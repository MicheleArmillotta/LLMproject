[
  {
    "function_name": "squashfs_read_inode_lookup_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
    "lines": "123-156",
    "snippet": "__le64 *squashfs_read_inode_lookup_table(struct super_block *sb,\n\t\tu64 lookup_table_start, u64 next_table, unsigned int inodes)\n{\n\tunsigned int length = SQUASHFS_LOOKUP_BLOCK_BYTES(inodes);\n\t__le64 *table;\n\n\tTRACE(\"In read_inode_lookup_table, length %d\\n\", length);\n\n\t/* Sanity check values */\n\n\t/* there should always be at least one inode */\n\tif (inodes == 0)\n\t\treturn ERR_PTR(-EINVAL);\n\n\t/* length bytes should not extend into the next table - this check\n\t * also traps instances where lookup_table_start is incorrectly larger\n\t * than the next table start\n\t */\n\tif (lookup_table_start + length > next_table)\n\t\treturn ERR_PTR(-EINVAL);\n\n\ttable = squashfs_read_table(sb, lookup_table_start, length);\n\n\t/*\n\t * table[0] points to the first inode lookup table metadata block,\n\t * this should be less than lookup_table_start\n\t */\n\tif (!IS_ERR(table) && le64_to_cpu(table[0]) >= lookup_table_start) {\n\t\tkfree(table);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\treturn table;\n}",
    "includes": [
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_i.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/dcache.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "table"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "table[0]"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "table"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squashfs_read_table",
          "args": [
            "sb",
            "lookup_table_start",
            "length"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_read_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/cache.c",
          "lines": "416-458",
          "snippet": "void *squashfs_read_table(struct super_block *sb, u64 block, int length)\n{\n\tint pages = (length + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\tint i, res;\n\tvoid *table, *buffer, **data;\n\tstruct squashfs_page_actor *actor;\n\n\ttable = buffer = kmalloc(length, GFP_KERNEL);\n\tif (table == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tdata = kcalloc(pages, sizeof(void *), GFP_KERNEL);\n\tif (data == NULL) {\n\t\tres = -ENOMEM;\n\t\tgoto failed;\n\t}\n\n\tactor = squashfs_page_actor_init(data, pages, length);\n\tif (actor == NULL) {\n\t\tres = -ENOMEM;\n\t\tgoto failed2;\n\t}\n\n\tfor (i = 0; i < pages; i++, buffer += PAGE_CACHE_SIZE)\n\t\tdata[i] = buffer;\n\n\tres = squashfs_read_data(sb, block, length |\n\t\tSQUASHFS_COMPRESSED_BIT_BLOCK, NULL, actor);\n\n\tkfree(data);\n\tkfree(actor);\n\n\tif (res < 0)\n\t\tgoto failed;\n\n\treturn table;\n\nfailed2:\n\tkfree(data);\nfailed:\n\tkfree(table);\n\treturn ERR_PTR(res);\n}",
          "includes": [
            "#include \"page_actor.h\"",
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/pagemap.h>",
            "#include <linux/wait.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page_actor.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/pagemap.h>\n#include <linux/wait.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nvoid *squashfs_read_table(struct super_block *sb, u64 block, int length)\n{\n\tint pages = (length + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\tint i, res;\n\tvoid *table, *buffer, **data;\n\tstruct squashfs_page_actor *actor;\n\n\ttable = buffer = kmalloc(length, GFP_KERNEL);\n\tif (table == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tdata = kcalloc(pages, sizeof(void *), GFP_KERNEL);\n\tif (data == NULL) {\n\t\tres = -ENOMEM;\n\t\tgoto failed;\n\t}\n\n\tactor = squashfs_page_actor_init(data, pages, length);\n\tif (actor == NULL) {\n\t\tres = -ENOMEM;\n\t\tgoto failed2;\n\t}\n\n\tfor (i = 0; i < pages; i++, buffer += PAGE_CACHE_SIZE)\n\t\tdata[i] = buffer;\n\n\tres = squashfs_read_data(sb, block, length |\n\t\tSQUASHFS_COMPRESSED_BIT_BLOCK, NULL, actor);\n\n\tkfree(data);\n\tkfree(actor);\n\n\tif (res < 0)\n\t\tgoto failed;\n\n\treturn table;\n\nfailed2:\n\tkfree(data);\nfailed:\n\tkfree(table);\n\treturn ERR_PTR(res);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TRACE",
          "args": [
            "\"In read_inode_lookup_table, length %d\\n\"",
            "length"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SQUASHFS_LOOKUP_BLOCK_BYTES",
          "args": [
            "inodes"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\n__le64 *squashfs_read_inode_lookup_table(struct super_block *sb,\n\t\tu64 lookup_table_start, u64 next_table, unsigned int inodes)\n{\n\tunsigned int length = SQUASHFS_LOOKUP_BLOCK_BYTES(inodes);\n\t__le64 *table;\n\n\tTRACE(\"In read_inode_lookup_table, length %d\\n\", length);\n\n\t/* Sanity check values */\n\n\t/* there should always be at least one inode */\n\tif (inodes == 0)\n\t\treturn ERR_PTR(-EINVAL);\n\n\t/* length bytes should not extend into the next table - this check\n\t * also traps instances where lookup_table_start is incorrectly larger\n\t * than the next table start\n\t */\n\tif (lookup_table_start + length > next_table)\n\t\treturn ERR_PTR(-EINVAL);\n\n\ttable = squashfs_read_table(sb, lookup_table_start, length);\n\n\t/*\n\t * table[0] points to the first inode lookup table metadata block,\n\t * this should be less than lookup_table_start\n\t */\n\tif (!IS_ERR(table) && le64_to_cpu(table[0]) >= lookup_table_start) {\n\t\tkfree(table);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\treturn table;\n}"
  },
  {
    "function_name": "squashfs_get_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
    "lines": "111-117",
    "snippet": "static struct dentry *squashfs_get_parent(struct dentry *child)\n{\n\tstruct inode *inode = child->d_inode;\n\tunsigned int parent_ino = squashfs_i(inode)->parent;\n\n\treturn squashfs_export_iget(inode->i_sb, parent_ino);\n}",
    "includes": [
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_i.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/dcache.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "squashfs_export_iget",
          "args": [
            "inode->i_sb",
            "parent_ino"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_export_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
          "lines": "74-87",
          "snippet": "static struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}",
          "includes": [
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_i.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/dcache.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "squashfs_i",
          "args": [
            "inode"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/squashfs_fs_i.h",
          "lines": "50-53",
          "snippet": "static inline struct squashfs_inode_info *squashfs_i(struct inode *inode)\n{\n\treturn list_entry(inode, struct squashfs_inode_info, vfs_inode);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline struct squashfs_inode_info *squashfs_i(struct inode *inode)\n{\n\treturn list_entry(inode, struct squashfs_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_get_parent(struct dentry *child)\n{\n\tstruct inode *inode = child->d_inode;\n\tunsigned int parent_ino = squashfs_i(inode)->parent;\n\n\treturn squashfs_export_iget(inode->i_sb, parent_ino);\n}"
  },
  {
    "function_name": "squashfs_fh_to_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
    "lines": "101-108",
    "snippet": "static struct dentry *squashfs_fh_to_parent(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tif (fh_type != FILEID_INO32_GEN_PARENT || fh_len < 4)\n\t\treturn NULL;\n\n\treturn squashfs_export_iget(sb, fid->i32.parent_ino);\n}",
    "includes": [
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_i.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/dcache.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "squashfs_export_iget",
          "args": [
            "sb",
            "fid->i32.parent_ino"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_export_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
          "lines": "74-87",
          "snippet": "static struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}",
          "includes": [
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_i.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/dcache.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_fh_to_parent(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tif (fh_type != FILEID_INO32_GEN_PARENT || fh_len < 4)\n\t\treturn NULL;\n\n\treturn squashfs_export_iget(sb, fid->i32.parent_ino);\n}"
  },
  {
    "function_name": "squashfs_fh_to_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
    "lines": "90-98",
    "snippet": "static struct dentry *squashfs_fh_to_dentry(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tif ((fh_type != FILEID_INO32_GEN && fh_type != FILEID_INO32_GEN_PARENT)\n\t\t\t|| fh_len < 2)\n\t\treturn NULL;\n\n\treturn squashfs_export_iget(sb, fid->i32.ino);\n}",
    "includes": [
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_i.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/dcache.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "squashfs_export_iget",
          "args": [
            "sb",
            "fid->i32.ino"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_export_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
          "lines": "74-87",
          "snippet": "static struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}",
          "includes": [
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_i.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/dcache.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_fh_to_dentry(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tif ((fh_type != FILEID_INO32_GEN && fh_type != FILEID_INO32_GEN_PARENT)\n\t\t\t|| fh_len < 2)\n\t\treturn NULL;\n\n\treturn squashfs_export_iget(sb, fid->i32.ino);\n}"
  },
  {
    "function_name": "squashfs_export_iget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
    "lines": "74-87",
    "snippet": "static struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}",
    "includes": [
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_i.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/dcache.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_obtain_alias",
          "args": [
            "squashfs_iget(sb, ino, ino_num)"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "d_obtain_alias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "1977-1980",
          "snippet": "struct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "squashfs_iget",
          "args": [
            "sb",
            "ino",
            "ino_num"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/inode.c",
          "lines": "84-105",
          "snippet": "struct inode *squashfs_iget(struct super_block *sb, long long ino,\n\t\t\t\tunsigned int ino_number)\n{\n\tstruct inode *inode = iget_locked(sb, ino_number);\n\tint err;\n\n\tTRACE(\"Entered squashfs_iget\\n\");\n\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOMEM);\n\tif (!(inode->i_state & I_NEW))\n\t\treturn inode;\n\n\terr = squashfs_read_inode(inode, ino);\n\tif (err) {\n\t\tiget_failed(inode);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tunlock_new_inode(inode);\n\treturn inode;\n}",
          "includes": [
            "#include \"xattr.h\"",
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_i.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xattr.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/xattr.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstruct inode *squashfs_iget(struct super_block *sb, long long ino,\n\t\t\t\tunsigned int ino_number)\n{\n\tstruct inode *inode = iget_locked(sb, ino_number);\n\tint err;\n\n\tTRACE(\"Entered squashfs_iget\\n\");\n\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOMEM);\n\tif (!(inode->i_state & I_NEW))\n\t\treturn inode;\n\n\terr = squashfs_read_inode(inode, ino);\n\tif (err) {\n\t\tiget_failed(inode);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tunlock_new_inode(inode);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "squashfs_inode_lookup",
          "args": [
            "sb",
            "ino_num"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_inode_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
          "lines": "52-71",
          "snippet": "static long long squashfs_inode_lookup(struct super_block *sb, int ino_num)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint blk = SQUASHFS_LOOKUP_BLOCK(ino_num - 1);\n\tint offset = SQUASHFS_LOOKUP_BLOCK_OFFSET(ino_num - 1);\n\tu64 start = le64_to_cpu(msblk->inode_lookup_table[blk]);\n\t__le64 ino;\n\tint err;\n\n\tTRACE(\"Entered squashfs_inode_lookup, inode_number = %d\\n\", ino_num);\n\n\terr = squashfs_read_metadata(sb, &ino, &start, &offset, sizeof(ino));\n\tif (err < 0)\n\t\treturn err;\n\n\tTRACE(\"squashfs_inode_lookup, inode = 0x%llx\\n\",\n\t\t(u64) le64_to_cpu(ino));\n\n\treturn le64_to_cpu(ino);\n}",
          "includes": [
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_i.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/dcache.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic long long squashfs_inode_lookup(struct super_block *sb, int ino_num)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint blk = SQUASHFS_LOOKUP_BLOCK(ino_num - 1);\n\tint offset = SQUASHFS_LOOKUP_BLOCK_OFFSET(ino_num - 1);\n\tu64 start = le64_to_cpu(msblk->inode_lookup_table[blk]);\n\t__le64 ino;\n\tint err;\n\n\tTRACE(\"Entered squashfs_inode_lookup, inode_number = %d\\n\", ino_num);\n\n\terr = squashfs_read_metadata(sb, &ino, &start, &offset, sizeof(ino));\n\tif (err < 0)\n\t\treturn err;\n\n\tTRACE(\"squashfs_inode_lookup, inode = 0x%llx\\n\",\n\t\t(u64) le64_to_cpu(ino));\n\n\treturn le64_to_cpu(ino);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TRACE",
          "args": [
            "\"Entered squashfs_export_iget\\n\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOENT"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic struct dentry *squashfs_export_iget(struct super_block *sb,\n\tunsigned int ino_num)\n{\n\tlong long ino;\n\tstruct dentry *dentry = ERR_PTR(-ENOENT);\n\n\tTRACE(\"Entered squashfs_export_iget\\n\");\n\n\tino = squashfs_inode_lookup(sb, ino_num);\n\tif (ino >= 0)\n\t\tdentry = d_obtain_alias(squashfs_iget(sb, ino, ino_num));\n\n\treturn dentry;\n}"
  },
  {
    "function_name": "squashfs_inode_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/export.c",
    "lines": "52-71",
    "snippet": "static long long squashfs_inode_lookup(struct super_block *sb, int ino_num)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint blk = SQUASHFS_LOOKUP_BLOCK(ino_num - 1);\n\tint offset = SQUASHFS_LOOKUP_BLOCK_OFFSET(ino_num - 1);\n\tu64 start = le64_to_cpu(msblk->inode_lookup_table[blk]);\n\t__le64 ino;\n\tint err;\n\n\tTRACE(\"Entered squashfs_inode_lookup, inode_number = %d\\n\", ino_num);\n\n\terr = squashfs_read_metadata(sb, &ino, &start, &offset, sizeof(ino));\n\tif (err < 0)\n\t\treturn err;\n\n\tTRACE(\"squashfs_inode_lookup, inode = 0x%llx\\n\",\n\t\t(u64) le64_to_cpu(ino));\n\n\treturn le64_to_cpu(ino);\n}",
    "includes": [
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_i.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/dcache.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "ino"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TRACE",
          "args": [
            "\"squashfs_inode_lookup, inode = 0x%llx\\n\"",
            "(u64) le64_to_cpu(ino)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squashfs_read_metadata",
          "args": [
            "sb",
            "&ino",
            "&start",
            "&offset",
            "sizeof(ino)"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_read_metadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/cache.c",
          "lines": "344-382",
          "snippet": "int squashfs_read_metadata(struct super_block *sb, void *buffer,\n\t\tu64 *block, int *offset, int length)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint bytes, res = length;\n\tstruct squashfs_cache_entry *entry;\n\n\tTRACE(\"Entered squashfs_read_metadata [%llx:%x]\\n\", *block, *offset);\n\n\twhile (length) {\n\t\tentry = squashfs_cache_get(sb, msblk->block_cache, *block, 0);\n\t\tif (entry->error) {\n\t\t\tres = entry->error;\n\t\t\tgoto error;\n\t\t} else if (*offset >= entry->length) {\n\t\t\tres = -EIO;\n\t\t\tgoto error;\n\t\t}\n\n\t\tbytes = squashfs_copy_data(buffer, entry, *offset, length);\n\t\tif (buffer)\n\t\t\tbuffer += bytes;\n\t\tlength -= bytes;\n\t\t*offset += bytes;\n\n\t\tif (*offset == entry->length) {\n\t\t\t*block = entry->next_index;\n\t\t\t*offset = 0;\n\t\t}\n\n\t\tsquashfs_cache_put(entry);\n\t}\n\n\treturn res;\n\nerror:\n\tsquashfs_cache_put(entry);\n\treturn res;\n}",
          "includes": [
            "#include \"page_actor.h\"",
            "#include \"squashfs.h\"",
            "#include \"squashfs_fs_sb.h\"",
            "#include \"squashfs_fs.h\"",
            "#include <linux/pagemap.h>",
            "#include <linux/wait.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page_actor.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/pagemap.h>\n#include <linux/wait.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nint squashfs_read_metadata(struct super_block *sb, void *buffer,\n\t\tu64 *block, int *offset, int length)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint bytes, res = length;\n\tstruct squashfs_cache_entry *entry;\n\n\tTRACE(\"Entered squashfs_read_metadata [%llx:%x]\\n\", *block, *offset);\n\n\twhile (length) {\n\t\tentry = squashfs_cache_get(sb, msblk->block_cache, *block, 0);\n\t\tif (entry->error) {\n\t\t\tres = entry->error;\n\t\t\tgoto error;\n\t\t} else if (*offset >= entry->length) {\n\t\t\tres = -EIO;\n\t\t\tgoto error;\n\t\t}\n\n\t\tbytes = squashfs_copy_data(buffer, entry, *offset, length);\n\t\tif (buffer)\n\t\t\tbuffer += bytes;\n\t\tlength -= bytes;\n\t\t*offset += bytes;\n\n\t\tif (*offset == entry->length) {\n\t\t\t*block = entry->next_index;\n\t\t\t*offset = 0;\n\t\t}\n\n\t\tsquashfs_cache_put(entry);\n\t}\n\n\treturn res;\n\nerror:\n\tsquashfs_cache_put(entry);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TRACE",
          "args": [
            "\"Entered squashfs_inode_lookup, inode_number = %d\\n\"",
            "ino_num"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SQUASHFS_LOOKUP_BLOCK_OFFSET",
          "args": [
            "ino_num - 1"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SQUASHFS_LOOKUP_BLOCK",
          "args": [
            "ino_num - 1"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"squashfs.h\"\n#include \"squashfs_fs_i.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/dcache.h>\n#include <linux/vfs.h>\n#include <linux/fs.h>\n\nstatic long long squashfs_inode_lookup(struct super_block *sb, int ino_num)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint blk = SQUASHFS_LOOKUP_BLOCK(ino_num - 1);\n\tint offset = SQUASHFS_LOOKUP_BLOCK_OFFSET(ino_num - 1);\n\tu64 start = le64_to_cpu(msblk->inode_lookup_table[blk]);\n\t__le64 ino;\n\tint err;\n\n\tTRACE(\"Entered squashfs_inode_lookup, inode_number = %d\\n\", ino_num);\n\n\terr = squashfs_read_metadata(sb, &ino, &start, &offset, sizeof(ino));\n\tif (err < 0)\n\t\treturn err;\n\n\tTRACE(\"squashfs_inode_lookup, inode = 0x%llx\\n\",\n\t\t(u64) le64_to_cpu(ino));\n\n\treturn le64_to_cpu(ino);\n}"
  }
]