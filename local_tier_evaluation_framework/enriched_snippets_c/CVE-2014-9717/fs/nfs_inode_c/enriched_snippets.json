[
  {
    "function_name": "exit_nfs_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "2025-2040",
    "snippet": "static void __exit exit_nfs_fs(void)\n{\n\tnfs_destroy_directcache();\n\tnfs_destroy_writepagecache();\n\tnfs_destroy_readpagecache();\n\tnfs_destroy_inodecache();\n\tnfs_destroy_nfspagecache();\n\tnfs_fscache_unregister();\n\tunregister_pernet_subsys(&nfs_net_ops);\n#ifdef CONFIG_PROC_FS\n\trpc_proc_unregister(&init_net, \"nfs\");\n#endif\n\tunregister_nfs_fs();\n\tnfs_fs_proc_exit();\n\tnfsiod_stop();\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pernet_operations nfs_net_ops = {\n\t.init = nfs_net_init,\n\t.exit = nfs_net_exit,\n\t.id   = &nfs_net_id,\n\t.size = sizeof(struct nfs_net),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfsiod_stop",
          "args": [],
          "line": 2039
        },
        "resolved": true,
        "details": {
          "function_name": "nfsiod_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1917-1926",
          "snippet": "static void nfsiod_stop(void)\n{\n\tstruct workqueue_struct *wq;\n\n\twq = nfsiod_workqueue;\n\tif (wq == NULL)\n\t\treturn;\n\tnfsiod_workqueue = NULL;\n\tdestroy_workqueue(wq);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *nfsiod_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct workqueue_struct *nfsiod_workqueue;\n\nstatic void nfsiod_stop(void)\n{\n\tstruct workqueue_struct *wq;\n\n\twq = nfsiod_workqueue;\n\tif (wq == NULL)\n\t\treturn;\n\tnfsiod_workqueue = NULL;\n\tdestroy_workqueue(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fs_proc_exit",
          "args": [],
          "line": 2038
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_proc_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "217-219",
          "snippet": "static inline void nfs_fs_proc_exit(void)\n{\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline void nfs_fs_proc_exit(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_nfs_fs",
          "args": [],
          "line": 2037
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs_fs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "399-405",
          "snippet": "void __exit unregister_nfs_fs(void)\n{\n\tunregister_shrinker(&acl_shrinker);\n\tnfs_unregister_sysctl();\n\tunregister_nfs4_fs();\n\tunregister_filesystem(&nfs_fs_type);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};",
            "static struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\nstatic struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};\n\nvoid __exit unregister_nfs_fs(void)\n{\n\tunregister_shrinker(&acl_shrinker);\n\tnfs_unregister_sysctl();\n\tunregister_nfs4_fs();\n\tunregister_filesystem(&nfs_fs_type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_proc_unregister",
          "args": [
            "&init_net",
            "\"nfs\""
          ],
          "line": 2035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_pernet_subsys",
          "args": [
            "&nfs_net_ops"
          ],
          "line": 2033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fscache_unregister",
          "args": [],
          "line": 2032
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache-index.c",
          "lines": "46-49",
          "snippet": "void nfs_fscache_unregister(void)\n{\n\tfscache_unregister_netfs(&nfs_fscache_netfs);\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct fscache_netfs nfs_fscache_netfs = {\n\t.name\t\t= \"nfs\",\n\t.version\t= 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"internal.h\"\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstruct fscache_netfs nfs_fscache_netfs = {\n\t.name\t\t= \"nfs\",\n\t.version\t= 0,\n};\n\nvoid nfs_fscache_unregister(void)\n{\n\tfscache_unregister_netfs(&nfs_fscache_netfs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_nfspagecache",
          "args": [],
          "line": 2031
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_nfspagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1295-1298",
          "snippet": "void nfs_destroy_nfspagecache(void)\n{\n\tkmem_cache_destroy(nfs_page_cachep);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_page_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nvoid nfs_destroy_nfspagecache(void)\n{\n\tkmem_cache_destroy(nfs_page_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_inodecache",
          "args": [],
          "line": 2030
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_inodecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1887-1895",
          "snippet": "static void nfs_destroy_inodecache(void)\n{\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(nfs_inode_cachep);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache * nfs_inode_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstatic void nfs_destroy_inodecache(void)\n{\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(nfs_inode_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_readpagecache",
          "args": [],
          "line": 2029
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_readpagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/read.c",
          "lines": "433-436",
          "snippet": "void nfs_destroy_readpagecache(void)\n{\n\tkmem_cache_destroy(nfs_rdata_cachep);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_rdata_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n\nstatic struct kmem_cache *nfs_rdata_cachep;\n\nvoid nfs_destroy_readpagecache(void)\n{\n\tkmem_cache_destroy(nfs_rdata_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_writepagecache",
          "args": [],
          "line": 2028
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_writepagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "2006-2012",
          "snippet": "void nfs_destroy_writepagecache(void)\n{\n\tmempool_destroy(nfs_commit_mempool);\n\tkmem_cache_destroy(nfs_cdata_cachep);\n\tmempool_destroy(nfs_wdata_mempool);\n\tkmem_cache_destroy(nfs_wdata_cachep);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_wdata_cachep;",
            "static mempool_t *nfs_wdata_mempool;",
            "static struct kmem_cache *nfs_cdata_cachep;",
            "static mempool_t *nfs_commit_mempool;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic struct kmem_cache *nfs_wdata_cachep;\nstatic mempool_t *nfs_wdata_mempool;\nstatic struct kmem_cache *nfs_cdata_cachep;\nstatic mempool_t *nfs_commit_mempool;\n\nvoid nfs_destroy_writepagecache(void)\n{\n\tmempool_destroy(nfs_commit_mempool);\n\tkmem_cache_destroy(nfs_cdata_cachep);\n\tmempool_destroy(nfs_wdata_mempool);\n\tkmem_cache_destroy(nfs_wdata_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_directcache",
          "args": [],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_directcache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "1078-1081",
          "snippet": "void nfs_destroy_directcache(void)\n{\n\tkmem_cache_destroy(nfs_direct_cachep);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_direct_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\n\nvoid nfs_destroy_directcache(void)\n{\n\tkmem_cache_destroy(nfs_direct_cachep);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct pernet_operations nfs_net_ops = {\n\t.init = nfs_net_init,\n\t.exit = nfs_net_exit,\n\t.id   = &nfs_net_id,\n\t.size = sizeof(struct nfs_net),\n};\n\nstatic void __exit exit_nfs_fs(void)\n{\n\tnfs_destroy_directcache();\n\tnfs_destroy_writepagecache();\n\tnfs_destroy_readpagecache();\n\tnfs_destroy_inodecache();\n\tnfs_destroy_nfspagecache();\n\tnfs_fscache_unregister();\n\tunregister_pernet_subsys(&nfs_net_ops);\n#ifdef CONFIG_PROC_FS\n\trpc_proc_unregister(&init_net, \"nfs\");\n#endif\n\tunregister_nfs_fs();\n\tnfs_fs_proc_exit();\n\tnfsiod_stop();\n}"
  },
  {
    "function_name": "init_nfs_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1953-2023",
    "snippet": "static int __init init_nfs_fs(void)\n{\n\tint err;\n\n\terr = register_pernet_subsys(&nfs_net_ops);\n\tif (err < 0)\n\t\tgoto out9;\n\n\terr = nfs_fscache_register();\n\tif (err < 0)\n\t\tgoto out8;\n\n\terr = nfsiod_start();\n\tif (err)\n\t\tgoto out7;\n\n\terr = nfs_fs_proc_init();\n\tif (err)\n\t\tgoto out6;\n\n\terr = nfs_init_nfspagecache();\n\tif (err)\n\t\tgoto out5;\n\n\terr = nfs_init_inodecache();\n\tif (err)\n\t\tgoto out4;\n\n\terr = nfs_init_readpagecache();\n\tif (err)\n\t\tgoto out3;\n\n\terr = nfs_init_writepagecache();\n\tif (err)\n\t\tgoto out2;\n\n\terr = nfs_init_directcache();\n\tif (err)\n\t\tgoto out1;\n\n#ifdef CONFIG_PROC_FS\n\trpc_proc_register(&init_net, &nfs_rpcstat);\n#endif\n\tif ((err = register_nfs_fs()) != 0)\n\t\tgoto out0;\n\n\treturn 0;\nout0:\n#ifdef CONFIG_PROC_FS\n\trpc_proc_unregister(&init_net, \"nfs\");\n#endif\n\tnfs_destroy_directcache();\nout1:\n\tnfs_destroy_writepagecache();\nout2:\n\tnfs_destroy_readpagecache();\nout3:\n\tnfs_destroy_inodecache();\nout4:\n\tnfs_destroy_nfspagecache();\nout5:\n\tnfs_fs_proc_exit();\nout6:\n\tnfsiod_stop();\nout7:\n\tnfs_fscache_unregister();\nout8:\n\tunregister_pernet_subsys(&nfs_net_ops);\nout9:\n\treturn err;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pernet_operations nfs_net_ops = {\n\t.init = nfs_net_init,\n\t.exit = nfs_net_exit,\n\t.id   = &nfs_net_id,\n\t.size = sizeof(struct nfs_net),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_pernet_subsys",
          "args": [
            "&nfs_net_ops"
          ],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fscache_unregister",
          "args": [],
          "line": 2018
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache-index.c",
          "lines": "46-49",
          "snippet": "void nfs_fscache_unregister(void)\n{\n\tfscache_unregister_netfs(&nfs_fscache_netfs);\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct fscache_netfs nfs_fscache_netfs = {\n\t.name\t\t= \"nfs\",\n\t.version\t= 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"internal.h\"\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstruct fscache_netfs nfs_fscache_netfs = {\n\t.name\t\t= \"nfs\",\n\t.version\t= 0,\n};\n\nvoid nfs_fscache_unregister(void)\n{\n\tfscache_unregister_netfs(&nfs_fscache_netfs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfsiod_stop",
          "args": [],
          "line": 2016
        },
        "resolved": true,
        "details": {
          "function_name": "nfsiod_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1917-1926",
          "snippet": "static void nfsiod_stop(void)\n{\n\tstruct workqueue_struct *wq;\n\n\twq = nfsiod_workqueue;\n\tif (wq == NULL)\n\t\treturn;\n\tnfsiod_workqueue = NULL;\n\tdestroy_workqueue(wq);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *nfsiod_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct workqueue_struct *nfsiod_workqueue;\n\nstatic void nfsiod_stop(void)\n{\n\tstruct workqueue_struct *wq;\n\n\twq = nfsiod_workqueue;\n\tif (wq == NULL)\n\t\treturn;\n\tnfsiod_workqueue = NULL;\n\tdestroy_workqueue(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fs_proc_exit",
          "args": [],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_proc_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "217-219",
          "snippet": "static inline void nfs_fs_proc_exit(void)\n{\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline void nfs_fs_proc_exit(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_nfspagecache",
          "args": [],
          "line": 2012
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_nfspagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1295-1298",
          "snippet": "void nfs_destroy_nfspagecache(void)\n{\n\tkmem_cache_destroy(nfs_page_cachep);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_page_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nvoid nfs_destroy_nfspagecache(void)\n{\n\tkmem_cache_destroy(nfs_page_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_inodecache",
          "args": [],
          "line": 2010
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_inodecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1887-1895",
          "snippet": "static void nfs_destroy_inodecache(void)\n{\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(nfs_inode_cachep);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache * nfs_inode_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstatic void nfs_destroy_inodecache(void)\n{\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(nfs_inode_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_readpagecache",
          "args": [],
          "line": 2008
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_readpagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/read.c",
          "lines": "433-436",
          "snippet": "void nfs_destroy_readpagecache(void)\n{\n\tkmem_cache_destroy(nfs_rdata_cachep);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_rdata_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n\nstatic struct kmem_cache *nfs_rdata_cachep;\n\nvoid nfs_destroy_readpagecache(void)\n{\n\tkmem_cache_destroy(nfs_rdata_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_writepagecache",
          "args": [],
          "line": 2006
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_writepagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "2006-2012",
          "snippet": "void nfs_destroy_writepagecache(void)\n{\n\tmempool_destroy(nfs_commit_mempool);\n\tkmem_cache_destroy(nfs_cdata_cachep);\n\tmempool_destroy(nfs_wdata_mempool);\n\tkmem_cache_destroy(nfs_wdata_cachep);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_wdata_cachep;",
            "static mempool_t *nfs_wdata_mempool;",
            "static struct kmem_cache *nfs_cdata_cachep;",
            "static mempool_t *nfs_commit_mempool;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic struct kmem_cache *nfs_wdata_cachep;\nstatic mempool_t *nfs_wdata_mempool;\nstatic struct kmem_cache *nfs_cdata_cachep;\nstatic mempool_t *nfs_commit_mempool;\n\nvoid nfs_destroy_writepagecache(void)\n{\n\tmempool_destroy(nfs_commit_mempool);\n\tkmem_cache_destroy(nfs_cdata_cachep);\n\tmempool_destroy(nfs_wdata_mempool);\n\tkmem_cache_destroy(nfs_wdata_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_destroy_directcache",
          "args": [],
          "line": 2004
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_destroy_directcache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "1078-1081",
          "snippet": "void nfs_destroy_directcache(void)\n{\n\tkmem_cache_destroy(nfs_direct_cachep);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_direct_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\n\nvoid nfs_destroy_directcache(void)\n{\n\tkmem_cache_destroy(nfs_direct_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_proc_unregister",
          "args": [
            "&init_net",
            "\"nfs\""
          ],
          "line": 2002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_nfs_fs",
          "args": [],
          "line": 1996
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs_fs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "399-405",
          "snippet": "void __exit unregister_nfs_fs(void)\n{\n\tunregister_shrinker(&acl_shrinker);\n\tnfs_unregister_sysctl();\n\tunregister_nfs4_fs();\n\tunregister_filesystem(&nfs_fs_type);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};",
            "static struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\nstatic struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};\n\nvoid __exit unregister_nfs_fs(void)\n{\n\tunregister_shrinker(&acl_shrinker);\n\tnfs_unregister_sysctl();\n\tunregister_nfs4_fs();\n\tunregister_filesystem(&nfs_fs_type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_proc_register",
          "args": [
            "&init_net",
            "&nfs_rpcstat"
          ],
          "line": 1994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_init_directcache",
          "args": [],
          "line": 1989
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_directcache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/direct.c",
          "lines": "1061-1072",
          "snippet": "int __init nfs_init_directcache(void)\n{\n\tnfs_direct_cachep = kmem_cache_create(\"nfs_direct_cache\",\n\t\t\t\t\t\tsizeof(struct nfs_direct_req),\n\t\t\t\t\t\t0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t\tNULL);\n\tif (nfs_direct_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_direct_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <asm/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *nfs_direct_cachep;\n\nint __init nfs_init_directcache(void)\n{\n\tnfs_direct_cachep = kmem_cache_create(\"nfs_direct_cache\",\n\t\t\t\t\t\tsizeof(struct nfs_direct_req),\n\t\t\t\t\t\t0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t\tNULL);\n\tif (nfs_direct_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_writepagecache",
          "args": [],
          "line": 1985
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_writepagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1949-2004",
          "snippet": "int __init nfs_init_writepagecache(void)\n{\n\tnfs_wdata_cachep = kmem_cache_create(\"nfs_write_data\",\n\t\t\t\t\t     sizeof(struct nfs_pgio_header),\n\t\t\t\t\t     0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t     NULL);\n\tif (nfs_wdata_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\tnfs_wdata_mempool = mempool_create_slab_pool(MIN_POOL_WRITE,\n\t\t\t\t\t\t     nfs_wdata_cachep);\n\tif (nfs_wdata_mempool == NULL)\n\t\tgoto out_destroy_write_cache;\n\n\tnfs_cdata_cachep = kmem_cache_create(\"nfs_commit_data\",\n\t\t\t\t\t     sizeof(struct nfs_commit_data),\n\t\t\t\t\t     0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t     NULL);\n\tif (nfs_cdata_cachep == NULL)\n\t\tgoto out_destroy_write_mempool;\n\n\tnfs_commit_mempool = mempool_create_slab_pool(MIN_POOL_COMMIT,\n\t\t\t\t\t\t      nfs_cdata_cachep);\n\tif (nfs_commit_mempool == NULL)\n\t\tgoto out_destroy_commit_cache;\n\n\t/*\n\t * NFS congestion size, scale with available memory.\n\t *\n\t *  64MB:    8192k\n\t * 128MB:   11585k\n\t * 256MB:   16384k\n\t * 512MB:   23170k\n\t *   1GB:   32768k\n\t *   2GB:   46340k\n\t *   4GB:   65536k\n\t *   8GB:   92681k\n\t *  16GB:  131072k\n\t *\n\t * This allows larger machines to have larger/more transfers.\n\t * Limit the default to 256M\n\t */\n\tnfs_congestion_kb = (16*int_sqrt(totalram_pages)) << (PAGE_SHIFT-10);\n\tif (nfs_congestion_kb > 256*1024)\n\t\tnfs_congestion_kb = 256*1024;\n\n\treturn 0;\n\nout_destroy_commit_cache:\n\tkmem_cache_destroy(nfs_cdata_cachep);\nout_destroy_write_mempool:\n\tmempool_destroy(nfs_wdata_mempool);\nout_destroy_write_cache:\n\tkmem_cache_destroy(nfs_wdata_cachep);\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define MIN_POOL_COMMIT\t\t(4)",
            "#define MIN_POOL_WRITE\t\t(32)"
          ],
          "globals_used": [
            "static struct kmem_cache *nfs_wdata_cachep;",
            "static mempool_t *nfs_wdata_mempool;",
            "static struct kmem_cache *nfs_cdata_cachep;",
            "static mempool_t *nfs_commit_mempool;",
            "int nfs_congestion_kb;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define MIN_POOL_COMMIT\t\t(4)\n#define MIN_POOL_WRITE\t\t(32)\n\nstatic struct kmem_cache *nfs_wdata_cachep;\nstatic mempool_t *nfs_wdata_mempool;\nstatic struct kmem_cache *nfs_cdata_cachep;\nstatic mempool_t *nfs_commit_mempool;\nint nfs_congestion_kb;\n\nint __init nfs_init_writepagecache(void)\n{\n\tnfs_wdata_cachep = kmem_cache_create(\"nfs_write_data\",\n\t\t\t\t\t     sizeof(struct nfs_pgio_header),\n\t\t\t\t\t     0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t     NULL);\n\tif (nfs_wdata_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\tnfs_wdata_mempool = mempool_create_slab_pool(MIN_POOL_WRITE,\n\t\t\t\t\t\t     nfs_wdata_cachep);\n\tif (nfs_wdata_mempool == NULL)\n\t\tgoto out_destroy_write_cache;\n\n\tnfs_cdata_cachep = kmem_cache_create(\"nfs_commit_data\",\n\t\t\t\t\t     sizeof(struct nfs_commit_data),\n\t\t\t\t\t     0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t     NULL);\n\tif (nfs_cdata_cachep == NULL)\n\t\tgoto out_destroy_write_mempool;\n\n\tnfs_commit_mempool = mempool_create_slab_pool(MIN_POOL_COMMIT,\n\t\t\t\t\t\t      nfs_cdata_cachep);\n\tif (nfs_commit_mempool == NULL)\n\t\tgoto out_destroy_commit_cache;\n\n\t/*\n\t * NFS congestion size, scale with available memory.\n\t *\n\t *  64MB:    8192k\n\t * 128MB:   11585k\n\t * 256MB:   16384k\n\t * 512MB:   23170k\n\t *   1GB:   32768k\n\t *   2GB:   46340k\n\t *   4GB:   65536k\n\t *   8GB:   92681k\n\t *  16GB:  131072k\n\t *\n\t * This allows larger machines to have larger/more transfers.\n\t * Limit the default to 256M\n\t */\n\tnfs_congestion_kb = (16*int_sqrt(totalram_pages)) << (PAGE_SHIFT-10);\n\tif (nfs_congestion_kb > 256*1024)\n\t\tnfs_congestion_kb = 256*1024;\n\n\treturn 0;\n\nout_destroy_commit_cache:\n\tkmem_cache_destroy(nfs_cdata_cachep);\nout_destroy_write_mempool:\n\tmempool_destroy(nfs_wdata_mempool);\nout_destroy_write_cache:\n\tkmem_cache_destroy(nfs_wdata_cachep);\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_readpagecache",
          "args": [],
          "line": 1981
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_readpagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/read.c",
          "lines": "421-431",
          "snippet": "int __init nfs_init_readpagecache(void)\n{\n\tnfs_rdata_cachep = kmem_cache_create(\"nfs_read_data\",\n\t\t\t\t\t     sizeof(struct nfs_pgio_header),\n\t\t\t\t\t     0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t     NULL);\n\tif (nfs_rdata_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_rdata_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n\nstatic struct kmem_cache *nfs_rdata_cachep;\n\nint __init nfs_init_readpagecache(void)\n{\n\tnfs_rdata_cachep = kmem_cache_create(\"nfs_read_data\",\n\t\t\t\t\t     sizeof(struct nfs_pgio_header),\n\t\t\t\t\t     0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t     NULL);\n\tif (nfs_rdata_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_inodecache",
          "args": [],
          "line": 1977
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_inodecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1874-1885",
          "snippet": "static int __init nfs_init_inodecache(void)\n{\n\tnfs_inode_cachep = kmem_cache_create(\"nfs_inode_cache\",\n\t\t\t\t\t     sizeof(struct nfs_inode),\n\t\t\t\t\t     0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t     init_once);\n\tif (nfs_inode_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache * nfs_inode_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstatic int __init nfs_init_inodecache(void)\n{\n\tnfs_inode_cachep = kmem_cache_create(\"nfs_inode_cache\",\n\t\t\t\t\t     sizeof(struct nfs_inode),\n\t\t\t\t\t     0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t     init_once);\n\tif (nfs_inode_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_nfspagecache",
          "args": [],
          "line": 1973
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_nfspagecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pagelist.c",
          "lines": "1283-1293",
          "snippet": "int __init nfs_init_nfspagecache(void)\n{\n\tnfs_page_cachep = kmem_cache_create(\"nfs_page\",\n\t\t\t\t\t    sizeof(struct nfs_page),\n\t\t\t\t\t    0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t    NULL);\n\tif (nfs_page_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include <linux/export.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *nfs_page_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include <linux/export.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs4.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *nfs_page_cachep;\n\nint __init nfs_init_nfspagecache(void)\n{\n\tnfs_page_cachep = kmem_cache_create(\"nfs_page\",\n\t\t\t\t\t    sizeof(struct nfs_page),\n\t\t\t\t\t    0, SLAB_HWCACHE_ALIGN,\n\t\t\t\t\t    NULL);\n\tif (nfs_page_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fs_proc_init",
          "args": [],
          "line": 1969
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_proc_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "213-216",
          "snippet": "static inline int nfs_fs_proc_init(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline int nfs_fs_proc_init(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfsiod_start",
          "args": [],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "nfsiod_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1903-1912",
          "snippet": "static int nfsiod_start(void)\n{\n\tstruct workqueue_struct *wq;\n\tdprintk(\"RPC:       creating workqueue nfsiod\\n\");\n\twq = alloc_workqueue(\"nfsiod\", WQ_MEM_RECLAIM, 0);\n\tif (wq == NULL)\n\t\treturn -ENOMEM;\n\tnfsiod_workqueue = wq;\n\treturn 0;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *nfsiod_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct workqueue_struct *nfsiod_workqueue;\n\nstatic int nfsiod_start(void)\n{\n\tstruct workqueue_struct *wq;\n\tdprintk(\"RPC:       creating workqueue nfsiod\\n\");\n\twq = alloc_workqueue(\"nfsiod\", WQ_MEM_RECLAIM, 0);\n\tif (wq == NULL)\n\t\treturn -ENOMEM;\n\tnfsiod_workqueue = wq;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fscache_register",
          "args": [],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache-index.c",
          "lines": "38-41",
          "snippet": "int nfs_fscache_register(void)\n{\n\treturn fscache_register_netfs(&nfs_fscache_netfs);\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct fscache_netfs nfs_fscache_netfs = {\n\t.name\t\t= \"nfs\",\n\t.version\t= 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"internal.h\"\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstruct fscache_netfs nfs_fscache_netfs = {\n\t.name\t\t= \"nfs\",\n\t.version\t= 0,\n};\n\nint nfs_fscache_register(void)\n{\n\treturn fscache_register_netfs(&nfs_fscache_netfs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_pernet_subsys",
          "args": [
            "&nfs_net_ops"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct pernet_operations nfs_net_ops = {\n\t.init = nfs_net_init,\n\t.exit = nfs_net_exit,\n\t.id   = &nfs_net_id,\n\t.size = sizeof(struct nfs_net),\n};\n\nstatic int __init init_nfs_fs(void)\n{\n\tint err;\n\n\terr = register_pernet_subsys(&nfs_net_ops);\n\tif (err < 0)\n\t\tgoto out9;\n\n\terr = nfs_fscache_register();\n\tif (err < 0)\n\t\tgoto out8;\n\n\terr = nfsiod_start();\n\tif (err)\n\t\tgoto out7;\n\n\terr = nfs_fs_proc_init();\n\tif (err)\n\t\tgoto out6;\n\n\terr = nfs_init_nfspagecache();\n\tif (err)\n\t\tgoto out5;\n\n\terr = nfs_init_inodecache();\n\tif (err)\n\t\tgoto out4;\n\n\terr = nfs_init_readpagecache();\n\tif (err)\n\t\tgoto out3;\n\n\terr = nfs_init_writepagecache();\n\tif (err)\n\t\tgoto out2;\n\n\terr = nfs_init_directcache();\n\tif (err)\n\t\tgoto out1;\n\n#ifdef CONFIG_PROC_FS\n\trpc_proc_register(&init_net, &nfs_rpcstat);\n#endif\n\tif ((err = register_nfs_fs()) != 0)\n\t\tgoto out0;\n\n\treturn 0;\nout0:\n#ifdef CONFIG_PROC_FS\n\trpc_proc_unregister(&init_net, \"nfs\");\n#endif\n\tnfs_destroy_directcache();\nout1:\n\tnfs_destroy_writepagecache();\nout2:\n\tnfs_destroy_readpagecache();\nout3:\n\tnfs_destroy_inodecache();\nout4:\n\tnfs_destroy_nfspagecache();\nout5:\n\tnfs_fs_proc_exit();\nout6:\n\tnfsiod_stop();\nout7:\n\tnfs_fscache_unregister();\nout8:\n\tunregister_pernet_subsys(&nfs_net_ops);\nout9:\n\treturn err;\n}"
  },
  {
    "function_name": "nfs_net_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1937-1941",
    "snippet": "static void nfs_net_exit(struct net *net)\n{\n\tnfs_fs_proc_net_exit(net);\n\tnfs_cleanup_cb_ident_idr(net);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_cleanup_cb_ident_idr",
          "args": [
            "net"
          ],
          "line": 1940
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cleanup_cb_ident_idr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "224-226",
          "snippet": "void nfs_cleanup_cb_ident_idr(struct net *net)\n{\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_cleanup_cb_ident_idr(struct net *net)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fs_proc_net_exit",
          "args": [
            "net"
          ],
          "line": 1939
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_proc_net_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "210-212",
          "snippet": "static inline void nfs_fs_proc_net_exit(struct net *net)\n{\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern void nfs_clients_init(struct net *net);",
            "extern void nfs_cleanup_cb_ident_idr(struct net *);",
            "extern struct nfs_client *nfs4_find_client_ident(struct net *, int);",
            "extern int nfs4_update_server(struct nfs_server *server, const char *hostname,\n\t\t\t\t\tstruct sockaddr *sap, size_t salen,\n\t\t\t\t\tstruct net *net);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern void nfs_clients_init(struct net *net);\nextern void nfs_cleanup_cb_ident_idr(struct net *);\nextern struct nfs_client *nfs4_find_client_ident(struct net *, int);\nextern int nfs4_update_server(struct nfs_server *server, const char *hostname,\n\t\t\t\t\tstruct sockaddr *sap, size_t salen,\n\t\t\t\t\tstruct net *net);\n\nstatic inline void nfs_fs_proc_net_exit(struct net *net)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_net_exit(struct net *net)\n{\n\tnfs_fs_proc_net_exit(net);\n\tnfs_cleanup_cb_ident_idr(net);\n}"
  },
  {
    "function_name": "nfs_net_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1931-1935",
    "snippet": "static int nfs_net_init(struct net *net)\n{\n\tnfs_clients_init(net);\n\treturn nfs_fs_proc_net_init(net);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fs_proc_net_init",
          "args": [
            "net"
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_proc_net_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "206-209",
          "snippet": "static inline int nfs_fs_proc_net_init(struct net *net)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern void nfs_clients_init(struct net *net);",
            "extern void nfs_cleanup_cb_ident_idr(struct net *);",
            "extern struct nfs_client *nfs4_find_client_ident(struct net *, int);",
            "extern int nfs4_update_server(struct nfs_server *server, const char *hostname,\n\t\t\t\t\tstruct sockaddr *sap, size_t salen,\n\t\t\t\t\tstruct net *net);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern void nfs_clients_init(struct net *net);\nextern void nfs_cleanup_cb_ident_idr(struct net *);\nextern struct nfs_client *nfs4_find_client_ident(struct net *, int);\nextern int nfs4_update_server(struct nfs_server *server, const char *hostname,\n\t\t\t\t\tstruct sockaddr *sap, size_t salen,\n\t\t\t\t\tstruct net *net);\n\nstatic inline int nfs_fs_proc_net_init(struct net *net)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_clients_init",
          "args": [
            "net"
          ],
          "line": 1933
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_clients_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1183-1194",
          "snippet": "void nfs_clients_init(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tINIT_LIST_HEAD(&nn->nfs_client_list);\n\tINIT_LIST_HEAD(&nn->nfs_volume_list);\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tidr_init(&nn->cb_ident_idr);\n#endif\n\tspin_lock_init(&nn->nfs_client_lock);\n\tnn->boot_time = CURRENT_TIME;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_clients_init(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tINIT_LIST_HEAD(&nn->nfs_client_list);\n\tINIT_LIST_HEAD(&nn->nfs_volume_list);\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tidr_init(&nn->cb_ident_idr);\n#endif\n\tspin_lock_init(&nn->nfs_client_lock);\n\tnn->boot_time = CURRENT_TIME;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_net_init(struct net *net)\n{\n\tnfs_clients_init(net);\n\treturn nfs_fs_proc_net_init(net);\n}"
  },
  {
    "function_name": "nfsiod_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1917-1926",
    "snippet": "static void nfsiod_stop(void)\n{\n\tstruct workqueue_struct *wq;\n\n\twq = nfsiod_workqueue;\n\tif (wq == NULL)\n\t\treturn;\n\tnfsiod_workqueue = NULL;\n\tdestroy_workqueue(wq);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct workqueue_struct *nfsiod_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "wq"
          ],
          "line": 1925
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct workqueue_struct *nfsiod_workqueue;\n\nstatic void nfsiod_stop(void)\n{\n\tstruct workqueue_struct *wq;\n\n\twq = nfsiod_workqueue;\n\tif (wq == NULL)\n\t\treturn;\n\tnfsiod_workqueue = NULL;\n\tdestroy_workqueue(wq);\n}"
  },
  {
    "function_name": "nfsiod_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1903-1912",
    "snippet": "static int nfsiod_start(void)\n{\n\tstruct workqueue_struct *wq;\n\tdprintk(\"RPC:       creating workqueue nfsiod\\n\");\n\twq = alloc_workqueue(\"nfsiod\", WQ_MEM_RECLAIM, 0);\n\tif (wq == NULL)\n\t\treturn -ENOMEM;\n\tnfsiod_workqueue = wq;\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct workqueue_struct *nfsiod_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"nfsiod\"",
            "WQ_MEM_RECLAIM",
            "0"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"RPC:       creating workqueue nfsiod\\n\""
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct workqueue_struct *nfsiod_workqueue;\n\nstatic int nfsiod_start(void)\n{\n\tstruct workqueue_struct *wq;\n\tdprintk(\"RPC:       creating workqueue nfsiod\\n\");\n\twq = alloc_workqueue(\"nfsiod\", WQ_MEM_RECLAIM, 0);\n\tif (wq == NULL)\n\t\treturn -ENOMEM;\n\tnfsiod_workqueue = wq;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_destroy_inodecache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1887-1895",
    "snippet": "static void nfs_destroy_inodecache(void)\n{\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(nfs_inode_cachep);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache * nfs_inode_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "nfs_inode_cachep"
          ],
          "line": 1894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_barrier",
          "args": [],
          "line": 1893
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstatic void nfs_destroy_inodecache(void)\n{\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(nfs_inode_cachep);\n}"
  },
  {
    "function_name": "nfs_init_inodecache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1874-1885",
    "snippet": "static int __init nfs_init_inodecache(void)\n{\n\tnfs_inode_cachep = kmem_cache_create(\"nfs_inode_cache\",\n\t\t\t\t\t     sizeof(struct nfs_inode),\n\t\t\t\t\t     0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t     init_once);\n\tif (nfs_inode_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache * nfs_inode_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"nfs_inode_cache\"",
            "sizeof(struct nfs_inode)",
            "0",
            "(SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD)",
            "init_once"
          ],
          "line": 1876
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstatic int __init nfs_init_inodecache(void)\n{\n\tnfs_inode_cachep = kmem_cache_create(\"nfs_inode_cache\",\n\t\t\t\t\t     sizeof(struct nfs_inode),\n\t\t\t\t\t     0, (SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t\tSLAB_MEM_SPREAD),\n\t\t\t\t\t     init_once);\n\tif (nfs_inode_cachep == NULL)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "init_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1856-1872",
    "snippet": "static void init_once(void *foo)\n{\n\tstruct nfs_inode *nfsi = (struct nfs_inode *) foo;\n\n\tinode_init_once(&nfsi->vfs_inode);\n\tINIT_LIST_HEAD(&nfsi->open_files);\n\tINIT_LIST_HEAD(&nfsi->access_cache_entry_lru);\n\tINIT_LIST_HEAD(&nfsi->access_cache_inode_lru);\n\tINIT_LIST_HEAD(&nfsi->commit_info.list);\n\tnfsi->nrequests = 0;\n\tnfsi->commit_info.ncommit = 0;\n\tatomic_set(&nfsi->commit_info.rpcs_out, 0);\n\tatomic_set(&nfsi->silly_count, 1);\n\tINIT_HLIST_HEAD(&nfsi->silly_list);\n\tinit_waitqueue_head(&nfsi->waitqueue);\n\tnfs4_init_once(nfsi);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_init_once",
          "args": [
            "nfsi"
          ],
          "line": 1871
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_once",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1846-1854",
          "snippet": "static inline void nfs4_init_once(struct nfs_inode *nfsi)\n{\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tINIT_LIST_HEAD(&nfsi->open_states);\n\tnfsi->delegation = NULL;\n\tinit_rwsem(&nfsi->rwsem);\n\tnfsi->layout = NULL;\n#endif\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic inline void nfs4_init_once(struct nfs_inode *nfsi)\n{\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tINIT_LIST_HEAD(&nfsi->open_states);\n\tnfsi->delegation = NULL;\n\tinit_rwsem(&nfsi->rwsem);\n\tnfsi->layout = NULL;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_waitqueue_head",
          "args": [
            "&nfsi->waitqueue"
          ],
          "line": 1870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_HEAD",
          "args": [
            "&nfsi->silly_list"
          ],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&nfsi->silly_count",
            "1"
          ],
          "line": 1868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&nfsi->commit_info.rpcs_out",
            "0"
          ],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nfsi->commit_info.list"
          ],
          "line": 1864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nfsi->access_cache_inode_lru"
          ],
          "line": 1863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nfsi->access_cache_entry_lru"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nfsi->open_files"
          ],
          "line": 1861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_init_once",
          "args": [
            "&nfsi->vfs_inode"
          ],
          "line": 1860
        },
        "resolved": true,
        "details": {
          "function_name": "inode_init_once",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "355-367",
          "snippet": "void inode_init_once(struct inode *inode)\n{\n\tmemset(inode, 0, sizeof(*inode));\n\tINIT_HLIST_NODE(&inode->i_hash);\n\tINIT_LIST_HEAD(&inode->i_devices);\n\tINIT_LIST_HEAD(&inode->i_wb_list);\n\tINIT_LIST_HEAD(&inode->i_lru);\n\taddress_space_init_once(&inode->i_data);\n\ti_size_ordered_init(inode);\n#ifdef CONFIG_FSNOTIFY\n\tINIT_HLIST_HEAD(&inode->i_fsnotify_marks);\n#endif\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid inode_init_once(struct inode *inode)\n{\n\tmemset(inode, 0, sizeof(*inode));\n\tINIT_HLIST_NODE(&inode->i_hash);\n\tINIT_LIST_HEAD(&inode->i_devices);\n\tINIT_LIST_HEAD(&inode->i_wb_list);\n\tINIT_LIST_HEAD(&inode->i_lru);\n\taddress_space_init_once(&inode->i_data);\n\ti_size_ordered_init(inode);\n#ifdef CONFIG_FSNOTIFY\n\tINIT_HLIST_HEAD(&inode->i_fsnotify_marks);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void init_once(void *foo)\n{\n\tstruct nfs_inode *nfsi = (struct nfs_inode *) foo;\n\n\tinode_init_once(&nfsi->vfs_inode);\n\tINIT_LIST_HEAD(&nfsi->open_files);\n\tINIT_LIST_HEAD(&nfsi->access_cache_entry_lru);\n\tINIT_LIST_HEAD(&nfsi->access_cache_inode_lru);\n\tINIT_LIST_HEAD(&nfsi->commit_info.list);\n\tnfsi->nrequests = 0;\n\tnfsi->commit_info.ncommit = 0;\n\tatomic_set(&nfsi->commit_info.rpcs_out, 0);\n\tatomic_set(&nfsi->silly_count, 1);\n\tINIT_HLIST_HEAD(&nfsi->silly_list);\n\tinit_waitqueue_head(&nfsi->waitqueue);\n\tnfs4_init_once(nfsi);\n}"
  },
  {
    "function_name": "nfs4_init_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1846-1854",
    "snippet": "static inline void nfs4_init_once(struct nfs_inode *nfsi)\n{\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tINIT_LIST_HEAD(&nfsi->open_states);\n\tnfsi->delegation = NULL;\n\tinit_rwsem(&nfsi->rwsem);\n\tnfsi->layout = NULL;\n#endif\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_rwsem",
          "args": [
            "&nfsi->rwsem"
          ],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nfsi->open_states"
          ],
          "line": 1849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NFS_V4"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic inline void nfs4_init_once(struct nfs_inode *nfsi)\n{\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tINIT_LIST_HEAD(&nfsi->open_states);\n\tnfsi->delegation = NULL;\n\tinit_rwsem(&nfsi->rwsem);\n\tnfsi->layout = NULL;\n#endif\n}"
  },
  {
    "function_name": "nfs_destroy_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1840-1843",
    "snippet": "void nfs_destroy_inode(struct inode *inode)\n{\n\tcall_rcu(&inode->i_rcu, nfs_i_callback);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_rcu",
          "args": [
            "&inode->i_rcu",
            "nfs_i_callback"
          ],
          "line": 1842
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_destroy_inode(struct inode *inode)\n{\n\tcall_rcu(&inode->i_rcu, nfs_i_callback);\n}"
  },
  {
    "function_name": "nfs_i_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1834-1838",
    "snippet": "static void nfs_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tkmem_cache_free(nfs_inode_cachep, NFS_I(inode));\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static struct kmem_cache * nfs_inode_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "nfs_inode_cachep",
            "NFS_I(inode)"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "head",
            "structinode",
            "i_rcu"
          ],
          "line": 1836
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstatic void nfs_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tkmem_cache_free(nfs_inode_cachep, NFS_I(inode));\n}"
  },
  {
    "function_name": "nfs_alloc_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1819-1831",
    "snippet": "struct inode *nfs_alloc_inode(struct super_block *sb)\n{\n\tstruct nfs_inode *nfsi;\n\tnfsi = (struct nfs_inode *)kmem_cache_alloc(nfs_inode_cachep, GFP_KERNEL);\n\tif (!nfsi)\n\t\treturn NULL;\n\tnfsi->flags = 0UL;\n\tnfsi->cache_validity = 0UL;\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tnfsi->nfs4_acl = NULL;\n#endif /* CONFIG_NFS_V4 */\n\treturn &nfsi->vfs_inode;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static struct kmem_cache * nfs_inode_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NFS_V4"
          ],
          "line": 1827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "nfs_inode_cachep",
            "GFP_KERNEL"
          ],
          "line": 1822
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic struct kmem_cache * nfs_inode_cachep;\n\nstruct inode *nfs_alloc_inode(struct super_block *sb)\n{\n\tstruct nfs_inode *nfsi;\n\tnfsi = (struct nfs_inode *)kmem_cache_alloc(nfs_inode_cachep, GFP_KERNEL);\n\tif (!nfsi)\n\t\treturn NULL;\n\tnfsi->flags = 0UL;\n\tnfsi->cache_validity = 0UL;\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tnfsi->nfs4_acl = NULL;\n#endif /* CONFIG_NFS_V4 */\n\treturn &nfsi->vfs_inode;\n}"
  },
  {
    "function_name": "nfs_update_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1603-1817",
    "snippet": "static int nfs_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_isize, new_isize;\n\tunsigned long invalid = 0;\n\tunsigned long now = jiffies;\n\tunsigned long save_cache_validity;\n\n\tdfprintk(VFS, \"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\",\n\t\t\t__func__, inode->i_sb->s_id, inode->i_ino,\n\t\t\tnfs_display_fhandle_hash(NFS_FH(inode)),\n\t\t\tatomic_read(&inode->i_count), fattr->valid);\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid) {\n\t\tprintk(KERN_ERR \"NFS: server %s error: fileid changed\\n\"\n\t\t\t\"fsid %s: expected fileid 0x%Lx, got 0x%Lx\\n\",\n\t\t\tNFS_SERVER(inode)->nfs_client->cl_hostname,\n\t\t\tinode->i_sb->s_id, (long long)nfsi->fileid,\n\t\t\t(long long)fattr->fileid);\n\t\tgoto out_err;\n\t}\n\n\t/*\n\t * Make sure the inode's type hasn't changed.\n\t */\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT)) {\n\t\t/*\n\t\t* Big trouble! The inode has become a different object.\n\t\t*/\n\t\tprintk(KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\",\n\t\t\t\t__func__, inode->i_ino, inode->i_mode, fattr->mode);\n\t\tgoto out_err;\n\t}\n\n\tserver = NFS_SERVER(inode);\n\t/* Update the fsid? */\n\tif (S_ISDIR(inode->i_mode) && (fattr->valid & NFS_ATTR_FATTR_FSID) &&\n\t\t\t!nfs_fsid_equal(&server->fsid, &fattr->fsid) &&\n\t\t\t!IS_AUTOMOUNT(inode))\n\t\tserver->fsid = fattr->fsid;\n\n\t/*\n\t * Update the read time so we don't revalidate too often.\n\t */\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\n\tsave_cache_validity = nfsi->cache_validity;\n\tnfsi->cache_validity &= ~(NFS_INO_INVALID_ATTR\n\t\t\t| NFS_INO_INVALID_ATIME\n\t\t\t| NFS_INO_REVAL_FORCED\n\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\n\t/* Do atomic weak cache consistency updates */\n\tinvalid |= nfs_wcc_update_inode(inode, fattr);\n\n\t/* More cache consistency checks */\n\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE) {\n\t\tif (inode->i_version != fattr->change_attr) {\n\t\t\tdprintk(\"NFS: change_attr change on server for file %s/%ld\\n\",\n\t\t\t\t\tinode->i_sb->s_id, inode->i_ino);\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tnfs_force_lookup_revalidate(inode);\n\t\t\tinode->i_version = fattr->change_attr;\n\t\t}\n\t} else if (server->caps & NFS_CAP_CHANGE_ATTR)\n\t\tnfsi->cache_validity |= save_cache_validity;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MTIME) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t} else if (server->caps & NFS_CAP_MTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_CTIME) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t} else if (server->caps & NFS_CAP_CTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\t/* Check if our cached file size is stale */\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tcur_isize = i_size_read(inode);\n\t\tif (new_isize != cur_isize) {\n\t\t\t/* Do we perhaps have any outstanding writes, or has\n\t\t\t * the file grown beyond our last write? */\n\t\t\tif ((nfsi->nrequests == 0) || new_isize > cur_isize) {\n\t\t\t\ti_size_write(inode, new_isize);\n\t\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_DATA;\n\t\t\t\tinvalid &= ~NFS_INO_REVAL_PAGECACHE;\n\t\t\t}\n\t\t\tdprintk(\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\",\n\t\t\t\t\tinode->i_sb->s_id,\n\t\t\t\t\tinode->i_ino,\n\t\t\t\t\t(long long)cur_isize,\n\t\t\t\t\t(long long)new_isize);\n\t\t}\n\t} else\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\n\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\tmemcpy(&inode->i_atime, &fattr->atime, sizeof(inode->i_atime));\n\telse if (server->caps & NFS_CAP_ATIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATIME\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MODE) {\n\t\tif ((inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO)) {\n\t\t\tumode_t newmode = inode->i_mode & S_IFMT;\n\t\t\tnewmode |= fattr->mode & S_IALLUGO;\n\t\t\tinode->i_mode = newmode;\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t}\n\t} else if (server->caps & NFS_CAP_MODE)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER) {\n\t\tif (!uid_eq(inode->i_uid, fattr->uid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_uid = fattr->uid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP) {\n\t\tif (!gid_eq(inode->i_gid, fattr->gid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_gid = fattr->gid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER_GROUP)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_NLINK) {\n\t\tif (inode->i_nlink != fattr->nlink) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tinvalid |= NFS_INO_INVALID_DATA;\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\t}\n\t} else if (server->caps & NFS_CAP_NLINK)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t/*\n\t\t * report the blocks in 512byte units\n\t\t */\n\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n \t}\n\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\n\t/* Update attrtimeo value if we're out of the unstable period */\n\tif (invalid & NFS_INO_INVALID_ATTR) {\n\t\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\t/* Set barrier to be more recent than all outstanding updates */\n\t\tnfsi->attr_gencount = nfs_inc_attr_generation_counter();\n\t} else {\n\t\tif (!time_in_range_open(now, nfsi->attrtimeo_timestamp, nfsi->attrtimeo_timestamp + nfsi->attrtimeo)) {\n\t\t\tif ((nfsi->attrtimeo <<= 1) > NFS_MAXATTRTIMEO(inode))\n\t\t\t\tnfsi->attrtimeo = NFS_MAXATTRTIMEO(inode);\n\t\t\tnfsi->attrtimeo_timestamp = now;\n\t\t}\n\t\t/* Set the barrier to be more recent than this fattr */\n\t\tif ((long)fattr->gencount - (long)nfsi->attr_gencount > 0)\n\t\t\tnfsi->attr_gencount = fattr->gencount;\n\t}\n\tinvalid &= ~NFS_INO_INVALID_ATTR;\n\t/* Don't invalidate the data if we were to blame */\n\tif (!(S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode)\n\t\t\t\t|| S_ISLNK(inode->i_mode)))\n\t\tinvalid &= ~NFS_INO_INVALID_DATA;\n\tif (!NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) ||\n\t\t\t(save_cache_validity & NFS_INO_REVAL_FORCED))\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\treturn 0;\n out_err:\n\t/*\n\t * No need to worry about unhashing the dentry, as the\n\t * lookup validation will know that the inode is bad.\n\t * (But we fall through to invalidate the caches.)\n\t */\n\tnfs_invalidate_inode(inode);\n\treturn -ESTALE;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_invalidate_inode",
          "args": [
            "inode"
          ],
          "line": 1815
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_invalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "231-235",
          "snippet": "static void nfs_invalidate_inode(struct inode *inode)\n{\n\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\tnfs_zap_caches_locked(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_invalidate_inode(struct inode *inode)\n{\n\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\tnfs_zap_caches_locked(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "invalid"
          ],
          "line": 1806
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode",
            "FMODE_READ"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "inode->i_mode"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 1801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_MAXATTRTIMEO",
          "args": [
            "inode"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_MAXATTRTIMEO",
          "args": [
            "inode"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time_in_range_open",
          "args": [
            "now",
            "nfsi->attrtimeo_timestamp",
            "nfsi->attrtimeo_timestamp + nfsi->attrtimeo"
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inc_attr_generation_counter",
          "args": [],
          "line": 1788
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_attr_generation_counter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1280-1283",
          "snippet": "unsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_long_t nfs_attr_generation_counter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic atomic_long_t nfs_attr_generation_counter;\n\nunsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_MINATTRTIMEO",
          "args": [
            "inode"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_ATTRINVALIDATE"
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_calc_block_size",
          "args": [
            "fattr->du.nfs3.used"
          ],
          "line": 1777
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_calc_block_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "570-574",
          "snippet": "static inline blkcnt_t nfs_calc_block_size(u64 tsize)\n{\n\tblkcnt_t used = (tsize + 511) >> 9;\n\treturn (used > ULONG_MAX) ? ULONG_MAX : used;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline blkcnt_t nfs_calc_block_size(u64 tsize)\n{\n\tblkcnt_t used = (tsize + 511) >> 9;\n\treturn (used > ULONG_MAX) ? ULONG_MAX : used;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_nlink",
          "args": [
            "inode",
            "fattr->nlink"
          ],
          "line": 1766
        },
        "resolved": true,
        "details": {
          "function_name": "set_nlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "305-316",
          "snippet": "void set_nlink(struct inode *inode, unsigned int nlink)\n{\n\tif (!nlink) {\n\t\tclear_nlink(inode);\n\t} else {\n\t\t/* Yes, some filesystems do change nlink from zero to one */\n\t\tif (inode->i_nlink == 0)\n\t\t\tatomic_long_dec(&inode->i_sb->s_remove_count);\n\n\t\tinode->__i_nlink = nlink;\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid set_nlink(struct inode *inode, unsigned int nlink)\n{\n\tif (!nlink) {\n\t\tclear_nlink(inode);\n\t} else {\n\t\t/* Yes, some filesystems do change nlink from zero to one */\n\t\tif (inode->i_nlink == 0)\n\t\t\tatomic_long_dec(&inode->i_sb->s_remove_count);\n\n\t\tinode->__i_nlink = nlink;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "inode->i_gid",
            "fattr->gid"
          ],
          "line": 1750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "inode->i_uid",
            "fattr->uid"
          ],
          "line": 1738
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&inode->i_atime",
            "&fattr->atime",
            "sizeof(inode->i_atime)"
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\"",
            "inode->i_sb->s_id",
            "inode->i_ino",
            "(long long)cur_isize",
            "(long long)new_isize"
          ],
          "line": 1702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "new_isize"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_size_to_loff_t",
          "args": [
            "fattr->size"
          ],
          "line": 1692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&inode->i_ctime",
            "&fattr->ctime",
            "sizeof(inode->i_ctime)"
          ],
          "line": 1684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&inode->i_mtime",
            "&fattr->mtime",
            "sizeof(inode->i_mtime)"
          ],
          "line": 1677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_force_lookup_revalidate",
          "args": [
            "inode"
          ],
          "line": 1670
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_force_lookup_revalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "996-999",
          "snippet": "void nfs_force_lookup_revalidate(struct inode *dir)\n{\n\tNFS_I(dir)->cache_change_attribute++;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nvoid nfs_force_lookup_revalidate(struct inode *dir)\n{\n\tNFS_I(dir)->cache_change_attribute++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: change_attr change on server for file %s/%ld\\n\"",
            "inode->i_sb->s_id",
            "inode->i_ino"
          ],
          "line": 1662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_wcc_update_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1657
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wcc_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1165-1203",
          "snippet": "static unsigned long nfs_wcc_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long ret = 0;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECHANGE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CHANGE)\n\t\t\t&& inode->i_version == fattr->pre_change_attr) {\n\t\tinode->i_version = fattr->change_attr;\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\t/* If we have atomic WCC data, we may update some attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CTIME)\n\t\t\t&& timespec_equal(&inode->i_ctime, &fattr->pre_ctime)) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PREMTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_MTIME)\n\t\t\t&& timespec_equal(&inode->i_mtime, &fattr->pre_mtime)) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRESIZE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_SIZE)\n\t\t\t&& i_size_read(inode) == nfs_size_to_loff_t(fattr->pre_size)\n\t\t\t&& nfsi->nrequests == 0) {\n\t\ti_size_write(inode, nfs_size_to_loff_t(fattr->size));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic unsigned long nfs_wcc_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long ret = 0;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECHANGE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CHANGE)\n\t\t\t&& inode->i_version == fattr->pre_change_attr) {\n\t\tinode->i_version = fattr->change_attr;\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\t/* If we have atomic WCC data, we may update some attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CTIME)\n\t\t\t&& timespec_equal(&inode->i_ctime, &fattr->pre_ctime)) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PREMTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_MTIME)\n\t\t\t&& timespec_equal(&inode->i_mtime, &fattr->pre_mtime)) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRESIZE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_SIZE)\n\t\t\t&& i_size_read(inode) == nfs_size_to_loff_t(fattr->pre_size)\n\t\t\t&& nfsi->nrequests == 0) {\n\t\ti_size_write(inode, nfs_size_to_loff_t(fattr->size));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_AUTOMOUNT",
          "args": [
            "inode"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fsid_equal",
          "args": [
            "&server->fsid",
            "&fattr->fsid"
          ],
          "line": 1641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 1638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\"",
            "__func__",
            "inode->i_ino",
            "inode->i_mode",
            "fattr->mode"
          ],
          "line": 1633
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "VFS",
            "\"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\"",
            "__func__",
            "inode->i_sb->s_id",
            "inode->i_ino",
            "nfs_display_fhandle_hash(NFS_FH(inode))",
            "atomic_read(&inode->i_count)",
            "fattr->valid"
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&inode->i_count"
          ],
          "line": 1615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_display_fhandle_hash",
          "args": [
            "NFS_FH(inode)"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "_nfs_display_fhandle_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1343-1348",
          "snippet": "u32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nu32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_isize, new_isize;\n\tunsigned long invalid = 0;\n\tunsigned long now = jiffies;\n\tunsigned long save_cache_validity;\n\n\tdfprintk(VFS, \"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\",\n\t\t\t__func__, inode->i_sb->s_id, inode->i_ino,\n\t\t\tnfs_display_fhandle_hash(NFS_FH(inode)),\n\t\t\tatomic_read(&inode->i_count), fattr->valid);\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid) {\n\t\tprintk(KERN_ERR \"NFS: server %s error: fileid changed\\n\"\n\t\t\t\"fsid %s: expected fileid 0x%Lx, got 0x%Lx\\n\",\n\t\t\tNFS_SERVER(inode)->nfs_client->cl_hostname,\n\t\t\tinode->i_sb->s_id, (long long)nfsi->fileid,\n\t\t\t(long long)fattr->fileid);\n\t\tgoto out_err;\n\t}\n\n\t/*\n\t * Make sure the inode's type hasn't changed.\n\t */\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT)) {\n\t\t/*\n\t\t* Big trouble! The inode has become a different object.\n\t\t*/\n\t\tprintk(KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\",\n\t\t\t\t__func__, inode->i_ino, inode->i_mode, fattr->mode);\n\t\tgoto out_err;\n\t}\n\n\tserver = NFS_SERVER(inode);\n\t/* Update the fsid? */\n\tif (S_ISDIR(inode->i_mode) && (fattr->valid & NFS_ATTR_FATTR_FSID) &&\n\t\t\t!nfs_fsid_equal(&server->fsid, &fattr->fsid) &&\n\t\t\t!IS_AUTOMOUNT(inode))\n\t\tserver->fsid = fattr->fsid;\n\n\t/*\n\t * Update the read time so we don't revalidate too often.\n\t */\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\n\tsave_cache_validity = nfsi->cache_validity;\n\tnfsi->cache_validity &= ~(NFS_INO_INVALID_ATTR\n\t\t\t| NFS_INO_INVALID_ATIME\n\t\t\t| NFS_INO_REVAL_FORCED\n\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\n\t/* Do atomic weak cache consistency updates */\n\tinvalid |= nfs_wcc_update_inode(inode, fattr);\n\n\t/* More cache consistency checks */\n\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE) {\n\t\tif (inode->i_version != fattr->change_attr) {\n\t\t\tdprintk(\"NFS: change_attr change on server for file %s/%ld\\n\",\n\t\t\t\t\tinode->i_sb->s_id, inode->i_ino);\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tnfs_force_lookup_revalidate(inode);\n\t\t\tinode->i_version = fattr->change_attr;\n\t\t}\n\t} else if (server->caps & NFS_CAP_CHANGE_ATTR)\n\t\tnfsi->cache_validity |= save_cache_validity;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MTIME) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t} else if (server->caps & NFS_CAP_MTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_CTIME) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t} else if (server->caps & NFS_CAP_CTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\t/* Check if our cached file size is stale */\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tcur_isize = i_size_read(inode);\n\t\tif (new_isize != cur_isize) {\n\t\t\t/* Do we perhaps have any outstanding writes, or has\n\t\t\t * the file grown beyond our last write? */\n\t\t\tif ((nfsi->nrequests == 0) || new_isize > cur_isize) {\n\t\t\t\ti_size_write(inode, new_isize);\n\t\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_DATA;\n\t\t\t\tinvalid &= ~NFS_INO_REVAL_PAGECACHE;\n\t\t\t}\n\t\t\tdprintk(\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\",\n\t\t\t\t\tinode->i_sb->s_id,\n\t\t\t\t\tinode->i_ino,\n\t\t\t\t\t(long long)cur_isize,\n\t\t\t\t\t(long long)new_isize);\n\t\t}\n\t} else\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\n\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\tmemcpy(&inode->i_atime, &fattr->atime, sizeof(inode->i_atime));\n\telse if (server->caps & NFS_CAP_ATIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATIME\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MODE) {\n\t\tif ((inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO)) {\n\t\t\tumode_t newmode = inode->i_mode & S_IFMT;\n\t\t\tnewmode |= fattr->mode & S_IALLUGO;\n\t\t\tinode->i_mode = newmode;\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t}\n\t} else if (server->caps & NFS_CAP_MODE)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER) {\n\t\tif (!uid_eq(inode->i_uid, fattr->uid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_uid = fattr->uid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP) {\n\t\tif (!gid_eq(inode->i_gid, fattr->gid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_gid = fattr->gid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER_GROUP)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_NLINK) {\n\t\tif (inode->i_nlink != fattr->nlink) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tinvalid |= NFS_INO_INVALID_DATA;\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\t}\n\t} else if (server->caps & NFS_CAP_NLINK)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t/*\n\t\t * report the blocks in 512byte units\n\t\t */\n\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n \t}\n\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\n\t/* Update attrtimeo value if we're out of the unstable period */\n\tif (invalid & NFS_INO_INVALID_ATTR) {\n\t\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\t/* Set barrier to be more recent than all outstanding updates */\n\t\tnfsi->attr_gencount = nfs_inc_attr_generation_counter();\n\t} else {\n\t\tif (!time_in_range_open(now, nfsi->attrtimeo_timestamp, nfsi->attrtimeo_timestamp + nfsi->attrtimeo)) {\n\t\t\tif ((nfsi->attrtimeo <<= 1) > NFS_MAXATTRTIMEO(inode))\n\t\t\t\tnfsi->attrtimeo = NFS_MAXATTRTIMEO(inode);\n\t\t\tnfsi->attrtimeo_timestamp = now;\n\t\t}\n\t\t/* Set the barrier to be more recent than this fattr */\n\t\tif ((long)fattr->gencount - (long)nfsi->attr_gencount > 0)\n\t\t\tnfsi->attr_gencount = fattr->gencount;\n\t}\n\tinvalid &= ~NFS_INO_INVALID_ATTR;\n\t/* Don't invalidate the data if we were to blame */\n\tif (!(S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode)\n\t\t\t\t|| S_ISLNK(inode->i_mode)))\n\t\tinvalid &= ~NFS_INO_INVALID_DATA;\n\tif (!NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) ||\n\t\t\t(save_cache_validity & NFS_INO_REVAL_FORCED))\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\treturn 0;\n out_err:\n\t/*\n\t * No need to worry about unhashing the dentry, as the\n\t * lookup validation will know that the inode is bad.\n\t * (But we fall through to invalidate the caches.)\n\t */\n\tnfs_invalidate_inode(inode);\n\treturn -ESTALE;\n}"
  },
  {
    "function_name": "nfs_post_op_update_inode_force_wcc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1579-1588",
    "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode_force_wcc_locked",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1585
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1530-1566",
          "snippet": "int nfs_post_op_update_inode_force_wcc_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\t/* Don't do a WCC update if these attributes are already stale */\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0 ||\n\t\t\t!nfs_inode_attrs_need_update(inode, fattr)) {\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_PRECHANGE\n\t\t\t\t| NFS_ATTR_FATTR_PRESIZE\n\t\t\t\t| NFS_ATTR_FATTR_PREMTIME\n\t\t\t\t| NFS_ATTR_FATTR_PRECTIME);\n\t\tgoto out_noforce;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECHANGE) == 0) {\n\t\tfattr->pre_change_attr = inode->i_version;\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECHANGE;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECTIME) == 0) {\n\t\tmemcpy(&fattr->pre_ctime, &inode->i_ctime, sizeof(fattr->pre_ctime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PREMTIME) == 0) {\n\t\tmemcpy(&fattr->pre_mtime, &inode->i_mtime, sizeof(fattr->pre_mtime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PREMTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_SIZE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRESIZE) == 0) {\n\t\tfattr->pre_size = i_size_read(inode);\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRESIZE;\n\t}\nout_noforce:\n\tstatus = nfs_post_op_update_inode_locked(inode, fattr);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\t/* Don't do a WCC update if these attributes are already stale */\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0 ||\n\t\t\t!nfs_inode_attrs_need_update(inode, fattr)) {\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_PRECHANGE\n\t\t\t\t| NFS_ATTR_FATTR_PRESIZE\n\t\t\t\t| NFS_ATTR_FATTR_PREMTIME\n\t\t\t\t| NFS_ATTR_FATTR_PRECTIME);\n\t\tgoto out_noforce;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECHANGE) == 0) {\n\t\tfattr->pre_change_attr = inode->i_version;\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECHANGE;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECTIME) == 0) {\n\t\tmemcpy(&fattr->pre_ctime, &inode->i_ctime, sizeof(fattr->pre_ctime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PREMTIME) == 0) {\n\t\tmemcpy(&fattr->pre_mtime, &inode->i_mtime, sizeof(fattr->pre_mtime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PREMTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_SIZE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRESIZE) == 0) {\n\t\tfattr->pre_size = i_size_read(inode);\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRESIZE;\n\t}\nout_noforce:\n\tstatus = nfs_post_op_update_inode_locked(inode, fattr);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_set_barrier",
          "args": [
            "fattr"
          ],
          "line": 1584
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_set_barrier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1307-1310",
          "snippet": "void nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1583
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_post_op_update_inode_force_wcc_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1530-1566",
    "snippet": "int nfs_post_op_update_inode_force_wcc_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\t/* Don't do a WCC update if these attributes are already stale */\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0 ||\n\t\t\t!nfs_inode_attrs_need_update(inode, fattr)) {\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_PRECHANGE\n\t\t\t\t| NFS_ATTR_FATTR_PRESIZE\n\t\t\t\t| NFS_ATTR_FATTR_PREMTIME\n\t\t\t\t| NFS_ATTR_FATTR_PRECTIME);\n\t\tgoto out_noforce;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECHANGE) == 0) {\n\t\tfattr->pre_change_attr = inode->i_version;\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECHANGE;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECTIME) == 0) {\n\t\tmemcpy(&fattr->pre_ctime, &inode->i_ctime, sizeof(fattr->pre_ctime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PREMTIME) == 0) {\n\t\tmemcpy(&fattr->pre_mtime, &inode->i_mtime, sizeof(fattr->pre_mtime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PREMTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_SIZE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRESIZE) == 0) {\n\t\tfattr->pre_size = i_size_read(inode);\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRESIZE;\n\t}\nout_noforce:\n\tstatus = nfs_post_op_update_inode_locked(inode, fattr);\n\treturn status;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode_locked",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1480-1490",
          "snippet": "static int nfs_post_op_update_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tunsigned long invalid = NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\tif (S_ISDIR(inode->i_mode))\n\t\tinvalid |= NFS_INO_INVALID_DATA;\n\tnfs_set_cache_invalid(inode, invalid);\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\treturn nfs_refresh_inode_locked(inode, fattr);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_post_op_update_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tunsigned long invalid = NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\tif (S_ISDIR(inode->i_mode))\n\t\tinvalid |= NFS_INO_INVALID_DATA;\n\tnfs_set_cache_invalid(inode, invalid);\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\treturn nfs_refresh_inode_locked(inode, fattr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&fattr->pre_mtime",
            "&inode->i_mtime",
            "sizeof(fattr->pre_mtime)"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&fattr->pre_ctime",
            "&inode->i_ctime",
            "sizeof(fattr->pre_ctime)"
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inode_attrs_need_update",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1536
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_attrs_need_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1416-1423",
          "snippet": "static int nfs_inode_attrs_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tconst struct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn ((long)fattr->gencount - (long)nfsi->attr_gencount) > 0 ||\n\t\tnfs_ctime_need_update(inode, fattr) ||\n\t\t((long)nfsi->attr_gencount - (long)nfs_read_attr_generation_counter() > 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_inode_attrs_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tconst struct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn ((long)fattr->gencount - (long)nfsi->attr_gencount) > 0 ||\n\t\tnfs_ctime_need_update(inode, fattr) ||\n\t\t((long)nfsi->attr_gencount - (long)nfs_read_attr_generation_counter() > 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\t/* Don't do a WCC update if these attributes are already stale */\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0 ||\n\t\t\t!nfs_inode_attrs_need_update(inode, fattr)) {\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_PRECHANGE\n\t\t\t\t| NFS_ATTR_FATTR_PRESIZE\n\t\t\t\t| NFS_ATTR_FATTR_PREMTIME\n\t\t\t\t| NFS_ATTR_FATTR_PRECTIME);\n\t\tgoto out_noforce;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECHANGE) == 0) {\n\t\tfattr->pre_change_attr = inode->i_version;\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECHANGE;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_CTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRECTIME) == 0) {\n\t\tmemcpy(&fattr->pre_ctime, &inode->i_ctime, sizeof(fattr->pre_ctime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRECTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PREMTIME) == 0) {\n\t\tmemcpy(&fattr->pre_mtime, &inode->i_mtime, sizeof(fattr->pre_mtime));\n\t\tfattr->valid |= NFS_ATTR_FATTR_PREMTIME;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_SIZE) != 0 &&\n\t\t\t(fattr->valid & NFS_ATTR_FATTR_PRESIZE) == 0) {\n\t\tfattr->pre_size = i_size_read(inode);\n\t\tfattr->valid |= NFS_ATTR_FATTR_PRESIZE;\n\t}\nout_noforce:\n\tstatus = nfs_post_op_update_inode_locked(inode, fattr);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_post_op_update_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1506-1516",
    "snippet": "int nfs_post_op_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode_locked",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1480-1490",
          "snippet": "static int nfs_post_op_update_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tunsigned long invalid = NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\tif (S_ISDIR(inode->i_mode))\n\t\tinvalid |= NFS_INO_INVALID_DATA;\n\tnfs_set_cache_invalid(inode, invalid);\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\treturn nfs_refresh_inode_locked(inode, fattr);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_post_op_update_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tunsigned long invalid = NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\tif (S_ISDIR(inode->i_mode))\n\t\tinvalid |= NFS_INO_INVALID_DATA;\n\tnfs_set_cache_invalid(inode, invalid);\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\treturn nfs_refresh_inode_locked(inode, fattr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_set_barrier",
          "args": [
            "fattr"
          ],
          "line": 1511
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_set_barrier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1307-1310",
          "snippet": "void nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1510
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_post_op_update_inode_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1480-1490",
    "snippet": "static int nfs_post_op_update_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tunsigned long invalid = NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\tif (S_ISDIR(inode->i_mode))\n\t\tinvalid |= NFS_INO_INVALID_DATA;\n\tnfs_set_cache_invalid(inode, invalid);\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\treturn nfs_refresh_inode_locked(inode, fattr);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_refresh_inode_locked",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1489
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1439-1454",
          "snippet": "static int nfs_refresh_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint ret;\n\n\ttrace_nfs_refresh_inode_enter(inode);\n\n\tnfs_inode_attrs_handle_layoutcommit(inode, fattr);\n\n\tif (nfs_inode_attrs_need_update(inode, fattr))\n\t\tret = nfs_update_inode(inode, fattr);\n\telse\n\t\tret = nfs_check_inode_attributes(inode, fattr);\n\n\ttrace_nfs_refresh_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_refresh_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint ret;\n\n\ttrace_nfs_refresh_inode_enter(inode);\n\n\tnfs_inode_attrs_handle_layoutcommit(inode, fattr);\n\n\tif (nfs_inode_attrs_need_update(inode, fattr))\n\t\tret = nfs_update_inode(inode, fattr);\n\telse\n\t\tret = nfs_check_inode_attributes(inode, fattr);\n\n\ttrace_nfs_refresh_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "invalid"
          ],
          "line": 1486
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_post_op_update_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tunsigned long invalid = NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\tif (S_ISDIR(inode->i_mode))\n\t\tinvalid |= NFS_INO_INVALID_DATA;\n\tnfs_set_cache_invalid(inode, invalid);\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\treturn nfs_refresh_inode_locked(inode, fattr);\n}"
  },
  {
    "function_name": "nfs_refresh_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1466-1477",
    "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1474
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode_locked",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1473
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1439-1454",
          "snippet": "static int nfs_refresh_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint ret;\n\n\ttrace_nfs_refresh_inode_enter(inode);\n\n\tnfs_inode_attrs_handle_layoutcommit(inode, fattr);\n\n\tif (nfs_inode_attrs_need_update(inode, fattr))\n\t\tret = nfs_update_inode(inode, fattr);\n\telse\n\t\tret = nfs_check_inode_attributes(inode, fattr);\n\n\ttrace_nfs_refresh_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_refresh_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint ret;\n\n\ttrace_nfs_refresh_inode_enter(inode);\n\n\tnfs_inode_attrs_handle_layoutcommit(inode, fattr);\n\n\tif (nfs_inode_attrs_need_update(inode, fattr))\n\t\tret = nfs_update_inode(inode, fattr);\n\telse\n\t\tret = nfs_check_inode_attributes(inode, fattr);\n\n\ttrace_nfs_refresh_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_refresh_inode_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1439-1454",
    "snippet": "static int nfs_refresh_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint ret;\n\n\ttrace_nfs_refresh_inode_enter(inode);\n\n\tnfs_inode_attrs_handle_layoutcommit(inode, fattr);\n\n\tif (nfs_inode_attrs_need_update(inode, fattr))\n\t\tret = nfs_update_inode(inode, fattr);\n\telse\n\t\tret = nfs_check_inode_attributes(inode, fattr);\n\n\ttrace_nfs_refresh_inode_exit(inode, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs_refresh_inode_exit",
          "args": [
            "inode",
            "ret"
          ],
          "line": 1452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_check_inode_attributes",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1450
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_check_inode_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1214-1264",
          "snippet": "static int nfs_check_inode_attributes(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_size, new_isize;\n\tunsigned long invalid = 0;\n\n\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\t/* Has the inode gone and changed behind our back? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid)\n\t\treturn -EIO;\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT))\n\t\treturn -EIO;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\tinode->i_version != fattr->change_attr)\n\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\t/* Verify a few of the more important attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) && !timespec_equal(&inode->i_mtime, &fattr->mtime))\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tcur_size = i_size_read(inode);\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tif (cur_size != new_isize && nfsi->nrequests == 0)\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\t}\n\n\t/* Have any file permissions changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MODE) && (inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_OWNER) && !uid_eq(inode->i_uid, fattr->uid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_GROUP) && !gid_eq(inode->i_gid, fattr->gid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\n\t/* Has the link count changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_NLINK) && inode->i_nlink != fattr->nlink)\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_ATIME) && !timespec_equal(&inode->i_atime, &fattr->atime))\n\t\tinvalid |= NFS_INO_INVALID_ATIME;\n\n\tif (invalid != 0)\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\treturn 0;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_check_inode_attributes(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_size, new_isize;\n\tunsigned long invalid = 0;\n\n\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\t/* Has the inode gone and changed behind our back? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid)\n\t\treturn -EIO;\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT))\n\t\treturn -EIO;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\tinode->i_version != fattr->change_attr)\n\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\t/* Verify a few of the more important attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) && !timespec_equal(&inode->i_mtime, &fattr->mtime))\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tcur_size = i_size_read(inode);\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tif (cur_size != new_isize && nfsi->nrequests == 0)\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\t}\n\n\t/* Have any file permissions changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MODE) && (inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_OWNER) && !uid_eq(inode->i_uid, fattr->uid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_GROUP) && !gid_eq(inode->i_gid, fattr->gid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\n\t/* Has the link count changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_NLINK) && inode->i_nlink != fattr->nlink)\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_ATIME) && !timespec_equal(&inode->i_atime, &fattr->atime))\n\t\tinvalid |= NFS_INO_INVALID_ATIME;\n\n\tif (invalid != 0)\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_update_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1603-1817",
          "snippet": "static int nfs_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_isize, new_isize;\n\tunsigned long invalid = 0;\n\tunsigned long now = jiffies;\n\tunsigned long save_cache_validity;\n\n\tdfprintk(VFS, \"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\",\n\t\t\t__func__, inode->i_sb->s_id, inode->i_ino,\n\t\t\tnfs_display_fhandle_hash(NFS_FH(inode)),\n\t\t\tatomic_read(&inode->i_count), fattr->valid);\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid) {\n\t\tprintk(KERN_ERR \"NFS: server %s error: fileid changed\\n\"\n\t\t\t\"fsid %s: expected fileid 0x%Lx, got 0x%Lx\\n\",\n\t\t\tNFS_SERVER(inode)->nfs_client->cl_hostname,\n\t\t\tinode->i_sb->s_id, (long long)nfsi->fileid,\n\t\t\t(long long)fattr->fileid);\n\t\tgoto out_err;\n\t}\n\n\t/*\n\t * Make sure the inode's type hasn't changed.\n\t */\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT)) {\n\t\t/*\n\t\t* Big trouble! The inode has become a different object.\n\t\t*/\n\t\tprintk(KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\",\n\t\t\t\t__func__, inode->i_ino, inode->i_mode, fattr->mode);\n\t\tgoto out_err;\n\t}\n\n\tserver = NFS_SERVER(inode);\n\t/* Update the fsid? */\n\tif (S_ISDIR(inode->i_mode) && (fattr->valid & NFS_ATTR_FATTR_FSID) &&\n\t\t\t!nfs_fsid_equal(&server->fsid, &fattr->fsid) &&\n\t\t\t!IS_AUTOMOUNT(inode))\n\t\tserver->fsid = fattr->fsid;\n\n\t/*\n\t * Update the read time so we don't revalidate too often.\n\t */\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\n\tsave_cache_validity = nfsi->cache_validity;\n\tnfsi->cache_validity &= ~(NFS_INO_INVALID_ATTR\n\t\t\t| NFS_INO_INVALID_ATIME\n\t\t\t| NFS_INO_REVAL_FORCED\n\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\n\t/* Do atomic weak cache consistency updates */\n\tinvalid |= nfs_wcc_update_inode(inode, fattr);\n\n\t/* More cache consistency checks */\n\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE) {\n\t\tif (inode->i_version != fattr->change_attr) {\n\t\t\tdprintk(\"NFS: change_attr change on server for file %s/%ld\\n\",\n\t\t\t\t\tinode->i_sb->s_id, inode->i_ino);\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tnfs_force_lookup_revalidate(inode);\n\t\t\tinode->i_version = fattr->change_attr;\n\t\t}\n\t} else if (server->caps & NFS_CAP_CHANGE_ATTR)\n\t\tnfsi->cache_validity |= save_cache_validity;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MTIME) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t} else if (server->caps & NFS_CAP_MTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_CTIME) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t} else if (server->caps & NFS_CAP_CTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\t/* Check if our cached file size is stale */\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tcur_isize = i_size_read(inode);\n\t\tif (new_isize != cur_isize) {\n\t\t\t/* Do we perhaps have any outstanding writes, or has\n\t\t\t * the file grown beyond our last write? */\n\t\t\tif ((nfsi->nrequests == 0) || new_isize > cur_isize) {\n\t\t\t\ti_size_write(inode, new_isize);\n\t\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_DATA;\n\t\t\t\tinvalid &= ~NFS_INO_REVAL_PAGECACHE;\n\t\t\t}\n\t\t\tdprintk(\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\",\n\t\t\t\t\tinode->i_sb->s_id,\n\t\t\t\t\tinode->i_ino,\n\t\t\t\t\t(long long)cur_isize,\n\t\t\t\t\t(long long)new_isize);\n\t\t}\n\t} else\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\n\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\tmemcpy(&inode->i_atime, &fattr->atime, sizeof(inode->i_atime));\n\telse if (server->caps & NFS_CAP_ATIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATIME\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MODE) {\n\t\tif ((inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO)) {\n\t\t\tumode_t newmode = inode->i_mode & S_IFMT;\n\t\t\tnewmode |= fattr->mode & S_IALLUGO;\n\t\t\tinode->i_mode = newmode;\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t}\n\t} else if (server->caps & NFS_CAP_MODE)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER) {\n\t\tif (!uid_eq(inode->i_uid, fattr->uid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_uid = fattr->uid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP) {\n\t\tif (!gid_eq(inode->i_gid, fattr->gid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_gid = fattr->gid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER_GROUP)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_NLINK) {\n\t\tif (inode->i_nlink != fattr->nlink) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tinvalid |= NFS_INO_INVALID_DATA;\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\t}\n\t} else if (server->caps & NFS_CAP_NLINK)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t/*\n\t\t * report the blocks in 512byte units\n\t\t */\n\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n \t}\n\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\n\t/* Update attrtimeo value if we're out of the unstable period */\n\tif (invalid & NFS_INO_INVALID_ATTR) {\n\t\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\t/* Set barrier to be more recent than all outstanding updates */\n\t\tnfsi->attr_gencount = nfs_inc_attr_generation_counter();\n\t} else {\n\t\tif (!time_in_range_open(now, nfsi->attrtimeo_timestamp, nfsi->attrtimeo_timestamp + nfsi->attrtimeo)) {\n\t\t\tif ((nfsi->attrtimeo <<= 1) > NFS_MAXATTRTIMEO(inode))\n\t\t\t\tnfsi->attrtimeo = NFS_MAXATTRTIMEO(inode);\n\t\t\tnfsi->attrtimeo_timestamp = now;\n\t\t}\n\t\t/* Set the barrier to be more recent than this fattr */\n\t\tif ((long)fattr->gencount - (long)nfsi->attr_gencount > 0)\n\t\t\tnfsi->attr_gencount = fattr->gencount;\n\t}\n\tinvalid &= ~NFS_INO_INVALID_ATTR;\n\t/* Don't invalidate the data if we were to blame */\n\tif (!(S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode)\n\t\t\t\t|| S_ISLNK(inode->i_mode)))\n\t\tinvalid &= ~NFS_INO_INVALID_DATA;\n\tif (!NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) ||\n\t\t\t(save_cache_validity & NFS_INO_REVAL_FORCED))\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\treturn 0;\n out_err:\n\t/*\n\t * No need to worry about unhashing the dentry, as the\n\t * lookup validation will know that the inode is bad.\n\t * (But we fall through to invalidate the caches.)\n\t */\n\tnfs_invalidate_inode(inode);\n\treturn -ESTALE;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_isize, new_isize;\n\tunsigned long invalid = 0;\n\tunsigned long now = jiffies;\n\tunsigned long save_cache_validity;\n\n\tdfprintk(VFS, \"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\",\n\t\t\t__func__, inode->i_sb->s_id, inode->i_ino,\n\t\t\tnfs_display_fhandle_hash(NFS_FH(inode)),\n\t\t\tatomic_read(&inode->i_count), fattr->valid);\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid) {\n\t\tprintk(KERN_ERR \"NFS: server %s error: fileid changed\\n\"\n\t\t\t\"fsid %s: expected fileid 0x%Lx, got 0x%Lx\\n\",\n\t\t\tNFS_SERVER(inode)->nfs_client->cl_hostname,\n\t\t\tinode->i_sb->s_id, (long long)nfsi->fileid,\n\t\t\t(long long)fattr->fileid);\n\t\tgoto out_err;\n\t}\n\n\t/*\n\t * Make sure the inode's type hasn't changed.\n\t */\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT)) {\n\t\t/*\n\t\t* Big trouble! The inode has become a different object.\n\t\t*/\n\t\tprintk(KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\",\n\t\t\t\t__func__, inode->i_ino, inode->i_mode, fattr->mode);\n\t\tgoto out_err;\n\t}\n\n\tserver = NFS_SERVER(inode);\n\t/* Update the fsid? */\n\tif (S_ISDIR(inode->i_mode) && (fattr->valid & NFS_ATTR_FATTR_FSID) &&\n\t\t\t!nfs_fsid_equal(&server->fsid, &fattr->fsid) &&\n\t\t\t!IS_AUTOMOUNT(inode))\n\t\tserver->fsid = fattr->fsid;\n\n\t/*\n\t * Update the read time so we don't revalidate too often.\n\t */\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\n\tsave_cache_validity = nfsi->cache_validity;\n\tnfsi->cache_validity &= ~(NFS_INO_INVALID_ATTR\n\t\t\t| NFS_INO_INVALID_ATIME\n\t\t\t| NFS_INO_REVAL_FORCED\n\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\n\t/* Do atomic weak cache consistency updates */\n\tinvalid |= nfs_wcc_update_inode(inode, fattr);\n\n\t/* More cache consistency checks */\n\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE) {\n\t\tif (inode->i_version != fattr->change_attr) {\n\t\t\tdprintk(\"NFS: change_attr change on server for file %s/%ld\\n\",\n\t\t\t\t\tinode->i_sb->s_id, inode->i_ino);\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tnfs_force_lookup_revalidate(inode);\n\t\t\tinode->i_version = fattr->change_attr;\n\t\t}\n\t} else if (server->caps & NFS_CAP_CHANGE_ATTR)\n\t\tnfsi->cache_validity |= save_cache_validity;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MTIME) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t} else if (server->caps & NFS_CAP_MTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_CTIME) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t} else if (server->caps & NFS_CAP_CTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\t/* Check if our cached file size is stale */\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tcur_isize = i_size_read(inode);\n\t\tif (new_isize != cur_isize) {\n\t\t\t/* Do we perhaps have any outstanding writes, or has\n\t\t\t * the file grown beyond our last write? */\n\t\t\tif ((nfsi->nrequests == 0) || new_isize > cur_isize) {\n\t\t\t\ti_size_write(inode, new_isize);\n\t\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_DATA;\n\t\t\t\tinvalid &= ~NFS_INO_REVAL_PAGECACHE;\n\t\t\t}\n\t\t\tdprintk(\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\",\n\t\t\t\t\tinode->i_sb->s_id,\n\t\t\t\t\tinode->i_ino,\n\t\t\t\t\t(long long)cur_isize,\n\t\t\t\t\t(long long)new_isize);\n\t\t}\n\t} else\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\n\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\tmemcpy(&inode->i_atime, &fattr->atime, sizeof(inode->i_atime));\n\telse if (server->caps & NFS_CAP_ATIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATIME\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MODE) {\n\t\tif ((inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO)) {\n\t\t\tumode_t newmode = inode->i_mode & S_IFMT;\n\t\t\tnewmode |= fattr->mode & S_IALLUGO;\n\t\t\tinode->i_mode = newmode;\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t}\n\t} else if (server->caps & NFS_CAP_MODE)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER) {\n\t\tif (!uid_eq(inode->i_uid, fattr->uid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_uid = fattr->uid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP) {\n\t\tif (!gid_eq(inode->i_gid, fattr->gid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_gid = fattr->gid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER_GROUP)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_NLINK) {\n\t\tif (inode->i_nlink != fattr->nlink) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tinvalid |= NFS_INO_INVALID_DATA;\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\t}\n\t} else if (server->caps & NFS_CAP_NLINK)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t/*\n\t\t * report the blocks in 512byte units\n\t\t */\n\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n \t}\n\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\n\t/* Update attrtimeo value if we're out of the unstable period */\n\tif (invalid & NFS_INO_INVALID_ATTR) {\n\t\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\t/* Set barrier to be more recent than all outstanding updates */\n\t\tnfsi->attr_gencount = nfs_inc_attr_generation_counter();\n\t} else {\n\t\tif (!time_in_range_open(now, nfsi->attrtimeo_timestamp, nfsi->attrtimeo_timestamp + nfsi->attrtimeo)) {\n\t\t\tif ((nfsi->attrtimeo <<= 1) > NFS_MAXATTRTIMEO(inode))\n\t\t\t\tnfsi->attrtimeo = NFS_MAXATTRTIMEO(inode);\n\t\t\tnfsi->attrtimeo_timestamp = now;\n\t\t}\n\t\t/* Set the barrier to be more recent than this fattr */\n\t\tif ((long)fattr->gencount - (long)nfsi->attr_gencount > 0)\n\t\t\tnfsi->attr_gencount = fattr->gencount;\n\t}\n\tinvalid &= ~NFS_INO_INVALID_ATTR;\n\t/* Don't invalidate the data if we were to blame */\n\tif (!(S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode)\n\t\t\t\t|| S_ISLNK(inode->i_mode)))\n\t\tinvalid &= ~NFS_INO_INVALID_DATA;\n\tif (!NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) ||\n\t\t\t(save_cache_validity & NFS_INO_REVAL_FORCED))\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\treturn 0;\n out_err:\n\t/*\n\t * No need to worry about unhashing the dentry, as the\n\t * lookup validation will know that the inode is bad.\n\t * (But we fall through to invalidate the caches.)\n\t */\n\tnfs_invalidate_inode(inode);\n\treturn -ESTALE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_attrs_need_update",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1447
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_attrs_need_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1416-1423",
          "snippet": "static int nfs_inode_attrs_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tconst struct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn ((long)fattr->gencount - (long)nfsi->attr_gencount) > 0 ||\n\t\tnfs_ctime_need_update(inode, fattr) ||\n\t\t((long)nfsi->attr_gencount - (long)nfs_read_attr_generation_counter() > 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_inode_attrs_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tconst struct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn ((long)fattr->gencount - (long)nfsi->attr_gencount) > 0 ||\n\t\tnfs_ctime_need_update(inode, fattr) ||\n\t\t((long)nfsi->attr_gencount - (long)nfs_read_attr_generation_counter() > 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_attrs_handle_layoutcommit",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_attrs_handle_layoutcommit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1429-1437",
          "snippet": "static void nfs_inode_attrs_handle_layoutcommit(struct inode *inode,\n\t\tstruct nfs_fattr *fattr)\n{\n\tif (pnfs_layoutcommit_outstanding(inode))\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_CHANGE |\n\t\t\t\tNFS_ATTR_FATTR_MTIME |\n\t\t\t\tNFS_ATTR_FATTR_CTIME |\n\t\t\t\tNFS_ATTR_FATTR_SIZE);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic void nfs_inode_attrs_handle_layoutcommit(struct inode *inode,\n\t\tstruct nfs_fattr *fattr)\n{\n\tif (pnfs_layoutcommit_outstanding(inode))\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_CHANGE |\n\t\t\t\tNFS_ATTR_FATTR_MTIME |\n\t\t\t\tNFS_ATTR_FATTR_CTIME |\n\t\t\t\tNFS_ATTR_FATTR_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_nfs_refresh_inode_enter",
          "args": [
            "inode"
          ],
          "line": 1443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_refresh_inode_locked(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint ret;\n\n\ttrace_nfs_refresh_inode_enter(inode);\n\n\tnfs_inode_attrs_handle_layoutcommit(inode, fattr);\n\n\tif (nfs_inode_attrs_need_update(inode, fattr))\n\t\tret = nfs_update_inode(inode, fattr);\n\telse\n\t\tret = nfs_check_inode_attributes(inode, fattr);\n\n\ttrace_nfs_refresh_inode_exit(inode, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_inode_attrs_handle_layoutcommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1429-1437",
    "snippet": "static void nfs_inode_attrs_handle_layoutcommit(struct inode *inode,\n\t\tstruct nfs_fattr *fattr)\n{\n\tif (pnfs_layoutcommit_outstanding(inode))\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_CHANGE |\n\t\t\t\tNFS_ATTR_FATTR_MTIME |\n\t\t\t\tNFS_ATTR_FATTR_CTIME |\n\t\t\t\tNFS_ATTR_FATTR_SIZE);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pnfs_layoutcommit_outstanding",
          "args": [
            "inode"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "pnfs_layoutcommit_outstanding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs.h",
          "lines": "654-658",
          "snippet": "static inline bool\npnfs_layoutcommit_outstanding(struct inode *inode)\n{\n\treturn false;\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n\nstatic inline bool\npnfs_layoutcommit_outstanding(struct inode *inode)\n{\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic void nfs_inode_attrs_handle_layoutcommit(struct inode *inode,\n\t\tstruct nfs_fattr *fattr)\n{\n\tif (pnfs_layoutcommit_outstanding(inode))\n\t\tfattr->valid &= ~(NFS_ATTR_FATTR_CHANGE |\n\t\t\t\tNFS_ATTR_FATTR_MTIME |\n\t\t\t\tNFS_ATTR_FATTR_CTIME |\n\t\t\t\tNFS_ATTR_FATTR_SIZE);\n}"
  },
  {
    "function_name": "nfs_inode_attrs_need_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1416-1423",
    "snippet": "static int nfs_inode_attrs_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tconst struct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn ((long)fattr->gencount - (long)nfsi->attr_gencount) > 0 ||\n\t\tnfs_ctime_need_update(inode, fattr) ||\n\t\t((long)nfsi->attr_gencount - (long)nfs_read_attr_generation_counter() > 0);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_read_attr_generation_counter",
          "args": [],
          "line": 1422
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_read_attr_generation_counter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1275-1278",
          "snippet": "static unsigned long nfs_read_attr_generation_counter(void)\n{\n\treturn atomic_long_read(&nfs_attr_generation_counter);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_long_t nfs_attr_generation_counter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic atomic_long_t nfs_attr_generation_counter;\n\nstatic unsigned long nfs_read_attr_generation_counter(void)\n{\n\treturn atomic_long_read(&nfs_attr_generation_counter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_ctime_need_update",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 1421
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_ctime_need_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1266-1271",
          "snippet": "static int nfs_ctime_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tif (!(fattr->valid & NFS_ATTR_FATTR_CTIME))\n\t\treturn 0;\n\treturn timespec_compare(&fattr->ctime, &inode->i_ctime) > 0;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_ctime_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tif (!(fattr->valid & NFS_ATTR_FATTR_CTIME))\n\t\treturn 0;\n\treturn timespec_compare(&fattr->ctime, &inode->i_ctime) > 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_inode_attrs_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tconst struct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn ((long)fattr->gencount - (long)nfsi->attr_gencount) > 0 ||\n\t\tnfs_ctime_need_update(inode, fattr) ||\n\t\t((long)nfsi->attr_gencount - (long)nfs_read_attr_generation_counter() > 0);\n}"
  },
  {
    "function_name": "_nfs_display_fhandle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1359-1393",
    "snippet": "void _nfs_display_fhandle(const struct nfs_fh *fh, const char *caption)\n{\n\tunsigned short i;\n\n\tif (fh == NULL || fh->size == 0) {\n\t\tprintk(KERN_DEFAULT \"%s at %p is empty\\n\", caption, fh);\n\t\treturn;\n\t}\n\n\tprintk(KERN_DEFAULT \"%s at %p is %u bytes, crc: 0x%08x:\\n\",\n\t       caption, fh, fh->size, _nfs_display_fhandle_hash(fh));\n\tfor (i = 0; i < fh->size; i += 16) {\n\t\t__be32 *pos = (__be32 *)&fh->data[i];\n\n\t\tswitch ((fh->size - i - 1) >> 2) {\n\t\tcase 0:\n\t\t\tprintk(KERN_DEFAULT \" %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos));\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1));\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2), be32_to_cpup(pos + 3));\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEFAULT \" %08x %08x %08x %08x\\n\"",
            "be32_to_cpup(pos)",
            "be32_to_cpup(pos + 1)",
            "be32_to_cpup(pos + 2)",
            "be32_to_cpup(pos + 3)"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos + 3"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos + 2"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos + 1"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos + 2"
          ],
          "line": 1385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos + 1"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos + 1"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "pos"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_nfs_display_fhandle_hash",
          "args": [
            "fh"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "_nfs_display_fhandle_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1343-1348",
          "snippet": "u32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nu32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid _nfs_display_fhandle(const struct nfs_fh *fh, const char *caption)\n{\n\tunsigned short i;\n\n\tif (fh == NULL || fh->size == 0) {\n\t\tprintk(KERN_DEFAULT \"%s at %p is empty\\n\", caption, fh);\n\t\treturn;\n\t}\n\n\tprintk(KERN_DEFAULT \"%s at %p is %u bytes, crc: 0x%08x:\\n\",\n\t       caption, fh, fh->size, _nfs_display_fhandle_hash(fh));\n\tfor (i = 0; i < fh->size; i += 16) {\n\t\t__be32 *pos = (__be32 *)&fh->data[i];\n\n\t\tswitch ((fh->size - i - 1) >> 2) {\n\t\tcase 0:\n\t\t\tprintk(KERN_DEFAULT \" %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos));\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1));\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tprintk(KERN_DEFAULT \" %08x %08x %08x %08x\\n\",\n\t\t\t\tbe32_to_cpup(pos), be32_to_cpup(pos + 1),\n\t\t\t\tbe32_to_cpup(pos + 2), be32_to_cpup(pos + 3));\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "_nfs_display_fhandle_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1343-1348",
    "snippet": "u32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fhandle_hash",
          "args": [
            "fh"
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fhandle_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "679-682",
          "snippet": "static inline u32 nfs_fhandle_hash(const struct nfs_fh *fh)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct nfs_client *\nnfs4_find_client_sessionid(struct net *, const struct sockaddr *,\n\t\t\t\tstruct nfs4_sessionid *, u32);",
            "extern struct nfs_server *nfs4_create_referral_server(struct nfs_clone_mount *,\n\t\t\t\t\t\t      struct nfs_fh *);",
            "extern struct dentry *nfs_get_root(struct super_block *, struct nfs_fh *,\n\t\t\t\t   const char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct nfs_client *\nnfs4_find_client_sessionid(struct net *, const struct sockaddr *,\n\t\t\t\tstruct nfs4_sessionid *, u32);\nextern struct nfs_server *nfs4_create_referral_server(struct nfs_clone_mount *,\n\t\t\t\t\t\t      struct nfs_fh *);\nextern struct dentry *nfs_get_root(struct super_block *, struct nfs_fh *,\n\t\t\t\t   const char *);\n\nstatic inline u32 nfs_fhandle_hash(const struct nfs_fh *fh)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nu32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}"
  },
  {
    "function_name": "nfs_alloc_fhandle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1323-1331",
    "snippet": "struct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(struct nfs_fh)",
            "GFP_NOFS"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}"
  },
  {
    "function_name": "nfs_alloc_fattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1312-1320",
    "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 1318
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*fattr)",
            "GFP_NOFS"
          ],
          "line": 1316
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
  },
  {
    "function_name": "nfs_fattr_set_barrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1307-1310",
    "snippet": "void nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_inc_attr_generation_counter",
          "args": [],
          "line": 1309
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_attr_generation_counter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1280-1283",
          "snippet": "unsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_long_t nfs_attr_generation_counter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic atomic_long_t nfs_attr_generation_counter;\n\nunsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}"
  },
  {
    "function_name": "nfs_fattr_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1286-1293",
    "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_inc_attr_generation_counter",
          "args": [],
          "line": 1290
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_attr_generation_counter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1280-1283",
          "snippet": "unsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_long_t nfs_attr_generation_counter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic atomic_long_t nfs_attr_generation_counter;\n\nunsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
  },
  {
    "function_name": "nfs_inc_attr_generation_counter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1280-1283",
    "snippet": "unsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_long_t nfs_attr_generation_counter;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_long_inc_return",
          "args": [
            "&nfs_attr_generation_counter"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic atomic_long_t nfs_attr_generation_counter;\n\nunsigned long nfs_inc_attr_generation_counter(void)\n{\n\treturn atomic_long_inc_return(&nfs_attr_generation_counter);\n}"
  },
  {
    "function_name": "nfs_read_attr_generation_counter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1275-1278",
    "snippet": "static unsigned long nfs_read_attr_generation_counter(void)\n{\n\treturn atomic_long_read(&nfs_attr_generation_counter);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_long_t nfs_attr_generation_counter;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_long_read",
          "args": [
            "&nfs_attr_generation_counter"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic atomic_long_t nfs_attr_generation_counter;\n\nstatic unsigned long nfs_read_attr_generation_counter(void)\n{\n\treturn atomic_long_read(&nfs_attr_generation_counter);\n}"
  },
  {
    "function_name": "nfs_ctime_need_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1266-1271",
    "snippet": "static int nfs_ctime_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tif (!(fattr->valid & NFS_ATTR_FATTR_CTIME))\n\t\treturn 0;\n\treturn timespec_compare(&fattr->ctime, &inode->i_ctime) > 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "timespec_compare",
          "args": [
            "&fattr->ctime",
            "&inode->i_ctime"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_ctime_need_update(const struct inode *inode, const struct nfs_fattr *fattr)\n{\n\tif (!(fattr->valid & NFS_ATTR_FATTR_CTIME))\n\t\treturn 0;\n\treturn timespec_compare(&fattr->ctime, &inode->i_ctime) > 0;\n}"
  },
  {
    "function_name": "nfs_check_inode_attributes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1214-1264",
    "snippet": "static int nfs_check_inode_attributes(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_size, new_isize;\n\tunsigned long invalid = 0;\n\n\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\t/* Has the inode gone and changed behind our back? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid)\n\t\treturn -EIO;\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT))\n\t\treturn -EIO;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\tinode->i_version != fattr->change_attr)\n\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\t/* Verify a few of the more important attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) && !timespec_equal(&inode->i_mtime, &fattr->mtime))\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tcur_size = i_size_read(inode);\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tif (cur_size != new_isize && nfsi->nrequests == 0)\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\t}\n\n\t/* Have any file permissions changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MODE) && (inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_OWNER) && !uid_eq(inode->i_uid, fattr->uid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_GROUP) && !gid_eq(inode->i_gid, fattr->gid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\n\t/* Has the link count changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_NLINK) && inode->i_nlink != fattr->nlink)\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_ATIME) && !timespec_equal(&inode->i_atime, &fattr->atime))\n\t\tinvalid |= NFS_INO_INVALID_ATIME;\n\n\tif (invalid != 0)\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "invalid"
          ],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timespec_equal",
          "args": [
            "&inode->i_atime",
            "&fattr->atime"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "inode->i_gid",
            "fattr->gid"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "inode->i_uid",
            "fattr->uid"
          ],
          "line": 1247
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_size_to_loff_t",
          "args": [
            "fattr->size"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_equal",
          "args": [
            "&inode->i_mtime",
            "&fattr->mtime"
          ],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_have_delegated_attributes",
          "args": [
            "inode"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_have_delegated_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.h",
          "lines": "67-71",
          "snippet": "static inline int nfs_have_delegated_attributes(struct inode *inode)\n{\n\treturn NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) &&\n\t\t!(NFS_I(inode)->cache_validity & NFS_INO_REVAL_FORCED);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs_have_delegated_attributes(struct inode *inode)\n{\n\treturn NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) &&\n\t\t!(NFS_I(inode)->cache_validity & NFS_INO_REVAL_FORCED);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_check_inode_attributes(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_size, new_isize;\n\tunsigned long invalid = 0;\n\n\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\t/* Has the inode gone and changed behind our back? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid)\n\t\treturn -EIO;\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT))\n\t\treturn -EIO;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_CHANGE) != 0 &&\n\t\t\tinode->i_version != fattr->change_attr)\n\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\n\t/* Verify a few of the more important attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MTIME) && !timespec_equal(&inode->i_mtime, &fattr->mtime))\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tcur_size = i_size_read(inode);\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tif (cur_size != new_isize && nfsi->nrequests == 0)\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_REVAL_PAGECACHE;\n\t}\n\n\t/* Have any file permissions changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_MODE) && (inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_OWNER) && !uid_eq(inode->i_uid, fattr->uid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\tif ((fattr->valid & NFS_ATTR_FATTR_GROUP) && !gid_eq(inode->i_gid, fattr->gid))\n\t\tinvalid |= NFS_INO_INVALID_ATTR | NFS_INO_INVALID_ACCESS | NFS_INO_INVALID_ACL;\n\n\t/* Has the link count changed? */\n\tif ((fattr->valid & NFS_ATTR_FATTR_NLINK) && inode->i_nlink != fattr->nlink)\n\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_ATIME) && !timespec_equal(&inode->i_atime, &fattr->atime))\n\t\tinvalid |= NFS_INO_INVALID_ATIME;\n\n\tif (invalid != 0)\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_wcc_update_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1165-1203",
    "snippet": "static unsigned long nfs_wcc_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long ret = 0;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECHANGE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CHANGE)\n\t\t\t&& inode->i_version == fattr->pre_change_attr) {\n\t\tinode->i_version = fattr->change_attr;\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\t/* If we have atomic WCC data, we may update some attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CTIME)\n\t\t\t&& timespec_equal(&inode->i_ctime, &fattr->pre_ctime)) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PREMTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_MTIME)\n\t\t\t&& timespec_equal(&inode->i_mtime, &fattr->pre_mtime)) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRESIZE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_SIZE)\n\t\t\t&& i_size_read(inode) == nfs_size_to_loff_t(fattr->pre_size)\n\t\t\t&& nfsi->nrequests == 0) {\n\t\ti_size_write(inode, nfs_size_to_loff_t(fattr->size));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "nfs_size_to_loff_t(fattr->size)"
          ],
          "line": 1198
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_size_to_loff_t",
          "args": [
            "fattr->size"
          ],
          "line": 1198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_size_to_loff_t",
          "args": [
            "fattr->pre_size"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "NFS_INO_INVALID_DATA"
          ],
          "line": 1191
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&inode->i_mtime",
            "&fattr->mtime",
            "sizeof(inode->i_mtime)"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_equal",
          "args": [
            "&inode->i_mtime",
            "&fattr->pre_mtime"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&inode->i_ctime",
            "&fattr->ctime",
            "sizeof(inode->i_ctime)"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_equal",
          "args": [
            "&inode->i_ctime",
            "&fattr->pre_ctime"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic unsigned long nfs_wcc_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long ret = 0;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECHANGE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CHANGE)\n\t\t\t&& inode->i_version == fattr->pre_change_attr) {\n\t\tinode->i_version = fattr->change_attr;\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\t/* If we have atomic WCC data, we may update some attributes */\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRECTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_CTIME)\n\t\t\t&& timespec_equal(&inode->i_ctime, &fattr->pre_ctime)) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_PREMTIME)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_MTIME)\n\t\t\t&& timespec_equal(&inode->i_mtime, &fattr->pre_mtime)) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t\tif (S_ISDIR(inode->i_mode))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\tif ((fattr->valid & NFS_ATTR_FATTR_PRESIZE)\n\t\t\t&& (fattr->valid & NFS_ATTR_FATTR_SIZE)\n\t\t\t&& i_size_read(inode) == nfs_size_to_loff_t(fattr->pre_size)\n\t\t\t&& nfsi->nrequests == 0) {\n\t\ti_size_write(inode, nfs_size_to_loff_t(fattr->size));\n\t\tret |= NFS_INO_INVALID_ATTR;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_revalidate_mapping_protected",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1160-1163",
    "snippet": "int nfs_revalidate_mapping_protected(struct inode *inode, struct address_space *mapping)\n{\n\treturn __nfs_revalidate_mapping(inode, mapping, true);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_revalidate_mapping",
          "args": [
            "inode",
            "mapping",
            "true"
          ],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_revalidate_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1076-1140",
          "snippet": "static int __nfs_revalidate_mapping(struct inode *inode,\n\t\tstruct address_space *mapping,\n\t\tbool may_lock)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long *bitlock = &nfsi->flags;\n\tint ret = 0;\n\n\t/* swapfiles are not supposed to be shared. */\n\tif (IS_SWAPFILE(inode))\n\t\tgoto out;\n\n\tif (nfs_mapping_need_revalidate_inode(inode)) {\n\t\tret = __nfs_revalidate_inode(NFS_SERVER(inode), inode);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We must clear NFS_INO_INVALID_DATA first to ensure that\n\t * invalidations that come in while we're shooting down the mappings\n\t * are respected. But, that leaves a race window where one revalidator\n\t * can clear the flag, and then another checks it before the mapping\n\t * gets invalidated. Fix that by serializing access to this part of\n\t * the function.\n\t *\n\t * At the same time, we need to allow other tasks to see whether we\n\t * might be in the middle of invalidating the pages, so we only set\n\t * the bit lock here if it looks like we're going to be doing that.\n\t */\n\tfor (;;) {\n\t\tret = wait_on_bit_action(bitlock, NFS_INO_INVALIDATING,\n\t\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tspin_lock(&inode->i_lock);\n\t\tif (test_bit(NFS_INO_INVALIDATING, bitlock)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\tif (nfsi->cache_validity & NFS_INO_INVALID_DATA)\n\t\t\tbreak;\n\t\tspin_unlock(&inode->i_lock);\n\t\tgoto out;\n\t}\n\n\tset_bit(NFS_INO_INVALIDATING, bitlock);\n\tsmp_wmb();\n\tnfsi->cache_validity &= ~NFS_INO_INVALID_DATA;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs_invalidate_mapping_enter(inode);\n\tif (may_lock) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\t\tmutex_unlock(&inode->i_mutex);\n\t} else\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\ttrace_nfs_invalidate_mapping_exit(inode, ret);\n\n\tclear_bit_unlock(NFS_INO_INVALIDATING, bitlock);\n\tsmp_mb__after_atomic();\n\twake_up_bit(bitlock, NFS_INO_INVALIDATING);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int __nfs_revalidate_mapping(struct inode *inode,\n\t\tstruct address_space *mapping,\n\t\tbool may_lock)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long *bitlock = &nfsi->flags;\n\tint ret = 0;\n\n\t/* swapfiles are not supposed to be shared. */\n\tif (IS_SWAPFILE(inode))\n\t\tgoto out;\n\n\tif (nfs_mapping_need_revalidate_inode(inode)) {\n\t\tret = __nfs_revalidate_inode(NFS_SERVER(inode), inode);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We must clear NFS_INO_INVALID_DATA first to ensure that\n\t * invalidations that come in while we're shooting down the mappings\n\t * are respected. But, that leaves a race window where one revalidator\n\t * can clear the flag, and then another checks it before the mapping\n\t * gets invalidated. Fix that by serializing access to this part of\n\t * the function.\n\t *\n\t * At the same time, we need to allow other tasks to see whether we\n\t * might be in the middle of invalidating the pages, so we only set\n\t * the bit lock here if it looks like we're going to be doing that.\n\t */\n\tfor (;;) {\n\t\tret = wait_on_bit_action(bitlock, NFS_INO_INVALIDATING,\n\t\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tspin_lock(&inode->i_lock);\n\t\tif (test_bit(NFS_INO_INVALIDATING, bitlock)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\tif (nfsi->cache_validity & NFS_INO_INVALID_DATA)\n\t\t\tbreak;\n\t\tspin_unlock(&inode->i_lock);\n\t\tgoto out;\n\t}\n\n\tset_bit(NFS_INO_INVALIDATING, bitlock);\n\tsmp_wmb();\n\tnfsi->cache_validity &= ~NFS_INO_INVALID_DATA;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs_invalidate_mapping_enter(inode);\n\tif (may_lock) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\t\tmutex_unlock(&inode->i_mutex);\n\t} else\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\ttrace_nfs_invalidate_mapping_exit(inode, ret);\n\n\tclear_bit_unlock(NFS_INO_INVALIDATING, bitlock);\n\tsmp_mb__after_atomic();\n\twake_up_bit(bitlock, NFS_INO_INVALIDATING);\nout:\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_revalidate_mapping_protected(struct inode *inode, struct address_space *mapping)\n{\n\treturn __nfs_revalidate_mapping(inode, mapping, true);\n}"
  },
  {
    "function_name": "nfs_revalidate_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1147-1150",
    "snippet": "int nfs_revalidate_mapping(struct inode *inode, struct address_space *mapping)\n{\n\treturn __nfs_revalidate_mapping(inode, mapping, false);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_revalidate_mapping",
          "args": [
            "inode",
            "mapping",
            "false"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_revalidate_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1076-1140",
          "snippet": "static int __nfs_revalidate_mapping(struct inode *inode,\n\t\tstruct address_space *mapping,\n\t\tbool may_lock)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long *bitlock = &nfsi->flags;\n\tint ret = 0;\n\n\t/* swapfiles are not supposed to be shared. */\n\tif (IS_SWAPFILE(inode))\n\t\tgoto out;\n\n\tif (nfs_mapping_need_revalidate_inode(inode)) {\n\t\tret = __nfs_revalidate_inode(NFS_SERVER(inode), inode);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We must clear NFS_INO_INVALID_DATA first to ensure that\n\t * invalidations that come in while we're shooting down the mappings\n\t * are respected. But, that leaves a race window where one revalidator\n\t * can clear the flag, and then another checks it before the mapping\n\t * gets invalidated. Fix that by serializing access to this part of\n\t * the function.\n\t *\n\t * At the same time, we need to allow other tasks to see whether we\n\t * might be in the middle of invalidating the pages, so we only set\n\t * the bit lock here if it looks like we're going to be doing that.\n\t */\n\tfor (;;) {\n\t\tret = wait_on_bit_action(bitlock, NFS_INO_INVALIDATING,\n\t\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tspin_lock(&inode->i_lock);\n\t\tif (test_bit(NFS_INO_INVALIDATING, bitlock)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\tif (nfsi->cache_validity & NFS_INO_INVALID_DATA)\n\t\t\tbreak;\n\t\tspin_unlock(&inode->i_lock);\n\t\tgoto out;\n\t}\n\n\tset_bit(NFS_INO_INVALIDATING, bitlock);\n\tsmp_wmb();\n\tnfsi->cache_validity &= ~NFS_INO_INVALID_DATA;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs_invalidate_mapping_enter(inode);\n\tif (may_lock) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\t\tmutex_unlock(&inode->i_mutex);\n\t} else\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\ttrace_nfs_invalidate_mapping_exit(inode, ret);\n\n\tclear_bit_unlock(NFS_INO_INVALIDATING, bitlock);\n\tsmp_mb__after_atomic();\n\twake_up_bit(bitlock, NFS_INO_INVALIDATING);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int __nfs_revalidate_mapping(struct inode *inode,\n\t\tstruct address_space *mapping,\n\t\tbool may_lock)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long *bitlock = &nfsi->flags;\n\tint ret = 0;\n\n\t/* swapfiles are not supposed to be shared. */\n\tif (IS_SWAPFILE(inode))\n\t\tgoto out;\n\n\tif (nfs_mapping_need_revalidate_inode(inode)) {\n\t\tret = __nfs_revalidate_inode(NFS_SERVER(inode), inode);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We must clear NFS_INO_INVALID_DATA first to ensure that\n\t * invalidations that come in while we're shooting down the mappings\n\t * are respected. But, that leaves a race window where one revalidator\n\t * can clear the flag, and then another checks it before the mapping\n\t * gets invalidated. Fix that by serializing access to this part of\n\t * the function.\n\t *\n\t * At the same time, we need to allow other tasks to see whether we\n\t * might be in the middle of invalidating the pages, so we only set\n\t * the bit lock here if it looks like we're going to be doing that.\n\t */\n\tfor (;;) {\n\t\tret = wait_on_bit_action(bitlock, NFS_INO_INVALIDATING,\n\t\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tspin_lock(&inode->i_lock);\n\t\tif (test_bit(NFS_INO_INVALIDATING, bitlock)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\tif (nfsi->cache_validity & NFS_INO_INVALID_DATA)\n\t\t\tbreak;\n\t\tspin_unlock(&inode->i_lock);\n\t\tgoto out;\n\t}\n\n\tset_bit(NFS_INO_INVALIDATING, bitlock);\n\tsmp_wmb();\n\tnfsi->cache_validity &= ~NFS_INO_INVALID_DATA;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs_invalidate_mapping_enter(inode);\n\tif (may_lock) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\t\tmutex_unlock(&inode->i_mutex);\n\t} else\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\ttrace_nfs_invalidate_mapping_exit(inode, ret);\n\n\tclear_bit_unlock(NFS_INO_INVALIDATING, bitlock);\n\tsmp_mb__after_atomic();\n\twake_up_bit(bitlock, NFS_INO_INVALIDATING);\nout:\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_revalidate_mapping(struct inode *inode, struct address_space *mapping)\n{\n\treturn __nfs_revalidate_mapping(inode, mapping, false);\n}"
  },
  {
    "function_name": "__nfs_revalidate_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1076-1140",
    "snippet": "static int __nfs_revalidate_mapping(struct inode *inode,\n\t\tstruct address_space *mapping,\n\t\tbool may_lock)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long *bitlock = &nfsi->flags;\n\tint ret = 0;\n\n\t/* swapfiles are not supposed to be shared. */\n\tif (IS_SWAPFILE(inode))\n\t\tgoto out;\n\n\tif (nfs_mapping_need_revalidate_inode(inode)) {\n\t\tret = __nfs_revalidate_inode(NFS_SERVER(inode), inode);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We must clear NFS_INO_INVALID_DATA first to ensure that\n\t * invalidations that come in while we're shooting down the mappings\n\t * are respected. But, that leaves a race window where one revalidator\n\t * can clear the flag, and then another checks it before the mapping\n\t * gets invalidated. Fix that by serializing access to this part of\n\t * the function.\n\t *\n\t * At the same time, we need to allow other tasks to see whether we\n\t * might be in the middle of invalidating the pages, so we only set\n\t * the bit lock here if it looks like we're going to be doing that.\n\t */\n\tfor (;;) {\n\t\tret = wait_on_bit_action(bitlock, NFS_INO_INVALIDATING,\n\t\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tspin_lock(&inode->i_lock);\n\t\tif (test_bit(NFS_INO_INVALIDATING, bitlock)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\tif (nfsi->cache_validity & NFS_INO_INVALID_DATA)\n\t\t\tbreak;\n\t\tspin_unlock(&inode->i_lock);\n\t\tgoto out;\n\t}\n\n\tset_bit(NFS_INO_INVALIDATING, bitlock);\n\tsmp_wmb();\n\tnfsi->cache_validity &= ~NFS_INO_INVALID_DATA;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs_invalidate_mapping_enter(inode);\n\tif (may_lock) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\t\tmutex_unlock(&inode->i_mutex);\n\t} else\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\ttrace_nfs_invalidate_mapping_exit(inode, ret);\n\n\tclear_bit_unlock(NFS_INO_INVALIDATING, bitlock);\n\tsmp_mb__after_atomic();\n\twake_up_bit(bitlock, NFS_INO_INVALIDATING);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "bitlock",
            "NFS_INO_INVALIDATING"
          ],
          "line": 1137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit_unlock",
          "args": [
            "NFS_INO_INVALIDATING",
            "bitlock"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_nfs_invalidate_mapping_exit",
          "args": [
            "inode",
            "ret"
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_invalidate_mapping",
          "args": [
            "inode",
            "mapping"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_invalidate_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1031-1059",
          "snippet": "static int nfs_invalidate_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint ret;\n\n\tif (mapping->nrpages != 0) {\n\t\tif (S_ISREG(inode->i_mode)) {\n\t\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\t\tret = nfs_sync_mapping(mapping);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t}\n\t\tret = invalidate_inode_pages2(mapping);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tspin_lock(&inode->i_lock);\n\t\tmemset(nfsi->cookieverf, 0, sizeof(nfsi->cookieverf));\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\tnfs_inc_stats(inode, NFSIOS_DATAINVALIDATE);\n\tnfs_fscache_wait_on_invalidate(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) data cache invalidated\\n\",\n\t\t\tinode->i_sb->s_id,\n\t\t\t(unsigned long long)NFS_FILEID(inode));\n\treturn 0;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int nfs_invalidate_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint ret;\n\n\tif (mapping->nrpages != 0) {\n\t\tif (S_ISREG(inode->i_mode)) {\n\t\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\t\tret = nfs_sync_mapping(mapping);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t}\n\t\tret = invalidate_inode_pages2(mapping);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tspin_lock(&inode->i_lock);\n\t\tmemset(nfsi->cookieverf, 0, sizeof(nfsi->cookieverf));\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\tnfs_inc_stats(inode, NFSIOS_DATAINVALIDATE);\n\tnfs_fscache_wait_on_invalidate(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) data cache invalidated\\n\",\n\t\t\tinode->i_sb->s_id,\n\t\t\t(unsigned long long)NFS_FILEID(inode));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_nfs_invalidate_mapping_enter",
          "args": [
            "inode"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_INO_INVALIDATING",
            "bitlock"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_INO_INVALIDATING",
            "bitlock"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_on_bit_action",
          "args": [
            "bitlock",
            "NFS_INO_INVALIDATING",
            "nfs_wait_bit_killable",
            "TASK_KILLABLE"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__nfs_revalidate_inode",
          "args": [
            "NFS_SERVER(inode)",
            "inode"
          ],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_revalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "924-991",
          "snippet": "int\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mapping_need_revalidate_inode",
          "args": [
            "inode"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mapping_need_revalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1061-1068",
          "snippet": "static bool nfs_mapping_need_revalidate_inode(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn false;\n\treturn (NFS_I(inode)->cache_validity & NFS_INO_REVAL_PAGECACHE)\n\t\t|| nfs_attribute_timeout(inode)\n\t\t|| NFS_STALE(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic bool nfs_mapping_need_revalidate_inode(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn false;\n\treturn (NFS_I(inode)->cache_validity & NFS_INO_REVAL_PAGECACHE)\n\t\t|| nfs_attribute_timeout(inode)\n\t\t|| NFS_STALE(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_SWAPFILE",
          "args": [
            "inode"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int __nfs_revalidate_mapping(struct inode *inode,\n\t\tstruct address_space *mapping,\n\t\tbool may_lock)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tunsigned long *bitlock = &nfsi->flags;\n\tint ret = 0;\n\n\t/* swapfiles are not supposed to be shared. */\n\tif (IS_SWAPFILE(inode))\n\t\tgoto out;\n\n\tif (nfs_mapping_need_revalidate_inode(inode)) {\n\t\tret = __nfs_revalidate_inode(NFS_SERVER(inode), inode);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We must clear NFS_INO_INVALID_DATA first to ensure that\n\t * invalidations that come in while we're shooting down the mappings\n\t * are respected. But, that leaves a race window where one revalidator\n\t * can clear the flag, and then another checks it before the mapping\n\t * gets invalidated. Fix that by serializing access to this part of\n\t * the function.\n\t *\n\t * At the same time, we need to allow other tasks to see whether we\n\t * might be in the middle of invalidating the pages, so we only set\n\t * the bit lock here if it looks like we're going to be doing that.\n\t */\n\tfor (;;) {\n\t\tret = wait_on_bit_action(bitlock, NFS_INO_INVALIDATING,\n\t\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tspin_lock(&inode->i_lock);\n\t\tif (test_bit(NFS_INO_INVALIDATING, bitlock)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\tif (nfsi->cache_validity & NFS_INO_INVALID_DATA)\n\t\t\tbreak;\n\t\tspin_unlock(&inode->i_lock);\n\t\tgoto out;\n\t}\n\n\tset_bit(NFS_INO_INVALIDATING, bitlock);\n\tsmp_wmb();\n\tnfsi->cache_validity &= ~NFS_INO_INVALID_DATA;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs_invalidate_mapping_enter(inode);\n\tif (may_lock) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\t\tmutex_unlock(&inode->i_mutex);\n\t} else\n\t\tret = nfs_invalidate_mapping(inode, mapping);\n\ttrace_nfs_invalidate_mapping_exit(inode, ret);\n\n\tclear_bit_unlock(NFS_INO_INVALIDATING, bitlock);\n\tsmp_mb__after_atomic();\n\twake_up_bit(bitlock, NFS_INO_INVALIDATING);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_mapping_need_revalidate_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1061-1068",
    "snippet": "static bool nfs_mapping_need_revalidate_inode(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn false;\n\treturn (NFS_I(inode)->cache_validity & NFS_INO_REVAL_PAGECACHE)\n\t\t|| nfs_attribute_timeout(inode)\n\t\t|| NFS_STALE(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "NFS_STALE",
          "args": [
            "inode"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_attribute_timeout",
          "args": [
            "inode"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_attribute_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "993-998",
          "snippet": "int nfs_attribute_timeout(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn !time_in_range_open(jiffies, nfsi->read_cache_jiffies, nfsi->read_cache_jiffies + nfsi->attrtimeo);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_attribute_timeout(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn !time_in_range_open(jiffies, nfsi->read_cache_jiffies, nfsi->read_cache_jiffies + nfsi->attrtimeo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_have_delegated_attributes",
          "args": [
            "inode"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_have_delegated_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.h",
          "lines": "67-71",
          "snippet": "static inline int nfs_have_delegated_attributes(struct inode *inode)\n{\n\treturn NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) &&\n\t\t!(NFS_I(inode)->cache_validity & NFS_INO_REVAL_FORCED);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs_have_delegated_attributes(struct inode *inode)\n{\n\treturn NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) &&\n\t\t!(NFS_I(inode)->cache_validity & NFS_INO_REVAL_FORCED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic bool nfs_mapping_need_revalidate_inode(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn false;\n\treturn (NFS_I(inode)->cache_validity & NFS_INO_REVAL_PAGECACHE)\n\t\t|| nfs_attribute_timeout(inode)\n\t\t|| NFS_STALE(inode);\n}"
  },
  {
    "function_name": "nfs_invalidate_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1031-1059",
    "snippet": "static int nfs_invalidate_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint ret;\n\n\tif (mapping->nrpages != 0) {\n\t\tif (S_ISREG(inode->i_mode)) {\n\t\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\t\tret = nfs_sync_mapping(mapping);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t}\n\t\tret = invalidate_inode_pages2(mapping);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tspin_lock(&inode->i_lock);\n\t\tmemset(nfsi->cookieverf, 0, sizeof(nfsi->cookieverf));\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\tnfs_inc_stats(inode, NFSIOS_DATAINVALIDATE);\n\tnfs_fscache_wait_on_invalidate(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) data cache invalidated\\n\",\n\t\t\tinode->i_sb->s_id,\n\t\t\t(unsigned long long)NFS_FILEID(inode));\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "PAGECACHE",
            "\"NFS: (%s/%Lu) data cache invalidated\\n\"",
            "inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(inode)"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fscache_wait_on_invalidate",
          "args": [
            "inode"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_wait_on_invalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
          "lines": "221-221",
          "snippet": "static inline void nfs_fscache_wait_on_invalidate(struct inode *inode) {}",
          "includes": [
            "#include <linux/fscache.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_wait_on_invalidate(struct inode *inode) {}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_DATAINVALIDATE"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "nfsi->cookieverf",
            "0",
            "sizeof(nfsi->cookieverf)"
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "invalidate_inode_pages2",
          "args": [
            "mapping"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_sync_mapping",
          "args": [
            "mapping"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sync_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "139-148",
          "snippet": "int nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unmap_mapping_range",
          "args": [
            "mapping",
            "0",
            "0",
            "0"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int nfs_invalidate_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint ret;\n\n\tif (mapping->nrpages != 0) {\n\t\tif (S_ISREG(inode->i_mode)) {\n\t\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\t\tret = nfs_sync_mapping(mapping);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t}\n\t\tret = invalidate_inode_pages2(mapping);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tspin_lock(&inode->i_lock);\n\t\tmemset(nfsi->cookieverf, 0, sizeof(nfsi->cookieverf));\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\tnfs_inc_stats(inode, NFSIOS_DATAINVALIDATE);\n\tnfs_fscache_wait_on_invalidate(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) data cache invalidated\\n\",\n\t\t\tinode->i_sb->s_id,\n\t\t\t(unsigned long long)NFS_FILEID(inode));\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_revalidate_inode_rcu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1022-1029",
    "snippet": "int nfs_revalidate_inode_rcu(struct nfs_server *server, struct inode *inode)\n{\n\tif (!(NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\t\t&& !nfs_attribute_cache_expired(inode))\n\t\treturn NFS_STALE(inode) ? -ESTALE : 0;\n\treturn -ECHILD;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "NFS_STALE",
          "args": [
            "inode"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_attribute_cache_expired",
          "args": [
            "inode"
          ],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_attribute_cache_expired",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1000-1005",
          "snippet": "int nfs_attribute_cache_expired(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\treturn nfs_attribute_timeout(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_attribute_cache_expired(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\treturn nfs_attribute_timeout(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_revalidate_inode_rcu(struct nfs_server *server, struct inode *inode)\n{\n\tif (!(NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\t\t&& !nfs_attribute_cache_expired(inode))\n\t\treturn NFS_STALE(inode) ? -ESTALE : 0;\n\treturn -ECHILD;\n}"
  },
  {
    "function_name": "nfs_revalidate_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1014-1019",
    "snippet": "int nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tif (!nfs_need_revalidate_inode(inode))\n\t\treturn NFS_STALE(inode) ? -ESTALE : 0;\n\treturn __nfs_revalidate_inode(server, inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_revalidate_inode",
          "args": [
            "server",
            "inode"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_revalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "924-991",
          "snippet": "int\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_STALE",
          "args": [
            "inode"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_need_revalidate_inode",
          "args": [
            "inode"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_need_revalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "628-636",
          "snippet": "static bool nfs_need_revalidate_inode(struct inode *inode)\n{\n\tif (NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\treturn true;\n\tif (nfs_attribute_cache_expired(inode))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic bool nfs_need_revalidate_inode(struct inode *inode)\n{\n\tif (NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\treturn true;\n\tif (nfs_attribute_cache_expired(inode))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tif (!nfs_need_revalidate_inode(inode))\n\t\treturn NFS_STALE(inode) ? -ESTALE : 0;\n\treturn __nfs_revalidate_inode(server, inode);\n}"
  },
  {
    "function_name": "nfs_attribute_cache_expired",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "1000-1005",
    "snippet": "int nfs_attribute_cache_expired(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\treturn nfs_attribute_timeout(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_attribute_timeout",
          "args": [
            "inode"
          ],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_attribute_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "993-998",
          "snippet": "int nfs_attribute_timeout(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn !time_in_range_open(jiffies, nfsi->read_cache_jiffies, nfsi->read_cache_jiffies + nfsi->attrtimeo);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_attribute_timeout(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn !time_in_range_open(jiffies, nfsi->read_cache_jiffies, nfsi->read_cache_jiffies + nfsi->attrtimeo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_have_delegated_attributes",
          "args": [
            "inode"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_have_delegated_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.h",
          "lines": "67-71",
          "snippet": "static inline int nfs_have_delegated_attributes(struct inode *inode)\n{\n\treturn NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) &&\n\t\t!(NFS_I(inode)->cache_validity & NFS_INO_REVAL_FORCED);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs_have_delegated_attributes(struct inode *inode)\n{\n\treturn NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) &&\n\t\t!(NFS_I(inode)->cache_validity & NFS_INO_REVAL_FORCED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_attribute_cache_expired(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\treturn nfs_attribute_timeout(inode);\n}"
  },
  {
    "function_name": "nfs_attribute_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "993-998",
    "snippet": "int nfs_attribute_timeout(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn !time_in_range_open(jiffies, nfsi->read_cache_jiffies, nfsi->read_cache_jiffies + nfsi->attrtimeo);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "time_in_range_open",
          "args": [
            "jiffies",
            "nfsi->read_cache_jiffies",
            "nfsi->read_cache_jiffies + nfsi->attrtimeo"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_attribute_timeout(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\treturn !time_in_range_open(jiffies, nfsi->read_cache_jiffies, nfsi->read_cache_jiffies + nfsi->attrtimeo);\n}"
  },
  {
    "function_name": "__nfs_revalidate_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "924-991",
    "snippet": "int\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs_revalidate_inode_exit",
          "args": [
            "inode",
            "status"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_label_free",
          "args": [
            "label"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_label_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "315-315",
          "snippet": "static inline void nfs4_label_free(void *label) {}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline void nfs4_label_free(void *label) {}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "PAGECACHE",
            "\"NFS: (%s/%Lu) revalidation complete\\n\"",
            "inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(inode)"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_setsecurity",
          "args": [
            "inode",
            "fattr",
            "label"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_setsecurity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "332-335",
          "snippet": "void nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_zap_acl_cache",
          "args": [
            "inode"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_acl_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "206-216",
          "snippet": "void nfs_zap_acl_cache(struct inode *inode)\n{\n\tvoid (*clear_acl_cache)(struct inode *);\n\n\tclear_acl_cache = NFS_PROTO(inode)->clear_acl_cache;\n\tif (clear_acl_cache != NULL)\n\t\tclear_acl_cache(inode);\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_ACL;\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_acl_cache(struct inode *inode)\n{\n\tvoid (*clear_acl_cache)(struct inode *);\n\n\tclear_acl_cache = NFS_PROTO(inode)->clear_acl_cache;\n\tif (clear_acl_cache != NULL)\n\t\tclear_acl_cache(inode);\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_ACL;\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "PAGECACHE",
            "\"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\"",
            "inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(inode)",
            "status"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_INO_STALE",
            "&NFS_I(inode)->flags"
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_zap_caches",
          "args": [
            "inode"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_caches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "189-194",
          "snippet": "void nfs_zap_caches(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_zap_caches_locked(inode);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_caches(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_zap_caches_locked(inode);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "PAGECACHE",
            "\"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\"",
            "inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(inode)",
            "status"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "server",
            "NFS_FH(inode)",
            "fattr",
            "label"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "label"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "label"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_label_alloc",
          "args": [
            "NFS_SERVER(inode)",
            "GFP_KERNEL"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_label_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "306-329",
          "snippet": "struct nfs4_label *nfs4_label_alloc(struct nfs_server *server, gfp_t flags)\n{\n\tstruct nfs4_label *label = NULL;\n\tint minor_version = server->nfs_client->cl_minorversion;\n\n\tif (minor_version < 2)\n\t\treturn label;\n\n\tif (!(server->caps & NFS_CAP_SECURITY_LABEL))\n\t\treturn label;\n\n\tlabel = kzalloc(sizeof(struct nfs4_label), flags);\n\tif (label == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tlabel->label = kzalloc(NFS4_MAXLABELLEN, flags);\n\tif (label->label == NULL) {\n\t\tkfree(label);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tlabel->len = NFS4_MAXLABELLEN;\n\n\treturn label;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs4_label *nfs4_label_alloc(struct nfs_server *server, gfp_t flags)\n{\n\tstruct nfs4_label *label = NULL;\n\tint minor_version = server->nfs_client->cl_minorversion;\n\n\tif (minor_version < 2)\n\t\treturn label;\n\n\tif (!(server->caps & NFS_CAP_SECURITY_LABEL))\n\t\treturn label;\n\n\tlabel = kzalloc(sizeof(struct nfs4_label), flags);\n\tif (label == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tlabel->label = kzalloc(NFS4_MAXLABELLEN, flags);\n\tif (label->label == NULL) {\n\t\tkfree(label);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tlabel->len = NFS4_MAXLABELLEN;\n\n\treturn label;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_INODEREVALIDATE"
          ],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_STALE",
          "args": [
            "inode"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_bad_inode",
          "args": [
            "inode"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "is_bad_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/bad_inode.c",
          "lines": "195-198",
          "snippet": "int is_bad_inode(struct inode *inode)\n{\n\treturn (inode->i_op == &bad_inode_ops);\t\n}",
          "includes": [
            "#include <linux/poll.h>",
            "#include <linux/namei.h>",
            "#include <linux/time.h>",
            "#include <linux/stat.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct inode_operations bad_inode_ops =\n{\n\t.create\t\t= bad_inode_create,\n\t.lookup\t\t= bad_inode_lookup,\n\t.link\t\t= bad_inode_link,\n\t.unlink\t\t= bad_inode_unlink,\n\t.symlink\t= bad_inode_symlink,\n\t.mkdir\t\t= bad_inode_mkdir,\n\t.rmdir\t\t= bad_inode_rmdir,\n\t.mknod\t\t= bad_inode_mknod,\n\t.rename2\t= bad_inode_rename2,\n\t.readlink\t= bad_inode_readlink,\n\t/* follow_link must be no-op, otherwise unmounting this inode\n\t   won't work */\n\t/* put_link returns void */\n\t/* truncate returns void */\n\t.permission\t= bad_inode_permission,\n\t.getattr\t= bad_inode_getattr,\n\t.setattr\t= bad_inode_setattr,\n\t.setxattr\t= bad_inode_setxattr,\n\t.getxattr\t= bad_inode_getxattr,\n\t.listxattr\t= bad_inode_listxattr,\n\t.removexattr\t= bad_inode_removexattr,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/poll.h>\n#include <linux/namei.h>\n#include <linux/time.h>\n#include <linux/stat.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nstatic const struct inode_operations bad_inode_ops =\n{\n\t.create\t\t= bad_inode_create,\n\t.lookup\t\t= bad_inode_lookup,\n\t.link\t\t= bad_inode_link,\n\t.unlink\t\t= bad_inode_unlink,\n\t.symlink\t= bad_inode_symlink,\n\t.mkdir\t\t= bad_inode_mkdir,\n\t.rmdir\t\t= bad_inode_rmdir,\n\t.mknod\t\t= bad_inode_mknod,\n\t.rename2\t= bad_inode_rename2,\n\t.readlink\t= bad_inode_readlink,\n\t/* follow_link must be no-op, otherwise unmounting this inode\n\t   won't work */\n\t/* put_link returns void */\n\t/* truncate returns void */\n\t.permission\t= bad_inode_permission,\n\t.getattr\t= bad_inode_getattr,\n\t.setattr\t= bad_inode_setattr,\n\t.setxattr\t= bad_inode_setxattr,\n\t.getxattr\t= bad_inode_getxattr,\n\t.listxattr\t= bad_inode_listxattr,\n\t.removexattr\t= bad_inode_removexattr,\n};\n\nint is_bad_inode(struct inode *inode)\n{\n\treturn (inode->i_op == &bad_inode_ops);\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_nfs_revalidate_inode_enter",
          "args": [
            "inode"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "PAGECACHE",
            "\"NFS: revalidating (%s/%Lu)\\n\"",
            "inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(inode)"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "914-918",
    "snippet": "int nfs_release(struct inode *inode, struct file *filp)\n{\n\tnfs_file_clear_open_context(filp);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_file_clear_open_context",
          "args": [
            "filp"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_file_clear_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "883-896",
          "snippet": "static void nfs_file_clear_open_context(struct file *filp)\n{\n\tstruct nfs_open_context *ctx = nfs_file_open_context(filp);\n\n\tif (ctx) {\n\t\tstruct inode *inode = ctx->dentry->d_inode;\n\n\t\tfilp->private_data = NULL;\n\t\tspin_lock(&inode->i_lock);\n\t\tlist_move_tail(&ctx->list, &NFS_I(inode)->open_files);\n\t\tspin_unlock(&inode->i_lock);\n\t\t__put_nfs_open_context(ctx, filp->f_flags & O_DIRECT ? 0 : 1);\n\t}\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_file_clear_open_context(struct file *filp)\n{\n\tstruct nfs_open_context *ctx = nfs_file_open_context(filp);\n\n\tif (ctx) {\n\t\tstruct inode *inode = ctx->dentry->d_inode;\n\n\t\tfilp->private_data = NULL;\n\t\tspin_lock(&inode->i_lock);\n\t\tlist_move_tail(&ctx->list, &NFS_I(inode)->open_files);\n\t\tspin_unlock(&inode->i_lock);\n\t\t__put_nfs_open_context(ctx, filp->f_flags & O_DIRECT ? 0 : 1);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_release(struct inode *inode, struct file *filp)\n{\n\tnfs_file_clear_open_context(filp);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "901-912",
    "snippet": "int nfs_open(struct inode *inode, struct file *filp)\n{\n\tstruct nfs_open_context *ctx;\n\n\tctx = alloc_nfs_open_context(filp->f_path.dentry, filp->f_mode);\n\tif (IS_ERR(ctx))\n\t\treturn PTR_ERR(ctx);\n\tnfs_file_set_open_context(filp, ctx);\n\tput_nfs_open_context(ctx);\n\tnfs_fscache_open_file(inode, filp);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fscache_open_file",
          "args": [
            "inode",
            "filp"
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_open_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "233-252",
          "snippet": "void nfs_fscache_open_file(struct inode *inode, struct file *filp)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct fscache_cookie *cookie = nfs_i_fscache(inode);\n\n\tif (!fscache_cookie_valid(cookie))\n\t\treturn;\n\n\tif (inode_is_open_for_write(inode)) {\n\t\tdfprintk(FSCACHE, \"NFS: nfsi 0x%p disabling cache\\n\", nfsi);\n\t\tclear_bit(NFS_INO_FSCACHE, &nfsi->flags);\n\t\tfscache_disable_cookie(cookie, true);\n\t\tfscache_uncache_all_inode_pages(cookie, inode);\n\t} else {\n\t\tdfprintk(FSCACHE, \"NFS: nfsi 0x%p enabling cache\\n\", nfsi);\n\t\tfscache_enable_cookie(cookie, nfs_fscache_can_enable, inode);\n\t\tif (fscache_cookie_enabled(cookie))\n\t\t\tset_bit(NFS_INO_FSCACHE, &NFS_I(inode)->flags);\n\t}\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid nfs_fscache_open_file(struct inode *inode, struct file *filp)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct fscache_cookie *cookie = nfs_i_fscache(inode);\n\n\tif (!fscache_cookie_valid(cookie))\n\t\treturn;\n\n\tif (inode_is_open_for_write(inode)) {\n\t\tdfprintk(FSCACHE, \"NFS: nfsi 0x%p disabling cache\\n\", nfsi);\n\t\tclear_bit(NFS_INO_FSCACHE, &nfsi->flags);\n\t\tfscache_disable_cookie(cookie, true);\n\t\tfscache_uncache_all_inode_pages(cookie, inode);\n\t} else {\n\t\tdfprintk(FSCACHE, \"NFS: nfsi 0x%p enabling cache\\n\", nfsi);\n\t\tfscache_enable_cookie(cookie, nfs_fscache_can_enable, inode);\n\t\tif (fscache_cookie_enabled(cookie))\n\t\t\tset_bit(NFS_INO_FSCACHE, &NFS_I(inode)->flags);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_nfs_open_context",
          "args": [
            "ctx"
          ],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "833-836",
          "snippet": "void put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_set_open_context",
          "args": [
            "filp",
            "ctx"
          ],
          "line": 908
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_file_set_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "854-859",
          "snippet": "void nfs_file_set_open_context(struct file *filp, struct nfs_open_context *ctx)\n{\n\tfilp->private_data = get_nfs_open_context(ctx);\n\tif (list_empty(&ctx->list))\n\t\tnfs_inode_attach_open_context(ctx);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_file_set_open_context(struct file *filp, struct nfs_open_context *ctx)\n{\n\tfilp->private_data = get_nfs_open_context(ctx);\n\tif (list_empty(&ctx->list))\n\t\tnfs_inode_attach_open_context(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "ctx"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "ctx"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_nfs_open_context",
          "args": [
            "filp->f_path.dentry",
            "filp->f_mode"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "776-800",
          "snippet": "struct nfs_open_context *alloc_nfs_open_context(struct dentry *dentry, fmode_t f_mode)\n{\n\tstruct nfs_open_context *ctx;\n\tstruct rpc_cred *cred = rpc_lookup_cred();\n\tif (IS_ERR(cred))\n\t\treturn ERR_CAST(cred);\n\n\tctx = kmalloc(sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx) {\n\t\tput_rpccred(cred);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tnfs_sb_active(dentry->d_sb);\n\tctx->dentry = dget(dentry);\n\tctx->cred = cred;\n\tctx->state = NULL;\n\tctx->mode = f_mode;\n\tctx->flags = 0;\n\tctx->error = 0;\n\tnfs_init_lock_context(&ctx->lock_context);\n\tctx->lock_context.open_context = ctx;\n\tINIT_LIST_HEAD(&ctx->list);\n\tctx->mdsthreshold = NULL;\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *alloc_nfs_open_context(struct dentry *dentry, fmode_t f_mode)\n{\n\tstruct nfs_open_context *ctx;\n\tstruct rpc_cred *cred = rpc_lookup_cred();\n\tif (IS_ERR(cred))\n\t\treturn ERR_CAST(cred);\n\n\tctx = kmalloc(sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx) {\n\t\tput_rpccred(cred);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tnfs_sb_active(dentry->d_sb);\n\tctx->dentry = dget(dentry);\n\tctx->cred = cred;\n\tctx->state = NULL;\n\tctx->mode = f_mode;\n\tctx->flags = 0;\n\tctx->error = 0;\n\tnfs_init_lock_context(&ctx->lock_context);\n\tctx->lock_context.open_context = ctx;\n\tINIT_LIST_HEAD(&ctx->list);\n\tctx->mdsthreshold = NULL;\n\treturn ctx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_open(struct inode *inode, struct file *filp)\n{\n\tstruct nfs_open_context *ctx;\n\n\tctx = alloc_nfs_open_context(filp->f_path.dentry, filp->f_mode);\n\tif (IS_ERR(ctx))\n\t\treturn PTR_ERR(ctx);\n\tnfs_file_set_open_context(filp, ctx);\n\tput_nfs_open_context(ctx);\n\tnfs_fscache_open_file(inode, filp);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_file_clear_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "883-896",
    "snippet": "static void nfs_file_clear_open_context(struct file *filp)\n{\n\tstruct nfs_open_context *ctx = nfs_file_open_context(filp);\n\n\tif (ctx) {\n\t\tstruct inode *inode = ctx->dentry->d_inode;\n\n\t\tfilp->private_data = NULL;\n\t\tspin_lock(&inode->i_lock);\n\t\tlist_move_tail(&ctx->list, &NFS_I(inode)->open_files);\n\t\tspin_unlock(&inode->i_lock);\n\t\t__put_nfs_open_context(ctx, filp->f_flags & O_DIRECT ? 0 : 1);\n\t}\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_nfs_open_context",
          "args": [
            "ctx",
            "filp->f_flags & O_DIRECT ? 0 : 1"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "__put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "811-831",
          "snippet": "static void __put_nfs_open_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct super_block *sb = ctx->dentry->d_sb;\n\n\tif (!list_empty(&ctx->list)) {\n\t\tif (!atomic_dec_and_lock(&ctx->lock_context.count, &inode->i_lock))\n\t\t\treturn;\n\t\tlist_del(&ctx->list);\n\t\tspin_unlock(&inode->i_lock);\n\t} else if (!atomic_dec_and_test(&ctx->lock_context.count))\n\t\treturn;\n\tif (inode != NULL)\n\t\tNFS_PROTO(inode)->close_context(ctx, is_sync);\n\tif (ctx->cred != NULL)\n\t\tput_rpccred(ctx->cred);\n\tdput(ctx->dentry);\n\tnfs_sb_deactive(sb);\n\tkfree(ctx->mdsthreshold);\n\tkfree(ctx);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void __put_nfs_open_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct super_block *sb = ctx->dentry->d_sb;\n\n\tif (!list_empty(&ctx->list)) {\n\t\tif (!atomic_dec_and_lock(&ctx->lock_context.count, &inode->i_lock))\n\t\t\treturn;\n\t\tlist_del(&ctx->list);\n\t\tspin_unlock(&inode->i_lock);\n\t} else if (!atomic_dec_and_test(&ctx->lock_context.count))\n\t\treturn;\n\tif (inode != NULL)\n\t\tNFS_PROTO(inode)->close_context(ctx, is_sync);\n\tif (ctx->cred != NULL)\n\t\tput_rpccred(ctx->cred);\n\tdput(ctx->dentry);\n\tnfs_sb_deactive(sb);\n\tkfree(ctx->mdsthreshold);\n\tkfree(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_move_tail",
          "args": [
            "&ctx->list",
            "&NFS_I(inode)->open_files"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_open_context",
          "args": [
            "filp"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_file_clear_open_context(struct file *filp)\n{\n\tstruct nfs_open_context *ctx = nfs_file_open_context(filp);\n\n\tif (ctx) {\n\t\tstruct inode *inode = ctx->dentry->d_inode;\n\n\t\tfilp->private_data = NULL;\n\t\tspin_lock(&inode->i_lock);\n\t\tlist_move_tail(&ctx->list, &NFS_I(inode)->open_files);\n\t\tspin_unlock(&inode->i_lock);\n\t\t__put_nfs_open_context(ctx, filp->f_flags & O_DIRECT ? 0 : 1);\n\t}\n}"
  },
  {
    "function_name": "nfs_find_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "865-881",
    "snippet": "struct nfs_open_context *nfs_find_open_context(struct inode *inode, struct rpc_cred *cred, fmode_t mode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *pos, *ctx = NULL;\n\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(pos, &nfsi->open_files, list) {\n\t\tif (cred != NULL && pos->cred != cred)\n\t\t\tcontinue;\n\t\tif ((pos->mode & (FMODE_READ|FMODE_WRITE)) != mode)\n\t\t\tcontinue;\n\t\tctx = get_nfs_open_context(pos);\n\t\tbreak;\n\t}\n\tspin_unlock(&inode->i_lock);\n\treturn ctx;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "pos"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "pos",
            "&nfsi->open_files",
            "list"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstruct nfs_open_context *nfs_find_open_context(struct inode *inode, struct rpc_cred *cred, fmode_t mode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *pos, *ctx = NULL;\n\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(pos, &nfsi->open_files, list) {\n\t\tif (cred != NULL && pos->cred != cred)\n\t\t\tcontinue;\n\t\tif ((pos->mode & (FMODE_READ|FMODE_WRITE)) != mode)\n\t\t\tcontinue;\n\t\tctx = get_nfs_open_context(pos);\n\t\tbreak;\n\t}\n\tspin_unlock(&inode->i_lock);\n\treturn ctx;\n}"
  },
  {
    "function_name": "nfs_file_set_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "854-859",
    "snippet": "void nfs_file_set_open_context(struct file *filp, struct nfs_open_context *ctx)\n{\n\tfilp->private_data = get_nfs_open_context(ctx);\n\tif (list_empty(&ctx->list))\n\t\tnfs_inode_attach_open_context(ctx);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_inode_attach_open_context",
          "args": [
            "ctx"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_attach_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "843-851",
          "snippet": "void nfs_inode_attach_open_context(struct nfs_open_context *ctx)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tspin_lock(&inode->i_lock);\n\tlist_add(&ctx->list, &nfsi->open_files);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_inode_attach_open_context(struct nfs_open_context *ctx)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tspin_lock(&inode->i_lock);\n\tlist_add(&ctx->list, &nfsi->open_files);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ctx->list"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "ctx"
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_file_set_open_context(struct file *filp, struct nfs_open_context *ctx)\n{\n\tfilp->private_data = get_nfs_open_context(ctx);\n\tif (list_empty(&ctx->list))\n\t\tnfs_inode_attach_open_context(ctx);\n}"
  },
  {
    "function_name": "nfs_inode_attach_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "843-851",
    "snippet": "void nfs_inode_attach_open_context(struct nfs_open_context *ctx)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tspin_lock(&inode->i_lock);\n\tlist_add(&ctx->list, &nfsi->open_files);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 850
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&ctx->list",
            "&nfsi->open_files"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_inode_attach_open_context(struct nfs_open_context *ctx)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tspin_lock(&inode->i_lock);\n\tlist_add(&ctx->list, &nfsi->open_files);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "put_nfs_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "833-836",
    "snippet": "void put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_nfs_open_context",
          "args": [
            "ctx",
            "0"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "__put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "811-831",
          "snippet": "static void __put_nfs_open_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct super_block *sb = ctx->dentry->d_sb;\n\n\tif (!list_empty(&ctx->list)) {\n\t\tif (!atomic_dec_and_lock(&ctx->lock_context.count, &inode->i_lock))\n\t\t\treturn;\n\t\tlist_del(&ctx->list);\n\t\tspin_unlock(&inode->i_lock);\n\t} else if (!atomic_dec_and_test(&ctx->lock_context.count))\n\t\treturn;\n\tif (inode != NULL)\n\t\tNFS_PROTO(inode)->close_context(ctx, is_sync);\n\tif (ctx->cred != NULL)\n\t\tput_rpccred(ctx->cred);\n\tdput(ctx->dentry);\n\tnfs_sb_deactive(sb);\n\tkfree(ctx->mdsthreshold);\n\tkfree(ctx);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void __put_nfs_open_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct super_block *sb = ctx->dentry->d_sb;\n\n\tif (!list_empty(&ctx->list)) {\n\t\tif (!atomic_dec_and_lock(&ctx->lock_context.count, &inode->i_lock))\n\t\t\treturn;\n\t\tlist_del(&ctx->list);\n\t\tspin_unlock(&inode->i_lock);\n\t} else if (!atomic_dec_and_test(&ctx->lock_context.count))\n\t\treturn;\n\tif (inode != NULL)\n\t\tNFS_PROTO(inode)->close_context(ctx, is_sync);\n\tif (ctx->cred != NULL)\n\t\tput_rpccred(ctx->cred);\n\tdput(ctx->dentry);\n\tnfs_sb_deactive(sb);\n\tkfree(ctx->mdsthreshold);\n\tkfree(ctx);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}"
  },
  {
    "function_name": "__put_nfs_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "811-831",
    "snippet": "static void __put_nfs_open_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct super_block *sb = ctx->dentry->d_sb;\n\n\tif (!list_empty(&ctx->list)) {\n\t\tif (!atomic_dec_and_lock(&ctx->lock_context.count, &inode->i_lock))\n\t\t\treturn;\n\t\tlist_del(&ctx->list);\n\t\tspin_unlock(&inode->i_lock);\n\t} else if (!atomic_dec_and_test(&ctx->lock_context.count))\n\t\treturn;\n\tif (inode != NULL)\n\t\tNFS_PROTO(inode)->close_context(ctx, is_sync);\n\tif (ctx->cred != NULL)\n\t\tput_rpccred(ctx->cred);\n\tdput(ctx->dentry);\n\tnfs_sb_deactive(sb);\n\tkfree(ctx->mdsthreshold);\n\tkfree(ctx);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ctx"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ctx->mdsthreshold"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_sb_deactive",
          "args": [
            "sb"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sb_deactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "419-425",
          "snippet": "void nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "ctx->dentry"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_rpccred",
          "args": [
            "ctx->cred"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "ctx",
            "is_sync"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&ctx->lock_context.count"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&ctx->list"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_lock",
          "args": [
            "&ctx->lock_context.count",
            "&inode->i_lock"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ctx->list"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void __put_nfs_open_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode = ctx->dentry->d_inode;\n\tstruct super_block *sb = ctx->dentry->d_sb;\n\n\tif (!list_empty(&ctx->list)) {\n\t\tif (!atomic_dec_and_lock(&ctx->lock_context.count, &inode->i_lock))\n\t\t\treturn;\n\t\tlist_del(&ctx->list);\n\t\tspin_unlock(&inode->i_lock);\n\t} else if (!atomic_dec_and_test(&ctx->lock_context.count))\n\t\treturn;\n\tif (inode != NULL)\n\t\tNFS_PROTO(inode)->close_context(ctx, is_sync);\n\tif (ctx->cred != NULL)\n\t\tput_rpccred(ctx->cred);\n\tdput(ctx->dentry);\n\tnfs_sb_deactive(sb);\n\tkfree(ctx->mdsthreshold);\n\tkfree(ctx);\n}"
  },
  {
    "function_name": "get_nfs_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "803-808",
    "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&ctx->lock_context.count"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
  },
  {
    "function_name": "alloc_nfs_open_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "776-800",
    "snippet": "struct nfs_open_context *alloc_nfs_open_context(struct dentry *dentry, fmode_t f_mode)\n{\n\tstruct nfs_open_context *ctx;\n\tstruct rpc_cred *cred = rpc_lookup_cred();\n\tif (IS_ERR(cred))\n\t\treturn ERR_CAST(cred);\n\n\tctx = kmalloc(sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx) {\n\t\tput_rpccred(cred);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tnfs_sb_active(dentry->d_sb);\n\tctx->dentry = dget(dentry);\n\tctx->cred = cred;\n\tctx->state = NULL;\n\tctx->mode = f_mode;\n\tctx->flags = 0;\n\tctx->error = 0;\n\tnfs_init_lock_context(&ctx->lock_context);\n\tctx->lock_context.open_context = ctx;\n\tINIT_LIST_HEAD(&ctx->list);\n\tctx->mdsthreshold = NULL;\n\treturn ctx;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ctx->list"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_init_lock_context",
          "args": [
            "&ctx->lock_context"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "683-690",
          "snippet": "static void nfs_init_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tatomic_set(&l_ctx->count, 1);\n\tl_ctx->lockowner.l_owner = current->files;\n\tl_ctx->lockowner.l_pid = current->tgid;\n\tINIT_LIST_HEAD(&l_ctx->list);\n\tnfs_iocounter_init(&l_ctx->io_count);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_init_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tatomic_set(&l_ctx->count, 1);\n\tl_ctx->lockowner.l_owner = current->files;\n\tl_ctx->lockowner.l_pid = current->tgid;\n\tINIT_LIST_HEAD(&l_ctx->list);\n\tnfs_iocounter_init(&l_ctx->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dget",
          "args": [
            "dentry"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "dget_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "777-814",
          "snippet": "struct dentry *dget_parent(struct dentry *dentry)\n{\n\tint gotref;\n\tstruct dentry *ret;\n\n\t/*\n\t * Do optimistic parent lookup without any\n\t * locking.\n\t */\n\trcu_read_lock();\n\tret = ACCESS_ONCE(dentry->d_parent);\n\tgotref = lockref_get_not_zero(&ret->d_lockref);\n\trcu_read_unlock();\n\tif (likely(gotref)) {\n\t\tif (likely(ret == ACCESS_ONCE(dentry->d_parent)))\n\t\t\treturn ret;\n\t\tdput(ret);\n\t}\n\nrepeat:\n\t/*\n\t * Don't need rcu_dereference because we re-check it was correct under\n\t * the lock.\n\t */\n\trcu_read_lock();\n\tret = dentry->d_parent;\n\tspin_lock(&ret->d_lock);\n\tif (unlikely(ret != dentry->d_parent)) {\n\t\tspin_unlock(&ret->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto repeat;\n\t}\n\trcu_read_unlock();\n\tBUG_ON(!ret->d_lockref.count);\n\tret->d_lockref.count++;\n\tspin_unlock(&ret->d_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *dget_parent(struct dentry *dentry)\n{\n\tint gotref;\n\tstruct dentry *ret;\n\n\t/*\n\t * Do optimistic parent lookup without any\n\t * locking.\n\t */\n\trcu_read_lock();\n\tret = ACCESS_ONCE(dentry->d_parent);\n\tgotref = lockref_get_not_zero(&ret->d_lockref);\n\trcu_read_unlock();\n\tif (likely(gotref)) {\n\t\tif (likely(ret == ACCESS_ONCE(dentry->d_parent)))\n\t\t\treturn ret;\n\t\tdput(ret);\n\t}\n\nrepeat:\n\t/*\n\t * Don't need rcu_dereference because we re-check it was correct under\n\t * the lock.\n\t */\n\trcu_read_lock();\n\tret = dentry->d_parent;\n\tspin_lock(&ret->d_lock);\n\tif (unlikely(ret != dentry->d_parent)) {\n\t\tspin_unlock(&ret->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto repeat;\n\t}\n\trcu_read_unlock();\n\tBUG_ON(!ret->d_lockref.count);\n\tret->d_lockref.count++;\n\tspin_unlock(&ret->d_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_sb_active",
          "args": [
            "dentry->d_sb"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sb_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "407-416",
          "snippet": "bool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nbool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_rpccred",
          "args": [
            "cred"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*ctx)",
            "GFP_KERNEL"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "cred"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cred"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_lookup_cred",
          "args": [],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *alloc_nfs_open_context(struct dentry *dentry, fmode_t f_mode)\n{\n\tstruct nfs_open_context *ctx;\n\tstruct rpc_cred *cred = rpc_lookup_cred();\n\tif (IS_ERR(cred))\n\t\treturn ERR_CAST(cred);\n\n\tctx = kmalloc(sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx) {\n\t\tput_rpccred(cred);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tnfs_sb_active(dentry->d_sb);\n\tctx->dentry = dget(dentry);\n\tctx->cred = cred;\n\tctx->state = NULL;\n\tctx->mode = f_mode;\n\tctx->flags = 0;\n\tctx->error = 0;\n\tnfs_init_lock_context(&ctx->lock_context);\n\tctx->lock_context.open_context = ctx;\n\tINIT_LIST_HEAD(&ctx->list);\n\tctx->mdsthreshold = NULL;\n\treturn ctx;\n}"
  },
  {
    "function_name": "nfs_close_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "757-773",
    "snippet": "void nfs_close_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode;\n\tstruct nfs_server *server;\n\n\tif (!(ctx->mode & FMODE_WRITE))\n\t\treturn;\n\tif (!is_sync)\n\t\treturn;\n\tinode = ctx->dentry->d_inode;\n\tif (!list_empty(&NFS_I(inode)->open_files))\n\t\treturn;\n\tserver = NFS_SERVER(inode);\n\tif (server->flags & NFS_MOUNT_NOCTO)\n\t\treturn;\n\tnfs_revalidate_inode(server, inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_revalidate_inode",
          "args": [
            "server",
            "inode"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_revalidate_inode_rcu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1022-1029",
          "snippet": "int nfs_revalidate_inode_rcu(struct nfs_server *server, struct inode *inode)\n{\n\tif (!(NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\t\t&& !nfs_attribute_cache_expired(inode))\n\t\treturn NFS_STALE(inode) ? -ESTALE : 0;\n\treturn -ECHILD;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_revalidate_inode_rcu(struct nfs_server *server, struct inode *inode)\n{\n\tif (!(NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\t\t&& !nfs_attribute_cache_expired(inode))\n\t\treturn NFS_STALE(inode) ? -ESTALE : 0;\n\treturn -ECHILD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&NFS_I(inode)->open_files"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_close_context(struct nfs_open_context *ctx, int is_sync)\n{\n\tstruct inode *inode;\n\tstruct nfs_server *server;\n\n\tif (!(ctx->mode & FMODE_WRITE))\n\t\treturn;\n\tif (!is_sync)\n\t\treturn;\n\tinode = ctx->dentry->d_inode;\n\tif (!list_empty(&NFS_I(inode)->open_files))\n\t\treturn;\n\tserver = NFS_SERVER(inode);\n\tif (server->flags & NFS_MOUNT_NOCTO)\n\t\treturn;\n\tnfs_revalidate_inode(server, inode);\n}"
  },
  {
    "function_name": "nfs_put_lock_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "736-746",
    "snippet": "void nfs_put_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tstruct nfs_open_context *ctx = l_ctx->open_context;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tif (!atomic_dec_and_lock(&l_ctx->count, &inode->i_lock))\n\t\treturn;\n\tlist_del(&l_ctx->list);\n\tspin_unlock(&inode->i_lock);\n\tkfree(l_ctx);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "l_ctx"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&l_ctx->list"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_lock",
          "args": [
            "&l_ctx->count",
            "&inode->i_lock"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_put_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tstruct nfs_open_context *ctx = l_ctx->open_context;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tif (!atomic_dec_and_lock(&l_ctx->count, &inode->i_lock))\n\t\treturn;\n\tlist_del(&l_ctx->list);\n\tspin_unlock(&inode->i_lock);\n\tkfree(l_ctx);\n}"
  },
  {
    "function_name": "nfs_get_lock_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "708-733",
    "snippet": "struct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&new->list",
            "&ctx->lock_context.list"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__nfs_find_lock_context",
          "args": [
            "ctx"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_find_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "692-706",
          "snippet": "static struct nfs_lock_context *__nfs_find_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *head = &ctx->lock_context;\n\tstruct nfs_lock_context *pos = head;\n\n\tdo {\n\t\tif (pos->lockowner.l_owner != current->files)\n\t\t\tcontinue;\n\t\tif (pos->lockowner.l_pid != current->tgid)\n\t\t\tcontinue;\n\t\tatomic_inc(&pos->count);\n\t\treturn pos;\n\t} while ((pos = list_entry(pos->list.next, typeof(*pos), list)) != head);\n\treturn NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_lock_context *__nfs_find_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *head = &ctx->lock_context;\n\tstruct nfs_lock_context *pos = head;\n\n\tdo {\n\t\tif (pos->lockowner.l_owner != current->files)\n\t\t\tcontinue;\n\t\tif (pos->lockowner.l_pid != current->tgid)\n\t\t\tcontinue;\n\t\tatomic_inc(&pos->count);\n\t\treturn pos;\n\t} while ((pos = list_entry(pos->list.next, typeof(*pos), list)) != head);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_lock_context",
          "args": [
            "new"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_lock_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "683-690",
          "snippet": "static void nfs_init_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tatomic_set(&l_ctx->count, 1);\n\tl_ctx->lockowner.l_owner = current->files;\n\tl_ctx->lockowner.l_pid = current->tgid;\n\tINIT_LIST_HEAD(&l_ctx->list);\n\tnfs_iocounter_init(&l_ctx->io_count);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_init_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tatomic_set(&l_ctx->count, 1);\n\tl_ctx->lockowner.l_owner = current->files;\n\tl_ctx->lockowner.l_pid = current->tgid;\n\tINIT_LIST_HEAD(&l_ctx->list);\n\tnfs_iocounter_init(&l_ctx->io_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*new)",
            "GFP_KERNEL"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstruct nfs_lock_context *nfs_get_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *res, *new = NULL;\n\tstruct inode *inode = ctx->dentry->d_inode;\n\n\tspin_lock(&inode->i_lock);\n\tres = __nfs_find_lock_context(ctx);\n\tif (res == NULL) {\n\t\tspin_unlock(&inode->i_lock);\n\t\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\t\tif (new == NULL)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\tnfs_init_lock_context(new);\n\t\tspin_lock(&inode->i_lock);\n\t\tres = __nfs_find_lock_context(ctx);\n\t\tif (res == NULL) {\n\t\t\tlist_add_tail(&new->list, &ctx->lock_context.list);\n\t\t\tnew->open_context = ctx;\n\t\t\tres = new;\n\t\t\tnew = NULL;\n\t\t}\n\t}\n\tspin_unlock(&inode->i_lock);\n\tkfree(new);\n\treturn res;\n}"
  },
  {
    "function_name": "__nfs_find_lock_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "692-706",
    "snippet": "static struct nfs_lock_context *__nfs_find_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *head = &ctx->lock_context;\n\tstruct nfs_lock_context *pos = head;\n\n\tdo {\n\t\tif (pos->lockowner.l_owner != current->files)\n\t\t\tcontinue;\n\t\tif (pos->lockowner.l_pid != current->tgid)\n\t\t\tcontinue;\n\t\tatomic_inc(&pos->count);\n\t\treturn pos;\n\t} while ((pos = list_entry(pos->list.next, typeof(*pos), list)) != head);\n\treturn NULL;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "pos->list.next",
            "typeof(*pos)",
            "list"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeof",
          "args": [
            "*pos"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&pos->count"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_lock_context *__nfs_find_lock_context(struct nfs_open_context *ctx)\n{\n\tstruct nfs_lock_context *head = &ctx->lock_context;\n\tstruct nfs_lock_context *pos = head;\n\n\tdo {\n\t\tif (pos->lockowner.l_owner != current->files)\n\t\t\tcontinue;\n\t\tif (pos->lockowner.l_pid != current->tgid)\n\t\t\tcontinue;\n\t\tatomic_inc(&pos->count);\n\t\treturn pos;\n\t} while ((pos = list_entry(pos->list.next, typeof(*pos), list)) != head);\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs_init_lock_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "683-690",
    "snippet": "static void nfs_init_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tatomic_set(&l_ctx->count, 1);\n\tl_ctx->lockowner.l_owner = current->files;\n\tl_ctx->lockowner.l_pid = current->tgid;\n\tINIT_LIST_HEAD(&l_ctx->list);\n\tnfs_iocounter_init(&l_ctx->io_count);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_iocounter_init",
          "args": [
            "&l_ctx->io_count"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_iocounter_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "259-263",
          "snippet": "static inline void nfs_iocounter_init(struct nfs_io_counter *c)\n{\n\tc->flags = 0;\n\tatomic_set(&c->io_count, 0);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nfs_iocounter_wait(struct nfs_io_counter *c);",
            "int nfs_initiate_pgio(struct rpc_clnt *clnt, struct nfs_pgio_header *hdr,\n\t\t      struct rpc_cred *cred, const struct nfs_rpc_ops *rpc_ops,\n\t\t      const struct rpc_call_ops *call_ops, int how, int flags);",
            "extern char *nfs_path(char **p, struct dentry *dentry,\n\t\t      char *buffer, ssize_t buflen, unsigned flags);",
            "extern int nfs_initiate_commit(struct rpc_clnt *clnt,\n\t\t\t       struct nfs_commit_data *data,\n\t\t\t       const struct nfs_rpc_ops *nfs_ops,\n\t\t\t       const struct rpc_call_ops *call_ops,\n\t\t\t       int how, int flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nint nfs_iocounter_wait(struct nfs_io_counter *c);\nint nfs_initiate_pgio(struct rpc_clnt *clnt, struct nfs_pgio_header *hdr,\n\t\t      struct rpc_cred *cred, const struct nfs_rpc_ops *rpc_ops,\n\t\t      const struct rpc_call_ops *call_ops, int how, int flags);\nextern char *nfs_path(char **p, struct dentry *dentry,\n\t\t      char *buffer, ssize_t buflen, unsigned flags);\nextern int nfs_initiate_commit(struct rpc_clnt *clnt,\n\t\t\t       struct nfs_commit_data *data,\n\t\t\t       const struct nfs_rpc_ops *nfs_ops,\n\t\t\t       const struct rpc_call_ops *call_ops,\n\t\t\t       int how, int flags);\n\nstatic inline void nfs_iocounter_init(struct nfs_io_counter *c)\n{\n\tc->flags = 0;\n\tatomic_set(&c->io_count, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&l_ctx->list"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&l_ctx->count",
            "1"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_init_lock_context(struct nfs_lock_context *l_ctx)\n{\n\tatomic_set(&l_ctx->count, 1);\n\tl_ctx->lockowner.l_owner = current->files;\n\tl_ctx->lockowner.l_pid = current->tgid;\n\tINIT_LIST_HEAD(&l_ctx->list);\n\tnfs_iocounter_init(&l_ctx->io_count);\n}"
  },
  {
    "function_name": "nfs_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "638-680",
    "snippet": "int nfs_getattr(struct vfsmount *mnt, struct dentry *dentry, struct kstat *stat)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tint need_atime = NFS_I(inode)->cache_validity & NFS_INO_INVALID_ATIME;\n\tint err = 0;\n\n\ttrace_nfs_getattr_enter(inode);\n\t/* Flush out writes to the server in order to update c/mtime.  */\n\tif (S_ISREG(inode->i_mode)) {\n\t\tnfs_inode_dio_wait(inode);\n\t\terr = filemap_write_and_wait(inode->i_mapping);\n\t\tif (err)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We may force a getattr if the user cares about atime.\n\t *\n\t * Note that we only have to check the vfsmount flags here:\n\t *  - NFS always sets S_NOATIME by so checking it would give a\n\t *    bogus result\n\t *  - NFS never sets MS_NOATIME or MS_NODIRATIME so there is\n\t *    no point in checking those.\n\t */\n \tif ((mnt->mnt_flags & MNT_NOATIME) ||\n \t    ((mnt->mnt_flags & MNT_NODIRATIME) && S_ISDIR(inode->i_mode)))\n\t\tneed_atime = 0;\n\n\tif (need_atime || nfs_need_revalidate_inode(inode)) {\n\t\tstruct nfs_server *server = NFS_SERVER(inode);\n\n\t\tif (server->caps & NFS_CAP_READDIRPLUS)\n\t\t\tnfs_request_parent_use_readdirplus(dentry);\n\t\terr = __nfs_revalidate_inode(server, inode);\n\t}\n\tif (!err) {\n\t\tgeneric_fillattr(inode, stat);\n\t\tstat->ino = nfs_compat_user_ino64(NFS_FILEID(inode));\n\t}\nout:\n\ttrace_nfs_getattr_exit(inode, err);\n\treturn err;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs_getattr_exit",
          "args": [
            "inode",
            "err"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_compat_user_ino64",
          "args": [
            "NFS_FILEID(inode)"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_compat_user_ino64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "94-108",
          "snippet": "u64 nfs_compat_user_ino64(u64 fileid)\n{\n#ifdef CONFIG_COMPAT\n\tcompat_ulong_t ino;\n#else\t\n\tunsigned long ino;\n#endif\n\n\tif (enable_ino64)\n\t\treturn fileid;\n\tino = fileid;\n\tif (sizeof(ino) < sizeof(fileid))\n\t\tino ^= fileid >> (sizeof(fileid)-sizeof(ino)) * 8;\n\treturn ino;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool enable_ino64 = NFS_64_BIT_INODE_NUMBERS_ENABLED;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic bool enable_ino64 = NFS_64_BIT_INODE_NUMBERS_ENABLED;\n\nu64 nfs_compat_user_ino64(u64 fileid)\n{\n#ifdef CONFIG_COMPAT\n\tcompat_ulong_t ino;\n#else\t\n\tunsigned long ino;\n#endif\n\n\tif (enable_ino64)\n\t\treturn fileid;\n\tino = fileid;\n\tif (sizeof(ino) < sizeof(fileid))\n\t\tino ^= fileid >> (sizeof(fileid)-sizeof(ino)) * 8;\n\treturn ino;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_fillattr",
          "args": [
            "inode",
            "stat"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "generic_fillattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "21-36",
          "snippet": "void generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = (1 << inode->i_blkbits);\n\tstat->blocks = inode->i_blocks;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = (1 << inode->i_blkbits);\n\tstat->blocks = inode->i_blocks;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nfs_revalidate_inode",
          "args": [
            "server",
            "inode"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_revalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "924-991",
          "snippet": "int\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint\n__nfs_revalidate_inode(struct nfs_server *server, struct inode *inode)\n{\n\tint\t\t status = -ESTALE;\n\tstruct nfs4_label *label = NULL;\n\tstruct nfs_fattr *fattr = NULL;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tdfprintk(PAGECACHE, \"NFS: revalidating (%s/%Lu)\\n\",\n\t\tinode->i_sb->s_id, (unsigned long long)NFS_FILEID(inode));\n\n\ttrace_nfs_revalidate_inode_enter(inode);\n\n\tif (is_bad_inode(inode))\n\t\tgoto out;\n\tif (NFS_STALE(inode))\n\t\tgoto out;\n\n\tstatus = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\n\tnfs_inc_stats(inode, NFSIOS_INODEREVALIDATE);\n\n\tlabel = nfs4_label_alloc(NFS_SERVER(inode), GFP_KERNEL);\n\tif (IS_ERR(label)) {\n\t\tstatus = PTR_ERR(label);\n\t\tgoto out;\n\t}\n\n\tstatus = NFS_PROTO(inode)->getattr(server, NFS_FH(inode), fattr, label);\n\tif (status != 0) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) getattr failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tif (status == -ESTALE) {\n\t\t\tnfs_zap_caches(inode);\n\t\t\tif (!S_ISDIR(inode->i_mode))\n\t\t\t\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\t\t}\n\t\tgoto err_out;\n\t}\n\n\tstatus = nfs_refresh_inode(inode, fattr);\n\tif (status) {\n\t\tdfprintk(PAGECACHE, \"nfs_revalidate_inode: (%s/%Lu) refresh failed, error=%d\\n\",\n\t\t\t inode->i_sb->s_id,\n\t\t\t (unsigned long long)NFS_FILEID(inode), status);\n\t\tgoto err_out;\n\t}\n\n\tif (nfsi->cache_validity & NFS_INO_INVALID_ACL)\n\t\tnfs_zap_acl_cache(inode);\n\n\tnfs_setsecurity(inode, fattr, label);\n\n\tdfprintk(PAGECACHE, \"NFS: (%s/%Lu) revalidation complete\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode));\n\nerr_out:\n\tnfs4_label_free(label);\nout:\n\tnfs_free_fattr(fattr);\n\ttrace_nfs_revalidate_inode_exit(inode, status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_request_parent_use_readdirplus",
          "args": [
            "dentry"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_request_parent_use_readdirplus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "619-626",
          "snippet": "static void nfs_request_parent_use_readdirplus(struct dentry *dentry)\n{\n\tstruct dentry *parent;\n\n\tparent = dget_parent(dentry);\n\tnfs_force_use_readdirplus(parent->d_inode);\n\tdput(parent);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_request_parent_use_readdirplus(struct dentry *dentry)\n{\n\tstruct dentry *parent;\n\n\tparent = dget_parent(dentry);\n\tnfs_force_use_readdirplus(parent->d_inode);\n\tdput(parent);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_need_revalidate_inode",
          "args": [
            "inode"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_need_revalidate_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "628-636",
          "snippet": "static bool nfs_need_revalidate_inode(struct inode *inode)\n{\n\tif (NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\treturn true;\n\tif (nfs_attribute_cache_expired(inode))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic bool nfs_need_revalidate_inode(struct inode *inode)\n{\n\tif (NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\treturn true;\n\tif (nfs_attribute_cache_expired(inode))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filemap_write_and_wait",
          "args": [
            "inode->i_mapping"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inode_dio_wait",
          "args": [
            "inode"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_dio_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "498-501",
          "snippet": "static inline void nfs_inode_dio_wait(struct inode *inode)\n{\n\tinode_dio_wait(inode);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);",
            "extern void nfs_destroy_inode(struct inode *);",
            "extern int nfs_drop_inode(struct inode *);",
            "extern void nfs_clear_inode(struct inode *);",
            "extern void nfs_evict_inode(struct inode *);",
            "void nfs_zap_acl_cache(struct inode *inode);",
            "int nfs_key_timeout_notify(struct file *filp, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);\nextern void nfs_destroy_inode(struct inode *);\nextern int nfs_drop_inode(struct inode *);\nextern void nfs_clear_inode(struct inode *);\nextern void nfs_evict_inode(struct inode *);\nvoid nfs_zap_acl_cache(struct inode *inode);\nint nfs_key_timeout_notify(struct file *filp, struct inode *inode);\n\nstatic inline void nfs_inode_dio_wait(struct inode *inode)\n{\n\tinode_dio_wait(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_nfs_getattr_enter",
          "args": [
            "inode"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_getattr(struct vfsmount *mnt, struct dentry *dentry, struct kstat *stat)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tint need_atime = NFS_I(inode)->cache_validity & NFS_INO_INVALID_ATIME;\n\tint err = 0;\n\n\ttrace_nfs_getattr_enter(inode);\n\t/* Flush out writes to the server in order to update c/mtime.  */\n\tif (S_ISREG(inode->i_mode)) {\n\t\tnfs_inode_dio_wait(inode);\n\t\terr = filemap_write_and_wait(inode->i_mapping);\n\t\tif (err)\n\t\t\tgoto out;\n\t}\n\n\t/*\n\t * We may force a getattr if the user cares about atime.\n\t *\n\t * Note that we only have to check the vfsmount flags here:\n\t *  - NFS always sets S_NOATIME by so checking it would give a\n\t *    bogus result\n\t *  - NFS never sets MS_NOATIME or MS_NODIRATIME so there is\n\t *    no point in checking those.\n\t */\n \tif ((mnt->mnt_flags & MNT_NOATIME) ||\n \t    ((mnt->mnt_flags & MNT_NODIRATIME) && S_ISDIR(inode->i_mode)))\n\t\tneed_atime = 0;\n\n\tif (need_atime || nfs_need_revalidate_inode(inode)) {\n\t\tstruct nfs_server *server = NFS_SERVER(inode);\n\n\t\tif (server->caps & NFS_CAP_READDIRPLUS)\n\t\t\tnfs_request_parent_use_readdirplus(dentry);\n\t\terr = __nfs_revalidate_inode(server, inode);\n\t}\n\tif (!err) {\n\t\tgeneric_fillattr(inode, stat);\n\t\tstat->ino = nfs_compat_user_ino64(NFS_FILEID(inode));\n\t}\nout:\n\ttrace_nfs_getattr_exit(inode, err);\n\treturn err;\n}"
  },
  {
    "function_name": "nfs_need_revalidate_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "628-636",
    "snippet": "static bool nfs_need_revalidate_inode(struct inode *inode)\n{\n\tif (NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\treturn true;\n\tif (nfs_attribute_cache_expired(inode))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_attribute_cache_expired",
          "args": [
            "inode"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_attribute_cache_expired",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1000-1005",
          "snippet": "int nfs_attribute_cache_expired(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\treturn nfs_attribute_timeout(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_attribute_cache_expired(struct inode *inode)\n{\n\tif (nfs_have_delegated_attributes(inode))\n\t\treturn 0;\n\treturn nfs_attribute_timeout(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic bool nfs_need_revalidate_inode(struct inode *inode)\n{\n\tif (NFS_I(inode)->cache_validity &\n\t\t\t(NFS_INO_INVALID_ATTR|NFS_INO_INVALID_LABEL))\n\t\treturn true;\n\tif (nfs_attribute_cache_expired(inode))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "nfs_request_parent_use_readdirplus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "619-626",
    "snippet": "static void nfs_request_parent_use_readdirplus(struct dentry *dentry)\n{\n\tstruct dentry *parent;\n\n\tparent = dget_parent(dentry);\n\tnfs_force_use_readdirplus(parent->d_inode);\n\tdput(parent);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "parent"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_force_use_readdirplus",
          "args": [
            "parent->d_inode"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_force_use_readdirplus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "462-468",
          "snippet": "void nfs_force_use_readdirplus(struct inode *dir)\n{\n\tif (!list_empty(&NFS_I(dir)->open_files)) {\n\t\tnfs_advise_use_readdirplus(dir);\n\t\tnfs_zap_mapping(dir, dir->i_mapping);\n\t}\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nvoid nfs_force_use_readdirplus(struct inode *dir)\n{\n\tif (!list_empty(&NFS_I(dir)->open_files)) {\n\t\tnfs_advise_use_readdirplus(dir);\n\t\tnfs_zap_mapping(dir, dir->i_mapping);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dget_parent",
          "args": [
            "dentry"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "dget_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "777-814",
          "snippet": "struct dentry *dget_parent(struct dentry *dentry)\n{\n\tint gotref;\n\tstruct dentry *ret;\n\n\t/*\n\t * Do optimistic parent lookup without any\n\t * locking.\n\t */\n\trcu_read_lock();\n\tret = ACCESS_ONCE(dentry->d_parent);\n\tgotref = lockref_get_not_zero(&ret->d_lockref);\n\trcu_read_unlock();\n\tif (likely(gotref)) {\n\t\tif (likely(ret == ACCESS_ONCE(dentry->d_parent)))\n\t\t\treturn ret;\n\t\tdput(ret);\n\t}\n\nrepeat:\n\t/*\n\t * Don't need rcu_dereference because we re-check it was correct under\n\t * the lock.\n\t */\n\trcu_read_lock();\n\tret = dentry->d_parent;\n\tspin_lock(&ret->d_lock);\n\tif (unlikely(ret != dentry->d_parent)) {\n\t\tspin_unlock(&ret->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto repeat;\n\t}\n\trcu_read_unlock();\n\tBUG_ON(!ret->d_lockref.count);\n\tret->d_lockref.count++;\n\tspin_unlock(&ret->d_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *dget_parent(struct dentry *dentry)\n{\n\tint gotref;\n\tstruct dentry *ret;\n\n\t/*\n\t * Do optimistic parent lookup without any\n\t * locking.\n\t */\n\trcu_read_lock();\n\tret = ACCESS_ONCE(dentry->d_parent);\n\tgotref = lockref_get_not_zero(&ret->d_lockref);\n\trcu_read_unlock();\n\tif (likely(gotref)) {\n\t\tif (likely(ret == ACCESS_ONCE(dentry->d_parent)))\n\t\t\treturn ret;\n\t\tdput(ret);\n\t}\n\nrepeat:\n\t/*\n\t * Don't need rcu_dereference because we re-check it was correct under\n\t * the lock.\n\t */\n\trcu_read_lock();\n\tret = dentry->d_parent;\n\tspin_lock(&ret->d_lock);\n\tif (unlikely(ret != dentry->d_parent)) {\n\t\tspin_unlock(&ret->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto repeat;\n\t}\n\trcu_read_unlock();\n\tBUG_ON(!ret->d_lockref.count);\n\tret->d_lockref.count++;\n\tspin_unlock(&ret->d_lock);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_request_parent_use_readdirplus(struct dentry *dentry)\n{\n\tstruct dentry *parent;\n\n\tparent = dget_parent(dentry);\n\tnfs_force_use_readdirplus(parent->d_inode);\n\tdput(parent);\n}"
  },
  {
    "function_name": "nfs_setattr_update_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "589-616",
    "snippet": "void nfs_setattr_update_inode(struct inode *inode, struct iattr *attr,\n\t\tstruct nfs_fattr *fattr)\n{\n\t/* Barrier: bump the attribute generation count. */\n\tnfs_fattr_set_barrier(fattr);\n\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->attr_gencount = fattr->gencount;\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0) {\n\t\tif ((attr->ia_valid & ATTR_MODE) != 0) {\n\t\t\tint mode = attr->ia_mode & S_IALLUGO;\n\t\t\tmode |= inode->i_mode & ~S_IALLUGO;\n\t\t\tinode->i_mode = mode;\n\t\t}\n\t\tif ((attr->ia_valid & ATTR_UID) != 0)\n\t\t\tinode->i_uid = attr->ia_uid;\n\t\tif ((attr->ia_valid & ATTR_GID) != 0)\n\t\t\tinode->i_gid = attr->ia_gid;\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL);\n\t}\n\tif ((attr->ia_valid & ATTR_SIZE) != 0) {\n\t\tnfs_inc_stats(inode, NFSIOS_SETATTRTRUNC);\n\t\tnfs_vmtruncate(inode, attr->ia_size);\n\t}\n\tnfs_update_inode(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_update_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1603-1817",
          "snippet": "static int nfs_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_isize, new_isize;\n\tunsigned long invalid = 0;\n\tunsigned long now = jiffies;\n\tunsigned long save_cache_validity;\n\n\tdfprintk(VFS, \"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\",\n\t\t\t__func__, inode->i_sb->s_id, inode->i_ino,\n\t\t\tnfs_display_fhandle_hash(NFS_FH(inode)),\n\t\t\tatomic_read(&inode->i_count), fattr->valid);\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid) {\n\t\tprintk(KERN_ERR \"NFS: server %s error: fileid changed\\n\"\n\t\t\t\"fsid %s: expected fileid 0x%Lx, got 0x%Lx\\n\",\n\t\t\tNFS_SERVER(inode)->nfs_client->cl_hostname,\n\t\t\tinode->i_sb->s_id, (long long)nfsi->fileid,\n\t\t\t(long long)fattr->fileid);\n\t\tgoto out_err;\n\t}\n\n\t/*\n\t * Make sure the inode's type hasn't changed.\n\t */\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT)) {\n\t\t/*\n\t\t* Big trouble! The inode has become a different object.\n\t\t*/\n\t\tprintk(KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\",\n\t\t\t\t__func__, inode->i_ino, inode->i_mode, fattr->mode);\n\t\tgoto out_err;\n\t}\n\n\tserver = NFS_SERVER(inode);\n\t/* Update the fsid? */\n\tif (S_ISDIR(inode->i_mode) && (fattr->valid & NFS_ATTR_FATTR_FSID) &&\n\t\t\t!nfs_fsid_equal(&server->fsid, &fattr->fsid) &&\n\t\t\t!IS_AUTOMOUNT(inode))\n\t\tserver->fsid = fattr->fsid;\n\n\t/*\n\t * Update the read time so we don't revalidate too often.\n\t */\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\n\tsave_cache_validity = nfsi->cache_validity;\n\tnfsi->cache_validity &= ~(NFS_INO_INVALID_ATTR\n\t\t\t| NFS_INO_INVALID_ATIME\n\t\t\t| NFS_INO_REVAL_FORCED\n\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\n\t/* Do atomic weak cache consistency updates */\n\tinvalid |= nfs_wcc_update_inode(inode, fattr);\n\n\t/* More cache consistency checks */\n\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE) {\n\t\tif (inode->i_version != fattr->change_attr) {\n\t\t\tdprintk(\"NFS: change_attr change on server for file %s/%ld\\n\",\n\t\t\t\t\tinode->i_sb->s_id, inode->i_ino);\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tnfs_force_lookup_revalidate(inode);\n\t\t\tinode->i_version = fattr->change_attr;\n\t\t}\n\t} else if (server->caps & NFS_CAP_CHANGE_ATTR)\n\t\tnfsi->cache_validity |= save_cache_validity;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MTIME) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t} else if (server->caps & NFS_CAP_MTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_CTIME) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t} else if (server->caps & NFS_CAP_CTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\t/* Check if our cached file size is stale */\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tcur_isize = i_size_read(inode);\n\t\tif (new_isize != cur_isize) {\n\t\t\t/* Do we perhaps have any outstanding writes, or has\n\t\t\t * the file grown beyond our last write? */\n\t\t\tif ((nfsi->nrequests == 0) || new_isize > cur_isize) {\n\t\t\t\ti_size_write(inode, new_isize);\n\t\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_DATA;\n\t\t\t\tinvalid &= ~NFS_INO_REVAL_PAGECACHE;\n\t\t\t}\n\t\t\tdprintk(\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\",\n\t\t\t\t\tinode->i_sb->s_id,\n\t\t\t\t\tinode->i_ino,\n\t\t\t\t\t(long long)cur_isize,\n\t\t\t\t\t(long long)new_isize);\n\t\t}\n\t} else\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\n\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\tmemcpy(&inode->i_atime, &fattr->atime, sizeof(inode->i_atime));\n\telse if (server->caps & NFS_CAP_ATIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATIME\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MODE) {\n\t\tif ((inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO)) {\n\t\t\tumode_t newmode = inode->i_mode & S_IFMT;\n\t\t\tnewmode |= fattr->mode & S_IALLUGO;\n\t\t\tinode->i_mode = newmode;\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t}\n\t} else if (server->caps & NFS_CAP_MODE)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER) {\n\t\tif (!uid_eq(inode->i_uid, fattr->uid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_uid = fattr->uid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP) {\n\t\tif (!gid_eq(inode->i_gid, fattr->gid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_gid = fattr->gid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER_GROUP)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_NLINK) {\n\t\tif (inode->i_nlink != fattr->nlink) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tinvalid |= NFS_INO_INVALID_DATA;\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\t}\n\t} else if (server->caps & NFS_CAP_NLINK)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t/*\n\t\t * report the blocks in 512byte units\n\t\t */\n\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n \t}\n\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\n\t/* Update attrtimeo value if we're out of the unstable period */\n\tif (invalid & NFS_INO_INVALID_ATTR) {\n\t\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\t/* Set barrier to be more recent than all outstanding updates */\n\t\tnfsi->attr_gencount = nfs_inc_attr_generation_counter();\n\t} else {\n\t\tif (!time_in_range_open(now, nfsi->attrtimeo_timestamp, nfsi->attrtimeo_timestamp + nfsi->attrtimeo)) {\n\t\t\tif ((nfsi->attrtimeo <<= 1) > NFS_MAXATTRTIMEO(inode))\n\t\t\t\tnfsi->attrtimeo = NFS_MAXATTRTIMEO(inode);\n\t\t\tnfsi->attrtimeo_timestamp = now;\n\t\t}\n\t\t/* Set the barrier to be more recent than this fattr */\n\t\tif ((long)fattr->gencount - (long)nfsi->attr_gencount > 0)\n\t\t\tnfsi->attr_gencount = fattr->gencount;\n\t}\n\tinvalid &= ~NFS_INO_INVALID_ATTR;\n\t/* Don't invalidate the data if we were to blame */\n\tif (!(S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode)\n\t\t\t\t|| S_ISLNK(inode->i_mode)))\n\t\tinvalid &= ~NFS_INO_INVALID_DATA;\n\tif (!NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) ||\n\t\t\t(save_cache_validity & NFS_INO_REVAL_FORCED))\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\treturn 0;\n out_err:\n\t/*\n\t * No need to worry about unhashing the dentry, as the\n\t * lookup validation will know that the inode is bad.\n\t * (But we fall through to invalidate the caches.)\n\t */\n\tnfs_invalidate_inode(inode);\n\treturn -ESTALE;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int nfs_update_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tloff_t cur_isize, new_isize;\n\tunsigned long invalid = 0;\n\tunsigned long now = jiffies;\n\tunsigned long save_cache_validity;\n\n\tdfprintk(VFS, \"NFS: %s(%s/%lu fh_crc=0x%08x ct=%d info=0x%x)\\n\",\n\t\t\t__func__, inode->i_sb->s_id, inode->i_ino,\n\t\t\tnfs_display_fhandle_hash(NFS_FH(inode)),\n\t\t\tatomic_read(&inode->i_count), fattr->valid);\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_FILEID) && nfsi->fileid != fattr->fileid) {\n\t\tprintk(KERN_ERR \"NFS: server %s error: fileid changed\\n\"\n\t\t\t\"fsid %s: expected fileid 0x%Lx, got 0x%Lx\\n\",\n\t\t\tNFS_SERVER(inode)->nfs_client->cl_hostname,\n\t\t\tinode->i_sb->s_id, (long long)nfsi->fileid,\n\t\t\t(long long)fattr->fileid);\n\t\tgoto out_err;\n\t}\n\n\t/*\n\t * Make sure the inode's type hasn't changed.\n\t */\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) && (inode->i_mode & S_IFMT) != (fattr->mode & S_IFMT)) {\n\t\t/*\n\t\t* Big trouble! The inode has become a different object.\n\t\t*/\n\t\tprintk(KERN_DEBUG \"NFS: %s: inode %lu mode changed, %07o to %07o\\n\",\n\t\t\t\t__func__, inode->i_ino, inode->i_mode, fattr->mode);\n\t\tgoto out_err;\n\t}\n\n\tserver = NFS_SERVER(inode);\n\t/* Update the fsid? */\n\tif (S_ISDIR(inode->i_mode) && (fattr->valid & NFS_ATTR_FATTR_FSID) &&\n\t\t\t!nfs_fsid_equal(&server->fsid, &fattr->fsid) &&\n\t\t\t!IS_AUTOMOUNT(inode))\n\t\tserver->fsid = fattr->fsid;\n\n\t/*\n\t * Update the read time so we don't revalidate too often.\n\t */\n\tnfsi->read_cache_jiffies = fattr->time_start;\n\n\tsave_cache_validity = nfsi->cache_validity;\n\tnfsi->cache_validity &= ~(NFS_INO_INVALID_ATTR\n\t\t\t| NFS_INO_INVALID_ATIME\n\t\t\t| NFS_INO_REVAL_FORCED\n\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\n\t/* Do atomic weak cache consistency updates */\n\tinvalid |= nfs_wcc_update_inode(inode, fattr);\n\n\t/* More cache consistency checks */\n\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE) {\n\t\tif (inode->i_version != fattr->change_attr) {\n\t\t\tdprintk(\"NFS: change_attr change on server for file %s/%ld\\n\",\n\t\t\t\t\tinode->i_sb->s_id, inode->i_ino);\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tnfs_force_lookup_revalidate(inode);\n\t\t\tinode->i_version = fattr->change_attr;\n\t\t}\n\t} else if (server->caps & NFS_CAP_CHANGE_ATTR)\n\t\tnfsi->cache_validity |= save_cache_validity;\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MTIME) {\n\t\tmemcpy(&inode->i_mtime, &fattr->mtime, sizeof(inode->i_mtime));\n\t} else if (server->caps & NFS_CAP_MTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_CTIME) {\n\t\tmemcpy(&inode->i_ctime, &fattr->ctime, sizeof(inode->i_ctime));\n\t} else if (server->caps & NFS_CAP_CTIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\t/* Check if our cached file size is stale */\n\tif (fattr->valid & NFS_ATTR_FATTR_SIZE) {\n\t\tnew_isize = nfs_size_to_loff_t(fattr->size);\n\t\tcur_isize = i_size_read(inode);\n\t\tif (new_isize != cur_isize) {\n\t\t\t/* Do we perhaps have any outstanding writes, or has\n\t\t\t * the file grown beyond our last write? */\n\t\t\tif ((nfsi->nrequests == 0) || new_isize > cur_isize) {\n\t\t\t\ti_size_write(inode, new_isize);\n\t\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_DATA;\n\t\t\t\tinvalid &= ~NFS_INO_REVAL_PAGECACHE;\n\t\t\t}\n\t\t\tdprintk(\"NFS: isize change on server for file %s/%ld \"\n\t\t\t\t\t\"(%Ld to %Ld)\\n\",\n\t\t\t\t\tinode->i_sb->s_id,\n\t\t\t\t\tinode->i_ino,\n\t\t\t\t\t(long long)cur_isize,\n\t\t\t\t\t(long long)new_isize);\n\t\t}\n\t} else\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\n\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\tmemcpy(&inode->i_atime, &fattr->atime, sizeof(inode->i_atime));\n\telse if (server->caps & NFS_CAP_ATIME)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATIME\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_MODE) {\n\t\tif ((inode->i_mode & S_IALLUGO) != (fattr->mode & S_IALLUGO)) {\n\t\t\tumode_t newmode = inode->i_mode & S_IFMT;\n\t\t\tnewmode |= fattr->mode & S_IALLUGO;\n\t\t\tinode->i_mode = newmode;\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t}\n\t} else if (server->caps & NFS_CAP_MODE)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER) {\n\t\tif (!uid_eq(inode->i_uid, fattr->uid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_uid = fattr->uid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP) {\n\t\tif (!gid_eq(inode->i_gid, fattr->gid)) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR|NFS_INO_INVALID_ACCESS|NFS_INO_INVALID_ACL;\n\t\t\tinode->i_gid = fattr->gid;\n\t\t}\n\t} else if (server->caps & NFS_CAP_OWNER_GROUP)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_NLINK) {\n\t\tif (inode->i_nlink != fattr->nlink) {\n\t\t\tinvalid |= NFS_INO_INVALID_ATTR;\n\t\t\tif (S_ISDIR(inode->i_mode))\n\t\t\t\tinvalid |= NFS_INO_INVALID_DATA;\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\t}\n\t} else if (server->caps & NFS_CAP_NLINK)\n\t\tnfsi->cache_validity |= save_cache_validity &\n\t\t\t\t(NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_FORCED);\n\n\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t/*\n\t\t * report the blocks in 512byte units\n\t\t */\n\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n \t}\n\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\n\t/* Update attrtimeo value if we're out of the unstable period */\n\tif (invalid & NFS_INO_INVALID_ATTR) {\n\t\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\t/* Set barrier to be more recent than all outstanding updates */\n\t\tnfsi->attr_gencount = nfs_inc_attr_generation_counter();\n\t} else {\n\t\tif (!time_in_range_open(now, nfsi->attrtimeo_timestamp, nfsi->attrtimeo_timestamp + nfsi->attrtimeo)) {\n\t\t\tif ((nfsi->attrtimeo <<= 1) > NFS_MAXATTRTIMEO(inode))\n\t\t\t\tnfsi->attrtimeo = NFS_MAXATTRTIMEO(inode);\n\t\t\tnfsi->attrtimeo_timestamp = now;\n\t\t}\n\t\t/* Set the barrier to be more recent than this fattr */\n\t\tif ((long)fattr->gencount - (long)nfsi->attr_gencount > 0)\n\t\t\tnfsi->attr_gencount = fattr->gencount;\n\t}\n\tinvalid &= ~NFS_INO_INVALID_ATTR;\n\t/* Don't invalidate the data if we were to blame */\n\tif (!(S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode)\n\t\t\t\t|| S_ISLNK(inode->i_mode)))\n\t\tinvalid &= ~NFS_INO_INVALID_DATA;\n\tif (!NFS_PROTO(inode)->have_delegation(inode, FMODE_READ) ||\n\t\t\t(save_cache_validity & NFS_INO_REVAL_FORCED))\n\t\tnfs_set_cache_invalid(inode, invalid);\n\n\treturn 0;\n out_err:\n\t/*\n\t * No need to worry about unhashing the dentry, as the\n\t * lookup validation will know that the inode is bad.\n\t * (But we fall through to invalidate the caches.)\n\t */\n\tnfs_invalidate_inode(inode);\n\treturn -ESTALE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_vmtruncate",
          "args": [
            "inode",
            "attr->ia_size"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_vmtruncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "561-579",
          "snippet": "static int nfs_vmtruncate(struct inode * inode, loff_t offset)\n{\n\tint err;\n\n\terr = inode_newsize_ok(inode, offset);\n\tif (err)\n\t\tgoto out;\n\n\ti_size_write(inode, offset);\n\t/* Optimisation */\n\tif (offset == 0)\n\t\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_DATA;\n\n\tspin_unlock(&inode->i_lock);\n\ttruncate_pagecache(inode, offset);\n\tspin_lock(&inode->i_lock);\nout:\n\treturn err;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int nfs_vmtruncate(struct inode * inode, loff_t offset)\n{\n\tint err;\n\n\terr = inode_newsize_ok(inode, offset);\n\tif (err)\n\t\tgoto out;\n\n\ti_size_write(inode, offset);\n\t/* Optimisation */\n\tif (offset == 0)\n\t\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_DATA;\n\n\tspin_unlock(&inode->i_lock);\n\ttruncate_pagecache(inode, offset);\n\tspin_lock(&inode->i_lock);\nout:\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_SETATTRTRUNC"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_set_barrier",
          "args": [
            "fattr"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_set_barrier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1307-1310",
          "snippet": "void nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_set_barrier(struct nfs_fattr *fattr)\n{\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setattr_update_inode(struct inode *inode, struct iattr *attr,\n\t\tstruct nfs_fattr *fattr)\n{\n\t/* Barrier: bump the attribute generation count. */\n\tnfs_fattr_set_barrier(fattr);\n\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->attr_gencount = fattr->gencount;\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0) {\n\t\tif ((attr->ia_valid & ATTR_MODE) != 0) {\n\t\t\tint mode = attr->ia_mode & S_IALLUGO;\n\t\t\tmode |= inode->i_mode & ~S_IALLUGO;\n\t\t\tinode->i_mode = mode;\n\t\t}\n\t\tif ((attr->ia_valid & ATTR_UID) != 0)\n\t\t\tinode->i_uid = attr->ia_uid;\n\t\tif ((attr->ia_valid & ATTR_GID) != 0)\n\t\t\tinode->i_gid = attr->ia_gid;\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL);\n\t}\n\tif ((attr->ia_valid & ATTR_SIZE) != 0) {\n\t\tnfs_inc_stats(inode, NFSIOS_SETATTRTRUNC);\n\t\tnfs_vmtruncate(inode, attr->ia_size);\n\t}\n\tnfs_update_inode(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "nfs_vmtruncate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "561-579",
    "snippet": "static int nfs_vmtruncate(struct inode * inode, loff_t offset)\n{\n\tint err;\n\n\terr = inode_newsize_ok(inode, offset);\n\tif (err)\n\t\tgoto out;\n\n\ti_size_write(inode, offset);\n\t/* Optimisation */\n\tif (offset == 0)\n\t\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_DATA;\n\n\tspin_unlock(&inode->i_lock);\n\ttruncate_pagecache(inode, offset);\n\tspin_lock(&inode->i_lock);\nout:\n\treturn err;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "truncate_pagecache",
          "args": [
            "inode",
            "offset"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "offset"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_newsize_ok",
          "args": [
            "inode",
            "offset"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_inode_newsize_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/inode.c",
          "lines": "823-843",
          "snippet": "static int ecryptfs_inode_newsize_ok(struct inode *inode, loff_t offset)\n{\n\tstruct ecryptfs_crypt_stat *crypt_stat;\n\tloff_t lower_oldsize, lower_newsize;\n\n\tcrypt_stat = &ecryptfs_inode_to_private(inode)->crypt_stat;\n\tlower_oldsize = upper_size_to_lower_size(crypt_stat,\n\t\t\t\t\t\t i_size_read(inode));\n\tlower_newsize = upper_size_to_lower_size(crypt_stat, offset);\n\tif (lower_newsize > lower_oldsize) {\n\t\t/*\n\t\t * The eCryptfs inode and the new *lower* size are mixed here\n\t\t * because we may not have the lower i_mutex held and/or it may\n\t\t * not be appropriate to call inode_newsize_ok() with inodes\n\t\t * from other filesystems.\n\t\t */\n\t\treturn inode_newsize_ok(inode, lower_newsize);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"ecryptfs_kernel.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/crypto.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/file.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <asm/unaligned.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/fs_stack.h>\n#include <linux/crypto.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/file.h>\n\nstatic int ecryptfs_inode_newsize_ok(struct inode *inode, loff_t offset)\n{\n\tstruct ecryptfs_crypt_stat *crypt_stat;\n\tloff_t lower_oldsize, lower_newsize;\n\n\tcrypt_stat = &ecryptfs_inode_to_private(inode)->crypt_stat;\n\tlower_oldsize = upper_size_to_lower_size(crypt_stat,\n\t\t\t\t\t\t i_size_read(inode));\n\tlower_newsize = upper_size_to_lower_size(crypt_stat, offset);\n\tif (lower_newsize > lower_oldsize) {\n\t\t/*\n\t\t * The eCryptfs inode and the new *lower* size are mixed here\n\t\t * because we may not have the lower i_mutex held and/or it may\n\t\t * not be appropriate to call inode_newsize_ok() with inodes\n\t\t * from other filesystems.\n\t\t */\n\t\treturn inode_newsize_ok(inode, lower_newsize);\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic int nfs_vmtruncate(struct inode * inode, loff_t offset)\n{\n\tint err;\n\n\terr = inode_newsize_ok(inode, offset);\n\tif (err)\n\t\tgoto out;\n\n\ti_size_write(inode, offset);\n\t/* Optimisation */\n\tif (offset == 0)\n\t\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_DATA;\n\n\tspin_unlock(&inode->i_lock);\n\ttruncate_pagecache(inode, offset);\n\tspin_lock(&inode->i_lock);\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "nfs_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "495-548",
    "snippet": "int\nnfs_setattr(struct dentry *dentry, struct iattr *attr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs_fattr *fattr;\n\tint error = -ENOMEM;\n\n\tnfs_inc_stats(inode, NFSIOS_VFSSETATTR);\n\n\t/* skip mode change if it's just for clearing setuid/setgid */\n\tif (attr->ia_valid & (ATTR_KILL_SUID | ATTR_KILL_SGID))\n\t\tattr->ia_valid &= ~ATTR_MODE;\n\n\tif (attr->ia_valid & ATTR_SIZE) {\n\t\tloff_t i_size;\n\n\t\tBUG_ON(!S_ISREG(inode->i_mode));\n\n\t\ti_size = i_size_read(inode);\n\t\tif (attr->ia_size == i_size)\n\t\t\tattr->ia_valid &= ~ATTR_SIZE;\n\t\telse if (attr->ia_size < i_size && IS_SWAPFILE(inode))\n\t\t\treturn -ETXTBSY;\n\t}\n\n\t/* Optimization: if the end result is no change, don't RPC */\n\tattr->ia_valid &= NFS_VALID_ATTRS;\n\tif ((attr->ia_valid & ~(ATTR_FILE|ATTR_OPEN)) == 0)\n\t\treturn 0;\n\n\ttrace_nfs_setattr_enter(inode);\n\n\t/* Write all dirty data */\n\tif (S_ISREG(inode->i_mode)) {\n\t\tnfs_inode_dio_wait(inode);\n\t\tnfs_wb_all(inode);\n\t}\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\t/*\n\t * Return any delegations if we're going to change ACLs\n\t */\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0)\n\t\tNFS_PROTO(inode)->return_delegation(inode);\n\terror = NFS_PROTO(inode)->setattr(dentry, fattr, attr);\n\tif (error == 0)\n\t\terror = nfs_refresh_inode(inode, fattr);\n\tnfs_free_fattr(fattr);\nout:\n\ttrace_nfs_setattr_exit(inode, error);\n\treturn error;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_VALID_ATTRS (ATTR_MODE|ATTR_UID|ATTR_GID|ATTR_SIZE|ATTR_ATIME|ATTR_ATIME_SET|ATTR_MTIME|ATTR_MTIME_SET|ATTR_FILE|ATTR_OPEN)"
    ],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs_setattr_exit",
          "args": [
            "inode",
            "error"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "dentry",
            "fattr",
            "attr"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_wb_all",
          "args": [
            "inode"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wb_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1841-1857",
          "snippet": "int nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_dio_wait",
          "args": [
            "inode"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_dio_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "498-501",
          "snippet": "static inline void nfs_inode_dio_wait(struct inode *inode)\n{\n\tinode_dio_wait(inode);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);",
            "extern void nfs_destroy_inode(struct inode *);",
            "extern int nfs_drop_inode(struct inode *);",
            "extern void nfs_clear_inode(struct inode *);",
            "extern void nfs_evict_inode(struct inode *);",
            "void nfs_zap_acl_cache(struct inode *inode);",
            "int nfs_key_timeout_notify(struct file *filp, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);\nextern void nfs_destroy_inode(struct inode *);\nextern int nfs_drop_inode(struct inode *);\nextern void nfs_clear_inode(struct inode *);\nextern void nfs_evict_inode(struct inode *);\nvoid nfs_zap_acl_cache(struct inode *inode);\nint nfs_key_timeout_notify(struct file *filp, struct inode *inode);\n\nstatic inline void nfs_inode_dio_wait(struct inode *inode)\n{\n\tinode_dio_wait(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_nfs_setattr_enter",
          "args": [
            "inode"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_SWAPFILE",
          "args": [
            "inode"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!S_ISREG(inode->i_mode)"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_VFSSETATTR"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_VALID_ATTRS (ATTR_MODE|ATTR_UID|ATTR_GID|ATTR_SIZE|ATTR_ATIME|ATTR_ATIME_SET|ATTR_MTIME|ATTR_MTIME_SET|ATTR_FILE|ATTR_OPEN)\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint\nnfs_setattr(struct dentry *dentry, struct iattr *attr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs_fattr *fattr;\n\tint error = -ENOMEM;\n\n\tnfs_inc_stats(inode, NFSIOS_VFSSETATTR);\n\n\t/* skip mode change if it's just for clearing setuid/setgid */\n\tif (attr->ia_valid & (ATTR_KILL_SUID | ATTR_KILL_SGID))\n\t\tattr->ia_valid &= ~ATTR_MODE;\n\n\tif (attr->ia_valid & ATTR_SIZE) {\n\t\tloff_t i_size;\n\n\t\tBUG_ON(!S_ISREG(inode->i_mode));\n\n\t\ti_size = i_size_read(inode);\n\t\tif (attr->ia_size == i_size)\n\t\t\tattr->ia_valid &= ~ATTR_SIZE;\n\t\telse if (attr->ia_size < i_size && IS_SWAPFILE(inode))\n\t\t\treturn -ETXTBSY;\n\t}\n\n\t/* Optimization: if the end result is no change, don't RPC */\n\tattr->ia_valid &= NFS_VALID_ATTRS;\n\tif ((attr->ia_valid & ~(ATTR_FILE|ATTR_OPEN)) == 0)\n\t\treturn 0;\n\n\ttrace_nfs_setattr_enter(inode);\n\n\t/* Write all dirty data */\n\tif (S_ISREG(inode->i_mode)) {\n\t\tnfs_inode_dio_wait(inode);\n\t\tnfs_wb_all(inode);\n\t}\n\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\t/*\n\t * Return any delegations if we're going to change ACLs\n\t */\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0)\n\t\tNFS_PROTO(inode)->return_delegation(inode);\n\terror = NFS_PROTO(inode)->setattr(dentry, fattr, attr);\n\tif (error == 0)\n\t\terror = nfs_refresh_inode(inode, fattr);\n\tnfs_free_fattr(fattr);\nout:\n\ttrace_nfs_setattr_exit(inode, error);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_fhget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "343-490",
    "snippet": "struct inode *\nnfs_fhget(struct super_block *sb, struct nfs_fh *fh, struct nfs_fattr *fattr, struct nfs4_label *label)\n{\n\tstruct nfs_find_desc desc = {\n\t\t.fh\t= fh,\n\t\t.fattr\t= fattr\n\t};\n\tstruct inode *inode = ERR_PTR(-ENOENT);\n\tunsigned long hash;\n\n\tnfs_attr_check_mountpoint(sb, fattr);\n\n\tif (nfs_attr_use_mounted_on_fileid(fattr))\n\t\tfattr->fileid = fattr->mounted_on_fileid;\n\telse if ((fattr->valid & NFS_ATTR_FATTR_FILEID) == 0)\n\t\tgoto out_no_inode;\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) == 0)\n\t\tgoto out_no_inode;\n\n\thash = nfs_fattr_to_ino_t(fattr);\n\n\tinode = iget5_locked(sb, hash, nfs_find_actor, nfs_init_locked, &desc);\n\tif (inode == NULL) {\n\t\tinode = ERR_PTR(-ENOMEM);\n\t\tgoto out_no_inode;\n\t}\n\n\tif (inode->i_state & I_NEW) {\n\t\tstruct nfs_inode *nfsi = NFS_I(inode);\n\t\tunsigned long now = jiffies;\n\n\t\t/* We set i_ino for the few things that still rely on it,\n\t\t * such as stat(2) */\n\t\tinode->i_ino = hash;\n\n\t\t/* We can't support update_atime(), since the server will reset it */\n\t\tinode->i_flags |= S_NOATIME|S_NOCMTIME;\n\t\tinode->i_mode = fattr->mode;\n\t\tif ((fattr->valid & NFS_ATTR_FATTR_MODE) == 0\n\t\t\t\t&& nfs_server_capable(inode, NFS_CAP_MODE))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\t/* Why so? Because we want revalidate for devices/FIFOs, and\n\t\t * that's precisely what we have in nfs_file_inode_operations.\n\t\t */\n\t\tinode->i_op = NFS_SB(sb)->nfs_client->rpc_ops->file_inode_ops;\n\t\tif (S_ISREG(inode->i_mode)) {\n\t\t\tinode->i_fop = NFS_SB(sb)->nfs_client->rpc_ops->file_ops;\n\t\t\tinode->i_data.a_ops = &nfs_file_aops;\n\t\t} else if (S_ISDIR(inode->i_mode)) {\n\t\t\tinode->i_op = NFS_SB(sb)->nfs_client->rpc_ops->dir_inode_ops;\n\t\t\tinode->i_fop = &nfs_dir_operations;\n\t\t\tinode->i_data.a_ops = &nfs_dir_aops;\n\t\t\t/* Deal with crossing mountpoints */\n\t\t\tif (fattr->valid & NFS_ATTR_FATTR_MOUNTPOINT ||\n\t\t\t\t\tfattr->valid & NFS_ATTR_FATTR_V4_REFERRAL) {\n\t\t\t\tif (fattr->valid & NFS_ATTR_FATTR_V4_REFERRAL)\n\t\t\t\t\tinode->i_op = &nfs_referral_inode_operations;\n\t\t\t\telse\n\t\t\t\t\tinode->i_op = &nfs_mountpoint_inode_operations;\n\t\t\t\tinode->i_fop = NULL;\n\t\t\t\tinode->i_flags |= S_AUTOMOUNT;\n\t\t\t}\n\t\t} else if (S_ISLNK(inode->i_mode))\n\t\t\tinode->i_op = &nfs_symlink_inode_operations;\n\t\telse\n\t\t\tinit_special_inode(inode, inode->i_mode, fattr->rdev);\n\n\t\tmemset(&inode->i_atime, 0, sizeof(inode->i_atime));\n\t\tmemset(&inode->i_mtime, 0, sizeof(inode->i_mtime));\n\t\tmemset(&inode->i_ctime, 0, sizeof(inode->i_ctime));\n\t\tinode->i_version = 0;\n\t\tinode->i_size = 0;\n\t\tclear_nlink(inode);\n\t\tinode->i_uid = make_kuid(&init_user_ns, -2);\n\t\tinode->i_gid = make_kgid(&init_user_ns, -2);\n\t\tinode->i_blocks = 0;\n\t\tmemset(nfsi->cookieverf, 0, sizeof(nfsi->cookieverf));\n\t\tnfsi->write_io = 0;\n\t\tnfsi->read_io = 0;\n\n\t\tnfsi->read_cache_jiffies = fattr->time_start;\n\t\tnfsi->attr_gencount = fattr->gencount;\n\t\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\t\tinode->i_atime = fattr->atime;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_ATIME))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_MTIME)\n\t\t\tinode->i_mtime = fattr->mtime;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_MTIME))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_CTIME)\n\t\t\tinode->i_ctime = fattr->ctime;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_CTIME))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE)\n\t\t\tinode->i_version = fattr->change_attr;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_CHANGE_ATTR))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_SIZE)\n\t\t\tinode->i_size = nfs_size_to_loff_t(fattr->size);\n\t\telse\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_NLINK)\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\telse if (nfs_server_capable(inode, NFS_CAP_NLINK))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_OWNER)\n\t\t\tinode->i_uid = fattr->uid;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_OWNER))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_GROUP)\n\t\t\tinode->i_gid = fattr->gid;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_OWNER_GROUP))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\t\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t\t/*\n\t\t\t * report the blocks in 512byte units\n\t\t\t */\n\t\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n\t\t}\n\n\t\tnfs_setsecurity(inode, fattr, label);\n\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\tnfsi->access_cache = RB_ROOT;\n\n\t\tnfs_fscache_init_inode(inode);\n\n\t\tunlock_new_inode(inode);\n\t} else\n\t\tnfs_refresh_inode(inode, fattr);\n\tdprintk(\"NFS: nfs_fhget(%s/%Lu fh_crc=0x%08x ct=%d)\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode),\n\t\tnfs_display_fhandle_hash(fh),\n\t\tatomic_read(&inode->i_count));\n\nout:\n\treturn inode;\n\nout_no_inode:\n\tdprintk(\"nfs_fhget: iget failed with error %ld\\n\", PTR_ERR(inode));\n\tgoto out;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs_fhget: iget failed with error %ld\\n\"",
            "PTR_ERR(inode)"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "inode"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: nfs_fhget(%s/%Lu fh_crc=0x%08x ct=%d)\\n\"",
            "inode->i_sb->s_id",
            "(unsigned long long)NFS_FILEID(inode)",
            "nfs_display_fhandle_hash(fh)",
            "atomic_read(&inode->i_count)"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&inode->i_count"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_display_fhandle_hash",
          "args": [
            "fh"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "_nfs_display_fhandle_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1343-1348",
          "snippet": "u32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nu32 _nfs_display_fhandle_hash(const struct nfs_fh *fh)\n{\n\t/* wireshark uses 32-bit AUTODIN crc and does a bitwise\n\t * not on the result */\n\treturn nfs_fhandle_hash(fh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_new_inode",
          "args": [
            "inode"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_new_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "924-933",
          "snippet": "void unlock_new_inode(struct inode *inode)\n{\n\tlockdep_annotate_inode_mutex_key(inode);\n\tspin_lock(&inode->i_lock);\n\tWARN_ON(!(inode->i_state & I_NEW));\n\tinode->i_state &= ~I_NEW;\n\tsmp_mb();\n\twake_up_bit(&inode->i_state, __I_NEW);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid unlock_new_inode(struct inode *inode)\n{\n\tlockdep_annotate_inode_mutex_key(inode);\n\tspin_lock(&inode->i_lock);\n\tWARN_ON(!(inode->i_state & I_NEW));\n\tinode->i_state &= ~I_NEW;\n\tsmp_mb();\n\twake_up_bit(&inode->i_state, __I_NEW);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fscache_init_inode",
          "args": [
            "inode"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_init_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "181-191",
          "snippet": "void nfs_fscache_init_inode(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tnfsi->fscache = NULL;\n\tif (!S_ISREG(inode->i_mode))\n\t\treturn;\n\tnfsi->fscache = fscache_acquire_cookie(NFS_SB(inode->i_sb)->fscache,\n\t\t\t\t\t       &nfs_fscache_inode_object_def,\n\t\t\t\t\t       nfsi, false);\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid nfs_fscache_init_inode(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tnfsi->fscache = NULL;\n\tif (!S_ISREG(inode->i_mode))\n\t\treturn;\n\tnfsi->fscache = fscache_acquire_cookie(NFS_SB(inode->i_sb)->fscache,\n\t\t\t\t\t       &nfs_fscache_inode_object_def,\n\t\t\t\t\t       nfsi, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_MINATTRTIMEO",
          "args": [
            "inode"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_setsecurity",
          "args": [
            "inode",
            "fattr",
            "label"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_setsecurity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "332-335",
          "snippet": "void nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_calc_block_size",
          "args": [
            "fattr->du.nfs3.used"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_calc_block_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "570-574",
          "snippet": "static inline blkcnt_t nfs_calc_block_size(u64 tsize)\n{\n\tblkcnt_t used = (tsize + 511) >> 9;\n\treturn (used > ULONG_MAX) ? ULONG_MAX : used;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline blkcnt_t nfs_calc_block_size(u64 tsize)\n{\n\tblkcnt_t used = (tsize + 511) >> 9;\n\treturn (used > ULONG_MAX) ? ULONG_MAX : used;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "NFS_INO_INVALID_ATTR"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_OWNER_GROUP"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_OWNER"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_NLINK"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_nlink",
          "args": [
            "inode",
            "fattr->nlink"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "set_nlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "305-316",
          "snippet": "void set_nlink(struct inode *inode, unsigned int nlink)\n{\n\tif (!nlink) {\n\t\tclear_nlink(inode);\n\t} else {\n\t\t/* Yes, some filesystems do change nlink from zero to one */\n\t\tif (inode->i_nlink == 0)\n\t\t\tatomic_long_dec(&inode->i_sb->s_remove_count);\n\n\t\tinode->__i_nlink = nlink;\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid set_nlink(struct inode *inode, unsigned int nlink)\n{\n\tif (!nlink) {\n\t\tclear_nlink(inode);\n\t} else {\n\t\t/* Yes, some filesystems do change nlink from zero to one */\n\t\tif (inode->i_nlink == 0)\n\t\t\tatomic_long_dec(&inode->i_sb->s_remove_count);\n\n\t\tinode->__i_nlink = nlink;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_size_to_loff_t",
          "args": [
            "fattr->size"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_CHANGE_ATTR"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_CTIME"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_MTIME"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_ATIME"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "nfsi->cookieverf",
            "0",
            "sizeof(nfsi->cookieverf)"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "&init_user_ns",
            "-2"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "&init_user_ns",
            "-2"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_nlink",
          "args": [
            "inode"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "clear_nlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "288-294",
          "snippet": "void clear_nlink(struct inode *inode)\n{\n\tif (inode->i_nlink) {\n\t\tinode->__i_nlink = 0;\n\t\tatomic_long_inc(&inode->i_sb->s_remove_count);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid clear_nlink(struct inode *inode)\n{\n\tif (inode->i_nlink) {\n\t\tinode->__i_nlink = 0;\n\t\tatomic_long_inc(&inode->i_sb->s_remove_count);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&inode->i_ctime",
            "0",
            "sizeof(inode->i_ctime)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&inode->i_mtime",
            "0",
            "sizeof(inode->i_mtime)"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&inode->i_atime",
            "0",
            "sizeof(inode->i_atime)"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_special_inode",
          "args": [
            "inode",
            "inode->i_mode",
            "fattr->rdev"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "init_special_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1854-1871",
          "snippet": "void init_special_inode(struct inode *inode, umode_t mode, dev_t rdev)\n{\n\tinode->i_mode = mode;\n\tif (S_ISCHR(mode)) {\n\t\tinode->i_fop = &def_chr_fops;\n\t\tinode->i_rdev = rdev;\n\t} else if (S_ISBLK(mode)) {\n\t\tinode->i_fop = &def_blk_fops;\n\t\tinode->i_rdev = rdev;\n\t} else if (S_ISFIFO(mode))\n\t\tinode->i_fop = &pipefifo_fops;\n\telse if (S_ISSOCK(mode))\n\t\t;\t/* leave it no_open_fops */\n\telse\n\t\tprintk(KERN_DEBUG \"init_special_inode: bogus i_mode (%o) for\"\n\t\t\t\t  \" inode %s:%lu\\n\", mode, inode->i_sb->s_id,\n\t\t\t\t  inode->i_ino);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid init_special_inode(struct inode *inode, umode_t mode, dev_t rdev)\n{\n\tinode->i_mode = mode;\n\tif (S_ISCHR(mode)) {\n\t\tinode->i_fop = &def_chr_fops;\n\t\tinode->i_rdev = rdev;\n\t} else if (S_ISBLK(mode)) {\n\t\tinode->i_fop = &def_blk_fops;\n\t\tinode->i_rdev = rdev;\n\t} else if (S_ISFIFO(mode))\n\t\tinode->i_fop = &pipefifo_fops;\n\telse if (S_ISSOCK(mode))\n\t\t;\t/* leave it no_open_fops */\n\telse\n\t\tprintk(KERN_DEBUG \"init_special_inode: bogus i_mode (%o) for\"\n\t\t\t\t  \" inode %s:%lu\\n\", mode, inode->i_sb->s_id,\n\t\t\t\t  inode->i_ino);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "inode->i_mode"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_capable",
          "args": [
            "inode",
            "NFS_CAP_MODE"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iget5_locked",
          "args": [
            "sb",
            "hash",
            "nfs_find_actor",
            "nfs_init_locked",
            "&desc"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "iget5_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "991-1047",
          "snippet": "struct inode *iget5_locked(struct super_block *sb, unsigned long hashval,\n\t\tint (*test)(struct inode *, void *),\n\t\tint (*set)(struct inode *, void *), void *data)\n{\n\tstruct hlist_head *head = inode_hashtable + hash(sb, hashval);\n\tstruct inode *inode;\n\n\tspin_lock(&inode_hash_lock);\n\tinode = find_inode(sb, head, test, data);\n\tspin_unlock(&inode_hash_lock);\n\n\tif (inode) {\n\t\twait_on_inode(inode);\n\t\treturn inode;\n\t}\n\n\tinode = alloc_inode(sb);\n\tif (inode) {\n\t\tstruct inode *old;\n\n\t\tspin_lock(&inode_hash_lock);\n\t\t/* We released the lock, so.. */\n\t\told = find_inode(sb, head, test, data);\n\t\tif (!old) {\n\t\t\tif (set(inode, data))\n\t\t\t\tgoto set_failed;\n\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tinode->i_state = I_NEW;\n\t\t\thlist_add_head(&inode->i_hash, head);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tinode_sb_list_add(inode);\n\t\t\tspin_unlock(&inode_hash_lock);\n\n\t\t\t/* Return the locked inode with I_NEW set, the\n\t\t\t * caller is responsible for filling in the contents\n\t\t\t */\n\t\t\treturn inode;\n\t\t}\n\n\t\t/*\n\t\t * Uhhuh, somebody else created the same inode under\n\t\t * us. Use the old inode instead of the one we just\n\t\t * allocated.\n\t\t */\n\t\tspin_unlock(&inode_hash_lock);\n\t\tdestroy_inode(inode);\n\t\tinode = old;\n\t\twait_on_inode(inode);\n\t}\n\treturn inode;\n\nset_failed:\n\tspin_unlock(&inode_hash_lock);\n\tdestroy_inode(inode);\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_head *inode_hashtable",
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_hash_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic struct hlist_head *inode_hashtable;\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_hash_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstruct inode *iget5_locked(struct super_block *sb, unsigned long hashval,\n\t\tint (*test)(struct inode *, void *),\n\t\tint (*set)(struct inode *, void *), void *data)\n{\n\tstruct hlist_head *head = inode_hashtable + hash(sb, hashval);\n\tstruct inode *inode;\n\n\tspin_lock(&inode_hash_lock);\n\tinode = find_inode(sb, head, test, data);\n\tspin_unlock(&inode_hash_lock);\n\n\tif (inode) {\n\t\twait_on_inode(inode);\n\t\treturn inode;\n\t}\n\n\tinode = alloc_inode(sb);\n\tif (inode) {\n\t\tstruct inode *old;\n\n\t\tspin_lock(&inode_hash_lock);\n\t\t/* We released the lock, so.. */\n\t\told = find_inode(sb, head, test, data);\n\t\tif (!old) {\n\t\t\tif (set(inode, data))\n\t\t\t\tgoto set_failed;\n\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tinode->i_state = I_NEW;\n\t\t\thlist_add_head(&inode->i_hash, head);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tinode_sb_list_add(inode);\n\t\t\tspin_unlock(&inode_hash_lock);\n\n\t\t\t/* Return the locked inode with I_NEW set, the\n\t\t\t * caller is responsible for filling in the contents\n\t\t\t */\n\t\t\treturn inode;\n\t\t}\n\n\t\t/*\n\t\t * Uhhuh, somebody else created the same inode under\n\t\t * us. Use the old inode instead of the one we just\n\t\t * allocated.\n\t\t */\n\t\tspin_unlock(&inode_hash_lock);\n\t\tdestroy_inode(inode);\n\t\tinode = old;\n\t\twait_on_inode(inode);\n\t}\n\treturn inode;\n\nset_failed:\n\tspin_unlock(&inode_hash_lock);\n\tdestroy_inode(inode);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_to_ino_t",
          "args": [
            "fattr"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_to_ino_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "68-72",
          "snippet": "static inline unsigned long\nnfs_fattr_to_ino_t(struct nfs_fattr *fattr)\n{\n\treturn nfs_fileid_to_ino_t(fattr->fileid);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic inline unsigned long\nnfs_fattr_to_ino_t(struct nfs_fattr *fattr)\n{\n\treturn nfs_fileid_to_ino_t(fattr->fileid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_attr_use_mounted_on_fileid",
          "args": [
            "fattr"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_attr_use_mounted_on_fileid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "29-36",
          "snippet": "static inline int nfs_attr_use_mounted_on_fileid(struct nfs_fattr *fattr)\n{\n\tif (((fattr->valid & NFS_ATTR_FATTR_MOUNTED_ON_FILEID) == 0) ||\n\t    (((fattr->valid & NFS_ATTR_FATTR_MOUNTPOINT) == 0) &&\n\t     ((fattr->valid & NFS_ATTR_FATTR_V4_REFERRAL) == 0)))\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *, struct nfs_fattr *);",
            "struct vfsmount *nfs_submount(struct nfs_server *, struct dentry *,\n\t\t\t      struct nfs_fh *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *, struct nfs_fattr *);\nstruct vfsmount *nfs_submount(struct nfs_server *, struct dentry *,\n\t\t\t      struct nfs_fh *, struct nfs_fattr *);\n\nstatic inline int nfs_attr_use_mounted_on_fileid(struct nfs_fattr *fattr)\n{\n\tif (((fattr->valid & NFS_ATTR_FATTR_MOUNTED_ON_FILEID) == 0) ||\n\t    (((fattr->valid & NFS_ATTR_FATTR_MOUNTPOINT) == 0) &&\n\t     ((fattr->valid & NFS_ATTR_FATTR_V4_REFERRAL) == 0)))\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_attr_check_mountpoint",
          "args": [
            "sb",
            "fattr"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_attr_check_mountpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "23-27",
          "snippet": "static inline void nfs_attr_check_mountpoint(struct super_block *parent, struct nfs_fattr *fattr)\n{\n\tif (!nfs_fsid_equal(&NFS_SB(parent)->fsid, &fattr->fsid))\n\t\tfattr->valid |= NFS_ATTR_FATTR_MOUNTPOINT;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *, struct nfs_fattr *);",
            "void nfs_initialise_sb(struct super_block *);",
            "void nfs_kill_super(struct super_block *);",
            "struct vfsmount *nfs_submount(struct nfs_server *, struct dentry *,\n\t\t\t      struct nfs_fh *, struct nfs_fattr *);",
            "void nfs_umount_begin(struct super_block *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *, struct nfs_fattr *);\nvoid nfs_initialise_sb(struct super_block *);\nvoid nfs_kill_super(struct super_block *);\nstruct vfsmount *nfs_submount(struct nfs_server *, struct dentry *,\n\t\t\t      struct nfs_fh *, struct nfs_fattr *);\nvoid nfs_umount_begin(struct super_block *);\n\nstatic inline void nfs_attr_check_mountpoint(struct super_block *parent, struct nfs_fattr *fattr)\n{\n\tif (!nfs_fsid_equal(&NFS_SB(parent)->fsid, &fattr->fsid))\n\t\tfattr->valid |= NFS_ATTR_FATTR_MOUNTPOINT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOENT"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct inode *\nnfs_fhget(struct super_block *sb, struct nfs_fh *fh, struct nfs_fattr *fattr, struct nfs4_label *label)\n{\n\tstruct nfs_find_desc desc = {\n\t\t.fh\t= fh,\n\t\t.fattr\t= fattr\n\t};\n\tstruct inode *inode = ERR_PTR(-ENOENT);\n\tunsigned long hash;\n\n\tnfs_attr_check_mountpoint(sb, fattr);\n\n\tif (nfs_attr_use_mounted_on_fileid(fattr))\n\t\tfattr->fileid = fattr->mounted_on_fileid;\n\telse if ((fattr->valid & NFS_ATTR_FATTR_FILEID) == 0)\n\t\tgoto out_no_inode;\n\tif ((fattr->valid & NFS_ATTR_FATTR_TYPE) == 0)\n\t\tgoto out_no_inode;\n\n\thash = nfs_fattr_to_ino_t(fattr);\n\n\tinode = iget5_locked(sb, hash, nfs_find_actor, nfs_init_locked, &desc);\n\tif (inode == NULL) {\n\t\tinode = ERR_PTR(-ENOMEM);\n\t\tgoto out_no_inode;\n\t}\n\n\tif (inode->i_state & I_NEW) {\n\t\tstruct nfs_inode *nfsi = NFS_I(inode);\n\t\tunsigned long now = jiffies;\n\n\t\t/* We set i_ino for the few things that still rely on it,\n\t\t * such as stat(2) */\n\t\tinode->i_ino = hash;\n\n\t\t/* We can't support update_atime(), since the server will reset it */\n\t\tinode->i_flags |= S_NOATIME|S_NOCMTIME;\n\t\tinode->i_mode = fattr->mode;\n\t\tif ((fattr->valid & NFS_ATTR_FATTR_MODE) == 0\n\t\t\t\t&& nfs_server_capable(inode, NFS_CAP_MODE))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\t/* Why so? Because we want revalidate for devices/FIFOs, and\n\t\t * that's precisely what we have in nfs_file_inode_operations.\n\t\t */\n\t\tinode->i_op = NFS_SB(sb)->nfs_client->rpc_ops->file_inode_ops;\n\t\tif (S_ISREG(inode->i_mode)) {\n\t\t\tinode->i_fop = NFS_SB(sb)->nfs_client->rpc_ops->file_ops;\n\t\t\tinode->i_data.a_ops = &nfs_file_aops;\n\t\t} else if (S_ISDIR(inode->i_mode)) {\n\t\t\tinode->i_op = NFS_SB(sb)->nfs_client->rpc_ops->dir_inode_ops;\n\t\t\tinode->i_fop = &nfs_dir_operations;\n\t\t\tinode->i_data.a_ops = &nfs_dir_aops;\n\t\t\t/* Deal with crossing mountpoints */\n\t\t\tif (fattr->valid & NFS_ATTR_FATTR_MOUNTPOINT ||\n\t\t\t\t\tfattr->valid & NFS_ATTR_FATTR_V4_REFERRAL) {\n\t\t\t\tif (fattr->valid & NFS_ATTR_FATTR_V4_REFERRAL)\n\t\t\t\t\tinode->i_op = &nfs_referral_inode_operations;\n\t\t\t\telse\n\t\t\t\t\tinode->i_op = &nfs_mountpoint_inode_operations;\n\t\t\t\tinode->i_fop = NULL;\n\t\t\t\tinode->i_flags |= S_AUTOMOUNT;\n\t\t\t}\n\t\t} else if (S_ISLNK(inode->i_mode))\n\t\t\tinode->i_op = &nfs_symlink_inode_operations;\n\t\telse\n\t\t\tinit_special_inode(inode, inode->i_mode, fattr->rdev);\n\n\t\tmemset(&inode->i_atime, 0, sizeof(inode->i_atime));\n\t\tmemset(&inode->i_mtime, 0, sizeof(inode->i_mtime));\n\t\tmemset(&inode->i_ctime, 0, sizeof(inode->i_ctime));\n\t\tinode->i_version = 0;\n\t\tinode->i_size = 0;\n\t\tclear_nlink(inode);\n\t\tinode->i_uid = make_kuid(&init_user_ns, -2);\n\t\tinode->i_gid = make_kgid(&init_user_ns, -2);\n\t\tinode->i_blocks = 0;\n\t\tmemset(nfsi->cookieverf, 0, sizeof(nfsi->cookieverf));\n\t\tnfsi->write_io = 0;\n\t\tnfsi->read_io = 0;\n\n\t\tnfsi->read_cache_jiffies = fattr->time_start;\n\t\tnfsi->attr_gencount = fattr->gencount;\n\t\tif (fattr->valid & NFS_ATTR_FATTR_ATIME)\n\t\t\tinode->i_atime = fattr->atime;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_ATIME))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_MTIME)\n\t\t\tinode->i_mtime = fattr->mtime;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_MTIME))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_CTIME)\n\t\t\tinode->i_ctime = fattr->ctime;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_CTIME))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_CHANGE)\n\t\t\tinode->i_version = fattr->change_attr;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_CHANGE_ATTR))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_SIZE)\n\t\t\tinode->i_size = nfs_size_to_loff_t(fattr->size);\n\t\telse\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_NLINK)\n\t\t\tset_nlink(inode, fattr->nlink);\n\t\telse if (nfs_server_capable(inode, NFS_CAP_NLINK))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_OWNER)\n\t\t\tinode->i_uid = fattr->uid;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_OWNER))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_GROUP)\n\t\t\tinode->i_gid = fattr->gid;\n\t\telse if (nfs_server_capable(inode, NFS_CAP_OWNER_GROUP))\n\t\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR);\n\t\tif (fattr->valid & NFS_ATTR_FATTR_BLOCKS_USED)\n\t\t\tinode->i_blocks = fattr->du.nfs2.blocks;\n\t\tif (fattr->valid & NFS_ATTR_FATTR_SPACE_USED) {\n\t\t\t/*\n\t\t\t * report the blocks in 512byte units\n\t\t\t */\n\t\t\tinode->i_blocks = nfs_calc_block_size(fattr->du.nfs3.used);\n\t\t}\n\n\t\tnfs_setsecurity(inode, fattr, label);\n\n\t\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\t\tnfsi->attrtimeo_timestamp = now;\n\t\tnfsi->access_cache = RB_ROOT;\n\n\t\tnfs_fscache_init_inode(inode);\n\n\t\tunlock_new_inode(inode);\n\t} else\n\t\tnfs_refresh_inode(inode, fattr);\n\tdprintk(\"NFS: nfs_fhget(%s/%Lu fh_crc=0x%08x ct=%d)\\n\",\n\t\tinode->i_sb->s_id,\n\t\t(unsigned long long)NFS_FILEID(inode),\n\t\tnfs_display_fhandle_hash(fh),\n\t\tatomic_read(&inode->i_count));\n\nout:\n\treturn inode;\n\nout_no_inode:\n\tdprintk(\"nfs_fhget: iget failed with error %ld\\n\", PTR_ERR(inode));\n\tgoto out;\n}"
  },
  {
    "function_name": "nfs_setsecurity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "332-335",
    "snippet": "void nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n}"
  },
  {
    "function_name": "nfs4_label_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "306-329",
    "snippet": "struct nfs4_label *nfs4_label_alloc(struct nfs_server *server, gfp_t flags)\n{\n\tstruct nfs4_label *label = NULL;\n\tint minor_version = server->nfs_client->cl_minorversion;\n\n\tif (minor_version < 2)\n\t\treturn label;\n\n\tif (!(server->caps & NFS_CAP_SECURITY_LABEL))\n\t\treturn label;\n\n\tlabel = kzalloc(sizeof(struct nfs4_label), flags);\n\tif (label == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tlabel->label = kzalloc(NFS4_MAXLABELLEN, flags);\n\tif (label->label == NULL) {\n\t\tkfree(label);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tlabel->len = NFS4_MAXLABELLEN;\n\n\treturn label;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "label"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "NFS4_MAXLABELLEN",
            "flags"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct nfs4_label)",
            "flags"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs4_label *nfs4_label_alloc(struct nfs_server *server, gfp_t flags)\n{\n\tstruct nfs4_label *label = NULL;\n\tint minor_version = server->nfs_client->cl_minorversion;\n\n\tif (minor_version < 2)\n\t\treturn label;\n\n\tif (!(server->caps & NFS_CAP_SECURITY_LABEL))\n\t\treturn label;\n\n\tlabel = kzalloc(sizeof(struct nfs4_label), flags);\n\tif (label == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tlabel->label = kzalloc(NFS4_MAXLABELLEN, flags);\n\tif (label->label == NULL) {\n\t\tkfree(label);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tlabel->len = NFS4_MAXLABELLEN;\n\n\treturn label;\n}"
  },
  {
    "function_name": "nfs_setsecurity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "285-304",
    "snippet": "void nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n\tint error;\n\n\tif (label == NULL)\n\t\treturn;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_V4_SECURITY_LABEL) && inode->i_security) {\n\t\terror = security_inode_notifysecctx(inode, label->label,\n\t\t\t\tlabel->len);\n\t\tif (error)\n\t\t\tprintk(KERN_ERR \"%s() %s %d \"\n\t\t\t\t\t\"security_inode_notifysecctx() %d\\n\",\n\t\t\t\t\t__func__,\n\t\t\t\t\t(char *)label->label,\n\t\t\t\t\tlabel->len, error);\n\t\tnfs_clear_label_invalid(inode);\n\t}\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_clear_label_invalid",
          "args": [
            "inode"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_clear_label_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "278-283",
          "snippet": "static void nfs_clear_label_invalid(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_LABEL;\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_clear_label_invalid(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_LABEL;\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"%s() %s %d \"\n\t\t\t\t\t\"security_inode_notifysecctx() %d\\n\"",
            "__func__",
            "(char *)label->label",
            "label->len",
            "error"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_inode_notifysecctx",
          "args": [
            "inode",
            "label->label",
            "label->len"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setsecurity(struct inode *inode, struct nfs_fattr *fattr,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n\tint error;\n\n\tif (label == NULL)\n\t\treturn;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR_V4_SECURITY_LABEL) && inode->i_security) {\n\t\terror = security_inode_notifysecctx(inode, label->label,\n\t\t\t\tlabel->len);\n\t\tif (error)\n\t\t\tprintk(KERN_ERR \"%s() %s %d \"\n\t\t\t\t\t\"security_inode_notifysecctx() %d\\n\",\n\t\t\t\t\t__func__,\n\t\t\t\t\t(char *)label->label,\n\t\t\t\t\tlabel->len, error);\n\t\tnfs_clear_label_invalid(inode);\n\t}\n}"
  },
  {
    "function_name": "nfs_clear_label_invalid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "278-283",
    "snippet": "static void nfs_clear_label_invalid(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_LABEL;\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_clear_label_invalid(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_LABEL;\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "nfs_init_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "266-275",
    "snippet": "static int\nnfs_init_locked(struct inode *inode, void *opaque)\n{\n\tstruct nfs_find_desc\t*desc = (struct nfs_find_desc *)opaque;\n\tstruct nfs_fattr\t*fattr = desc->fattr;\n\n\tset_nfs_fileid(inode, fattr->fileid);\n\tnfs_copy_fh(NFS_FH(inode), desc->fh);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_copy_fh",
          "args": [
            "NFS_FH(inode)",
            "desc->fh"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_nfs_fileid",
          "args": [
            "inode",
            "fattr->fileid"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int\nnfs_init_locked(struct inode *inode, void *opaque)\n{\n\tstruct nfs_find_desc\t*desc = (struct nfs_find_desc *)opaque;\n\tstruct nfs_fattr\t*fattr = desc->fattr;\n\n\tset_nfs_fileid(inode, fattr->fileid);\n\tnfs_copy_fh(NFS_FH(inode), desc->fh);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_find_actor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "248-264",
    "snippet": "static int\nnfs_find_actor(struct inode *inode, void *opaque)\n{\n\tstruct nfs_find_desc\t*desc = (struct nfs_find_desc *)opaque;\n\tstruct nfs_fh\t\t*fh = desc->fh;\n\tstruct nfs_fattr\t*fattr = desc->fattr;\n\n\tif (NFS_FILEID(inode) != fattr->fileid)\n\t\treturn 0;\n\tif ((S_IFMT & inode->i_mode) != (S_IFMT & fattr->mode))\n\t\treturn 0;\n\tif (nfs_compare_fh(NFS_FH(inode), fh))\n\t\treturn 0;\n\tif (is_bad_inode(inode) || NFS_STALE(inode))\n\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);",
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "NFS_STALE",
          "args": [
            "inode"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_bad_inode",
          "args": [
            "inode"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "is_bad_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/bad_inode.c",
          "lines": "195-198",
          "snippet": "int is_bad_inode(struct inode *inode)\n{\n\treturn (inode->i_op == &bad_inode_ops);\t\n}",
          "includes": [
            "#include <linux/poll.h>",
            "#include <linux/namei.h>",
            "#include <linux/time.h>",
            "#include <linux/stat.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct inode_operations bad_inode_ops =\n{\n\t.create\t\t= bad_inode_create,\n\t.lookup\t\t= bad_inode_lookup,\n\t.link\t\t= bad_inode_link,\n\t.unlink\t\t= bad_inode_unlink,\n\t.symlink\t= bad_inode_symlink,\n\t.mkdir\t\t= bad_inode_mkdir,\n\t.rmdir\t\t= bad_inode_rmdir,\n\t.mknod\t\t= bad_inode_mknod,\n\t.rename2\t= bad_inode_rename2,\n\t.readlink\t= bad_inode_readlink,\n\t/* follow_link must be no-op, otherwise unmounting this inode\n\t   won't work */\n\t/* put_link returns void */\n\t/* truncate returns void */\n\t.permission\t= bad_inode_permission,\n\t.getattr\t= bad_inode_getattr,\n\t.setattr\t= bad_inode_setattr,\n\t.setxattr\t= bad_inode_setxattr,\n\t.getxattr\t= bad_inode_getxattr,\n\t.listxattr\t= bad_inode_listxattr,\n\t.removexattr\t= bad_inode_removexattr,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/poll.h>\n#include <linux/namei.h>\n#include <linux/time.h>\n#include <linux/stat.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nstatic const struct inode_operations bad_inode_ops =\n{\n\t.create\t\t= bad_inode_create,\n\t.lookup\t\t= bad_inode_lookup,\n\t.link\t\t= bad_inode_link,\n\t.unlink\t\t= bad_inode_unlink,\n\t.symlink\t= bad_inode_symlink,\n\t.mkdir\t\t= bad_inode_mkdir,\n\t.rmdir\t\t= bad_inode_rmdir,\n\t.mknod\t\t= bad_inode_mknod,\n\t.rename2\t= bad_inode_rename2,\n\t.readlink\t= bad_inode_readlink,\n\t/* follow_link must be no-op, otherwise unmounting this inode\n\t   won't work */\n\t/* put_link returns void */\n\t/* truncate returns void */\n\t.permission\t= bad_inode_permission,\n\t.getattr\t= bad_inode_getattr,\n\t.setattr\t= bad_inode_setattr,\n\t.setxattr\t= bad_inode_setxattr,\n\t.getxattr\t= bad_inode_getxattr,\n\t.listxattr\t= bad_inode_listxattr,\n\t.removexattr\t= bad_inode_removexattr,\n};\n\nint is_bad_inode(struct inode *inode)\n{\n\treturn (inode->i_op == &bad_inode_ops);\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_compare_fh",
          "args": [
            "NFS_FH(inode)",
            "fh"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FILEID",
          "args": [
            "inode"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic int\nnfs_find_actor(struct inode *inode, void *opaque)\n{\n\tstruct nfs_find_desc\t*desc = (struct nfs_find_desc *)opaque;\n\tstruct nfs_fh\t\t*fh = desc->fh;\n\tstruct nfs_fattr\t*fattr = desc->fattr;\n\n\tif (NFS_FILEID(inode) != fattr->fileid)\n\t\treturn 0;\n\tif ((S_IFMT & inode->i_mode) != (S_IFMT & fattr->mode))\n\t\treturn 0;\n\tif (nfs_compare_fh(NFS_FH(inode), fh))\n\t\treturn 0;\n\tif (is_bad_inode(inode) || NFS_STALE(inode))\n\t\treturn 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_invalidate_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "231-235",
    "snippet": "static void nfs_invalidate_inode(struct inode *inode)\n{\n\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\tnfs_zap_caches_locked(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_zap_caches_locked",
          "args": [
            "inode"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_caches_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "164-187",
          "snippet": "static void nfs_zap_caches_locked(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint mode = inode->i_mode;\n\n\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\n\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\tnfsi->attrtimeo_timestamp = jiffies;\n\n\tmemset(NFS_I(inode)->cookieverf, 0, sizeof(NFS_I(inode)->cookieverf));\n\tif (S_ISREG(mode) || S_ISDIR(mode) || S_ISLNK(mode)) {\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t} else\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\tnfs_zap_label_cache_locked(nfsi);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_zap_caches_locked(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint mode = inode->i_mode;\n\n\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\n\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\tnfsi->attrtimeo_timestamp = jiffies;\n\n\tmemset(NFS_I(inode)->cookieverf, 0, sizeof(NFS_I(inode)->cookieverf));\n\tif (S_ISREG(mode) || S_ISDIR(mode) || S_ISLNK(mode)) {\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t} else\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\tnfs_zap_label_cache_locked(nfsi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_INO_STALE",
            "&NFS_I(inode)->flags"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_invalidate_inode(struct inode *inode)\n{\n\tset_bit(NFS_INO_STALE, &NFS_I(inode)->flags);\n\tnfs_zap_caches_locked(inode);\n}"
  },
  {
    "function_name": "nfs_invalidate_atime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "219-224",
    "snippet": "void nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "NFS_INO_INVALID_ATIME"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "nfs_zap_acl_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "206-216",
    "snippet": "void nfs_zap_acl_cache(struct inode *inode)\n{\n\tvoid (*clear_acl_cache)(struct inode *);\n\n\tclear_acl_cache = NFS_PROTO(inode)->clear_acl_cache;\n\tif (clear_acl_cache != NULL)\n\t\tclear_acl_cache(inode);\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_ACL;\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_acl_cache",
          "args": [
            "inode"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_PROTO",
          "args": [
            "inode"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_acl_cache(struct inode *inode)\n{\n\tvoid (*clear_acl_cache)(struct inode *);\n\n\tclear_acl_cache = NFS_PROTO(inode)->clear_acl_cache;\n\tif (clear_acl_cache != NULL)\n\t\tclear_acl_cache(inode);\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_ACL;\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "nfs_zap_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "197-204",
    "snippet": "void nfs_zap_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tif (mapping->nrpages != 0) {\n\t\tspin_lock(&inode->i_lock);\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "NFS_INO_INVALID_DATA"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_mapping(struct inode *inode, struct address_space *mapping)\n{\n\tif (mapping->nrpages != 0) {\n\t\tspin_lock(&inode->i_lock);\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_DATA);\n\t\tspin_unlock(&inode->i_lock);\n\t}\n}"
  },
  {
    "function_name": "nfs_zap_caches",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "189-194",
    "snippet": "void nfs_zap_caches(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_zap_caches_locked(inode);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_zap_caches_locked",
          "args": [
            "inode"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_caches_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "164-187",
          "snippet": "static void nfs_zap_caches_locked(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint mode = inode->i_mode;\n\n\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\n\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\tnfsi->attrtimeo_timestamp = jiffies;\n\n\tmemset(NFS_I(inode)->cookieverf, 0, sizeof(NFS_I(inode)->cookieverf));\n\tif (S_ISREG(mode) || S_ISDIR(mode) || S_ISLNK(mode)) {\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t} else\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\tnfs_zap_label_cache_locked(nfsi);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_zap_caches_locked(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint mode = inode->i_mode;\n\n\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\n\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\tnfsi->attrtimeo_timestamp = jiffies;\n\n\tmemset(NFS_I(inode)->cookieverf, 0, sizeof(NFS_I(inode)->cookieverf));\n\tif (S_ISREG(mode) || S_ISDIR(mode) || S_ISLNK(mode)) {\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t} else\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\tnfs_zap_label_cache_locked(nfsi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_caches(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_zap_caches_locked(inode);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "nfs_zap_caches_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "164-187",
    "snippet": "static void nfs_zap_caches_locked(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint mode = inode->i_mode;\n\n\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\n\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\tnfsi->attrtimeo_timestamp = jiffies;\n\n\tmemset(NFS_I(inode)->cookieverf, 0, sizeof(NFS_I(inode)->cookieverf));\n\tif (S_ISREG(mode) || S_ISDIR(mode) || S_ISLNK(mode)) {\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t} else\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\tnfs_zap_label_cache_locked(nfsi);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_zap_label_cache_locked",
          "args": [
            "nfsi"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_label_cache_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "316-318",
          "snippet": "static inline void nfs_zap_label_cache_locked(struct nfs_inode *nfsi)\n{\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline void nfs_zap_label_cache_locked(struct nfs_inode *nfsi)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_cache_invalid",
          "args": [
            "inode",
            "NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_cache_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "150-159",
          "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "mode"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "mode"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "mode"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "NFS_I(inode)->cookieverf",
            "0",
            "sizeof(NFS_I(inode)->cookieverf)"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_MINATTRTIMEO",
          "args": [
            "inode"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_ATTRINVALIDATE"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_zap_caches_locked(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint mode = inode->i_mode;\n\n\tnfs_inc_stats(inode, NFSIOS_ATTRINVALIDATE);\n\n\tnfsi->attrtimeo = NFS_MINATTRTIMEO(inode);\n\tnfsi->attrtimeo_timestamp = jiffies;\n\n\tmemset(NFS_I(inode)->cookieverf, 0, sizeof(NFS_I(inode)->cookieverf));\n\tif (S_ISREG(mode) || S_ISDIR(mode) || S_ISLNK(mode)) {\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_DATA\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\t} else\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATTR\n\t\t\t\t\t| NFS_INO_INVALID_ACCESS\n\t\t\t\t\t| NFS_INO_INVALID_ACL\n\t\t\t\t\t| NFS_INO_REVAL_PAGECACHE);\n\tnfs_zap_label_cache_locked(nfsi);\n}"
  },
  {
    "function_name": "nfs_set_cache_invalid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "150-159",
    "snippet": "static void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fscache_invalidate",
          "args": [
            "inode"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_invalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
          "lines": "220-220",
          "snippet": "static inline void nfs_fscache_invalidate(struct inode *inode) {}",
          "includes": [
            "#include <linux/fscache.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_invalidate(struct inode *inode) {}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nstatic void nfs_set_cache_invalid(struct inode *inode, unsigned long flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\n\tif (inode->i_mapping->nrpages == 0)\n\t\tflags &= ~NFS_INO_INVALID_DATA;\n\tnfsi->cache_validity |= flags;\n\tif (flags & NFS_INO_INVALID_DATA)\n\t\tnfs_fscache_invalidate(inode);\n}"
  },
  {
    "function_name": "nfs_sync_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "139-148",
    "snippet": "int nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_wb_all",
          "args": [
            "mapping->host"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wb_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1841-1857",
          "snippet": "int nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unmap_mapping_range",
          "args": [
            "mapping",
            "0",
            "0",
            "0"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_sync_mapping(struct address_space *mapping)\n{\n\tint ret = 0;\n\n\tif (mapping->nrpages != 0) {\n\t\tunmap_mapping_range(mapping, 0, 0, 0);\n\t\tret = nfs_wb_all(mapping->host);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_evict_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "129-134",
    "snippet": "void nfs_evict_inode(struct inode *inode)\n{\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\tnfs_clear_inode(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_clear_inode",
          "args": [
            "inode"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_clear_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "116-126",
          "snippet": "void nfs_clear_inode(struct inode *inode)\n{\n\t/*\n\t * The following should never happen...\n\t */\n\tWARN_ON_ONCE(nfs_have_writebacks(inode));\n\tWARN_ON_ONCE(!list_empty(&NFS_I(inode)->open_files));\n\tnfs_zap_acl_cache(inode);\n\tnfs_access_zap_cache(inode);\n\tnfs_fscache_clear_inode(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_clear_inode(struct inode *inode)\n{\n\t/*\n\t * The following should never happen...\n\t */\n\tWARN_ON_ONCE(nfs_have_writebacks(inode));\n\tWARN_ON_ONCE(!list_empty(&NFS_I(inode)->open_files));\n\tnfs_zap_acl_cache(inode);\n\tnfs_access_zap_cache(inode);\n\tnfs_fscache_clear_inode(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages_final",
          "args": [
            "&inode->i_data"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_evict_inode(struct inode *inode)\n{\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\tnfs_clear_inode(inode);\n}"
  },
  {
    "function_name": "nfs_clear_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "116-126",
    "snippet": "void nfs_clear_inode(struct inode *inode)\n{\n\t/*\n\t * The following should never happen...\n\t */\n\tWARN_ON_ONCE(nfs_have_writebacks(inode));\n\tWARN_ON_ONCE(!list_empty(&NFS_I(inode)->open_files));\n\tnfs_zap_acl_cache(inode);\n\tnfs_access_zap_cache(inode);\n\tnfs_fscache_clear_inode(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fscache_clear_inode",
          "args": [
            "inode"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_clear_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "196-205",
          "snippet": "void nfs_fscache_clear_inode(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct fscache_cookie *cookie = nfs_i_fscache(inode);\n\n\tdfprintk(FSCACHE, \"NFS: clear cookie (0x%p/0x%p)\\n\", nfsi, cookie);\n\n\tfscache_relinquish_cookie(cookie, false);\n\tnfsi->fscache = NULL;\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid nfs_fscache_clear_inode(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct fscache_cookie *cookie = nfs_i_fscache(inode);\n\n\tdfprintk(FSCACHE, \"NFS: clear cookie (0x%p/0x%p)\\n\", nfsi, cookie);\n\n\tfscache_relinquish_cookie(cookie, false);\n\tnfsi->fscache = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_access_zap_cache",
          "args": [
            "inode"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_access_zap_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "2200-2216",
          "snippet": "void nfs_access_zap_cache(struct inode *inode)\n{\n\tLIST_HEAD(head);\n\n\tif (test_bit(NFS_INO_ACL_LRU_SET, &NFS_I(inode)->flags) == 0)\n\t\treturn;\n\t/* Remove from global LRU init */\n\tspin_lock(&nfs_access_lru_lock);\n\tif (test_and_clear_bit(NFS_INO_ACL_LRU_SET, &NFS_I(inode)->flags))\n\t\tlist_del_init(&NFS_I(inode)->access_cache_inode_lru);\n\n\tspin_lock(&inode->i_lock);\n\t__nfs_access_zap_cache(NFS_I(inode), &head);\n\tspin_unlock(&inode->i_lock);\n\tspin_unlock(&nfs_access_lru_lock);\n\tnfs_access_free_list(&head);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_access_lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_access_lru_lock);\n\nvoid nfs_access_zap_cache(struct inode *inode)\n{\n\tLIST_HEAD(head);\n\n\tif (test_bit(NFS_INO_ACL_LRU_SET, &NFS_I(inode)->flags) == 0)\n\t\treturn;\n\t/* Remove from global LRU init */\n\tspin_lock(&nfs_access_lru_lock);\n\tif (test_and_clear_bit(NFS_INO_ACL_LRU_SET, &NFS_I(inode)->flags))\n\t\tlist_del_init(&NFS_I(inode)->access_cache_inode_lru);\n\n\tspin_lock(&inode->i_lock);\n\t__nfs_access_zap_cache(NFS_I(inode), &head);\n\tspin_unlock(&inode->i_lock);\n\tspin_unlock(&nfs_access_lru_lock);\n\tnfs_access_free_list(&head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_zap_acl_cache",
          "args": [
            "inode"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_acl_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "206-216",
          "snippet": "void nfs_zap_acl_cache(struct inode *inode)\n{\n\tvoid (*clear_acl_cache)(struct inode *);\n\n\tclear_acl_cache = NFS_PROTO(inode)->clear_acl_cache;\n\tif (clear_acl_cache != NULL)\n\t\tclear_acl_cache(inode);\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_ACL;\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_acl_cache(struct inode *inode)\n{\n\tvoid (*clear_acl_cache)(struct inode *);\n\n\tclear_acl_cache = NFS_PROTO(inode)->clear_acl_cache;\n\tif (clear_acl_cache != NULL)\n\t\tclear_acl_cache(inode);\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->cache_validity &= ~NFS_INO_INVALID_ACL;\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!list_empty(&NFS_I(inode)->open_files)"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&NFS_I(inode)->open_files"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "nfs_have_writebacks(inode)"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_have_writebacks",
          "args": [
            "inode"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_clear_inode(struct inode *inode)\n{\n\t/*\n\t * The following should never happen...\n\t */\n\tWARN_ON_ONCE(nfs_have_writebacks(inode));\n\tWARN_ON_ONCE(!list_empty(&NFS_I(inode)->open_files));\n\tnfs_zap_acl_cache(inode);\n\tnfs_access_zap_cache(inode);\n\tnfs_fscache_clear_inode(inode);\n}"
  },
  {
    "function_name": "nfs_drop_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "110-113",
    "snippet": "int nfs_drop_inode(struct inode *inode)\n{\n\treturn NFS_STALE(inode) || generic_drop_inode(inode);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs_invalidate_inode(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_drop_inode",
          "args": [
            "inode"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_STALE",
          "args": [
            "inode"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nint nfs_drop_inode(struct inode *inode)\n{\n\treturn NFS_STALE(inode) || generic_drop_inode(inode);\n}"
  },
  {
    "function_name": "nfs_compat_user_ino64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "94-108",
    "snippet": "u64 nfs_compat_user_ino64(u64 fileid)\n{\n#ifdef CONFIG_COMPAT\n\tcompat_ulong_t ino;\n#else\t\n\tunsigned long ino;\n#endif\n\n\tif (enable_ino64)\n\t\treturn fileid;\n\tino = fileid;\n\tif (sizeof(ino) < sizeof(fileid))\n\t\tino ^= fileid >> (sizeof(fileid)-sizeof(ino)) * 8;\n\treturn ino;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool enable_ino64 = NFS_64_BIT_INODE_NUMBERS_ENABLED;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic bool enable_ino64 = NFS_64_BIT_INODE_NUMBERS_ENABLED;\n\nu64 nfs_compat_user_ino64(u64 fileid)\n{\n#ifdef CONFIG_COMPAT\n\tcompat_ulong_t ino;\n#else\t\n\tunsigned long ino;\n#endif\n\n\tif (enable_ino64)\n\t\treturn fileid;\n\tino = fileid;\n\tif (sizeof(ino) < sizeof(fileid))\n\t\tino ^= fileid >> (sizeof(fileid)-sizeof(ino)) * 8;\n\treturn ino;\n}"
  },
  {
    "function_name": "nfs_wait_bit_killable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "78-84",
    "snippet": "int nfs_wait_bit_killable(struct wait_bit_key *key)\n{\n\tif (fatal_signal_pending(current))\n\t\treturn -ERESTARTSYS;\n\tfreezable_schedule_unsafe();\n\treturn 0;\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freezable_schedule_unsafe",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal_signal_pending",
          "args": [
            "current"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_wait_bit_killable(struct wait_bit_key *key)\n{\n\tif (fatal_signal_pending(current))\n\t\treturn -ERESTARTSYS;\n\tfreezable_schedule_unsafe();\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_fattr_to_ino_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
    "lines": "68-72",
    "snippet": "static inline unsigned long\nnfs_fattr_to_ino_t(struct nfs_fattr *fattr)\n{\n\treturn nfs_fileid_to_ino_t(fattr->fileid);\n}",
    "includes": [
      "#include \"nfstrace.h\"",
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/freezer.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fileid_to_ino_t",
          "args": [
            "fattr->fileid"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstatic inline unsigned long\nnfs_fattr_to_ino_t(struct nfs_fattr *fattr)\n{\n\treturn nfs_fileid_to_ino_t(fattr->fileid);\n}"
  }
]