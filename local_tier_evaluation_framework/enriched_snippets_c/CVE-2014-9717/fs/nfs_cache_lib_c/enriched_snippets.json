[
  {
    "function_name": "nfs_cache_unregister_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "148-158",
    "snippet": "void nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sunrpc_destroy_cache_detail",
          "args": [
            "cd"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_put_sb_net",
          "args": [
            "net"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_cache_unregister_sb",
          "args": [
            "pipefs_sb",
            "cd"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_unregister_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "142-146",
          "snippet": "void nfs_cache_unregister_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tif (cd->u.pipefs.dir)\n\t\tsunrpc_cache_unregister_pipefs(cd);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tif (cd->u.pipefs.dir)\n\t\tsunrpc_cache_unregister_pipefs(cd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_get_sb_net",
          "args": [
            "net"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}"
  },
  {
    "function_name": "nfs_cache_unregister_sb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "142-146",
    "snippet": "void nfs_cache_unregister_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tif (cd->u.pipefs.dir)\n\t\tsunrpc_cache_unregister_pipefs(cd);\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sunrpc_cache_unregister_pipefs",
          "args": [
            "cd"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tif (cd->u.pipefs.dir)\n\t\tsunrpc_cache_unregister_pipefs(cd);\n}"
  },
  {
    "function_name": "nfs_cache_register_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "126-140",
    "snippet": "int nfs_cache_register_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\tint ret = 0;\n\n\tsunrpc_init_cache_detail(cd);\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tret = nfs_cache_register_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t\tif (ret)\n\t\t\tsunrpc_destroy_cache_detail(cd);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sunrpc_destroy_cache_detail",
          "args": [
            "cd"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_put_sb_net",
          "args": [
            "net"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_cache_register_sb",
          "args": [
            "pipefs_sb",
            "cd"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_register_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "115-124",
          "snippet": "int nfs_cache_register_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tint ret;\n\tstruct dentry *dir;\n\n\tdir = rpc_d_lookup_sb(sb, \"cache\");\n\tret = sunrpc_cache_register_pipefs(dir, cd->name, 0600, cd);\n\tdput(dir);\n\treturn ret;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nint nfs_cache_register_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tint ret;\n\tstruct dentry *dir;\n\n\tdir = rpc_d_lookup_sb(sb, \"cache\");\n\tret = sunrpc_cache_register_pipefs(dir, cd->name, 0600, cd);\n\tdput(dir);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_get_sb_net",
          "args": [
            "net"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_init_cache_detail",
          "args": [
            "cd"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nint nfs_cache_register_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\tint ret = 0;\n\n\tsunrpc_init_cache_detail(cd);\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tret = nfs_cache_register_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t\tif (ret)\n\t\t\tsunrpc_destroy_cache_detail(cd);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_cache_register_sb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "115-124",
    "snippet": "int nfs_cache_register_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tint ret;\n\tstruct dentry *dir;\n\n\tdir = rpc_d_lookup_sb(sb, \"cache\");\n\tret = sunrpc_cache_register_pipefs(dir, cd->name, 0600, cd);\n\tdput(dir);\n\treturn ret;\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "dir"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_register_pipefs",
          "args": [
            "dir",
            "cd->name",
            "0600",
            "cd"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_d_lookup_sb",
          "args": [
            "sb",
            "\"cache\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nint nfs_cache_register_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tint ret;\n\tstruct dentry *dir;\n\n\tdir = rpc_d_lookup_sb(sb, \"cache\");\n\tret = sunrpc_cache_register_pipefs(dir, cd->name, 0600, cd);\n\tdput(dir);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_cache_wait_for_upcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "107-113",
    "snippet": "int nfs_cache_wait_for_upcall(struct nfs_cache_defer_req *dreq)\n{\n\tif (wait_for_completion_timeout(&dreq->completion,\n\t\t\tnfs_cache_getent_timeout * HZ) == 0)\n\t\treturn -ETIMEDOUT;\n\treturn 0;\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long nfs_cache_getent_timeout = NFS_CACHE_UPCALL_TIMEOUT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion_timeout",
          "args": [
            "&dreq->completion",
            "nfs_cache_getent_timeout * HZ"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstatic unsigned long nfs_cache_getent_timeout = NFS_CACHE_UPCALL_TIMEOUT;\n\nint nfs_cache_wait_for_upcall(struct nfs_cache_defer_req *dreq)\n{\n\tif (wait_for_completion_timeout(&dreq->completion,\n\t\t\tnfs_cache_getent_timeout * HZ) == 0)\n\t\treturn -ETIMEDOUT;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_cache_defer_req_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "94-105",
    "snippet": "struct nfs_cache_defer_req *nfs_cache_defer_req_alloc(void)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = kzalloc(sizeof(*dreq), GFP_KERNEL);\n\tif (dreq) {\n\t\tinit_completion(&dreq->completion);\n\t\tatomic_set(&dreq->count, 1);\n\t\tdreq->req.defer = nfs_dns_cache_defer;\n\t}\n\treturn dreq;\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&dreq->count",
            "1"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&dreq->completion"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*dreq)",
            "GFP_KERNEL"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstruct nfs_cache_defer_req *nfs_cache_defer_req_alloc(void)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = kzalloc(sizeof(*dreq), GFP_KERNEL);\n\tif (dreq) {\n\t\tinit_completion(&dreq->completion);\n\t\tatomic_set(&dreq->count, 1);\n\t\tdreq->req.defer = nfs_dns_cache_defer;\n\t}\n\treturn dreq;\n}"
  },
  {
    "function_name": "nfs_dns_cache_defer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "83-92",
    "snippet": "static struct cache_deferred_req *nfs_dns_cache_defer(struct cache_req *req)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = container_of(req, struct nfs_cache_defer_req, req);\n\tdreq->deferred_req.revisit = nfs_dns_cache_revisit;\n\tatomic_inc(&dreq->count);\n\n\treturn &dreq->deferred_req;\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&dreq->count"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "req",
            "structnfs_cache_defer_req",
            "req"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstatic struct cache_deferred_req *nfs_dns_cache_defer(struct cache_req *req)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = container_of(req, struct nfs_cache_defer_req, req);\n\tdreq->deferred_req.revisit = nfs_dns_cache_revisit;\n\tatomic_inc(&dreq->count);\n\n\treturn &dreq->deferred_req;\n}"
  },
  {
    "function_name": "nfs_dns_cache_revisit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "73-81",
    "snippet": "static void nfs_dns_cache_revisit(struct cache_deferred_req *d, int toomany)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = container_of(d, struct nfs_cache_defer_req, deferred_req);\n\n\tcomplete_all(&dreq->completion);\n\tnfs_cache_defer_req_put(dreq);\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_cache_defer_req_put",
          "args": [
            "dreq"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_defer_req_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "67-71",
          "snippet": "void nfs_cache_defer_req_put(struct nfs_cache_defer_req *dreq)\n{\n\tif (atomic_dec_and_test(&dreq->count))\n\t\tkfree(dreq);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_defer_req_put(struct nfs_cache_defer_req *dreq)\n{\n\tif (atomic_dec_and_test(&dreq->count))\n\t\tkfree(dreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "complete_all",
          "args": [
            "&dreq->completion"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "d",
            "structnfs_cache_defer_req",
            "deferred_req"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstatic void nfs_dns_cache_revisit(struct cache_deferred_req *d, int toomany)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = container_of(d, struct nfs_cache_defer_req, deferred_req);\n\n\tcomplete_all(&dreq->completion);\n\tnfs_cache_defer_req_put(dreq);\n}"
  },
  {
    "function_name": "nfs_cache_defer_req_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "67-71",
    "snippet": "void nfs_cache_defer_req_put(struct nfs_cache_defer_req *dreq)\n{\n\tif (atomic_dec_and_test(&dreq->count))\n\t\tkfree(dreq);\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dreq"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&dreq->count"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_defer_req_put(struct nfs_cache_defer_req *dreq)\n{\n\tif (atomic_dec_and_test(&dreq->count))\n\t\tkfree(dreq);\n}"
  },
  {
    "function_name": "nfs_cache_upcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
    "lines": "34-62",
    "snippet": "int nfs_cache_upcall(struct cache_detail *cd, char *entry_name)\n{\n\tstatic char *envp[] = { \"HOME=/\",\n\t\t\"TERM=linux\",\n\t\t\"PATH=/sbin:/usr/sbin:/bin:/usr/bin\",\n\t\tNULL\n\t};\n\tchar *argv[] = {\n\t\tnfs_cache_getent_prog,\n\t\tcd->name,\n\t\tentry_name,\n\t\tNULL\n\t};\n\tint ret = -EACCES;\n\n\tif (nfs_cache_getent_prog[0] == '\\0')\n\t\tgoto out;\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_EXEC);\n\t/*\n\t * Disable the upcall mechanism if we're getting an ENOENT or\n\t * EACCES error. The admin can re-enable it on the fly by using\n\t * sysfs to set the 'cache_getent' parameter once the problem\n\t * has been fixed.\n\t */\n\tif (ret == -ENOENT || ret == -EACCES)\n\t\tnfs_cache_getent_prog[0] = '\\0';\nout:\n\treturn ret > 0 ? 0 : ret;\n}",
    "includes": [
      "#include \"cache_lib.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/kmod.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char nfs_cache_getent_prog[NFS_CACHE_UPCALL_PATHLEN] =\n\t\t\t\t\"/sbin/nfs_cache_getent\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_usermodehelper",
          "args": [
            "argv[0]",
            "argv",
            "envp",
            "UMH_WAIT_EXEC"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstatic char nfs_cache_getent_prog[NFS_CACHE_UPCALL_PATHLEN] =\n\t\t\t\t\"/sbin/nfs_cache_getent\";\n\nint nfs_cache_upcall(struct cache_detail *cd, char *entry_name)\n{\n\tstatic char *envp[] = { \"HOME=/\",\n\t\t\"TERM=linux\",\n\t\t\"PATH=/sbin:/usr/sbin:/bin:/usr/bin\",\n\t\tNULL\n\t};\n\tchar *argv[] = {\n\t\tnfs_cache_getent_prog,\n\t\tcd->name,\n\t\tentry_name,\n\t\tNULL\n\t};\n\tint ret = -EACCES;\n\n\tif (nfs_cache_getent_prog[0] == '\\0')\n\t\tgoto out;\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_EXEC);\n\t/*\n\t * Disable the upcall mechanism if we're getting an ENOENT or\n\t * EACCES error. The admin can re-enable it on the fly by using\n\t * sysfs to set the 'cache_getent' parameter once the problem\n\t * has been fixed.\n\t */\n\tif (ret == -ENOENT || ret == -EACCES)\n\t\tnfs_cache_getent_prog[0] = '\\0';\nout:\n\treturn ret > 0 ? 0 : ret;\n}"
  }
]