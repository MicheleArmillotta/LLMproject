[
  {
    "function_name": "v9fs_dir_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
    "lines": "225-235",
    "snippet": "int v9fs_dir_release(struct inode *inode, struct file *filp)\n{\n\tstruct p9_fid *fid;\n\n\tfid = filp->private_data;\n\tp9_debug(P9_DEBUG_VFS, \"inode: %p filp: %p fid: %d\\n\",\n\t\t inode, filp, fid ? fid->fid : -1);\n\tif (fid)\n\t\tp9_client_clunk(fid);\n\treturn 0;\n}",
    "includes": [
      "#include \"fid.h\"",
      "#include \"v9fs_vfs.h\"",
      "#include \"v9fs.h\"",
      "#include <net/9p/client.h>",
      "#include <net/9p/9p.h>",
      "#include <linux/slab.h>",
      "#include <linux/idr.h>",
      "#include <linux/inet.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/stat.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p9_client_clunk",
          "args": [
            "fid"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p9_debug",
          "args": [
            "P9_DEBUG_VFS",
            "\"inode: %p filp: %p fid: %d\\n\"",
            "inode",
            "filp",
            "fid ? fid->fid : -1"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nint v9fs_dir_release(struct inode *inode, struct file *filp)\n{\n\tstruct p9_fid *fid;\n\n\tfid = filp->private_data;\n\tp9_debug(P9_DEBUG_VFS, \"inode: %p filp: %p fid: %d\\n\",\n\t\t inode, filp, fid ? fid->fid : -1);\n\tif (fid)\n\t\tp9_client_clunk(fid);\n\treturn 0;\n}"
  },
  {
    "function_name": "v9fs_dir_readdir_dotl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
    "lines": "167-215",
    "snippet": "static int v9fs_dir_readdir_dotl(struct file *file, struct dir_context *ctx)\n{\n\tint err = 0;\n\tstruct p9_fid *fid;\n\tint buflen;\n\tstruct p9_rdir *rdir;\n\tstruct p9_dirent curdirent;\n\n\tp9_debug(P9_DEBUG_VFS, \"name %pD\\n\", file);\n\tfid = file->private_data;\n\n\tbuflen = fid->clnt->msize - P9_READDIRHDRSZ;\n\n\trdir = v9fs_alloc_rdir_buf(file, buflen);\n\tif (!rdir)\n\t\treturn -ENOMEM;\n\n\twhile (1) {\n\t\tif (rdir->tail == rdir->head) {\n\t\t\terr = p9_client_readdir(fid, rdir->buf, buflen,\n\t\t\t\t\t\tctx->pos);\n\t\t\tif (err <= 0)\n\t\t\t\treturn err;\n\n\t\t\trdir->head = 0;\n\t\t\trdir->tail = err;\n\t\t}\n\n\t\twhile (rdir->head < rdir->tail) {\n\n\t\t\terr = p9dirent_read(fid->clnt, rdir->buf + rdir->head,\n\t\t\t\t\t    rdir->tail - rdir->head,\n\t\t\t\t\t    &curdirent);\n\t\t\tif (err < 0) {\n\t\t\t\tp9_debug(P9_DEBUG_VFS, \"returned %d\\n\", err);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\n\t\t\tif (!dir_emit(ctx, curdirent.d_name,\n\t\t\t\t      strlen(curdirent.d_name),\n\t\t\t\t      v9fs_qid2ino(&curdirent.qid),\n\t\t\t\t      curdirent.d_type))\n\t\t\t\treturn 0;\n\n\t\t\tctx->pos = curdirent.d_off;\n\t\t\trdir->head += err;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"fid.h\"",
      "#include \"v9fs_vfs.h\"",
      "#include \"v9fs.h\"",
      "#include <net/9p/client.h>",
      "#include <net/9p/9p.h>",
      "#include <linux/slab.h>",
      "#include <linux/idr.h>",
      "#include <linux/inet.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/stat.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dir_emit",
          "args": [
            "ctx",
            "curdirent.d_name",
            "strlen(curdirent.d_name)",
            "v9fs_qid2ino(&curdirent.qid)",
            "curdirent.d_type"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v9fs_qid2ino",
          "args": [
            "&curdirent.qid"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_qid2ino",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_inode.c",
          "lines": "1213-1224",
          "snippet": "ino_t v9fs_qid2ino(struct p9_qid *qid)\n{\n\tu64 path = qid->path + 2;\n\tino_t i = 0;\n\n\tif (sizeof(ino_t) == sizeof(path))\n\t\tmemcpy(&i, &path, sizeof(ino_t));\n\telse\n\t\ti = (ino_t) (path ^ (path >> 32));\n\n\treturn i;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/idr.h>",
            "#include <linux/namei.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/idr.h>\n#include <linux/namei.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nino_t v9fs_qid2ino(struct p9_qid *qid)\n{\n\tu64 path = qid->path + 2;\n\tino_t i = 0;\n\n\tif (sizeof(ino_t) == sizeof(path))\n\t\tmemcpy(&i, &path, sizeof(ino_t));\n\telse\n\t\ti = (ino_t) (path ^ (path >> 32));\n\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "curdirent.d_name"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "p9_debug",
          "args": [
            "P9_DEBUG_VFS",
            "\"returned %d\\n\"",
            "err"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p9dirent_read",
          "args": [
            "fid->clnt",
            "rdir->buf + rdir->head",
            "rdir->tail - rdir->head",
            "&curdirent"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p9_client_readdir",
          "args": [
            "fid",
            "rdir->buf",
            "buflen",
            "ctx->pos"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v9fs_alloc_rdir_buf",
          "args": [
            "file",
            "buflen"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_alloc_rdir_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
          "lines": "94-100",
          "snippet": "static struct p9_rdir *v9fs_alloc_rdir_buf(struct file *filp, int buflen)\n{\n\tstruct p9_fid *fid = filp->private_data;\n\tif (!fid->rdir)\n\t\tfid->rdir = kzalloc(sizeof(struct p9_rdir) + buflen, GFP_KERNEL);\n\treturn fid->rdir;\n}",
          "includes": [
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/slab.h>",
            "#include <linux/idr.h>",
            "#include <linux/inet.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic struct p9_rdir *v9fs_alloc_rdir_buf(struct file *filp, int buflen)\n{\n\tstruct p9_fid *fid = filp->private_data;\n\tif (!fid->rdir)\n\t\tfid->rdir = kzalloc(sizeof(struct p9_rdir) + buflen, GFP_KERNEL);\n\treturn fid->rdir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p9_debug",
          "args": [
            "P9_DEBUG_VFS",
            "\"name %pD\\n\"",
            "file"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic int v9fs_dir_readdir_dotl(struct file *file, struct dir_context *ctx)\n{\n\tint err = 0;\n\tstruct p9_fid *fid;\n\tint buflen;\n\tstruct p9_rdir *rdir;\n\tstruct p9_dirent curdirent;\n\n\tp9_debug(P9_DEBUG_VFS, \"name %pD\\n\", file);\n\tfid = file->private_data;\n\n\tbuflen = fid->clnt->msize - P9_READDIRHDRSZ;\n\n\trdir = v9fs_alloc_rdir_buf(file, buflen);\n\tif (!rdir)\n\t\treturn -ENOMEM;\n\n\twhile (1) {\n\t\tif (rdir->tail == rdir->head) {\n\t\t\terr = p9_client_readdir(fid, rdir->buf, buflen,\n\t\t\t\t\t\tctx->pos);\n\t\t\tif (err <= 0)\n\t\t\t\treturn err;\n\n\t\t\trdir->head = 0;\n\t\t\trdir->tail = err;\n\t\t}\n\n\t\twhile (rdir->head < rdir->tail) {\n\n\t\t\terr = p9dirent_read(fid->clnt, rdir->buf + rdir->head,\n\t\t\t\t\t    rdir->tail - rdir->head,\n\t\t\t\t\t    &curdirent);\n\t\t\tif (err < 0) {\n\t\t\t\tp9_debug(P9_DEBUG_VFS, \"returned %d\\n\", err);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\n\t\t\tif (!dir_emit(ctx, curdirent.d_name,\n\t\t\t\t      strlen(curdirent.d_name),\n\t\t\t\t      v9fs_qid2ino(&curdirent.qid),\n\t\t\t\t      curdirent.d_type))\n\t\t\t\treturn 0;\n\n\t\t\tctx->pos = curdirent.d_off;\n\t\t\trdir->head += err;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "v9fs_dir_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
    "lines": "109-159",
    "snippet": "static int v9fs_dir_readdir(struct file *file, struct dir_context *ctx)\n{\n\tbool over;\n\tstruct p9_wstat st;\n\tint err = 0;\n\tstruct p9_fid *fid;\n\tint buflen;\n\tint reclen = 0;\n\tstruct p9_rdir *rdir;\n\n\tp9_debug(P9_DEBUG_VFS, \"name %pD\\n\", file);\n\tfid = file->private_data;\n\n\tbuflen = fid->clnt->msize - P9_IOHDRSZ;\n\n\trdir = v9fs_alloc_rdir_buf(file, buflen);\n\tif (!rdir)\n\t\treturn -ENOMEM;\n\n\twhile (1) {\n\t\tif (rdir->tail == rdir->head) {\n\t\t\terr = v9fs_file_readn(file, rdir->buf, NULL,\n\t\t\t\t\t\t\tbuflen, ctx->pos);\n\t\t\tif (err <= 0)\n\t\t\t\treturn err;\n\n\t\t\trdir->head = 0;\n\t\t\trdir->tail = err;\n\t\t}\n\t\twhile (rdir->head < rdir->tail) {\n\t\t\tp9stat_init(&st);\n\t\t\terr = p9stat_read(fid->clnt, rdir->buf + rdir->head,\n\t\t\t\t\t  rdir->tail - rdir->head, &st);\n\t\t\tif (err) {\n\t\t\t\tp9_debug(P9_DEBUG_VFS, \"returned %d\\n\", err);\n\t\t\t\tp9stat_free(&st);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\t\t\treclen = st.size+2;\n\n\t\t\tover = !dir_emit(ctx, st.name, strlen(st.name),\n\t\t\t\t\t v9fs_qid2ino(&st.qid), dt_type(&st));\n\t\t\tp9stat_free(&st);\n\t\t\tif (over)\n\t\t\t\treturn 0;\n\n\t\t\trdir->head += reclen;\n\t\t\tctx->pos += reclen;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"fid.h\"",
      "#include \"v9fs_vfs.h\"",
      "#include \"v9fs.h\"",
      "#include <net/9p/client.h>",
      "#include <net/9p/9p.h>",
      "#include <linux/slab.h>",
      "#include <linux/idr.h>",
      "#include <linux/inet.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/stat.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p9stat_free",
          "args": [
            "&st"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir_emit",
          "args": [
            "ctx",
            "st.name",
            "strlen(st.name)",
            "v9fs_qid2ino(&st.qid)",
            "dt_type(&st)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_type",
          "args": [
            "&st"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "dt_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
          "lines": "65-76",
          "snippet": "static inline int dt_type(struct p9_wstat *mistat)\n{\n\tunsigned long perm = mistat->mode;\n\tint rettype = DT_REG;\n\n\tif (perm & P9_DMDIR)\n\t\trettype = DT_DIR;\n\tif (perm & P9_DMSYMLINK)\n\t\trettype = DT_LNK;\n\n\treturn rettype;\n}",
          "includes": [
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/slab.h>",
            "#include <linux/idr.h>",
            "#include <linux/inet.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic inline int dt_type(struct p9_wstat *mistat)\n{\n\tunsigned long perm = mistat->mode;\n\tint rettype = DT_REG;\n\n\tif (perm & P9_DMDIR)\n\t\trettype = DT_DIR;\n\tif (perm & P9_DMSYMLINK)\n\t\trettype = DT_LNK;\n\n\treturn rettype;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_qid2ino",
          "args": [
            "&st.qid"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_qid2ino",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_inode.c",
          "lines": "1213-1224",
          "snippet": "ino_t v9fs_qid2ino(struct p9_qid *qid)\n{\n\tu64 path = qid->path + 2;\n\tino_t i = 0;\n\n\tif (sizeof(ino_t) == sizeof(path))\n\t\tmemcpy(&i, &path, sizeof(ino_t));\n\telse\n\t\ti = (ino_t) (path ^ (path >> 32));\n\n\treturn i;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/idr.h>",
            "#include <linux/namei.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/idr.h>\n#include <linux/namei.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nino_t v9fs_qid2ino(struct p9_qid *qid)\n{\n\tu64 path = qid->path + 2;\n\tino_t i = 0;\n\n\tif (sizeof(ino_t) == sizeof(path))\n\t\tmemcpy(&i, &path, sizeof(ino_t));\n\telse\n\t\ti = (ino_t) (path ^ (path >> 32));\n\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "st.name"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "p9stat_free",
          "args": [
            "&st"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p9_debug",
          "args": [
            "P9_DEBUG_VFS",
            "\"returned %d\\n\"",
            "err"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p9stat_read",
          "args": [
            "fid->clnt",
            "rdir->buf + rdir->head",
            "rdir->tail - rdir->head",
            "&st"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p9stat_init",
          "args": [
            "&st"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "p9stat_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
          "lines": "78-85",
          "snippet": "static void p9stat_init(struct p9_wstat *stbuf)\n{\n\tstbuf->name  = NULL;\n\tstbuf->uid   = NULL;\n\tstbuf->gid   = NULL;\n\tstbuf->muid  = NULL;\n\tstbuf->extension = NULL;\n}",
          "includes": [
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/slab.h>",
            "#include <linux/idr.h>",
            "#include <linux/inet.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic void p9stat_init(struct p9_wstat *stbuf)\n{\n\tstbuf->name  = NULL;\n\tstbuf->uid   = NULL;\n\tstbuf->gid   = NULL;\n\tstbuf->muid  = NULL;\n\tstbuf->extension = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_file_readn",
          "args": [
            "file",
            "rdir->buf",
            "NULL",
            "buflen",
            "ctx->pos"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_file_readn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_file.c",
          "lines": "416-421",
          "snippet": "ssize_t\nv9fs_file_readn(struct file *filp, char *data, char __user *udata, u32 count,\n\t       u64 offset)\n{\n\treturn v9fs_fid_readn(filp->private_data, data, udata, count, offset);\n}",
          "includes": [
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/idr.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/utsname.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/list.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/file.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/idr.h>\n#include <asm/uaccess.h>\n#include <linux/utsname.h>\n#include <linux/pagemap.h>\n#include <linux/list.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nssize_t\nv9fs_file_readn(struct file *filp, char *data, char __user *udata, u32 count,\n\t       u64 offset)\n{\n\treturn v9fs_fid_readn(filp->private_data, data, udata, count, offset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_alloc_rdir_buf",
          "args": [
            "file",
            "buflen"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_alloc_rdir_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
          "lines": "94-100",
          "snippet": "static struct p9_rdir *v9fs_alloc_rdir_buf(struct file *filp, int buflen)\n{\n\tstruct p9_fid *fid = filp->private_data;\n\tif (!fid->rdir)\n\t\tfid->rdir = kzalloc(sizeof(struct p9_rdir) + buflen, GFP_KERNEL);\n\treturn fid->rdir;\n}",
          "includes": [
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/slab.h>",
            "#include <linux/idr.h>",
            "#include <linux/inet.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic struct p9_rdir *v9fs_alloc_rdir_buf(struct file *filp, int buflen)\n{\n\tstruct p9_fid *fid = filp->private_data;\n\tif (!fid->rdir)\n\t\tfid->rdir = kzalloc(sizeof(struct p9_rdir) + buflen, GFP_KERNEL);\n\treturn fid->rdir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p9_debug",
          "args": [
            "P9_DEBUG_VFS",
            "\"name %pD\\n\"",
            "file"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic int v9fs_dir_readdir(struct file *file, struct dir_context *ctx)\n{\n\tbool over;\n\tstruct p9_wstat st;\n\tint err = 0;\n\tstruct p9_fid *fid;\n\tint buflen;\n\tint reclen = 0;\n\tstruct p9_rdir *rdir;\n\n\tp9_debug(P9_DEBUG_VFS, \"name %pD\\n\", file);\n\tfid = file->private_data;\n\n\tbuflen = fid->clnt->msize - P9_IOHDRSZ;\n\n\trdir = v9fs_alloc_rdir_buf(file, buflen);\n\tif (!rdir)\n\t\treturn -ENOMEM;\n\n\twhile (1) {\n\t\tif (rdir->tail == rdir->head) {\n\t\t\terr = v9fs_file_readn(file, rdir->buf, NULL,\n\t\t\t\t\t\t\tbuflen, ctx->pos);\n\t\t\tif (err <= 0)\n\t\t\t\treturn err;\n\n\t\t\trdir->head = 0;\n\t\t\trdir->tail = err;\n\t\t}\n\t\twhile (rdir->head < rdir->tail) {\n\t\t\tp9stat_init(&st);\n\t\t\terr = p9stat_read(fid->clnt, rdir->buf + rdir->head,\n\t\t\t\t\t  rdir->tail - rdir->head, &st);\n\t\t\tif (err) {\n\t\t\t\tp9_debug(P9_DEBUG_VFS, \"returned %d\\n\", err);\n\t\t\t\tp9stat_free(&st);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\t\t\treclen = st.size+2;\n\n\t\t\tover = !dir_emit(ctx, st.name, strlen(st.name),\n\t\t\t\t\t v9fs_qid2ino(&st.qid), dt_type(&st));\n\t\t\tp9stat_free(&st);\n\t\t\tif (over)\n\t\t\t\treturn 0;\n\n\t\t\trdir->head += reclen;\n\t\t\tctx->pos += reclen;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "v9fs_alloc_rdir_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
    "lines": "94-100",
    "snippet": "static struct p9_rdir *v9fs_alloc_rdir_buf(struct file *filp, int buflen)\n{\n\tstruct p9_fid *fid = filp->private_data;\n\tif (!fid->rdir)\n\t\tfid->rdir = kzalloc(sizeof(struct p9_rdir) + buflen, GFP_KERNEL);\n\treturn fid->rdir;\n}",
    "includes": [
      "#include \"fid.h\"",
      "#include \"v9fs_vfs.h\"",
      "#include \"v9fs.h\"",
      "#include <net/9p/client.h>",
      "#include <net/9p/9p.h>",
      "#include <linux/slab.h>",
      "#include <linux/idr.h>",
      "#include <linux/inet.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/stat.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct p9_rdir) + buflen",
            "GFP_KERNEL"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic struct p9_rdir *v9fs_alloc_rdir_buf(struct file *filp, int buflen)\n{\n\tstruct p9_fid *fid = filp->private_data;\n\tif (!fid->rdir)\n\t\tfid->rdir = kzalloc(sizeof(struct p9_rdir) + buflen, GFP_KERNEL);\n\treturn fid->rdir;\n}"
  },
  {
    "function_name": "p9stat_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
    "lines": "78-85",
    "snippet": "static void p9stat_init(struct p9_wstat *stbuf)\n{\n\tstbuf->name  = NULL;\n\tstbuf->uid   = NULL;\n\tstbuf->gid   = NULL;\n\tstbuf->muid  = NULL;\n\tstbuf->extension = NULL;\n}",
    "includes": [
      "#include \"fid.h\"",
      "#include \"v9fs_vfs.h\"",
      "#include \"v9fs.h\"",
      "#include <net/9p/client.h>",
      "#include <net/9p/9p.h>",
      "#include <linux/slab.h>",
      "#include <linux/idr.h>",
      "#include <linux/inet.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/stat.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic void p9stat_init(struct p9_wstat *stbuf)\n{\n\tstbuf->name  = NULL;\n\tstbuf->uid   = NULL;\n\tstbuf->gid   = NULL;\n\tstbuf->muid  = NULL;\n\tstbuf->extension = NULL;\n}"
  },
  {
    "function_name": "dt_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_dir.c",
    "lines": "65-76",
    "snippet": "static inline int dt_type(struct p9_wstat *mistat)\n{\n\tunsigned long perm = mistat->mode;\n\tint rettype = DT_REG;\n\n\tif (perm & P9_DMDIR)\n\t\trettype = DT_DIR;\n\tif (perm & P9_DMSYMLINK)\n\t\trettype = DT_LNK;\n\n\treturn rettype;\n}",
    "includes": [
      "#include \"fid.h\"",
      "#include \"v9fs_vfs.h\"",
      "#include \"v9fs.h\"",
      "#include <net/9p/client.h>",
      "#include <net/9p/9p.h>",
      "#include <linux/slab.h>",
      "#include <linux/idr.h>",
      "#include <linux/inet.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/stat.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/slab.h>\n#include <linux/idr.h>\n#include <linux/inet.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstatic inline int dt_type(struct p9_wstat *mistat)\n{\n\tunsigned long perm = mistat->mode;\n\tint rettype = DT_REG;\n\n\tif (perm & P9_DMDIR)\n\t\trettype = DT_DIR;\n\tif (perm & P9_DMSYMLINK)\n\t\trettype = DT_LNK;\n\n\treturn rettype;\n}"
  }
]