[
  {
    "function_name": "xfs_fs_eofblocks_from_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_icache.h",
    "lines": "79-113",
    "snippet": "static inline int\nxfs_fs_eofblocks_from_user(\n\tstruct xfs_fs_eofblocks\t\t*src,\n\tstruct xfs_eofblocks\t\t*dst)\n{\n\tif (src->eof_version != XFS_EOFBLOCKS_VERSION)\n\t\treturn -EINVAL;\n\n\tif (src->eof_flags & ~XFS_EOF_FLAGS_VALID)\n\t\treturn -EINVAL;\n\n\tif (memchr_inv(&src->pad32, 0, sizeof(src->pad32)) ||\n\t    memchr_inv(src->pad64, 0, sizeof(src->pad64)))\n\t\treturn -EINVAL;\n\n\tdst->eof_flags = src->eof_flags;\n\tdst->eof_prid = src->eof_prid;\n\tdst->eof_min_file_size = src->eof_min_file_size;\n\tdst->eof_scan_owner = NULLFSINO;\n\n\tdst->eof_uid = INVALID_UID;\n\tif (src->eof_flags & XFS_EOF_FLAGS_UID) {\n\t\tdst->eof_uid = make_kuid(current_user_ns(), src->eof_uid);\n\t\tif (!uid_valid(dst->eof_uid))\n\t\t\treturn -EINVAL;\n\t}\n\n\tdst->eof_gid = INVALID_GID;\n\tif (src->eof_flags & XFS_EOF_FLAGS_GID) {\n\t\tdst->eof_gid = make_kgid(current_user_ns(), src->eof_gid);\n\t\tif (!gid_valid(dst->eof_gid))\n\t\t\treturn -EINVAL;\n\t}\n\treturn 0;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "dst->eof_gid"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "current_user_ns()",
            "src->eof_gid"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "dst->eof_uid"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "current_user_ns()",
            "src->eof_uid"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr_inv",
          "args": [
            "src->pad64",
            "0",
            "sizeof(src->pad64)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr_inv",
          "args": [
            "&src->pad32",
            "0",
            "sizeof(src->pad32)"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline int\nxfs_fs_eofblocks_from_user(\n\tstruct xfs_fs_eofblocks\t\t*src,\n\tstruct xfs_eofblocks\t\t*dst)\n{\n\tif (src->eof_version != XFS_EOFBLOCKS_VERSION)\n\t\treturn -EINVAL;\n\n\tif (src->eof_flags & ~XFS_EOF_FLAGS_VALID)\n\t\treturn -EINVAL;\n\n\tif (memchr_inv(&src->pad32, 0, sizeof(src->pad32)) ||\n\t    memchr_inv(src->pad64, 0, sizeof(src->pad64)))\n\t\treturn -EINVAL;\n\n\tdst->eof_flags = src->eof_flags;\n\tdst->eof_prid = src->eof_prid;\n\tdst->eof_min_file_size = src->eof_min_file_size;\n\tdst->eof_scan_owner = NULLFSINO;\n\n\tdst->eof_uid = INVALID_UID;\n\tif (src->eof_flags & XFS_EOF_FLAGS_UID) {\n\t\tdst->eof_uid = make_kuid(current_user_ns(), src->eof_uid);\n\t\tif (!uid_valid(dst->eof_uid))\n\t\t\treturn -EINVAL;\n\t}\n\n\tdst->eof_gid = INVALID_GID;\n\tif (src->eof_flags & XFS_EOF_FLAGS_GID) {\n\t\tdst->eof_gid = make_kgid(current_user_ns(), src->eof_gid);\n\t\tif (!gid_valid(dst->eof_gid))\n\t\t\treturn -EINVAL;\n\t}\n\treturn 0;\n}"
  }
]