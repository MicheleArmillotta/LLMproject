[
  {
    "function_name": "btree_compare_double",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "783-792",
    "snippet": "static int\nbtree_compare_double(cont void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tdouble result = *(double *) key1 - *(double *) key2;\n\tif (result == 0.0)\n\t\treturn 0;\n\n\treturn (result < 0.0) ? -1 : 1;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbtree_compare_double(cont void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tdouble result = *(double *) key1 - *(double *) key2;\n\tif (result == 0.0)\n\t\treturn 0;\n\n\treturn (result < 0.0) ? -1 : 1;\n}"
  },
  {
    "function_name": "btree_compare_float",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "773-781",
    "snippet": "static int\nbtree_compare_float(cont void *key1, int keylen1, const void *key2, int keylen2)\n{\n\tfloat result = *(float *) key1 - *(float *) key2;\n\tif (result == 0.0f)\n\t\treturn 0;\n\n\treturn (result < 0.0f) ? -1 : 1;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbtree_compare_float(cont void *key1, int keylen1, const void *key2, int keylen2)\n{\n\tfloat result = *(float *) key1 - *(float *) key2;\n\tif (result == 0.0f)\n\t\treturn 0;\n\n\treturn (result < 0.0f) ? -1 : 1;\n}"
  },
  {
    "function_name": "btree_compare_uint64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "761-771",
    "snippet": "static int\nbtree_compare_uint64(cont void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tif (*(u_int64_t *) key1 == *(u_int64_t *) key2)\n\t\treturn 0;\n\telse if (*(u_int64_t *) key1 > *(u_int64_t *) key2)\n\t\treturn 1;\n\n\treturn -1;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbtree_compare_uint64(cont void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tif (*(u_int64_t *) key1 == *(u_int64_t *) key2)\n\t\treturn 0;\n\telse if (*(u_int64_t *) key1 > *(u_int64_t *) key2)\n\t\treturn 1;\n\n\treturn -1;\n}"
  },
  {
    "function_name": "btree_compare_int64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "750-759",
    "snippet": "static int\nbtree_compare_int64(cont void *key1, int keylen1, const void *key2, int keylen2)\n{\n\tif (*(int64_t *) key1 == *(int64_t *) key2)\n\t\treturn 0;\n\telse if (*(int64_t *) key1 > *(int64_t *) key2)\n\t\treturn 1;\n\n\treturn -1;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbtree_compare_int64(cont void *key1, int keylen1, const void *key2, int keylen2)\n{\n\tif (*(int64_t *) key1 == *(int64_t *) key2)\n\t\treturn 0;\n\telse if (*(int64_t *) key1 > *(int64_t *) key2)\n\t\treturn 1;\n\n\treturn -1;\n}"
  },
  {
    "function_name": "btree_compare_uint32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "739-749",
    "snippet": "static int\nbtree_compare_uint32(cont void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tif (*(u_int32_t *) key1 == *(u_int32_t *) key2)\n\t\treturn 0;\n\telse if (*(u_int32_t *) key1 > *(u_int32_t *) key2)\n\t\treturn 1;\n\n\treturn -1;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbtree_compare_uint32(cont void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tif (*(u_int32_t *) key1 == *(u_int32_t *) key2)\n\t\treturn 0;\n\telse if (*(u_int32_t *) key1 > *(u_int32_t *) key2)\n\t\treturn 1;\n\n\treturn -1;\n}"
  },
  {
    "function_name": "btree_compare_int32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "733-737",
    "snippet": "static int\nbtree_compare_int32(cont void *key1, int keylen1, const void *key2, int keylen2)\n{\n\treturn *(int32_t *) key1 - *(int32_t *) key2;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbtree_compare_int32(cont void *key1, int keylen1, const void *key2, int keylen2)\n{\n\treturn *(int32_t *) key1 - *(int32_t *) key2;\n}"
  },
  {
    "function_name": "befs_compare_strings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "720-729",
    "snippet": "static int\nbefs_compare_strings(const void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tint len = min_t(int, keylen1, keylen2);\n\tint result = strncmp(key1, key2, len);\n\tif (result == 0)\n\t\tresult = keylen1 - keylen2;\n\treturn result;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key1",
            "key2",
            "len"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "int",
            "keylen1",
            "keylen2"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbefs_compare_strings(const void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tint len = min_t(int, keylen1, keylen2);\n\tint result = strncmp(key1, key2, len);\n\tif (result == 0)\n\t\tresult = keylen1 - keylen2;\n\treturn result;\n}"
  },
  {
    "function_name": "befs_bt_get_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "683-707",
    "snippet": "static char *\nbefs_bt_get_key(struct super_block *sb, struct befs_btree_node *node,\n\t\tint index, u16 * keylen)\n{\n\tint prev_key_end;\n\tchar *keystart;\n\tfs16 *keylen_index;\n\n\tif (index < 0 || index > node->head.all_key_count) {\n\t\t*keylen = 0;\n\t\treturn NULL;\n\t}\n\n\tkeystart = befs_bt_keydata(node);\n\tkeylen_index = befs_bt_keylen_index(node);\n\n\tif (index == 0)\n\t\tprev_key_end = 0;\n\telse\n\t\tprev_key_end = fs16_to_cpu(sb, keylen_index[index - 1]);\n\n\t*keylen = fs16_to_cpu(sb, keylen_index[index]) - prev_key_end;\n\n\treturn keystart + prev_key_end;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);",
      "static char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sb",
            "keylen_index[index]"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "50-57",
          "snippet": "static inline u16\nfs16_to_cpu(const struct super_block *sb, fs16 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u16\nfs16_to_cpu(const struct super_block *sb, fs16 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_keylen_index",
          "args": [
            "node"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_keylen_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "630-642",
          "snippet": "static fs16 *\nbefs_bt_keylen_index(struct befs_btree_node *node)\n{\n\tconst int keylen_align = 8;\n\tunsigned long int off =\n\t    (sizeof (befs_btree_nodehead) + node->head.all_key_length);\n\tulong tmp = off % keylen_align;\n\n\tif (tmp)\n\t\toff += keylen_align - tmp;\n\n\treturn (fs16 *) ((void *) node->od_node + off);\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs16 *\nbefs_bt_keylen_index(struct befs_btree_node *node)\n{\n\tconst int keylen_align = 8;\n\tunsigned long int off =\n\t    (sizeof (befs_btree_nodehead) + node->head.all_key_length);\n\tulong tmp = off % keylen_align;\n\n\tif (tmp)\n\t\toff += keylen_align - tmp;\n\n\treturn (fs16 *) ((void *) node->od_node + off);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_keydata",
          "args": [
            "node"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_keydata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "667-671",
          "snippet": "static char *\nbefs_bt_keydata(struct befs_btree_node *node)\n{\n\treturn (char *) ((void *) node->od_node + sizeof (befs_btree_nodehead));\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic char *\nbefs_bt_keydata(struct befs_btree_node *node)\n{\n\treturn (char *) ((void *) node->od_node + sizeof (befs_btree_nodehead));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);\n\nstatic char *\nbefs_bt_get_key(struct super_block *sb, struct befs_btree_node *node,\n\t\tint index, u16 * keylen)\n{\n\tint prev_key_end;\n\tchar *keystart;\n\tfs16 *keylen_index;\n\n\tif (index < 0 || index > node->head.all_key_count) {\n\t\t*keylen = 0;\n\t\treturn NULL;\n\t}\n\n\tkeystart = befs_bt_keydata(node);\n\tkeylen_index = befs_bt_keylen_index(node);\n\n\tif (index == 0)\n\t\tprev_key_end = 0;\n\telse\n\t\tprev_key_end = fs16_to_cpu(sb, keylen_index[index - 1]);\n\n\t*keylen = fs16_to_cpu(sb, keylen_index[index]) - prev_key_end;\n\n\treturn keystart + prev_key_end;\n}"
  },
  {
    "function_name": "befs_bt_keydata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "667-671",
    "snippet": "static char *\nbefs_bt_keydata(struct befs_btree_node *node)\n{\n\treturn (char *) ((void *) node->od_node + sizeof (befs_btree_nodehead));\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic char *\nbefs_bt_keydata(struct befs_btree_node *node)\n{\n\treturn (char *) ((void *) node->od_node + sizeof (befs_btree_nodehead));\n}"
  },
  {
    "function_name": "befs_bt_valarray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "651-658",
    "snippet": "static fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_bt_keylen_index",
          "args": [
            "node"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_keylen_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "630-642",
          "snippet": "static fs16 *\nbefs_bt_keylen_index(struct befs_btree_node *node)\n{\n\tconst int keylen_align = 8;\n\tunsigned long int off =\n\t    (sizeof (befs_btree_nodehead) + node->head.all_key_length);\n\tulong tmp = off % keylen_align;\n\n\tif (tmp)\n\t\toff += keylen_align - tmp;\n\n\treturn (fs16 *) ((void *) node->od_node + off);\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs16 *\nbefs_bt_keylen_index(struct befs_btree_node *node)\n{\n\tconst int keylen_align = 8;\n\tunsigned long int off =\n\t    (sizeof (befs_btree_nodehead) + node->head.all_key_length);\n\tulong tmp = off % keylen_align;\n\n\tif (tmp)\n\t\toff += keylen_align - tmp;\n\n\treturn (fs16 *) ((void *) node->od_node + off);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}"
  },
  {
    "function_name": "befs_bt_keylen_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "630-642",
    "snippet": "static fs16 *\nbefs_bt_keylen_index(struct befs_btree_node *node)\n{\n\tconst int keylen_align = 8;\n\tunsigned long int off =\n\t    (sizeof (befs_btree_nodehead) + node->head.all_key_length);\n\tulong tmp = off % keylen_align;\n\n\tif (tmp)\n\t\toff += keylen_align - tmp;\n\n\treturn (fs16 *) ((void *) node->od_node + off);\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs16 *\nbefs_bt_keylen_index(struct befs_btree_node *node)\n{\n\tconst int keylen_align = 8;\n\tunsigned long int off =\n\t    (sizeof (befs_btree_nodehead) + node->head.all_key_length);\n\tulong tmp = off % keylen_align;\n\n\tif (tmp)\n\t\toff += keylen_align - tmp;\n\n\treturn (fs16 *) ((void *) node->od_node + off);\n}"
  },
  {
    "function_name": "befs_leafnode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "607-615",
    "snippet": "static int\nbefs_leafnode(struct befs_btree_node *node)\n{\n\t/* all interior nodes (and only interior nodes) have an overflow node */\n\tif (node->head.overflow == befs_bt_inval)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;",
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_leafnode(struct befs_btree_node *node)\n{\n\t/* all interior nodes (and only interior nodes) have an overflow node */\n\tif (node->head.overflow == befs_bt_inval)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "befs_btree_seekleaf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "550-598",
    "snippet": "static int\nbefs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t    befs_btree_super *bt_super,\n\t\t    struct befs_btree_node *this_node,\n\t\t    befs_off_t * node_off)\n{\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\tgoto error;\n\t}\n\tbefs_debug(sb, \"Seekleaf to root node %llu\", *node_off);\n\n\tif (this_node->head.all_key_count == 0 && befs_leafnode(this_node)) {\n\t\tbefs_debug(sb, \"<--- %s Tree is EMPTY\", __func__);\n\t\treturn BEFS_BT_EMPTY;\n\t}\n\n\twhile (!befs_leafnode(this_node)) {\n\n\t\tif (this_node->head.all_key_count == 0) {\n\t\t\tbefs_debug(sb, \"%s encountered \"\n\t\t\t\t   \"an empty interior node: %llu. Using Overflow \"\n\t\t\t\t   \"node: %llu\", __func__, *node_off,\n\t\t\t\t   this_node->head.overflow);\n\t\t\t*node_off = this_node->head.overflow;\n\t\t} else {\n\t\t\tfs64 *valarray = befs_bt_valarray(this_node);\n\t\t\t*node_off = fs64_to_cpu(sb, valarray[0]);\n\t\t}\n\t\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\t\tgoto error;\n\t\t}\n\n\t\tbefs_debug(sb, \"Seekleaf to child node %llu\", *node_off);\n\t}\n\tbefs_debug(sb, \"Node %llu is a leaf node\", *node_off);\n\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
      "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s ERROR\"",
            "__func__"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"%s failed to read \"\n\t\t\t\t   \"node at %llu\"",
            "__func__",
            "*node_off"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_read_node",
          "args": [
            "sb",
            "ds",
            "this_node",
            "*node_off"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_read_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "195-229",
          "snippet": "static int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
            "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "valarray[0]"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "14-21",
          "snippet": "static inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_valarray",
          "args": [
            "this_node"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_valarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "651-658",
          "snippet": "static fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_leafnode",
          "args": [
            "this_node"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "befs_leafnode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "607-615",
          "snippet": "static int\nbefs_leafnode(struct befs_btree_node *node)\n{\n\t/* all interior nodes (and only interior nodes) have an overflow node */\n\tif (node->head.overflow == befs_bt_inval)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;",
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_leafnode(struct befs_btree_node *node)\n{\n\t/* all interior nodes (and only interior nodes) have an overflow node */\n\tif (node->head.overflow == befs_bt_inval)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t    befs_btree_super *bt_super,\n\t\t    struct befs_btree_node *this_node,\n\t\t    befs_off_t * node_off)\n{\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\tgoto error;\n\t}\n\tbefs_debug(sb, \"Seekleaf to root node %llu\", *node_off);\n\n\tif (this_node->head.all_key_count == 0 && befs_leafnode(this_node)) {\n\t\tbefs_debug(sb, \"<--- %s Tree is EMPTY\", __func__);\n\t\treturn BEFS_BT_EMPTY;\n\t}\n\n\twhile (!befs_leafnode(this_node)) {\n\n\t\tif (this_node->head.all_key_count == 0) {\n\t\t\tbefs_debug(sb, \"%s encountered \"\n\t\t\t\t   \"an empty interior node: %llu. Using Overflow \"\n\t\t\t\t   \"node: %llu\", __func__, *node_off,\n\t\t\t\t   this_node->head.overflow);\n\t\t\t*node_off = this_node->head.overflow;\n\t\t} else {\n\t\t\tfs64 *valarray = befs_bt_valarray(this_node);\n\t\t\t*node_off = fs64_to_cpu(sb, valarray[0]);\n\t\t}\n\t\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\t\tgoto error;\n\t\t}\n\n\t\tbefs_debug(sb, \"Seekleaf to child node %llu\", *node_off);\n\t}\n\tbefs_debug(sb, \"Node %llu is a leaf node\", *node_off);\n\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
  },
  {
    "function_name": "befs_btree_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "418-533",
    "snippet": "int\nbefs_btree_read(struct super_block *sb, befs_data_stream * ds,\n\t\tloff_t key_no, size_t bufsize, char *keybuf, size_t * keysize,\n\t\tbefs_off_t * value)\n{\n\tstruct befs_btree_node *this_node;\n\tbefs_btree_super bt_super;\n\tbefs_off_t node_off = 0;\n\tint cur_key;\n\tfs64 *valarray;\n\tchar *keystart;\n\tu16 keylen;\n\tint res;\n\n\tuint key_sum = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (befs_bt_read_super(sb, ds, &bt_super) != BEFS_OK) {\n\t\tbefs_error(sb,\n\t\t\t   \"befs_btree_read() failed to read index superblock\");\n\t\tgoto error;\n\t}\n\n\tthis_node = kmalloc(sizeof(struct befs_btree_node), GFP_NOFS);\n\tif (this_node == NULL) {\n\t\tbefs_error(sb, \"befs_btree_read() failed to allocate %zu \"\n\t\t\t   \"bytes of memory\", sizeof(struct befs_btree_node));\n\t\tgoto error;\n\t}\n\n\tnode_off = bt_super.root_node_ptr;\n\tthis_node->bh = NULL;\n\n\t/* seeks down to first leafnode, reads it into this_node */\n\tres = befs_btree_seekleaf(sb, ds, &bt_super, this_node, &node_off);\n\tif (res == BEFS_BT_EMPTY) {\n\t\tbrelse(this_node->bh);\n\t\tkfree(this_node);\n\t\t*value = 0;\n\t\t*keysize = 0;\n\t\tbefs_debug(sb, \"<--- %s Tree is EMPTY\", __func__);\n\t\treturn BEFS_BT_EMPTY;\n\t} else if (res == BEFS_ERR) {\n\t\tgoto error_alloc;\n\t}\n\n\t/* find the leaf node containing the key_no key */\n\n\twhile (key_sum + this_node->head.all_key_count <= key_no) {\n\n\t\t/* no more nodes to look in: key_no is too large */\n\t\tif (this_node->head.right == befs_bt_inval) {\n\t\t\t*keysize = 0;\n\t\t\t*value = 0;\n\t\t\tbefs_debug(sb,\n\t\t\t\t   \"<--- %s END of keys at %llu\", __func__,\n\t\t\t\t   (unsigned long long)\n\t\t\t\t   key_sum + this_node->head.all_key_count);\n\t\t\tbrelse(this_node->bh);\n\t\t\tkfree(this_node);\n\t\t\treturn BEFS_BT_END;\n\t\t}\n\n\t\tkey_sum += this_node->head.all_key_count;\n\t\tnode_off = this_node->head.right;\n\n\t\tif (befs_bt_read_node(sb, ds, this_node, node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"%s failed to read node at %llu\",\n\t\t\t\t  __func__, (unsigned long long)node_off);\n\t\t\tgoto error_alloc;\n\t\t}\n\t}\n\n\t/* how many keys into this_node is key_no */\n\tcur_key = key_no - key_sum;\n\n\t/* get pointers to datastructures within the node body */\n\tvalarray = befs_bt_valarray(this_node);\n\n\tkeystart = befs_bt_get_key(sb, this_node, cur_key, &keylen);\n\n\tbefs_debug(sb, \"Read [%llu,%d]: keysize %d\",\n\t\t   (long long unsigned int)node_off, (int)cur_key,\n\t\t   (int)keylen);\n\n\tif (bufsize < keylen + 1) {\n\t\tbefs_error(sb, \"%s keybuf too small (%zu) \"\n\t\t\t   \"for key of size %d\", __func__, bufsize, keylen);\n\t\tbrelse(this_node->bh);\n\t\tgoto error_alloc;\n\t}\n\n\tstrlcpy(keybuf, keystart, keylen + 1);\n\t*value = fs64_to_cpu(sb, valarray[cur_key]);\n\t*keysize = keylen;\n\n\tbefs_debug(sb, \"Read [%llu,%d]: Key \\\"%.*s\\\", Value %llu\", node_off,\n\t\t   cur_key, keylen, keybuf, *value);\n\n\tbrelse(this_node->bh);\n\tkfree(this_node);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\n\treturn BEFS_OK;\n\n      error_alloc:\n\tkfree(this_node);\n\n      error:\n\t*keysize = 0;\n\t*value = 0;\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;",
      "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
      "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);",
      "static int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);",
      "static char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s ERROR\"",
            "__func__"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "this_node"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "this_node"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "this_node->bh"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "valarray[cur_key]"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "14-21",
          "snippet": "static inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "keybuf",
            "keystart",
            "keylen + 1"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"%s keybuf too small (%zu) \"\n\t\t\t   \"for key of size %d\"",
            "__func__",
            "bufsize",
            "keylen"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_get_key",
          "args": [
            "sb",
            "this_node",
            "cur_key",
            "&keylen"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "683-707",
          "snippet": "static char *\nbefs_bt_get_key(struct super_block *sb, struct befs_btree_node *node,\n\t\tint index, u16 * keylen)\n{\n\tint prev_key_end;\n\tchar *keystart;\n\tfs16 *keylen_index;\n\n\tif (index < 0 || index > node->head.all_key_count) {\n\t\t*keylen = 0;\n\t\treturn NULL;\n\t}\n\n\tkeystart = befs_bt_keydata(node);\n\tkeylen_index = befs_bt_keylen_index(node);\n\n\tif (index == 0)\n\t\tprev_key_end = 0;\n\telse\n\t\tprev_key_end = fs16_to_cpu(sb, keylen_index[index - 1]);\n\n\t*keylen = fs16_to_cpu(sb, keylen_index[index]) - prev_key_end;\n\n\treturn keystart + prev_key_end;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);",
            "static char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);\n\nstatic char *\nbefs_bt_get_key(struct super_block *sb, struct befs_btree_node *node,\n\t\tint index, u16 * keylen)\n{\n\tint prev_key_end;\n\tchar *keystart;\n\tfs16 *keylen_index;\n\n\tif (index < 0 || index > node->head.all_key_count) {\n\t\t*keylen = 0;\n\t\treturn NULL;\n\t}\n\n\tkeystart = befs_bt_keydata(node);\n\tkeylen_index = befs_bt_keylen_index(node);\n\n\tif (index == 0)\n\t\tprev_key_end = 0;\n\telse\n\t\tprev_key_end = fs16_to_cpu(sb, keylen_index[index - 1]);\n\n\t*keylen = fs16_to_cpu(sb, keylen_index[index]) - prev_key_end;\n\n\treturn keystart + prev_key_end;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_valarray",
          "args": [
            "this_node"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_valarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "651-658",
          "snippet": "static fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_read_node",
          "args": [
            "sb",
            "ds",
            "this_node",
            "node_off"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_read_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "195-229",
          "snippet": "static int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
            "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "this_node"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "this_node"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "befs_btree_seekleaf",
          "args": [
            "sb",
            "ds",
            "&bt_super",
            "this_node",
            "&node_off"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "befs_btree_seekleaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "550-598",
          "snippet": "static int\nbefs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t    befs_btree_super *bt_super,\n\t\t    struct befs_btree_node *this_node,\n\t\t    befs_off_t * node_off)\n{\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\tgoto error;\n\t}\n\tbefs_debug(sb, \"Seekleaf to root node %llu\", *node_off);\n\n\tif (this_node->head.all_key_count == 0 && befs_leafnode(this_node)) {\n\t\tbefs_debug(sb, \"<--- %s Tree is EMPTY\", __func__);\n\t\treturn BEFS_BT_EMPTY;\n\t}\n\n\twhile (!befs_leafnode(this_node)) {\n\n\t\tif (this_node->head.all_key_count == 0) {\n\t\t\tbefs_debug(sb, \"%s encountered \"\n\t\t\t\t   \"an empty interior node: %llu. Using Overflow \"\n\t\t\t\t   \"node: %llu\", __func__, *node_off,\n\t\t\t\t   this_node->head.overflow);\n\t\t\t*node_off = this_node->head.overflow;\n\t\t} else {\n\t\t\tfs64 *valarray = befs_bt_valarray(this_node);\n\t\t\t*node_off = fs64_to_cpu(sb, valarray[0]);\n\t\t}\n\t\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\t\tgoto error;\n\t\t}\n\n\t\tbefs_debug(sb, \"Seekleaf to child node %llu\", *node_off);\n\t}\n\tbefs_debug(sb, \"Node %llu is a leaf node\", *node_off);\n\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
            "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t    befs_btree_super *bt_super,\n\t\t    struct befs_btree_node *this_node,\n\t\t    befs_off_t * node_off)\n{\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\tgoto error;\n\t}\n\tbefs_debug(sb, \"Seekleaf to root node %llu\", *node_off);\n\n\tif (this_node->head.all_key_count == 0 && befs_leafnode(this_node)) {\n\t\tbefs_debug(sb, \"<--- %s Tree is EMPTY\", __func__);\n\t\treturn BEFS_BT_EMPTY;\n\t}\n\n\twhile (!befs_leafnode(this_node)) {\n\n\t\tif (this_node->head.all_key_count == 0) {\n\t\t\tbefs_debug(sb, \"%s encountered \"\n\t\t\t\t   \"an empty interior node: %llu. Using Overflow \"\n\t\t\t\t   \"node: %llu\", __func__, *node_off,\n\t\t\t\t   this_node->head.overflow);\n\t\t\t*node_off = this_node->head.overflow;\n\t\t} else {\n\t\t\tfs64 *valarray = befs_bt_valarray(this_node);\n\t\t\t*node_off = fs64_to_cpu(sb, valarray[0]);\n\t\t}\n\t\tif (befs_bt_read_node(sb, ds, this_node, *node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t\t   \"node at %llu\", __func__, *node_off);\n\t\t\tgoto error;\n\t\t}\n\n\t\tbefs_debug(sb, \"Seekleaf to child node %llu\", *node_off);\n\t}\n\tbefs_debug(sb, \"Node %llu is a leaf node\", *node_off);\n\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(struct befs_btree_node)",
            "GFP_NOFS"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_read_super",
          "args": [
            "sb",
            "ds",
            "&bt_super"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_read_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "136-174",
          "snippet": "static int\nbefs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t   befs_btree_super * sup)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_disk_btree_super *od_sup = NULL;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tbh = befs_read_datastream(sb, ds, 0, NULL);\n\n\tif (!bh) {\n\t\tbefs_error(sb, \"Couldn't read index header.\");\n\t\tgoto error;\n\t}\n\tod_sup = (befs_disk_btree_super *) bh->b_data;\n\tbefs_dump_index_entry(sb, od_sup);\n\n\tsup->magic = fs32_to_cpu(sb, od_sup->magic);\n\tsup->node_size = fs32_to_cpu(sb, od_sup->node_size);\n\tsup->max_depth = fs32_to_cpu(sb, od_sup->max_depth);\n\tsup->data_type = fs32_to_cpu(sb, od_sup->data_type);\n\tsup->root_node_ptr = fs64_to_cpu(sb, od_sup->root_node_ptr);\n\tsup->free_node_ptr = fs64_to_cpu(sb, od_sup->free_node_ptr);\n\tsup->max_size = fs64_to_cpu(sb, od_sup->max_size);\n\n\tbrelse(bh);\n\tif (sup->magic != BEFS_BTREE_MAGIC) {\n\t\tbefs_error(sb, \"Index header has bad magic.\");\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t\t      befs_btree_super * sup);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t\t      befs_btree_super * sup);\n\nstatic int\nbefs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t   befs_btree_super * sup)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_disk_btree_super *od_sup = NULL;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tbh = befs_read_datastream(sb, ds, 0, NULL);\n\n\tif (!bh) {\n\t\tbefs_error(sb, \"Couldn't read index header.\");\n\t\tgoto error;\n\t}\n\tod_sup = (befs_disk_btree_super *) bh->b_data;\n\tbefs_dump_index_entry(sb, od_sup);\n\n\tsup->magic = fs32_to_cpu(sb, od_sup->magic);\n\tsup->node_size = fs32_to_cpu(sb, od_sup->node_size);\n\tsup->max_depth = fs32_to_cpu(sb, od_sup->max_depth);\n\tsup->data_type = fs32_to_cpu(sb, od_sup->data_type);\n\tsup->root_node_ptr = fs64_to_cpu(sb, od_sup->root_node_ptr);\n\tsup->free_node_ptr = fs64_to_cpu(sb, od_sup->free_node_ptr);\n\tsup->max_size = fs64_to_cpu(sb, od_sup->max_size);\n\n\tbrelse(bh);\n\tif (sup->magic != BEFS_BTREE_MAGIC) {\n\t\tbefs_error(sb, \"Index header has bad magic.\");\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);\nstatic char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);\n\nint\nbefs_btree_read(struct super_block *sb, befs_data_stream * ds,\n\t\tloff_t key_no, size_t bufsize, char *keybuf, size_t * keysize,\n\t\tbefs_off_t * value)\n{\n\tstruct befs_btree_node *this_node;\n\tbefs_btree_super bt_super;\n\tbefs_off_t node_off = 0;\n\tint cur_key;\n\tfs64 *valarray;\n\tchar *keystart;\n\tu16 keylen;\n\tint res;\n\n\tuint key_sum = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (befs_bt_read_super(sb, ds, &bt_super) != BEFS_OK) {\n\t\tbefs_error(sb,\n\t\t\t   \"befs_btree_read() failed to read index superblock\");\n\t\tgoto error;\n\t}\n\n\tthis_node = kmalloc(sizeof(struct befs_btree_node), GFP_NOFS);\n\tif (this_node == NULL) {\n\t\tbefs_error(sb, \"befs_btree_read() failed to allocate %zu \"\n\t\t\t   \"bytes of memory\", sizeof(struct befs_btree_node));\n\t\tgoto error;\n\t}\n\n\tnode_off = bt_super.root_node_ptr;\n\tthis_node->bh = NULL;\n\n\t/* seeks down to first leafnode, reads it into this_node */\n\tres = befs_btree_seekleaf(sb, ds, &bt_super, this_node, &node_off);\n\tif (res == BEFS_BT_EMPTY) {\n\t\tbrelse(this_node->bh);\n\t\tkfree(this_node);\n\t\t*value = 0;\n\t\t*keysize = 0;\n\t\tbefs_debug(sb, \"<--- %s Tree is EMPTY\", __func__);\n\t\treturn BEFS_BT_EMPTY;\n\t} else if (res == BEFS_ERR) {\n\t\tgoto error_alloc;\n\t}\n\n\t/* find the leaf node containing the key_no key */\n\n\twhile (key_sum + this_node->head.all_key_count <= key_no) {\n\n\t\t/* no more nodes to look in: key_no is too large */\n\t\tif (this_node->head.right == befs_bt_inval) {\n\t\t\t*keysize = 0;\n\t\t\t*value = 0;\n\t\t\tbefs_debug(sb,\n\t\t\t\t   \"<--- %s END of keys at %llu\", __func__,\n\t\t\t\t   (unsigned long long)\n\t\t\t\t   key_sum + this_node->head.all_key_count);\n\t\t\tbrelse(this_node->bh);\n\t\t\tkfree(this_node);\n\t\t\treturn BEFS_BT_END;\n\t\t}\n\n\t\tkey_sum += this_node->head.all_key_count;\n\t\tnode_off = this_node->head.right;\n\n\t\tif (befs_bt_read_node(sb, ds, this_node, node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"%s failed to read node at %llu\",\n\t\t\t\t  __func__, (unsigned long long)node_off);\n\t\t\tgoto error_alloc;\n\t\t}\n\t}\n\n\t/* how many keys into this_node is key_no */\n\tcur_key = key_no - key_sum;\n\n\t/* get pointers to datastructures within the node body */\n\tvalarray = befs_bt_valarray(this_node);\n\n\tkeystart = befs_bt_get_key(sb, this_node, cur_key, &keylen);\n\n\tbefs_debug(sb, \"Read [%llu,%d]: keysize %d\",\n\t\t   (long long unsigned int)node_off, (int)cur_key,\n\t\t   (int)keylen);\n\n\tif (bufsize < keylen + 1) {\n\t\tbefs_error(sb, \"%s keybuf too small (%zu) \"\n\t\t\t   \"for key of size %d\", __func__, bufsize, keylen);\n\t\tbrelse(this_node->bh);\n\t\tgoto error_alloc;\n\t}\n\n\tstrlcpy(keybuf, keystart, keylen + 1);\n\t*value = fs64_to_cpu(sb, valarray[cur_key]);\n\t*keysize = keylen;\n\n\tbefs_debug(sb, \"Read [%llu,%d]: Key \\\"%.*s\\\", Value %llu\", node_off,\n\t\t   cur_key, keylen, keybuf, *value);\n\n\tbrelse(this_node->bh);\n\tkfree(this_node);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\n\treturn BEFS_OK;\n\n      error_alloc:\n\tkfree(this_node);\n\n      error:\n\t*keysize = 0;\n\t*value = 0;\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
  },
  {
    "function_name": "befs_find_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "338-396",
    "snippet": "static int\nbefs_find_key(struct super_block *sb, struct befs_btree_node *node,\n\t      const char *findkey, befs_off_t * value)\n{\n\tint first, last, mid;\n\tint eq;\n\tu16 keylen;\n\tint findkey_len;\n\tchar *thiskey;\n\tfs64 *valarray;\n\n\tbefs_debug(sb, \"---> %s %s\", __func__, findkey);\n\n\t*value = 0;\n\n\tfindkey_len = strlen(findkey);\n\n\t/* if node can not contain key, just skeep this node */\n\tlast = node->head.all_key_count - 1;\n\tthiskey = befs_bt_get_key(sb, node, last, &keylen);\n\n\teq = befs_compare_strings(thiskey, keylen, findkey, findkey_len);\n\tif (eq < 0) {\n\t\tbefs_debug(sb, \"<--- %s %s not found\", __func__, findkey);\n\t\treturn BEFS_BT_NOT_FOUND;\n\t}\n\n\tvalarray = befs_bt_valarray(node);\n\n\t/* simple binary search */\n\tfirst = 0;\n\tmid = 0;\n\twhile (last >= first) {\n\t\tmid = (last + first) / 2;\n\t\tbefs_debug(sb, \"first: %d, last: %d, mid: %d\", first, last,\n\t\t\t   mid);\n\t\tthiskey = befs_bt_get_key(sb, node, mid, &keylen);\n\t\teq = befs_compare_strings(thiskey, keylen, findkey,\n\t\t\t\t\t  findkey_len);\n\n\t\tif (eq == 0) {\n\t\t\tbefs_debug(sb, \"<--- %s found %s at %d\",\n\t\t\t\t   __func__, thiskey, mid);\n\n\t\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\t\t\treturn BEFS_BT_MATCH;\n\t\t}\n\t\tif (eq > 0)\n\t\t\tlast = mid - 1;\n\t\telse\n\t\t\tfirst = mid + 1;\n\t}\n\tif (eq < 0)\n\t\t*value = fs64_to_cpu(sb, valarray[mid + 1]);\n\telse\n\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\tbefs_debug(sb, \"<--- %s found %s at %d\", __func__, thiskey, mid);\n\treturn BEFS_BT_PARMATCH;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);",
      "static int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);",
      "static char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s found %s at %d\"",
            "__func__",
            "thiskey",
            "mid"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "valarray[mid]"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "14-21",
          "snippet": "static inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_compare_strings",
          "args": [
            "thiskey",
            "keylen",
            "findkey",
            "findkey_len"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "befs_compare_strings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "720-729",
          "snippet": "static int\nbefs_compare_strings(const void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tint len = min_t(int, keylen1, keylen2);\n\tint result = strncmp(key1, key2, len);\n\tif (result == 0)\n\t\tresult = keylen1 - keylen2;\n\treturn result;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_compare_strings(const void *key1, int keylen1,\n\t\t\t\tconst void *key2, int keylen2);\n\nstatic int\nbefs_compare_strings(const void *key1, int keylen1,\n\t\t     const void *key2, int keylen2)\n{\n\tint len = min_t(int, keylen1, keylen2);\n\tint result = strncmp(key1, key2, len);\n\tif (result == 0)\n\t\tresult = keylen1 - keylen2;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_get_key",
          "args": [
            "sb",
            "node",
            "mid",
            "&keylen"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "683-707",
          "snippet": "static char *\nbefs_bt_get_key(struct super_block *sb, struct befs_btree_node *node,\n\t\tint index, u16 * keylen)\n{\n\tint prev_key_end;\n\tchar *keystart;\n\tfs16 *keylen_index;\n\n\tif (index < 0 || index > node->head.all_key_count) {\n\t\t*keylen = 0;\n\t\treturn NULL;\n\t}\n\n\tkeystart = befs_bt_keydata(node);\n\tkeylen_index = befs_bt_keylen_index(node);\n\n\tif (index == 0)\n\t\tprev_key_end = 0;\n\telse\n\t\tprev_key_end = fs16_to_cpu(sb, keylen_index[index - 1]);\n\n\t*keylen = fs16_to_cpu(sb, keylen_index[index]) - prev_key_end;\n\n\treturn keystart + prev_key_end;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);",
            "static char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);\n\nstatic char *\nbefs_bt_get_key(struct super_block *sb, struct befs_btree_node *node,\n\t\tint index, u16 * keylen)\n{\n\tint prev_key_end;\n\tchar *keystart;\n\tfs16 *keylen_index;\n\n\tif (index < 0 || index > node->head.all_key_count) {\n\t\t*keylen = 0;\n\t\treturn NULL;\n\t}\n\n\tkeystart = befs_bt_keydata(node);\n\tkeylen_index = befs_bt_keylen_index(node);\n\n\tif (index == 0)\n\t\tprev_key_end = 0;\n\telse\n\t\tprev_key_end = fs16_to_cpu(sb, keylen_index[index - 1]);\n\n\t*keylen = fs16_to_cpu(sb, keylen_index[index]) - prev_key_end;\n\n\treturn keystart + prev_key_end;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_valarray",
          "args": [
            "node"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_valarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "651-658",
          "snippet": "static fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic fs64 *\nbefs_bt_valarray(struct befs_btree_node *node)\n{\n\tvoid *keylen_index_start = (void *) befs_bt_keylen_index(node);\n\tsize_t keylen_index_size = node->head.all_key_count * sizeof (fs16);\n\n\treturn (fs64 *) (keylen_index_start + keylen_index_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "findkey"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);\nstatic char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);\n\nstatic int\nbefs_find_key(struct super_block *sb, struct befs_btree_node *node,\n\t      const char *findkey, befs_off_t * value)\n{\n\tint first, last, mid;\n\tint eq;\n\tu16 keylen;\n\tint findkey_len;\n\tchar *thiskey;\n\tfs64 *valarray;\n\n\tbefs_debug(sb, \"---> %s %s\", __func__, findkey);\n\n\t*value = 0;\n\n\tfindkey_len = strlen(findkey);\n\n\t/* if node can not contain key, just skeep this node */\n\tlast = node->head.all_key_count - 1;\n\tthiskey = befs_bt_get_key(sb, node, last, &keylen);\n\n\teq = befs_compare_strings(thiskey, keylen, findkey, findkey_len);\n\tif (eq < 0) {\n\t\tbefs_debug(sb, \"<--- %s %s not found\", __func__, findkey);\n\t\treturn BEFS_BT_NOT_FOUND;\n\t}\n\n\tvalarray = befs_bt_valarray(node);\n\n\t/* simple binary search */\n\tfirst = 0;\n\tmid = 0;\n\twhile (last >= first) {\n\t\tmid = (last + first) / 2;\n\t\tbefs_debug(sb, \"first: %d, last: %d, mid: %d\", first, last,\n\t\t\t   mid);\n\t\tthiskey = befs_bt_get_key(sb, node, mid, &keylen);\n\t\teq = befs_compare_strings(thiskey, keylen, findkey,\n\t\t\t\t\t  findkey_len);\n\n\t\tif (eq == 0) {\n\t\t\tbefs_debug(sb, \"<--- %s found %s at %d\",\n\t\t\t\t   __func__, thiskey, mid);\n\n\t\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\t\t\treturn BEFS_BT_MATCH;\n\t\t}\n\t\tif (eq > 0)\n\t\t\tlast = mid - 1;\n\t\telse\n\t\t\tfirst = mid + 1;\n\t}\n\tif (eq < 0)\n\t\t*value = fs64_to_cpu(sb, valarray[mid + 1]);\n\telse\n\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\tbefs_debug(sb, \"<--- %s found %s at %d\", __func__, thiskey, mid);\n\treturn BEFS_BT_PARMATCH;\n}"
  },
  {
    "function_name": "befs_btree_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "249-318",
    "snippet": "int\nbefs_btree_find(struct super_block *sb, befs_data_stream * ds,\n\t\tconst char *key, befs_off_t * value)\n{\n\tstruct befs_btree_node *this_node = NULL;\n\tbefs_btree_super bt_super;\n\tbefs_off_t node_off;\n\tint res;\n\n\tbefs_debug(sb, \"---> %s Key: %s\", __func__, key);\n\n\tif (befs_bt_read_super(sb, ds, &bt_super) != BEFS_OK) {\n\t\tbefs_error(sb,\n\t\t\t   \"befs_btree_find() failed to read index superblock\");\n\t\tgoto error;\n\t}\n\n\tthis_node = kmalloc(sizeof(struct befs_btree_node),\n\t\t\t\t\t\tGFP_NOFS);\n\tif (!this_node) {\n\t\tbefs_error(sb, \"befs_btree_find() failed to allocate %zu \"\n\t\t\t   \"bytes of memory\", sizeof(struct befs_btree_node));\n\t\tgoto error;\n\t}\n\n\tthis_node->bh = NULL;\n\n\t/* read in root node */\n\tnode_off = bt_super.root_node_ptr;\n\tif (befs_bt_read_node(sb, ds, this_node, node_off) != BEFS_OK) {\n\t\tbefs_error(sb, \"befs_btree_find() failed to read \"\n\t\t\t   \"node at %llu\", node_off);\n\t\tgoto error_alloc;\n\t}\n\n\twhile (!befs_leafnode(this_node)) {\n\t\tres = befs_find_key(sb, this_node, key, &node_off);\n\t\tif (res == BEFS_BT_NOT_FOUND)\n\t\t\tnode_off = this_node->head.overflow;\n\t\t/* if no match, go to overflow node */\n\t\tif (befs_bt_read_node(sb, ds, this_node, node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"befs_btree_find() failed to read \"\n\t\t\t\t   \"node at %llu\", node_off);\n\t\t\tgoto error_alloc;\n\t\t}\n\t}\n\n\t/* at the correct leaf node now */\n\n\tres = befs_find_key(sb, this_node, key, value);\n\n\tbrelse(this_node->bh);\n\tkfree(this_node);\n\n\tif (res != BEFS_BT_MATCH) {\n\t\tbefs_debug(sb, \"<--- %s Key %s not found\", __func__, key);\n\t\t*value = 0;\n\t\treturn BEFS_BT_NOT_FOUND;\n\t}\n\tbefs_debug(sb, \"<--- %s Found key %s, value %llu\", __func__,\n\t\t   key, *value);\n\treturn BEFS_OK;\n\n      error_alloc:\n\tkfree(this_node);\n      error:\n\t*value = 0;\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
      "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);",
      "static int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s ERROR\"",
            "__func__"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "this_node"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "this_node"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "this_node->bh"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_find_key",
          "args": [
            "sb",
            "this_node",
            "key",
            "value"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "befs_find_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "338-396",
          "snippet": "static int\nbefs_find_key(struct super_block *sb, struct befs_btree_node *node,\n\t      const char *findkey, befs_off_t * value)\n{\n\tint first, last, mid;\n\tint eq;\n\tu16 keylen;\n\tint findkey_len;\n\tchar *thiskey;\n\tfs64 *valarray;\n\n\tbefs_debug(sb, \"---> %s %s\", __func__, findkey);\n\n\t*value = 0;\n\n\tfindkey_len = strlen(findkey);\n\n\t/* if node can not contain key, just skeep this node */\n\tlast = node->head.all_key_count - 1;\n\tthiskey = befs_bt_get_key(sb, node, last, &keylen);\n\n\teq = befs_compare_strings(thiskey, keylen, findkey, findkey_len);\n\tif (eq < 0) {\n\t\tbefs_debug(sb, \"<--- %s %s not found\", __func__, findkey);\n\t\treturn BEFS_BT_NOT_FOUND;\n\t}\n\n\tvalarray = befs_bt_valarray(node);\n\n\t/* simple binary search */\n\tfirst = 0;\n\tmid = 0;\n\twhile (last >= first) {\n\t\tmid = (last + first) / 2;\n\t\tbefs_debug(sb, \"first: %d, last: %d, mid: %d\", first, last,\n\t\t\t   mid);\n\t\tthiskey = befs_bt_get_key(sb, node, mid, &keylen);\n\t\teq = befs_compare_strings(thiskey, keylen, findkey,\n\t\t\t\t\t  findkey_len);\n\n\t\tif (eq == 0) {\n\t\t\tbefs_debug(sb, \"<--- %s found %s at %d\",\n\t\t\t\t   __func__, thiskey, mid);\n\n\t\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\t\t\treturn BEFS_BT_MATCH;\n\t\t}\n\t\tif (eq > 0)\n\t\t\tlast = mid - 1;\n\t\telse\n\t\t\tfirst = mid + 1;\n\t}\n\tif (eq < 0)\n\t\t*value = fs64_to_cpu(sb, valarray[mid + 1]);\n\telse\n\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\tbefs_debug(sb, \"<--- %s found %s at %d\", __func__, thiskey, mid);\n\treturn BEFS_BT_PARMATCH;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);",
            "static int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);",
            "static char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);\nstatic char *befs_bt_get_key(struct super_block *sb,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     int index, u16 * keylen);\n\nstatic int\nbefs_find_key(struct super_block *sb, struct befs_btree_node *node,\n\t      const char *findkey, befs_off_t * value)\n{\n\tint first, last, mid;\n\tint eq;\n\tu16 keylen;\n\tint findkey_len;\n\tchar *thiskey;\n\tfs64 *valarray;\n\n\tbefs_debug(sb, \"---> %s %s\", __func__, findkey);\n\n\t*value = 0;\n\n\tfindkey_len = strlen(findkey);\n\n\t/* if node can not contain key, just skeep this node */\n\tlast = node->head.all_key_count - 1;\n\tthiskey = befs_bt_get_key(sb, node, last, &keylen);\n\n\teq = befs_compare_strings(thiskey, keylen, findkey, findkey_len);\n\tif (eq < 0) {\n\t\tbefs_debug(sb, \"<--- %s %s not found\", __func__, findkey);\n\t\treturn BEFS_BT_NOT_FOUND;\n\t}\n\n\tvalarray = befs_bt_valarray(node);\n\n\t/* simple binary search */\n\tfirst = 0;\n\tmid = 0;\n\twhile (last >= first) {\n\t\tmid = (last + first) / 2;\n\t\tbefs_debug(sb, \"first: %d, last: %d, mid: %d\", first, last,\n\t\t\t   mid);\n\t\tthiskey = befs_bt_get_key(sb, node, mid, &keylen);\n\t\teq = befs_compare_strings(thiskey, keylen, findkey,\n\t\t\t\t\t  findkey_len);\n\n\t\tif (eq == 0) {\n\t\t\tbefs_debug(sb, \"<--- %s found %s at %d\",\n\t\t\t\t   __func__, thiskey, mid);\n\n\t\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\t\t\treturn BEFS_BT_MATCH;\n\t\t}\n\t\tif (eq > 0)\n\t\t\tlast = mid - 1;\n\t\telse\n\t\t\tfirst = mid + 1;\n\t}\n\tif (eq < 0)\n\t\t*value = fs64_to_cpu(sb, valarray[mid + 1]);\n\telse\n\t\t*value = fs64_to_cpu(sb, valarray[mid]);\n\tbefs_debug(sb, \"<--- %s found %s at %d\", __func__, thiskey, mid);\n\treturn BEFS_BT_PARMATCH;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"befs_btree_find() failed to read \"\n\t\t\t\t   \"node at %llu\"",
            "node_off"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_read_node",
          "args": [
            "sb",
            "ds",
            "this_node",
            "node_off"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_read_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "195-229",
          "snippet": "static int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
            "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_leafnode",
          "args": [
            "this_node"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "befs_leafnode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "607-615",
          "snippet": "static int\nbefs_leafnode(struct befs_btree_node *node)\n{\n\t/* all interior nodes (and only interior nodes) have an overflow node */\n\tif (node->head.overflow == befs_bt_inval)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;",
            "static int befs_leafnode(struct befs_btree_node *node);",
            "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
            "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
            "static char *befs_bt_keydata(struct befs_btree_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic const befs_off_t befs_bt_inval = 0xffffffffffffffffULL;\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_leafnode(struct befs_btree_node *node)\n{\n\t/* all interior nodes (and only interior nodes) have an overflow node */\n\tif (node->head.overflow == befs_bt_inval)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(struct befs_btree_node)",
            "GFP_NOFS"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_bt_read_super",
          "args": [
            "sb",
            "ds",
            "&bt_super"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "befs_bt_read_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
          "lines": "136-174",
          "snippet": "static int\nbefs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t   befs_btree_super * sup)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_disk_btree_super *od_sup = NULL;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tbh = befs_read_datastream(sb, ds, 0, NULL);\n\n\tif (!bh) {\n\t\tbefs_error(sb, \"Couldn't read index header.\");\n\t\tgoto error;\n\t}\n\tod_sup = (befs_disk_btree_super *) bh->b_data;\n\tbefs_dump_index_entry(sb, od_sup);\n\n\tsup->magic = fs32_to_cpu(sb, od_sup->magic);\n\tsup->node_size = fs32_to_cpu(sb, od_sup->node_size);\n\tsup->max_depth = fs32_to_cpu(sb, od_sup->max_depth);\n\tsup->data_type = fs32_to_cpu(sb, od_sup->data_type);\n\tsup->root_node_ptr = fs64_to_cpu(sb, od_sup->root_node_ptr);\n\tsup->free_node_ptr = fs64_to_cpu(sb, od_sup->free_node_ptr);\n\tsup->max_size = fs64_to_cpu(sb, od_sup->max_size);\n\n\tbrelse(bh);\n\tif (sup->magic != BEFS_BTREE_MAGIC) {\n\t\tbefs_error(sb, \"Index header has bad magic.\");\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
          "includes": [
            "#include \"datastream.h\"",
            "#include \"btree.h\"",
            "#include \"befs.h\"",
            "#include <linux/buffer_head.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t\t      befs_btree_super * sup);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t\t      befs_btree_super * sup);\n\nstatic int\nbefs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t   befs_btree_super * sup)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_disk_btree_super *od_sup = NULL;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tbh = befs_read_datastream(sb, ds, 0, NULL);\n\n\tif (!bh) {\n\t\tbefs_error(sb, \"Couldn't read index header.\");\n\t\tgoto error;\n\t}\n\tod_sup = (befs_disk_btree_super *) bh->b_data;\n\tbefs_dump_index_entry(sb, od_sup);\n\n\tsup->magic = fs32_to_cpu(sb, od_sup->magic);\n\tsup->node_size = fs32_to_cpu(sb, od_sup->node_size);\n\tsup->max_depth = fs32_to_cpu(sb, od_sup->max_depth);\n\tsup->data_type = fs32_to_cpu(sb, od_sup->data_type);\n\tsup->root_node_ptr = fs64_to_cpu(sb, od_sup->root_node_ptr);\n\tsup->free_node_ptr = fs64_to_cpu(sb, od_sup->free_node_ptr);\n\tsup->max_size = fs64_to_cpu(sb, od_sup->max_size);\n\n\tbrelse(bh);\n\tif (sup->magic != BEFS_BTREE_MAGIC) {\n\t\tbefs_error(sb, \"Index header has bad magic.\");\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\nstatic int befs_find_key(struct super_block *sb,\n\t\t\t struct befs_btree_node *node,\n\t\t\t const char *findkey, befs_off_t * value);\n\nint\nbefs_btree_find(struct super_block *sb, befs_data_stream * ds,\n\t\tconst char *key, befs_off_t * value)\n{\n\tstruct befs_btree_node *this_node = NULL;\n\tbefs_btree_super bt_super;\n\tbefs_off_t node_off;\n\tint res;\n\n\tbefs_debug(sb, \"---> %s Key: %s\", __func__, key);\n\n\tif (befs_bt_read_super(sb, ds, &bt_super) != BEFS_OK) {\n\t\tbefs_error(sb,\n\t\t\t   \"befs_btree_find() failed to read index superblock\");\n\t\tgoto error;\n\t}\n\n\tthis_node = kmalloc(sizeof(struct befs_btree_node),\n\t\t\t\t\t\tGFP_NOFS);\n\tif (!this_node) {\n\t\tbefs_error(sb, \"befs_btree_find() failed to allocate %zu \"\n\t\t\t   \"bytes of memory\", sizeof(struct befs_btree_node));\n\t\tgoto error;\n\t}\n\n\tthis_node->bh = NULL;\n\n\t/* read in root node */\n\tnode_off = bt_super.root_node_ptr;\n\tif (befs_bt_read_node(sb, ds, this_node, node_off) != BEFS_OK) {\n\t\tbefs_error(sb, \"befs_btree_find() failed to read \"\n\t\t\t   \"node at %llu\", node_off);\n\t\tgoto error_alloc;\n\t}\n\n\twhile (!befs_leafnode(this_node)) {\n\t\tres = befs_find_key(sb, this_node, key, &node_off);\n\t\tif (res == BEFS_BT_NOT_FOUND)\n\t\t\tnode_off = this_node->head.overflow;\n\t\t/* if no match, go to overflow node */\n\t\tif (befs_bt_read_node(sb, ds, this_node, node_off) != BEFS_OK) {\n\t\t\tbefs_error(sb, \"befs_btree_find() failed to read \"\n\t\t\t\t   \"node at %llu\", node_off);\n\t\t\tgoto error_alloc;\n\t\t}\n\t}\n\n\t/* at the correct leaf node now */\n\n\tres = befs_find_key(sb, this_node, key, value);\n\n\tbrelse(this_node->bh);\n\tkfree(this_node);\n\n\tif (res != BEFS_BT_MATCH) {\n\t\tbefs_debug(sb, \"<--- %s Key %s not found\", __func__, key);\n\t\t*value = 0;\n\t\treturn BEFS_BT_NOT_FOUND;\n\t}\n\tbefs_debug(sb, \"<--- %s Found key %s, value %llu\", __func__,\n\t\t   key, *value);\n\treturn BEFS_OK;\n\n      error_alloc:\n\tkfree(this_node);\n      error:\n\t*value = 0;\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
  },
  {
    "function_name": "befs_bt_read_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "195-229",
    "snippet": "static int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);",
      "static int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);",
      "static int befs_leafnode(struct befs_btree_node *node);",
      "static fs16 *befs_bt_keylen_index(struct befs_btree_node *node);",
      "static fs64 *befs_bt_valarray(struct befs_btree_node *node);",
      "static char *befs_bt_keydata(struct befs_btree_node *node);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s\"",
            "__func__"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sb",
            "node->od_node->all_key_length"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "50-57",
          "snippet": "static inline u16\nfs16_to_cpu(const struct super_block *sb, fs16 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u16\nfs16_to_cpu(const struct super_block *sb, fs16 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "node->od_node->overflow"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "14-21",
          "snippet": "static inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_dump_index_node",
          "args": [
            "sb",
            "node->od_node"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "befs_dump_index_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "243-258",
          "snippet": "void\nbefs_dump_index_node(const struct super_block *sb, befs_btree_nodehead * node)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tbefs_debug(sb, \"Btree node structure\");\n\tbefs_debug(sb, \"  left %016LX\", fs64_to_cpu(sb, node->left));\n\tbefs_debug(sb, \"  right %016LX\", fs64_to_cpu(sb, node->right));\n\tbefs_debug(sb, \"  overflow %016LX\", fs64_to_cpu(sb, node->overflow));\n\tbefs_debug(sb, \"  all_key_count %hu\",\n\t\t   fs16_to_cpu(sb, node->all_key_count));\n\tbefs_debug(sb, \"  all_key_length %hu\",\n\t\t   fs16_to_cpu(sb, node->all_key_length));\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_dump_index_node(const struct super_block *sb, befs_btree_nodehead * node)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tbefs_debug(sb, \"Btree node structure\");\n\tbefs_debug(sb, \"  left %016LX\", fs64_to_cpu(sb, node->left));\n\tbefs_debug(sb, \"  right %016LX\", fs64_to_cpu(sb, node->right));\n\tbefs_debug(sb, \"  overflow %016LX\", fs64_to_cpu(sb, node->overflow));\n\tbefs_debug(sb, \"  all_key_count %hu\",\n\t\t   fs16_to_cpu(sb, node->all_key_count));\n\tbefs_debug(sb, \"  all_key_length %hu\",\n\t\t   fs16_to_cpu(sb, node->all_key_length));\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"%s failed to read \"\n\t\t\t   \"node at %llu\"",
            "__func__",
            "node_off"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_read_datastream",
          "args": [
            "sb",
            "ds",
            "node_off",
            "&off"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "befs_read_datastream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/datastream.c",
          "lines": "47-76",
          "snippet": "struct buffer_head *\nbefs_read_datastream(struct super_block *sb, befs_data_stream * ds,\n\t\t     befs_off_t pos, uint * off)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_block_run run;\n\tbefs_blocknr_t block;\t/* block coresponding to pos */\n\n\tbefs_debug(sb, \"---> %s %llu\", __func__, pos);\n\tblock = pos >> BEFS_SB(sb)->block_shift;\n\tif (off)\n\t\t*off = pos - (block << BEFS_SB(sb)->block_shift);\n\n\tif (befs_fblock2brun(sb, ds, block, &run) != BEFS_OK) {\n\t\tbefs_error(sb, \"BeFS: Error finding disk addr of block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\t\treturn NULL;\n\t}\n\tbh = befs_bread_iaddr(sb, run);\n\tif (!bh) {\n\t\tbefs_error(sb, \"BeFS: Error reading block %lu from datastream\",\n\t\t\t   (unsigned long)block);\n\t\treturn NULL;\n\t}\n\n\tbefs_debug(sb, \"<--- %s read data, starting at %llu\", __func__, pos);\n\n\treturn bh;\n}",
          "includes": [
            "#include \"io.h\"",
            "#include \"datastream.h\"",
            "#include \"befs.h\"",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_find_brun_direct(struct super_block *sb,\n\t\t\t\t befs_data_stream * data,\n\t\t\t\t befs_blocknr_t blockno, befs_block_run * run);",
            "static int befs_find_brun_indirect(struct super_block *sb,\n\t\t\t\t   befs_data_stream * data,\n\t\t\t\t   befs_blocknr_t blockno,\n\t\t\t\t   befs_block_run * run);",
            "static int befs_find_brun_dblindirect(struct super_block *sb,\n\t\t\t\t      befs_data_stream * data,\n\t\t\t\t      befs_blocknr_t blockno,\n\t\t\t\t      befs_block_run * run);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"io.h\"\n#include \"datastream.h\"\n#include \"befs.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic int befs_find_brun_direct(struct super_block *sb,\n\t\t\t\t befs_data_stream * data,\n\t\t\t\t befs_blocknr_t blockno, befs_block_run * run);\nstatic int befs_find_brun_indirect(struct super_block *sb,\n\t\t\t\t   befs_data_stream * data,\n\t\t\t\t   befs_blocknr_t blockno,\n\t\t\t\t   befs_block_run * run);\nstatic int befs_find_brun_dblindirect(struct super_block *sb,\n\t\t\t\t      befs_data_stream * data,\n\t\t\t\t      befs_blocknr_t blockno,\n\t\t\t\t      befs_block_run * run);\n\nstruct buffer_head *\nbefs_read_datastream(struct super_block *sb, befs_data_stream * ds,\n\t\t     befs_off_t pos, uint * off)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_block_run run;\n\tbefs_blocknr_t block;\t/* block coresponding to pos */\n\n\tbefs_debug(sb, \"---> %s %llu\", __func__, pos);\n\tblock = pos >> BEFS_SB(sb)->block_shift;\n\tif (off)\n\t\t*off = pos - (block << BEFS_SB(sb)->block_shift);\n\n\tif (befs_fblock2brun(sb, ds, block, &run) != BEFS_OK) {\n\t\tbefs_error(sb, \"BeFS: Error finding disk addr of block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\t\treturn NULL;\n\t}\n\tbh = befs_bread_iaddr(sb, run);\n\tif (!bh) {\n\t\tbefs_error(sb, \"BeFS: Error reading block %lu from datastream\",\n\t\t\t   (unsigned long)block);\n\t\treturn NULL;\n\t}\n\n\tbefs_debug(sb, \"<--- %s read data, starting at %llu\", __func__, pos);\n\n\treturn bh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "node->bh"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_btree_seekleaf(struct super_block *sb, befs_data_stream * ds,\n\t\t\t       befs_btree_super * bt_super,\n\t\t\t       struct befs_btree_node *this_node,\n\t\t\t       befs_off_t * node_off);\nstatic int befs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t\t     struct befs_btree_node *node,\n\t\t\t     befs_off_t node_off);\nstatic int befs_leafnode(struct befs_btree_node *node);\nstatic fs16 *befs_bt_keylen_index(struct befs_btree_node *node);\nstatic fs64 *befs_bt_valarray(struct befs_btree_node *node);\nstatic char *befs_bt_keydata(struct befs_btree_node *node);\n\nstatic int\nbefs_bt_read_node(struct super_block *sb, befs_data_stream * ds,\n\t\t  struct befs_btree_node *node, befs_off_t node_off)\n{\n\tuint off = 0;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tif (node->bh)\n\t\tbrelse(node->bh);\n\n\tnode->bh = befs_read_datastream(sb, ds, node_off, &off);\n\tif (!node->bh) {\n\t\tbefs_error(sb, \"%s failed to read \"\n\t\t\t   \"node at %llu\", __func__, node_off);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\n\t\treturn BEFS_ERR;\n\t}\n\tnode->od_node =\n\t    (befs_btree_nodehead *) ((void *) node->bh->b_data + off);\n\n\tbefs_dump_index_node(sb, node->od_node);\n\n\tnode->head.left = fs64_to_cpu(sb, node->od_node->left);\n\tnode->head.right = fs64_to_cpu(sb, node->od_node->right);\n\tnode->head.overflow = fs64_to_cpu(sb, node->od_node->overflow);\n\tnode->head.all_key_count =\n\t    fs16_to_cpu(sb, node->od_node->all_key_count);\n\tnode->head.all_key_length =\n\t    fs16_to_cpu(sb, node->od_node->all_key_length);\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n}"
  },
  {
    "function_name": "befs_bt_read_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/btree.c",
    "lines": "136-174",
    "snippet": "static int\nbefs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t   befs_btree_super * sup)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_disk_btree_super *od_sup = NULL;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tbh = befs_read_datastream(sb, ds, 0, NULL);\n\n\tif (!bh) {\n\t\tbefs_error(sb, \"Couldn't read index header.\");\n\t\tgoto error;\n\t}\n\tod_sup = (befs_disk_btree_super *) bh->b_data;\n\tbefs_dump_index_entry(sb, od_sup);\n\n\tsup->magic = fs32_to_cpu(sb, od_sup->magic);\n\tsup->node_size = fs32_to_cpu(sb, od_sup->node_size);\n\tsup->max_depth = fs32_to_cpu(sb, od_sup->max_depth);\n\tsup->data_type = fs32_to_cpu(sb, od_sup->data_type);\n\tsup->root_node_ptr = fs64_to_cpu(sb, od_sup->root_node_ptr);\n\tsup->free_node_ptr = fs64_to_cpu(sb, od_sup->free_node_ptr);\n\tsup->max_size = fs64_to_cpu(sb, od_sup->max_size);\n\n\tbrelse(bh);\n\tif (sup->magic != BEFS_BTREE_MAGIC) {\n\t\tbefs_error(sb, \"Index header has bad magic.\");\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}",
    "includes": [
      "#include \"datastream.h\"",
      "#include \"btree.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int befs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t\t      befs_btree_super * sup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s ERROR\"",
            "__func__"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"Index header has bad magic.\""
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "od_sup->max_size"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "14-21",
          "snippet": "static inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u64\nfs64_to_cpu(const struct super_block *sb, fs64 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "od_sup->data_type"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/endian.h",
          "lines": "32-39",
          "snippet": "static inline u32\nfs32_to_cpu(const struct super_block *sb, fs32 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n\nstatic inline u32\nfs32_to_cpu(const struct super_block *sb, fs32 n)\n{\n\tif (BEFS_SB(sb)->byte_order == BEFS_BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_dump_index_entry",
          "args": [
            "sb",
            "od_sup"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "befs_dump_index_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "222-241",
          "snippet": "void\nbefs_dump_index_entry(const struct super_block *sb, befs_disk_btree_super * super)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tbefs_debug(sb, \"Btree super structure\");\n\tbefs_debug(sb, \"  magic %08x\", fs32_to_cpu(sb, super->magic));\n\tbefs_debug(sb, \"  node_size %u\", fs32_to_cpu(sb, super->node_size));\n\tbefs_debug(sb, \"  max_depth %08x\", fs32_to_cpu(sb, super->max_depth));\n\n\tbefs_debug(sb, \"  data_type %08x\", fs32_to_cpu(sb, super->data_type));\n\tbefs_debug(sb, \"  root_node_pointer %016LX\",\n\t\t   fs64_to_cpu(sb, super->root_node_ptr));\n\tbefs_debug(sb, \"  free_node_pointer %016LX\",\n\t\t   fs64_to_cpu(sb, super->free_node_ptr));\n\tbefs_debug(sb, \"  maximum size %016LX\",\n\t\t   fs64_to_cpu(sb, super->max_size));\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_dump_index_entry(const struct super_block *sb, befs_disk_btree_super * super)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tbefs_debug(sb, \"Btree super structure\");\n\tbefs_debug(sb, \"  magic %08x\", fs32_to_cpu(sb, super->magic));\n\tbefs_debug(sb, \"  node_size %u\", fs32_to_cpu(sb, super->node_size));\n\tbefs_debug(sb, \"  max_depth %08x\", fs32_to_cpu(sb, super->max_depth));\n\n\tbefs_debug(sb, \"  data_type %08x\", fs32_to_cpu(sb, super->data_type));\n\tbefs_debug(sb, \"  root_node_pointer %016LX\",\n\t\t   fs64_to_cpu(sb, super->root_node_ptr));\n\tbefs_debug(sb, \"  free_node_pointer %016LX\",\n\t\t   fs64_to_cpu(sb, super->free_node_ptr));\n\tbefs_debug(sb, \"  maximum size %016LX\",\n\t\t   fs64_to_cpu(sb, super->max_size));\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_read_datastream",
          "args": [
            "sb",
            "ds",
            "0",
            "NULL"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "befs_read_datastream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/datastream.c",
          "lines": "47-76",
          "snippet": "struct buffer_head *\nbefs_read_datastream(struct super_block *sb, befs_data_stream * ds,\n\t\t     befs_off_t pos, uint * off)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_block_run run;\n\tbefs_blocknr_t block;\t/* block coresponding to pos */\n\n\tbefs_debug(sb, \"---> %s %llu\", __func__, pos);\n\tblock = pos >> BEFS_SB(sb)->block_shift;\n\tif (off)\n\t\t*off = pos - (block << BEFS_SB(sb)->block_shift);\n\n\tif (befs_fblock2brun(sb, ds, block, &run) != BEFS_OK) {\n\t\tbefs_error(sb, \"BeFS: Error finding disk addr of block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\t\treturn NULL;\n\t}\n\tbh = befs_bread_iaddr(sb, run);\n\tif (!bh) {\n\t\tbefs_error(sb, \"BeFS: Error reading block %lu from datastream\",\n\t\t\t   (unsigned long)block);\n\t\treturn NULL;\n\t}\n\n\tbefs_debug(sb, \"<--- %s read data, starting at %llu\", __func__, pos);\n\n\treturn bh;\n}",
          "includes": [
            "#include \"io.h\"",
            "#include \"datastream.h\"",
            "#include \"befs.h\"",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int befs_find_brun_direct(struct super_block *sb,\n\t\t\t\t befs_data_stream * data,\n\t\t\t\t befs_blocknr_t blockno, befs_block_run * run);",
            "static int befs_find_brun_indirect(struct super_block *sb,\n\t\t\t\t   befs_data_stream * data,\n\t\t\t\t   befs_blocknr_t blockno,\n\t\t\t\t   befs_block_run * run);",
            "static int befs_find_brun_dblindirect(struct super_block *sb,\n\t\t\t\t      befs_data_stream * data,\n\t\t\t\t      befs_blocknr_t blockno,\n\t\t\t\t      befs_block_run * run);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"io.h\"\n#include \"datastream.h\"\n#include \"befs.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic int befs_find_brun_direct(struct super_block *sb,\n\t\t\t\t befs_data_stream * data,\n\t\t\t\t befs_blocknr_t blockno, befs_block_run * run);\nstatic int befs_find_brun_indirect(struct super_block *sb,\n\t\t\t\t   befs_data_stream * data,\n\t\t\t\t   befs_blocknr_t blockno,\n\t\t\t\t   befs_block_run * run);\nstatic int befs_find_brun_dblindirect(struct super_block *sb,\n\t\t\t\t      befs_data_stream * data,\n\t\t\t\t      befs_blocknr_t blockno,\n\t\t\t\t      befs_block_run * run);\n\nstruct buffer_head *\nbefs_read_datastream(struct super_block *sb, befs_data_stream * ds,\n\t\t     befs_off_t pos, uint * off)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_block_run run;\n\tbefs_blocknr_t block;\t/* block coresponding to pos */\n\n\tbefs_debug(sb, \"---> %s %llu\", __func__, pos);\n\tblock = pos >> BEFS_SB(sb)->block_shift;\n\tif (off)\n\t\t*off = pos - (block << BEFS_SB(sb)->block_shift);\n\n\tif (befs_fblock2brun(sb, ds, block, &run) != BEFS_OK) {\n\t\tbefs_error(sb, \"BeFS: Error finding disk addr of block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\t\treturn NULL;\n\t}\n\tbh = befs_bread_iaddr(sb, run);\n\tif (!bh) {\n\t\tbefs_error(sb, \"BeFS: Error reading block %lu from datastream\",\n\t\t\t   (unsigned long)block);\n\t\treturn NULL;\n\t}\n\n\tbefs_debug(sb, \"<--- %s read data, starting at %llu\", __func__, pos);\n\n\treturn bh;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"datastream.h\"\n#include \"btree.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int befs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t\t      befs_btree_super * sup);\n\nstatic int\nbefs_bt_read_super(struct super_block *sb, befs_data_stream * ds,\n\t\t   befs_btree_super * sup)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_disk_btree_super *od_sup = NULL;\n\n\tbefs_debug(sb, \"---> %s\", __func__);\n\n\tbh = befs_read_datastream(sb, ds, 0, NULL);\n\n\tif (!bh) {\n\t\tbefs_error(sb, \"Couldn't read index header.\");\n\t\tgoto error;\n\t}\n\tod_sup = (befs_disk_btree_super *) bh->b_data;\n\tbefs_dump_index_entry(sb, od_sup);\n\n\tsup->magic = fs32_to_cpu(sb, od_sup->magic);\n\tsup->node_size = fs32_to_cpu(sb, od_sup->node_size);\n\tsup->max_depth = fs32_to_cpu(sb, od_sup->max_depth);\n\tsup->data_type = fs32_to_cpu(sb, od_sup->data_type);\n\tsup->root_node_ptr = fs64_to_cpu(sb, od_sup->root_node_ptr);\n\tsup->free_node_ptr = fs64_to_cpu(sb, od_sup->free_node_ptr);\n\tsup->max_size = fs64_to_cpu(sb, od_sup->max_size);\n\n\tbrelse(bh);\n\tif (sup->magic != BEFS_BTREE_MAGIC) {\n\t\tbefs_error(sb, \"Index header has bad magic.\");\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn BEFS_OK;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn BEFS_ERR;\n}"
  }
]