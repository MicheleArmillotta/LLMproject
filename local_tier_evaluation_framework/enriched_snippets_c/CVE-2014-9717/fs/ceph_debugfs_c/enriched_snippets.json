[
  {
    "function_name": "ceph_fs_debugfs_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "317-319",
    "snippet": "void ceph_fs_debugfs_cleanup(struct ceph_fs_client *fsc)\n{\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nvoid ceph_fs_debugfs_cleanup(struct ceph_fs_client *fsc)\n{\n}"
  },
  {
    "function_name": "ceph_fs_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "312-315",
    "snippet": "int ceph_fs_debugfs_init(struct ceph_fs_client *fsc)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nint ceph_fs_debugfs_init(struct ceph_fs_client *fsc)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "ceph_fs_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "237-307",
    "snippet": "int ceph_fs_debugfs_init(struct ceph_fs_client *fsc)\n{\n\tchar name[100];\n\tint err = -ENOMEM;\n\n\tdout(\"ceph_fs_debugfs_init\\n\");\n\tBUG_ON(!fsc->client->debugfs_dir);\n\tfsc->debugfs_congestion_kb =\n\t\tdebugfs_create_file(\"writeback_congestion_kb\",\n\t\t\t\t    0600,\n\t\t\t\t    fsc->client->debugfs_dir,\n\t\t\t\t    fsc,\n\t\t\t\t    &congestion_kb_fops);\n\tif (!fsc->debugfs_congestion_kb)\n\t\tgoto out;\n\n\tsnprintf(name, sizeof(name), \"../../bdi/%s\",\n\t\t dev_name(fsc->backing_dev_info.dev));\n\tfsc->debugfs_bdi =\n\t\tdebugfs_create_symlink(\"bdi\",\n\t\t\t\t       fsc->client->debugfs_dir,\n\t\t\t\t       name);\n\tif (!fsc->debugfs_bdi)\n\t\tgoto out;\n\n\tfsc->debugfs_mdsmap = debugfs_create_file(\"mdsmap\",\n\t\t\t\t\t0600,\n\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\tfsc,\n\t\t\t\t\t&mdsmap_show_fops);\n\tif (!fsc->debugfs_mdsmap)\n\t\tgoto out;\n\n\tfsc->debugfs_mds_sessions = debugfs_create_file(\"mds_sessions\",\n\t\t\t\t\t0600,\n\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\tfsc,\n\t\t\t\t\t&mds_sessions_show_fops);\n\tif (!fsc->debugfs_mds_sessions)\n\t\tgoto out;\n\n\tfsc->debugfs_mdsc = debugfs_create_file(\"mdsc\",\n\t\t\t\t\t\t0600,\n\t\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\t\tfsc,\n\t\t\t\t\t\t&mdsc_show_fops);\n\tif (!fsc->debugfs_mdsc)\n\t\tgoto out;\n\n\tfsc->debugfs_caps = debugfs_create_file(\"caps\",\n\t\t\t\t\t\t   0400,\n\t\t\t\t\t\t   fsc->client->debugfs_dir,\n\t\t\t\t\t\t   fsc,\n\t\t\t\t\t\t   &caps_show_fops);\n\tif (!fsc->debugfs_caps)\n\t\tgoto out;\n\n\tfsc->debugfs_dentry_lru = debugfs_create_file(\"dentry_lru\",\n\t\t\t\t\t0600,\n\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\tfsc,\n\t\t\t\t\t&dentry_lru_show_fops);\n\tif (!fsc->debugfs_dentry_lru)\n\t\tgoto out;\n\n\treturn 0;\n\nout:\n\tceph_fs_debugfs_cleanup(fsc);\n\treturn err;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ceph_fs_debugfs_cleanup",
          "args": [
            "fsc"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_fs_debugfs_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
          "lines": "317-319",
          "snippet": "void ceph_fs_debugfs_cleanup(struct ceph_fs_client *fsc)\n{\n}",
          "includes": [
            "#include \"mds_client.h\"",
            "#include \"super.h\"",
            "#include <linux/ceph/debugfs.h>",
            "#include <linux/ceph/auth.h>",
            "#include <linux/ceph/mon_client.h>",
            "#include <linux/ceph/libceph.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/device.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nvoid ceph_fs_debugfs_cleanup(struct ceph_fs_client *fsc)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"dentry_lru\"",
            "0600",
            "fsc->client->debugfs_dir",
            "fsc",
            "&dentry_lru_show_fops"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_symlink",
          "args": [
            "\"bdi\"",
            "fsc->client->debugfs_dir",
            "name"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_symlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "490-515",
          "snippet": "struct dentry *debugfs_create_symlink(const char *name, struct dentry *parent,\n\t\t\t\t      const char *target)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\tchar *link = kstrdup(target, GFP_KERNEL);\n\tif (!link)\n\t\treturn NULL;\n\n\tdentry = start_creating(name, parent);\n\tif (IS_ERR(dentry)) {\n\t\tkfree(link);\n\t\treturn NULL;\n\t}\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode)) {\n\t\tkfree(link);\n\t\treturn failed_creating(dentry);\n\t}\n\tinode->i_mode = S_IFLNK | S_IRWXUGO;\n\tinode->i_op = &debugfs_link_operations;\n\tinode->i_private = link;\n\td_instantiate(dentry, inode);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_symlink(const char *name, struct dentry *parent,\n\t\t\t\t      const char *target)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\tchar *link = kstrdup(target, GFP_KERNEL);\n\tif (!link)\n\t\treturn NULL;\n\n\tdentry = start_creating(name, parent);\n\tif (IS_ERR(dentry)) {\n\t\tkfree(link);\n\t\treturn NULL;\n\t}\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode)) {\n\t\tkfree(link);\n\t\treturn failed_creating(dentry);\n\t}\n\tinode->i_mode = S_IFLNK | S_IRWXUGO;\n\tinode->i_op = &debugfs_link_operations;\n\tinode->i_private = link;\n\td_instantiate(dentry, inode);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "name",
            "sizeof(name)",
            "\"../../bdi/%s\"",
            "dev_name(fsc->backing_dev_info.dev)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_name",
          "args": [
            "fsc->backing_dev_info.dev"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!fsc->client->debugfs_dir"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dout",
          "args": [
            "\"ceph_fs_debugfs_init\\n\""
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nint ceph_fs_debugfs_init(struct ceph_fs_client *fsc)\n{\n\tchar name[100];\n\tint err = -ENOMEM;\n\n\tdout(\"ceph_fs_debugfs_init\\n\");\n\tBUG_ON(!fsc->client->debugfs_dir);\n\tfsc->debugfs_congestion_kb =\n\t\tdebugfs_create_file(\"writeback_congestion_kb\",\n\t\t\t\t    0600,\n\t\t\t\t    fsc->client->debugfs_dir,\n\t\t\t\t    fsc,\n\t\t\t\t    &congestion_kb_fops);\n\tif (!fsc->debugfs_congestion_kb)\n\t\tgoto out;\n\n\tsnprintf(name, sizeof(name), \"../../bdi/%s\",\n\t\t dev_name(fsc->backing_dev_info.dev));\n\tfsc->debugfs_bdi =\n\t\tdebugfs_create_symlink(\"bdi\",\n\t\t\t\t       fsc->client->debugfs_dir,\n\t\t\t\t       name);\n\tif (!fsc->debugfs_bdi)\n\t\tgoto out;\n\n\tfsc->debugfs_mdsmap = debugfs_create_file(\"mdsmap\",\n\t\t\t\t\t0600,\n\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\tfsc,\n\t\t\t\t\t&mdsmap_show_fops);\n\tif (!fsc->debugfs_mdsmap)\n\t\tgoto out;\n\n\tfsc->debugfs_mds_sessions = debugfs_create_file(\"mds_sessions\",\n\t\t\t\t\t0600,\n\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\tfsc,\n\t\t\t\t\t&mds_sessions_show_fops);\n\tif (!fsc->debugfs_mds_sessions)\n\t\tgoto out;\n\n\tfsc->debugfs_mdsc = debugfs_create_file(\"mdsc\",\n\t\t\t\t\t\t0600,\n\t\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\t\tfsc,\n\t\t\t\t\t\t&mdsc_show_fops);\n\tif (!fsc->debugfs_mdsc)\n\t\tgoto out;\n\n\tfsc->debugfs_caps = debugfs_create_file(\"caps\",\n\t\t\t\t\t\t   0400,\n\t\t\t\t\t\t   fsc->client->debugfs_dir,\n\t\t\t\t\t\t   fsc,\n\t\t\t\t\t\t   &caps_show_fops);\n\tif (!fsc->debugfs_caps)\n\t\tgoto out;\n\n\tfsc->debugfs_dentry_lru = debugfs_create_file(\"dentry_lru\",\n\t\t\t\t\t0600,\n\t\t\t\t\tfsc->client->debugfs_dir,\n\t\t\t\t\tfsc,\n\t\t\t\t\t&dentry_lru_show_fops);\n\tif (!fsc->debugfs_dentry_lru)\n\t\tgoto out;\n\n\treturn 0;\n\nout:\n\tceph_fs_debugfs_cleanup(fsc);\n\treturn err;\n}"
  },
  {
    "function_name": "ceph_fs_debugfs_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "225-235",
    "snippet": "void ceph_fs_debugfs_cleanup(struct ceph_fs_client *fsc)\n{\n\tdout(\"ceph_fs_debugfs_cleanup\\n\");\n\tdebugfs_remove(fsc->debugfs_bdi);\n\tdebugfs_remove(fsc->debugfs_congestion_kb);\n\tdebugfs_remove(fsc->debugfs_mdsmap);\n\tdebugfs_remove(fsc->debugfs_mds_sessions);\n\tdebugfs_remove(fsc->debugfs_caps);\n\tdebugfs_remove(fsc->debugfs_mdsc);\n\tdebugfs_remove(fsc->debugfs_dentry_lru);\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "fsc->debugfs_dentry_lru"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dout",
          "args": [
            "\"ceph_fs_debugfs_cleanup\\n\""
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nvoid ceph_fs_debugfs_cleanup(struct ceph_fs_client *fsc)\n{\n\tdout(\"ceph_fs_debugfs_cleanup\\n\");\n\tdebugfs_remove(fsc->debugfs_bdi);\n\tdebugfs_remove(fsc->debugfs_congestion_kb);\n\tdebugfs_remove(fsc->debugfs_mdsmap);\n\tdebugfs_remove(fsc->debugfs_mds_sessions);\n\tdebugfs_remove(fsc->debugfs_caps);\n\tdebugfs_remove(fsc->debugfs_mdsc);\n\tdebugfs_remove(fsc->debugfs_dentry_lru);\n}"
  },
  {
    "function_name": "congestion_kb_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "213-219",
    "snippet": "static int congestion_kb_get(void *data, u64 *val)\n{\n\tstruct ceph_fs_client *fsc = (struct ceph_fs_client *)data;\n\n\t*val = (u64)fsc->mount_options->congestion_kb;\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic int congestion_kb_get(void *data, u64 *val)\n{\n\tstruct ceph_fs_client *fsc = (struct ceph_fs_client *)data;\n\n\t*val = (u64)fsc->mount_options->congestion_kb;\n\treturn 0;\n}"
  },
  {
    "function_name": "CEPH_DEFINE_SHOW_FUNC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "195-211",
    "snippet": "CEPH_DEFINE_SHOW_FUNC(mdsmap_show)\nCEPH_DEFINE_SHOW_FUNC(mdsc_show)\nCEPH_DEFINE_SHOW_FUNC(caps_show)\nCEPH_DEFINE_SHOW_FUNC(dentry_lru_show)\nCEPH_DEFINE_SHOW_FUNC(mds_sessions_show)\n\n\n/*\n * debugfs\n */\nstatic int congestion_kb_set(void *data, u64 val)\n{\n\tstruct ceph_fs_client *fsc = (struct ceph_fs_client *)data;\n\n\tfsc->mount_options->congestion_kb = (int)val;\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "congestion_kb_set",
          "args": [
            "void *data",
            "u64val"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CEPH_DEFINE_SHOW_FUNC",
          "args": [
            "mds_sessions_show"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "CEPH_DEFINE_SHOW_FUNC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
          "lines": "195-211",
          "snippet": "CEPH_DEFINE_SHOW_FUNC(mdsmap_show)\nCEPH_DEFINE_SHOW_FUNC(mdsc_show)\nCEPH_DEFINE_SHOW_FUNC(caps_show)\nCEPH_DEFINE_SHOW_FUNC(dentry_lru_show)\nCEPH_DEFINE_SHOW_FUNC(mds_sessions_show)\n\n\n/*\n * debugfs\n */\nstatic int congestion_kb_set(void *data, u64 val)\n{\n\tstruct ceph_fs_client *fsc = (struct ceph_fs_client *)data;\n\n\tfsc->mount_options->congestion_kb = (int)val;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nCEPH_DEFINE_SHOW_FUNC(mdsmap_show)\nCEPH_DEFINE_SHOW_FUNC(mdsc_show)\nCEPH_DEFINE_SHOW_FUNC(caps_show)\nCEPH_DEFINE_SHOW_FUNC(dentry_lru_show)\nCEPH_DEFINE_SHOW_FUNC(mds_sessions_show)\n\n\n/*\n * debugfs\n */\nstatic int congestion_kb_set(void *data, u64 val)\n{\n\tstruct ceph_fs_client *fsc = (struct ceph_fs_client *)data;\n\n\tfsc->mount_options->congestion_kb = (int)val;\n\treturn 0;\n}"
  },
  {
    "function_name": "mds_sessions_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "159-193",
    "snippet": "static int mds_sessions_show(struct seq_file *s, void *ptr)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\tstruct ceph_auth_client *ac = fsc->client->monc.auth;\n\tstruct ceph_options *opt = fsc->client->options;\n\tint mds = -1;\n\n\tmutex_lock(&mdsc->mutex);\n\n\t/* The 'num' portion of an 'entity name' */\n\tseq_printf(s, \"global_id %llu\\n\", ac->global_id);\n\n\t/* The -o name mount argument */\n\tseq_printf(s, \"name \\\"%s\\\"\\n\", opt->name ? opt->name : \"\");\n\n\t/* The list of MDS session rank+state */\n\tfor (mds = 0; mds < mdsc->max_sessions; mds++) {\n\t\tstruct ceph_mds_session *session =\n\t\t\t__ceph_lookup_mds_session(mdsc, mds);\n\t\tif (!session) {\n\t\t\tcontinue;\n\t\t}\n\t\tmutex_unlock(&mdsc->mutex);\n\t\tseq_printf(s, \"mds.%d %s\\n\",\n\t\t\t\tsession->s_mds,\n\t\t\t\tceph_session_state_name(session->s_state));\n\n\t\tceph_put_mds_session(session);\n\t\tmutex_lock(&mdsc->mutex);\n\t}\n\tmutex_unlock(&mdsc->mutex);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&mdsc->mutex"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&mdsc->mutex"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ceph_put_mds_session",
          "args": [
            "session"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_put_mds_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/mds_client.c",
          "lines": "374-385",
          "snippet": "void ceph_put_mds_session(struct ceph_mds_session *s)\n{\n\tdout(\"mdsc put_session %p %d -> %d\\n\", s,\n\t     atomic_read(&s->s_ref), atomic_read(&s->s_ref)-1);\n\tif (atomic_dec_and_test(&s->s_ref)) {\n\t\tif (s->s_auth.authorizer)\n\t\t\tceph_auth_destroy_authorizer(\n\t\t\t\ts->s_mdsc->fsc->client->monc.auth,\n\t\t\t\ts->s_auth.authorizer);\n\t\tkfree(s);\n\t}\n}",
          "includes": [
            "#include <linux/ceph/debugfs.h>",
            "#include <linux/ceph/auth.h>",
            "#include <linux/ceph/pagelist.h>",
            "#include <linux/ceph/decode.h>",
            "#include <linux/ceph/messenger.h>",
            "#include <linux/ceph/ceph_features.h>",
            "#include \"mds_client.h\"",
            "#include \"super.h\"",
            "#include <linux/utsname.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/gfp.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/fs.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/pagelist.h>\n#include <linux/ceph/decode.h>\n#include <linux/ceph/messenger.h>\n#include <linux/ceph/ceph_features.h>\n#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/utsname.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/sched.h>\n#include <linux/gfp.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/fs.h>\n#include <linux/ceph/ceph_debug.h>\n\nvoid ceph_put_mds_session(struct ceph_mds_session *s)\n{\n\tdout(\"mdsc put_session %p %d -> %d\\n\", s,\n\t     atomic_read(&s->s_ref), atomic_read(&s->s_ref)-1);\n\tif (atomic_dec_and_test(&s->s_ref)) {\n\t\tif (s->s_auth.authorizer)\n\t\t\tceph_auth_destroy_authorizer(\n\t\t\t\ts->s_mdsc->fsc->client->monc.auth,\n\t\t\t\ts->s_auth.authorizer);\n\t\tkfree(s);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"mds.%d %s\\n\"",
            "session->s_mds",
            "ceph_session_state_name(session->s_state)"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ceph_session_state_name",
          "args": [
            "session->s_state"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_session_state_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/mds_client.c",
          "lines": "348-360",
          "snippet": "const char *ceph_session_state_name(int s)\n{\n\tswitch (s) {\n\tcase CEPH_MDS_SESSION_NEW: return \"new\";\n\tcase CEPH_MDS_SESSION_OPENING: return \"opening\";\n\tcase CEPH_MDS_SESSION_OPEN: return \"open\";\n\tcase CEPH_MDS_SESSION_HUNG: return \"hung\";\n\tcase CEPH_MDS_SESSION_CLOSING: return \"closing\";\n\tcase CEPH_MDS_SESSION_RESTARTING: return \"restarting\";\n\tcase CEPH_MDS_SESSION_RECONNECTING: return \"reconnecting\";\n\tdefault: return \"???\";\n\t}\n}",
          "includes": [
            "#include <linux/ceph/debugfs.h>",
            "#include <linux/ceph/auth.h>",
            "#include <linux/ceph/pagelist.h>",
            "#include <linux/ceph/decode.h>",
            "#include <linux/ceph/messenger.h>",
            "#include <linux/ceph/ceph_features.h>",
            "#include \"mds_client.h\"",
            "#include \"super.h\"",
            "#include <linux/utsname.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/gfp.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/fs.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/pagelist.h>\n#include <linux/ceph/decode.h>\n#include <linux/ceph/messenger.h>\n#include <linux/ceph/ceph_features.h>\n#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/utsname.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/sched.h>\n#include <linux/gfp.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/fs.h>\n#include <linux/ceph/ceph_debug.h>\n\nconst char *ceph_session_state_name(int s)\n{\n\tswitch (s) {\n\tcase CEPH_MDS_SESSION_NEW: return \"new\";\n\tcase CEPH_MDS_SESSION_OPENING: return \"opening\";\n\tcase CEPH_MDS_SESSION_OPEN: return \"open\";\n\tcase CEPH_MDS_SESSION_HUNG: return \"hung\";\n\tcase CEPH_MDS_SESSION_CLOSING: return \"closing\";\n\tcase CEPH_MDS_SESSION_RESTARTING: return \"restarting\";\n\tcase CEPH_MDS_SESSION_RECONNECTING: return \"reconnecting\";\n\tdefault: return \"???\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&mdsc->mutex"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__ceph_lookup_mds_session",
          "args": [
            "mdsc",
            "mds"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "__ceph_lookup_mds_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/mds_client.c",
          "lines": "390-402",
          "snippet": "struct ceph_mds_session *__ceph_lookup_mds_session(struct ceph_mds_client *mdsc,\n\t\t\t\t\t\t   int mds)\n{\n\tstruct ceph_mds_session *session;\n\n\tif (mds >= mdsc->max_sessions || mdsc->sessions[mds] == NULL)\n\t\treturn NULL;\n\tsession = mdsc->sessions[mds];\n\tdout(\"lookup_mds_session %p %d\\n\", session,\n\t     atomic_read(&session->s_ref));\n\tget_session(session);\n\treturn session;\n}",
          "includes": [
            "#include <linux/ceph/debugfs.h>",
            "#include <linux/ceph/auth.h>",
            "#include <linux/ceph/pagelist.h>",
            "#include <linux/ceph/decode.h>",
            "#include <linux/ceph/messenger.h>",
            "#include <linux/ceph/ceph_features.h>",
            "#include \"mds_client.h\"",
            "#include \"super.h\"",
            "#include <linux/utsname.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/gfp.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/fs.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/pagelist.h>\n#include <linux/ceph/decode.h>\n#include <linux/ceph/messenger.h>\n#include <linux/ceph/ceph_features.h>\n#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/utsname.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/sched.h>\n#include <linux/gfp.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/fs.h>\n#include <linux/ceph/ceph_debug.h>\n\nstruct ceph_mds_session *__ceph_lookup_mds_session(struct ceph_mds_client *mdsc,\n\t\t\t\t\t\t   int mds)\n{\n\tstruct ceph_mds_session *session;\n\n\tif (mds >= mdsc->max_sessions || mdsc->sessions[mds] == NULL)\n\t\treturn NULL;\n\tsession = mdsc->sessions[mds];\n\tdout(\"lookup_mds_session %p %d\\n\", session,\n\t     atomic_read(&session->s_ref));\n\tget_session(session);\n\treturn session;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&mdsc->mutex"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic int mds_sessions_show(struct seq_file *s, void *ptr)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\tstruct ceph_auth_client *ac = fsc->client->monc.auth;\n\tstruct ceph_options *opt = fsc->client->options;\n\tint mds = -1;\n\n\tmutex_lock(&mdsc->mutex);\n\n\t/* The 'num' portion of an 'entity name' */\n\tseq_printf(s, \"global_id %llu\\n\", ac->global_id);\n\n\t/* The -o name mount argument */\n\tseq_printf(s, \"name \\\"%s\\\"\\n\", opt->name ? opt->name : \"\");\n\n\t/* The list of MDS session rank+state */\n\tfor (mds = 0; mds < mdsc->max_sessions; mds++) {\n\t\tstruct ceph_mds_session *session =\n\t\t\t__ceph_lookup_mds_session(mdsc, mds);\n\t\tif (!session) {\n\t\t\tcontinue;\n\t\t}\n\t\tmutex_unlock(&mdsc->mutex);\n\t\tseq_printf(s, \"mds.%d %s\\n\",\n\t\t\t\tsession->s_mds,\n\t\t\t\tceph_session_state_name(session->s_state));\n\n\t\tceph_put_mds_session(session);\n\t\tmutex_lock(&mdsc->mutex);\n\t}\n\tmutex_unlock(&mdsc->mutex);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "dentry_lru_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "142-157",
    "snippet": "static int dentry_lru_show(struct seq_file *s, void *ptr)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\tstruct ceph_dentry_info *di;\n\n\tspin_lock(&mdsc->dentry_lru_lock);\n\tlist_for_each_entry(di, &mdsc->dentry_lru, lru) {\n\t\tstruct dentry *dentry = di->dentry;\n\t\tseq_printf(s, \"%p %p\\t%pd\\n\",\n\t\t\t   di, dentry, dentry);\n\t}\n\tspin_unlock(&mdsc->dentry_lru_lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&mdsc->dentry_lru_lock"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"%p %p\\t%pd\\n\"",
            "di",
            "dentry",
            "dentry"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "di",
            "&mdsc->dentry_lru",
            "lru"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&mdsc->dentry_lru_lock"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic int dentry_lru_show(struct seq_file *s, void *ptr)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\tstruct ceph_dentry_info *di;\n\n\tspin_lock(&mdsc->dentry_lru_lock);\n\tlist_for_each_entry(di, &mdsc->dentry_lru, lru) {\n\t\tstruct dentry *dentry = di->dentry;\n\t\tseq_printf(s, \"%p %p\\t%pd\\n\",\n\t\t\t   di, dentry, dentry);\n\t}\n\tspin_unlock(&mdsc->dentry_lru_lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "caps_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "127-140",
    "snippet": "static int caps_show(struct seq_file *s, void *p)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tint total, avail, used, reserved, min;\n\n\tceph_reservation_status(fsc, &total, &avail, &used, &reserved, &min);\n\tseq_printf(s, \"total\\t\\t%d\\n\"\n\t\t   \"avail\\t\\t%d\\n\"\n\t\t   \"used\\t\\t%d\\n\"\n\t\t   \"reserved\\t%d\\n\"\n\t\t   \"min\\t%d\\n\",\n\t\t   total, avail, used, reserved, min);\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"total\\t\\t%d\\n\"\n\t\t   \"avail\\t\\t%d\\n\"\n\t\t   \"used\\t\\t%d\\n\"\n\t\t   \"reserved\\t%d\\n\"\n\t\t   \"min\\t%d\\n\"",
            "total",
            "avail",
            "used",
            "reserved",
            "min"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ceph_reservation_status",
          "args": [
            "fsc",
            "&total",
            "&avail",
            "&used",
            "&reserved",
            "&min"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_reservation_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/caps.c",
          "lines": "287-303",
          "snippet": "void ceph_reservation_status(struct ceph_fs_client *fsc,\n\t\t\t     int *total, int *avail, int *used, int *reserved,\n\t\t\t     int *min)\n{\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\n\tif (total)\n\t\t*total = mdsc->caps_total_count;\n\tif (avail)\n\t\t*avail = mdsc->caps_avail_count;\n\tif (used)\n\t\t*used = mdsc->caps_use_count;\n\tif (reserved)\n\t\t*reserved = mdsc->caps_reserve_count;\n\tif (min)\n\t\t*min = mdsc->caps_min_count;\n}",
          "includes": [
            "#include <linux/ceph/messenger.h>",
            "#include <linux/ceph/decode.h>",
            "#include \"cache.h\"",
            "#include \"mds_client.h\"",
            "#include \"super.h\"",
            "#include <linux/writeback.h>",
            "#include <linux/wait.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/messenger.h>\n#include <linux/ceph/decode.h>\n#include \"cache.h\"\n#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/writeback.h>\n#include <linux/wait.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/ceph/ceph_debug.h>\n\nvoid ceph_reservation_status(struct ceph_fs_client *fsc,\n\t\t\t     int *total, int *avail, int *used, int *reserved,\n\t\t\t     int *min)\n{\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\n\tif (total)\n\t\t*total = mdsc->caps_total_count;\n\tif (avail)\n\t\t*avail = mdsc->caps_avail_count;\n\tif (used)\n\t\t*used = mdsc->caps_use_count;\n\tif (reserved)\n\t\t*reserved = mdsc->caps_reserve_count;\n\tif (min)\n\t\t*min = mdsc->caps_min_count;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic int caps_show(struct seq_file *s, void *p)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tint total, avail, used, reserved, min;\n\n\tceph_reservation_status(fsc, &total, &avail, &used, &reserved, &min);\n\tseq_printf(s, \"total\\t\\t%d\\n\"\n\t\t   \"avail\\t\\t%d\\n\"\n\t\t   \"used\\t\\t%d\\n\"\n\t\t   \"reserved\\t%d\\n\"\n\t\t   \"min\\t%d\\n\",\n\t\t   total, avail, used, reserved, min);\n\treturn 0;\n}"
  },
  {
    "function_name": "mdsc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "49-125",
    "snippet": "static int mdsc_show(struct seq_file *s, void *p)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\tstruct ceph_mds_request *req;\n\tstruct rb_node *rp;\n\tint pathlen;\n\tu64 pathbase;\n\tchar *path;\n\n\tmutex_lock(&mdsc->mutex);\n\tfor (rp = rb_first(&mdsc->request_tree); rp; rp = rb_next(rp)) {\n\t\treq = rb_entry(rp, struct ceph_mds_request, r_node);\n\n\t\tif (req->r_request && req->r_session)\n\t\t\tseq_printf(s, \"%lld\\tmds%d\\t\", req->r_tid,\n\t\t\t\t   req->r_session->s_mds);\n\t\telse if (!req->r_request)\n\t\t\tseq_printf(s, \"%lld\\t(no request)\\t\", req->r_tid);\n\t\telse\n\t\t\tseq_printf(s, \"%lld\\t(no session)\\t\", req->r_tid);\n\n\t\tseq_printf(s, \"%s\", ceph_mds_op_name(req->r_op));\n\n\t\tif (req->r_got_unsafe)\n\t\t\tseq_puts(s, \"\\t(unsafe)\");\n\t\telse\n\t\t\tseq_puts(s, \"\\t\");\n\n\t\tif (req->r_inode) {\n\t\t\tseq_printf(s, \" #%llx\", ceph_ino(req->r_inode));\n\t\t} else if (req->r_dentry) {\n\t\t\tpath = ceph_mdsc_build_path(req->r_dentry, &pathlen,\n\t\t\t\t\t\t    &pathbase, 0);\n\t\t\tif (IS_ERR(path))\n\t\t\t\tpath = NULL;\n\t\t\tspin_lock(&req->r_dentry->d_lock);\n\t\t\tseq_printf(s, \" #%llx/%pd (%s)\",\n\t\t\t\t   ceph_ino(req->r_dentry->d_parent->d_inode),\n\t\t\t\t   req->r_dentry,\n\t\t\t\t   path ? path : \"\");\n\t\t\tspin_unlock(&req->r_dentry->d_lock);\n\t\t\tkfree(path);\n\t\t} else if (req->r_path1) {\n\t\t\tseq_printf(s, \" #%llx/%s\", req->r_ino1.ino,\n\t\t\t\t   req->r_path1);\n\t\t} else {\n\t\t\tseq_printf(s, \" #%llx\", req->r_ino1.ino);\n\t\t}\n\n\t\tif (req->r_old_dentry) {\n\t\t\tpath = ceph_mdsc_build_path(req->r_old_dentry, &pathlen,\n\t\t\t\t\t\t    &pathbase, 0);\n\t\t\tif (IS_ERR(path))\n\t\t\t\tpath = NULL;\n\t\t\tspin_lock(&req->r_old_dentry->d_lock);\n\t\t\tseq_printf(s, \" #%llx/%pd (%s)\",\n\t\t\t\t   req->r_old_dentry_dir ?\n\t\t\t\t   ceph_ino(req->r_old_dentry_dir) : 0,\n\t\t\t\t   req->r_old_dentry,\n\t\t\t\t   path ? path : \"\");\n\t\t\tspin_unlock(&req->r_old_dentry->d_lock);\n\t\t\tkfree(path);\n\t\t} else if (req->r_path2) {\n\t\t\tif (req->r_ino2.ino)\n\t\t\t\tseq_printf(s, \" #%llx/%s\", req->r_ino2.ino,\n\t\t\t\t\t   req->r_path2);\n\t\t\telse\n\t\t\t\tseq_printf(s, \" %s\", req->r_path2);\n\t\t}\n\n\t\tseq_puts(s, \"\\n\");\n\t}\n\tmutex_unlock(&mdsc->mutex);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&mdsc->mutex"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "s",
            "\"\\n\""
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\" %s\"",
            "req->r_path2"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "path"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&req->r_old_dentry->d_lock"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ceph_ino",
          "args": [
            "req->r_old_dentry_dir"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_ino",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/super.h",
          "lines": "412-415",
          "snippet": "static inline u64 ceph_ino(struct inode *inode)\n{\n\treturn ceph_inode(inode)->i_vino.ino;\n}",
          "includes": [
            "#include <linux/fscache.h>",
            "#include <linux/ceph/libceph.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/wait.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/completion.h>",
            "#include <linux/backing-dev.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/ceph/libceph.h>\n#include <linux/posix_acl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/wait.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/fs.h>\n#include <linux/exportfs.h>\n#include <linux/completion.h>\n#include <linux/backing-dev.h>\n#include <asm/unaligned.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic inline u64 ceph_ino(struct inode *inode)\n{\n\treturn ceph_inode(inode)->i_vino.ino;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&req->r_old_dentry->d_lock"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "path"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ceph_mdsc_build_path",
          "args": [
            "req->r_old_dentry",
            "&pathlen",
            "&pathbase",
            "0"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_mdsc_build_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/mds_client.c",
          "lines": "1699-1778",
          "snippet": "char *ceph_mdsc_build_path(struct dentry *dentry, int *plen, u64 *base,\n\t\t\t   int stop_on_nosnap)\n{\n\tstruct dentry *temp;\n\tchar *path;\n\tint len, pos;\n\tunsigned seq;\n\n\tif (dentry == NULL)\n\t\treturn ERR_PTR(-EINVAL);\n\nretry:\n\tlen = 0;\n\tseq = read_seqbegin(&rename_lock);\n\trcu_read_lock();\n\tfor (temp = dentry; !IS_ROOT(temp);) {\n\t\tstruct inode *inode = temp->d_inode;\n\t\tif (inode && ceph_snap(inode) == CEPH_SNAPDIR)\n\t\t\tlen++;  /* slash only */\n\t\telse if (stop_on_nosnap && inode &&\n\t\t\t ceph_snap(inode) == CEPH_NOSNAP)\n\t\t\tbreak;\n\t\telse\n\t\t\tlen += 1 + temp->d_name.len;\n\t\ttemp = temp->d_parent;\n\t}\n\trcu_read_unlock();\n\tif (len)\n\t\tlen--;  /* no leading '/' */\n\n\tpath = kmalloc(len+1, GFP_NOFS);\n\tif (path == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\tpos = len;\n\tpath[pos] = 0;\t/* trailing null */\n\trcu_read_lock();\n\tfor (temp = dentry; !IS_ROOT(temp) && pos != 0; ) {\n\t\tstruct inode *inode;\n\n\t\tspin_lock(&temp->d_lock);\n\t\tinode = temp->d_inode;\n\t\tif (inode && ceph_snap(inode) == CEPH_SNAPDIR) {\n\t\t\tdout(\"build_path path+%d: %p SNAPDIR\\n\",\n\t\t\t     pos, temp);\n\t\t} else if (stop_on_nosnap && inode &&\n\t\t\t   ceph_snap(inode) == CEPH_NOSNAP) {\n\t\t\tspin_unlock(&temp->d_lock);\n\t\t\tbreak;\n\t\t} else {\n\t\t\tpos -= temp->d_name.len;\n\t\t\tif (pos < 0) {\n\t\t\t\tspin_unlock(&temp->d_lock);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tstrncpy(path + pos, temp->d_name.name,\n\t\t\t\ttemp->d_name.len);\n\t\t}\n\t\tspin_unlock(&temp->d_lock);\n\t\tif (pos)\n\t\t\tpath[--pos] = '/';\n\t\ttemp = temp->d_parent;\n\t}\n\trcu_read_unlock();\n\tif (pos != 0 || read_seqretry(&rename_lock, seq)) {\n\t\tpr_err(\"build_path did not end path lookup where \"\n\t\t       \"expected, namelen is %d, pos is %d\\n\", len, pos);\n\t\t/* presumably this is only possible if racing with a\n\t\t   rename of one of the parent directories (we can not\n\t\t   lock the dentries above us to prevent this, but\n\t\t   retrying should be harmless) */\n\t\tkfree(path);\n\t\tgoto retry;\n\t}\n\n\t*base = ceph_ino(temp->d_inode);\n\t*plen = len;\n\tdout(\"build_path on %p %d built %llx '%.*s'\\n\",\n\t     dentry, d_count(dentry), *base, len, path);\n\treturn path;\n}",
          "includes": [
            "#include <linux/ceph/debugfs.h>",
            "#include <linux/ceph/auth.h>",
            "#include <linux/ceph/pagelist.h>",
            "#include <linux/ceph/decode.h>",
            "#include <linux/ceph/messenger.h>",
            "#include <linux/ceph/ceph_features.h>",
            "#include \"mds_client.h\"",
            "#include \"super.h\"",
            "#include <linux/utsname.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/gfp.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/fs.h>",
            "#include <linux/ceph/ceph_debug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/pagelist.h>\n#include <linux/ceph/decode.h>\n#include <linux/ceph/messenger.h>\n#include <linux/ceph/ceph_features.h>\n#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/utsname.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/sched.h>\n#include <linux/gfp.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/fs.h>\n#include <linux/ceph/ceph_debug.h>\n\nchar *ceph_mdsc_build_path(struct dentry *dentry, int *plen, u64 *base,\n\t\t\t   int stop_on_nosnap)\n{\n\tstruct dentry *temp;\n\tchar *path;\n\tint len, pos;\n\tunsigned seq;\n\n\tif (dentry == NULL)\n\t\treturn ERR_PTR(-EINVAL);\n\nretry:\n\tlen = 0;\n\tseq = read_seqbegin(&rename_lock);\n\trcu_read_lock();\n\tfor (temp = dentry; !IS_ROOT(temp);) {\n\t\tstruct inode *inode = temp->d_inode;\n\t\tif (inode && ceph_snap(inode) == CEPH_SNAPDIR)\n\t\t\tlen++;  /* slash only */\n\t\telse if (stop_on_nosnap && inode &&\n\t\t\t ceph_snap(inode) == CEPH_NOSNAP)\n\t\t\tbreak;\n\t\telse\n\t\t\tlen += 1 + temp->d_name.len;\n\t\ttemp = temp->d_parent;\n\t}\n\trcu_read_unlock();\n\tif (len)\n\t\tlen--;  /* no leading '/' */\n\n\tpath = kmalloc(len+1, GFP_NOFS);\n\tif (path == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\tpos = len;\n\tpath[pos] = 0;\t/* trailing null */\n\trcu_read_lock();\n\tfor (temp = dentry; !IS_ROOT(temp) && pos != 0; ) {\n\t\tstruct inode *inode;\n\n\t\tspin_lock(&temp->d_lock);\n\t\tinode = temp->d_inode;\n\t\tif (inode && ceph_snap(inode) == CEPH_SNAPDIR) {\n\t\t\tdout(\"build_path path+%d: %p SNAPDIR\\n\",\n\t\t\t     pos, temp);\n\t\t} else if (stop_on_nosnap && inode &&\n\t\t\t   ceph_snap(inode) == CEPH_NOSNAP) {\n\t\t\tspin_unlock(&temp->d_lock);\n\t\t\tbreak;\n\t\t} else {\n\t\t\tpos -= temp->d_name.len;\n\t\t\tif (pos < 0) {\n\t\t\t\tspin_unlock(&temp->d_lock);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tstrncpy(path + pos, temp->d_name.name,\n\t\t\t\ttemp->d_name.len);\n\t\t}\n\t\tspin_unlock(&temp->d_lock);\n\t\tif (pos)\n\t\t\tpath[--pos] = '/';\n\t\ttemp = temp->d_parent;\n\t}\n\trcu_read_unlock();\n\tif (pos != 0 || read_seqretry(&rename_lock, seq)) {\n\t\tpr_err(\"build_path did not end path lookup where \"\n\t\t       \"expected, namelen is %d, pos is %d\\n\", len, pos);\n\t\t/* presumably this is only possible if racing with a\n\t\t   rename of one of the parent directories (we can not\n\t\t   lock the dentries above us to prevent this, but\n\t\t   retrying should be harmless) */\n\t\tkfree(path);\n\t\tgoto retry;\n\t}\n\n\t*base = ceph_ino(temp->d_inode);\n\t*plen = len;\n\tdout(\"build_path on %p %d built %llx '%.*s'\\n\",\n\t     dentry, d_count(dentry), *base, len, path);\n\treturn path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "path"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "path"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ceph_mds_op_name",
          "args": [
            "req->r_op"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_mds_op_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/strings.c",
          "lines": "50-82",
          "snippet": "const char *ceph_mds_op_name(int op)\n{\n\tswitch (op) {\n\tcase CEPH_MDS_OP_LOOKUP:  return \"lookup\";\n\tcase CEPH_MDS_OP_LOOKUPHASH:  return \"lookuphash\";\n\tcase CEPH_MDS_OP_LOOKUPPARENT:  return \"lookupparent\";\n\tcase CEPH_MDS_OP_LOOKUPINO:  return \"lookupino\";\n\tcase CEPH_MDS_OP_LOOKUPNAME:  return \"lookupname\";\n\tcase CEPH_MDS_OP_GETATTR:  return \"getattr\";\n\tcase CEPH_MDS_OP_SETXATTR: return \"setxattr\";\n\tcase CEPH_MDS_OP_SETATTR: return \"setattr\";\n\tcase CEPH_MDS_OP_RMXATTR: return \"rmxattr\";\n\tcase CEPH_MDS_OP_SETLAYOUT: return \"setlayou\";\n\tcase CEPH_MDS_OP_SETDIRLAYOUT: return \"setdirlayout\";\n\tcase CEPH_MDS_OP_READDIR: return \"readdir\";\n\tcase CEPH_MDS_OP_MKNOD: return \"mknod\";\n\tcase CEPH_MDS_OP_LINK: return \"link\";\n\tcase CEPH_MDS_OP_UNLINK: return \"unlink\";\n\tcase CEPH_MDS_OP_RENAME: return \"rename\";\n\tcase CEPH_MDS_OP_MKDIR: return \"mkdir\";\n\tcase CEPH_MDS_OP_RMDIR: return \"rmdir\";\n\tcase CEPH_MDS_OP_SYMLINK: return \"symlink\";\n\tcase CEPH_MDS_OP_CREATE: return \"create\";\n\tcase CEPH_MDS_OP_OPEN: return \"open\";\n\tcase CEPH_MDS_OP_LOOKUPSNAP: return \"lookupsnap\";\n\tcase CEPH_MDS_OP_LSSNAP: return \"lssnap\";\n\tcase CEPH_MDS_OP_MKSNAP: return \"mksnap\";\n\tcase CEPH_MDS_OP_RMSNAP: return \"rmsnap\";\n\tcase CEPH_MDS_OP_SETFILELOCK: return \"setfilelock\";\n\tcase CEPH_MDS_OP_GETFILELOCK: return \"getfilelock\";\n\t}\n\treturn \"???\";\n}",
          "includes": [
            "#include <linux/ceph/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/types.h>\n#include <linux/module.h>\n\nconst char *ceph_mds_op_name(int op)\n{\n\tswitch (op) {\n\tcase CEPH_MDS_OP_LOOKUP:  return \"lookup\";\n\tcase CEPH_MDS_OP_LOOKUPHASH:  return \"lookuphash\";\n\tcase CEPH_MDS_OP_LOOKUPPARENT:  return \"lookupparent\";\n\tcase CEPH_MDS_OP_LOOKUPINO:  return \"lookupino\";\n\tcase CEPH_MDS_OP_LOOKUPNAME:  return \"lookupname\";\n\tcase CEPH_MDS_OP_GETATTR:  return \"getattr\";\n\tcase CEPH_MDS_OP_SETXATTR: return \"setxattr\";\n\tcase CEPH_MDS_OP_SETATTR: return \"setattr\";\n\tcase CEPH_MDS_OP_RMXATTR: return \"rmxattr\";\n\tcase CEPH_MDS_OP_SETLAYOUT: return \"setlayou\";\n\tcase CEPH_MDS_OP_SETDIRLAYOUT: return \"setdirlayout\";\n\tcase CEPH_MDS_OP_READDIR: return \"readdir\";\n\tcase CEPH_MDS_OP_MKNOD: return \"mknod\";\n\tcase CEPH_MDS_OP_LINK: return \"link\";\n\tcase CEPH_MDS_OP_UNLINK: return \"unlink\";\n\tcase CEPH_MDS_OP_RENAME: return \"rename\";\n\tcase CEPH_MDS_OP_MKDIR: return \"mkdir\";\n\tcase CEPH_MDS_OP_RMDIR: return \"rmdir\";\n\tcase CEPH_MDS_OP_SYMLINK: return \"symlink\";\n\tcase CEPH_MDS_OP_CREATE: return \"create\";\n\tcase CEPH_MDS_OP_OPEN: return \"open\";\n\tcase CEPH_MDS_OP_LOOKUPSNAP: return \"lookupsnap\";\n\tcase CEPH_MDS_OP_LSSNAP: return \"lssnap\";\n\tcase CEPH_MDS_OP_MKSNAP: return \"mksnap\";\n\tcase CEPH_MDS_OP_RMSNAP: return \"rmsnap\";\n\tcase CEPH_MDS_OP_SETFILELOCK: return \"setfilelock\";\n\tcase CEPH_MDS_OP_GETFILELOCK: return \"getfilelock\";\n\t}\n\treturn \"???\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "rp",
            "structceph_mds_request",
            "r_node"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_next",
          "args": [
            "rp"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_first",
          "args": [
            "&mdsc->request_tree"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&mdsc->mutex"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic int mdsc_show(struct seq_file *s, void *p)\n{\n\tstruct ceph_fs_client *fsc = s->private;\n\tstruct ceph_mds_client *mdsc = fsc->mdsc;\n\tstruct ceph_mds_request *req;\n\tstruct rb_node *rp;\n\tint pathlen;\n\tu64 pathbase;\n\tchar *path;\n\n\tmutex_lock(&mdsc->mutex);\n\tfor (rp = rb_first(&mdsc->request_tree); rp; rp = rb_next(rp)) {\n\t\treq = rb_entry(rp, struct ceph_mds_request, r_node);\n\n\t\tif (req->r_request && req->r_session)\n\t\t\tseq_printf(s, \"%lld\\tmds%d\\t\", req->r_tid,\n\t\t\t\t   req->r_session->s_mds);\n\t\telse if (!req->r_request)\n\t\t\tseq_printf(s, \"%lld\\t(no request)\\t\", req->r_tid);\n\t\telse\n\t\t\tseq_printf(s, \"%lld\\t(no session)\\t\", req->r_tid);\n\n\t\tseq_printf(s, \"%s\", ceph_mds_op_name(req->r_op));\n\n\t\tif (req->r_got_unsafe)\n\t\t\tseq_puts(s, \"\\t(unsafe)\");\n\t\telse\n\t\t\tseq_puts(s, \"\\t\");\n\n\t\tif (req->r_inode) {\n\t\t\tseq_printf(s, \" #%llx\", ceph_ino(req->r_inode));\n\t\t} else if (req->r_dentry) {\n\t\t\tpath = ceph_mdsc_build_path(req->r_dentry, &pathlen,\n\t\t\t\t\t\t    &pathbase, 0);\n\t\t\tif (IS_ERR(path))\n\t\t\t\tpath = NULL;\n\t\t\tspin_lock(&req->r_dentry->d_lock);\n\t\t\tseq_printf(s, \" #%llx/%pd (%s)\",\n\t\t\t\t   ceph_ino(req->r_dentry->d_parent->d_inode),\n\t\t\t\t   req->r_dentry,\n\t\t\t\t   path ? path : \"\");\n\t\t\tspin_unlock(&req->r_dentry->d_lock);\n\t\t\tkfree(path);\n\t\t} else if (req->r_path1) {\n\t\t\tseq_printf(s, \" #%llx/%s\", req->r_ino1.ino,\n\t\t\t\t   req->r_path1);\n\t\t} else {\n\t\t\tseq_printf(s, \" #%llx\", req->r_ino1.ino);\n\t\t}\n\n\t\tif (req->r_old_dentry) {\n\t\t\tpath = ceph_mdsc_build_path(req->r_old_dentry, &pathlen,\n\t\t\t\t\t\t    &pathbase, 0);\n\t\t\tif (IS_ERR(path))\n\t\t\t\tpath = NULL;\n\t\t\tspin_lock(&req->r_old_dentry->d_lock);\n\t\t\tseq_printf(s, \" #%llx/%pd (%s)\",\n\t\t\t\t   req->r_old_dentry_dir ?\n\t\t\t\t   ceph_ino(req->r_old_dentry_dir) : 0,\n\t\t\t\t   req->r_old_dentry,\n\t\t\t\t   path ? path : \"\");\n\t\t\tspin_unlock(&req->r_old_dentry->d_lock);\n\t\t\tkfree(path);\n\t\t} else if (req->r_path2) {\n\t\t\tif (req->r_ino2.ino)\n\t\t\t\tseq_printf(s, \" #%llx/%s\", req->r_ino2.ino,\n\t\t\t\t\t   req->r_path2);\n\t\t\telse\n\t\t\t\tseq_printf(s, \" %s\", req->r_path2);\n\t\t}\n\n\t\tseq_puts(s, \"\\n\");\n\t}\n\tmutex_unlock(&mdsc->mutex);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "mdsmap_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/debugfs.c",
    "lines": "21-44",
    "snippet": "static int mdsmap_show(struct seq_file *s, void *p)\n{\n\tint i;\n\tstruct ceph_fs_client *fsc = s->private;\n\n\tif (fsc->mdsc == NULL || fsc->mdsc->mdsmap == NULL)\n\t\treturn 0;\n\tseq_printf(s, \"epoch %d\\n\", fsc->mdsc->mdsmap->m_epoch);\n\tseq_printf(s, \"root %d\\n\", fsc->mdsc->mdsmap->m_root);\n\tseq_printf(s, \"session_timeout %d\\n\",\n\t\t       fsc->mdsc->mdsmap->m_session_timeout);\n\tseq_printf(s, \"session_autoclose %d\\n\",\n\t\t       fsc->mdsc->mdsmap->m_session_autoclose);\n\tfor (i = 0; i < fsc->mdsc->mdsmap->m_max_mds; i++) {\n\t\tstruct ceph_entity_addr *addr =\n\t\t\t&fsc->mdsc->mdsmap->m_info[i].addr;\n\t\tint state = fsc->mdsc->mdsmap->m_info[i].state;\n\n\t\tseq_printf(s, \"\\tmds%d\\t%s\\t(%s)\\n\", i,\n\t\t\t       ceph_pr_addr(&addr->in_addr),\n\t\t\t       ceph_mds_state_name(state));\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"mds_client.h\"",
      "#include \"super.h\"",
      "#include <linux/ceph/debugfs.h>",
      "#include <linux/ceph/auth.h>",
      "#include <linux/ceph/mon_client.h>",
      "#include <linux/ceph/libceph.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/ctype.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/device.h>",
      "#include <linux/ceph/ceph_debug.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"\\tmds%d\\t%s\\t(%s)\\n\"",
            "i",
            "ceph_pr_addr(&addr->in_addr)",
            "ceph_mds_state_name(state)"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ceph_mds_state_name",
          "args": [
            "state"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "ceph_mds_state_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ceph/strings.c",
          "lines": "8-31",
          "snippet": "const char *ceph_mds_state_name(int s)\n{\n\tswitch (s) {\n\t\t/* down and out */\n\tcase CEPH_MDS_STATE_DNE:        return \"down:dne\";\n\tcase CEPH_MDS_STATE_STOPPED:    return \"down:stopped\";\n\t\t/* up and out */\n\tcase CEPH_MDS_STATE_BOOT:       return \"up:boot\";\n\tcase CEPH_MDS_STATE_STANDBY:    return \"up:standby\";\n\tcase CEPH_MDS_STATE_STANDBY_REPLAY:    return \"up:standby-replay\";\n\tcase CEPH_MDS_STATE_REPLAYONCE: return \"up:oneshot-replay\";\n\tcase CEPH_MDS_STATE_CREATING:   return \"up:creating\";\n\tcase CEPH_MDS_STATE_STARTING:   return \"up:starting\";\n\t\t/* up and in */\n\tcase CEPH_MDS_STATE_REPLAY:     return \"up:replay\";\n\tcase CEPH_MDS_STATE_RESOLVE:    return \"up:resolve\";\n\tcase CEPH_MDS_STATE_RECONNECT:  return \"up:reconnect\";\n\tcase CEPH_MDS_STATE_REJOIN:     return \"up:rejoin\";\n\tcase CEPH_MDS_STATE_CLIENTREPLAY: return \"up:clientreplay\";\n\tcase CEPH_MDS_STATE_ACTIVE:     return \"up:active\";\n\tcase CEPH_MDS_STATE_STOPPING:   return \"up:stopping\";\n\t}\n\treturn \"???\";\n}",
          "includes": [
            "#include <linux/ceph/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ceph/types.h>\n#include <linux/module.h>\n\nconst char *ceph_mds_state_name(int s)\n{\n\tswitch (s) {\n\t\t/* down and out */\n\tcase CEPH_MDS_STATE_DNE:        return \"down:dne\";\n\tcase CEPH_MDS_STATE_STOPPED:    return \"down:stopped\";\n\t\t/* up and out */\n\tcase CEPH_MDS_STATE_BOOT:       return \"up:boot\";\n\tcase CEPH_MDS_STATE_STANDBY:    return \"up:standby\";\n\tcase CEPH_MDS_STATE_STANDBY_REPLAY:    return \"up:standby-replay\";\n\tcase CEPH_MDS_STATE_REPLAYONCE: return \"up:oneshot-replay\";\n\tcase CEPH_MDS_STATE_CREATING:   return \"up:creating\";\n\tcase CEPH_MDS_STATE_STARTING:   return \"up:starting\";\n\t\t/* up and in */\n\tcase CEPH_MDS_STATE_REPLAY:     return \"up:replay\";\n\tcase CEPH_MDS_STATE_RESOLVE:    return \"up:resolve\";\n\tcase CEPH_MDS_STATE_RECONNECT:  return \"up:reconnect\";\n\tcase CEPH_MDS_STATE_REJOIN:     return \"up:rejoin\";\n\tcase CEPH_MDS_STATE_CLIENTREPLAY: return \"up:clientreplay\";\n\tcase CEPH_MDS_STATE_ACTIVE:     return \"up:active\";\n\tcase CEPH_MDS_STATE_STOPPING:   return \"up:stopping\";\n\t}\n\treturn \"???\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "ceph_pr_addr",
          "args": [
            "&addr->in_addr"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mds_client.h\"\n#include \"super.h\"\n#include <linux/ceph/debugfs.h>\n#include <linux/ceph/auth.h>\n#include <linux/ceph/mon_client.h>\n#include <linux/ceph/libceph.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/device.h>\n#include <linux/ceph/ceph_debug.h>\n\nstatic int mdsmap_show(struct seq_file *s, void *p)\n{\n\tint i;\n\tstruct ceph_fs_client *fsc = s->private;\n\n\tif (fsc->mdsc == NULL || fsc->mdsc->mdsmap == NULL)\n\t\treturn 0;\n\tseq_printf(s, \"epoch %d\\n\", fsc->mdsc->mdsmap->m_epoch);\n\tseq_printf(s, \"root %d\\n\", fsc->mdsc->mdsmap->m_root);\n\tseq_printf(s, \"session_timeout %d\\n\",\n\t\t       fsc->mdsc->mdsmap->m_session_timeout);\n\tseq_printf(s, \"session_autoclose %d\\n\",\n\t\t       fsc->mdsc->mdsmap->m_session_autoclose);\n\tfor (i = 0; i < fsc->mdsc->mdsmap->m_max_mds; i++) {\n\t\tstruct ceph_entity_addr *addr =\n\t\t\t&fsc->mdsc->mdsmap->m_info[i].addr;\n\t\tint state = fsc->mdsc->mdsmap->m_info[i].state;\n\n\t\tseq_printf(s, \"\\tmds%d\\t%s\\t(%s)\\n\", i,\n\t\t\t       ceph_pr_addr(&addr->in_addr),\n\t\t\t       ceph_mds_state_name(state));\n\t}\n\treturn 0;\n}"
  }
]