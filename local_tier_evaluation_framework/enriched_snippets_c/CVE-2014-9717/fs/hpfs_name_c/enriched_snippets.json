[
  {
    "function_name": "hpfs_adjust_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "106-113",
    "snippet": "void hpfs_adjust_length(const unsigned char *name, unsigned *len)\n{\n\tif (!*len) return;\n\tif (*len == 1 && name[0] == '.') return;\n\tif (*len == 2 && name[0] == '.' && name[1] == '.') return;\n\twhile (*len && (name[*len - 1] == '.' || name[*len - 1] == ' '))\n\t\t(*len)--;\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nvoid hpfs_adjust_length(const unsigned char *name, unsigned *len)\n{\n\tif (!*len) return;\n\tif (*len == 1 && name[0] == '.') return;\n\tif (*len == 2 && name[0] == '.' && name[1] == '.') return;\n\twhile (*len && (name[*len - 1] == '.' || name[*len - 1] == ' '))\n\t\t(*len)--;\n}"
  },
  {
    "function_name": "hpfs_is_name_long",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "92-102",
    "snippet": "int hpfs_is_name_long(const unsigned char *name, unsigned len)\n{\n\tint i,j;\n\tfor (i = 0; i < len && name[i] != '.'; i++)\n\t\tif (no_dos_char(name[i])) return 1;\n\tif (!i || i > 8) return 1;\n\tif (i == len) return 0;\n\tfor (j = i + 1; j < len; j++)\n\t\tif (name[j] == '.' || no_dos_char(name[i])) return 1;\n\treturn j - i > 4;\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "no_dos_char",
          "args": [
            "name[i]"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "no_dos_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "17-20",
          "snippet": "static inline int no_dos_char(unsigned char c)\n{\t/* Characters that are allowed in HPFS but not in DOS */\n\treturn c=='+' || c==',' || c==';' || c=='=' || c=='[' || c==']';\n}",
          "includes": [
            "#include \"hpfs_fn.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline int no_dos_char(unsigned char c)\n{\t/* Characters that are allowed in HPFS but not in DOS */\n\treturn c=='+' || c==',' || c==';' || c=='=' || c=='[' || c==']';\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nint hpfs_is_name_long(const unsigned char *name, unsigned len)\n{\n\tint i,j;\n\tfor (i = 0; i < len && name[i] != '.'; i++)\n\t\tif (no_dos_char(name[i])) return 1;\n\tif (!i || i > 8) return 1;\n\tif (i == len) return 0;\n\tfor (j = i + 1; j < len; j++)\n\t\tif (name[j] == '.' || no_dos_char(name[i])) return 1;\n\treturn j - i > 4;\n}"
  },
  {
    "function_name": "hpfs_compare_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "74-90",
    "snippet": "int hpfs_compare_names(struct super_block *s,\n\t\t       const unsigned char *n1, unsigned l1,\n\t\t       const unsigned char *n2, unsigned l2, int last)\n{\n\tunsigned l = l1 < l2 ? l1 : l2;\n\tunsigned i;\n\tif (last) return -1;\n\tfor (i = 0; i < l; i++) {\n\t\tunsigned char c1 = upcase(hpfs_sb(s)->sb_cp_table,n1[i]);\n\t\tunsigned char c2 = upcase(hpfs_sb(s)->sb_cp_table,n2[i]);\n\t\tif (c1 < c2) return -1;\n\t\tif (c1 > c2) return 1;\n\t}\n\tif (l1 < l2) return -1;\n\tif (l1 > l2) return 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "upcase",
          "args": [
            "hpfs_sb(s)->sb_cp_table",
            "n2[i]"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "hpfs_upcase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "29-32",
          "snippet": "unsigned char hpfs_upcase(unsigned char *dir, unsigned char a)\n{\n\treturn upcase(dir, a);\n}",
          "includes": [
            "#include \"hpfs_fn.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs_fn.h\"\n\nunsigned char hpfs_upcase(unsigned char *dir, unsigned char a)\n{\n\treturn upcase(dir, a);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hpfs_sb",
          "args": [
            "s"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "hpfs_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/hpfs_fn.h",
          "lines": "310-313",
          "snippet": "static inline struct hpfs_sb_info *hpfs_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hpfs.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int hpfs_check_free_dnodes(struct super_block *, int);",
            "void hpfs_prefetch_sectors(struct super_block *, unsigned, int);",
            "void hpfs_prefetch_bitmap(struct super_block *, unsigned);",
            "unsigned char *hpfs_translate_name(struct super_block *, unsigned char *, unsigned, int, int);",
            "int hpfs_compare_names(struct super_block *, const unsigned char *, unsigned,\n\t\t       const unsigned char *, unsigned, int);",
            "void hpfs_error(struct super_block *, const char *, ...);",
            "int hpfs_stop_cycles(struct super_block *, int, int *, int *, char *);",
            "unsigned hpfs_get_free_dnodes(struct super_block *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs.h\"\n#include <asm/unaligned.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/pagemap.h>\n#include <linux/mutex.h>\n\nint hpfs_check_free_dnodes(struct super_block *, int);\nvoid hpfs_prefetch_sectors(struct super_block *, unsigned, int);\nvoid hpfs_prefetch_bitmap(struct super_block *, unsigned);\nunsigned char *hpfs_translate_name(struct super_block *, unsigned char *, unsigned, int, int);\nint hpfs_compare_names(struct super_block *, const unsigned char *, unsigned,\n\t\t       const unsigned char *, unsigned, int);\nvoid hpfs_error(struct super_block *, const char *, ...);\nint hpfs_stop_cycles(struct super_block *, int, int *, int *, char *);\nunsigned hpfs_get_free_dnodes(struct super_block *);\n\nstatic inline struct hpfs_sb_info *hpfs_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nint hpfs_compare_names(struct super_block *s,\n\t\t       const unsigned char *n1, unsigned l1,\n\t\t       const unsigned char *n2, unsigned l2, int last)\n{\n\tunsigned l = l1 < l2 ? l1 : l2;\n\tunsigned i;\n\tif (last) return -1;\n\tfor (i = 0; i < l; i++) {\n\t\tunsigned char c1 = upcase(hpfs_sb(s)->sb_cp_table,n1[i]);\n\t\tunsigned char c2 = upcase(hpfs_sb(s)->sb_cp_table,n2[i]);\n\t\tif (c1 < c2) return -1;\n\t\tif (c1 > c2) return 1;\n\t}\n\tif (l1 < l2) return -1;\n\tif (l1 > l2) return 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "hpfs_translate_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "53-72",
    "snippet": "unsigned char *hpfs_translate_name(struct super_block *s, unsigned char *from,\n\t\t\t  unsigned len, int lc, int lng)\n{\n\tunsigned char *to;\n\tint i;\n\tif (hpfs_sb(s)->sb_chk >= 2) if (hpfs_is_name_long(from, len) != lng) {\n\t\tpr_err(\"Long name flag mismatch - name \");\n\t\tfor (i = 0; i < len; i++)\n\t\t\tpr_cont(\"%c\", from[i]);\n\t\tpr_cont(\" misidentified as %s.\\n\", lng ? \"short\" : \"long\");\n\t\tpr_err(\"It's nothing serious. It could happen because of bug in OS/2.\\nSet checks=normal to disable this message.\\n\");\n\t}\n\tif (!lc) return from;\n\tif (!(to = kmalloc(len, GFP_KERNEL))) {\n\t\tpr_err(\"can't allocate memory for name conversion buffer\\n\");\n\t\treturn from;\n\t}\n\tfor (i = 0; i < len; i++) to[i] = locase(hpfs_sb(s)->sb_cp_table,from[i]);\n\treturn to;\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "locase",
          "args": [
            "hpfs_sb(s)->sb_cp_table",
            "from[i]"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "locase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "34-39",
          "snippet": "static inline unsigned char locase(unsigned char *dir, unsigned char a)\n{\n\tif (a<128 || a==255) return a>='A' && a<='Z' ? a + 0x20 : a;\n\tif (!dir) return a;\n\treturn dir[a];\n}",
          "includes": [
            "#include \"hpfs_fn.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline unsigned char locase(unsigned char *dir, unsigned char a)\n{\n\tif (a<128 || a==255) return a>='A' && a<='Z' ? a + 0x20 : a;\n\tif (!dir) return a;\n\treturn dir[a];\n}"
        }
      },
      {
        "call_info": {
          "callee": "hpfs_sb",
          "args": [
            "s"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "hpfs_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/hpfs_fn.h",
          "lines": "310-313",
          "snippet": "static inline struct hpfs_sb_info *hpfs_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hpfs.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int hpfs_check_free_dnodes(struct super_block *, int);",
            "void hpfs_prefetch_sectors(struct super_block *, unsigned, int);",
            "void hpfs_prefetch_bitmap(struct super_block *, unsigned);",
            "unsigned char *hpfs_translate_name(struct super_block *, unsigned char *, unsigned, int, int);",
            "int hpfs_compare_names(struct super_block *, const unsigned char *, unsigned,\n\t\t       const unsigned char *, unsigned, int);",
            "void hpfs_error(struct super_block *, const char *, ...);",
            "int hpfs_stop_cycles(struct super_block *, int, int *, int *, char *);",
            "unsigned hpfs_get_free_dnodes(struct super_block *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs.h\"\n#include <asm/unaligned.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/pagemap.h>\n#include <linux/mutex.h>\n\nint hpfs_check_free_dnodes(struct super_block *, int);\nvoid hpfs_prefetch_sectors(struct super_block *, unsigned, int);\nvoid hpfs_prefetch_bitmap(struct super_block *, unsigned);\nunsigned char *hpfs_translate_name(struct super_block *, unsigned char *, unsigned, int, int);\nint hpfs_compare_names(struct super_block *, const unsigned char *, unsigned,\n\t\t       const unsigned char *, unsigned, int);\nvoid hpfs_error(struct super_block *, const char *, ...);\nint hpfs_stop_cycles(struct super_block *, int, int *, int *, char *);\nunsigned hpfs_get_free_dnodes(struct super_block *);\n\nstatic inline struct hpfs_sb_info *hpfs_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"can't allocate memory for name conversion buffer\\n\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "len",
            "GFP_KERNEL"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"It's nothing serious. It could happen because of bug in OS/2.\\nSet checks=normal to disable this message.\\n\""
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\" misidentified as %s.\\n\"",
            "lng ? \"short\" : \"long\""
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"%c\"",
            "from[i]"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Long name flag mismatch - name \""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hpfs_is_name_long",
          "args": [
            "from",
            "len"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "hpfs_is_name_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "92-102",
          "snippet": "int hpfs_is_name_long(const unsigned char *name, unsigned len)\n{\n\tint i,j;\n\tfor (i = 0; i < len && name[i] != '.'; i++)\n\t\tif (no_dos_char(name[i])) return 1;\n\tif (!i || i > 8) return 1;\n\tif (i == len) return 0;\n\tfor (j = i + 1; j < len; j++)\n\t\tif (name[j] == '.' || no_dos_char(name[i])) return 1;\n\treturn j - i > 4;\n}",
          "includes": [
            "#include \"hpfs_fn.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs_fn.h\"\n\nint hpfs_is_name_long(const unsigned char *name, unsigned len)\n{\n\tint i,j;\n\tfor (i = 0; i < len && name[i] != '.'; i++)\n\t\tif (no_dos_char(name[i])) return 1;\n\tif (!i || i > 8) return 1;\n\tif (i == len) return 0;\n\tfor (j = i + 1; j < len; j++)\n\t\tif (name[j] == '.' || no_dos_char(name[i])) return 1;\n\treturn j - i > 4;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nunsigned char *hpfs_translate_name(struct super_block *s, unsigned char *from,\n\t\t\t  unsigned len, int lc, int lng)\n{\n\tunsigned char *to;\n\tint i;\n\tif (hpfs_sb(s)->sb_chk >= 2) if (hpfs_is_name_long(from, len) != lng) {\n\t\tpr_err(\"Long name flag mismatch - name \");\n\t\tfor (i = 0; i < len; i++)\n\t\t\tpr_cont(\"%c\", from[i]);\n\t\tpr_cont(\" misidentified as %s.\\n\", lng ? \"short\" : \"long\");\n\t\tpr_err(\"It's nothing serious. It could happen because of bug in OS/2.\\nSet checks=normal to disable this message.\\n\");\n\t}\n\tif (!lc) return from;\n\tif (!(to = kmalloc(len, GFP_KERNEL))) {\n\t\tpr_err(\"can't allocate memory for name conversion buffer\\n\");\n\t\treturn from;\n\t}\n\tfor (i = 0; i < len; i++) to[i] = locase(hpfs_sb(s)->sb_cp_table,from[i]);\n\treturn to;\n}"
  },
  {
    "function_name": "hpfs_chk_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "41-51",
    "snippet": "int hpfs_chk_name(const unsigned char *name, unsigned *len)\n{\n\tint i;\n\tif (*len > 254) return -ENAMETOOLONG;\n\thpfs_adjust_length(name, len);\n\tif (!*len) return -EINVAL;\n\tfor (i = 0; i < *len; i++) if (not_allowed_char(name[i])) return -EINVAL;\n\tif (*len == 1) if (name[0] == '.') return -EINVAL;\n\tif (*len == 2) if (name[0] == '.' && name[1] == '.') return -EINVAL;\n\treturn 0;\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "not_allowed_char",
          "args": [
            "name[i]"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "not_allowed_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "11-15",
          "snippet": "static inline int not_allowed_char(unsigned char c)\n{\n\treturn c<' ' || c=='\"' || c=='*' || c=='/' || c==':' || c=='<' ||\n\t      c=='>' || c=='?' || c=='\\\\' || c=='|';\n}",
          "includes": [
            "#include \"hpfs_fn.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline int not_allowed_char(unsigned char c)\n{\n\treturn c<' ' || c=='\"' || c=='*' || c=='/' || c==':' || c=='<' ||\n\t      c=='>' || c=='?' || c=='\\\\' || c=='|';\n}"
        }
      },
      {
        "call_info": {
          "callee": "hpfs_adjust_length",
          "args": [
            "name",
            "len"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "hpfs_adjust_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "106-113",
          "snippet": "void hpfs_adjust_length(const unsigned char *name, unsigned *len)\n{\n\tif (!*len) return;\n\tif (*len == 1 && name[0] == '.') return;\n\tif (*len == 2 && name[0] == '.' && name[1] == '.') return;\n\twhile (*len && (name[*len - 1] == '.' || name[*len - 1] == ' '))\n\t\t(*len)--;\n}",
          "includes": [
            "#include \"hpfs_fn.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hpfs_fn.h\"\n\nvoid hpfs_adjust_length(const unsigned char *name, unsigned *len)\n{\n\tif (!*len) return;\n\tif (*len == 1 && name[0] == '.') return;\n\tif (*len == 2 && name[0] == '.' && name[1] == '.') return;\n\twhile (*len && (name[*len - 1] == '.' || name[*len - 1] == ' '))\n\t\t(*len)--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nint hpfs_chk_name(const unsigned char *name, unsigned *len)\n{\n\tint i;\n\tif (*len > 254) return -ENAMETOOLONG;\n\thpfs_adjust_length(name, len);\n\tif (!*len) return -EINVAL;\n\tfor (i = 0; i < *len; i++) if (not_allowed_char(name[i])) return -EINVAL;\n\tif (*len == 1) if (name[0] == '.') return -EINVAL;\n\tif (*len == 2) if (name[0] == '.' && name[1] == '.') return -EINVAL;\n\treturn 0;\n}"
  },
  {
    "function_name": "locase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "34-39",
    "snippet": "static inline unsigned char locase(unsigned char *dir, unsigned char a)\n{\n\tif (a<128 || a==255) return a>='A' && a<='Z' ? a + 0x20 : a;\n\tif (!dir) return a;\n\treturn dir[a];\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline unsigned char locase(unsigned char *dir, unsigned char a)\n{\n\tif (a<128 || a==255) return a>='A' && a<='Z' ? a + 0x20 : a;\n\tif (!dir) return a;\n\treturn dir[a];\n}"
  },
  {
    "function_name": "hpfs_upcase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "29-32",
    "snippet": "unsigned char hpfs_upcase(unsigned char *dir, unsigned char a)\n{\n\treturn upcase(dir, a);\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "upcase",
          "args": [
            "dir",
            "a"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "hpfs_upcase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
          "lines": "29-32",
          "snippet": "unsigned char hpfs_upcase(unsigned char *dir, unsigned char a)\n{\n\treturn upcase(dir, a);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nunsigned char hpfs_upcase(unsigned char *dir, unsigned char a)\n{\n\treturn upcase(dir, a);\n}"
  },
  {
    "function_name": "upcase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "22-27",
    "snippet": "static inline unsigned char upcase(unsigned char *dir, unsigned char a)\n{\n\tif (a<128 || a==255) return a>='a' && a<='z' ? a - 0x20 : a;\n\tif (!dir) return a;\n\treturn dir[a-128];\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline unsigned char upcase(unsigned char *dir, unsigned char a)\n{\n\tif (a<128 || a==255) return a>='a' && a<='z' ? a - 0x20 : a;\n\tif (!dir) return a;\n\treturn dir[a-128];\n}"
  },
  {
    "function_name": "no_dos_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "17-20",
    "snippet": "static inline int no_dos_char(unsigned char c)\n{\t/* Characters that are allowed in HPFS but not in DOS */\n\treturn c=='+' || c==',' || c==';' || c=='=' || c=='[' || c==']';\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline int no_dos_char(unsigned char c)\n{\t/* Characters that are allowed in HPFS but not in DOS */\n\treturn c=='+' || c==',' || c==';' || c=='=' || c=='[' || c==']';\n}"
  },
  {
    "function_name": "not_allowed_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hpfs/name.c",
    "lines": "11-15",
    "snippet": "static inline int not_allowed_char(unsigned char c)\n{\n\treturn c<' ' || c=='\"' || c=='*' || c=='/' || c==':' || c=='<' ||\n\t      c=='>' || c=='?' || c=='\\\\' || c=='|';\n}",
    "includes": [
      "#include \"hpfs_fn.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hpfs_fn.h\"\n\nstatic inline int not_allowed_char(unsigned char c)\n{\n\treturn c<' ' || c=='\"' || c=='*' || c=='/' || c==':' || c=='<' ||\n\t      c=='>' || c=='?' || c=='\\\\' || c=='|';\n}"
  }
]