[
  {
    "function_name": "fs2_dynrubin_exit(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "449-452",
    "snippet": "id jffs2_dynrubin_exit(void)\n{\n\tjffs2_unregister_compressor(&jffs2_dynrubin_comp);\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic struct jffs2_compressor jffs2_dynrubin_comp = {\n\t.priority = JFFS2_DYNRUBIN_PRIORITY,\n\t.name = \"dynrubin\",\n\t.compr = JFFS2_COMPR_RUBINMIPS,\n\t.compress = jffs2_dynrubin_compress,\n\t.decompress = &jffs2_dynrubin_decompress,\n#ifdef JFFS2_DYNRUBIN_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs2_unregister_compressor(&",
          "args": [
            "ffs2_dynrubin_comp);"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic struct jffs2_compressor jffs2_dynrubin_comp = {\n\t.priority = JFFS2_DYNRUBIN_PRIORITY,\n\t.name = \"dynrubin\",\n\t.compr = JFFS2_COMPR_RUBINMIPS,\n\t.compress = jffs2_dynrubin_compress,\n\t.decompress = &jffs2_dynrubin_decompress,\n#ifdef JFFS2_DYNRUBIN_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};\n\nid jffs2_dynrubin_exit(void)\n{\n\tjffs2_unregister_compressor(&jffs2_dynrubin_comp);\n}"
  },
  {
    "function_name": "fs2_dynrubin_init(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "444-447",
    "snippet": "t jffs2_dynrubin_init(void)\n{\n\treturn jffs2_register_compressor(&jffs2_dynrubin_comp);\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic struct jffs2_compressor jffs2_dynrubin_comp = {\n\t.priority = JFFS2_DYNRUBIN_PRIORITY,\n\t.name = \"dynrubin\",\n\t.compr = JFFS2_COMPR_RUBINMIPS,\n\t.compress = jffs2_dynrubin_compress,\n\t.decompress = &jffs2_dynrubin_decompress,\n#ifdef JFFS2_DYNRUBIN_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs2_register_compressor(&",
          "args": [
            "ffs2_dynrubin_comp);"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic struct jffs2_compressor jffs2_dynrubin_comp = {\n\t.priority = JFFS2_DYNRUBIN_PRIORITY,\n\t.name = \"dynrubin\",\n\t.compr = JFFS2_COMPR_RUBINMIPS,\n\t.compress = jffs2_dynrubin_compress,\n\t.decompress = &jffs2_dynrubin_decompress,\n#ifdef JFFS2_DYNRUBIN_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};\n\nt jffs2_dynrubin_init(void)\n{\n\treturn jffs2_register_compressor(&jffs2_dynrubin_comp);\n}"
  },
  {
    "function_name": "fs2_rubinmips_exit(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "426-429",
    "snippet": "id jffs2_rubinmips_exit(void)\n{\n\tjffs2_unregister_compressor(&jffs2_rubinmips_comp);\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic struct jffs2_compressor jffs2_rubinmips_comp = {\n\t.priority = JFFS2_RUBINMIPS_PRIORITY,\n\t.name = \"rubinmips\",\n\t.compr = JFFS2_COMPR_DYNRUBIN,\n\t.compress = NULL, /*&jffs2_rubinmips_compress,*/\n\t.decompress = &jffs2_rubinmips_decompress,\n#ifdef JFFS2_RUBINMIPS_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs2_unregister_compressor(&",
          "args": [
            "ffs2_rubinmips_comp);"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic struct jffs2_compressor jffs2_rubinmips_comp = {\n\t.priority = JFFS2_RUBINMIPS_PRIORITY,\n\t.name = \"rubinmips\",\n\t.compr = JFFS2_COMPR_DYNRUBIN,\n\t.compress = NULL, /*&jffs2_rubinmips_compress,*/\n\t.decompress = &jffs2_rubinmips_decompress,\n#ifdef JFFS2_RUBINMIPS_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};\n\nid jffs2_rubinmips_exit(void)\n{\n\tjffs2_unregister_compressor(&jffs2_rubinmips_comp);\n}"
  },
  {
    "function_name": "fs2_rubinmips_init(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "421-424",
    "snippet": "t jffs2_rubinmips_init(void)\n{\n\treturn jffs2_register_compressor(&jffs2_rubinmips_comp);\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic struct jffs2_compressor jffs2_rubinmips_comp = {\n\t.priority = JFFS2_RUBINMIPS_PRIORITY,\n\t.name = \"rubinmips\",\n\t.compr = JFFS2_COMPR_DYNRUBIN,\n\t.compress = NULL, /*&jffs2_rubinmips_compress,*/\n\t.decompress = &jffs2_rubinmips_decompress,\n#ifdef JFFS2_RUBINMIPS_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs2_register_compressor(&",
          "args": [
            "ffs2_rubinmips_comp);"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic struct jffs2_compressor jffs2_rubinmips_comp = {\n\t.priority = JFFS2_RUBINMIPS_PRIORITY,\n\t.name = \"rubinmips\",\n\t.compr = JFFS2_COMPR_DYNRUBIN,\n\t.compress = NULL, /*&jffs2_rubinmips_compress,*/\n\t.decompress = &jffs2_rubinmips_decompress,\n#ifdef JFFS2_RUBINMIPS_DISABLED\n\t.disabled = 1,\n#else\n\t.disabled = 0,\n#endif\n};\n\nt jffs2_rubinmips_init(void)\n{\n\treturn jffs2_register_compressor(&jffs2_rubinmips_comp);\n}"
  },
  {
    "function_name": "fs2_dynrubin_decompress(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "393-406",
    "snippet": "atic int jffs2_dynrubin_decompress(unsigned char *data_in,\n\t\t\t\t     unsigned char *cpage_out,\n\t\t\t\t     uint32_t sourcelen, uint32_t dstlen)\n{\n\tint bits[8];\n\tint c;\n\n\tfor (c=0; c<8; c++)\n\t\tbits[c] = data_in[c];\n\n\trubin_do_decompress(256, bits, data_in+8, cpage_out, sourcelen-8,\n\t\t\t    dstlen);\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bin_do_decompress(2",
          "args": [
            "6,",
            "ts,",
            "ta_in+8,",
            "age_out,",
            "urcelen-8,",
            "tlen);"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int jffs2_dynrubin_decompress(unsigned char *data_in,\n\t\t\t\t     unsigned char *cpage_out,\n\t\t\t\t     uint32_t sourcelen, uint32_t dstlen)\n{\n\tint bits[8];\n\tint c;\n\n\tfor (c=0; c<8; c++)\n\t\tbits[c] = data_in[c];\n\n\trubin_do_decompress(256, bits, data_in+8, cpage_out, sourcelen-8,\n\t\t\t    dstlen);\n\treturn 0;\n}"
  },
  {
    "function_name": "fs2_rubinmips_decompress(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "384-391",
    "snippet": "atic int jffs2_rubinmips_decompress(unsigned char *data_in,\n\t\t\t\t      unsigned char *cpage_out,\n\t\t\t\t      uint32_t sourcelen, uint32_t dstlen)\n{\n\trubin_do_decompress(BIT_DIVIDER_MIPS, bits_mips, data_in,\n\t\t\t    cpage_out, sourcelen, dstlen);\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic int bits_mips[8] = { 277, 249, 290, 267, 229, 341, 212, 241};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bin_do_decompress(B",
          "args": [
            "T_DIVIDER_MIPS,",
            "ts_mips,",
            "ta_in,",
            "age_out,",
            "urcelen,",
            "tlen);"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int bits_mips[8] = { 277, 249, 290, 267, 229, 341, 212, 241};\n\natic int jffs2_rubinmips_decompress(unsigned char *data_in,\n\t\t\t\t      unsigned char *cpage_out,\n\t\t\t\t      uint32_t sourcelen, uint32_t dstlen)\n{\n\trubin_do_decompress(BIT_DIVIDER_MIPS, bits_mips, data_in,\n\t\t\t    cpage_out, sourcelen, dstlen);\n\treturn 0;\n}"
  },
  {
    "function_name": "bin_do_decompress(i",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "368-381",
    "snippet": "atic void rubin_do_decompress(int bit_divider, int *bits,\n\t\t\t\tunsigned char *cdata_in, \n\t\t\t\tunsigned char *page_out, uint32_t srclen,\n\t\t\t\tuint32_t destlen)\n{\n\tint outpos = 0;\n\tstruct rubin_state rs;\n\n\tinit_pushpull(&rs.pp, cdata_in, srclen, 0, 0);\n\tinit_decode(&rs, bit_divider, bits);\n\n\twhile (outpos < destlen)\n\t\tpage_out[outpos++] = in_byte(&rs);\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_byte(&",
          "args": [
            "s);"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it_decode(&",
          "args": [
            "s,",
            "t_divider,",
            "ts);"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it_pushpull(&",
          "args": [
            "s.pp,",
            "ata_in,",
            "clen,",
            ";"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic void rubin_do_decompress(int bit_divider, int *bits,\n\t\t\t\tunsigned char *cdata_in, \n\t\t\t\tunsigned char *page_out, uint32_t srclen,\n\t\t\t\tuint32_t destlen)\n{\n\tint outpos = 0;\n\tstruct rubin_state rs;\n\n\tinit_pushpull(&rs.pp, cdata_in, srclen, 0, 0);\n\tinit_decode(&rs, bit_divider, bits);\n\n\twhile (outpos < destlen)\n\t\tpage_out[outpos++] = in_byte(&rs);\n}"
  },
  {
    "function_name": "fs2_dynrubin_compress(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "304-366",
    "snippet": "atic int jffs2_dynrubin_compress(unsigned char *data_in,\n\t\t\t\t   unsigned char *cpage_out,\n\t\t\t\t   uint32_t *sourcelen, uint32_t *dstlen)\n{\n\tint bits[8];\n\tunsigned char histo[256];\n\tint i;\n\tint ret;\n\tuint32_t mysrclen, mydstlen;\n\n\tmysrclen = *sourcelen;\n\tmydstlen = *dstlen - 8;\n\n\tif (*dstlen <= 12)\n\t\treturn -1;\n\n\tmemset(histo, 0, 256);\n\tfor (i=0; i<mysrclen; i++)\n\t\thisto[data_in[i]]++;\n\tmemset(bits, 0, sizeof(int)*8);\n\tfor (i=0; i<256; i++) {\n\t\tif (i&128)\n\t\t\tbits[7] += histo[i];\n\t\tif (i&64)\n\t\t\tbits[6] += histo[i];\n\t\tif (i&32)\n\t\t\tbits[5] += histo[i];\n\t\tif (i&16)\n\t\t\tbits[4] += histo[i];\n\t\tif (i&8)\n\t\t\tbits[3] += histo[i];\n\t\tif (i&4)\n\t\t\tbits[2] += histo[i];\n\t\tif (i&2)\n\t\t\tbits[1] += histo[i];\n\t\tif (i&1)\n\t\t\tbits[0] += histo[i];\n\t}\n\n\tfor (i=0; i<8; i++) {\n\t\tbits[i] = (bits[i] * 256) / mysrclen;\n\t\tif (!bits[i]) bits[i] = 1;\n\t\tif (bits[i] > 255) bits[i] = 255;\n\t\tcpage_out[i] = bits[i];\n\t}\n\n\tret = rubin_do_compress(256, bits, data_in, cpage_out+8, &mysrclen,\n\t\t\t\t&mydstlen);\n\tif (ret)\n\t\treturn ret;\n\n\t/* Add back the 8 bytes we took for the probabilities */\n\tmydstlen += 8;\n\n\tif (mysrclen <= mydstlen) {\n\t\t/* We compressed */\n\t\treturn -1;\n\t}\n\n\t*sourcelen = mysrclen;\n\t*dstlen = mydstlen;\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bin_do_compress(2",
          "args": [
            "6,",
            "ts,",
            "ta_in,",
            "age_out+8,",
            "ysrclen,",
            "ydstlen);"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mset(b",
          "args": [
            "ts,",
            "zeof(int)*8);"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mset(h",
          "args": [
            "sto,",
            "6);"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int jffs2_dynrubin_compress(unsigned char *data_in,\n\t\t\t\t   unsigned char *cpage_out,\n\t\t\t\t   uint32_t *sourcelen, uint32_t *dstlen)\n{\n\tint bits[8];\n\tunsigned char histo[256];\n\tint i;\n\tint ret;\n\tuint32_t mysrclen, mydstlen;\n\n\tmysrclen = *sourcelen;\n\tmydstlen = *dstlen - 8;\n\n\tif (*dstlen <= 12)\n\t\treturn -1;\n\n\tmemset(histo, 0, 256);\n\tfor (i=0; i<mysrclen; i++)\n\t\thisto[data_in[i]]++;\n\tmemset(bits, 0, sizeof(int)*8);\n\tfor (i=0; i<256; i++) {\n\t\tif (i&128)\n\t\t\tbits[7] += histo[i];\n\t\tif (i&64)\n\t\t\tbits[6] += histo[i];\n\t\tif (i&32)\n\t\t\tbits[5] += histo[i];\n\t\tif (i&16)\n\t\t\tbits[4] += histo[i];\n\t\tif (i&8)\n\t\t\tbits[3] += histo[i];\n\t\tif (i&4)\n\t\t\tbits[2] += histo[i];\n\t\tif (i&2)\n\t\t\tbits[1] += histo[i];\n\t\tif (i&1)\n\t\t\tbits[0] += histo[i];\n\t}\n\n\tfor (i=0; i<8; i++) {\n\t\tbits[i] = (bits[i] * 256) / mysrclen;\n\t\tif (!bits[i]) bits[i] = 1;\n\t\tif (bits[i] > 255) bits[i] = 255;\n\t\tcpage_out[i] = bits[i];\n\t}\n\n\tret = rubin_do_compress(256, bits, data_in, cpage_out+8, &mysrclen,\n\t\t\t\t&mydstlen);\n\tif (ret)\n\t\treturn ret;\n\n\t/* Add back the 8 bytes we took for the probabilities */\n\tmydstlen += 8;\n\n\tif (mysrclen <= mydstlen) {\n\t\t/* We compressed */\n\t\treturn -1;\n\t}\n\n\t*sourcelen = mysrclen;\n\t*dstlen = mydstlen;\n\treturn 0;\n}"
  },
  {
    "function_name": "fs2_rubinmips_compress(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "297-302",
    "snippet": "t jffs2_rubinmips_compress(unsigned char *data_in, unsigned char *cpage_out,\n\t\t   uint32_t *sourcelen, uint32_t *dstlen)\n{\n\treturn rubin_do_compress(BIT_DIVIDER_MIPS, bits_mips, data_in,\n\t\t\t\t cpage_out, sourcelen, dstlen);\n}\n#",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic int bits_mips[8] = { 277, 249, 290, 267, 229, 341, 212, 241};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bin_do_compress(B",
          "args": [
            "T_DIVIDER_MIPS,",
            "ts_mips,",
            "ta_in,",
            "age_out,",
            "urcelen,",
            "tlen);"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int bits_mips[8] = { 277, 249, 290, 267, 229, 341, 212, 241};\n\nt jffs2_rubinmips_compress(unsigned char *data_in, unsigned char *cpage_out,\n\t\t   uint32_t *sourcelen, uint32_t *dstlen)\n{\n\treturn rubin_do_compress(BIT_DIVIDER_MIPS, bits_mips, data_in,\n\t\t\t\t cpage_out, sourcelen, dstlen);\n}\n#"
  },
  {
    "function_name": "bin_do_compress(i",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "262-294",
    "snippet": "atic int rubin_do_compress(int bit_divider, int *bits, unsigned char *data_in,\n\t\t\t     unsigned char *cpage_out, uint32_t *sourcelen,\n\t\t\t     uint32_t *dstlen)\n\t{\n\tint outpos = 0;\n\tint pos=0;\n\tstruct rubin_state rs;\n\n\tinit_pushpull(&rs.pp, cpage_out, *dstlen * 8, 0, 32);\n\n\tinit_rubin(&rs, bit_divider, bits);\n\n\twhile (pos < (*sourcelen) && !out_byte(&rs, data_in[pos]))\n\t\tpos++;\n\n\tend_rubin(&rs);\n\n\tif (outpos > pos) {\n\t\t/* We failed */\n\t\treturn -1;\n\t}\n\n\t/* Tell the caller how much we managed to compress,\n\t * and how much space it took */\n\n\toutpos = (pushedbits(&rs.pp)+7)/8;\n\n\tif (outpos >= pos)\n\t\treturn -1; /* We didn't actually compress */\n\t*sourcelen = pos;\n\t*dstlen = outpos;\n\treturn 0;\n}\n#",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shedbits(&",
          "args": [
            "s.pp)+"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_rubin(&",
          "args": [
            "s);"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t_byte(&",
          "args": [
            "s,",
            "ta_in[pos]))"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it_rubin(&",
          "args": [
            "s,",
            "t_divider,",
            "ts);"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it_pushpull(&",
          "args": [
            "s.pp,",
            "age_out,",
            "stlen * 8,",
            ");"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int rubin_do_compress(int bit_divider, int *bits, unsigned char *data_in,\n\t\t\t     unsigned char *cpage_out, uint32_t *sourcelen,\n\t\t\t     uint32_t *dstlen)\n\t{\n\tint outpos = 0;\n\tint pos=0;\n\tstruct rubin_state rs;\n\n\tinit_pushpull(&rs.pp, cpage_out, *dstlen * 8, 0, 32);\n\n\tinit_rubin(&rs, bit_divider, bits);\n\n\twhile (pos < (*sourcelen) && !out_byte(&rs, data_in[pos]))\n\t\tpos++;\n\n\tend_rubin(&rs);\n\n\tif (outpos > pos) {\n\t\t/* We failed */\n\t\treturn -1;\n\t}\n\n\t/* Tell the caller how much we managed to compress,\n\t * and how much space it took */\n\n\toutpos = (pushedbits(&rs.pp)+7)/8;\n\n\tif (outpos >= pos)\n\t\treturn -1; /* We didn't actually compress */\n\t*sourcelen = pos;\n\t*dstlen = outpos;\n\treturn 0;\n}\n#"
  },
  {
    "function_name": "_byte(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "249-258",
    "snippet": "atic int in_byte(struct rubin_state *rs)\n{\n\tint i, result = 0, bit_divider = rs->bit_divider;\n\n\tfor (i = 0; i < 8; i++)\n\t\tresult |= decode(rs, bit_divider - rs->bits[i],\n\t\t\t\t rs->bits[i]) << i;\n\n\treturn result;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "code(r",
          "args": [
            ",",
            "t_divider - rs->bits[i],",
            "->bits[i])"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int in_byte(struct rubin_state *rs)\n{\n\tint i, result = 0, bit_divider = rs->bit_divider;\n\n\tfor (i = 0; i < 8; i++)\n\t\tresult |= decode(rs, bit_divider - rs->bits[i],\n\t\t\t\t rs->bits[i]) << i;\n\n\treturn result;\n}"
  },
  {
    "function_name": "t_byte(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "230-247",
    "snippet": "atic int out_byte(struct rubin_state *rs, unsigned char byte)\n{\n\tint i, ret;\n\tstruct rubin_state rs_copy;\n\trs_copy = *rs;\n\n\tfor (i=0; i<8; i++) {\n\t\tret = encode(rs, rs->bit_divider-rs->bits[i],\n\t\t\t     rs->bits[i], byte & 1);\n\t\tif (ret) {\n\t\t\t/* Failed. Restore old state */\n\t\t\t*rs = rs_copy;\n\t\t\treturn ret;\n\t\t}\n\t\tbyte >>= 1 ;\n\t}\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "code(r",
          "args": [
            ",",
            "->bit_divider-rs->bits[i],",
            "->bits[i],",
            "te & 1);"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int out_byte(struct rubin_state *rs, unsigned char byte)\n{\n\tint i, ret;\n\tstruct rubin_state rs_copy;\n\trs_copy = *rs;\n\n\tfor (i=0; i<8; i++) {\n\t\tret = encode(rs, rs->bit_divider-rs->bits[i],\n\t\t\t     rs->bits[i], byte & 1);\n\t\tif (ret) {\n\t\t\t/* Failed. Restore old state */\n\t\t\t*rs = rs_copy;\n\t\t\treturn ret;\n\t\t}\n\t\tbyte >>= 1 ;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "code(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "200-226",
    "snippet": "atic int decode(struct rubin_state *rs, long A, long B)\n{\n\tunsigned long p = rs->p, q = rs->q;\n\tlong i0, threshold;\n\tint symbol;\n\n\tif (q >= UPPER_BIT_RUBIN || ((p + q) <= UPPER_BIT_RUBIN))\n\t\t__do_decode(rs, p, q);\n\n\ti0 = A * rs->p / (A + B);\n\tif (i0 <= 0)\n\t\ti0 = 1;\n\n\tif (i0 >= rs->p)\n\t\ti0 = rs->p - 1;\n\n\tthreshold = rs->q + i0;\n\tsymbol = rs->rec_q >= threshold;\n\tif (rs->rec_q >= threshold) {\n\t\trs->q += i0;\n\t\ti0 = rs->p - i0;\n\t}\n\n\trs->p = i0;\n\n\treturn symbol;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_decode(r",
          "args": [
            ",",
            ";"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int decode(struct rubin_state *rs, long A, long B)\n{\n\tunsigned long p = rs->p, q = rs->q;\n\tlong i0, threshold;\n\tint symbol;\n\n\tif (q >= UPPER_BIT_RUBIN || ((p + q) <= UPPER_BIT_RUBIN))\n\t\t__do_decode(rs, p, q);\n\n\ti0 = A * rs->p / (A + B);\n\tif (i0 <= 0)\n\t\ti0 = 1;\n\n\tif (i0 >= rs->p)\n\t\ti0 = rs->p - 1;\n\n\tthreshold = rs->q + i0;\n\tsymbol = rs->rec_q >= threshold;\n\tif (rs->rec_q >= threshold) {\n\t\trs->q += i0;\n\t\ti0 = rs->p - i0;\n\t}\n\n\trs->p = i0;\n\n\treturn symbol;\n}"
  },
  {
    "function_name": "do_decode(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "163-198",
    "snippet": "atic void __do_decode(struct rubin_state *rs, unsigned long p,\n\t\t\tunsigned long q)\n{\n\tregister unsigned long lower_bits_rubin = LOWER_BITS_RUBIN;\n\tunsigned long rec_q;\n\tint c, bits = 0;\n\n\t/*\n\t * First, work out how many bits we need from the input stream.\n\t * Note that we have already done the initial check on this\n\t * loop prior to calling this function.\n\t */\n\tdo {\n\t\tbits++;\n\t\tq &= lower_bits_rubin;\n\t\tq <<= 1;\n\t\tp <<= 1;\n\t} while ((q >= UPPER_BIT_RUBIN) || ((p + q) <= UPPER_BIT_RUBIN));\n\n\trs->p = p;\n\trs->q = q;\n\n\trs->bit_number += bits;\n\n\t/*\n\t * Now get the bits.  We really want this to be \"get n bits\".\n\t */\n\trec_q = rs->rec_q;\n\tdo {\n\t\tc = pullbit(&rs->pp);\n\t\trec_q &= lower_bits_rubin;\n\t\trec_q <<= 1;\n\t\trec_q += c;\n\t} while (--bits);\n\trs->rec_q = rec_q;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "llbit(&",
          "args": [
            "s->pp);"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic void __do_decode(struct rubin_state *rs, unsigned long p,\n\t\t\tunsigned long q)\n{\n\tregister unsigned long lower_bits_rubin = LOWER_BITS_RUBIN;\n\tunsigned long rec_q;\n\tint c, bits = 0;\n\n\t/*\n\t * First, work out how many bits we need from the input stream.\n\t * Note that we have already done the initial check on this\n\t * loop prior to calling this function.\n\t */\n\tdo {\n\t\tbits++;\n\t\tq &= lower_bits_rubin;\n\t\tq <<= 1;\n\t\tp <<= 1;\n\t} while ((q >= UPPER_BIT_RUBIN) || ((p + q) <= UPPER_BIT_RUBIN));\n\n\trs->p = p;\n\trs->q = q;\n\n\trs->bit_number += bits;\n\n\t/*\n\t * Now get the bits.  We really want this to be \"get n bits\".\n\t */\n\trec_q = rs->rec_q;\n\tdo {\n\t\tc = pullbit(&rs->pp);\n\t\trec_q &= lower_bits_rubin;\n\t\trec_q <<= 1;\n\t\trec_q += c;\n\t} while (--bits);\n\trs->rec_q = rec_q;\n}"
  },
  {
    "function_name": "it_decode(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "151-161",
    "snippet": "atic void init_decode(struct rubin_state *rs, int div, int *bits)\n{\n\tinit_rubin(rs, div, bits);\n\n\t/* behalve lower */\n\trs->rec_q = 0;\n\n\tfor (rs->bit_number = 0; rs->bit_number++ < RUBIN_REG_SIZE;\n\t     rs->rec_q = rs->rec_q * 2 + (long) (pullbit(&rs->pp)))\n\t\t;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "llbit(&",
          "args": [
            "s->pp))"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it_rubin(r",
          "args": [
            ",",
            "v,",
            "ts);"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic void init_decode(struct rubin_state *rs, int div, int *bits)\n{\n\tinit_rubin(rs, div, bits);\n\n\t/* behalve lower */\n\trs->rec_q = 0;\n\n\tfor (rs->bit_number = 0; rs->bit_number++ < RUBIN_REG_SIZE;\n\t     rs->rec_q = rs->rec_q * 2 + (long) (pullbit(&rs->pp)))\n\t\t;\n}"
  },
  {
    "function_name": "d_rubin(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "138-148",
    "snippet": "atic void end_rubin(struct rubin_state *rs)\n{\n\n\tint i;\n\n\tfor (i = 0; i < RUBIN_REG_SIZE; i++) {\n\t\tpushbit(&rs->pp, (UPPER_BIT_RUBIN & rs->q) ? 1 : 0, 1);\n\t\trs->q &= LOWER_BITS_RUBIN;\n\t\trs->q <<= 1;\n\t}\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shbit(&",
          "args": [
            "s->pp,",
            "PPER_BIT_RUBIN & rs->q) ? 1 : 0,",
            ";"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic void end_rubin(struct rubin_state *rs)\n{\n\n\tint i;\n\n\tfor (i = 0; i < RUBIN_REG_SIZE; i++) {\n\t\tpushbit(&rs->pp, (UPPER_BIT_RUBIN & rs->q) ? 1 : 0, 1);\n\t\trs->q &= LOWER_BITS_RUBIN;\n\t\trs->q <<= 1;\n\t}\n}"
  },
  {
    "function_name": "code(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "102-135",
    "snippet": "atic int encode(struct rubin_state *rs, long A, long B, int symbol)\n{\n\n\tlong i0, i1;\n\tint ret;\n\n\twhile ((rs->q >= UPPER_BIT_RUBIN) ||\n\t       ((rs->p + rs->q) <= UPPER_BIT_RUBIN)) {\n\t\trs->bit_number++;\n\n\t\tret = pushbit(&rs->pp, (rs->q & UPPER_BIT_RUBIN) ? 1 : 0, 0);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\trs->q &= LOWER_BITS_RUBIN;\n\t\trs->q <<= 1;\n\t\trs->p <<= 1;\n\t}\n\ti0 = A * rs->p / (A + B);\n\tif (i0 <= 0)\n\t\ti0 = 1;\n\n\tif (i0 >= rs->p)\n\t\ti0 = rs->p - 1;\n\n\ti1 = rs->p - i0;\n\n\tif (symbol == 0)\n\t\trs->p = i0;\n\telse {\n\t\trs->p = i1;\n\t\trs->q += i0;\n\t}\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shbit(&",
          "args": [
            "s->pp,",
            "s->q & UPPER_BIT_RUBIN) ? 1 : 0,",
            ";"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic int encode(struct rubin_state *rs, long A, long B, int symbol)\n{\n\n\tlong i0, i1;\n\tint ret;\n\n\twhile ((rs->q >= UPPER_BIT_RUBIN) ||\n\t       ((rs->p + rs->q) <= UPPER_BIT_RUBIN)) {\n\t\trs->bit_number++;\n\n\t\tret = pushbit(&rs->pp, (rs->q & UPPER_BIT_RUBIN) ? 1 : 0, 0);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\trs->q &= LOWER_BITS_RUBIN;\n\t\trs->q <<= 1;\n\t\trs->p <<= 1;\n\t}\n\ti0 = A * rs->p / (A + B);\n\tif (i0 <= 0)\n\t\ti0 = 1;\n\n\tif (i0 >= rs->p)\n\t\ti0 = rs->p - 1;\n\n\ti1 = rs->p - i0;\n\n\tif (symbol == 0)\n\t\trs->p = i0;\n\telse {\n\t\trs->p = i1;\n\t\trs->q += i0;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "it_rubin(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "88-99",
    "snippet": "atic void init_rubin(struct rubin_state *rs, int div, int *bits)\n{\n\tint c;\n\n\trs->q = 0;\n\trs->p = (long) (2 * UPPER_BIT_RUBIN);\n\trs->bit_number = (long) 0;\n\trs->bit_divider = div;\n\n\tfor (c=0; c<8; c++)\n\t\trs->bits[c] = bits[c];\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic void init_rubin(struct rubin_state *rs, int div, int *bits)\n{\n\tint c;\n\n\trs->q = 0;\n\trs->p = (long) (2 * UPPER_BIT_RUBIN);\n\trs->bit_number = (long) 0;\n\trs->bit_divider = div;\n\n\tfor (c=0; c<8; c++)\n\t\trs->bits[c] = bits[c];\n}"
  },
  {
    "function_name": "llbit(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "77-85",
    "snippet": "atic inline int pullbit(struct pushpull *pp)\n{\n\tint bit;\n\n\tbit = (pp->buf[pp->ofs >> 3] >> (7-(pp->ofs & 7))) & 1;\n\n\tpp->ofs++;\n\treturn bit;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic inline int pullbit(struct pushpull *pp)\n{\n\tint bit;\n\n\tbit = (pp->buf[pp->ofs >> 3] >> (7-(pp->ofs & 7))) & 1;\n\n\tpp->ofs++;\n\treturn bit;\n}"
  },
  {
    "function_name": "shedbits(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "72-75",
    "snippet": "atic inline int pushedbits(struct pushpull *pp)\n{\n\treturn pp->ofs;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic inline int pushedbits(struct pushpull *pp)\n{\n\treturn pp->ofs;\n}"
  },
  {
    "function_name": "shbit(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "57-70",
    "snippet": "atic inline int pushbit(struct pushpull *pp, int bit, int use_reserved)\n{\n\tif (pp->ofs >= pp->buflen - (use_reserved?0:pp->reserve))\n\t\treturn -ENOSPC;\n\n\tif (bit)\n\t\tpp->buf[pp->ofs >> 3] |= (1<<(7-(pp->ofs & 7)));\n\telse\n\t\tpp->buf[pp->ofs >> 3] &= ~(1<<(7-(pp->ofs & 7)));\n\n\tpp->ofs++;\n\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic inline int pushbit(struct pushpull *pp, int bit, int use_reserved)\n{\n\tif (pp->ofs >= pp->buflen - (use_reserved?0:pp->reserve))\n\t\treturn -ENOSPC;\n\n\tif (bit)\n\t\tpp->buf[pp->ofs >> 3] |= (1<<(7-(pp->ofs & 7)));\n\telse\n\t\tpp->buf[pp->ofs >> 3] &= ~(1<<(7-(pp->ofs & 7)));\n\n\tpp->ofs++;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "it_pushpull(s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rubin.c",
    "lines": "47-55",
    "snippet": "atic inline void init_pushpull(struct pushpull *pp, char *buf,\n\t\t\t\t unsigned buflen, unsigned ofs,\n\t\t\t\t unsigned reserve)\n{\n\tpp->buf = buf;\n\tpp->buflen = buflen;\n\tpp->ofs = ofs;\n\tpp->reserve = reserve;\n}",
    "includes": [
      "nclude \"compr.h\"",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/string.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"compr.h\"\nnclude <linux/errno.h>\n#i\nnclude <linux/jffs2.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/string.h>\n#i\n\natic inline void init_pushpull(struct pushpull *pp, char *buf,\n\t\t\t\t unsigned buflen, unsigned ofs,\n\t\t\t\t unsigned reserve)\n{\n\tpp->buf = buf;\n\tpp->buflen = buflen;\n\tpp->ofs = ofs;\n\tpp->reserve = reserve;\n}"
  }
]