[
  {
    "function_name": "xfs_log_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "217-228",
    "snippet": "STATIC ssize_t\nxfs_log_store(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tconst char\t\t*buf,\n\tsize_t\t\t\tcount)\n{\n\tstruct xlog *log = to_xlog(kobject);\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->store ? xfs_attr->store(buf, count, log) : 0;\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_attr->store",
          "args": [
            "buf",
            "count",
            "log"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_attr",
          "args": [
            "attr"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "to_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
          "lines": "31-35",
          "snippet": "static inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}",
          "includes": [
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_xlog",
          "args": [
            "kobject"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "to_xlog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
          "lines": "198-203",
          "snippet": "static inline struct xlog *\nto_xlog(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\treturn container_of(kobj, struct xlog, l_kobj);\n}",
          "includes": [
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xlog *\nto_xlog(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\treturn container_of(kobj, struct xlog, l_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nxfs_log_store(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tconst char\t\t*buf,\n\tsize_t\t\t\tcount)\n{\n\tstruct xlog *log = to_xlog(kobject);\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->store ? xfs_attr->store(buf, count, log) : 0;\n}"
  },
  {
    "function_name": "xfs_log_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "205-215",
    "snippet": "STATIC ssize_t\nxfs_log_show(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tchar\t\t\t*buf)\n{\n\tstruct xlog *log = to_xlog(kobject);\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->show ? xfs_attr->show(buf, log) : 0;\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_attr->show",
          "args": [
            "buf",
            "log"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_attr",
          "args": [
            "attr"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "to_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
          "lines": "31-35",
          "snippet": "static inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}",
          "includes": [
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_xlog",
          "args": [
            "kobject"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "to_xlog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
          "lines": "198-203",
          "snippet": "static inline struct xlog *\nto_xlog(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\treturn container_of(kobj, struct xlog, l_kobj);\n}",
          "includes": [
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xlog *\nto_xlog(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\treturn container_of(kobj, struct xlog, l_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nxfs_log_show(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tchar\t\t\t*buf)\n{\n\tstruct xlog *log = to_xlog(kobject);\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->show ? xfs_attr->show(buf, log) : 0;\n}"
  },
  {
    "function_name": "to_xlog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "198-203",
    "snippet": "static inline struct xlog *\nto_xlog(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\treturn container_of(kobj, struct xlog, l_kobj);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structxlog",
            "l_kobj"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_kobj",
          "args": [
            "kobject"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "to_kobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.h",
          "lines": "26-30",
          "snippet": "static inline struct xfs_kobj *\nto_kobj(struct kobject *kobject)\n{\n\treturn container_of(kobject, struct xfs_kobj, kobject);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline struct xfs_kobj *\nto_kobj(struct kobject *kobject)\n{\n\treturn container_of(kobject, struct xfs_kobj, kobject);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xlog *\nto_xlog(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\treturn container_of(kobj, struct xlog, l_kobj);\n}"
  },
  {
    "function_name": "write_grant_head_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "176-187",
    "snippet": "STATIC ssize_t\nwrite_grant_head_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint bytes;\n\n\txlog_crack_grant_head(&log->l_write_head.grant, &cycle, &bytes);\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, bytes);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d:%d\\n\"",
            "cycle",
            "bytes"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xlog_crack_grant_head",
          "args": [
            "&log->l_write_head.grant",
            "&cycle",
            "&bytes"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "xlog_crack_grant_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log_priv.h",
          "lines": "499-503",
          "snippet": "static inline void\nxlog_crack_grant_head(atomic64_t *head, int *cycle, int *space)\n{\n\txlog_crack_grant_head_val(atomic64_read(head), cycle, space);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nxlog_crack_grant_head(atomic64_t *head, int *cycle, int *space)\n{\n\txlog_crack_grant_head_val(atomic64_read(head), cycle, space);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nwrite_grant_head_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint bytes;\n\n\txlog_crack_grant_head(&log->l_write_head.grant, &cycle, &bytes);\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, bytes);\n}"
  },
  {
    "function_name": "reserve_grant_head_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "162-173",
    "snippet": "STATIC ssize_t\nreserve_grant_head_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint bytes;\n\n\txlog_crack_grant_head(&log->l_reserve_head.grant, &cycle, &bytes);\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, bytes);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d:%d\\n\"",
            "cycle",
            "bytes"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xlog_crack_grant_head",
          "args": [
            "&log->l_reserve_head.grant",
            "&cycle",
            "&bytes"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "xlog_crack_grant_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log_priv.h",
          "lines": "499-503",
          "snippet": "static inline void\nxlog_crack_grant_head(atomic64_t *head, int *cycle, int *space)\n{\n\txlog_crack_grant_head_val(atomic64_read(head), cycle, space);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nxlog_crack_grant_head(atomic64_t *head, int *cycle, int *space)\n{\n\txlog_crack_grant_head_val(atomic64_read(head), cycle, space);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nreserve_grant_head_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint bytes;\n\n\txlog_crack_grant_head(&log->l_reserve_head.grant, &cycle, &bytes);\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, bytes);\n}"
  },
  {
    "function_name": "log_tail_lsn_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "148-159",
    "snippet": "STATIC ssize_t\nlog_tail_lsn_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint block;\n\n\txlog_crack_atomic_lsn(&log->l_tail_lsn, &cycle, &block);\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, block);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d:%d\\n\"",
            "cycle",
            "block"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xlog_crack_atomic_lsn",
          "args": [
            "&log->l_tail_lsn",
            "&cycle",
            "&block"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "xlog_crack_atomic_lsn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_log_priv.h",
          "lines": "469-476",
          "snippet": "static inline void\nxlog_crack_atomic_lsn(atomic64_t *lsn, uint *cycle, uint *block)\n{\n\txfs_lsn_t val = atomic64_read(lsn);\n\n\t*cycle = CYCLE_LSN(val);\n\t*block = BLOCK_LSN(val);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nxlog_crack_atomic_lsn(atomic64_t *lsn, uint *cycle, uint *block)\n{\n\txfs_lsn_t val = atomic64_read(lsn);\n\n\t*cycle = CYCLE_LSN(val);\n\t*block = BLOCK_LSN(val);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nlog_tail_lsn_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint block;\n\n\txlog_crack_atomic_lsn(&log->l_tail_lsn, &cycle, &block);\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, block);\n}"
  },
  {
    "function_name": "log_head_lsn_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "130-145",
    "snippet": "STATIC ssize_t\nlog_head_lsn_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint block;\n\n\tspin_lock(&log->l_icloglock);\n\tcycle = log->l_curr_cycle;\n\tblock = log->l_curr_block;\n\tspin_unlock(&log->l_icloglock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, block);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d:%d\\n\"",
            "cycle",
            "block"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&log->l_icloglock"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&log->l_icloglock"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nlog_head_lsn_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\tstruct xlog *log = data;\n\tint cycle;\n\tint block;\n\n\tspin_lock(&log->l_icloglock);\n\tcycle = log->l_curr_cycle;\n\tblock = log->l_curr_block;\n\tspin_unlock(&log->l_icloglock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d:%d\\n\", cycle, block);\n}"
  },
  {
    "function_name": "xfs_dbg_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "103-113",
    "snippet": "STATIC ssize_t\nxfs_dbg_store(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tconst char\t\t*buf,\n\tsize_t\t\t\tcount)\n{\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->store ? xfs_attr->store(buf, count, NULL) : 0;\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_attr->store",
          "args": [
            "buf",
            "count",
            "NULL"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_attr",
          "args": [
            "attr"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "to_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
          "lines": "31-35",
          "snippet": "static inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}",
          "includes": [
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nxfs_dbg_store(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tconst char\t\t*buf,\n\tsize_t\t\t\tcount)\n{\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->store ? xfs_attr->store(buf, count, NULL) : 0;\n}"
  },
  {
    "function_name": "xfs_dbg_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "92-101",
    "snippet": "STATIC ssize_t\nxfs_dbg_show(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tchar\t\t\t*buf)\n{\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->show ? xfs_attr->show(buf, NULL) : 0;\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_attr->show",
          "args": [
            "buf",
            "NULL"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_attr",
          "args": [
            "attr"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "to_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
          "lines": "31-35",
          "snippet": "static inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}",
          "includes": [
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nxfs_dbg_show(\n\tstruct kobject\t\t*kobject,\n\tstruct attribute\t*attr,\n\tchar\t\t\t*buf)\n{\n\tstruct xfs_sysfs_attr *xfs_attr = to_attr(attr);\n\n\treturn xfs_attr->show ? xfs_attr->show(buf, NULL) : 0;\n}"
  },
  {
    "function_name": "log_recovery_delay_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "78-84",
    "snippet": "STATIC ssize_t\nlog_recovery_delay_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%d\\n\", xfs_globals.log_recovery_delay);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d\\n\"",
            "xfs_globals.log_recovery_delay"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nlog_recovery_delay_show(\n\tchar\t*buf,\n\tvoid\t*data)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%d\\n\", xfs_globals.log_recovery_delay);\n}"
  },
  {
    "function_name": "log_recovery_delay_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "57-76",
    "snippet": "STATIC ssize_t\nlog_recovery_delay_store(\n\tconst char\t*buf,\n\tsize_t\t\tcount,\n\tvoid\t\t*data)\n{\n\tint\t\tret;\n\tint\t\tval;\n\n\tret = kstrtoint(buf, 0, &val);\n\tif (ret)\n\t\treturn ret;\n\n\tif (val < 0 || val > 60)\n\t\treturn -EINVAL;\n\n\txfs_globals.log_recovery_delay = val;\n\n\treturn count;\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "buf",
            "0",
            "&val"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "suffix_kstrtoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_super.c",
          "lines": "140-164",
          "snippet": "STATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/parser.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mempool.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/namei.h>",
            "#include \"xfs_sysfs.h\"",
            "#include \"xfs_quota.h\"",
            "#include \"xfs_filestream.h\"",
            "#include \"xfs_icreate_item.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_icache.h\"",
            "#include \"xfs_inode_item.h\"",
            "#include \"xfs_mru_cache.h\"",
            "#include \"xfs_extfree_item.h\"",
            "#include \"xfs_dir2.h\"",
            "#include \"xfs_da_btree.h\"",
            "#include \"xfs_log_priv.h\"",
            "#include \"xfs_log.h\"",
            "#include \"xfs_buf_item.h\"",
            "#include \"xfs_trans.h\"",
            "#include \"xfs_fsops.h\"",
            "#include \"xfs_error.h\"",
            "#include \"xfs_alloc.h\"",
            "#include \"xfs_bmap.h\"",
            "#include \"xfs_btree.h\"",
            "#include \"xfs_inode.h\"",
            "#include \"xfs_da_format.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include \"xfs_shared.h\"",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "STATIC int",
            "STATIC int",
            "STATIC int",
            "STATIC void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/parser.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/writeback.h>\n#include <linux/mempool.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/namei.h>\n#include \"xfs_sysfs.h\"\n#include \"xfs_quota.h\"\n#include \"xfs_filestream.h\"\n#include \"xfs_icreate_item.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_icache.h\"\n#include \"xfs_inode_item.h\"\n#include \"xfs_mru_cache.h\"\n#include \"xfs_extfree_item.h\"\n#include \"xfs_dir2.h\"\n#include \"xfs_da_btree.h\"\n#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_buf_item.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_fsops.h\"\n#include \"xfs_error.h\"\n#include \"xfs_alloc.h\"\n#include \"xfs_bmap.h\"\n#include \"xfs_btree.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_da_format.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include \"xfs_shared.h\"\n#include \"xfs.h\"\n\nSTATIC int;\nSTATIC int;\nSTATIC int;\nSTATIC void;\n\nSTATIC unsigned long\nsuffix_kstrtoint(char *s, unsigned int base, int *res)\n{\n\tint\tlast, shift_left_factor = 0, _res;\n\tchar\t*value = s;\n\n\tlast = strlen(value) - 1;\n\tif (value[last] == 'K' || value[last] == 'k') {\n\t\tshift_left_factor = 10;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'M' || value[last] == 'm') {\n\t\tshift_left_factor = 20;\n\t\tvalue[last] = '\\0';\n\t}\n\tif (value[last] == 'G' || value[last] == 'g') {\n\t\tshift_left_factor = 30;\n\t\tvalue[last] = '\\0';\n\t}\n\n\tif (kstrtoint(s, base, &_res))\n\t\treturn -EINVAL;\n\t*res = _res << shift_left_factor;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nSTATIC ssize_t\nlog_recovery_delay_store(\n\tconst char\t*buf,\n\tsize_t\t\tcount,\n\tvoid\t\t*data)\n{\n\tint\t\tret;\n\tint\t\tval;\n\n\tret = kstrtoint(buf, 0, &val);\n\tif (ret)\n\t\treturn ret;\n\n\tif (val < 0 || val > 60)\n\t\treturn -EINVAL;\n\n\txfs_globals.log_recovery_delay = val;\n\n\treturn count;\n}"
  },
  {
    "function_name": "to_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.c",
    "lines": "31-35",
    "snippet": "static inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}",
    "includes": [
      "#include \"xfs_log_priv.h\"",
      "#include \"xfs_log.h\"",
      "#include \"xfs_log_format.h\"",
      "#include \"xfs_sysfs.h\"",
      "#include \"xfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structxfs_sysfs_attr",
            "attr"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xfs_log_priv.h\"\n#include \"xfs_log.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_sysfs.h\"\n#include \"xfs.h\"\n\nstatic inline struct xfs_sysfs_attr *\nto_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct xfs_sysfs_attr, attr);\n}"
  }
]