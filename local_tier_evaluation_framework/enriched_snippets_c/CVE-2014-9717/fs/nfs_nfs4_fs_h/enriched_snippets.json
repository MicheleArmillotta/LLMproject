[
  {
    "function_name": "nfs4_valid_open_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "516-519",
    "snippet": "static inline bool nfs4_valid_open_stateid(const struct nfs4_state *state)\n{\n\treturn test_bit(NFS_STATE_RECOVERY_FAILED, &state->flags) == 0;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_STATE_RECOVERY_FAILED",
            "&state->flags"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_valid_open_stateid(const struct nfs4_state *state)\n{\n\treturn test_bit(NFS_STATE_RECOVERY_FAILED, &state->flags) == 0;\n}"
  },
  {
    "function_name": "nfs4_stateid_is_newer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "511-514",
    "snippet": "static inline bool nfs4_stateid_is_newer(const nfs4_stateid *s1, const nfs4_stateid *s2)\n{\n\treturn (s32)(be32_to_cpu(s1->seqid) - be32_to_cpu(s2->seqid)) > 0;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "be32_to_cpu(s1->seqid) - be32_to_cpu(s2->seqid)"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "s2->seqid"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "s1->seqid"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_stateid_is_newer(const nfs4_stateid *s1, const nfs4_stateid *s2)\n{\n\treturn (s32)(be32_to_cpu(s1->seqid) - be32_to_cpu(s2->seqid)) > 0;\n}"
  },
  {
    "function_name": "nfs4_stateid_match_other",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "506-509",
    "snippet": "static inline bool nfs4_stateid_match_other(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst->other, src->other, NFS4_STATEID_OTHER_SIZE) == 0;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "dst->other",
            "src->other",
            "NFS4_STATEID_OTHER_SIZE"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_stateid_match_other(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst->other, src->other, NFS4_STATEID_OTHER_SIZE) == 0;\n}"
  },
  {
    "function_name": "nfs4_stateid_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "501-504",
    "snippet": "static inline bool nfs4_stateid_match(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst, src, sizeof(*dst)) == 0;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "dst",
            "src",
            "sizeof(*dst)"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_stateid_match(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst, src, sizeof(*dst)) == 0;\n}"
  },
  {
    "function_name": "nfs4_stateid_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "496-499",
    "snippet": "static inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "sizeof(*dst)"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}"
  },
  {
    "function_name": "nfs4_unregister_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "482-484",
    "snippet": "static inline void nfs4_unregister_sysctl(void)\n{\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void nfs4_unregister_sysctl(void)\n{\n}"
  },
  {
    "function_name": "nfs4_register_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "477-480",
    "snippet": "static inline int nfs4_register_sysctl(void)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline int nfs4_register_sysctl(void)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_schedule_session_recovery",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "411-413",
    "snippet": "static inline void nfs4_schedule_session_recovery(struct nfs4_session *session, int err)\n{\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void nfs4_schedule_session_recovery(struct nfs4_session *session, int err)\n{\n}"
  },
  {
    "function_name": "nfs4_state_protect_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "366-370",
    "snippet": "static inline void\nnfs4_state_protect_write(struct nfs_client *clp, struct rpc_clnt **clntp,\n\t\t\t struct rpc_message *msg, struct nfs_pgio_header *hdr)\n{\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void\nnfs4_state_protect_write(struct nfs_client *clp, struct rpc_clnt **clntp,\n\t\t\t struct rpc_message *msg, struct nfs_pgio_header *hdr)\n{\n}"
  },
  {
    "function_name": "nfs4_state_protect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "360-364",
    "snippet": "static inline void\nnfs4_state_protect(struct nfs_client *clp, unsigned long sp4_flags,\n\t\t   struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void\nnfs4_state_protect(struct nfs_client *clp, unsigned long sp4_flags,\n\t\t   struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n}"
  },
  {
    "function_name": "is_ds_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "354-358",
    "snippet": "static inline bool\nis_ds_client(struct nfs_client *clp)\n{\n\treturn false;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\nis_ds_client(struct nfs_client *clp)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "is_ds_only_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "348-352",
    "snippet": "static inline bool\nis_ds_only_client(struct nfs_client *clp)\n{\n\treturn false;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\nis_ds_only_client(struct nfs_client *clp)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "nfs4_get_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "343-346",
    "snippet": "static inline struct nfs4_session *nfs4_get_session(const struct nfs_server *server)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline struct nfs4_session *nfs4_get_session(const struct nfs_server *server)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs4_state_protect_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "334-341",
    "snippet": "static inline void\nnfs4_state_protect_write(struct nfs_client *clp, struct rpc_clnt **clntp,\n\t\t\t struct rpc_message *msg, struct nfs_pgio_header *hdr)\n{\n\tif (_nfs4_state_protect(clp, NFS_SP4_MACH_CRED_WRITE, clntp, msg) &&\n\t    !test_bit(NFS_SP4_MACH_CRED_COMMIT, &clp->cl_sp4_flags))\n\t\thdr->args.stable = NFS_FILE_SYNC;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_SP4_MACH_CRED_COMMIT",
            "&clp->cl_sp4_flags"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_nfs4_state_protect",
          "args": [
            "clp",
            "NFS_SP4_MACH_CRED_WRITE",
            "clntp",
            "msg"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "_nfs4_state_protect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "290-314",
          "snippet": "static inline bool\n_nfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t    struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\tstruct rpc_cred *newcred = NULL;\n\trpc_authflavor_t flavor;\n\n\tif (test_bit(sp4_mode, &clp->cl_sp4_flags)) {\n\t\tspin_lock(&clp->cl_lock);\n\t\tif (clp->cl_machine_cred != NULL)\n\t\t\t/* don't call get_rpccred on the machine cred -\n\t\t\t * a reference will be held for life of clp */\n\t\t\tnewcred = clp->cl_machine_cred;\n\t\tspin_unlock(&clp->cl_lock);\n\t\tmsg->rpc_cred = newcred;\n\n\t\tflavor = clp->cl_rpcclient->cl_auth->au_flavor;\n\t\tWARN_ON_ONCE(flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P);\n\t\t*clntp = clp->cl_rpcclient;\n\n\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\n_nfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t    struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\tstruct rpc_cred *newcred = NULL;\n\trpc_authflavor_t flavor;\n\n\tif (test_bit(sp4_mode, &clp->cl_sp4_flags)) {\n\t\tspin_lock(&clp->cl_lock);\n\t\tif (clp->cl_machine_cred != NULL)\n\t\t\t/* don't call get_rpccred on the machine cred -\n\t\t\t * a reference will be held for life of clp */\n\t\t\tnewcred = clp->cl_machine_cred;\n\t\tspin_unlock(&clp->cl_lock);\n\t\tmsg->rpc_cred = newcred;\n\n\t\tflavor = clp->cl_rpcclient->cl_auth->au_flavor;\n\t\tWARN_ON_ONCE(flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P);\n\t\t*clntp = clp->cl_rpcclient;\n\n\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void\nnfs4_state_protect_write(struct nfs_client *clp, struct rpc_clnt **clntp,\n\t\t\t struct rpc_message *msg, struct nfs_pgio_header *hdr)\n{\n\tif (_nfs4_state_protect(clp, NFS_SP4_MACH_CRED_WRITE, clntp, msg) &&\n\t    !test_bit(NFS_SP4_MACH_CRED_COMMIT, &clp->cl_sp4_flags))\n\t\thdr->args.stable = NFS_FILE_SYNC;\n}"
  },
  {
    "function_name": "nfs4_state_protect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "322-327",
    "snippet": "static inline void\nnfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t   struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\t_nfs4_state_protect(clp, sp4_mode, clntp, msg);\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_nfs4_state_protect",
          "args": [
            "clp",
            "sp4_mode",
            "clntp",
            "msg"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "_nfs4_state_protect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "290-314",
          "snippet": "static inline bool\n_nfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t    struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\tstruct rpc_cred *newcred = NULL;\n\trpc_authflavor_t flavor;\n\n\tif (test_bit(sp4_mode, &clp->cl_sp4_flags)) {\n\t\tspin_lock(&clp->cl_lock);\n\t\tif (clp->cl_machine_cred != NULL)\n\t\t\t/* don't call get_rpccred on the machine cred -\n\t\t\t * a reference will be held for life of clp */\n\t\t\tnewcred = clp->cl_machine_cred;\n\t\tspin_unlock(&clp->cl_lock);\n\t\tmsg->rpc_cred = newcred;\n\n\t\tflavor = clp->cl_rpcclient->cl_auth->au_flavor;\n\t\tWARN_ON_ONCE(flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P);\n\t\t*clntp = clp->cl_rpcclient;\n\n\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\n_nfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t    struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\tstruct rpc_cred *newcred = NULL;\n\trpc_authflavor_t flavor;\n\n\tif (test_bit(sp4_mode, &clp->cl_sp4_flags)) {\n\t\tspin_lock(&clp->cl_lock);\n\t\tif (clp->cl_machine_cred != NULL)\n\t\t\t/* don't call get_rpccred on the machine cred -\n\t\t\t * a reference will be held for life of clp */\n\t\t\tnewcred = clp->cl_machine_cred;\n\t\tspin_unlock(&clp->cl_lock);\n\t\tmsg->rpc_cred = newcred;\n\n\t\tflavor = clp->cl_rpcclient->cl_auth->au_flavor;\n\t\tWARN_ON_ONCE(flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P);\n\t\t*clntp = clp->cl_rpcclient;\n\n\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void\nnfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t   struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\t_nfs4_state_protect(clp, sp4_mode, clntp, msg);\n}"
  },
  {
    "function_name": "_nfs4_state_protect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "290-314",
    "snippet": "static inline bool\n_nfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t    struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\tstruct rpc_cred *newcred = NULL;\n\trpc_authflavor_t flavor;\n\n\tif (test_bit(sp4_mode, &clp->cl_sp4_flags)) {\n\t\tspin_lock(&clp->cl_lock);\n\t\tif (clp->cl_machine_cred != NULL)\n\t\t\t/* don't call get_rpccred on the machine cred -\n\t\t\t * a reference will be held for life of clp */\n\t\t\tnewcred = clp->cl_machine_cred;\n\t\tspin_unlock(&clp->cl_lock);\n\t\tmsg->rpc_cred = newcred;\n\n\t\tflavor = clp->cl_rpcclient->cl_auth->au_flavor;\n\t\tWARN_ON_ONCE(flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P);\n\t\t*clntp = clp->cl_rpcclient;\n\n\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "sp4_mode",
            "&clp->cl_sp4_flags"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\n_nfs4_state_protect(struct nfs_client *clp, unsigned long sp4_mode,\n\t\t    struct rpc_clnt **clntp, struct rpc_message *msg)\n{\n\tstruct rpc_cred *newcred = NULL;\n\trpc_authflavor_t flavor;\n\n\tif (test_bit(sp4_mode, &clp->cl_sp4_flags)) {\n\t\tspin_lock(&clp->cl_lock);\n\t\tif (clp->cl_machine_cred != NULL)\n\t\t\t/* don't call get_rpccred on the machine cred -\n\t\t\t * a reference will be held for life of clp */\n\t\t\tnewcred = clp->cl_machine_cred;\n\t\tspin_unlock(&clp->cl_lock);\n\t\tmsg->rpc_cred = newcred;\n\n\t\tflavor = clp->cl_rpcclient->cl_auth->au_flavor;\n\t\tWARN_ON_ONCE(flavor != RPC_AUTH_GSS_KRB5I &&\n\t\t\t     flavor != RPC_AUTH_GSS_KRB5P);\n\t\t*clntp = clp->cl_rpcclient;\n\n\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "is_ds_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "284-288",
    "snippet": "static inline bool\nis_ds_client(struct nfs_client *clp)\n{\n\treturn clp->cl_exchange_flags & EXCHGID4_FLAG_USE_PNFS_DS;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\nis_ds_client(struct nfs_client *clp)\n{\n\treturn clp->cl_exchange_flags & EXCHGID4_FLAG_USE_PNFS_DS;\n}"
  },
  {
    "function_name": "is_ds_only_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "277-282",
    "snippet": "static inline bool\nis_ds_only_client(struct nfs_client *clp)\n{\n\treturn (clp->cl_exchange_flags & EXCHGID4_FLAG_MASK_PNFS) ==\n\t\tEXCHGID4_FLAG_USE_PNFS_DS;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\nis_ds_only_client(struct nfs_client *clp)\n{\n\treturn (clp->cl_exchange_flags & EXCHGID4_FLAG_MASK_PNFS) ==\n\t\tEXCHGID4_FLAG_USE_PNFS_DS;\n}"
  },
  {
    "function_name": "nfs4_get_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "261-264",
    "snippet": "static inline struct nfs4_session *nfs4_get_session(const struct nfs_server *server)\n{\n\treturn server->nfs_client->cl_session;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline struct nfs4_session *nfs4_get_session(const struct nfs_server *server)\n{\n\treturn server->nfs_client->cl_session;\n}"
  },
  {
    "function_name": "nfs_confirm_seqid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
    "lines": "86-90",
    "snippet": "static inline void nfs_confirm_seqid(struct nfs_seqid_counter *seqid, int status)\n{\n\tif (seqid_mutating_err(-status))\n\t\tseqid->flags |= NFS_SEQID_CONFIRMED;\n}",
    "includes": [
      "#include <linux/seqlock.h>"
    ],
    "macros_used": [
      "#define NFS_SEQID_CONFIRMED 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seqid_mutating_err",
          "args": [
            "-status"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/seqlock.h>\n\n#define NFS_SEQID_CONFIRMED 1\n\nstatic inline void nfs_confirm_seqid(struct nfs_seqid_counter *seqid, int status)\n{\n\tif (seqid_mutating_err(-status))\n\t\tseqid->flags |= NFS_SEQID_CONFIRMED;\n}"
  }
]