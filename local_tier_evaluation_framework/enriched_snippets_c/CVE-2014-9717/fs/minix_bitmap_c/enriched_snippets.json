[
  {
    "function_name": "minix_count_free_inodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "266-272",
    "snippet": "unsigned long minix_count_free_inodes(struct super_block *sb)\n{\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tu32 bits = sbi->s_ninodes + 1;\n\n\treturn count_free(sbi->s_imap, sb->s_blocksize, bits);\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "count_free",
          "args": [
            "sbi->s_imap",
            "sb->s_blocksize",
            "bits"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "count_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
          "lines": "26-39",
          "snippet": "static __u32 count_free(struct buffer_head *map[], unsigned blocksize, __u32 numbits)\n{\n\t__u32 sum = 0;\n\tunsigned blocks = DIV_ROUND_UP(numbits, blocksize * 8);\n\n\twhile (blocks--) {\n\t\tunsigned words = blocksize / 2;\n\t\t__u16 *p = (__u16 *)(*map++)->b_data;\n\t\twhile (words--)\n\t\t\tsum += 16 - hweight16(*p++);\n\t}\n\n\treturn sum;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include \"minix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic __u32 count_free(struct buffer_head *map[], unsigned blocksize, __u32 numbits)\n{\n\t__u32 sum = 0;\n\tunsigned blocks = DIV_ROUND_UP(numbits, blocksize * 8);\n\n\twhile (blocks--) {\n\t\tunsigned words = blocksize / 2;\n\t\t__u16 *p = (__u16 *)(*map++)->b_data;\n\t\twhile (words--)\n\t\t\tsum += 16 - hweight16(*p++);\n\t}\n\n\treturn sum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "sb"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nunsigned long minix_count_free_inodes(struct super_block *sb)\n{\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tu32 bits = sbi->s_ninodes + 1;\n\n\treturn count_free(sbi->s_imap, sb->s_blocksize, bits);\n}"
  },
  {
    "function_name": "minix_new_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "212-264",
    "snippet": "struct inode *minix_new_inode(const struct inode *dir, umode_t mode, int *error)\n{\n\tstruct super_block *sb = dir->i_sb;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct inode *inode = new_inode(sb);\n\tstruct buffer_head * bh;\n\tint bits_per_zone = 8 * sb->s_blocksize;\n\tunsigned long j;\n\tint i;\n\n\tif (!inode) {\n\t\t*error = -ENOMEM;\n\t\treturn NULL;\n\t}\n\tj = bits_per_zone;\n\tbh = NULL;\n\t*error = -ENOSPC;\n\tspin_lock(&bitmap_lock);\n\tfor (i = 0; i < sbi->s_imap_blocks; i++) {\n\t\tbh = sbi->s_imap[i];\n\t\tj = minix_find_first_zero_bit(bh->b_data, bits_per_zone);\n\t\tif (j < bits_per_zone)\n\t\t\tbreak;\n\t}\n\tif (!bh || j >= bits_per_zone) {\n\t\tspin_unlock(&bitmap_lock);\n\t\tiput(inode);\n\t\treturn NULL;\n\t}\n\tif (minix_test_and_set_bit(j, bh->b_data)) {\t/* shouldn't happen */\n\t\tspin_unlock(&bitmap_lock);\n\t\tprintk(\"minix_new_inode: bit already set\\n\");\n\t\tiput(inode);\n\t\treturn NULL;\n\t}\n\tspin_unlock(&bitmap_lock);\n\tmark_buffer_dirty(bh);\n\tj += i * bits_per_zone;\n\tif (!j || j > sbi->s_ninodes) {\n\t\tiput(inode);\n\t\treturn NULL;\n\t}\n\tinode_init_owner(inode, dir, mode);\n\tinode->i_ino = j;\n\tinode->i_mtime = inode->i_atime = inode->i_ctime = CURRENT_TIME_SEC;\n\tinode->i_blocks = 0;\n\tmemset(&minix_i(inode)->u, 0, sizeof(minix_i(inode)->u));\n\tinsert_inode_hash(inode);\n\tmark_inode_dirty(inode);\n\n\t*error = 0;\n\treturn inode;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(bitmap_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mark_inode_dirty",
          "args": [
            "inode"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "block_dump___mark_inode_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fs-writeback.c",
          "lines": "1134-1154",
          "snippet": "static noinline void block_dump___mark_inode_dirty(struct inode *inode)\n{\n\tif (inode->i_ino || strcmp(inode->i_sb->s_id, \"bdev\")) {\n\t\tstruct dentry *dentry;\n\t\tconst char *name = \"?\";\n\n\t\tdentry = d_find_alias(inode);\n\t\tif (dentry) {\n\t\t\tspin_lock(&dentry->d_lock);\n\t\t\tname = (const char *) dentry->d_name.name;\n\t\t}\n\t\tprintk(KERN_DEBUG\n\t\t       \"%s(%d): dirtied inode %lu (%s) on %s\\n\",\n\t\t       current->comm, task_pid_nr(current), inode->i_ino,\n\t\t       name, inode->i_sb->s_id);\n\t\tif (dentry) {\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\tdput(dentry);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/writeback.h>",
            "#include \"internal.h\"",
            "#include <linux/device.h>",
            "#include <linux/tracepoint.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/kthread.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/writeback.h>\n#include \"internal.h\"\n#include <linux/device.h>\n#include <linux/tracepoint.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/kthread.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic noinline void block_dump___mark_inode_dirty(struct inode *inode)\n{\n\tif (inode->i_ino || strcmp(inode->i_sb->s_id, \"bdev\")) {\n\t\tstruct dentry *dentry;\n\t\tconst char *name = \"?\";\n\n\t\tdentry = d_find_alias(inode);\n\t\tif (dentry) {\n\t\t\tspin_lock(&dentry->d_lock);\n\t\t\tname = (const char *) dentry->d_name.name;\n\t\t}\n\t\tprintk(KERN_DEBUG\n\t\t       \"%s(%d): dirtied inode %lu (%s) on %s\\n\",\n\t\t       current->comm, task_pid_nr(current), inode->i_ino,\n\t\t       name, inode->i_sb->s_id);\n\t\tif (dentry) {\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\tdput(dentry);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "insert_inode_hash",
          "args": [
            "inode"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_insert_inode_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "213-218",
          "snippet": "static inline void btrfs_insert_inode_hash(struct inode *inode)\n{\n\tunsigned long h = btrfs_inode_hash(inode->i_ino, BTRFS_I(inode)->root);\n\n\t__insert_inode_hash(inode, h);\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_insert_inode_hash(struct inode *inode)\n{\n\tunsigned long h = btrfs_inode_hash(inode->i_ino, BTRFS_I(inode)->root);\n\n\t__insert_inode_hash(inode, h);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&minix_i(inode)->u",
            "0",
            "sizeof(minix_i(inode)->u)"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minix_i",
          "args": [
            "inode"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "V2_minix_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/inode.c",
          "lines": "496-526",
          "snippet": "static struct inode *V2_minix_iget(struct inode *inode)\n{\n\tstruct buffer_head * bh;\n\tstruct minix2_inode * raw_inode;\n\tstruct minix_inode_info *minix_inode = minix_i(inode);\n\tint i;\n\n\traw_inode = minix_V2_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\tif (!raw_inode) {\n\t\tiget_failed(inode);\n\t\treturn ERR_PTR(-EIO);\n\t}\n\tinode->i_mode = raw_inode->i_mode;\n\ti_uid_write(inode, raw_inode->i_uid);\n\ti_gid_write(inode, raw_inode->i_gid);\n\tset_nlink(inode, raw_inode->i_nlinks);\n\tinode->i_size = raw_inode->i_size;\n\tinode->i_mtime.tv_sec = raw_inode->i_mtime;\n\tinode->i_atime.tv_sec = raw_inode->i_atime;\n\tinode->i_ctime.tv_sec = raw_inode->i_ctime;\n\tinode->i_mtime.tv_nsec = 0;\n\tinode->i_atime.tv_nsec = 0;\n\tinode->i_ctime.tv_nsec = 0;\n\tinode->i_blocks = 0;\n\tfor (i = 0; i < 10; i++)\n\t\tminix_inode->u.i2_data[i] = raw_inode->i_zone[i];\n\tminix_set_inode(inode, old_decode_dev(raw_inode->i_zone[0]));\n\tbrelse(bh);\n\tunlock_new_inode(inode);\n\treturn inode;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/vfs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include \"minix.h\"",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/vfs.h>\n#include <linux/highuid.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n#include <linux/module.h>\n\nstatic struct inode *V2_minix_iget(struct inode *inode)\n{\n\tstruct buffer_head * bh;\n\tstruct minix2_inode * raw_inode;\n\tstruct minix_inode_info *minix_inode = minix_i(inode);\n\tint i;\n\n\traw_inode = minix_V2_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\tif (!raw_inode) {\n\t\tiget_failed(inode);\n\t\treturn ERR_PTR(-EIO);\n\t}\n\tinode->i_mode = raw_inode->i_mode;\n\ti_uid_write(inode, raw_inode->i_uid);\n\ti_gid_write(inode, raw_inode->i_gid);\n\tset_nlink(inode, raw_inode->i_nlinks);\n\tinode->i_size = raw_inode->i_size;\n\tinode->i_mtime.tv_sec = raw_inode->i_mtime;\n\tinode->i_atime.tv_sec = raw_inode->i_atime;\n\tinode->i_ctime.tv_sec = raw_inode->i_ctime;\n\tinode->i_mtime.tv_nsec = 0;\n\tinode->i_atime.tv_nsec = 0;\n\tinode->i_ctime.tv_nsec = 0;\n\tinode->i_blocks = 0;\n\tfor (i = 0; i < 10; i++)\n\t\tminix_inode->u.i2_data[i] = raw_inode->i_zone[i];\n\tminix_set_inode(inode, old_decode_dev(raw_inode->i_zone[0]));\n\tbrelse(bh);\n\tunlock_new_inode(inode);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_init_owner",
          "args": [
            "inode",
            "dir",
            "mode"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "inode_init_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1880-1891",
          "snippet": "void inode_init_owner(struct inode *inode, const struct inode *dir,\n\t\t\tumode_t mode)\n{\n\tinode->i_uid = current_fsuid();\n\tif (dir && dir->i_mode & S_ISGID) {\n\t\tinode->i_gid = dir->i_gid;\n\t\tif (S_ISDIR(mode))\n\t\t\tmode |= S_ISGID;\n\t} else\n\t\tinode->i_gid = current_fsgid();\n\tinode->i_mode = mode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid inode_init_owner(struct inode *inode, const struct inode *dir,\n\t\t\tumode_t mode)\n{\n\tinode->i_uid = current_fsuid();\n\tif (dir && dir->i_mode & S_ISGID) {\n\t\tinode->i_gid = dir->i_gid;\n\t\tif (S_ISDIR(mode))\n\t\t\tmode |= S_ISGID;\n\t} else\n\t\tinode->i_gid = current_fsgid();\n\tinode->i_mode = mode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"minix_new_inode: bit already set\\n\""
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_test_and_set_bit",
          "args": [
            "j",
            "bh->b_data"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minix_find_first_zero_bit",
          "args": [
            "bh->b_data",
            "bits_per_zone"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "minix_find_first_zero_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "124-140",
          "snippet": "static inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define minix_find_first_zero_bit\tfind_first_zero_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\n#define minix_find_first_zero_bit\tfind_first_zero_bit_le\n\nstatic inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_inode",
          "args": [
            "sb"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_new_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "924-933",
          "snippet": "void unlock_new_inode(struct inode *inode)\n{\n\tlockdep_annotate_inode_mutex_key(inode);\n\tspin_lock(&inode->i_lock);\n\tWARN_ON(!(inode->i_state & I_NEW));\n\tinode->i_state &= ~I_NEW;\n\tsmp_mb();\n\twake_up_bit(&inode->i_state, __I_NEW);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid unlock_new_inode(struct inode *inode)\n{\n\tlockdep_annotate_inode_mutex_key(inode);\n\tspin_lock(&inode->i_lock);\n\tWARN_ON(!(inode->i_state & I_NEW));\n\tinode->i_state &= ~I_NEW;\n\tsmp_mb();\n\twake_up_bit(&inode->i_state, __I_NEW);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "sb"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic DEFINE_SPINLOCK(bitmap_lock);\n\nstruct inode *minix_new_inode(const struct inode *dir, umode_t mode, int *error)\n{\n\tstruct super_block *sb = dir->i_sb;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct inode *inode = new_inode(sb);\n\tstruct buffer_head * bh;\n\tint bits_per_zone = 8 * sb->s_blocksize;\n\tunsigned long j;\n\tint i;\n\n\tif (!inode) {\n\t\t*error = -ENOMEM;\n\t\treturn NULL;\n\t}\n\tj = bits_per_zone;\n\tbh = NULL;\n\t*error = -ENOSPC;\n\tspin_lock(&bitmap_lock);\n\tfor (i = 0; i < sbi->s_imap_blocks; i++) {\n\t\tbh = sbi->s_imap[i];\n\t\tj = minix_find_first_zero_bit(bh->b_data, bits_per_zone);\n\t\tif (j < bits_per_zone)\n\t\t\tbreak;\n\t}\n\tif (!bh || j >= bits_per_zone) {\n\t\tspin_unlock(&bitmap_lock);\n\t\tiput(inode);\n\t\treturn NULL;\n\t}\n\tif (minix_test_and_set_bit(j, bh->b_data)) {\t/* shouldn't happen */\n\t\tspin_unlock(&bitmap_lock);\n\t\tprintk(\"minix_new_inode: bit already set\\n\");\n\t\tiput(inode);\n\t\treturn NULL;\n\t}\n\tspin_unlock(&bitmap_lock);\n\tmark_buffer_dirty(bh);\n\tj += i * bits_per_zone;\n\tif (!j || j > sbi->s_ninodes) {\n\t\tiput(inode);\n\t\treturn NULL;\n\t}\n\tinode_init_owner(inode, dir, mode);\n\tinode->i_ino = j;\n\tinode->i_mtime = inode->i_atime = inode->i_ctime = CURRENT_TIME_SEC;\n\tinode->i_blocks = 0;\n\tmemset(&minix_i(inode)->u, 0, sizeof(minix_i(inode)->u));\n\tinsert_inode_hash(inode);\n\tmark_inode_dirty(inode);\n\n\t*error = 0;\n\treturn inode;\n}"
  },
  {
    "function_name": "minix_free_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "182-210",
    "snippet": "void minix_free_inode(struct inode * inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\tstruct minix_sb_info *sbi = minix_sb(inode->i_sb);\n\tstruct buffer_head *bh;\n\tint k = sb->s_blocksize_bits + 3;\n\tunsigned long ino, bit;\n\n\tino = inode->i_ino;\n\tif (ino < 1 || ino > sbi->s_ninodes) {\n\t\tprintk(\"minix_free_inode: inode 0 or nonexistent inode\\n\");\n\t\treturn;\n\t}\n\tbit = ino & ((1<<k) - 1);\n\tino >>= k;\n\tif (ino >= sbi->s_imap_blocks) {\n\t\tprintk(\"minix_free_inode: nonexistent imap in superblock\\n\");\n\t\treturn;\n\t}\n\n\tminix_clear_inode(inode);\t/* clear on-disk copy */\n\n\tbh = sbi->s_imap[ino];\n\tspin_lock(&bitmap_lock);\n\tif (!minix_test_and_clear_bit(bit, bh->b_data))\n\t\tprintk(\"minix_free_inode: bit %lu already cleared\\n\", bit);\n\tspin_unlock(&bitmap_lock);\n\tmark_buffer_dirty(bh);\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(bitmap_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"minix_free_inode: bit %lu already cleared\\n\"",
            "bit"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_test_and_clear_bit",
          "args": [
            "bit",
            "bh->b_data"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_clear_inode",
          "args": [
            "inode"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "minix_clear_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
          "lines": "157-180",
          "snippet": "static void minix_clear_inode(struct inode *inode)\n{\n\tstruct buffer_head *bh = NULL;\n\n\tif (INODE_VERSION(inode) == MINIX_V1) {\n\t\tstruct minix_inode *raw_inode;\n\t\traw_inode = minix_V1_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t} else {\n\t\tstruct minix2_inode *raw_inode;\n\t\traw_inode = minix_V2_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t}\n\tif (bh) {\n\t\tmark_buffer_dirty(bh);\n\t\tbrelse (bh);\n\t}\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include \"minix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic void minix_clear_inode(struct inode *inode)\n{\n\tstruct buffer_head *bh = NULL;\n\n\tif (INODE_VERSION(inode) == MINIX_V1) {\n\t\tstruct minix_inode *raw_inode;\n\t\traw_inode = minix_V1_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t} else {\n\t\tstruct minix2_inode *raw_inode;\n\t\traw_inode = minix_V2_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t}\n\tif (bh) {\n\t\tmark_buffer_dirty(bh);\n\t\tbrelse (bh);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "inode->i_sb"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic DEFINE_SPINLOCK(bitmap_lock);\n\nvoid minix_free_inode(struct inode * inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\tstruct minix_sb_info *sbi = minix_sb(inode->i_sb);\n\tstruct buffer_head *bh;\n\tint k = sb->s_blocksize_bits + 3;\n\tunsigned long ino, bit;\n\n\tino = inode->i_ino;\n\tif (ino < 1 || ino > sbi->s_ninodes) {\n\t\tprintk(\"minix_free_inode: inode 0 or nonexistent inode\\n\");\n\t\treturn;\n\t}\n\tbit = ino & ((1<<k) - 1);\n\tino >>= k;\n\tif (ino >= sbi->s_imap_blocks) {\n\t\tprintk(\"minix_free_inode: nonexistent imap in superblock\\n\");\n\t\treturn;\n\t}\n\n\tminix_clear_inode(inode);\t/* clear on-disk copy */\n\n\tbh = sbi->s_imap[ino];\n\tspin_lock(&bitmap_lock);\n\tif (!minix_test_and_clear_bit(bit, bh->b_data))\n\t\tprintk(\"minix_free_inode: bit %lu already cleared\\n\", bit);\n\tspin_unlock(&bitmap_lock);\n\tmark_buffer_dirty(bh);\n}"
  },
  {
    "function_name": "minix_clear_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "157-180",
    "snippet": "static void minix_clear_inode(struct inode *inode)\n{\n\tstruct buffer_head *bh = NULL;\n\n\tif (INODE_VERSION(inode) == MINIX_V1) {\n\t\tstruct minix_inode *raw_inode;\n\t\traw_inode = minix_V1_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t} else {\n\t\tstruct minix2_inode *raw_inode;\n\t\traw_inode = minix_V2_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t}\n\tif (bh) {\n\t\tmark_buffer_dirty(bh);\n\t\tbrelse (bh);\n\t}\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_V2_raw_inode",
          "args": [
            "inode->i_sb",
            "inode->i_ino",
            "&bh"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "minix_V2_raw_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
          "lines": "129-153",
          "snippet": "struct minix2_inode *\nminix_V2_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix2_inode *p;\n\tint minix2_inodes_per_block = sb->s_blocksize / sizeof(struct minix2_inode);\n\n\t*bh = NULL;\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / minix2_inodes_per_block;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % minix2_inodes_per_block;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include \"minix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstruct minix2_inode *\nminix_V2_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix2_inode *p;\n\tint minix2_inodes_per_block = sb->s_blocksize / sizeof(struct minix2_inode);\n\n\t*bh = NULL;\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / minix2_inodes_per_block;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % minix2_inodes_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_V1_raw_inode",
          "args": [
            "inode->i_sb",
            "inode->i_ino",
            "&bh"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "minix_V1_raw_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
          "lines": "105-127",
          "snippet": "struct minix_inode *\nminix_V1_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix_inode *p;\n\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / MINIX_INODES_PER_BLOCK;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % MINIX_INODES_PER_BLOCK;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include \"minix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstruct minix_inode *\nminix_V1_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix_inode *p;\n\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / MINIX_INODES_PER_BLOCK;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % MINIX_INODES_PER_BLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INODE_VERSION",
          "args": [
            "inode"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic void minix_clear_inode(struct inode *inode)\n{\n\tstruct buffer_head *bh = NULL;\n\n\tif (INODE_VERSION(inode) == MINIX_V1) {\n\t\tstruct minix_inode *raw_inode;\n\t\traw_inode = minix_V1_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t} else {\n\t\tstruct minix2_inode *raw_inode;\n\t\traw_inode = minix_V2_raw_inode(inode->i_sb, inode->i_ino, &bh);\n\t\tif (raw_inode) {\n\t\t\traw_inode->i_nlinks = 0;\n\t\t\traw_inode->i_mode = 0;\n\t\t}\n\t}\n\tif (bh) {\n\t\tmark_buffer_dirty(bh);\n\t\tbrelse (bh);\n\t}\n}"
  },
  {
    "function_name": "minix_V2_raw_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "129-153",
    "snippet": "struct minix2_inode *\nminix_V2_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix2_inode *p;\n\tint minix2_inodes_per_block = sb->s_blocksize / sizeof(struct minix2_inode);\n\n\t*bh = NULL;\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / minix2_inodes_per_block;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % minix2_inodes_per_block;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"Unable to read inode block\\n\""
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "sb",
            "block"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "sb"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstruct minix2_inode *\nminix_V2_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix2_inode *p;\n\tint minix2_inodes_per_block = sb->s_blocksize / sizeof(struct minix2_inode);\n\n\t*bh = NULL;\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / minix2_inodes_per_block;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % minix2_inodes_per_block;\n}"
  },
  {
    "function_name": "minix_V1_raw_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "105-127",
    "snippet": "struct minix_inode *\nminix_V1_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix_inode *p;\n\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / MINIX_INODES_PER_BLOCK;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % MINIX_INODES_PER_BLOCK;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"Unable to read inode block\\n\""
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "sb",
            "block"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "sb"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstruct minix_inode *\nminix_V1_raw_inode(struct super_block *sb, ino_t ino, struct buffer_head **bh)\n{\n\tint block;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct minix_inode *p;\n\n\tif (!ino || ino > sbi->s_ninodes) {\n\t\tprintk(\"Bad inode number on dev %s: %ld is out of range\\n\",\n\t\t       sb->s_id, (long)ino);\n\t\treturn NULL;\n\t}\n\tino--;\n\tblock = 2 + sbi->s_imap_blocks + sbi->s_zmap_blocks +\n\t\t ino / MINIX_INODES_PER_BLOCK;\n\t*bh = sb_bread(sb, block);\n\tif (!*bh) {\n\t\tprintk(\"Unable to read inode block\\n\");\n\t\treturn NULL;\n\t}\n\tp = (void *)(*bh)->b_data;\n\treturn p + ino % MINIX_INODES_PER_BLOCK;\n}"
  },
  {
    "function_name": "minix_count_free_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "96-103",
    "snippet": "unsigned long minix_count_free_blocks(struct super_block *sb)\n{\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tu32 bits = sbi->s_nzones - sbi->s_firstdatazone + 1;\n\n\treturn (count_free(sbi->s_zmap, sb->s_blocksize, bits)\n\t\t<< sbi->s_log_zone_size);\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "count_free",
          "args": [
            "sbi->s_zmap",
            "sb->s_blocksize",
            "bits"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "count_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
          "lines": "26-39",
          "snippet": "static __u32 count_free(struct buffer_head *map[], unsigned blocksize, __u32 numbits)\n{\n\t__u32 sum = 0;\n\tunsigned blocks = DIV_ROUND_UP(numbits, blocksize * 8);\n\n\twhile (blocks--) {\n\t\tunsigned words = blocksize / 2;\n\t\t__u16 *p = (__u16 *)(*map++)->b_data;\n\t\twhile (words--)\n\t\t\tsum += 16 - hweight16(*p++);\n\t}\n\n\treturn sum;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include \"minix.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic __u32 count_free(struct buffer_head *map[], unsigned blocksize, __u32 numbits)\n{\n\t__u32 sum = 0;\n\tunsigned blocks = DIV_ROUND_UP(numbits, blocksize * 8);\n\n\twhile (blocks--) {\n\t\tunsigned words = blocksize / 2;\n\t\t__u16 *p = (__u16 *)(*map++)->b_data;\n\t\twhile (words--)\n\t\t\tsum += 16 - hweight16(*p++);\n\t}\n\n\treturn sum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "sb"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nunsigned long minix_count_free_blocks(struct super_block *sb)\n{\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tu32 bits = sbi->s_nzones - sbi->s_firstdatazone + 1;\n\n\treturn (count_free(sbi->s_zmap, sb->s_blocksize, bits)\n\t\t<< sbi->s_log_zone_size);\n}"
  },
  {
    "function_name": "minix_new_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "70-94",
    "snippet": "int minix_new_block(struct inode * inode)\n{\n\tstruct minix_sb_info *sbi = minix_sb(inode->i_sb);\n\tint bits_per_zone = 8 * inode->i_sb->s_blocksize;\n\tint i;\n\n\tfor (i = 0; i < sbi->s_zmap_blocks; i++) {\n\t\tstruct buffer_head *bh = sbi->s_zmap[i];\n\t\tint j;\n\n\t\tspin_lock(&bitmap_lock);\n\t\tj = minix_find_first_zero_bit(bh->b_data, bits_per_zone);\n\t\tif (j < bits_per_zone) {\n\t\t\tminix_set_bit(j, bh->b_data);\n\t\t\tspin_unlock(&bitmap_lock);\n\t\t\tmark_buffer_dirty(bh);\n\t\t\tj += i * bits_per_zone + sbi->s_firstdatazone-1;\n\t\t\tif (j < sbi->s_firstdatazone || j >= sbi->s_nzones)\n\t\t\t\tbreak;\n\t\t\treturn j;\n\t\t}\n\t\tspin_unlock(&bitmap_lock);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(bitmap_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_set_bit",
          "args": [
            "j",
            "bh->b_data"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minix_find_first_zero_bit",
          "args": [
            "bh->b_data",
            "bits_per_zone"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "minix_find_first_zero_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "124-140",
          "snippet": "static inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define minix_find_first_zero_bit\tfind_first_zero_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\n#define minix_find_first_zero_bit\tfind_first_zero_bit_le\n\nstatic inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "inode->i_sb"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic DEFINE_SPINLOCK(bitmap_lock);\n\nint minix_new_block(struct inode * inode)\n{\n\tstruct minix_sb_info *sbi = minix_sb(inode->i_sb);\n\tint bits_per_zone = 8 * inode->i_sb->s_blocksize;\n\tint i;\n\n\tfor (i = 0; i < sbi->s_zmap_blocks; i++) {\n\t\tstruct buffer_head *bh = sbi->s_zmap[i];\n\t\tint j;\n\n\t\tspin_lock(&bitmap_lock);\n\t\tj = minix_find_first_zero_bit(bh->b_data, bits_per_zone);\n\t\tif (j < bits_per_zone) {\n\t\t\tminix_set_bit(j, bh->b_data);\n\t\t\tspin_unlock(&bitmap_lock);\n\t\t\tmark_buffer_dirty(bh);\n\t\t\tj += i * bits_per_zone + sbi->s_firstdatazone-1;\n\t\t\tif (j < sbi->s_firstdatazone || j >= sbi->s_nzones)\n\t\t\t\tbreak;\n\t\t\treturn j;\n\t\t}\n\t\tspin_unlock(&bitmap_lock);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "minix_free_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "41-68",
    "snippet": "void minix_free_block(struct inode *inode, unsigned long block)\n{\n\tstruct super_block *sb = inode->i_sb;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct buffer_head *bh;\n\tint k = sb->s_blocksize_bits + 3;\n\tunsigned long bit, zone;\n\n\tif (block < sbi->s_firstdatazone || block >= sbi->s_nzones) {\n\t\tprintk(\"Trying to free block not in datazone\\n\");\n\t\treturn;\n\t}\n\tzone = block - sbi->s_firstdatazone + 1;\n\tbit = zone & ((1<<k) - 1);\n\tzone >>= k;\n\tif (zone >= sbi->s_zmap_blocks) {\n\t\tprintk(\"minix_free_block: nonexistent bitmap buffer\\n\");\n\t\treturn;\n\t}\n\tbh = sbi->s_zmap[zone];\n\tspin_lock(&bitmap_lock);\n\tif (!minix_test_and_clear_bit(bit, bh->b_data))\n\t\tprintk(\"minix_free_block (%s:%lu): bit already cleared\\n\",\n\t\t       sb->s_id, block);\n\tspin_unlock(&bitmap_lock);\n\tmark_buffer_dirty(bh);\n\treturn;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(bitmap_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"minix_free_block (%s:%lu): bit already cleared\\n\"",
            "sb->s_id",
            "block"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_test_and_clear_bit",
          "args": [
            "bit",
            "bh->b_data"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&bitmap_lock"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "minix_sb",
          "args": [
            "sb"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "minix_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "80-83",
          "snippet": "static inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\nstatic inline struct minix_sb_info *minix_sb(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic DEFINE_SPINLOCK(bitmap_lock);\n\nvoid minix_free_block(struct inode *inode, unsigned long block)\n{\n\tstruct super_block *sb = inode->i_sb;\n\tstruct minix_sb_info *sbi = minix_sb(sb);\n\tstruct buffer_head *bh;\n\tint k = sb->s_blocksize_bits + 3;\n\tunsigned long bit, zone;\n\n\tif (block < sbi->s_firstdatazone || block >= sbi->s_nzones) {\n\t\tprintk(\"Trying to free block not in datazone\\n\");\n\t\treturn;\n\t}\n\tzone = block - sbi->s_firstdatazone + 1;\n\tbit = zone & ((1<<k) - 1);\n\tzone >>= k;\n\tif (zone >= sbi->s_zmap_blocks) {\n\t\tprintk(\"minix_free_block: nonexistent bitmap buffer\\n\");\n\t\treturn;\n\t}\n\tbh = sbi->s_zmap[zone];\n\tspin_lock(&bitmap_lock);\n\tif (!minix_test_and_clear_bit(bit, bh->b_data))\n\t\tprintk(\"minix_free_block (%s:%lu): bit already cleared\\n\",\n\t\t       sb->s_id, block);\n\tspin_unlock(&bitmap_lock);\n\tmark_buffer_dirty(bh);\n\treturn;\n}"
  },
  {
    "function_name": "count_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/bitmap.c",
    "lines": "26-39",
    "snippet": "static __u32 count_free(struct buffer_head *map[], unsigned blocksize, __u32 numbits)\n{\n\t__u32 sum = 0;\n\tunsigned blocks = DIV_ROUND_UP(numbits, blocksize * 8);\n\n\twhile (blocks--) {\n\t\tunsigned words = blocksize / 2;\n\t\t__u16 *p = (__u16 *)(*map++)->b_data;\n\t\twhile (words--)\n\t\t\tsum += 16 - hweight16(*p++);\n\t}\n\n\treturn sum;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/bitops.h>",
      "#include <linux/buffer_head.h>",
      "#include \"minix.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hweight16",
          "args": [
            "*p++"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "numbits",
            "blocksize * 8"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include \"minix.h\"\n\nstatic __u32 count_free(struct buffer_head *map[], unsigned blocksize, __u32 numbits)\n{\n\t__u32 sum = 0;\n\tunsigned blocks = DIV_ROUND_UP(numbits, blocksize * 8);\n\n\twhile (blocks--) {\n\t\tunsigned words = blocksize / 2;\n\t\t__u16 *p = (__u16 *)(*map++)->b_data;\n\t\twhile (words--)\n\t\t\tsum += 16 - hweight16(*p++);\n\t}\n\n\treturn sum;\n}"
  }
]