[
  {
    "function_name": "do_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "391-415",
    "snippet": "int do_statfs(char *root, long *bsize_out, long long *blocks_out,\n\t      long long *bfree_out, long long *bavail_out,\n\t      long long *files_out, long long *ffree_out,\n\t      void *fsid_out, int fsid_size, long *namelen_out)\n{\n\tstruct statfs64 buf;\n\tint err;\n\n\terr = statfs64(root, &buf);\n\tif (err < 0)\n\t\treturn -errno;\n\n\t*bsize_out = buf.f_bsize;\n\t*blocks_out = buf.f_blocks;\n\t*bfree_out = buf.f_bfree;\n\t*bavail_out = buf.f_bavail;\n\t*files_out = buf.f_files;\n\t*ffree_out = buf.f_ffree;\n\tmemcpy(fsid_out, &buf.f_fsid,\n\t       sizeof(buf.f_fsid) > fsid_size ? fsid_size :\n\t       sizeof(buf.f_fsid));\n\t*namelen_out = buf.f_namelen;\n\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fsid_out",
            "&buf.f_fsid",
            "sizeof(buf.f_fsid) > fsid_size ? fsid_size :\n\t       sizeof(buf.f_fsid)"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "statfs64",
          "args": [
            "root",
            "&buf"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "put_compat_statfs64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "268-299",
          "snippet": "static int put_compat_statfs64(struct compat_statfs64 __user *ubuf, struct kstatfs *kbuf)\n{\n\tif (sizeof ubuf->f_blocks == 4) {\n\t\tif ((kbuf->f_blocks | kbuf->f_bfree | kbuf->f_bavail |\n\t\t     kbuf->f_bsize | kbuf->f_frsize) & 0xffffffff00000000ULL)\n\t\t\treturn -EOVERFLOW;\n\t\t/* f_files and f_ffree may be -1; it's okay\n\t\t * to stuff that into 32 bits */\n\t\tif (kbuf->f_files != 0xffffffffffffffffULL\n\t\t && (kbuf->f_files & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t\tif (kbuf->f_ffree != 0xffffffffffffffffULL\n\t\t && (kbuf->f_ffree & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t}\n\tif (!access_ok(VERIFY_WRITE, ubuf, sizeof(*ubuf)) ||\n\t    __put_user(kbuf->f_type, &ubuf->f_type) ||\n\t    __put_user(kbuf->f_bsize, &ubuf->f_bsize) ||\n\t    __put_user(kbuf->f_blocks, &ubuf->f_blocks) ||\n\t    __put_user(kbuf->f_bfree, &ubuf->f_bfree) ||\n\t    __put_user(kbuf->f_bavail, &ubuf->f_bavail) ||\n\t    __put_user(kbuf->f_files, &ubuf->f_files) ||\n\t    __put_user(kbuf->f_ffree, &ubuf->f_ffree) ||\n\t    __put_user(kbuf->f_namelen, &ubuf->f_namelen) ||\n\t    __put_user(kbuf->f_fsid.val[0], &ubuf->f_fsid.val[0]) ||\n\t    __put_user(kbuf->f_fsid.val[1], &ubuf->f_fsid.val[1]) ||\n\t    __put_user(kbuf->f_frsize, &ubuf->f_frsize) ||\n\t    __put_user(kbuf->f_flags, &ubuf->f_flags) ||\n\t    __clear_user(ubuf->f_spare, sizeof(ubuf->f_spare)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int put_compat_statfs64(struct compat_statfs64 __user *ubuf, struct kstatfs *kbuf)\n{\n\tif (sizeof ubuf->f_blocks == 4) {\n\t\tif ((kbuf->f_blocks | kbuf->f_bfree | kbuf->f_bavail |\n\t\t     kbuf->f_bsize | kbuf->f_frsize) & 0xffffffff00000000ULL)\n\t\t\treturn -EOVERFLOW;\n\t\t/* f_files and f_ffree may be -1; it's okay\n\t\t * to stuff that into 32 bits */\n\t\tif (kbuf->f_files != 0xffffffffffffffffULL\n\t\t && (kbuf->f_files & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t\tif (kbuf->f_ffree != 0xffffffffffffffffULL\n\t\t && (kbuf->f_ffree & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t}\n\tif (!access_ok(VERIFY_WRITE, ubuf, sizeof(*ubuf)) ||\n\t    __put_user(kbuf->f_type, &ubuf->f_type) ||\n\t    __put_user(kbuf->f_bsize, &ubuf->f_bsize) ||\n\t    __put_user(kbuf->f_blocks, &ubuf->f_blocks) ||\n\t    __put_user(kbuf->f_bfree, &ubuf->f_bfree) ||\n\t    __put_user(kbuf->f_bavail, &ubuf->f_bavail) ||\n\t    __put_user(kbuf->f_files, &ubuf->f_files) ||\n\t    __put_user(kbuf->f_ffree, &ubuf->f_ffree) ||\n\t    __put_user(kbuf->f_namelen, &ubuf->f_namelen) ||\n\t    __put_user(kbuf->f_fsid.val[0], &ubuf->f_fsid.val[0]) ||\n\t    __put_user(kbuf->f_fsid.val[1], &ubuf->f_fsid.val[1]) ||\n\t    __put_user(kbuf->f_frsize, &ubuf->f_frsize) ||\n\t    __put_user(kbuf->f_flags, &ubuf->f_flags) ||\n\t    __clear_user(ubuf->f_spare, sizeof(ubuf->f_spare)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint do_statfs(char *root, long *bsize_out, long long *blocks_out,\n\t      long long *bfree_out, long long *bavail_out,\n\t      long long *files_out, long long *ffree_out,\n\t      void *fsid_out, int fsid_size, long *namelen_out)\n{\n\tstruct statfs64 buf;\n\tint err;\n\n\terr = statfs64(root, &buf);\n\tif (err < 0)\n\t\treturn -errno;\n\n\t*bsize_out = buf.f_bsize;\n\t*blocks_out = buf.f_blocks;\n\t*bfree_out = buf.f_bfree;\n\t*bavail_out = buf.f_bavail;\n\t*files_out = buf.f_files;\n\t*ffree_out = buf.f_ffree;\n\tmemcpy(fsid_out, &buf.f_fsid,\n\t       sizeof(buf.f_fsid) > fsid_size ? fsid_size :\n\t       sizeof(buf.f_fsid));\n\t*namelen_out = buf.f_namelen;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rename2_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "364-389",
    "snippet": "int rename2_file(char *from, char *to, unsigned int flags)\n{\n\tint err;\n\n#ifndef SYS_renameat2\n#  ifdef __x86_64__\n#    define SYS_renameat2 316\n#  endif\n#  ifdef __i386__\n#    define SYS_renameat2 353\n#  endif\n#endif\n\n#ifdef SYS_renameat2\n\terr = syscall(SYS_renameat2, AT_FDCWD, from, AT_FDCWD, to, flags);\n\tif (err < 0) {\n\t\tif (errno != ENOSYS)\n\t\t\treturn -errno;\n\t\telse\n\t\t\treturn -EINVAL;\n\t}\n\treturn 0;\n#else\n\treturn -EINVAL;\n#endif\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_renameat2",
            "AT_FDCWD",
            "from",
            "AT_FDCWD",
            "to",
            "flags"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint rename2_file(char *from, char *to, unsigned int flags)\n{\n\tint err;\n\n#ifndef SYS_renameat2\n#  ifdef __x86_64__\n#    define SYS_renameat2 316\n#  endif\n#  ifdef __i386__\n#    define SYS_renameat2 353\n#  endif\n#endif\n\n#ifdef SYS_renameat2\n\terr = syscall(SYS_renameat2, AT_FDCWD, from, AT_FDCWD, to, flags);\n\tif (err < 0) {\n\t\tif (errno != ENOSYS)\n\t\t\treturn -errno;\n\t\telse\n\t\t\treturn -EINVAL;\n\t}\n\treturn 0;\n#else\n\treturn -EINVAL;\n#endif\n}"
  },
  {
    "function_name": "rename_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "354-362",
    "snippet": "int rename_file(char *from, char *to)\n{\n\tint err;\n\n\terr = rename(from, to);\n\tif (err < 0)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "from",
            "to"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "rename_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "354-362",
          "snippet": "int rename_file(char *from, char *to)\n{\n\tint err;\n\n\terr = rename(from, to);\n\tif (err < 0)\n\t\treturn -errno;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint rename_file(char *from, char *to)\n{\n\tint err;\n\n\terr = rename(from, to);\n\tif (err < 0)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "hostfs_do_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "342-352",
    "snippet": "int hostfs_do_readlink(char *file, char *buf, int size)\n{\n\tint n;\n\n\tn = readlink(file, buf, size);\n\tif (n < 0)\n\t\treturn -errno;\n\tif (n < size)\n\t\tbuf[n] = '\\0';\n\treturn n;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "readlink",
          "args": [
            "file",
            "buf",
            "size"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "hostfs_do_readlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "342-352",
          "snippet": "int hostfs_do_readlink(char *file, char *buf, int size)\n{\n\tint n;\n\n\tn = readlink(file, buf, size);\n\tif (n < 0)\n\t\treturn -errno;\n\tif (n < size)\n\t\tbuf[n] = '\\0';\n\treturn n;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint hostfs_do_readlink(char *file, char *buf, int size)\n{\n\tint n;\n\n\tn = readlink(file, buf, size);\n\tif (n < 0)\n\t\treturn -errno;\n\tif (n < size)\n\t\tbuf[n] = '\\0';\n\treturn n;\n}"
  },
  {
    "function_name": "link_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "332-340",
    "snippet": "int link_file(const char *to, const char *from)\n{\n\tint err;\n\n\terr = link(to, from);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "link",
          "args": [
            "to",
            "from"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "link_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "332-340",
          "snippet": "int link_file(const char *to, const char *from)\n{\n\tint err;\n\n\terr = link(to, from);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint link_file(const char *to, const char *from)\n{\n\tint err;\n\n\terr = link(to, from);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "do_mknod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "322-330",
    "snippet": "int do_mknod(const char *file, int mode, unsigned int major, unsigned int minor)\n{\n\tint err;\n\n\terr = mknod(file, mode, os_makedev(major, minor));\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mknod",
          "args": [
            "file",
            "mode",
            "os_makedev(major, minor)"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_mknod_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/journal.h",
          "lines": "433-443",
          "snippet": "static inline int ocfs2_mknod_credits(struct super_block *sb, int is_dir,\n\t\t\t\t      int xattr_credits)\n{\n\tint dir_credits = OCFS2_DIR_LINK_ADDITIONAL_CREDITS;\n\n\tif (is_dir)\n\t\tdir_credits += ocfs2_add_dir_index_credits(sb);\n\n\treturn 4 + OCFS2_SUBALLOC_ALLOC + dir_credits + xattr_credits +\n\t       ocfs2_quota_trans_credits(sb);\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_DIR_LINK_ADDITIONAL_CREDITS (1 + OCFS2_SUBALLOC_ALLOC + 1)",
            "#define OCFS2_SUBALLOC_ALLOC (3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_DIR_LINK_ADDITIONAL_CREDITS (1 + OCFS2_SUBALLOC_ALLOC + 1)\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_mknod_credits(struct super_block *sb, int is_dir,\n\t\t\t\t      int xattr_credits)\n{\n\tint dir_credits = OCFS2_DIR_LINK_ADDITIONAL_CREDITS;\n\n\tif (is_dir)\n\t\tdir_credits += ocfs2_add_dir_index_credits(sb);\n\n\treturn 4 + OCFS2_SUBALLOC_ALLOC + dir_credits + xattr_credits +\n\t       ocfs2_quota_trans_credits(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "os_makedev",
          "args": [
            "major",
            "minor"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint do_mknod(const char *file, int mode, unsigned int major, unsigned int minor)\n{\n\tint err;\n\n\terr = mknod(file, mode, os_makedev(major, minor));\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "do_rmdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "312-320",
    "snippet": "int do_rmdir(const char *file)\n{\n\tint err;\n\n\terr = rmdir(file);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "file"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "do_rmdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "312-320",
          "snippet": "int do_rmdir(const char *file)\n{\n\tint err;\n\n\terr = rmdir(file);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint do_rmdir(const char *file)\n{\n\tint err;\n\n\terr = rmdir(file);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "do_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "302-310",
    "snippet": "int do_mkdir(const char *file, int mode)\n{\n\tint err;\n\n\terr = mkdir(file, mode);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "file",
            "mode"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "do_mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "302-310",
          "snippet": "int do_mkdir(const char *file, int mode)\n{\n\tint err;\n\n\terr = mkdir(file, mode);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint do_mkdir(const char *file, int mode)\n{\n\tint err;\n\n\terr = mkdir(file, mode);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "unlink_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "292-300",
    "snippet": "int unlink_file(const char *file)\n{\n\tint err;\n\n\terr = unlink(file);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "file"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "unlink_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "292-300",
          "snippet": "int unlink_file(const char *file)\n{\n\tint err;\n\n\terr = unlink(file);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint unlink_file(const char *file)\n{\n\tint err;\n\n\terr = unlink(file);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "make_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "282-290",
    "snippet": "int make_symlink(const char *from, const char *to)\n{\n\tint err;\n\n\terr = symlink(to, from);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "symlink",
          "args": [
            "to",
            "from"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "make_symlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "282-290",
          "snippet": "int make_symlink(const char *from, const char *to)\n{\n\tint err;\n\n\terr = symlink(to, from);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint make_symlink(const char *from, const char *to)\n{\n\tint err;\n\n\terr = symlink(to, from);\n\tif (err)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "set_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "199-280",
    "snippet": "int set_attr(const char *file, struct hostfs_iattr *attrs, int fd)\n{\n\tstruct hostfs_stat st;\n\tstruct timeval times[2];\n\tint err, ma;\n\n\tif (attrs->ia_valid & HOSTFS_ATTR_MODE) {\n\t\tif (fd >= 0) {\n\t\t\tif (fchmod(fd, attrs->ia_mode) != 0)\n\t\t\t\treturn -errno;\n\t\t} else if (chmod(file, attrs->ia_mode) != 0) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\tif (attrs->ia_valid & HOSTFS_ATTR_UID) {\n\t\tif (fd >= 0) {\n\t\t\tif (fchown(fd, attrs->ia_uid, -1))\n\t\t\t\treturn -errno;\n\t\t} else if (chown(file, attrs->ia_uid, -1)) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\tif (attrs->ia_valid & HOSTFS_ATTR_GID) {\n\t\tif (fd >= 0) {\n\t\t\tif (fchown(fd, -1, attrs->ia_gid))\n\t\t\t\treturn -errno;\n\t\t} else if (chown(file, -1, attrs->ia_gid)) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\tif (attrs->ia_valid & HOSTFS_ATTR_SIZE) {\n\t\tif (fd >= 0) {\n\t\t\tif (ftruncate(fd, attrs->ia_size))\n\t\t\t\treturn -errno;\n\t\t} else if (truncate(file, attrs->ia_size)) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\n\t/*\n\t * Update accessed and/or modified time, in two parts: first set\n\t * times according to the changes to perform, and then call futimes()\n\t * or utimes() to apply them.\n\t */\n\tma = (HOSTFS_ATTR_ATIME_SET | HOSTFS_ATTR_MTIME_SET);\n\tif (attrs->ia_valid & ma) {\n\t\terr = stat_file(file, &st, fd);\n\t\tif (err != 0)\n\t\t\treturn err;\n\n\t\ttimes[0].tv_sec = st.atime.tv_sec;\n\t\ttimes[0].tv_usec = st.atime.tv_nsec / 1000;\n\t\ttimes[1].tv_sec = st.mtime.tv_sec;\n\t\ttimes[1].tv_usec = st.mtime.tv_nsec / 1000;\n\n\t\tif (attrs->ia_valid & HOSTFS_ATTR_ATIME_SET) {\n\t\t\ttimes[0].tv_sec = attrs->ia_atime.tv_sec;\n\t\t\ttimes[0].tv_usec = attrs->ia_atime.tv_nsec / 1000;\n\t\t}\n\t\tif (attrs->ia_valid & HOSTFS_ATTR_MTIME_SET) {\n\t\t\ttimes[1].tv_sec = attrs->ia_mtime.tv_sec;\n\t\t\ttimes[1].tv_usec = attrs->ia_mtime.tv_nsec / 1000;\n\t\t}\n\n\t\tif (fd >= 0) {\n\t\t\tif (futimes(fd, times) != 0)\n\t\t\t\treturn -errno;\n\t\t} else if (utimes(file, times) != 0) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\n\t/* Note: ctime is not handled */\n\tif (attrs->ia_valid & (HOSTFS_ATTR_ATIME | HOSTFS_ATTR_MTIME)) {\n\t\terr = stat_file(file, &st, fd);\n\t\tattrs->ia_atime = st.atime;\n\t\tattrs->ia_mtime = st.mtime;\n\t\tif (err != 0)\n\t\t\treturn err;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stat_file",
          "args": [
            "file",
            "&st",
            "fd"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "stat_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "41-53",
          "snippet": "int stat_file(const char *path, struct hostfs_stat *p, int fd)\n{\n\tstruct stat64 buf;\n\n\tif (fd >= 0) {\n\t\tif (fstat64(fd, &buf) < 0)\n\t\t\treturn -errno;\n\t} else if (lstat64(path, &buf) < 0) {\n\t\treturn -errno;\n\t}\n\tstat64_to_hostfs(&buf, p);\n\treturn 0;\n}",
          "includes": [
            "#include <utime.h>",
            "#include \"hostfs.h\"",
            "#include <sys/syscall.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <stddef.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint stat_file(const char *path, struct hostfs_stat *p, int fd)\n{\n\tstruct stat64 buf;\n\n\tif (fd >= 0) {\n\t\tif (fstat64(fd, &buf) < 0)\n\t\t\treturn -errno;\n\t} else if (lstat64(path, &buf) < 0) {\n\t\treturn -errno;\n\t}\n\tstat64_to_hostfs(&buf, p);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "utimes",
          "args": [
            "file",
            "times"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "utimes_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/utimes.c",
          "lines": "51-119",
          "snippet": "static int utimes_common(struct path *path, struct timespec *times)\n{\n\tint error;\n\tstruct iattr newattrs;\n\tstruct inode *inode = path->dentry->d_inode;\n\tstruct inode *delegated_inode = NULL;\n\n\terror = mnt_want_write(path->mnt);\n\tif (error)\n\t\tgoto out;\n\n\tif (times && times[0].tv_nsec == UTIME_NOW &&\n\t\t     times[1].tv_nsec == UTIME_NOW)\n\t\ttimes = NULL;\n\n\tnewattrs.ia_valid = ATTR_CTIME | ATTR_MTIME | ATTR_ATIME;\n\tif (times) {\n\t\tif (times[0].tv_nsec == UTIME_OMIT)\n\t\t\tnewattrs.ia_valid &= ~ATTR_ATIME;\n\t\telse if (times[0].tv_nsec != UTIME_NOW) {\n\t\t\tnewattrs.ia_atime.tv_sec = times[0].tv_sec;\n\t\t\tnewattrs.ia_atime.tv_nsec = times[0].tv_nsec;\n\t\t\tnewattrs.ia_valid |= ATTR_ATIME_SET;\n\t\t}\n\n\t\tif (times[1].tv_nsec == UTIME_OMIT)\n\t\t\tnewattrs.ia_valid &= ~ATTR_MTIME;\n\t\telse if (times[1].tv_nsec != UTIME_NOW) {\n\t\t\tnewattrs.ia_mtime.tv_sec = times[1].tv_sec;\n\t\t\tnewattrs.ia_mtime.tv_nsec = times[1].tv_nsec;\n\t\t\tnewattrs.ia_valid |= ATTR_MTIME_SET;\n\t\t}\n\t\t/*\n\t\t * Tell inode_change_ok(), that this is an explicit time\n\t\t * update, even if neither ATTR_ATIME_SET nor ATTR_MTIME_SET\n\t\t * were used.\n\t\t */\n\t\tnewattrs.ia_valid |= ATTR_TIMES_SET;\n\t} else {\n\t\t/*\n\t\t * If times is NULL (or both times are UTIME_NOW),\n\t\t * then we need to check permissions, because\n\t\t * inode_change_ok() won't do it.\n\t\t */\n\t\terror = -EACCES;\n                if (IS_IMMUTABLE(inode))\n\t\t\tgoto mnt_drop_write_and_out;\n\n\t\tif (!inode_owner_or_capable(inode)) {\n\t\t\terror = inode_permission(inode, MAY_WRITE);\n\t\t\tif (error)\n\t\t\t\tgoto mnt_drop_write_and_out;\n\t\t}\n\t}\nretry_deleg:\n\tmutex_lock(&inode->i_mutex);\n\terror = notify_change(path->dentry, &newattrs, &delegated_inode);\n\tmutex_unlock(&inode->i_mutex);\n\tif (delegated_inode) {\n\t\terror = break_deleg_wait(&delegated_inode);\n\t\tif (!error)\n\t\t\tgoto retry_deleg;\n\t}\n\nmnt_drop_write_and_out:\n\tmnt_drop_write(path->mnt);\nout:\n\treturn error;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/utime.h>",
            "#include <linux/stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/linkage.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/utime.h>\n#include <linux/stat.h>\n#include <linux/sched.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/linkage.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/compiler.h>\n\nstatic int utimes_common(struct path *path, struct timespec *times)\n{\n\tint error;\n\tstruct iattr newattrs;\n\tstruct inode *inode = path->dentry->d_inode;\n\tstruct inode *delegated_inode = NULL;\n\n\terror = mnt_want_write(path->mnt);\n\tif (error)\n\t\tgoto out;\n\n\tif (times && times[0].tv_nsec == UTIME_NOW &&\n\t\t     times[1].tv_nsec == UTIME_NOW)\n\t\ttimes = NULL;\n\n\tnewattrs.ia_valid = ATTR_CTIME | ATTR_MTIME | ATTR_ATIME;\n\tif (times) {\n\t\tif (times[0].tv_nsec == UTIME_OMIT)\n\t\t\tnewattrs.ia_valid &= ~ATTR_ATIME;\n\t\telse if (times[0].tv_nsec != UTIME_NOW) {\n\t\t\tnewattrs.ia_atime.tv_sec = times[0].tv_sec;\n\t\t\tnewattrs.ia_atime.tv_nsec = times[0].tv_nsec;\n\t\t\tnewattrs.ia_valid |= ATTR_ATIME_SET;\n\t\t}\n\n\t\tif (times[1].tv_nsec == UTIME_OMIT)\n\t\t\tnewattrs.ia_valid &= ~ATTR_MTIME;\n\t\telse if (times[1].tv_nsec != UTIME_NOW) {\n\t\t\tnewattrs.ia_mtime.tv_sec = times[1].tv_sec;\n\t\t\tnewattrs.ia_mtime.tv_nsec = times[1].tv_nsec;\n\t\t\tnewattrs.ia_valid |= ATTR_MTIME_SET;\n\t\t}\n\t\t/*\n\t\t * Tell inode_change_ok(), that this is an explicit time\n\t\t * update, even if neither ATTR_ATIME_SET nor ATTR_MTIME_SET\n\t\t * were used.\n\t\t */\n\t\tnewattrs.ia_valid |= ATTR_TIMES_SET;\n\t} else {\n\t\t/*\n\t\t * If times is NULL (or both times are UTIME_NOW),\n\t\t * then we need to check permissions, because\n\t\t * inode_change_ok() won't do it.\n\t\t */\n\t\terror = -EACCES;\n                if (IS_IMMUTABLE(inode))\n\t\t\tgoto mnt_drop_write_and_out;\n\n\t\tif (!inode_owner_or_capable(inode)) {\n\t\t\terror = inode_permission(inode, MAY_WRITE);\n\t\t\tif (error)\n\t\t\t\tgoto mnt_drop_write_and_out;\n\t\t}\n\t}\nretry_deleg:\n\tmutex_lock(&inode->i_mutex);\n\terror = notify_change(path->dentry, &newattrs, &delegated_inode);\n\tmutex_unlock(&inode->i_mutex);\n\tif (delegated_inode) {\n\t\terror = break_deleg_wait(&delegated_inode);\n\t\tif (!error)\n\t\t\tgoto retry_deleg;\n\t}\n\nmnt_drop_write_and_out:\n\tmnt_drop_write(path->mnt);\nout:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "futimes",
          "args": [
            "fd",
            "times"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "truncate",
          "args": [
            "file",
            "attrs->ia_size"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "do_sys_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/open.c",
          "lines": "118-138",
          "snippet": "static long do_sys_truncate(const char __user *pathname, loff_t length)\n{\n\tunsigned int lookup_flags = LOOKUP_FOLLOW;\n\tstruct path path;\n\tint error;\n\n\tif (length < 0)\t/* sorry, but loff_t says... */\n\t\treturn -EINVAL;\n\nretry:\n\terror = user_path_at(AT_FDCWD, pathname, lookup_flags, &path);\n\tif (!error) {\n\t\terror = vfs_truncate(&path, length);\n\t\tpath_put(&path);\n\t}\n\tif (retry_estale(error, lookup_flags)) {\n\t\tlookup_flags |= LOOKUP_REVAL;\n\t\tgoto retry;\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/dnotify.h>",
            "#include <linux/ima.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/falloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mount.h>",
            "#include <linux/security.h>",
            "#include <linux/securebits.h>",
            "#include <linux/capability.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/namei.h>",
            "#include <linux/tty.h>",
            "#include <linux/module.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/dnotify.h>\n#include <linux/ima.h>\n#include <linux/fs_struct.h>\n#include <linux/falloc.h>\n#include <linux/audit.h>\n#include <linux/rcupdate.h>\n#include <linux/syscalls.h>\n#include <linux/pagemap.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mount.h>\n#include <linux/security.h>\n#include <linux/securebits.h>\n#include <linux/capability.h>\n#include <linux/backing-dev.h>\n#include <linux/namei.h>\n#include <linux/tty.h>\n#include <linux/module.h>\n#include <linux/fsnotify.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n\nstatic long do_sys_truncate(const char __user *pathname, loff_t length)\n{\n\tunsigned int lookup_flags = LOOKUP_FOLLOW;\n\tstruct path path;\n\tint error;\n\n\tif (length < 0)\t/* sorry, but loff_t says... */\n\t\treturn -EINVAL;\n\nretry:\n\terror = user_path_at(AT_FDCWD, pathname, lookup_flags, &path);\n\tif (!error) {\n\t\terror = vfs_truncate(&path, length);\n\t\tpath_put(&path);\n\t}\n\tif (retry_estale(error, lookup_flags)) {\n\t\tlookup_flags |= LOOKUP_REVAL;\n\t\tgoto retry;\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftruncate",
          "args": [
            "fd",
            "attrs->ia_size"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "file",
            "-1",
            "attrs->ia_gid"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "chown_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/open.c",
          "lines": "561-601",
          "snippet": "static int chown_common(struct path *path, uid_t user, gid_t group)\n{\n\tstruct inode *inode = path->dentry->d_inode;\n\tstruct inode *delegated_inode = NULL;\n\tint error;\n\tstruct iattr newattrs;\n\tkuid_t uid;\n\tkgid_t gid;\n\n\tuid = make_kuid(current_user_ns(), user);\n\tgid = make_kgid(current_user_ns(), group);\n\n\tnewattrs.ia_valid =  ATTR_CTIME;\n\tif (user != (uid_t) -1) {\n\t\tif (!uid_valid(uid))\n\t\t\treturn -EINVAL;\n\t\tnewattrs.ia_valid |= ATTR_UID;\n\t\tnewattrs.ia_uid = uid;\n\t}\n\tif (group != (gid_t) -1) {\n\t\tif (!gid_valid(gid))\n\t\t\treturn -EINVAL;\n\t\tnewattrs.ia_valid |= ATTR_GID;\n\t\tnewattrs.ia_gid = gid;\n\t}\n\tif (!S_ISDIR(inode->i_mode))\n\t\tnewattrs.ia_valid |=\n\t\t\tATTR_KILL_SUID | ATTR_KILL_SGID | ATTR_KILL_PRIV;\nretry_deleg:\n\tmutex_lock(&inode->i_mutex);\n\terror = security_path_chown(path, uid, gid);\n\tif (!error)\n\t\terror = notify_change(path->dentry, &newattrs, &delegated_inode);\n\tmutex_unlock(&inode->i_mutex);\n\tif (delegated_inode) {\n\t\terror = break_deleg_wait(&delegated_inode);\n\t\tif (!error)\n\t\t\tgoto retry_deleg;\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/dnotify.h>",
            "#include <linux/ima.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/falloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mount.h>",
            "#include <linux/security.h>",
            "#include <linux/securebits.h>",
            "#include <linux/capability.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/namei.h>",
            "#include <linux/tty.h>",
            "#include <linux/module.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/dnotify.h>\n#include <linux/ima.h>\n#include <linux/fs_struct.h>\n#include <linux/falloc.h>\n#include <linux/audit.h>\n#include <linux/rcupdate.h>\n#include <linux/syscalls.h>\n#include <linux/pagemap.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mount.h>\n#include <linux/security.h>\n#include <linux/securebits.h>\n#include <linux/capability.h>\n#include <linux/backing-dev.h>\n#include <linux/namei.h>\n#include <linux/tty.h>\n#include <linux/module.h>\n#include <linux/fsnotify.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n\nstatic int chown_common(struct path *path, uid_t user, gid_t group)\n{\n\tstruct inode *inode = path->dentry->d_inode;\n\tstruct inode *delegated_inode = NULL;\n\tint error;\n\tstruct iattr newattrs;\n\tkuid_t uid;\n\tkgid_t gid;\n\n\tuid = make_kuid(current_user_ns(), user);\n\tgid = make_kgid(current_user_ns(), group);\n\n\tnewattrs.ia_valid =  ATTR_CTIME;\n\tif (user != (uid_t) -1) {\n\t\tif (!uid_valid(uid))\n\t\t\treturn -EINVAL;\n\t\tnewattrs.ia_valid |= ATTR_UID;\n\t\tnewattrs.ia_uid = uid;\n\t}\n\tif (group != (gid_t) -1) {\n\t\tif (!gid_valid(gid))\n\t\t\treturn -EINVAL;\n\t\tnewattrs.ia_valid |= ATTR_GID;\n\t\tnewattrs.ia_gid = gid;\n\t}\n\tif (!S_ISDIR(inode->i_mode))\n\t\tnewattrs.ia_valid |=\n\t\t\tATTR_KILL_SUID | ATTR_KILL_SGID | ATTR_KILL_PRIV;\nretry_deleg:\n\tmutex_lock(&inode->i_mutex);\n\terror = security_path_chown(path, uid, gid);\n\tif (!error)\n\t\terror = notify_change(path->dentry, &newattrs, &delegated_inode);\n\tmutex_unlock(&inode->i_mutex);\n\tif (delegated_inode) {\n\t\terror = break_deleg_wait(&delegated_inode);\n\t\tif (!error)\n\t\t\tgoto retry_deleg;\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fchown",
          "args": [
            "fd",
            "-1",
            "attrs->ia_gid"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fchown",
          "args": [
            "fd",
            "attrs->ia_uid",
            "-1"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chmod",
          "args": [
            "file",
            "attrs->ia_mode"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "posix_acl_chmod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/posix_acl.c",
          "lines": "518-542",
          "snippet": "int\nposix_acl_chmod(struct inode *inode, umode_t mode)\n{\n\tstruct posix_acl *acl;\n\tint ret = 0;\n\n\tif (!IS_POSIXACL(inode))\n\t\treturn 0;\n\tif (!inode->i_op->set_acl)\n\t\treturn -EOPNOTSUPP;\n\n\tacl = get_acl(inode, ACL_TYPE_ACCESS);\n\tif (IS_ERR_OR_NULL(acl)) {\n\t\tif (acl == ERR_PTR(-EOPNOTSUPP))\n\t\t\treturn 0;\n\t\treturn PTR_ERR(acl);\n\t}\n\n\tret = __posix_acl_chmod(&acl, GFP_KERNEL, mode);\n\tif (ret)\n\t\treturn ret;\n\tret = inode->i_op->set_acl(inode, acl, ACL_TYPE_ACCESS);\n\tposix_acl_release(acl);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/xattr.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/xattr.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint\nposix_acl_chmod(struct inode *inode, umode_t mode)\n{\n\tstruct posix_acl *acl;\n\tint ret = 0;\n\n\tif (!IS_POSIXACL(inode))\n\t\treturn 0;\n\tif (!inode->i_op->set_acl)\n\t\treturn -EOPNOTSUPP;\n\n\tacl = get_acl(inode, ACL_TYPE_ACCESS);\n\tif (IS_ERR_OR_NULL(acl)) {\n\t\tif (acl == ERR_PTR(-EOPNOTSUPP))\n\t\t\treturn 0;\n\t\treturn PTR_ERR(acl);\n\t}\n\n\tret = __posix_acl_chmod(&acl, GFP_KERNEL, mode);\n\tif (ret)\n\t\treturn ret;\n\tret = inode->i_op->set_acl(inode, acl, ACL_TYPE_ACCESS);\n\tposix_acl_release(acl);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fchmod",
          "args": [
            "fd",
            "attrs->ia_mode"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint set_attr(const char *file, struct hostfs_iattr *attrs, int fd)\n{\n\tstruct hostfs_stat st;\n\tstruct timeval times[2];\n\tint err, ma;\n\n\tif (attrs->ia_valid & HOSTFS_ATTR_MODE) {\n\t\tif (fd >= 0) {\n\t\t\tif (fchmod(fd, attrs->ia_mode) != 0)\n\t\t\t\treturn -errno;\n\t\t} else if (chmod(file, attrs->ia_mode) != 0) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\tif (attrs->ia_valid & HOSTFS_ATTR_UID) {\n\t\tif (fd >= 0) {\n\t\t\tif (fchown(fd, attrs->ia_uid, -1))\n\t\t\t\treturn -errno;\n\t\t} else if (chown(file, attrs->ia_uid, -1)) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\tif (attrs->ia_valid & HOSTFS_ATTR_GID) {\n\t\tif (fd >= 0) {\n\t\t\tif (fchown(fd, -1, attrs->ia_gid))\n\t\t\t\treturn -errno;\n\t\t} else if (chown(file, -1, attrs->ia_gid)) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\tif (attrs->ia_valid & HOSTFS_ATTR_SIZE) {\n\t\tif (fd >= 0) {\n\t\t\tif (ftruncate(fd, attrs->ia_size))\n\t\t\t\treturn -errno;\n\t\t} else if (truncate(file, attrs->ia_size)) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\n\t/*\n\t * Update accessed and/or modified time, in two parts: first set\n\t * times according to the changes to perform, and then call futimes()\n\t * or utimes() to apply them.\n\t */\n\tma = (HOSTFS_ATTR_ATIME_SET | HOSTFS_ATTR_MTIME_SET);\n\tif (attrs->ia_valid & ma) {\n\t\terr = stat_file(file, &st, fd);\n\t\tif (err != 0)\n\t\t\treturn err;\n\n\t\ttimes[0].tv_sec = st.atime.tv_sec;\n\t\ttimes[0].tv_usec = st.atime.tv_nsec / 1000;\n\t\ttimes[1].tv_sec = st.mtime.tv_sec;\n\t\ttimes[1].tv_usec = st.mtime.tv_nsec / 1000;\n\n\t\tif (attrs->ia_valid & HOSTFS_ATTR_ATIME_SET) {\n\t\t\ttimes[0].tv_sec = attrs->ia_atime.tv_sec;\n\t\t\ttimes[0].tv_usec = attrs->ia_atime.tv_nsec / 1000;\n\t\t}\n\t\tif (attrs->ia_valid & HOSTFS_ATTR_MTIME_SET) {\n\t\t\ttimes[1].tv_sec = attrs->ia_mtime.tv_sec;\n\t\t\ttimes[1].tv_usec = attrs->ia_mtime.tv_nsec / 1000;\n\t\t}\n\n\t\tif (fd >= 0) {\n\t\t\tif (futimes(fd, times) != 0)\n\t\t\t\treturn -errno;\n\t\t} else if (utimes(file, times) != 0) {\n\t\t\treturn -errno;\n\t\t}\n\t}\n\n\t/* Note: ctime is not handled */\n\tif (attrs->ia_valid & (HOSTFS_ATTR_ATIME | HOSTFS_ATTR_MTIME)) {\n\t\terr = stat_file(file, &st, fd);\n\t\tattrs->ia_atime = st.atime;\n\t\tattrs->ia_mtime = st.mtime;\n\t\tif (err != 0)\n\t\t\treturn err;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "file_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "178-197",
    "snippet": "int file_create(char *name, int ur, int uw, int ux, int gr,\n\t\tint gw, int gx, int or, int ow, int ox)\n{\n\tint mode, fd;\n\n\tmode = 0;\n\tmode |= ur ? S_IRUSR : 0;\n\tmode |= uw ? S_IWUSR : 0;\n\tmode |= ux ? S_IXUSR : 0;\n\tmode |= gr ? S_IRGRP : 0;\n\tmode |= gw ? S_IWGRP : 0;\n\tmode |= gx ? S_IXGRP : 0;\n\tmode |= or ? S_IROTH : 0;\n\tmode |= ow ? S_IWOTH : 0;\n\tmode |= ox ? S_IXOTH : 0;\n\tfd = open64(name, O_CREAT | O_RDWR, mode);\n\tif (fd < 0)\n\t\treturn -errno;\n\treturn fd;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "open64",
          "args": [
            "name",
            "O_CREAT | O_RDWR",
            "mode"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint file_create(char *name, int ur, int uw, int ux, int gr,\n\t\tint gw, int gx, int or, int ow, int ox)\n{\n\tint mode, fd;\n\n\tmode = 0;\n\tmode |= ur ? S_IRUSR : 0;\n\tmode |= uw ? S_IWUSR : 0;\n\tmode |= ux ? S_IXUSR : 0;\n\tmode |= gr ? S_IRGRP : 0;\n\tmode |= gw ? S_IWGRP : 0;\n\tmode |= gx ? S_IXGRP : 0;\n\tmode |= or ? S_IROTH : 0;\n\tmode |= ow ? S_IWOTH : 0;\n\tmode |= ox ? S_IXOTH : 0;\n\tfd = open64(name, O_CREAT | O_RDWR, mode);\n\tif (fd < 0)\n\t\treturn -errno;\n\treturn fd;\n}"
  },
  {
    "function_name": "close_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "173-176",
    "snippet": "void close_dir(void *stream)\n{\n\tclosedir(stream);\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "stream"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nvoid close_dir(void *stream)\n{\n\tclosedir(stream);\n}"
  },
  {
    "function_name": "close_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "168-171",
    "snippet": "void close_file(void *stream)\n{\n\tclose(*((int *) stream));\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "*((int *) stream)"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "close_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "173-176",
          "snippet": "void close_dir(void *stream)\n{\n\tclosedir(stream);\n}",
          "includes": [
            "#include <utime.h>",
            "#include \"hostfs.h\"",
            "#include <sys/syscall.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <stddef.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nvoid close_dir(void *stream)\n{\n\tclosedir(stream);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nvoid close_file(void *stream)\n{\n\tclose(*((int *) stream));\n}"
  },
  {
    "function_name": "replace_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "163-166",
    "snippet": "int replace_file(int oldfd, int fd)\n{\n\treturn dup2(oldfd, fd);\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dup2",
          "args": [
            "oldfd",
            "fd"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "fh_dup2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4proc.c",
          "lines": "177-185",
          "snippet": "static inline void\nfh_dup2(struct svc_fh *dst, struct svc_fh *src)\n{\n\tfh_put(dst);\n\tdget(src->fh_dentry);\n\tif (src->fh_export)\n\t\texp_get(src->fh_export);\n\t*dst = *src;\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include \"trace.h\"",
            "#include \"pnfs.h\"",
            "#include \"acl.h\"",
            "#include \"netns.h\"",
            "#include \"current_stateid.h\"",
            "#include \"vfs.h\"",
            "#include \"xdr4.h\"",
            "#include \"cache.h\"",
            "#include \"idmap.h\"",
            "#include <linux/slab.h>",
            "#include <linux/falloc.h>",
            "#include <linux/file.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include \"trace.h\"\n#include \"pnfs.h\"\n#include \"acl.h\"\n#include \"netns.h\"\n#include \"current_stateid.h\"\n#include \"vfs.h\"\n#include \"xdr4.h\"\n#include \"cache.h\"\n#include \"idmap.h\"\n#include <linux/slab.h>\n#include <linux/falloc.h>\n#include <linux/file.h>\n\nstatic inline void\nfh_dup2(struct svc_fh *dst, struct svc_fh *src)\n{\n\tfh_put(dst);\n\tdget(src->fh_dentry);\n\tif (src->fh_export)\n\t\texp_get(src->fh_export);\n\t*dst = *src;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint replace_file(int oldfd, int fd)\n{\n\treturn dup2(oldfd, fd);\n}"
  },
  {
    "function_name": "fsync_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "150-161",
    "snippet": "int fsync_file(int fd, int datasync)\n{\n\tint ret;\n\tif (datasync)\n\t\tret = fdatasync(fd);\n\telse\n\t\tret = fsync(fd);\n\n\tif (ret < 0)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fsync",
          "args": [
            "fd"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "fsync_bdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "185-194",
          "snippet": "int fsync_bdev(struct block_device *bdev)\n{\n\tstruct super_block *sb = get_super(bdev);\n\tif (sb) {\n\t\tint res = sync_filesystem(sb);\n\t\tdrop_super(sb);\n\t\treturn res;\n\t}\n\treturn sync_blockdev(bdev);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nint fsync_bdev(struct block_device *bdev)\n{\n\tstruct super_block *sb = get_super(bdev);\n\tif (sb) {\n\t\tint res = sync_filesystem(sb);\n\t\tdrop_super(sb);\n\t\treturn res;\n\t}\n\treturn sync_blockdev(bdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdatasync",
          "args": [
            "fd"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint fsync_file(int fd, int datasync)\n{\n\tint ret;\n\tif (datasync)\n\t\tret = fdatasync(fd);\n\telse\n\t\tret = fsync(fd);\n\n\tif (ret < 0)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "lseek_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "140-148",
    "snippet": "int lseek_file(int fd, long long offset, int whence)\n{\n\tint ret;\n\n\tret = lseek64(fd, offset, whence);\n\tif (ret < 0)\n\t\treturn -errno;\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lseek64",
          "args": [
            "fd",
            "offset",
            "whence"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint lseek_file(int fd, long long offset, int whence)\n{\n\tint ret;\n\n\tret = lseek64(fd, offset, whence);\n\tif (ret < 0)\n\t\treturn -errno;\n\treturn 0;\n}"
  },
  {
    "function_name": "write_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "129-138",
    "snippet": "int write_file(int fd, unsigned long long *offset, const char *buf, int len)\n{\n\tint n;\n\n\tn = pwrite64(fd, buf, len, *offset);\n\tif (n < 0)\n\t\treturn -errno;\n\t*offset += n;\n\treturn n;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pwrite64",
          "args": [
            "fd",
            "buf",
            "len",
            "*offset"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint write_file(int fd, unsigned long long *offset, const char *buf, int len)\n{\n\tint n;\n\n\tn = pwrite64(fd, buf, len, *offset);\n\tif (n < 0)\n\t\treturn -errno;\n\t*offset += n;\n\treturn n;\n}"
  },
  {
    "function_name": "read_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "118-127",
    "snippet": "int read_file(int fd, unsigned long long *offset, char *buf, int len)\n{\n\tint n;\n\n\tn = pread64(fd, buf, len, *offset);\n\tif (n < 0)\n\t\treturn -errno;\n\t*offset += n;\n\treturn n;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pread64",
          "args": [
            "fd",
            "buf",
            "len",
            "*offset"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint read_file(int fd, unsigned long long *offset, char *buf, int len)\n{\n\tint n;\n\n\tn = pread64(fd, buf, len, *offset);\n\tif (n < 0)\n\t\treturn -errno;\n\t*offset += n;\n\treturn n;\n}"
  },
  {
    "function_name": "read_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "100-116",
    "snippet": "char *read_dir(void *stream, unsigned long long *pos,\n\t       unsigned long long *ino_out, int *len_out,\n\t       unsigned int *type_out)\n{\n\tDIR *dir = stream;\n\tstruct dirent *ent;\n\n\tseekdir(dir, *pos);\n\tent = readdir(dir);\n\tif (ent == NULL)\n\t\treturn NULL;\n\t*len_out = strlen(ent->d_name);\n\t*ino_out = ent->d_ino;\n\t*type_out = ent->d_type;\n\t*pos = telldir(dir);\n\treturn ent->d_name;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "telldir",
          "args": [
            "dir"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "ent->d_name"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "dir"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_advise_use_readdirplus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/dir.c",
          "lines": "33-38",
          "snippet": "static void fuse_advise_use_readdirplus(struct inode *dir)\n{\n\tstruct fuse_inode *fi = get_fuse_inode(dir);\n\n\tset_bit(FUSE_I_ADVISE_RDPLUS, &fi->state);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic void fuse_advise_use_readdirplus(struct inode *dir)\n{\n\tstruct fuse_inode *fi = get_fuse_inode(dir);\n\n\tset_bit(FUSE_I_ADVISE_RDPLUS, &fi->state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seekdir",
          "args": [
            "dir",
            "*pos"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nchar *read_dir(void *stream, unsigned long long *pos,\n\t       unsigned long long *ino_out, int *len_out,\n\t       unsigned int *type_out)\n{\n\tDIR *dir = stream;\n\tstruct dirent *ent;\n\n\tseekdir(dir, *pos);\n\tent = readdir(dir);\n\tif (ent == NULL)\n\t\treturn NULL;\n\t*len_out = strlen(ent->d_name);\n\t*ino_out = ent->d_ino;\n\t*type_out = ent->d_type;\n\t*pos = telldir(dir);\n\treturn ent->d_name;\n}"
  },
  {
    "function_name": "open_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "90-98",
    "snippet": "void *open_dir(char *path, int *err_out)\n{\n\tDIR *dir;\n\n\tdir = opendir(path);\n\t*err_out = errno;\n\n\treturn dir;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "path"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nvoid *open_dir(char *path, int *err_out)\n{\n\tDIR *dir;\n\n\tdir = opendir(path);\n\t*err_out = errno;\n\n\treturn dir;\n}"
  },
  {
    "function_name": "open_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "70-88",
    "snippet": "int open_file(char *path, int r, int w, int append)\n{\n\tint mode = 0, fd;\n\n\tif (r && !w)\n\t\tmode = O_RDONLY;\n\telse if (!r && w)\n\t\tmode = O_WRONLY;\n\telse if (r && w)\n\t\tmode = O_RDWR;\n\telse panic(\"Impossible mode in open_file\");\n\n\tif (append)\n\t\tmode |= O_APPEND;\n\tfd = open64(path, mode);\n\tif (fd < 0)\n\t\treturn -errno;\n\telse return fd;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "open64",
          "args": [
            "path",
            "mode"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"Impossible mode in open_file\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint open_file(char *path, int r, int w, int append)\n{\n\tint mode = 0, fd;\n\n\tif (r && !w)\n\t\tmode = O_RDONLY;\n\telse if (!r && w)\n\t\tmode = O_WRONLY;\n\telse if (r && w)\n\t\tmode = O_RDWR;\n\telse panic(\"Impossible mode in open_file\");\n\n\tif (append)\n\t\tmode |= O_APPEND;\n\tfd = open64(path, mode);\n\tif (fd < 0)\n\t\treturn -errno;\n\telse return fd;\n}"
  },
  {
    "function_name": "access_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "55-68",
    "snippet": "int access_file(char *path, int r, int w, int x)\n{\n\tint mode = 0;\n\n\tif (r)\n\t\tmode = R_OK;\n\tif (w)\n\t\tmode |= W_OK;\n\tif (x)\n\t\tmode |= X_OK;\n\tif (access(path, mode) != 0)\n\t\treturn -errno;\n\telse return 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "access",
          "args": [
            "path",
            "mode"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "journal_get_undo_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jbd/transaction.c",
          "lines": "880-928",
          "snippet": "int journal_get_undo_access(handle_t *handle, struct buffer_head *bh)\n{\n\tint err;\n\tstruct journal_head *jh = journal_add_journal_head(bh);\n\tchar *committed_data = NULL;\n\n\tJBUFFER_TRACE(jh, \"entry\");\n\n\t/*\n\t * Do this first --- it can drop the journal lock, so we want to\n\t * make sure that obtaining the committed_data is done\n\t * atomically wrt. completion of any outstanding commits.\n\t */\n\terr = do_get_write_access(handle, jh, 1);\n\tif (err)\n\t\tgoto out;\n\nrepeat:\n\tif (!jh->b_committed_data) {\n\t\tcommitted_data = jbd_alloc(jh2bh(jh)->b_size, GFP_NOFS);\n\t\tif (!committed_data) {\n\t\t\tprintk(KERN_ERR \"%s: No memory for committed data\\n\",\n\t\t\t\t__func__);\n\t\t\terr = -ENOMEM;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tjbd_lock_bh_state(bh);\n\tif (!jh->b_committed_data) {\n\t\t/* Copy out the current buffer contents into the\n\t\t * preserved, committed copy. */\n\t\tJBUFFER_TRACE(jh, \"generate b_committed data\");\n\t\tif (!committed_data) {\n\t\t\tjbd_unlock_bh_state(bh);\n\t\t\tgoto repeat;\n\t\t}\n\n\t\tjh->b_committed_data = committed_data;\n\t\tcommitted_data = NULL;\n\t\tmemcpy(jh->b_committed_data, bh->b_data, bh->b_size);\n\t}\n\tjbd_unlock_bh_state(bh);\nout:\n\tjournal_put_journal_head(jh);\n\tif (unlikely(committed_data))\n\t\tjbd_free(committed_data, bh->b_size);\n\treturn err;\n}",
          "includes": [
            "#include <linux/hrtimer.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/timer.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/jbd.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __journal_temp_unlink_buffer(struct journal_head *jh);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/hrtimer.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/timer.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/jbd.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic void __journal_temp_unlink_buffer(struct journal_head *jh);\n\nint journal_get_undo_access(handle_t *handle, struct buffer_head *bh)\n{\n\tint err;\n\tstruct journal_head *jh = journal_add_journal_head(bh);\n\tchar *committed_data = NULL;\n\n\tJBUFFER_TRACE(jh, \"entry\");\n\n\t/*\n\t * Do this first --- it can drop the journal lock, so we want to\n\t * make sure that obtaining the committed_data is done\n\t * atomically wrt. completion of any outstanding commits.\n\t */\n\terr = do_get_write_access(handle, jh, 1);\n\tif (err)\n\t\tgoto out;\n\nrepeat:\n\tif (!jh->b_committed_data) {\n\t\tcommitted_data = jbd_alloc(jh2bh(jh)->b_size, GFP_NOFS);\n\t\tif (!committed_data) {\n\t\t\tprintk(KERN_ERR \"%s: No memory for committed data\\n\",\n\t\t\t\t__func__);\n\t\t\terr = -ENOMEM;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tjbd_lock_bh_state(bh);\n\tif (!jh->b_committed_data) {\n\t\t/* Copy out the current buffer contents into the\n\t\t * preserved, committed copy. */\n\t\tJBUFFER_TRACE(jh, \"generate b_committed data\");\n\t\tif (!committed_data) {\n\t\t\tjbd_unlock_bh_state(bh);\n\t\t\tgoto repeat;\n\t\t}\n\n\t\tjh->b_committed_data = committed_data;\n\t\tcommitted_data = NULL;\n\t\tmemcpy(jh->b_committed_data, bh->b_data, bh->b_size);\n\t}\n\tjbd_unlock_bh_state(bh);\nout:\n\tjournal_put_journal_head(jh);\n\tif (unlikely(committed_data))\n\t\tjbd_free(committed_data, bh->b_size);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint access_file(char *path, int r, int w, int x)\n{\n\tint mode = 0;\n\n\tif (r)\n\t\tmode = R_OK;\n\tif (w)\n\t\tmode |= W_OK;\n\tif (x)\n\t\tmode |= X_OK;\n\tif (access(path, mode) != 0)\n\t\treturn -errno;\n\telse return 0;\n}"
  },
  {
    "function_name": "stat_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "41-53",
    "snippet": "int stat_file(const char *path, struct hostfs_stat *p, int fd)\n{\n\tstruct stat64 buf;\n\n\tif (fd >= 0) {\n\t\tif (fstat64(fd, &buf) < 0)\n\t\t\treturn -errno;\n\t} else if (lstat64(path, &buf) < 0) {\n\t\treturn -errno;\n\t}\n\tstat64_to_hostfs(&buf, p);\n\treturn 0;\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stat64_to_hostfs",
          "args": [
            "&buf",
            "p"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "stat64_to_hostfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
          "lines": "21-39",
          "snippet": "static void stat64_to_hostfs(const struct stat64 *buf, struct hostfs_stat *p)\n{\n\tp->ino = buf->st_ino;\n\tp->mode = buf->st_mode;\n\tp->nlink = buf->st_nlink;\n\tp->uid = buf->st_uid;\n\tp->gid = buf->st_gid;\n\tp->size = buf->st_size;\n\tp->atime.tv_sec = buf->st_atime;\n\tp->atime.tv_nsec = 0;\n\tp->ctime.tv_sec = buf->st_ctime;\n\tp->ctime.tv_nsec = 0;\n\tp->mtime.tv_sec = buf->st_mtime;\n\tp->mtime.tv_nsec = 0;\n\tp->blksize = buf->st_blksize;\n\tp->blocks = buf->st_blocks;\n\tp->maj = os_major(buf->st_rdev);\n\tp->min = os_minor(buf->st_rdev);\n}",
          "includes": [
            "#include <utime.h>",
            "#include \"hostfs.h\"",
            "#include <sys/syscall.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <stddef.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nstatic void stat64_to_hostfs(const struct stat64 *buf, struct hostfs_stat *p)\n{\n\tp->ino = buf->st_ino;\n\tp->mode = buf->st_mode;\n\tp->nlink = buf->st_nlink;\n\tp->uid = buf->st_uid;\n\tp->gid = buf->st_gid;\n\tp->size = buf->st_size;\n\tp->atime.tv_sec = buf->st_atime;\n\tp->atime.tv_nsec = 0;\n\tp->ctime.tv_sec = buf->st_ctime;\n\tp->ctime.tv_nsec = 0;\n\tp->mtime.tv_sec = buf->st_mtime;\n\tp->mtime.tv_nsec = 0;\n\tp->blksize = buf->st_blksize;\n\tp->blocks = buf->st_blocks;\n\tp->maj = os_major(buf->st_rdev);\n\tp->min = os_minor(buf->st_rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lstat64",
          "args": [
            "path",
            "&buf"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fstat64",
          "args": [
            "fd",
            "&buf"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nint stat_file(const char *path, struct hostfs_stat *p, int fd)\n{\n\tstruct stat64 buf;\n\n\tif (fd >= 0) {\n\t\tif (fstat64(fd, &buf) < 0)\n\t\t\treturn -errno;\n\t} else if (lstat64(path, &buf) < 0) {\n\t\treturn -errno;\n\t}\n\tstat64_to_hostfs(&buf, p);\n\treturn 0;\n}"
  },
  {
    "function_name": "stat64_to_hostfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hostfs/hostfs_user.c",
    "lines": "21-39",
    "snippet": "static void stat64_to_hostfs(const struct stat64 *buf, struct hostfs_stat *p)\n{\n\tp->ino = buf->st_ino;\n\tp->mode = buf->st_mode;\n\tp->nlink = buf->st_nlink;\n\tp->uid = buf->st_uid;\n\tp->gid = buf->st_gid;\n\tp->size = buf->st_size;\n\tp->atime.tv_sec = buf->st_atime;\n\tp->atime.tv_nsec = 0;\n\tp->ctime.tv_sec = buf->st_ctime;\n\tp->ctime.tv_nsec = 0;\n\tp->mtime.tv_sec = buf->st_mtime;\n\tp->mtime.tv_nsec = 0;\n\tp->blksize = buf->st_blksize;\n\tp->blocks = buf->st_blocks;\n\tp->maj = os_major(buf->st_rdev);\n\tp->min = os_minor(buf->st_rdev);\n}",
    "includes": [
      "#include <utime.h>",
      "#include \"hostfs.h\"",
      "#include <sys/syscall.h>",
      "#include <sys/vfs.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <string.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "#include <stddef.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "os_minor",
          "args": [
            "buf->st_rdev"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "os_major",
          "args": [
            "buf->st_rdev"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <utime.h>\n#include \"hostfs.h\"\n#include <sys/syscall.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <stddef.h>\n#include <stdio.h>\n\nstatic void stat64_to_hostfs(const struct stat64 *buf, struct hostfs_stat *p)\n{\n\tp->ino = buf->st_ino;\n\tp->mode = buf->st_mode;\n\tp->nlink = buf->st_nlink;\n\tp->uid = buf->st_uid;\n\tp->gid = buf->st_gid;\n\tp->size = buf->st_size;\n\tp->atime.tv_sec = buf->st_atime;\n\tp->atime.tv_nsec = 0;\n\tp->ctime.tv_sec = buf->st_ctime;\n\tp->ctime.tv_nsec = 0;\n\tp->mtime.tv_sec = buf->st_mtime;\n\tp->mtime.tv_nsec = 0;\n\tp->blksize = buf->st_blksize;\n\tp->blocks = buf->st_blocks;\n\tp->maj = os_major(buf->st_rdev);\n\tp->min = os_minor(buf->st_rdev);\n}"
  }
]