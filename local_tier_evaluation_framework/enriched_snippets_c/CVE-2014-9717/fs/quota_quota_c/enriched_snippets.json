[
  {
    "function_name": "quotactl_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "528-553",
    "snippet": "static struct super_block *quotactl_block(const char __user *special, int cmd)\n{\n#ifdef CONFIG_BLOCK\n\tstruct block_device *bdev;\n\tstruct super_block *sb;\n\tstruct filename *tmp = getname(special);\n\n\tif (IS_ERR(tmp))\n\t\treturn ERR_CAST(tmp);\n\tbdev = lookup_bdev(tmp->name);\n\tputname(tmp);\n\tif (IS_ERR(bdev))\n\t\treturn ERR_CAST(bdev);\n\tif (quotactl_cmd_write(cmd))\n\t\tsb = get_super_thawed(bdev);\n\telse\n\t\tsb = get_super(bdev);\n\tbdput(bdev);\n\tif (!sb)\n\t\treturn ERR_PTR(-ENODEV);\n\n\treturn sb;\n#else\n\treturn ERR_PTR(-ENODEV);\n#endif\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENODEV"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENODEV"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdput",
          "args": [
            "bdev"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "bdput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "652-655",
          "snippet": "void bdput(struct block_device *bdev)\n{\n\tiput(bdev->bd_inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nvoid bdput(struct block_device *bdev)\n{\n\tiput(bdev->bd_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_super",
          "args": [
            "bdev"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "ser_get_super(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/super.c",
          "lines": "662-687",
          "snippet": "truct super_block *user_get_super(dev_t dev)\n{\n\tstruct super_block *sb;\n\n\tspin_lock(&sb_lock);\nrescan:\n\tlist_for_each_entry(sb, &super_blocks, s_list) {\n\t\tif (hlist_unhashed(&sb->s_instances))\n\t\t\tcontinue;\n\t\tif (sb->s_dev ==  dev) {\n\t\t\tsb->s_count++;\n\t\t\tspin_unlock(&sb_lock);\n\t\t\tdown_read(&sb->s_umount);\n\t\t\t/* still alive? */\n\t\t\tif (sb->s_root && (sb->s_flags & MS_BORN))\n\t\t\t\treturn sb;\n\t\t\tup_read(&sb->s_umount);\n\t\t\t/* nope, got unmounted */\n\t\t\tspin_lock(&sb_lock);\n\t\t\t__put_super(sb);\n\t\t\tgoto rescan;\n\t\t}\n\t}\n\tspin_unlock(&sb_lock);\n\treturn NULL;\n}",
          "includes": [
            "include \"internal.h\"",
            "include <linux/lockdep.h>\n#",
            "include <linux/fsnotify.h>\n#",
            "include <linux/cleancache.h>\n#",
            "include <linux/rculist_bl.h>\n#",
            "include <linux/backing-dev.h>\n#",
            "include <linux/mutex.h>\n#",
            "include <linux/idr.h>\n#",
            "include <linux/writeback.h>\t\t/* for the emergency remount stuff */\n#",
            "include <linux/security.h>\n#",
            "include <linux/mount.h>\n#",
            "include <linux/blkdev.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/export.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "tatic LIST_HEAD(super_blocks);",
            "tatic DEFINE_SPINLOCK(sb_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "include \"internal.h\"\ninclude <linux/lockdep.h>\n#\ninclude <linux/fsnotify.h>\n#\ninclude <linux/cleancache.h>\n#\ninclude <linux/rculist_bl.h>\n#\ninclude <linux/backing-dev.h>\n#\ninclude <linux/mutex.h>\n#\ninclude <linux/idr.h>\n#\ninclude <linux/writeback.h>\t\t/* for the emergency remount stuff */\n#\ninclude <linux/security.h>\n#\ninclude <linux/mount.h>\n#\ninclude <linux/blkdev.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/export.h>\n#\n\ntatic LIST_HEAD(super_blocks);\ntatic DEFINE_SPINLOCK(sb_lock);\n\ntruct super_block *user_get_super(dev_t dev)\n{\n\tstruct super_block *sb;\n\n\tspin_lock(&sb_lock);\nrescan:\n\tlist_for_each_entry(sb, &super_blocks, s_list) {\n\t\tif (hlist_unhashed(&sb->s_instances))\n\t\t\tcontinue;\n\t\tif (sb->s_dev ==  dev) {\n\t\t\tsb->s_count++;\n\t\t\tspin_unlock(&sb_lock);\n\t\t\tdown_read(&sb->s_umount);\n\t\t\t/* still alive? */\n\t\t\tif (sb->s_root && (sb->s_flags & MS_BORN))\n\t\t\t\treturn sb;\n\t\t\tup_read(&sb->s_umount);\n\t\t\t/* nope, got unmounted */\n\t\t\tspin_lock(&sb_lock);\n\t\t\t__put_super(sb);\n\t\t\tgoto rescan;\n\t\t}\n\t}\n\tspin_unlock(&sb_lock);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_super_thawed",
          "args": [
            "bdev"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quotactl_cmd_write",
          "args": [
            "cmd"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "quotactl_cmd_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "507-520",
          "snippet": "static int quotactl_cmd_write(int cmd)\n{\n\tswitch (cmd) {\n\tcase Q_GETFMT:\n\tcase Q_GETINFO:\n\tcase Q_SYNC:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XGETQUOTA:\n\tcase Q_XQUOTASYNC:\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quotactl_cmd_write(int cmd)\n{\n\tswitch (cmd) {\n\tcase Q_GETFMT:\n\tcase Q_GETINFO:\n\tcase Q_SYNC:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XGETQUOTA:\n\tcase Q_XQUOTASYNC:\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "bdev"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "bdev"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "putname",
          "args": [
            "tmp"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "putname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "245-257",
          "snippet": "void putname(struct filename *name)\n{\n\tBUG_ON(name->refcnt <= 0);\n\n\tif (--name->refcnt > 0)\n\t\treturn;\n\n\tif (name->separate) {\n\t\t__putname(name->name);\n\t\tkfree(name);\n\t} else\n\t\t__putname(name);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid putname(struct filename *name)\n{\n\tBUG_ON(name->refcnt <= 0);\n\n\tif (--name->refcnt > 0)\n\t\treturn;\n\n\tif (name->separate) {\n\t\t__putname(name->name);\n\t\tkfree(name);\n\t} else\n\t\t__putname(name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lookup_bdev",
          "args": [
            "tmp->name"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "lookup_bdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "1697-1728",
          "snippet": "struct block_device *lookup_bdev(const char *pathname)\n{\n\tstruct block_device *bdev;\n\tstruct inode *inode;\n\tstruct path path;\n\tint error;\n\n\tif (!pathname || !*pathname)\n\t\treturn ERR_PTR(-EINVAL);\n\n\terror = kern_path(pathname, LOOKUP_FOLLOW, &path);\n\tif (error)\n\t\treturn ERR_PTR(error);\n\n\tinode = path.dentry->d_inode;\n\terror = -ENOTBLK;\n\tif (!S_ISBLK(inode->i_mode))\n\t\tgoto fail;\n\terror = -EACCES;\n\tif (path.mnt->mnt_flags & MNT_NODEV)\n\t\tgoto fail;\n\terror = -ENOMEM;\n\tbdev = bd_acquire(inode);\n\tif (!bdev)\n\t\tgoto fail;\nout:\n\tpath_put(&path);\n\treturn bdev;\nfail:\n\tbdev = ERR_PTR(error);\n\tgoto out;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstruct block_device *lookup_bdev(const char *pathname)\n{\n\tstruct block_device *bdev;\n\tstruct inode *inode;\n\tstruct path path;\n\tint error;\n\n\tif (!pathname || !*pathname)\n\t\treturn ERR_PTR(-EINVAL);\n\n\terror = kern_path(pathname, LOOKUP_FOLLOW, &path);\n\tif (error)\n\t\treturn ERR_PTR(error);\n\n\tinode = path.dentry->d_inode;\n\terror = -ENOTBLK;\n\tif (!S_ISBLK(inode->i_mode))\n\t\tgoto fail;\n\terror = -EACCES;\n\tif (path.mnt->mnt_flags & MNT_NODEV)\n\t\tgoto fail;\n\terror = -ENOMEM;\n\tbdev = bd_acquire(inode);\n\tif (!bdev)\n\t\tgoto fail;\nout:\n\tpath_put(&path);\n\treturn bdev;\nfail:\n\tbdev = ERR_PTR(error);\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "tmp"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "tmp"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getname",
          "args": [
            "special"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "getname_kernel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "208-243",
          "snippet": "struct filename *\ngetname_kernel(const char * filename)\n{\n\tstruct filename *result;\n\tint len = strlen(filename) + 1;\n\n\tresult = __getname();\n\tif (unlikely(!result))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (len <= EMBEDDED_NAME_MAX) {\n\t\tresult->name = (char *)(result) + sizeof(*result);\n\t\tresult->separate = false;\n\t} else if (len <= PATH_MAX) {\n\t\tstruct filename *tmp;\n\n\t\ttmp = kmalloc(sizeof(*tmp), GFP_KERNEL);\n\t\tif (unlikely(!tmp)) {\n\t\t\t__putname(result);\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\t}\n\t\ttmp->name = (char *)result;\n\t\ttmp->separate = true;\n\t\tresult = tmp;\n\t} else {\n\t\t__putname(result);\n\t\treturn ERR_PTR(-ENAMETOOLONG);\n\t}\n\tmemcpy((char *)result->name, filename, len);\n\tresult->uptr = NULL;\n\tresult->aname = NULL;\n\tresult->refcnt = 1;\n\taudit_getname(result);\n\n\treturn result;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define EMBEDDED_NAME_MAX\t(PATH_MAX - sizeof(struct filename))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define EMBEDDED_NAME_MAX\t(PATH_MAX - sizeof(struct filename))\n\nstruct filename *\ngetname_kernel(const char * filename)\n{\n\tstruct filename *result;\n\tint len = strlen(filename) + 1;\n\n\tresult = __getname();\n\tif (unlikely(!result))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (len <= EMBEDDED_NAME_MAX) {\n\t\tresult->name = (char *)(result) + sizeof(*result);\n\t\tresult->separate = false;\n\t} else if (len <= PATH_MAX) {\n\t\tstruct filename *tmp;\n\n\t\ttmp = kmalloc(sizeof(*tmp), GFP_KERNEL);\n\t\tif (unlikely(!tmp)) {\n\t\t\t__putname(result);\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\t}\n\t\ttmp->name = (char *)result;\n\t\ttmp->separate = true;\n\t\tresult = tmp;\n\t} else {\n\t\t__putname(result);\n\t\treturn ERR_PTR(-ENAMETOOLONG);\n\t}\n\tmemcpy((char *)result->name, filename, len);\n\tresult->uptr = NULL;\n\tresult->aname = NULL;\n\tresult->refcnt = 1;\n\taudit_getname(result);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic struct super_block *quotactl_block(const char __user *special, int cmd)\n{\n#ifdef CONFIG_BLOCK\n\tstruct block_device *bdev;\n\tstruct super_block *sb;\n\tstruct filename *tmp = getname(special);\n\n\tif (IS_ERR(tmp))\n\t\treturn ERR_CAST(tmp);\n\tbdev = lookup_bdev(tmp->name);\n\tputname(tmp);\n\tif (IS_ERR(bdev))\n\t\treturn ERR_CAST(bdev);\n\tif (quotactl_cmd_write(cmd))\n\t\tsb = get_super_thawed(bdev);\n\telse\n\t\tsb = get_super(bdev);\n\tbdput(bdev);\n\tif (!sb)\n\t\treturn ERR_PTR(-ENODEV);\n\n\treturn sb;\n#else\n\treturn ERR_PTR(-ENODEV);\n#endif\n}"
  },
  {
    "function_name": "quotactl_cmd_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "507-520",
    "snippet": "static int quotactl_cmd_write(int cmd)\n{\n\tswitch (cmd) {\n\tcase Q_GETFMT:\n\tcase Q_GETINFO:\n\tcase Q_SYNC:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XGETQUOTA:\n\tcase Q_XQUOTASYNC:\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quotactl_cmd_write(int cmd)\n{\n\tswitch (cmd) {\n\tcase Q_GETFMT:\n\tcase Q_GETINFO:\n\tcase Q_SYNC:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XGETQUOTA:\n\tcase Q_XQUOTASYNC:\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "do_quotactl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "441-502",
    "snippet": "static int do_quotactl(struct super_block *sb, int type, int cmd, qid_t id,\n\t\t       void __user *addr, struct path *path)\n{\n\tint ret;\n\n\tif (type >= (XQM_COMMAND(cmd) ? XQM_MAXQUOTAS : MAXQUOTAS))\n\t\treturn -EINVAL;\n\t/*\n\t * Quota not supported on this fs? Check this before s_quota_types\n\t * since they needn't be set if quota is not supported at all.\n\t */\n\tif (!sb->s_qcop)\n\t\treturn -ENOSYS;\n\tif (!(sb->s_quota_types & (1 << type)))\n\t\treturn -EINVAL;\n\n\tret = check_quotactl_permission(sb, type, cmd, id);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tswitch (cmd) {\n\tcase Q_QUOTAON:\n\t\treturn quota_quotaon(sb, type, cmd, id, path);\n\tcase Q_QUOTAOFF:\n\t\treturn quota_quotaoff(sb, type);\n\tcase Q_GETFMT:\n\t\treturn quota_getfmt(sb, type, addr);\n\tcase Q_GETINFO:\n\t\treturn quota_getinfo(sb, type, addr);\n\tcase Q_SETINFO:\n\t\treturn quota_setinfo(sb, type, addr);\n\tcase Q_GETQUOTA:\n\t\treturn quota_getquota(sb, type, id, addr);\n\tcase Q_SETQUOTA:\n\t\treturn quota_setquota(sb, type, id, addr);\n\tcase Q_SYNC:\n\t\tif (!sb->s_qcop->quota_sync)\n\t\t\treturn -ENOSYS;\n\t\treturn sb->s_qcop->quota_sync(sb, type);\n\tcase Q_XQUOTAON:\n\t\treturn quota_enable(sb, addr);\n\tcase Q_XQUOTAOFF:\n\t\treturn quota_disable(sb, addr);\n\tcase Q_XQUOTARM:\n\t\treturn quota_rmxquota(sb, addr);\n\tcase Q_XGETQSTAT:\n\t\treturn quota_getxstate(sb, addr);\n\tcase Q_XGETQSTATV:\n\t\treturn quota_getxstatev(sb, addr);\n\tcase Q_XSETQLIM:\n\t\treturn quota_setxquota(sb, type, id, addr);\n\tcase Q_XGETQUOTA:\n\t\treturn quota_getxquota(sb, type, id, addr);\n\tcase Q_XQUOTASYNC:\n\t\tif (sb->s_flags & MS_RDONLY)\n\t\t\treturn -EROFS;\n\t\t/* XFS quotas are fully coherent now, making this call a noop */\n\t\treturn 0;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_getxquota",
          "args": [
            "sb",
            "type",
            "id",
            "addr"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "quota_getxquota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "407-427",
          "snippet": "static int quota_getxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &qdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_xfs_dqblk(&fdq, &qdq, type, id);\n\tif (copy_to_user(addr, &fdq, sizeof(fdq)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &qdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_xfs_dqblk(&fdq, &qdq, type, id);\n\tif (copy_to_user(addr, &fdq, sizeof(fdq)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_setxquota",
          "args": [
            "sb",
            "type",
            "id",
            "addr"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "quota_setxquota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "360-376",
          "snippet": "static int quota_setxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&fdq, addr, sizeof(fdq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_xfs_dqblk(&qdq, &fdq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &qdq);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_setxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&fdq, addr, sizeof(fdq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_xfs_dqblk(&qdq, &fdq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &qdq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_getxstatev",
          "args": [
            "sb",
            "addr"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "quota_getxstatev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "268-291",
          "snippet": "static int quota_getxstatev(struct super_block *sb, void __user *addr)\n{\n\tstruct fs_quota_statv fqs;\n\tint ret;\n\n\tif (!sb->s_qcop->get_xstatev)\n\t\treturn -ENOSYS;\n\n\tmemset(&fqs, 0, sizeof(fqs));\n\tif (copy_from_user(&fqs, addr, 1)) /* Just read qs_version */\n\t\treturn -EFAULT;\n\n\t/* If this kernel doesn't support user specified version, fail */\n\tswitch (fqs.qs_version) {\n\tcase FS_QSTATV_VERSION1:\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tret = sb->s_qcop->get_xstatev(sb, &fqs);\n\tif (!ret && copy_to_user(addr, &fqs, sizeof(fqs)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getxstatev(struct super_block *sb, void __user *addr)\n{\n\tstruct fs_quota_statv fqs;\n\tint ret;\n\n\tif (!sb->s_qcop->get_xstatev)\n\t\treturn -ENOSYS;\n\n\tmemset(&fqs, 0, sizeof(fqs));\n\tif (copy_from_user(&fqs, addr, 1)) /* Just read qs_version */\n\t\treturn -EFAULT;\n\n\t/* If this kernel doesn't support user specified version, fail */\n\tswitch (fqs.qs_version) {\n\tcase FS_QSTATV_VERSION1:\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tret = sb->s_qcop->get_xstatev(sb, &fqs);\n\tif (!ret && copy_to_user(addr, &fqs, sizeof(fqs)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_rmxquota",
          "args": [
            "sb",
            "addr"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "quota_rmxquota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "429-438",
          "snippet": "static int quota_rmxquota(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->rm_xquota)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->rm_xquota(sb, flags);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_rmxquota(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->rm_xquota)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->rm_xquota(sb, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_disable",
          "args": [
            "sb",
            "addr"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "quota_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "244-253",
          "snippet": "static int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_enable",
          "args": [
            "sb",
            "addr"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "quota_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "233-242",
          "snippet": "static int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_sync",
          "args": [
            "sb",
            "type"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quota_setquota",
          "args": [
            "sb",
            "type",
            "id",
            "addr"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "quota_setquota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "215-231",
          "snippet": "static int quota_setquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&idq, addr, sizeof(idq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_if_dqblk(&fdq, &idq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &fdq);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_setquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&idq, addr, sizeof(idq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_if_dqblk(&fdq, &idq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &fdq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_getquota",
          "args": [
            "sb",
            "type",
            "id",
            "addr"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "quota_getquota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "167-187",
          "snippet": "static int quota_getquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct kqid qid;\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &fdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_if_dqblk(&idq, &fdq);\n\tif (copy_to_user(addr, &idq, sizeof(idq)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct kqid qid;\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &fdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_if_dqblk(&idq, &fdq);\n\tif (copy_to_user(addr, &idq, sizeof(idq)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_setinfo",
          "args": [
            "sb",
            "type",
            "addr"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "quota_setinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "132-141",
          "snippet": "static int quota_setinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\n\tif (copy_from_user(&info, addr, sizeof(info)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_info)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->set_info(sb, type, &info);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_setinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\n\tif (copy_from_user(&info, addr, sizeof(info)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_info)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->set_info(sb, type, &info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_getinfo",
          "args": [
            "sb",
            "type",
            "addr"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "quota_getinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "119-130",
          "snippet": "static int quota_getinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\tint ret;\n\n\tif (!sb->s_qcop->get_info)\n\t\treturn -ENOSYS;\n\tret = sb->s_qcop->get_info(sb, type, &info);\n\tif (!ret && copy_to_user(addr, &info, sizeof(info)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\tint ret;\n\n\tif (!sb->s_qcop->get_info)\n\t\treturn -ENOSYS;\n\tret = sb->s_qcop->get_info(sb, type, &info);\n\tif (!ret && copy_to_user(addr, &info, sizeof(info)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_getfmt",
          "args": [
            "sb",
            "type",
            "addr"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "quota_getfmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "103-117",
          "snippet": "static int quota_getfmt(struct super_block *sb, int type, void __user *addr)\n{\n\t__u32 fmt;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\t\treturn -ESRCH;\n\t}\n\tfmt = sb_dqopt(sb)->info[type].dqi_format->qf_fmt_id;\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (copy_to_user(addr, &fmt, sizeof(fmt)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getfmt(struct super_block *sb, int type, void __user *addr)\n{\n\t__u32 fmt;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\t\treturn -ESRCH;\n\t}\n\tfmt = sb_dqopt(sb)->info[type].dqi_format->qf_fmt_id;\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (copy_to_user(addr, &fmt, sizeof(fmt)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_quotaoff",
          "args": [
            "sb",
            "type"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "quota_quotaoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "94-101",
          "snippet": "static int quota_quotaoff(struct super_block *sb, int type)\n{\n\tif (!sb->s_qcop->quota_off && !sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_disable)\n\t\treturn sb->s_qcop->quota_disable(sb, qtype_enforce_flag(type));\n\treturn sb->s_qcop->quota_off(sb, type);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_quotaoff(struct super_block *sb, int type)\n{\n\tif (!sb->s_qcop->quota_off && !sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_disable)\n\t\treturn sb->s_qcop->quota_disable(sb, qtype_enforce_flag(type));\n\treturn sb->s_qcop->quota_off(sb, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_quotaon",
          "args": [
            "sb",
            "type",
            "cmd",
            "id",
            "path"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "quota_quotaon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "82-92",
          "snippet": "static int quota_quotaon(struct super_block *sb, int type, int cmd, qid_t id,\n\t\t         struct path *path)\n{\n\tif (!sb->s_qcop->quota_on && !sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_enable)\n\t\treturn sb->s_qcop->quota_enable(sb, qtype_enforce_flag(type));\n\tif (IS_ERR(path))\n\t\treturn PTR_ERR(path);\n\treturn sb->s_qcop->quota_on(sb, type, id, path);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_quotaon(struct super_block *sb, int type, int cmd, qid_t id,\n\t\t         struct path *path)\n{\n\tif (!sb->s_qcop->quota_on && !sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_enable)\n\t\treturn sb->s_qcop->quota_enable(sb, qtype_enforce_flag(type));\n\tif (IS_ERR(path))\n\t\treturn PTR_ERR(path);\n\treturn sb->s_qcop->quota_on(sb, type, id, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_quotactl_permission",
          "args": [
            "sb",
            "type",
            "cmd",
            "id"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "check_quotactl_permission",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "21-46",
          "snippet": "static int check_quotactl_permission(struct super_block *sb, int type, int cmd,\n\t\t\t\t     qid_t id)\n{\n\tswitch (cmd) {\n\t/* these commands do not require any special privilegues */\n\tcase Q_GETFMT:\n\tcase Q_SYNC:\n\tcase Q_GETINFO:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XQUOTASYNC:\n\t\tbreak;\n\t/* allow to query information for dquots we \"own\" */\n\tcase Q_GETQUOTA:\n\tcase Q_XGETQUOTA:\n\t\tif ((type == USRQUOTA && uid_eq(current_euid(), make_kuid(current_user_ns(), id))) ||\n\t\t    (type == GRPQUOTA && in_egroup_p(make_kgid(current_user_ns(), id))))\n\t\t\tbreak;\n\t\t/*FALLTHROUGH*/\n\tdefault:\n\t\tif (!capable(CAP_SYS_ADMIN))\n\t\t\treturn -EPERM;\n\t}\n\n\treturn security_quotactl(cmd, type, id, sb);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int check_quotactl_permission(struct super_block *sb, int type, int cmd,\n\t\t\t\t     qid_t id)\n{\n\tswitch (cmd) {\n\t/* these commands do not require any special privilegues */\n\tcase Q_GETFMT:\n\tcase Q_SYNC:\n\tcase Q_GETINFO:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XQUOTASYNC:\n\t\tbreak;\n\t/* allow to query information for dquots we \"own\" */\n\tcase Q_GETQUOTA:\n\tcase Q_XGETQUOTA:\n\t\tif ((type == USRQUOTA && uid_eq(current_euid(), make_kuid(current_user_ns(), id))) ||\n\t\t    (type == GRPQUOTA && in_egroup_p(make_kgid(current_user_ns(), id))))\n\t\t\tbreak;\n\t\t/*FALLTHROUGH*/\n\tdefault:\n\t\tif (!capable(CAP_SYS_ADMIN))\n\t\t\treturn -EPERM;\n\t}\n\n\treturn security_quotactl(cmd, type, id, sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "XQM_COMMAND",
          "args": [
            "cmd"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int do_quotactl(struct super_block *sb, int type, int cmd, qid_t id,\n\t\t       void __user *addr, struct path *path)\n{\n\tint ret;\n\n\tif (type >= (XQM_COMMAND(cmd) ? XQM_MAXQUOTAS : MAXQUOTAS))\n\t\treturn -EINVAL;\n\t/*\n\t * Quota not supported on this fs? Check this before s_quota_types\n\t * since they needn't be set if quota is not supported at all.\n\t */\n\tif (!sb->s_qcop)\n\t\treturn -ENOSYS;\n\tif (!(sb->s_quota_types & (1 << type)))\n\t\treturn -EINVAL;\n\n\tret = check_quotactl_permission(sb, type, cmd, id);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tswitch (cmd) {\n\tcase Q_QUOTAON:\n\t\treturn quota_quotaon(sb, type, cmd, id, path);\n\tcase Q_QUOTAOFF:\n\t\treturn quota_quotaoff(sb, type);\n\tcase Q_GETFMT:\n\t\treturn quota_getfmt(sb, type, addr);\n\tcase Q_GETINFO:\n\t\treturn quota_getinfo(sb, type, addr);\n\tcase Q_SETINFO:\n\t\treturn quota_setinfo(sb, type, addr);\n\tcase Q_GETQUOTA:\n\t\treturn quota_getquota(sb, type, id, addr);\n\tcase Q_SETQUOTA:\n\t\treturn quota_setquota(sb, type, id, addr);\n\tcase Q_SYNC:\n\t\tif (!sb->s_qcop->quota_sync)\n\t\t\treturn -ENOSYS;\n\t\treturn sb->s_qcop->quota_sync(sb, type);\n\tcase Q_XQUOTAON:\n\t\treturn quota_enable(sb, addr);\n\tcase Q_XQUOTAOFF:\n\t\treturn quota_disable(sb, addr);\n\tcase Q_XQUOTARM:\n\t\treturn quota_rmxquota(sb, addr);\n\tcase Q_XGETQSTAT:\n\t\treturn quota_getxstate(sb, addr);\n\tcase Q_XGETQSTATV:\n\t\treturn quota_getxstatev(sb, addr);\n\tcase Q_XSETQLIM:\n\t\treturn quota_setxquota(sb, type, id, addr);\n\tcase Q_XGETQUOTA:\n\t\treturn quota_getxquota(sb, type, id, addr);\n\tcase Q_XQUOTASYNC:\n\t\tif (sb->s_flags & MS_RDONLY)\n\t\t\treturn -EROFS;\n\t\t/* XFS quotas are fully coherent now, making this call a noop */\n\t\treturn 0;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}"
  },
  {
    "function_name": "quota_rmxquota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "429-438",
    "snippet": "static int quota_rmxquota(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->rm_xquota)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->rm_xquota(sb, flags);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->rm_xquota",
          "args": [
            "sb",
            "flags"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&flags",
            "addr",
            "sizeof(flags)"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_rmxquota(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->rm_xquota)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->rm_xquota(sb, flags);\n}"
  },
  {
    "function_name": "quota_getxquota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "407-427",
    "snippet": "static int quota_getxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &qdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_xfs_dqblk(&fdq, &qdq, type, id);\n\tif (copy_to_user(addr, &fdq, sizeof(fdq)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "addr",
            "&fdq",
            "sizeof(fdq)"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_to_xfs_dqblk",
          "args": [
            "&fdq",
            "&qdq",
            "type",
            "id"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "copy_to_xfs_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "378-405",
          "snippet": "static void copy_to_xfs_dqblk(struct fs_disk_quota *dst, struct qc_dqblk *src,\n\t\t\t      int type, qid_t id)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->d_version = FS_DQUOT_VERSION;\n\tdst->d_id = id;\n\tif (type == USRQUOTA)\n\t\tdst->d_flags = FS_USER_QUOTA;\n\telse if (type == PRJQUOTA)\n\t\tdst->d_flags = FS_PROJ_QUOTA;\n\telse\n\t\tdst->d_flags = FS_GROUP_QUOTA;\n\tdst->d_blk_hardlimit = quota_btobb(src->d_spc_hardlimit);\n\tdst->d_blk_softlimit = quota_btobb(src->d_spc_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_bcount = quota_btobb(src->d_space);\n\tdst->d_icount = src->d_ino_count;\n\tdst->d_itimer = src->d_ino_timer;\n\tdst->d_btimer = src->d_spc_timer;\n\tdst->d_iwarns = src->d_ino_warns;\n\tdst->d_bwarns = src->d_spc_warns;\n\tdst->d_rtb_hardlimit = quota_btobb(src->d_rt_spc_hardlimit);\n\tdst->d_rtb_softlimit = quota_btobb(src->d_rt_spc_softlimit);\n\tdst->d_rtbcount = quota_btobb(src->d_rt_space);\n\tdst->d_rtbtimer = src->d_rt_spc_timer;\n\tdst->d_rtbwarns = src->d_rt_spc_warns;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_to_xfs_dqblk(struct fs_disk_quota *dst, struct qc_dqblk *src,\n\t\t\t      int type, qid_t id)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->d_version = FS_DQUOT_VERSION;\n\tdst->d_id = id;\n\tif (type == USRQUOTA)\n\t\tdst->d_flags = FS_USER_QUOTA;\n\telse if (type == PRJQUOTA)\n\t\tdst->d_flags = FS_PROJ_QUOTA;\n\telse\n\t\tdst->d_flags = FS_GROUP_QUOTA;\n\tdst->d_blk_hardlimit = quota_btobb(src->d_spc_hardlimit);\n\tdst->d_blk_softlimit = quota_btobb(src->d_spc_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_bcount = quota_btobb(src->d_space);\n\tdst->d_icount = src->d_ino_count;\n\tdst->d_itimer = src->d_ino_timer;\n\tdst->d_btimer = src->d_spc_timer;\n\tdst->d_iwarns = src->d_ino_warns;\n\tdst->d_bwarns = src->d_spc_warns;\n\tdst->d_rtb_hardlimit = quota_btobb(src->d_rt_spc_hardlimit);\n\tdst->d_rtb_softlimit = quota_btobb(src->d_rt_spc_softlimit);\n\tdst->d_rtbcount = quota_btobb(src->d_rt_space);\n\tdst->d_rtbtimer = src->d_rt_spc_timer;\n\tdst->d_rtbwarns = src->d_rt_spc_warns;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->get_dqblk",
          "args": [
            "sb",
            "qid",
            "&qdq"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qid_valid",
          "args": [
            "qid"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "qid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "119-131",
          "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "current_user_ns()",
            "type",
            "id"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &qdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_xfs_dqblk(&fdq, &qdq, type, id);\n\tif (copy_to_user(addr, &fdq, sizeof(fdq)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
  },
  {
    "function_name": "copy_to_xfs_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "378-405",
    "snippet": "static void copy_to_xfs_dqblk(struct fs_disk_quota *dst, struct qc_dqblk *src,\n\t\t\t      int type, qid_t id)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->d_version = FS_DQUOT_VERSION;\n\tdst->d_id = id;\n\tif (type == USRQUOTA)\n\t\tdst->d_flags = FS_USER_QUOTA;\n\telse if (type == PRJQUOTA)\n\t\tdst->d_flags = FS_PROJ_QUOTA;\n\telse\n\t\tdst->d_flags = FS_GROUP_QUOTA;\n\tdst->d_blk_hardlimit = quota_btobb(src->d_spc_hardlimit);\n\tdst->d_blk_softlimit = quota_btobb(src->d_spc_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_bcount = quota_btobb(src->d_space);\n\tdst->d_icount = src->d_ino_count;\n\tdst->d_itimer = src->d_ino_timer;\n\tdst->d_btimer = src->d_spc_timer;\n\tdst->d_iwarns = src->d_ino_warns;\n\tdst->d_bwarns = src->d_spc_warns;\n\tdst->d_rtb_hardlimit = quota_btobb(src->d_rt_spc_hardlimit);\n\tdst->d_rtb_softlimit = quota_btobb(src->d_rt_spc_softlimit);\n\tdst->d_rtbcount = quota_btobb(src->d_rt_space);\n\tdst->d_rtbtimer = src->d_rt_spc_timer;\n\tdst->d_rtbwarns = src->d_rt_spc_warns;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_btobb",
          "args": [
            "src->d_rt_space"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "quota_btobb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "305-308",
          "snippet": "static inline u64 quota_btobb(u64 bytes)\n{\n\treturn (bytes + (1 << XFS_BB_SHIFT) - 1) >> XFS_BB_SHIFT;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define XFS_BB_SHIFT 9"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\n#define XFS_BB_SHIFT 9\n\nstatic inline u64 quota_btobb(u64 bytes)\n{\n\treturn (bytes + (1 << XFS_BB_SHIFT) - 1) >> XFS_BB_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "dst",
            "0",
            "sizeof(*dst)"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_to_xfs_dqblk(struct fs_disk_quota *dst, struct qc_dqblk *src,\n\t\t\t      int type, qid_t id)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->d_version = FS_DQUOT_VERSION;\n\tdst->d_id = id;\n\tif (type == USRQUOTA)\n\t\tdst->d_flags = FS_USER_QUOTA;\n\telse if (type == PRJQUOTA)\n\t\tdst->d_flags = FS_PROJ_QUOTA;\n\telse\n\t\tdst->d_flags = FS_GROUP_QUOTA;\n\tdst->d_blk_hardlimit = quota_btobb(src->d_spc_hardlimit);\n\tdst->d_blk_softlimit = quota_btobb(src->d_spc_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_bcount = quota_btobb(src->d_space);\n\tdst->d_icount = src->d_ino_count;\n\tdst->d_itimer = src->d_ino_timer;\n\tdst->d_btimer = src->d_spc_timer;\n\tdst->d_iwarns = src->d_ino_warns;\n\tdst->d_bwarns = src->d_spc_warns;\n\tdst->d_rtb_hardlimit = quota_btobb(src->d_rt_spc_hardlimit);\n\tdst->d_rtb_softlimit = quota_btobb(src->d_rt_spc_softlimit);\n\tdst->d_rtbcount = quota_btobb(src->d_rt_space);\n\tdst->d_rtbtimer = src->d_rt_spc_timer;\n\tdst->d_rtbwarns = src->d_rt_spc_warns;\n}"
  },
  {
    "function_name": "quota_setxquota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "360-376",
    "snippet": "static int quota_setxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&fdq, addr, sizeof(fdq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_xfs_dqblk(&qdq, &fdq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &qdq);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->set_dqblk",
          "args": [
            "sb",
            "qid",
            "&qdq"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_xfs_dqblk",
          "args": [
            "&qdq",
            "&fdq"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "copy_from_xfs_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "310-358",
          "snippet": "static void copy_from_xfs_dqblk(struct qc_dqblk *dst, struct fs_disk_quota *src)\n{\n\tdst->d_spc_hardlimit = quota_bbtob(src->d_blk_hardlimit);\n\tdst->d_spc_softlimit = quota_bbtob(src->d_blk_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_space = quota_bbtob(src->d_bcount);\n\tdst->d_ino_count = src->d_icount;\n\tdst->d_ino_timer = src->d_itimer;\n\tdst->d_spc_timer = src->d_btimer;\n\tdst->d_ino_warns = src->d_iwarns;\n\tdst->d_spc_warns = src->d_bwarns;\n\tdst->d_rt_spc_hardlimit = quota_bbtob(src->d_rtb_hardlimit);\n\tdst->d_rt_spc_softlimit = quota_bbtob(src->d_rtb_softlimit);\n\tdst->d_rt_space = quota_bbtob(src->d_rtbcount);\n\tdst->d_rt_spc_timer = src->d_rtbtimer;\n\tdst->d_rt_spc_warns = src->d_rtbwarns;\n\tdst->d_fieldmask = 0;\n\tif (src->d_fieldmask & FS_DQ_ISOFT)\n\t\tdst->d_fieldmask |= QC_INO_SOFT;\n\tif (src->d_fieldmask & FS_DQ_IHARD)\n\t\tdst->d_fieldmask |= QC_INO_HARD;\n\tif (src->d_fieldmask & FS_DQ_BSOFT)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_BHARD)\n\t\tdst->d_fieldmask |= QC_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_RTBSOFT)\n\t\tdst->d_fieldmask |= QC_RT_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_RTBHARD)\n\t\tdst->d_fieldmask |= QC_RT_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_BTIMER)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_ITIMER)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n\tif (src->d_fieldmask & FS_DQ_RTBTIMER)\n\t\tdst->d_fieldmask |= QC_RT_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_BWARNS)\n\t\tdst->d_fieldmask |= QC_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_IWARNS)\n\t\tdst->d_fieldmask |= QC_INO_WARNS;\n\tif (src->d_fieldmask & FS_DQ_RTBWARNS)\n\t\tdst->d_fieldmask |= QC_RT_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_BCOUNT)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->d_fieldmask & FS_DQ_ICOUNT)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->d_fieldmask & FS_DQ_RTBCOUNT)\n\t\tdst->d_fieldmask |= QC_RT_SPACE;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_from_xfs_dqblk(struct qc_dqblk *dst, struct fs_disk_quota *src)\n{\n\tdst->d_spc_hardlimit = quota_bbtob(src->d_blk_hardlimit);\n\tdst->d_spc_softlimit = quota_bbtob(src->d_blk_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_space = quota_bbtob(src->d_bcount);\n\tdst->d_ino_count = src->d_icount;\n\tdst->d_ino_timer = src->d_itimer;\n\tdst->d_spc_timer = src->d_btimer;\n\tdst->d_ino_warns = src->d_iwarns;\n\tdst->d_spc_warns = src->d_bwarns;\n\tdst->d_rt_spc_hardlimit = quota_bbtob(src->d_rtb_hardlimit);\n\tdst->d_rt_spc_softlimit = quota_bbtob(src->d_rtb_softlimit);\n\tdst->d_rt_space = quota_bbtob(src->d_rtbcount);\n\tdst->d_rt_spc_timer = src->d_rtbtimer;\n\tdst->d_rt_spc_warns = src->d_rtbwarns;\n\tdst->d_fieldmask = 0;\n\tif (src->d_fieldmask & FS_DQ_ISOFT)\n\t\tdst->d_fieldmask |= QC_INO_SOFT;\n\tif (src->d_fieldmask & FS_DQ_IHARD)\n\t\tdst->d_fieldmask |= QC_INO_HARD;\n\tif (src->d_fieldmask & FS_DQ_BSOFT)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_BHARD)\n\t\tdst->d_fieldmask |= QC_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_RTBSOFT)\n\t\tdst->d_fieldmask |= QC_RT_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_RTBHARD)\n\t\tdst->d_fieldmask |= QC_RT_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_BTIMER)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_ITIMER)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n\tif (src->d_fieldmask & FS_DQ_RTBTIMER)\n\t\tdst->d_fieldmask |= QC_RT_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_BWARNS)\n\t\tdst->d_fieldmask |= QC_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_IWARNS)\n\t\tdst->d_fieldmask |= QC_INO_WARNS;\n\tif (src->d_fieldmask & FS_DQ_RTBWARNS)\n\t\tdst->d_fieldmask |= QC_RT_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_BCOUNT)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->d_fieldmask & FS_DQ_ICOUNT)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->d_fieldmask & FS_DQ_RTBCOUNT)\n\t\tdst->d_fieldmask |= QC_RT_SPACE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qid_valid",
          "args": [
            "qid"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "qid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "119-131",
          "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "current_user_ns()",
            "type",
            "id"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&fdq",
            "addr",
            "sizeof(fdq)"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_setxquota(struct super_block *sb, int type, qid_t id,\n\t\t\t   void __user *addr)\n{\n\tstruct fs_disk_quota fdq;\n\tstruct qc_dqblk qdq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&fdq, addr, sizeof(fdq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_xfs_dqblk(&qdq, &fdq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &qdq);\n}"
  },
  {
    "function_name": "copy_from_xfs_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "310-358",
    "snippet": "static void copy_from_xfs_dqblk(struct qc_dqblk *dst, struct fs_disk_quota *src)\n{\n\tdst->d_spc_hardlimit = quota_bbtob(src->d_blk_hardlimit);\n\tdst->d_spc_softlimit = quota_bbtob(src->d_blk_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_space = quota_bbtob(src->d_bcount);\n\tdst->d_ino_count = src->d_icount;\n\tdst->d_ino_timer = src->d_itimer;\n\tdst->d_spc_timer = src->d_btimer;\n\tdst->d_ino_warns = src->d_iwarns;\n\tdst->d_spc_warns = src->d_bwarns;\n\tdst->d_rt_spc_hardlimit = quota_bbtob(src->d_rtb_hardlimit);\n\tdst->d_rt_spc_softlimit = quota_bbtob(src->d_rtb_softlimit);\n\tdst->d_rt_space = quota_bbtob(src->d_rtbcount);\n\tdst->d_rt_spc_timer = src->d_rtbtimer;\n\tdst->d_rt_spc_warns = src->d_rtbwarns;\n\tdst->d_fieldmask = 0;\n\tif (src->d_fieldmask & FS_DQ_ISOFT)\n\t\tdst->d_fieldmask |= QC_INO_SOFT;\n\tif (src->d_fieldmask & FS_DQ_IHARD)\n\t\tdst->d_fieldmask |= QC_INO_HARD;\n\tif (src->d_fieldmask & FS_DQ_BSOFT)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_BHARD)\n\t\tdst->d_fieldmask |= QC_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_RTBSOFT)\n\t\tdst->d_fieldmask |= QC_RT_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_RTBHARD)\n\t\tdst->d_fieldmask |= QC_RT_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_BTIMER)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_ITIMER)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n\tif (src->d_fieldmask & FS_DQ_RTBTIMER)\n\t\tdst->d_fieldmask |= QC_RT_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_BWARNS)\n\t\tdst->d_fieldmask |= QC_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_IWARNS)\n\t\tdst->d_fieldmask |= QC_INO_WARNS;\n\tif (src->d_fieldmask & FS_DQ_RTBWARNS)\n\t\tdst->d_fieldmask |= QC_RT_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_BCOUNT)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->d_fieldmask & FS_DQ_ICOUNT)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->d_fieldmask & FS_DQ_RTBCOUNT)\n\t\tdst->d_fieldmask |= QC_RT_SPACE;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_bbtob",
          "args": [
            "src->d_rtbcount"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "quota_bbtob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "300-303",
          "snippet": "static inline u64 quota_bbtob(u64 blocks)\n{\n\treturn blocks << XFS_BB_SHIFT;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define XFS_BB_SHIFT 9"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\n#define XFS_BB_SHIFT 9\n\nstatic inline u64 quota_bbtob(u64 blocks)\n{\n\treturn blocks << XFS_BB_SHIFT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_from_xfs_dqblk(struct qc_dqblk *dst, struct fs_disk_quota *src)\n{\n\tdst->d_spc_hardlimit = quota_bbtob(src->d_blk_hardlimit);\n\tdst->d_spc_softlimit = quota_bbtob(src->d_blk_softlimit);\n\tdst->d_ino_hardlimit = src->d_ino_hardlimit;\n\tdst->d_ino_softlimit = src->d_ino_softlimit;\n\tdst->d_space = quota_bbtob(src->d_bcount);\n\tdst->d_ino_count = src->d_icount;\n\tdst->d_ino_timer = src->d_itimer;\n\tdst->d_spc_timer = src->d_btimer;\n\tdst->d_ino_warns = src->d_iwarns;\n\tdst->d_spc_warns = src->d_bwarns;\n\tdst->d_rt_spc_hardlimit = quota_bbtob(src->d_rtb_hardlimit);\n\tdst->d_rt_spc_softlimit = quota_bbtob(src->d_rtb_softlimit);\n\tdst->d_rt_space = quota_bbtob(src->d_rtbcount);\n\tdst->d_rt_spc_timer = src->d_rtbtimer;\n\tdst->d_rt_spc_warns = src->d_rtbwarns;\n\tdst->d_fieldmask = 0;\n\tif (src->d_fieldmask & FS_DQ_ISOFT)\n\t\tdst->d_fieldmask |= QC_INO_SOFT;\n\tif (src->d_fieldmask & FS_DQ_IHARD)\n\t\tdst->d_fieldmask |= QC_INO_HARD;\n\tif (src->d_fieldmask & FS_DQ_BSOFT)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_BHARD)\n\t\tdst->d_fieldmask |= QC_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_RTBSOFT)\n\t\tdst->d_fieldmask |= QC_RT_SPC_SOFT;\n\tif (src->d_fieldmask & FS_DQ_RTBHARD)\n\t\tdst->d_fieldmask |= QC_RT_SPC_HARD;\n\tif (src->d_fieldmask & FS_DQ_BTIMER)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_ITIMER)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n\tif (src->d_fieldmask & FS_DQ_RTBTIMER)\n\t\tdst->d_fieldmask |= QC_RT_SPC_TIMER;\n\tif (src->d_fieldmask & FS_DQ_BWARNS)\n\t\tdst->d_fieldmask |= QC_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_IWARNS)\n\t\tdst->d_fieldmask |= QC_INO_WARNS;\n\tif (src->d_fieldmask & FS_DQ_RTBWARNS)\n\t\tdst->d_fieldmask |= QC_RT_SPC_WARNS;\n\tif (src->d_fieldmask & FS_DQ_BCOUNT)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->d_fieldmask & FS_DQ_ICOUNT)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->d_fieldmask & FS_DQ_RTBCOUNT)\n\t\tdst->d_fieldmask |= QC_RT_SPACE;\n}"
  },
  {
    "function_name": "quota_btobb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "305-308",
    "snippet": "static inline u64 quota_btobb(u64 bytes)\n{\n\treturn (bytes + (1 << XFS_BB_SHIFT) - 1) >> XFS_BB_SHIFT;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define XFS_BB_SHIFT 9"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\n#define XFS_BB_SHIFT 9\n\nstatic inline u64 quota_btobb(u64 bytes)\n{\n\treturn (bytes + (1 << XFS_BB_SHIFT) - 1) >> XFS_BB_SHIFT;\n}"
  },
  {
    "function_name": "quota_bbtob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "300-303",
    "snippet": "static inline u64 quota_bbtob(u64 blocks)\n{\n\treturn blocks << XFS_BB_SHIFT;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define XFS_BB_SHIFT 9"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\n#define XFS_BB_SHIFT 9\n\nstatic inline u64 quota_bbtob(u64 blocks)\n{\n\treturn blocks << XFS_BB_SHIFT;\n}"
  },
  {
    "function_name": "quota_getxstatev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "268-291",
    "snippet": "static int quota_getxstatev(struct super_block *sb, void __user *addr)\n{\n\tstruct fs_quota_statv fqs;\n\tint ret;\n\n\tif (!sb->s_qcop->get_xstatev)\n\t\treturn -ENOSYS;\n\n\tmemset(&fqs, 0, sizeof(fqs));\n\tif (copy_from_user(&fqs, addr, 1)) /* Just read qs_version */\n\t\treturn -EFAULT;\n\n\t/* If this kernel doesn't support user specified version, fail */\n\tswitch (fqs.qs_version) {\n\tcase FS_QSTATV_VERSION1:\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tret = sb->s_qcop->get_xstatev(sb, &fqs);\n\tif (!ret && copy_to_user(addr, &fqs, sizeof(fqs)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "addr",
            "&fqs",
            "sizeof(fqs)"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->get_xstatev",
          "args": [
            "sb",
            "&fqs"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&fqs",
            "addr",
            "1"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fqs",
            "0",
            "sizeof(fqs)"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getxstatev(struct super_block *sb, void __user *addr)\n{\n\tstruct fs_quota_statv fqs;\n\tint ret;\n\n\tif (!sb->s_qcop->get_xstatev)\n\t\treturn -ENOSYS;\n\n\tmemset(&fqs, 0, sizeof(fqs));\n\tif (copy_from_user(&fqs, addr, 1)) /* Just read qs_version */\n\t\treturn -EFAULT;\n\n\t/* If this kernel doesn't support user specified version, fail */\n\tswitch (fqs.qs_version) {\n\tcase FS_QSTATV_VERSION1:\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tret = sb->s_qcop->get_xstatev(sb, &fqs);\n\tif (!ret && copy_to_user(addr, &fqs, sizeof(fqs)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
  },
  {
    "function_name": "quota_getxstate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "255-266",
    "snippet": "static int quota_getxstate(struct super_block *sb, void __user *addr)\n{\n\tstruct fs_quota_stat fqs;\n\tint ret;\n\n\tif (!sb->s_qcop->get_xstate)\n\t\treturn -ENOSYS;\n\tret = sb->s_qcop->get_xstate(sb, &fqs);\n\tif (!ret && copy_to_user(addr, &fqs, sizeof(fqs)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "addr",
            "&fqs",
            "sizeof(fqs)"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->get_xstate",
          "args": [
            "sb",
            "&fqs"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getxstate(struct super_block *sb, void __user *addr)\n{\n\tstruct fs_quota_stat fqs;\n\tint ret;\n\n\tif (!sb->s_qcop->get_xstate)\n\t\treturn -ENOSYS;\n\tret = sb->s_qcop->get_xstate(sb, &fqs);\n\tif (!ret && copy_to_user(addr, &fqs, sizeof(fqs)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
  },
  {
    "function_name": "quota_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "244-253",
    "snippet": "static int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_disable",
          "args": [
            "sb",
            "flags"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "quota_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "244-253",
          "snippet": "static int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&flags",
            "addr",
            "sizeof(flags)"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}"
  },
  {
    "function_name": "quota_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "233-242",
    "snippet": "static int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_enable",
          "args": [
            "sb",
            "flags"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "quota_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "233-242",
          "snippet": "static int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&flags",
            "addr",
            "sizeof(flags)"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}"
  },
  {
    "function_name": "quota_setquota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "215-231",
    "snippet": "static int quota_setquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&idq, addr, sizeof(idq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_if_dqblk(&fdq, &idq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &fdq);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->set_dqblk",
          "args": [
            "sb",
            "qid",
            "&fdq"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_if_dqblk",
          "args": [
            "&fdq",
            "&idq"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "copy_from_if_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "189-213",
          "snippet": "static void copy_from_if_dqblk(struct qc_dqblk *dst, struct if_dqblk *src)\n{\n\tdst->d_spc_hardlimit = qbtos(src->dqb_bhardlimit);\n\tdst->d_spc_softlimit = qbtos(src->dqb_bsoftlimit);\n\tdst->d_space = src->dqb_curspace;\n\tdst->d_ino_hardlimit = src->dqb_ihardlimit;\n\tdst->d_ino_softlimit = src->dqb_isoftlimit;\n\tdst->d_ino_count = src->dqb_curinodes;\n\tdst->d_spc_timer = src->dqb_btime;\n\tdst->d_ino_timer = src->dqb_itime;\n\n\tdst->d_fieldmask = 0;\n\tif (src->dqb_valid & QIF_BLIMITS)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT | QC_SPC_HARD;\n\tif (src->dqb_valid & QIF_SPACE)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->dqb_valid & QIF_ILIMITS)\n\t\tdst->d_fieldmask |= QC_INO_SOFT | QC_INO_HARD;\n\tif (src->dqb_valid & QIF_INODES)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->dqb_valid & QIF_BTIME)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->dqb_valid & QIF_ITIME)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_from_if_dqblk(struct qc_dqblk *dst, struct if_dqblk *src)\n{\n\tdst->d_spc_hardlimit = qbtos(src->dqb_bhardlimit);\n\tdst->d_spc_softlimit = qbtos(src->dqb_bsoftlimit);\n\tdst->d_space = src->dqb_curspace;\n\tdst->d_ino_hardlimit = src->dqb_ihardlimit;\n\tdst->d_ino_softlimit = src->dqb_isoftlimit;\n\tdst->d_ino_count = src->dqb_curinodes;\n\tdst->d_spc_timer = src->dqb_btime;\n\tdst->d_ino_timer = src->dqb_itime;\n\n\tdst->d_fieldmask = 0;\n\tif (src->dqb_valid & QIF_BLIMITS)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT | QC_SPC_HARD;\n\tif (src->dqb_valid & QIF_SPACE)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->dqb_valid & QIF_ILIMITS)\n\t\tdst->d_fieldmask |= QC_INO_SOFT | QC_INO_HARD;\n\tif (src->dqb_valid & QIF_INODES)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->dqb_valid & QIF_BTIME)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->dqb_valid & QIF_ITIME)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qid_valid",
          "args": [
            "qid"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "qid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "119-131",
          "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "current_user_ns()",
            "type",
            "id"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&idq",
            "addr",
            "sizeof(idq)"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_setquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tstruct kqid qid;\n\n\tif (copy_from_user(&idq, addr, sizeof(idq)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tcopy_from_if_dqblk(&fdq, &idq);\n\treturn sb->s_qcop->set_dqblk(sb, qid, &fdq);\n}"
  },
  {
    "function_name": "copy_from_if_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "189-213",
    "snippet": "static void copy_from_if_dqblk(struct qc_dqblk *dst, struct if_dqblk *src)\n{\n\tdst->d_spc_hardlimit = qbtos(src->dqb_bhardlimit);\n\tdst->d_spc_softlimit = qbtos(src->dqb_bsoftlimit);\n\tdst->d_space = src->dqb_curspace;\n\tdst->d_ino_hardlimit = src->dqb_ihardlimit;\n\tdst->d_ino_softlimit = src->dqb_isoftlimit;\n\tdst->d_ino_count = src->dqb_curinodes;\n\tdst->d_spc_timer = src->dqb_btime;\n\tdst->d_ino_timer = src->dqb_itime;\n\n\tdst->d_fieldmask = 0;\n\tif (src->dqb_valid & QIF_BLIMITS)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT | QC_SPC_HARD;\n\tif (src->dqb_valid & QIF_SPACE)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->dqb_valid & QIF_ILIMITS)\n\t\tdst->d_fieldmask |= QC_INO_SOFT | QC_INO_HARD;\n\tif (src->dqb_valid & QIF_INODES)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->dqb_valid & QIF_BTIME)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->dqb_valid & QIF_ITIME)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qbtos",
          "args": [
            "src->dqb_bsoftlimit"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "qbtos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "143-146",
          "snippet": "static inline qsize_t qbtos(qsize_t blocks)\n{\n\treturn blocks << QIF_DQBLKSIZE_BITS;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic inline qsize_t qbtos(qsize_t blocks)\n{\n\treturn blocks << QIF_DQBLKSIZE_BITS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_from_if_dqblk(struct qc_dqblk *dst, struct if_dqblk *src)\n{\n\tdst->d_spc_hardlimit = qbtos(src->dqb_bhardlimit);\n\tdst->d_spc_softlimit = qbtos(src->dqb_bsoftlimit);\n\tdst->d_space = src->dqb_curspace;\n\tdst->d_ino_hardlimit = src->dqb_ihardlimit;\n\tdst->d_ino_softlimit = src->dqb_isoftlimit;\n\tdst->d_ino_count = src->dqb_curinodes;\n\tdst->d_spc_timer = src->dqb_btime;\n\tdst->d_ino_timer = src->dqb_itime;\n\n\tdst->d_fieldmask = 0;\n\tif (src->dqb_valid & QIF_BLIMITS)\n\t\tdst->d_fieldmask |= QC_SPC_SOFT | QC_SPC_HARD;\n\tif (src->dqb_valid & QIF_SPACE)\n\t\tdst->d_fieldmask |= QC_SPACE;\n\tif (src->dqb_valid & QIF_ILIMITS)\n\t\tdst->d_fieldmask |= QC_INO_SOFT | QC_INO_HARD;\n\tif (src->dqb_valid & QIF_INODES)\n\t\tdst->d_fieldmask |= QC_INO_COUNT;\n\tif (src->dqb_valid & QIF_BTIME)\n\t\tdst->d_fieldmask |= QC_SPC_TIMER;\n\tif (src->dqb_valid & QIF_ITIME)\n\t\tdst->d_fieldmask |= QC_INO_TIMER;\n}"
  },
  {
    "function_name": "quota_getquota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "167-187",
    "snippet": "static int quota_getquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct kqid qid;\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &fdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_if_dqblk(&idq, &fdq);\n\tif (copy_to_user(addr, &idq, sizeof(idq)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "addr",
            "&idq",
            "sizeof(idq)"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_to_if_dqblk",
          "args": [
            "&idq",
            "&fdq"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "copy_to_if_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "153-165",
          "snippet": "static void copy_to_if_dqblk(struct if_dqblk *dst, struct qc_dqblk *src)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->dqb_bhardlimit = stoqb(src->d_spc_hardlimit);\n\tdst->dqb_bsoftlimit = stoqb(src->d_spc_softlimit);\n\tdst->dqb_curspace = src->d_space;\n\tdst->dqb_ihardlimit = src->d_ino_hardlimit;\n\tdst->dqb_isoftlimit = src->d_ino_softlimit;\n\tdst->dqb_curinodes = src->d_ino_count;\n\tdst->dqb_btime = src->d_spc_timer;\n\tdst->dqb_itime = src->d_ino_timer;\n\tdst->dqb_valid = QIF_ALL;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_to_if_dqblk(struct if_dqblk *dst, struct qc_dqblk *src)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->dqb_bhardlimit = stoqb(src->d_spc_hardlimit);\n\tdst->dqb_bsoftlimit = stoqb(src->d_spc_softlimit);\n\tdst->dqb_curspace = src->d_space;\n\tdst->dqb_ihardlimit = src->d_ino_hardlimit;\n\tdst->dqb_isoftlimit = src->d_ino_softlimit;\n\tdst->dqb_curinodes = src->d_ino_count;\n\tdst->dqb_btime = src->d_spc_timer;\n\tdst->dqb_itime = src->d_ino_timer;\n\tdst->dqb_valid = QIF_ALL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->get_dqblk",
          "args": [
            "sb",
            "qid",
            "&fdq"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qid_valid",
          "args": [
            "qid"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "qid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "119-131",
          "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "current_user_ns()",
            "type",
            "id"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getquota(struct super_block *sb, int type, qid_t id,\n\t\t\t  void __user *addr)\n{\n\tstruct kqid qid;\n\tstruct qc_dqblk fdq;\n\tstruct if_dqblk idq;\n\tint ret;\n\n\tif (!sb->s_qcop->get_dqblk)\n\t\treturn -ENOSYS;\n\tqid = make_kqid(current_user_ns(), type, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\tret = sb->s_qcop->get_dqblk(sb, qid, &fdq);\n\tif (ret)\n\t\treturn ret;\n\tcopy_to_if_dqblk(&idq, &fdq);\n\tif (copy_to_user(addr, &idq, sizeof(idq)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "copy_to_if_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "153-165",
    "snippet": "static void copy_to_if_dqblk(struct if_dqblk *dst, struct qc_dqblk *src)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->dqb_bhardlimit = stoqb(src->d_spc_hardlimit);\n\tdst->dqb_bsoftlimit = stoqb(src->d_spc_softlimit);\n\tdst->dqb_curspace = src->d_space;\n\tdst->dqb_ihardlimit = src->d_ino_hardlimit;\n\tdst->dqb_isoftlimit = src->d_ino_softlimit;\n\tdst->dqb_curinodes = src->d_ino_count;\n\tdst->dqb_btime = src->d_spc_timer;\n\tdst->dqb_itime = src->d_ino_timer;\n\tdst->dqb_valid = QIF_ALL;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stoqb",
          "args": [
            "src->d_spc_softlimit"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "stoqb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "148-151",
          "snippet": "static inline qsize_t stoqb(qsize_t space)\n{\n\treturn (space + QIF_DQBLKSIZE - 1) >> QIF_DQBLKSIZE_BITS;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic inline qsize_t stoqb(qsize_t space)\n{\n\treturn (space + QIF_DQBLKSIZE - 1) >> QIF_DQBLKSIZE_BITS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "dst",
            "0",
            "sizeof(*dst)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void copy_to_if_dqblk(struct if_dqblk *dst, struct qc_dqblk *src)\n{\n\tmemset(dst, 0, sizeof(*dst));\n\tdst->dqb_bhardlimit = stoqb(src->d_spc_hardlimit);\n\tdst->dqb_bsoftlimit = stoqb(src->d_spc_softlimit);\n\tdst->dqb_curspace = src->d_space;\n\tdst->dqb_ihardlimit = src->d_ino_hardlimit;\n\tdst->dqb_isoftlimit = src->d_ino_softlimit;\n\tdst->dqb_curinodes = src->d_ino_count;\n\tdst->dqb_btime = src->d_spc_timer;\n\tdst->dqb_itime = src->d_ino_timer;\n\tdst->dqb_valid = QIF_ALL;\n}"
  },
  {
    "function_name": "stoqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "148-151",
    "snippet": "static inline qsize_t stoqb(qsize_t space)\n{\n\treturn (space + QIF_DQBLKSIZE - 1) >> QIF_DQBLKSIZE_BITS;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic inline qsize_t stoqb(qsize_t space)\n{\n\treturn (space + QIF_DQBLKSIZE - 1) >> QIF_DQBLKSIZE_BITS;\n}"
  },
  {
    "function_name": "qbtos",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "143-146",
    "snippet": "static inline qsize_t qbtos(qsize_t blocks)\n{\n\treturn blocks << QIF_DQBLKSIZE_BITS;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic inline qsize_t qbtos(qsize_t blocks)\n{\n\treturn blocks << QIF_DQBLKSIZE_BITS;\n}"
  },
  {
    "function_name": "quota_setinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "132-141",
    "snippet": "static int quota_setinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\n\tif (copy_from_user(&info, addr, sizeof(info)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_info)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->set_info(sb, type, &info);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->set_info",
          "args": [
            "sb",
            "type",
            "&info"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&info",
            "addr",
            "sizeof(info)"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_setinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\n\tif (copy_from_user(&info, addr, sizeof(info)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->set_info)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->set_info(sb, type, &info);\n}"
  },
  {
    "function_name": "quota_getinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "119-130",
    "snippet": "static int quota_getinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\tint ret;\n\n\tif (!sb->s_qcop->get_info)\n\t\treturn -ENOSYS;\n\tret = sb->s_qcop->get_info(sb, type, &info);\n\tif (!ret && copy_to_user(addr, &info, sizeof(info)))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "addr",
            "&info",
            "sizeof(info)"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->get_info",
          "args": [
            "sb",
            "type",
            "&info"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getinfo(struct super_block *sb, int type, void __user *addr)\n{\n\tstruct if_dqinfo info;\n\tint ret;\n\n\tif (!sb->s_qcop->get_info)\n\t\treturn -ENOSYS;\n\tret = sb->s_qcop->get_info(sb, type, &info);\n\tif (!ret && copy_to_user(addr, &info, sizeof(info)))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
  },
  {
    "function_name": "quota_getfmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "103-117",
    "snippet": "static int quota_getfmt(struct super_block *sb, int type, void __user *addr)\n{\n\t__u32 fmt;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\t\treturn -ESRCH;\n\t}\n\tfmt = sb_dqopt(sb)->info[type].dqi_format->qf_fmt_id;\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (copy_to_user(addr, &fmt, sizeof(fmt)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "addr",
            "&fmt",
            "sizeof(fmt)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "type"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_getfmt(struct super_block *sb, int type, void __user *addr)\n{\n\t__u32 fmt;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\t\treturn -ESRCH;\n\t}\n\tfmt = sb_dqopt(sb)->info[type].dqi_format->qf_fmt_id;\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (copy_to_user(addr, &fmt, sizeof(fmt)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "quota_quotaoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "94-101",
    "snippet": "static int quota_quotaoff(struct super_block *sb, int type)\n{\n\tif (!sb->s_qcop->quota_off && !sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_disable)\n\t\treturn sb->s_qcop->quota_disable(sb, qtype_enforce_flag(type));\n\treturn sb->s_qcop->quota_off(sb, type);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_off",
          "args": [
            "sb",
            "type"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_disable",
          "args": [
            "sb",
            "qtype_enforce_flag(type)"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "quota_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "244-253",
          "snippet": "static int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_disable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_disable(sb, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qtype_enforce_flag",
          "args": [
            "type"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "qtype_enforce_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "69-80",
          "snippet": "unsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nunsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_quotaoff(struct super_block *sb, int type)\n{\n\tif (!sb->s_qcop->quota_off && !sb->s_qcop->quota_disable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_disable)\n\t\treturn sb->s_qcop->quota_disable(sb, qtype_enforce_flag(type));\n\treturn sb->s_qcop->quota_off(sb, type);\n}"
  },
  {
    "function_name": "quota_quotaon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "82-92",
    "snippet": "static int quota_quotaon(struct super_block *sb, int type, int cmd, qid_t id,\n\t\t         struct path *path)\n{\n\tif (!sb->s_qcop->quota_on && !sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_enable)\n\t\treturn sb->s_qcop->quota_enable(sb, qtype_enforce_flag(type));\n\tif (IS_ERR(path))\n\t\treturn PTR_ERR(path);\n\treturn sb->s_qcop->quota_on(sb, type, id, path);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_on",
          "args": [
            "sb",
            "type",
            "id",
            "path"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "path"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "path"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_enable",
          "args": [
            "sb",
            "qtype_enforce_flag(type)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "quota_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "233-242",
          "snippet": "static int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_enable(struct super_block *sb, void __user *addr)\n{\n\t__u32 flags;\n\n\tif (copy_from_user(&flags, addr, sizeof(flags)))\n\t\treturn -EFAULT;\n\tif (!sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\treturn sb->s_qcop->quota_enable(sb, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qtype_enforce_flag",
          "args": [
            "type"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "qtype_enforce_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "69-80",
          "snippet": "unsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nunsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_quotaon(struct super_block *sb, int type, int cmd, qid_t id,\n\t\t         struct path *path)\n{\n\tif (!sb->s_qcop->quota_on && !sb->s_qcop->quota_enable)\n\t\treturn -ENOSYS;\n\tif (sb->s_qcop->quota_enable)\n\t\treturn sb->s_qcop->quota_enable(sb, qtype_enforce_flag(type));\n\tif (IS_ERR(path))\n\t\treturn PTR_ERR(path);\n\treturn sb->s_qcop->quota_on(sb, type, id, path);\n}"
  },
  {
    "function_name": "qtype_enforce_flag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "69-80",
    "snippet": "unsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nunsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "quota_sync_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "57-67",
    "snippet": "static int quota_sync_all(int type)\n{\n\tint ret;\n\n\tif (type >= MAXQUOTAS)\n\t\treturn -EINVAL;\n\tret = security_quotactl(Q_SYNC, type, 0, NULL);\n\tif (!ret)\n\t\titerate_supers(quota_sync_one, &type);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iterate_supers",
          "args": [
            "quota_sync_one",
            "&type"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_quotactl",
          "args": [
            "Q_SYNC",
            "type",
            "0",
            "NULL"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int quota_sync_all(int type)\n{\n\tint ret;\n\n\tif (type >= MAXQUOTAS)\n\t\treturn -EINVAL;\n\tret = security_quotactl(Q_SYNC, type, 0, NULL);\n\tif (!ret)\n\t\titerate_supers(quota_sync_one, &type);\n\treturn ret;\n}"
  },
  {
    "function_name": "quota_sync_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "48-55",
    "snippet": "static void quota_sync_one(struct super_block *sb, void *arg)\n{\n\tint type = *(int *)arg;\n\n\tif (sb->s_qcop && sb->s_qcop->quota_sync &&\n\t    (sb->s_quota_types & (1 << type)))\n\t\tsb->s_qcop->quota_sync(sb, type);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_qcop->quota_sync",
          "args": [
            "sb",
            "type"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic void quota_sync_one(struct super_block *sb, void *arg)\n{\n\tint type = *(int *)arg;\n\n\tif (sb->s_qcop && sb->s_qcop->quota_sync &&\n\t    (sb->s_quota_types & (1 << type)))\n\t\tsb->s_qcop->quota_sync(sb, type);\n}"
  },
  {
    "function_name": "check_quotactl_permission",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
    "lines": "21-46",
    "snippet": "static int check_quotactl_permission(struct super_block *sb, int type, int cmd,\n\t\t\t\t     qid_t id)\n{\n\tswitch (cmd) {\n\t/* these commands do not require any special privilegues */\n\tcase Q_GETFMT:\n\tcase Q_SYNC:\n\tcase Q_GETINFO:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XQUOTASYNC:\n\t\tbreak;\n\t/* allow to query information for dquots we \"own\" */\n\tcase Q_GETQUOTA:\n\tcase Q_XGETQUOTA:\n\t\tif ((type == USRQUOTA && uid_eq(current_euid(), make_kuid(current_user_ns(), id))) ||\n\t\t    (type == GRPQUOTA && in_egroup_p(make_kgid(current_user_ns(), id))))\n\t\t\tbreak;\n\t\t/*FALLTHROUGH*/\n\tdefault:\n\t\tif (!capable(CAP_SYS_ADMIN))\n\t\t\treturn -EPERM;\n\t}\n\n\treturn security_quotactl(cmd, type, id, sb);\n}",
    "includes": [
      "#include <linux/writeback.h>",
      "#include <linux/types.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/kernel.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/current.h>",
      "#include <linux/slab.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_quotactl",
          "args": [
            "cmd",
            "type",
            "id",
            "sb"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "in_egroup_p",
          "args": [
            "make_kgid(current_user_ns(), id)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "current_user_ns()",
            "id"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "current_euid()",
            "make_kuid(current_user_ns(), id)"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "current_user_ns()",
            "id"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_euid",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nstatic int check_quotactl_permission(struct super_block *sb, int type, int cmd,\n\t\t\t\t     qid_t id)\n{\n\tswitch (cmd) {\n\t/* these commands do not require any special privilegues */\n\tcase Q_GETFMT:\n\tcase Q_SYNC:\n\tcase Q_GETINFO:\n\tcase Q_XGETQSTAT:\n\tcase Q_XGETQSTATV:\n\tcase Q_XQUOTASYNC:\n\t\tbreak;\n\t/* allow to query information for dquots we \"own\" */\n\tcase Q_GETQUOTA:\n\tcase Q_XGETQUOTA:\n\t\tif ((type == USRQUOTA && uid_eq(current_euid(), make_kuid(current_user_ns(), id))) ||\n\t\t    (type == GRPQUOTA && in_egroup_p(make_kgid(current_user_ns(), id))))\n\t\t\tbreak;\n\t\t/*FALLTHROUGH*/\n\tdefault:\n\t\tif (!capable(CAP_SYS_ADMIN))\n\t\t\treturn -EPERM;\n\t}\n\n\treturn security_quotactl(cmd, type, id, sb);\n}"
  }
]