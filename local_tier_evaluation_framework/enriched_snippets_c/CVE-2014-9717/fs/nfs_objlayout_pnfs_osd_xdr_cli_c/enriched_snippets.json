[
  {
    "function_name": "pnfs_osd_xdr_ioerr_reserve_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "406-415",
    "snippet": "__be32 *pnfs_osd_xdr_ioerr_reserve_space(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 32 + 24);\n\tif (unlikely(!p))\n\t\tdprintk(\"%s: out of xdr space\\n\", __func__);\n\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: out of xdr space\\n\"",
            "__func__"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "32 + 24"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\n__be32 *pnfs_osd_xdr_ioerr_reserve_space(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 32 + 24);\n\tif (unlikely(!p))\n\t\tdprintk(\"%s: out of xdr space\\n\", __func__);\n\n\treturn p;\n}"
  },
  {
    "function_name": "pnfs_osd_xdr_encode_ioerr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "397-404",
    "snippet": "void pnfs_osd_xdr_encode_ioerr(__be32 *p, struct pnfs_osd_ioerr *ioerr)\n{\n\tp = pnfs_osd_xdr_encode_objid(p, &ioerr->oer_component);\n\tp = xdr_encode_hyper(p, ioerr->oer_comp_offset);\n\tp = xdr_encode_hyper(p, ioerr->oer_comp_length);\n\t*p++ = cpu_to_be32(ioerr->oer_iswrite);\n\t*p   = cpu_to_be32(ioerr->oer_errno);\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ioerr->oer_errno"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ioerr->oer_iswrite"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "ioerr->oer_comp_length"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "ioerr->oer_comp_offset"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pnfs_osd_xdr_encode_objid",
          "args": [
            "p",
            "&ioerr->oer_component"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "pnfs_osd_xdr_encode_objid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "377-386",
          "snippet": "static inline __be32 *\npnfs_osd_xdr_encode_objid(__be32 *p, struct pnfs_osd_objid *object_id)\n{\n\tp = xdr_encode_opaque_fixed(p, &object_id->oid_device_id.data,\n\t\t\t\t    sizeof(object_id->oid_device_id.data));\n\tp = xdr_encode_hyper(p, object_id->oid_partition_id);\n\tp = xdr_encode_hyper(p, object_id->oid_object_id);\n\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic inline __be32 *\npnfs_osd_xdr_encode_objid(__be32 *p, struct pnfs_osd_objid *object_id)\n{\n\tp = xdr_encode_opaque_fixed(p, &object_id->oid_device_id.data,\n\t\t\t\t    sizeof(object_id->oid_device_id.data));\n\tp = xdr_encode_hyper(p, object_id->oid_partition_id);\n\tp = xdr_encode_hyper(p, object_id->oid_object_id);\n\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nvoid pnfs_osd_xdr_encode_ioerr(__be32 *p, struct pnfs_osd_ioerr *ioerr)\n{\n\tp = pnfs_osd_xdr_encode_objid(p, &ioerr->oer_component);\n\tp = xdr_encode_hyper(p, ioerr->oer_comp_offset);\n\tp = xdr_encode_hyper(p, ioerr->oer_comp_length);\n\t*p++ = cpu_to_be32(ioerr->oer_iswrite);\n\t*p   = cpu_to_be32(ioerr->oer_errno);\n}"
  },
  {
    "function_name": "pnfs_osd_xdr_encode_objid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "377-386",
    "snippet": "static inline __be32 *\npnfs_osd_xdr_encode_objid(__be32 *p, struct pnfs_osd_objid *object_id)\n{\n\tp = xdr_encode_opaque_fixed(p, &object_id->oid_device_id.data,\n\t\t\t\t    sizeof(object_id->oid_device_id.data));\n\tp = xdr_encode_hyper(p, object_id->oid_partition_id);\n\tp = xdr_encode_hyper(p, object_id->oid_object_id);\n\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "object_id->oid_object_id"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "object_id->oid_partition_id"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "&object_id->oid_device_id.data",
            "sizeof(object_id->oid_device_id.data)"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic inline __be32 *\npnfs_osd_xdr_encode_objid(__be32 *p, struct pnfs_osd_objid *object_id)\n{\n\tp = xdr_encode_opaque_fixed(p, &object_id->oid_device_id.data,\n\t\t\t\t    sizeof(object_id->oid_device_id.data));\n\tp = xdr_encode_hyper(p, object_id->oid_partition_id);\n\tp = xdr_encode_hyper(p, object_id->oid_object_id);\n\n\treturn p;\n}"
  },
  {
    "function_name": "pnfs_osd_xdr_encode_layoutupdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "354-368",
    "snippet": "int\npnfs_osd_xdr_encode_layoutupdate(struct xdr_stream *xdr,\n\t\t\t\t struct pnfs_osd_layoutupdate *lou)\n{\n\t__be32 *p = xdr_reserve_space(xdr,  4 + 8 + 4);\n\n\tif (!p)\n\t\treturn -E2BIG;\n\n\t*p++ = cpu_to_be32(lou->dsu_valid);\n\tif (lou->dsu_valid)\n\t\tp = xdr_encode_hyper(p, lou->dsu_delta);\n\t*p++ = cpu_to_be32(lou->olu_ioerr_flag);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "lou->olu_ioerr_flag"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "lou->dsu_delta"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "lou->dsu_valid"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 8 + 4"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nint\npnfs_osd_xdr_encode_layoutupdate(struct xdr_stream *xdr,\n\t\t\t\t struct pnfs_osd_layoutupdate *lou)\n{\n\t__be32 *p = xdr_reserve_space(xdr,  4 + 8 + 4);\n\n\tif (!p)\n\t\treturn -E2BIG;\n\n\t*p++ = cpu_to_be32(lou->dsu_valid);\n\tif (lou->dsu_valid)\n\t\tp = xdr_encode_hyper(p, lou->dsu_delta);\n\t*p++ = cpu_to_be32(lou->olu_ioerr_flag);\n\treturn 0;\n}"
  },
  {
    "function_name": "pnfs_osd_xdr_decode_deviceaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "327-345",
    "snippet": "void pnfs_osd_xdr_decode_deviceaddr(\n\tstruct pnfs_osd_deviceaddr *deviceaddr, __be32 *p)\n{\n\tp = __read_targetid(p, &deviceaddr->oda_targetid);\n\n\tp = __read_targetaddr(p, &deviceaddr->oda_targetaddr);\n\n\tp = xdr_decode_opaque_fixed(p, deviceaddr->oda_lun,\n\t\t\t\t    sizeof(deviceaddr->oda_lun));\n\n\tp = __read_u8_opaque(p, &deviceaddr->oda_systemid);\n\n\tp = __read_object_cred(p, &deviceaddr->oda_root_obj_cred);\n\n\tp = __read_u8_opaque(p, &deviceaddr->oda_osdname);\n\n\t/* libosd likes this terminated in dbg. It's last, so no problems */\n\tdeviceaddr->oda_osdname.data[deviceaddr->oda_osdname.len] = 0;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_u8_opaque",
          "args": [
            "p",
            "&deviceaddr->oda_osdname"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "__read_u8_opaque",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "223-231",
          "snippet": "static __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__read_object_cred",
          "args": [
            "p",
            "&deviceaddr->oda_root_obj_cred"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "__read_object_cred",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "315-325",
          "snippet": "static __be32 *\n__read_object_cred(__be32 *p, struct pnfs_osd_object_cred *comp)\n{\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p++);\n\n\tp = __read_opaque_cred(p, &comp->oc_cap_key);\n\tp = __read_opaque_cred(p, &comp->oc_cap);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_object_cred(__be32 *p, struct pnfs_osd_object_cred *comp)\n{\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p++);\n\n\tp = __read_opaque_cred(p, &comp->oc_cap_key);\n\tp = __read_opaque_cred(p, &comp->oc_cap);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_opaque_fixed",
          "args": [
            "p",
            "deviceaddr->oda_lun",
            "sizeof(deviceaddr->oda_lun)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__read_targetaddr",
          "args": [
            "p",
            "&deviceaddr->oda_targetaddr"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "__read_targetaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "277-290",
          "snippet": "static __be32 *\n__read_targetaddr(__be32 *p, struct pnfs_osd_targetaddr *targetaddr)\n{\n\tu32 ota_available;\n\n\tota_available = be32_to_cpup(p++);\n\ttargetaddr->ota_available = ota_available;\n\n\tif (ota_available)\n\t\tp = __read_net_addr(p, &targetaddr->ota_netaddr);\n\n\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_targetaddr(__be32 *p, struct pnfs_osd_targetaddr *targetaddr)\n{\n\tu32 ota_available;\n\n\tota_available = be32_to_cpup(p++);\n\ttargetaddr->ota_available = ota_available;\n\n\tif (ota_available)\n\t\tp = __read_net_addr(p, &targetaddr->ota_netaddr);\n\n\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__read_targetid",
          "args": [
            "p",
            "&deviceaddr->oda_targetid"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "__read_targetid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "239-254",
          "snippet": "static __be32 *\n__read_targetid(__be32 *p, struct pnfs_osd_targetid* targetid)\n{\n\tu32 oti_type;\n\n\toti_type = be32_to_cpup(p++);\n\ttargetid->oti_type = oti_type;\n\n\tswitch (oti_type) {\n\tcase OBJ_TARGET_SCSI_NAME:\n\tcase OBJ_TARGET_SCSI_DEVICE_ID:\n\t\tp = __read_u8_opaque(p, &targetid->oti_scsi_device_id);\n\t}\n\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_targetid(__be32 *p, struct pnfs_osd_targetid* targetid)\n{\n\tu32 oti_type;\n\n\toti_type = be32_to_cpup(p++);\n\ttargetid->oti_type = oti_type;\n\n\tswitch (oti_type) {\n\tcase OBJ_TARGET_SCSI_NAME:\n\tcase OBJ_TARGET_SCSI_DEVICE_ID:\n\t\tp = __read_u8_opaque(p, &targetid->oti_scsi_device_id);\n\t}\n\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nvoid pnfs_osd_xdr_decode_deviceaddr(\n\tstruct pnfs_osd_deviceaddr *deviceaddr, __be32 *p)\n{\n\tp = __read_targetid(p, &deviceaddr->oda_targetid);\n\n\tp = __read_targetaddr(p, &deviceaddr->oda_targetaddr);\n\n\tp = xdr_decode_opaque_fixed(p, deviceaddr->oda_lun,\n\t\t\t\t    sizeof(deviceaddr->oda_lun));\n\n\tp = __read_u8_opaque(p, &deviceaddr->oda_systemid);\n\n\tp = __read_object_cred(p, &deviceaddr->oda_root_obj_cred);\n\n\tp = __read_u8_opaque(p, &deviceaddr->oda_osdname);\n\n\t/* libosd likes this terminated in dbg. It's last, so no problems */\n\tdeviceaddr->oda_osdname.data[deviceaddr->oda_osdname.len] = 0;\n}"
  },
  {
    "function_name": "__read_object_cred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "315-325",
    "snippet": "static __be32 *\n__read_object_cred(__be32 *p, struct pnfs_osd_object_cred *comp)\n{\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p++);\n\n\tp = __read_opaque_cred(p, &comp->oc_cap_key);\n\tp = __read_opaque_cred(p, &comp->oc_cap);\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_opaque_cred",
          "args": [
            "p",
            "&comp->oc_cap"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "__read_opaque_cred",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "306-313",
          "snippet": "static __be32 *\n__read_opaque_cred(__be32 *p,\n\t\t\t      struct pnfs_osd_opaque_cred *opaque_cred)\n{\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\topaque_cred->cred = p;\n\treturn p + XDR_QUADLEN(opaque_cred->cred_len);\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_opaque_cred(__be32 *p,\n\t\t\t      struct pnfs_osd_opaque_cred *opaque_cred)\n{\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\topaque_cred->cred = p;\n\treturn p + XDR_QUADLEN(opaque_cred->cred_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_osd_xdr_decode_objid",
          "args": [
            "p",
            "&comp->oc_object_id"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "_osd_xdr_decode_objid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "55-64",
          "snippet": "static __be32 *\n_osd_xdr_decode_objid(__be32 *p, struct pnfs_osd_objid *objid)\n{\n\tp = xdr_decode_opaque_fixed(p, objid->oid_device_id.data,\n\t\t\t\t    sizeof(objid->oid_device_id.data));\n\n\tp = xdr_decode_hyper(p, &objid->oid_partition_id);\n\tp = xdr_decode_hyper(p, &objid->oid_object_id);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n_osd_xdr_decode_objid(__be32 *p, struct pnfs_osd_objid *objid)\n{\n\tp = xdr_decode_opaque_fixed(p, objid->oid_device_id.data,\n\t\t\t\t    sizeof(objid->oid_device_id.data));\n\n\tp = xdr_decode_hyper(p, &objid->oid_partition_id);\n\tp = xdr_decode_hyper(p, &objid->oid_object_id);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_object_cred(__be32 *p, struct pnfs_osd_object_cred *comp)\n{\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p++);\n\n\tp = __read_opaque_cred(p, &comp->oc_cap_key);\n\tp = __read_opaque_cred(p, &comp->oc_cap);\n\treturn p;\n}"
  },
  {
    "function_name": "__read_opaque_cred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "306-313",
    "snippet": "static __be32 *\n__read_opaque_cred(__be32 *p,\n\t\t\t      struct pnfs_osd_opaque_cred *opaque_cred)\n{\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\topaque_cred->cred = p;\n\treturn p + XDR_QUADLEN(opaque_cred->cred_len);\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "opaque_cred->cred_len"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*p++"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_opaque_cred(__be32 *p,\n\t\t\t      struct pnfs_osd_opaque_cred *opaque_cred)\n{\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\topaque_cred->cred = p;\n\treturn p + XDR_QUADLEN(opaque_cred->cred_len);\n}"
  },
  {
    "function_name": "__read_targetaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "277-290",
    "snippet": "static __be32 *\n__read_targetaddr(__be32 *p, struct pnfs_osd_targetaddr *targetaddr)\n{\n\tu32 ota_available;\n\n\tota_available = be32_to_cpup(p++);\n\ttargetaddr->ota_available = ota_available;\n\n\tif (ota_available)\n\t\tp = __read_net_addr(p, &targetaddr->ota_netaddr);\n\n\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_net_addr",
          "args": [
            "p",
            "&targetaddr->ota_netaddr"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "__read_net_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "262-269",
          "snippet": "static __be32 *\n__read_net_addr(__be32 *p, struct pnfs_osd_net_addr* netaddr)\n{\n\tp = __read_u8_opaque(p, &netaddr->r_netid);\n\tp = __read_u8_opaque(p, &netaddr->r_addr);\n\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_net_addr(__be32 *p, struct pnfs_osd_net_addr* netaddr)\n{\n\tp = __read_u8_opaque(p, &netaddr->r_netid);\n\tp = __read_u8_opaque(p, &netaddr->r_addr);\n\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_targetaddr(__be32 *p, struct pnfs_osd_targetaddr *targetaddr)\n{\n\tu32 ota_available;\n\n\tota_available = be32_to_cpup(p++);\n\ttargetaddr->ota_available = ota_available;\n\n\tif (ota_available)\n\t\tp = __read_net_addr(p, &targetaddr->ota_netaddr);\n\n\n\treturn p;\n}"
  },
  {
    "function_name": "__read_net_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "262-269",
    "snippet": "static __be32 *\n__read_net_addr(__be32 *p, struct pnfs_osd_net_addr* netaddr)\n{\n\tp = __read_u8_opaque(p, &netaddr->r_netid);\n\tp = __read_u8_opaque(p, &netaddr->r_addr);\n\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_u8_opaque",
          "args": [
            "p",
            "&netaddr->r_addr"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "__read_u8_opaque",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "223-231",
          "snippet": "static __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_net_addr(__be32 *p, struct pnfs_osd_net_addr* netaddr)\n{\n\tp = __read_u8_opaque(p, &netaddr->r_netid);\n\tp = __read_u8_opaque(p, &netaddr->r_addr);\n\n\treturn p;\n}"
  },
  {
    "function_name": "__read_targetid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "239-254",
    "snippet": "static __be32 *\n__read_targetid(__be32 *p, struct pnfs_osd_targetid* targetid)\n{\n\tu32 oti_type;\n\n\toti_type = be32_to_cpup(p++);\n\ttargetid->oti_type = oti_type;\n\n\tswitch (oti_type) {\n\tcase OBJ_TARGET_SCSI_NAME:\n\tcase OBJ_TARGET_SCSI_DEVICE_ID:\n\t\tp = __read_u8_opaque(p, &targetid->oti_scsi_device_id);\n\t}\n\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_u8_opaque",
          "args": [
            "p",
            "&targetid->oti_scsi_device_id"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "__read_u8_opaque",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "223-231",
          "snippet": "static __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_targetid(__be32 *p, struct pnfs_osd_targetid* targetid)\n{\n\tu32 oti_type;\n\n\toti_type = be32_to_cpup(p++);\n\ttargetid->oti_type = oti_type;\n\n\tswitch (oti_type) {\n\tcase OBJ_TARGET_SCSI_NAME:\n\tcase OBJ_TARGET_SCSI_DEVICE_ID:\n\t\tp = __read_u8_opaque(p, &targetid->oti_scsi_device_id);\n\t}\n\n\treturn p;\n}"
  },
  {
    "function_name": "__read_u8_opaque",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "223-231",
    "snippet": "static __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "str->len"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n__read_u8_opaque(__be32 *p, struct nfs4_string *str)\n{\n\tstr->len = be32_to_cpup(p++);\n\tstr->data = (char *)p;\n\n\tp += XDR_QUADLEN(str->len);\n\treturn p;\n}"
  },
  {
    "function_name": "pnfs_osd_xdr_decode_layout_comp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "180-206",
    "snippet": "bool pnfs_osd_xdr_decode_layout_comp(struct pnfs_osd_object_cred *comp,\n\tstruct pnfs_osd_xdr_decode_layout_iter *iter, struct xdr_stream *xdr,\n\tint *err)\n{\n\tBUG_ON(iter->decoded_comps > iter->total_comps);\n\tif (iter->decoded_comps == iter->total_comps)\n\t\treturn false;\n\n\t*err = _osd_xdr_decode_object_cred(comp, xdr);\n\tif (unlikely(*err)) {\n\t\tdprintk(\"%s: _osd_xdr_decode_object_cred=>%d decoded_comps=%d \"\n\t\t\t\"total_comps=%d\\n\", __func__, *err,\n\t\t\titer->decoded_comps, iter->total_comps);\n\t\treturn false; /* stop the loop */\n\t}\n\tdprintk(\"%s: dev(%llx:%llx) par=0x%llx obj=0x%llx \"\n\t\t\"key_len=%u cap_len=%u\\n\",\n\t\t__func__,\n\t\t_DEVID_LO(&comp->oc_object_id.oid_device_id),\n\t\t_DEVID_HI(&comp->oc_object_id.oid_device_id),\n\t\tcomp->oc_object_id.oid_partition_id,\n\t\tcomp->oc_object_id.oid_object_id,\n\t\tcomp->oc_cap_key.cred_len, comp->oc_cap.cred_len);\n\n\titer->decoded_comps++;\n\treturn true;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: dev(%llx:%llx) par=0x%llx obj=0x%llx \"\n\t\t\"key_len=%u cap_len=%u\\n\"",
            "__func__",
            "_DEVID_LO(&comp->oc_object_id.oid_device_id)",
            "_DEVID_HI(&comp->oc_object_id.oid_device_id)",
            "comp->oc_object_id.oid_partition_id",
            "comp->oc_object_id.oid_object_id",
            "comp->oc_cap_key.cred_len",
            "comp->oc_cap.cred_len"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_DEVID_HI",
          "args": [
            "&comp->oc_object_id.oid_device_id"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_DEVID_LO",
          "args": [
            "&comp->oc_object_id.oid_device_id"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: _osd_xdr_decode_object_cred=>%d decoded_comps=%d \"\n\t\t\t\"total_comps=%d\\n\"",
            "__func__",
            "*err",
            "iter->decoded_comps",
            "iter->total_comps"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "*err"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_osd_xdr_decode_object_cred",
          "args": [
            "comp",
            "xdr"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "_osd_xdr_decode_object_cred",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "100-120",
          "snippet": "static int\n_osd_xdr_decode_object_cred(struct pnfs_osd_object_cred *comp,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 32 + 4 + 4);\n\tint ret;\n\n\tif (!p)\n\t\treturn -EIO;\n\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p);\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap_key, xdr);\n\tif (unlikely(ret))\n\t\treturn ret;\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap, xdr);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic int\n_osd_xdr_decode_object_cred(struct pnfs_osd_object_cred *comp,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 32 + 4 + 4);\n\tint ret;\n\n\tif (!p)\n\t\treturn -EIO;\n\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p);\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap_key, xdr);\n\tif (unlikely(ret))\n\t\treturn ret;\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap, xdr);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "iter->decoded_comps > iter->total_comps"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nbool pnfs_osd_xdr_decode_layout_comp(struct pnfs_osd_object_cred *comp,\n\tstruct pnfs_osd_xdr_decode_layout_iter *iter, struct xdr_stream *xdr,\n\tint *err)\n{\n\tBUG_ON(iter->decoded_comps > iter->total_comps);\n\tif (iter->decoded_comps == iter->total_comps)\n\t\treturn false;\n\n\t*err = _osd_xdr_decode_object_cred(comp, xdr);\n\tif (unlikely(*err)) {\n\t\tdprintk(\"%s: _osd_xdr_decode_object_cred=>%d decoded_comps=%d \"\n\t\t\t\"total_comps=%d\\n\", __func__, *err,\n\t\t\titer->decoded_comps, iter->total_comps);\n\t\treturn false; /* stop the loop */\n\t}\n\tdprintk(\"%s: dev(%llx:%llx) par=0x%llx obj=0x%llx \"\n\t\t\"key_len=%u cap_len=%u\\n\",\n\t\t__func__,\n\t\t_DEVID_LO(&comp->oc_object_id.oid_device_id),\n\t\t_DEVID_HI(&comp->oc_object_id.oid_device_id),\n\t\tcomp->oc_object_id.oid_partition_id,\n\t\tcomp->oc_object_id.oid_object_id,\n\t\tcomp->oc_cap_key.cred_len, comp->oc_cap.cred_len);\n\n\titer->decoded_comps++;\n\treturn true;\n}"
  },
  {
    "function_name": "pnfs_osd_xdr_decode_layout_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "159-178",
    "snippet": "int pnfs_osd_xdr_decode_layout_map(struct pnfs_osd_layout *layout,\n\tstruct pnfs_osd_xdr_decode_layout_iter *iter, struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tp = xdr_inline_decode(xdr, _osd_data_map_xdr_sz() + 4 + 4);\n\tif (unlikely(!p))\n\t\treturn -EINVAL;\n\n\tp = _osd_xdr_decode_data_map(p, &layout->olo_map);\n\tlayout->olo_comps_index = be32_to_cpup(p++);\n\tlayout->olo_num_comps = be32_to_cpup(p++);\n\tdprintk(\"%s: olo_comps_index=%d olo_num_comps=%d\\n\", __func__,\n\t\tlayout->olo_comps_index, layout->olo_num_comps);\n\n\titer->total_comps = layout->olo_num_comps;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: olo_comps_index=%d olo_num_comps=%d\\n\"",
            "__func__",
            "layout->olo_comps_index",
            "layout->olo_num_comps"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_osd_xdr_decode_data_map",
          "args": [
            "p",
            "&layout->olo_map"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "_osd_xdr_decode_data_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "138-157",
          "snippet": "static __be32 *\n_osd_xdr_decode_data_map(__be32 *p, struct pnfs_osd_data_map *data_map)\n{\n\tdata_map->odm_num_comps = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &data_map->odm_stripe_unit);\n\tdata_map->odm_group_width = be32_to_cpup(p++);\n\tdata_map->odm_group_depth = be32_to_cpup(p++);\n\tdata_map->odm_mirror_cnt = be32_to_cpup(p++);\n\tdata_map->odm_raid_algorithm = be32_to_cpup(p++);\n\tdprintk(\"%s: odm_num_comps=%u odm_stripe_unit=%llu odm_group_width=%u \"\n\t\t\"odm_group_depth=%u odm_mirror_cnt=%u odm_raid_algorithm=%u\\n\",\n\t\t__func__,\n\t\tdata_map->odm_num_comps,\n\t\t(unsigned long long)data_map->odm_stripe_unit,\n\t\tdata_map->odm_group_width,\n\t\tdata_map->odm_group_depth,\n\t\tdata_map->odm_mirror_cnt,\n\t\tdata_map->odm_raid_algorithm);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n_osd_xdr_decode_data_map(__be32 *p, struct pnfs_osd_data_map *data_map)\n{\n\tdata_map->odm_num_comps = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &data_map->odm_stripe_unit);\n\tdata_map->odm_group_width = be32_to_cpup(p++);\n\tdata_map->odm_group_depth = be32_to_cpup(p++);\n\tdata_map->odm_mirror_cnt = be32_to_cpup(p++);\n\tdata_map->odm_raid_algorithm = be32_to_cpup(p++);\n\tdprintk(\"%s: odm_num_comps=%u odm_stripe_unit=%llu odm_group_width=%u \"\n\t\t\"odm_group_depth=%u odm_mirror_cnt=%u odm_raid_algorithm=%u\\n\",\n\t\t__func__,\n\t\tdata_map->odm_num_comps,\n\t\t(unsigned long long)data_map->odm_stripe_unit,\n\t\tdata_map->odm_group_width,\n\t\tdata_map->odm_group_depth,\n\t\tdata_map->odm_mirror_cnt,\n\t\tdata_map->odm_raid_algorithm);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "_osd_data_map_xdr_sz() + 4 + 4"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_osd_data_map_xdr_sz",
          "args": [],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "_osd_data_map_xdr_sz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "132-136",
          "snippet": "static inline int\n_osd_data_map_xdr_sz(void)\n{\n\treturn 4 + 8 + 4 + 4 + 4 + 4;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic inline int\n_osd_data_map_xdr_sz(void)\n{\n\treturn 4 + 8 + 4 + 4 + 4 + 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "iter",
            "0",
            "sizeof(*iter)"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nint pnfs_osd_xdr_decode_layout_map(struct pnfs_osd_layout *layout,\n\tstruct pnfs_osd_xdr_decode_layout_iter *iter, struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tmemset(iter, 0, sizeof(*iter));\n\n\tp = xdr_inline_decode(xdr, _osd_data_map_xdr_sz() + 4 + 4);\n\tif (unlikely(!p))\n\t\treturn -EINVAL;\n\n\tp = _osd_xdr_decode_data_map(p, &layout->olo_map);\n\tlayout->olo_comps_index = be32_to_cpup(p++);\n\tlayout->olo_num_comps = be32_to_cpup(p++);\n\tdprintk(\"%s: olo_comps_index=%d olo_num_comps=%d\\n\", __func__,\n\t\tlayout->olo_comps_index, layout->olo_num_comps);\n\n\titer->total_comps = layout->olo_num_comps;\n\treturn 0;\n}"
  },
  {
    "function_name": "_osd_xdr_decode_data_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "138-157",
    "snippet": "static __be32 *\n_osd_xdr_decode_data_map(__be32 *p, struct pnfs_osd_data_map *data_map)\n{\n\tdata_map->odm_num_comps = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &data_map->odm_stripe_unit);\n\tdata_map->odm_group_width = be32_to_cpup(p++);\n\tdata_map->odm_group_depth = be32_to_cpup(p++);\n\tdata_map->odm_mirror_cnt = be32_to_cpup(p++);\n\tdata_map->odm_raid_algorithm = be32_to_cpup(p++);\n\tdprintk(\"%s: odm_num_comps=%u odm_stripe_unit=%llu odm_group_width=%u \"\n\t\t\"odm_group_depth=%u odm_mirror_cnt=%u odm_raid_algorithm=%u\\n\",\n\t\t__func__,\n\t\tdata_map->odm_num_comps,\n\t\t(unsigned long long)data_map->odm_stripe_unit,\n\t\tdata_map->odm_group_width,\n\t\tdata_map->odm_group_depth,\n\t\tdata_map->odm_mirror_cnt,\n\t\tdata_map->odm_raid_algorithm);\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: odm_num_comps=%u odm_stripe_unit=%llu odm_group_width=%u \"\n\t\t\"odm_group_depth=%u odm_mirror_cnt=%u odm_raid_algorithm=%u\\n\"",
            "__func__",
            "data_map->odm_num_comps",
            "(unsigned long long)data_map->odm_stripe_unit",
            "data_map->odm_group_width",
            "data_map->odm_group_depth",
            "data_map->odm_mirror_cnt",
            "data_map->odm_raid_algorithm"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&data_map->odm_stripe_unit"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n_osd_xdr_decode_data_map(__be32 *p, struct pnfs_osd_data_map *data_map)\n{\n\tdata_map->odm_num_comps = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &data_map->odm_stripe_unit);\n\tdata_map->odm_group_width = be32_to_cpup(p++);\n\tdata_map->odm_group_depth = be32_to_cpup(p++);\n\tdata_map->odm_mirror_cnt = be32_to_cpup(p++);\n\tdata_map->odm_raid_algorithm = be32_to_cpup(p++);\n\tdprintk(\"%s: odm_num_comps=%u odm_stripe_unit=%llu odm_group_width=%u \"\n\t\t\"odm_group_depth=%u odm_mirror_cnt=%u odm_raid_algorithm=%u\\n\",\n\t\t__func__,\n\t\tdata_map->odm_num_comps,\n\t\t(unsigned long long)data_map->odm_stripe_unit,\n\t\tdata_map->odm_group_width,\n\t\tdata_map->odm_group_depth,\n\t\tdata_map->odm_mirror_cnt,\n\t\tdata_map->odm_raid_algorithm);\n\treturn p;\n}"
  },
  {
    "function_name": "_osd_data_map_xdr_sz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "132-136",
    "snippet": "static inline int\n_osd_data_map_xdr_sz(void)\n{\n\treturn 4 + 8 + 4 + 4 + 4 + 4;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic inline int\n_osd_data_map_xdr_sz(void)\n{\n\treturn 4 + 8 + 4 + 4 + 4 + 4;\n}"
  },
  {
    "function_name": "_osd_xdr_decode_object_cred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "100-120",
    "snippet": "static int\n_osd_xdr_decode_object_cred(struct pnfs_osd_object_cred *comp,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 32 + 4 + 4);\n\tint ret;\n\n\tif (!p)\n\t\treturn -EIO;\n\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p);\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap_key, xdr);\n\tif (unlikely(ret))\n\t\treturn ret;\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap, xdr);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_osd_xdr_decode_opaque_cred",
          "args": [
            "&comp->oc_cap",
            "xdr"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "_osd_xdr_decode_opaque_cred",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "72-89",
          "snippet": "static int\n_osd_xdr_decode_opaque_cred(struct pnfs_osd_opaque_cred *opaque_cred,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 1);\n\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\n\tp = xdr_inline_decode(xdr, opaque_cred->cred_len);\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred = p;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic int\n_osd_xdr_decode_opaque_cred(struct pnfs_osd_opaque_cred *opaque_cred,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 1);\n\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\n\tp = xdr_inline_decode(xdr, opaque_cred->cred_len);\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred = p;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_osd_xdr_decode_objid",
          "args": [
            "p",
            "&comp->oc_object_id"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "_osd_xdr_decode_objid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
          "lines": "55-64",
          "snippet": "static __be32 *\n_osd_xdr_decode_objid(__be32 *p, struct pnfs_osd_objid *objid)\n{\n\tp = xdr_decode_opaque_fixed(p, objid->oid_device_id.data,\n\t\t\t\t    sizeof(objid->oid_device_id.data));\n\n\tp = xdr_decode_hyper(p, &objid->oid_partition_id);\n\tp = xdr_decode_hyper(p, &objid->oid_object_id);\n\treturn p;\n}",
          "includes": [
            "#include <linux/pnfs_osd_xdr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n_osd_xdr_decode_objid(__be32 *p, struct pnfs_osd_objid *objid)\n{\n\tp = xdr_decode_opaque_fixed(p, objid->oid_device_id.data,\n\t\t\t\t    sizeof(objid->oid_device_id.data));\n\n\tp = xdr_decode_hyper(p, &objid->oid_partition_id);\n\tp = xdr_decode_hyper(p, &objid->oid_object_id);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "32 + 4 + 4"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic int\n_osd_xdr_decode_object_cred(struct pnfs_osd_object_cred *comp,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 32 + 4 + 4);\n\tint ret;\n\n\tif (!p)\n\t\treturn -EIO;\n\n\tp = _osd_xdr_decode_objid(p, &comp->oc_object_id);\n\tcomp->oc_osd_version = be32_to_cpup(p++);\n\tcomp->oc_cap_key_sec = be32_to_cpup(p);\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap_key, xdr);\n\tif (unlikely(ret))\n\t\treturn ret;\n\n\tret = _osd_xdr_decode_opaque_cred(&comp->oc_cap, xdr);\n\treturn ret;\n}"
  },
  {
    "function_name": "_osd_xdr_decode_opaque_cred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "72-89",
    "snippet": "static int\n_osd_xdr_decode_opaque_cred(struct pnfs_osd_opaque_cred *opaque_cred,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 1);\n\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\n\tp = xdr_inline_decode(xdr, opaque_cred->cred_len);\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred = p;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "opaque_cred->cred_len"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*p++"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "1"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic int\n_osd_xdr_decode_opaque_cred(struct pnfs_osd_opaque_cred *opaque_cred,\n\t\t\t    struct xdr_stream *xdr)\n{\n\t__be32 *p = xdr_inline_decode(xdr, 1);\n\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred_len = be32_to_cpu(*p++);\n\n\tp = xdr_inline_decode(xdr, opaque_cred->cred_len);\n\tif (!p)\n\t\treturn -EINVAL;\n\n\topaque_cred->cred = p;\n\treturn 0;\n}"
  },
  {
    "function_name": "_osd_xdr_decode_objid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/objlayout/pnfs_osd_xdr_cli.c",
    "lines": "55-64",
    "snippet": "static __be32 *\n_osd_xdr_decode_objid(__be32 *p, struct pnfs_osd_objid *objid)\n{\n\tp = xdr_decode_opaque_fixed(p, objid->oid_device_id.data,\n\t\t\t\t    sizeof(objid->oid_device_id.data));\n\n\tp = xdr_decode_hyper(p, &objid->oid_partition_id);\n\tp = xdr_decode_hyper(p, &objid->oid_object_id);\n\treturn p;\n}",
    "includes": [
      "#include <linux/pnfs_osd_xdr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&objid->oid_object_id"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&objid->oid_partition_id"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_opaque_fixed",
          "args": [
            "p",
            "objid->oid_device_id.data",
            "sizeof(objid->oid_device_id.data)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/pnfs_osd_xdr.h>\n\nstatic __be32 *\n_osd_xdr_decode_objid(__be32 *p, struct pnfs_osd_objid *objid)\n{\n\tp = xdr_decode_opaque_fixed(p, objid->oid_device_id.data,\n\t\t\t\t    sizeof(objid->oid_device_id.data));\n\n\tp = xdr_decode_hyper(p, &objid->oid_partition_id);\n\tp = xdr_decode_hyper(p, &objid->oid_object_id);\n\treturn p;\n}"
  }
]