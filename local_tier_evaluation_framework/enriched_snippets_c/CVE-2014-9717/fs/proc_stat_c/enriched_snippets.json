[
  {
    "function_name": "proc_stat_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "201-205",
    "snippet": "static int __init proc_stat_init(void)\n{\n\tproc_create(\"stat\", 0, NULL, &proc_stat_operations);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations proc_stat_operations = {\n\t.open\t\t= stat_open,\n\t.read\t\t= seq_read,\n\t.llseek\t\t= seq_lseek,\n\t.release\t= single_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"stat\"",
            "0",
            "NULL",
            "&proc_stat_operations"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic const struct file_operations proc_stat_operations = {\n\t.open\t\t= stat_open,\n\t.read\t\t= seq_read,\n\t.llseek\t\t= seq_lseek,\n\t.release\t= single_release,\n};\n\nstatic int __init proc_stat_init(void)\n{\n\tproc_create(\"stat\", 0, NULL, &proc_stat_operations);\n\treturn 0;\n}"
  },
  {
    "function_name": "stat_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "185-192",
    "snippet": "static int stat_open(struct inode *inode, struct file *file)\n{\n\tsize_t size = 1024 + 128 * num_online_cpus();\n\n\t/* minimum size to display an interrupt count : 2 bytes */\n\tsize += 2 * nr_irqs;\n\treturn single_open_size(file, show_stat, NULL, size);\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open_size",
          "args": [
            "file",
            "show_stat",
            "NULL",
            "size"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "single_open_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "578-593",
          "snippet": "int single_open_size(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data, size_t size)\n{\n\tchar *buf = seq_buf_alloc(size);\n\tint ret;\n\tif (!buf)\n\t\treturn -ENOMEM;\n\tret = single_open(file, show, data);\n\tif (ret) {\n\t\tkvfree(buf);\n\t\treturn ret;\n\t}\n\t((struct seq_file *)file->private_data)->buf = buf;\n\t((struct seq_file *)file->private_data)->size = size;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open_size(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data, size_t size)\n{\n\tchar *buf = seq_buf_alloc(size);\n\tint ret;\n\tif (!buf)\n\t\treturn -ENOMEM;\n\tret = single_open(file, show, data);\n\tif (ret) {\n\t\tkvfree(buf);\n\t\treturn ret;\n\t}\n\t((struct seq_file *)file->private_data)->buf = buf;\n\t((struct seq_file *)file->private_data)->size = size;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "num_online_cpus",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic int stat_open(struct inode *inode, struct file *file)\n{\n\tsize_t size = 1024 + 128 * num_online_cpus();\n\n\t/* minimum size to display an interrupt count : 2 bytes */\n\tsize += 2 * nr_irqs;\n\treturn single_open_size(file, show_stat, NULL, size);\n}"
  },
  {
    "function_name": "show_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "80-183",
    "snippet": "static int show_stat(struct seq_file *p, void *v)\n{\n\tint i, j;\n\tunsigned long jif;\n\tu64 user, nice, system, idle, iowait, irq, softirq, steal;\n\tu64 guest, guest_nice;\n\tu64 sum = 0;\n\tu64 sum_softirq = 0;\n\tunsigned int per_softirq_sums[NR_SOFTIRQS] = {0};\n\tstruct timespec boottime;\n\n\tuser = nice = system = idle = iowait =\n\t\tirq = softirq = steal = 0;\n\tguest = guest_nice = 0;\n\tgetboottime(&boottime);\n\tjif = boottime.tv_sec;\n\n\tfor_each_possible_cpu(i) {\n\t\tuser += kcpustat_cpu(i).cpustat[CPUTIME_USER];\n\t\tnice += kcpustat_cpu(i).cpustat[CPUTIME_NICE];\n\t\tsystem += kcpustat_cpu(i).cpustat[CPUTIME_SYSTEM];\n\t\tidle += get_idle_time(i);\n\t\tiowait += get_iowait_time(i);\n\t\tirq += kcpustat_cpu(i).cpustat[CPUTIME_IRQ];\n\t\tsoftirq += kcpustat_cpu(i).cpustat[CPUTIME_SOFTIRQ];\n\t\tsteal += kcpustat_cpu(i).cpustat[CPUTIME_STEAL];\n\t\tguest += kcpustat_cpu(i).cpustat[CPUTIME_GUEST];\n\t\tguest_nice += kcpustat_cpu(i).cpustat[CPUTIME_GUEST_NICE];\n\t\tsum += kstat_cpu_irqs_sum(i);\n\t\tsum += arch_irq_stat_cpu(i);\n\n\t\tfor (j = 0; j < NR_SOFTIRQS; j++) {\n\t\t\tunsigned int softirq_stat = kstat_softirqs_cpu(j, i);\n\n\t\t\tper_softirq_sums[j] += softirq_stat;\n\t\t\tsum_softirq += softirq_stat;\n\t\t}\n\t}\n\tsum += arch_irq_stat();\n\n\tseq_puts(p, \"cpu \");\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(user));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(nice));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(system));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(idle));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(iowait));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(irq));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(softirq));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(steal));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest_nice));\n\tseq_putc(p, '\\n');\n\n\tfor_each_online_cpu(i) {\n\t\t/* Copy values here to work around gcc-2.95.3, gcc-2.96 */\n\t\tuser = kcpustat_cpu(i).cpustat[CPUTIME_USER];\n\t\tnice = kcpustat_cpu(i).cpustat[CPUTIME_NICE];\n\t\tsystem = kcpustat_cpu(i).cpustat[CPUTIME_SYSTEM];\n\t\tidle = get_idle_time(i);\n\t\tiowait = get_iowait_time(i);\n\t\tirq = kcpustat_cpu(i).cpustat[CPUTIME_IRQ];\n\t\tsoftirq = kcpustat_cpu(i).cpustat[CPUTIME_SOFTIRQ];\n\t\tsteal = kcpustat_cpu(i).cpustat[CPUTIME_STEAL];\n\t\tguest = kcpustat_cpu(i).cpustat[CPUTIME_GUEST];\n\t\tguest_nice = kcpustat_cpu(i).cpustat[CPUTIME_GUEST_NICE];\n\t\tseq_printf(p, \"cpu%d\", i);\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(user));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(nice));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(system));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(idle));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(iowait));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(irq));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(softirq));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(steal));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest_nice));\n\t\tseq_putc(p, '\\n');\n\t}\n\tseq_printf(p, \"intr %llu\", (unsigned long long)sum);\n\n\t/* sum again ? it could be updated? */\n\tfor_each_irq_nr(j)\n\t\tseq_put_decimal_ull(p, ' ', kstat_irqs_usr(j));\n\n\tseq_printf(p,\n\t\t\"\\nctxt %llu\\n\"\n\t\t\"btime %lu\\n\"\n\t\t\"processes %lu\\n\"\n\t\t\"procs_running %lu\\n\"\n\t\t\"procs_blocked %lu\\n\",\n\t\tnr_context_switches(),\n\t\t(unsigned long)jif,\n\t\ttotal_forks,\n\t\tnr_running(),\n\t\tnr_iowait());\n\n\tseq_printf(p, \"softirq %llu\", (unsigned long long)sum_softirq);\n\n\tfor (i = 0; i < NR_SOFTIRQS; i++)\n\t\tseq_put_decimal_ull(p, ' ', per_softirq_sums[i]);\n\tseq_putc(p, '\\n');\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_putc",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "seq_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "648-655",
          "snippet": "int seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_put_decimal_ull",
          "args": [
            "p",
            "' '",
            "per_softirq_sums[i]"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "seq_put_decimal_ull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "678-702",
          "snippet": "int seq_put_decimal_ull(struct seq_file *m, char delimiter,\n\t\t\tunsigned long long num)\n{\n\tint len;\n\n\tif (m->count + 2 >= m->size) /* we'll write 2 bytes at least */\n\t\tgoto overflow;\n\n\tif (delimiter)\n\t\tm->buf[m->count++] = delimiter;\n\n\tif (num < 10) {\n\t\tm->buf[m->count++] = num + '0';\n\t\treturn 0;\n\t}\n\n\tlen = num_to_str(m->buf + m->count, m->size - m->count, num);\n\tif (!len)\n\t\tgoto overflow;\n\tm->count += len;\n\treturn 0;\noverflow:\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_put_decimal_ull(struct seq_file *m, char delimiter,\n\t\t\tunsigned long long num)\n{\n\tint len;\n\n\tif (m->count + 2 >= m->size) /* we'll write 2 bytes at least */\n\t\tgoto overflow;\n\n\tif (delimiter)\n\t\tm->buf[m->count++] = delimiter;\n\n\tif (num < 10) {\n\t\tm->buf[m->count++] = num + '0';\n\t\treturn 0;\n\t}\n\n\tlen = num_to_str(m->buf + m->count, m->size - m->count, num);\n\tif (!len)\n\t\tgoto overflow;\n\tm->count += len;\n\treturn 0;\noverflow:\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "p",
            "\"softirq %llu\"",
            "(unsigned long long)sum_softirq"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nr_iowait",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nr_running",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nr_context_switches",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "guest_nice"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "guest"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "steal"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "softirq"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "irq"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "iowait"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "idle"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "system"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "nice"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "user"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_iowait_time",
          "args": [
            "i"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "get_iowait_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
          "lines": "62-76",
          "snippet": "static u64 get_iowait_time(int cpu)\n{\n\tu64 iowait, iowait_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tiowait_time = get_cpu_iowait_time_us(cpu, NULL);\n\n\tif (iowait_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.iowait */\n\t\tiowait = kcpustat_cpu(cpu).cpustat[CPUTIME_IOWAIT];\n\telse\n\t\tiowait = usecs_to_cputime64(iowait_time);\n\n\treturn iowait;\n}",
          "includes": [
            "#include <linux/tick.h>",
            "#include <linux/cputime.h>",
            "#include <linux/irqnr.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/cpumask.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic u64 get_iowait_time(int cpu)\n{\n\tu64 iowait, iowait_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tiowait_time = get_cpu_iowait_time_us(cpu, NULL);\n\n\tif (iowait_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.iowait */\n\t\tiowait = kcpustat_cpu(cpu).cpustat[CPUTIME_IOWAIT];\n\telse\n\t\tiowait = usecs_to_cputime64(iowait_time);\n\n\treturn iowait;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_idle_time",
          "args": [
            "i"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "get_idle_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
          "lines": "46-60",
          "snippet": "static u64 get_idle_time(int cpu)\n{\n\tu64 idle, idle_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tidle_time = get_cpu_idle_time_us(cpu, NULL);\n\n\tif (idle_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.idle */\n\t\tidle = kcpustat_cpu(cpu).cpustat[CPUTIME_IDLE];\n\telse\n\t\tidle = usecs_to_cputime64(idle_time);\n\n\treturn idle;\n}",
          "includes": [
            "#include <linux/tick.h>",
            "#include <linux/cputime.h>",
            "#include <linux/irqnr.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/cpumask.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic u64 get_idle_time(int cpu)\n{\n\tu64 idle, idle_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tidle_time = get_cpu_idle_time_us(cpu, NULL);\n\n\tif (idle_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.idle */\n\t\tidle = kcpustat_cpu(cpu).cpustat[CPUTIME_IDLE];\n\telse\n\t\tidle = usecs_to_cputime64(idle_time);\n\n\treturn idle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "guest_nice"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "guest"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "steal"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "softirq"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "irq"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "iowait"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "idle"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "system"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "nice"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime64_to_clock_t",
          "args": [
            "user"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "p",
            "\"cpu \""
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_irq_stat",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstat_softirqs_cpu",
          "args": [
            "j",
            "i"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_irq_stat_cpu",
          "args": [
            "i"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstat_cpu_irqs_sum",
          "args": [
            "i"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "i"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getboottime",
          "args": [
            "&boottime"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic int show_stat(struct seq_file *p, void *v)\n{\n\tint i, j;\n\tunsigned long jif;\n\tu64 user, nice, system, idle, iowait, irq, softirq, steal;\n\tu64 guest, guest_nice;\n\tu64 sum = 0;\n\tu64 sum_softirq = 0;\n\tunsigned int per_softirq_sums[NR_SOFTIRQS] = {0};\n\tstruct timespec boottime;\n\n\tuser = nice = system = idle = iowait =\n\t\tirq = softirq = steal = 0;\n\tguest = guest_nice = 0;\n\tgetboottime(&boottime);\n\tjif = boottime.tv_sec;\n\n\tfor_each_possible_cpu(i) {\n\t\tuser += kcpustat_cpu(i).cpustat[CPUTIME_USER];\n\t\tnice += kcpustat_cpu(i).cpustat[CPUTIME_NICE];\n\t\tsystem += kcpustat_cpu(i).cpustat[CPUTIME_SYSTEM];\n\t\tidle += get_idle_time(i);\n\t\tiowait += get_iowait_time(i);\n\t\tirq += kcpustat_cpu(i).cpustat[CPUTIME_IRQ];\n\t\tsoftirq += kcpustat_cpu(i).cpustat[CPUTIME_SOFTIRQ];\n\t\tsteal += kcpustat_cpu(i).cpustat[CPUTIME_STEAL];\n\t\tguest += kcpustat_cpu(i).cpustat[CPUTIME_GUEST];\n\t\tguest_nice += kcpustat_cpu(i).cpustat[CPUTIME_GUEST_NICE];\n\t\tsum += kstat_cpu_irqs_sum(i);\n\t\tsum += arch_irq_stat_cpu(i);\n\n\t\tfor (j = 0; j < NR_SOFTIRQS; j++) {\n\t\t\tunsigned int softirq_stat = kstat_softirqs_cpu(j, i);\n\n\t\t\tper_softirq_sums[j] += softirq_stat;\n\t\t\tsum_softirq += softirq_stat;\n\t\t}\n\t}\n\tsum += arch_irq_stat();\n\n\tseq_puts(p, \"cpu \");\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(user));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(nice));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(system));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(idle));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(iowait));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(irq));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(softirq));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(steal));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest));\n\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest_nice));\n\tseq_putc(p, '\\n');\n\n\tfor_each_online_cpu(i) {\n\t\t/* Copy values here to work around gcc-2.95.3, gcc-2.96 */\n\t\tuser = kcpustat_cpu(i).cpustat[CPUTIME_USER];\n\t\tnice = kcpustat_cpu(i).cpustat[CPUTIME_NICE];\n\t\tsystem = kcpustat_cpu(i).cpustat[CPUTIME_SYSTEM];\n\t\tidle = get_idle_time(i);\n\t\tiowait = get_iowait_time(i);\n\t\tirq = kcpustat_cpu(i).cpustat[CPUTIME_IRQ];\n\t\tsoftirq = kcpustat_cpu(i).cpustat[CPUTIME_SOFTIRQ];\n\t\tsteal = kcpustat_cpu(i).cpustat[CPUTIME_STEAL];\n\t\tguest = kcpustat_cpu(i).cpustat[CPUTIME_GUEST];\n\t\tguest_nice = kcpustat_cpu(i).cpustat[CPUTIME_GUEST_NICE];\n\t\tseq_printf(p, \"cpu%d\", i);\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(user));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(nice));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(system));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(idle));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(iowait));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(irq));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(softirq));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(steal));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest));\n\t\tseq_put_decimal_ull(p, ' ', cputime64_to_clock_t(guest_nice));\n\t\tseq_putc(p, '\\n');\n\t}\n\tseq_printf(p, \"intr %llu\", (unsigned long long)sum);\n\n\t/* sum again ? it could be updated? */\n\tfor_each_irq_nr(j)\n\t\tseq_put_decimal_ull(p, ' ', kstat_irqs_usr(j));\n\n\tseq_printf(p,\n\t\t\"\\nctxt %llu\\n\"\n\t\t\"btime %lu\\n\"\n\t\t\"processes %lu\\n\"\n\t\t\"procs_running %lu\\n\"\n\t\t\"procs_blocked %lu\\n\",\n\t\tnr_context_switches(),\n\t\t(unsigned long)jif,\n\t\ttotal_forks,\n\t\tnr_running(),\n\t\tnr_iowait());\n\n\tseq_printf(p, \"softirq %llu\", (unsigned long long)sum_softirq);\n\n\tfor (i = 0; i < NR_SOFTIRQS; i++)\n\t\tseq_put_decimal_ull(p, ' ', per_softirq_sums[i]);\n\tseq_putc(p, '\\n');\n\n\treturn 0;\n}"
  },
  {
    "function_name": "get_iowait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "62-76",
    "snippet": "static u64 get_iowait_time(int cpu)\n{\n\tu64 iowait, iowait_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tiowait_time = get_cpu_iowait_time_us(cpu, NULL);\n\n\tif (iowait_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.iowait */\n\t\tiowait = kcpustat_cpu(cpu).cpustat[CPUTIME_IOWAIT];\n\telse\n\t\tiowait = usecs_to_cputime64(iowait_time);\n\n\treturn iowait;\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "usecs_to_cputime64",
          "args": [
            "iowait_time"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "cpu"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_iowait_time_us",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic u64 get_iowait_time(int cpu)\n{\n\tu64 iowait, iowait_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tiowait_time = get_cpu_iowait_time_us(cpu, NULL);\n\n\tif (iowait_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.iowait */\n\t\tiowait = kcpustat_cpu(cpu).cpustat[CPUTIME_IOWAIT];\n\telse\n\t\tiowait = usecs_to_cputime64(iowait_time);\n\n\treturn iowait;\n}"
  },
  {
    "function_name": "get_idle_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "46-60",
    "snippet": "static u64 get_idle_time(int cpu)\n{\n\tu64 idle, idle_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tidle_time = get_cpu_idle_time_us(cpu, NULL);\n\n\tif (idle_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.idle */\n\t\tidle = kcpustat_cpu(cpu).cpustat[CPUTIME_IDLE];\n\telse\n\t\tidle = usecs_to_cputime64(idle_time);\n\n\treturn idle;\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "usecs_to_cputime64",
          "args": [
            "idle_time"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "cpu"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_idle_time_us",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic u64 get_idle_time(int cpu)\n{\n\tu64 idle, idle_time = -1ULL;\n\n\tif (cpu_online(cpu))\n\t\tidle_time = get_cpu_idle_time_us(cpu, NULL);\n\n\tif (idle_time == -1ULL)\n\t\t/* !NO_HZ or cpu offline so we can rely on cpustat.idle */\n\t\tidle = kcpustat_cpu(cpu).cpustat[CPUTIME_IDLE];\n\telse\n\t\tidle = usecs_to_cputime64(idle_time);\n\n\treturn idle;\n}"
  },
  {
    "function_name": "get_iowait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "34-42",
    "snippet": "static cputime64_t get_iowait_time(int cpu)\n{\n\tcputime64_t iowait;\n\n\tiowait = kcpustat_cpu(cpu).cpustat[CPUTIME_IOWAIT];\n\tif (cpu_online(cpu) && nr_iowait_cpu(cpu))\n\t\tiowait += arch_idle_time(cpu);\n\treturn iowait;\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_idle_time",
          "args": [
            "cpu"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nr_iowait_cpu",
          "args": [
            "cpu"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "cpu"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic cputime64_t get_iowait_time(int cpu)\n{\n\tcputime64_t iowait;\n\n\tiowait = kcpustat_cpu(cpu).cpustat[CPUTIME_IOWAIT];\n\tif (cpu_online(cpu) && nr_iowait_cpu(cpu))\n\t\tiowait += arch_idle_time(cpu);\n\treturn iowait;\n}"
  },
  {
    "function_name": "get_idle_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/stat.c",
    "lines": "24-32",
    "snippet": "static cputime64_t get_idle_time(int cpu)\n{\n\tcputime64_t idle;\n\n\tidle = kcpustat_cpu(cpu).cpustat[CPUTIME_IDLE];\n\tif (cpu_online(cpu) && !nr_iowait_cpu(cpu))\n\t\tidle += arch_idle_time(cpu);\n\treturn idle;\n}",
    "includes": [
      "#include <linux/tick.h>",
      "#include <linux/cputime.h>",
      "#include <linux/irqnr.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>",
      "#include <linux/cpumask.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_idle_time",
          "args": [
            "cpu"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nr_iowait_cpu",
          "args": [
            "cpu"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcpustat_cpu",
          "args": [
            "cpu"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tick.h>\n#include <linux/cputime.h>\n#include <linux/irqnr.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/cpumask.h>\n\nstatic cputime64_t get_idle_time(int cpu)\n{\n\tcputime64_t idle;\n\n\tidle = kcpustat_cpu(cpu).cpustat[CPUTIME_IDLE];\n\tif (cpu_online(cpu) && !nr_iowait_cpu(cpu))\n\t\tidle += arch_idle_time(cpu);\n\treturn idle;\n}"
  }
]