[
  {
    "function_name": "decode_negTokenInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "493-623",
    "snippet": "int\ndecode_negTokenInit(unsigned char *security_blob, int length,\n\t\t    struct TCP_Server_Info *server)\n{\n\tstruct asn1_ctx ctx;\n\tunsigned char *end;\n\tunsigned char *sequence_end;\n\tunsigned long *oid = NULL;\n\tunsigned int cls, con, tag, oidlen, rc;\n\n\t/* cifs_dump_mem(\" Received SecBlob \", security_blob, length); */\n\n\tasn1_open(&ctx, security_blob, length);\n\n\t/* GSSAPI header */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit header\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_APL) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_EOC)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d\\n\", cls, con, tag);\n\t\treturn 0;\n\t}\n\n\t/* Check for SPNEGO OID -- remember to free obj->oid */\n\trc = asn1_header_decode(&ctx, &end, &cls, &con, &tag);\n\tif (rc) {\n\t\tif ((tag == ASN1_OJI) && (con == ASN1_PRI) &&\n\t\t    (cls == ASN1_UNI)) {\n\t\t\trc = asn1_oid_decode(&ctx, end, &oid, &oidlen);\n\t\t\tif (rc) {\n\t\t\t\trc = compare_oid(oid, oidlen, SPNEGO_OID,\n\t\t\t\t\t\t SPNEGO_OID_LEN);\n\t\t\t\tkfree(oid);\n\t\t\t}\n\t\t} else\n\t\t\trc = 0;\n\t}\n\n\t/* SPNEGO OID not present or garbled -- bail out */\n\tif (!rc) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit header\\n\");\n\t\treturn 0;\n\t}\n\n\t/* SPNEGO */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_CTX) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_EOC)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 0\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* negTokenInit */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_UNI) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_SEQ)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 1\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* sequence */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding 2nd part of negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_CTX) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_EOC)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 0\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* sequence of */\n\tif (asn1_header_decode\n\t    (&ctx, &sequence_end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding 2nd part of negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_UNI) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_SEQ)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 1\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* list of security mechanisms */\n\twhile (!asn1_eoc_decode(&ctx, sequence_end)) {\n\t\trc = asn1_header_decode(&ctx, &end, &cls, &con, &tag);\n\t\tif (!rc) {\n\t\t\tcifs_dbg(FYI, \"Error decoding negTokenInit hdr exit2\\n\");\n\t\t\treturn 0;\n\t\t}\n\t\tif ((tag == ASN1_OJI) && (con == ASN1_PRI)) {\n\t\t\tif (asn1_oid_decode(&ctx, end, &oid, &oidlen)) {\n\n\t\t\t\tcifs_dbg(FYI, \"OID len = %d oid = 0x%lx 0x%lx 0x%lx 0x%lx\\n\",\n\t\t\t\t\t oidlen, *oid, *(oid + 1), *(oid + 2),\n\t\t\t\t\t *(oid + 3));\n\n\t\t\t\tif (compare_oid(oid, oidlen, MSKRB5_OID,\n\t\t\t\t\t\tMSKRB5_OID_LEN))\n\t\t\t\t\tserver->sec_mskerberos = true;\n\t\t\t\telse if (compare_oid(oid, oidlen, KRB5U2U_OID,\n\t\t\t\t\t\t     KRB5U2U_OID_LEN))\n\t\t\t\t\tserver->sec_kerberosu2u = true;\n\t\t\t\telse if (compare_oid(oid, oidlen, KRB5_OID,\n\t\t\t\t\t\t     KRB5_OID_LEN))\n\t\t\t\t\tserver->sec_kerberos = true;\n\t\t\t\telse if (compare_oid(oid, oidlen, NTLMSSP_OID,\n\t\t\t\t\t\t     NTLMSSP_OID_LEN))\n\t\t\t\t\tserver->sec_ntlmssp = true;\n\n\t\t\t\tkfree(oid);\n\t\t\t}\n\t\t} else {\n\t\t\tcifs_dbg(FYI, \"Should be an oid what is going on?\\n\");\n\t\t}\n\t}\n\n\t/*\n\t * We currently ignore anything at the end of the SPNEGO blob after\n\t * the mechTypes have been parsed, since none of that info is\n\t * used at the moment.\n\t */\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define MSKRB5_OID_LEN  7",
      "#define KRB5U2U_OID_LEN  8",
      "#define KRB5_OID_LEN  7",
      "#define NTLMSSP_OID_LEN  10",
      "#define SPNEGO_OID_LEN 7",
      "#define ASN1_CON\t1\t/* Constructed */",
      "#define ASN1_PRI\t0\t/* Primitive */",
      "#define ASN1_SEQ\t16\t/* Sequence */",
      "#define ASN1_OJI\t6\t/* Object Identifier  */",
      "#define ASN1_EOC\t0\t/* End Of Contents or N/A */",
      "#define ASN1_CTX\t2\t/* Context */",
      "#define ASN1_APL\t1\t/* Application */",
      "#define ASN1_UNI\t0\t/* Universal */"
    ],
    "globals_used": [
      "static unsigned long SPNEGO_OID[7] = { 1, 3, 6, 1, 5, 5, 2 };",
      "static unsigned long NTLMSSP_OID[10] = { 1, 3, 6, 1, 4, 1, 311, 2, 2, 10 };",
      "static unsigned long KRB5_OID[7] = { 1, 2, 840, 113554, 1, 2, 2 };",
      "static unsigned long KRB5U2U_OID[8] = { 1, 2, 840, 113554, 1, 2, 2, 3 };",
      "static unsigned long MSKRB5_OID[7] = { 1, 2, 840, 48018, 1, 2, 2 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Should be an oid what is going on?\\n\""
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "oid"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compare_oid",
          "args": [
            "oid",
            "oidlen",
            "NTLMSSP_OID",
            "NTLMSSP_OID_LEN"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "compare_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "474-489",
          "snippet": "static int\ncompare_oid(unsigned long *oid1, unsigned int oid1len,\n\t    unsigned long *oid2, unsigned int oid2len)\n{\n\tunsigned int i;\n\n\tif (oid1len != oid2len)\n\t\treturn 0;\n\telse {\n\t\tfor (i = 0; i < oid1len; i++) {\n\t\t\tif (oid1[i] != oid2[i])\n\t\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int\ncompare_oid(unsigned long *oid1, unsigned int oid1len,\n\t    unsigned long *oid2, unsigned int oid2len)\n{\n\tunsigned int i;\n\n\tif (oid1len != oid2len)\n\t\treturn 0;\n\telse {\n\t\tfor (i = 0; i < oid1len; i++) {\n\t\t\tif (oid1[i] != oid2[i])\n\t\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"OID len = %d oid = 0x%lx 0x%lx 0x%lx 0x%lx\\n\"",
            "oidlen",
            "*oid",
            "*(oid + 1)",
            "*(oid + 2)",
            "*(oid + 3)"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asn1_oid_decode",
          "args": [
            "&ctx",
            "end",
            "&oid",
            "&oidlen"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_oid_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "417-472",
          "snippet": "static int\nasn1_oid_decode(struct asn1_ctx *ctx,\n\t\tunsigned char *eoc, unsigned long **oid, unsigned int *len)\n{\n\tunsigned long subid;\n\tunsigned int size;\n\tunsigned long *optr;\n\n\tsize = eoc - ctx->pointer + 1;\n\n\t/* first subid actually encodes first two subids */\n\tif (size < 2 || size > UINT_MAX/sizeof(unsigned long))\n\t\treturn 0;\n\n\t*oid = kmalloc(size * sizeof(unsigned long), GFP_ATOMIC);\n\tif (*oid == NULL)\n\t\treturn 0;\n\n\toptr = *oid;\n\n\tif (!asn1_subid_decode(ctx, &subid)) {\n\t\tkfree(*oid);\n\t\t*oid = NULL;\n\t\treturn 0;\n\t}\n\n\tif (subid < 40) {\n\t\toptr[0] = 0;\n\t\toptr[1] = subid;\n\t} else if (subid < 80) {\n\t\toptr[0] = 1;\n\t\toptr[1] = subid - 40;\n\t} else {\n\t\toptr[0] = 2;\n\t\toptr[1] = subid - 80;\n\t}\n\n\t*len = 2;\n\toptr += 2;\n\n\twhile (ctx->pointer < eoc) {\n\t\tif (++(*len) > size) {\n\t\t\tctx->error = ASN1_ERR_DEC_BADVALUE;\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_subid_decode(ctx, optr++)) {\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_BADVALUE\t\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_BADVALUE\t\t5\n\nstatic int\nasn1_oid_decode(struct asn1_ctx *ctx,\n\t\tunsigned char *eoc, unsigned long **oid, unsigned int *len)\n{\n\tunsigned long subid;\n\tunsigned int size;\n\tunsigned long *optr;\n\n\tsize = eoc - ctx->pointer + 1;\n\n\t/* first subid actually encodes first two subids */\n\tif (size < 2 || size > UINT_MAX/sizeof(unsigned long))\n\t\treturn 0;\n\n\t*oid = kmalloc(size * sizeof(unsigned long), GFP_ATOMIC);\n\tif (*oid == NULL)\n\t\treturn 0;\n\n\toptr = *oid;\n\n\tif (!asn1_subid_decode(ctx, &subid)) {\n\t\tkfree(*oid);\n\t\t*oid = NULL;\n\t\treturn 0;\n\t}\n\n\tif (subid < 40) {\n\t\toptr[0] = 0;\n\t\toptr[1] = subid;\n\t} else if (subid < 80) {\n\t\toptr[0] = 1;\n\t\toptr[1] = subid - 40;\n\t} else {\n\t\toptr[0] = 2;\n\t\toptr[1] = subid - 80;\n\t}\n\n\t*len = 2;\n\toptr += 2;\n\n\twhile (ctx->pointer < eoc) {\n\t\tif (++(*len) > size) {\n\t\t\tctx->error = ASN1_ERR_DEC_BADVALUE;\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_subid_decode(ctx, optr++)) {\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding negTokenInit hdr exit2\\n\""
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asn1_header_decode",
          "args": [
            "&ctx",
            "&end",
            "&cls",
            "&con",
            "&tag"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_header_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "222-245",
          "snippet": "static unsigned char\nasn1_header_decode(struct asn1_ctx *ctx,\n\t\t   unsigned char **eoc,\n\t\t   unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned int def = 0;\n\tunsigned int len = 0;\n\n\tif (!asn1_id_decode(ctx, cls, con, tag))\n\t\treturn 0;\n\n\tif (!asn1_length_decode(ctx, &def, &len))\n\t\treturn 0;\n\n\t/* primitive shall be definite, indefinite shall be constructed */\n\tif (*con == ASN1_PRI && !def)\n\t\treturn 0;\n\n\tif (def)\n\t\t*eoc = ctx->pointer + len;\n\telse\n\t\t*eoc = NULL;\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_PRI\t0\t/* Primitive */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_PRI\t0\t/* Primitive */\n\nstatic unsigned char\nasn1_header_decode(struct asn1_ctx *ctx,\n\t\t   unsigned char **eoc,\n\t\t   unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned int def = 0;\n\tunsigned int len = 0;\n\n\tif (!asn1_id_decode(ctx, cls, con, tag))\n\t\treturn 0;\n\n\tif (!asn1_length_decode(ctx, &def, &len))\n\t\treturn 0;\n\n\t/* primitive shall be definite, indefinite shall be constructed */\n\tif (*con == ASN1_PRI && !def)\n\t\treturn 0;\n\n\tif (def)\n\t\t*eoc = ctx->pointer + len;\n\telse\n\t\t*eoc = NULL;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "asn1_eoc_decode",
          "args": [
            "&ctx",
            "sequence_end"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_eoc_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "247-276",
          "snippet": "static unsigned char\nasn1_eoc_decode(struct asn1_ctx *ctx, unsigned char *eoc)\n{\n\tunsigned char ch;\n\n\tif (eoc == NULL) {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (ctx->pointer != eoc) {\n\t\t\tctx->error = ASN1_ERR_DEC_LENGTH_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_LENGTH_MISMATCH\t4",
            "#define ASN1_ERR_DEC_EOC_MISMATCH\t3"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_LENGTH_MISMATCH\t4\n#define ASN1_ERR_DEC_EOC_MISMATCH\t3\n\nstatic unsigned char\nasn1_eoc_decode(struct asn1_ctx *ctx, unsigned char *eoc)\n{\n\tunsigned char ch;\n\n\tif (eoc == NULL) {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (ctx->pointer != eoc) {\n\t\t\tctx->error = ASN1_ERR_DEC_LENGTH_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"cls = %d con = %d tag = %d end = %p (%d) exit 1\\n\"",
            "cls",
            "con",
            "tag",
            "end",
            "*end"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding 2nd part of negTokenInit\\n\""
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"cls = %d con = %d tag = %d end = %p (%d) exit 0\\n\"",
            "cls",
            "con",
            "tag",
            "end",
            "*end"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding 2nd part of negTokenInit\\n\""
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"cls = %d con = %d tag = %d end = %p (%d) exit 1\\n\"",
            "cls",
            "con",
            "tag",
            "end",
            "*end"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding negTokenInit\\n\""
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"cls = %d con = %d tag = %d end = %p (%d) exit 0\\n\"",
            "cls",
            "con",
            "tag",
            "end",
            "*end"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding negTokenInit\\n\""
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding negTokenInit header\\n\""
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "oid"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"cls = %d con = %d tag = %d\\n\"",
            "cls",
            "con",
            "tag"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cifs_dbg",
          "args": [
            "FYI",
            "\"Error decoding negTokenInit header\\n\""
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asn1_open",
          "args": [
            "&ctx",
            "security_blob",
            "length"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "108-115",
          "snippet": "static void\nasn1_open(struct asn1_ctx *ctx, unsigned char *buf, unsigned int len)\n{\n\tctx->begin = buf;\n\tctx->end = buf + len;\n\tctx->pointer = buf;\n\tctx->error = ASN1_ERR_NOERROR;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_NOERROR\t\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_NOERROR\t\t0\n\nstatic void\nasn1_open(struct asn1_ctx *ctx, unsigned char *buf, unsigned int len)\n{\n\tctx->begin = buf;\n\tctx->end = buf + len;\n\tctx->pointer = buf;\n\tctx->error = ASN1_ERR_NOERROR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define MSKRB5_OID_LEN  7\n#define KRB5U2U_OID_LEN  8\n#define KRB5_OID_LEN  7\n#define NTLMSSP_OID_LEN  10\n#define SPNEGO_OID_LEN 7\n#define ASN1_CON\t1\t/* Constructed */\n#define ASN1_PRI\t0\t/* Primitive */\n#define ASN1_SEQ\t16\t/* Sequence */\n#define ASN1_OJI\t6\t/* Object Identifier  */\n#define ASN1_EOC\t0\t/* End Of Contents or N/A */\n#define ASN1_CTX\t2\t/* Context */\n#define ASN1_APL\t1\t/* Application */\n#define ASN1_UNI\t0\t/* Universal */\n\nstatic unsigned long SPNEGO_OID[7] = { 1, 3, 6, 1, 5, 5, 2 };\nstatic unsigned long NTLMSSP_OID[10] = { 1, 3, 6, 1, 4, 1, 311, 2, 2, 10 };\nstatic unsigned long KRB5_OID[7] = { 1, 2, 840, 113554, 1, 2, 2 };\nstatic unsigned long KRB5U2U_OID[8] = { 1, 2, 840, 113554, 1, 2, 2, 3 };\nstatic unsigned long MSKRB5_OID[7] = { 1, 2, 840, 48018, 1, 2, 2 };\n\nint\ndecode_negTokenInit(unsigned char *security_blob, int length,\n\t\t    struct TCP_Server_Info *server)\n{\n\tstruct asn1_ctx ctx;\n\tunsigned char *end;\n\tunsigned char *sequence_end;\n\tunsigned long *oid = NULL;\n\tunsigned int cls, con, tag, oidlen, rc;\n\n\t/* cifs_dump_mem(\" Received SecBlob \", security_blob, length); */\n\n\tasn1_open(&ctx, security_blob, length);\n\n\t/* GSSAPI header */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit header\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_APL) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_EOC)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d\\n\", cls, con, tag);\n\t\treturn 0;\n\t}\n\n\t/* Check for SPNEGO OID -- remember to free obj->oid */\n\trc = asn1_header_decode(&ctx, &end, &cls, &con, &tag);\n\tif (rc) {\n\t\tif ((tag == ASN1_OJI) && (con == ASN1_PRI) &&\n\t\t    (cls == ASN1_UNI)) {\n\t\t\trc = asn1_oid_decode(&ctx, end, &oid, &oidlen);\n\t\t\tif (rc) {\n\t\t\t\trc = compare_oid(oid, oidlen, SPNEGO_OID,\n\t\t\t\t\t\t SPNEGO_OID_LEN);\n\t\t\t\tkfree(oid);\n\t\t\t}\n\t\t} else\n\t\t\trc = 0;\n\t}\n\n\t/* SPNEGO OID not present or garbled -- bail out */\n\tif (!rc) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit header\\n\");\n\t\treturn 0;\n\t}\n\n\t/* SPNEGO */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_CTX) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_EOC)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 0\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* negTokenInit */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_UNI) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_SEQ)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 1\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* sequence */\n\tif (asn1_header_decode(&ctx, &end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding 2nd part of negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_CTX) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_EOC)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 0\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* sequence of */\n\tif (asn1_header_decode\n\t    (&ctx, &sequence_end, &cls, &con, &tag) == 0) {\n\t\tcifs_dbg(FYI, \"Error decoding 2nd part of negTokenInit\\n\");\n\t\treturn 0;\n\t} else if ((cls != ASN1_UNI) || (con != ASN1_CON)\n\t\t   || (tag != ASN1_SEQ)) {\n\t\tcifs_dbg(FYI, \"cls = %d con = %d tag = %d end = %p (%d) exit 1\\n\",\n\t\t\t cls, con, tag, end, *end);\n\t\treturn 0;\n\t}\n\n\t/* list of security mechanisms */\n\twhile (!asn1_eoc_decode(&ctx, sequence_end)) {\n\t\trc = asn1_header_decode(&ctx, &end, &cls, &con, &tag);\n\t\tif (!rc) {\n\t\t\tcifs_dbg(FYI, \"Error decoding negTokenInit hdr exit2\\n\");\n\t\t\treturn 0;\n\t\t}\n\t\tif ((tag == ASN1_OJI) && (con == ASN1_PRI)) {\n\t\t\tif (asn1_oid_decode(&ctx, end, &oid, &oidlen)) {\n\n\t\t\t\tcifs_dbg(FYI, \"OID len = %d oid = 0x%lx 0x%lx 0x%lx 0x%lx\\n\",\n\t\t\t\t\t oidlen, *oid, *(oid + 1), *(oid + 2),\n\t\t\t\t\t *(oid + 3));\n\n\t\t\t\tif (compare_oid(oid, oidlen, MSKRB5_OID,\n\t\t\t\t\t\tMSKRB5_OID_LEN))\n\t\t\t\t\tserver->sec_mskerberos = true;\n\t\t\t\telse if (compare_oid(oid, oidlen, KRB5U2U_OID,\n\t\t\t\t\t\t     KRB5U2U_OID_LEN))\n\t\t\t\t\tserver->sec_kerberosu2u = true;\n\t\t\t\telse if (compare_oid(oid, oidlen, KRB5_OID,\n\t\t\t\t\t\t     KRB5_OID_LEN))\n\t\t\t\t\tserver->sec_kerberos = true;\n\t\t\t\telse if (compare_oid(oid, oidlen, NTLMSSP_OID,\n\t\t\t\t\t\t     NTLMSSP_OID_LEN))\n\t\t\t\t\tserver->sec_ntlmssp = true;\n\n\t\t\t\tkfree(oid);\n\t\t\t}\n\t\t} else {\n\t\t\tcifs_dbg(FYI, \"Should be an oid what is going on?\\n\");\n\t\t}\n\t}\n\n\t/*\n\t * We currently ignore anything at the end of the SPNEGO blob after\n\t * the mechTypes have been parsed, since none of that info is\n\t * used at the moment.\n\t */\n\treturn 1;\n}"
  },
  {
    "function_name": "compare_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "474-489",
    "snippet": "static int\ncompare_oid(unsigned long *oid1, unsigned int oid1len,\n\t    unsigned long *oid2, unsigned int oid2len)\n{\n\tunsigned int i;\n\n\tif (oid1len != oid2len)\n\t\treturn 0;\n\telse {\n\t\tfor (i = 0; i < oid1len; i++) {\n\t\t\tif (oid1[i] != oid2[i])\n\t\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int\ncompare_oid(unsigned long *oid1, unsigned int oid1len,\n\t    unsigned long *oid2, unsigned int oid2len)\n{\n\tunsigned int i;\n\n\tif (oid1len != oid2len)\n\t\treturn 0;\n\telse {\n\t\tfor (i = 0; i < oid1len; i++) {\n\t\t\tif (oid1[i] != oid2[i])\n\t\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}"
  },
  {
    "function_name": "asn1_oid_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "417-472",
    "snippet": "static int\nasn1_oid_decode(struct asn1_ctx *ctx,\n\t\tunsigned char *eoc, unsigned long **oid, unsigned int *len)\n{\n\tunsigned long subid;\n\tunsigned int size;\n\tunsigned long *optr;\n\n\tsize = eoc - ctx->pointer + 1;\n\n\t/* first subid actually encodes first two subids */\n\tif (size < 2 || size > UINT_MAX/sizeof(unsigned long))\n\t\treturn 0;\n\n\t*oid = kmalloc(size * sizeof(unsigned long), GFP_ATOMIC);\n\tif (*oid == NULL)\n\t\treturn 0;\n\n\toptr = *oid;\n\n\tif (!asn1_subid_decode(ctx, &subid)) {\n\t\tkfree(*oid);\n\t\t*oid = NULL;\n\t\treturn 0;\n\t}\n\n\tif (subid < 40) {\n\t\toptr[0] = 0;\n\t\toptr[1] = subid;\n\t} else if (subid < 80) {\n\t\toptr[0] = 1;\n\t\toptr[1] = subid - 40;\n\t} else {\n\t\toptr[0] = 2;\n\t\toptr[1] = subid - 80;\n\t}\n\n\t*len = 2;\n\toptr += 2;\n\n\twhile (ctx->pointer < eoc) {\n\t\tif (++(*len) > size) {\n\t\t\tctx->error = ASN1_ERR_DEC_BADVALUE;\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_subid_decode(ctx, optr++)) {\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ASN1_ERR_DEC_BADVALUE\t\t5"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "*oid"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asn1_subid_decode",
          "args": [
            "ctx",
            "optr++"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_subid_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "400-415",
          "snippet": "static unsigned char\nasn1_subid_decode(struct asn1_ctx *ctx, unsigned long *subid)\n{\n\tunsigned char ch;\n\n\t*subid = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\t*subid <<= 7;\n\t\t*subid |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_subid_decode(struct asn1_ctx *ctx, unsigned long *subid)\n{\n\tunsigned char ch;\n\n\t*subid = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\t*subid <<= 7;\n\t\t*subid |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "*oid"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "*oid"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "size * sizeof(unsigned long)",
            "GFP_ATOMIC"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_BADVALUE\t\t5\n\nstatic int\nasn1_oid_decode(struct asn1_ctx *ctx,\n\t\tunsigned char *eoc, unsigned long **oid, unsigned int *len)\n{\n\tunsigned long subid;\n\tunsigned int size;\n\tunsigned long *optr;\n\n\tsize = eoc - ctx->pointer + 1;\n\n\t/* first subid actually encodes first two subids */\n\tif (size < 2 || size > UINT_MAX/sizeof(unsigned long))\n\t\treturn 0;\n\n\t*oid = kmalloc(size * sizeof(unsigned long), GFP_ATOMIC);\n\tif (*oid == NULL)\n\t\treturn 0;\n\n\toptr = *oid;\n\n\tif (!asn1_subid_decode(ctx, &subid)) {\n\t\tkfree(*oid);\n\t\t*oid = NULL;\n\t\treturn 0;\n\t}\n\n\tif (subid < 40) {\n\t\toptr[0] = 0;\n\t\toptr[1] = subid;\n\t} else if (subid < 80) {\n\t\toptr[0] = 1;\n\t\toptr[1] = subid - 40;\n\t} else {\n\t\toptr[0] = 2;\n\t\toptr[1] = subid - 80;\n\t}\n\n\t*len = 2;\n\toptr += 2;\n\n\twhile (ctx->pointer < eoc) {\n\t\tif (++(*len) > size) {\n\t\t\tctx->error = ASN1_ERR_DEC_BADVALUE;\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_subid_decode(ctx, optr++)) {\n\t\t\tkfree(*oid);\n\t\t\t*oid = NULL;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_subid_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "400-415",
    "snippet": "static unsigned char\nasn1_subid_decode(struct asn1_ctx *ctx, unsigned long *subid)\n{\n\tunsigned char ch;\n\n\t*subid = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\t*subid <<= 7;\n\t\t*subid |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asn1_octet_decode",
          "args": [
            "ctx",
            "&ch"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_octet_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "117-126",
          "snippet": "static unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_EMPTY\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n\nstatic unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_subid_decode(struct asn1_ctx *ctx, unsigned long *subid)\n{\n\tunsigned char ch;\n\n\t*subid = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\t*subid <<= 7;\n\t\t*subid |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_eoc_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "247-276",
    "snippet": "static unsigned char\nasn1_eoc_decode(struct asn1_ctx *ctx, unsigned char *eoc)\n{\n\tunsigned char ch;\n\n\tif (eoc == NULL) {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (ctx->pointer != eoc) {\n\t\t\tctx->error = ASN1_ERR_DEC_LENGTH_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ASN1_ERR_DEC_LENGTH_MISMATCH\t4",
      "#define ASN1_ERR_DEC_EOC_MISMATCH\t3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asn1_octet_decode",
          "args": [
            "ctx",
            "&ch"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_octet_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "117-126",
          "snippet": "static unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_EMPTY\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n\nstatic unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_LENGTH_MISMATCH\t4\n#define ASN1_ERR_DEC_EOC_MISMATCH\t3\n\nstatic unsigned char\nasn1_eoc_decode(struct asn1_ctx *ctx, unsigned char *eoc)\n{\n\tunsigned char ch;\n\n\tif (eoc == NULL) {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\n\t\tif (ch != 0x00) {\n\t\t\tctx->error = ASN1_ERR_DEC_EOC_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (ctx->pointer != eoc) {\n\t\t\tctx->error = ASN1_ERR_DEC_LENGTH_MISMATCH;\n\t\t\treturn 0;\n\t\t}\n\t\treturn 1;\n\t}\n}"
  },
  {
    "function_name": "asn1_header_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "222-245",
    "snippet": "static unsigned char\nasn1_header_decode(struct asn1_ctx *ctx,\n\t\t   unsigned char **eoc,\n\t\t   unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned int def = 0;\n\tunsigned int len = 0;\n\n\tif (!asn1_id_decode(ctx, cls, con, tag))\n\t\treturn 0;\n\n\tif (!asn1_length_decode(ctx, &def, &len))\n\t\treturn 0;\n\n\t/* primitive shall be definite, indefinite shall be constructed */\n\tif (*con == ASN1_PRI && !def)\n\t\treturn 0;\n\n\tif (def)\n\t\t*eoc = ctx->pointer + len;\n\telse\n\t\t*eoc = NULL;\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ASN1_PRI\t0\t/* Primitive */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asn1_length_decode",
          "args": [
            "ctx",
            "&def",
            "&len"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_length_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "186-220",
          "snippet": "static unsigned char\nasn1_length_decode(struct asn1_ctx *ctx, unsigned int *def, unsigned int *len)\n{\n\tunsigned char ch, cnt;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\tif (ch == 0x80)\n\t\t*def = 0;\n\telse {\n\t\t*def = 1;\n\n\t\tif (ch < 0x80)\n\t\t\t*len = ch;\n\t\telse {\n\t\t\tcnt = (unsigned char) (ch & 0x7F);\n\t\t\t*len = 0;\n\n\t\t\twhile (cnt > 0) {\n\t\t\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\t\t\treturn 0;\n\t\t\t\t*len <<= 8;\n\t\t\t\t*len |= ch;\n\t\t\t\tcnt--;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* don't trust len bigger than ctx buffer */\n\tif (*len > ctx->end - ctx->pointer)\n\t\treturn 0;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_length_decode(struct asn1_ctx *ctx, unsigned int *def, unsigned int *len)\n{\n\tunsigned char ch, cnt;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\tif (ch == 0x80)\n\t\t*def = 0;\n\telse {\n\t\t*def = 1;\n\n\t\tif (ch < 0x80)\n\t\t\t*len = ch;\n\t\telse {\n\t\t\tcnt = (unsigned char) (ch & 0x7F);\n\t\t\t*len = 0;\n\n\t\t\twhile (cnt > 0) {\n\t\t\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\t\t\treturn 0;\n\t\t\t\t*len <<= 8;\n\t\t\t\t*len |= ch;\n\t\t\t\tcnt--;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* don't trust len bigger than ctx buffer */\n\tif (*len > ctx->end - ctx->pointer)\n\t\treturn 0;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "asn1_id_decode",
          "args": [
            "ctx",
            "cls",
            "con",
            "tag"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_id_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "166-184",
          "snippet": "static unsigned char\nasn1_id_decode(struct asn1_ctx *ctx,\n\t       unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\t*cls = (ch & 0xC0) >> 6;\n\t*con = (ch & 0x20) >> 5;\n\t*tag = (ch & 0x1F);\n\n\tif (*tag == 0x1F) {\n\t\tif (!asn1_tag_decode(ctx, tag))\n\t\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_id_decode(struct asn1_ctx *ctx,\n\t       unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\t*cls = (ch & 0xC0) >> 6;\n\t*con = (ch & 0x20) >> 5;\n\t*tag = (ch & 0x1F);\n\n\tif (*tag == 0x1F) {\n\t\tif (!asn1_tag_decode(ctx, tag))\n\t\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_PRI\t0\t/* Primitive */\n\nstatic unsigned char\nasn1_header_decode(struct asn1_ctx *ctx,\n\t\t   unsigned char **eoc,\n\t\t   unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned int def = 0;\n\tunsigned int len = 0;\n\n\tif (!asn1_id_decode(ctx, cls, con, tag))\n\t\treturn 0;\n\n\tif (!asn1_length_decode(ctx, &def, &len))\n\t\treturn 0;\n\n\t/* primitive shall be definite, indefinite shall be constructed */\n\tif (*con == ASN1_PRI && !def)\n\t\treturn 0;\n\n\tif (def)\n\t\t*eoc = ctx->pointer + len;\n\telse\n\t\t*eoc = NULL;\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_length_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "186-220",
    "snippet": "static unsigned char\nasn1_length_decode(struct asn1_ctx *ctx, unsigned int *def, unsigned int *len)\n{\n\tunsigned char ch, cnt;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\tif (ch == 0x80)\n\t\t*def = 0;\n\telse {\n\t\t*def = 1;\n\n\t\tif (ch < 0x80)\n\t\t\t*len = ch;\n\t\telse {\n\t\t\tcnt = (unsigned char) (ch & 0x7F);\n\t\t\t*len = 0;\n\n\t\t\twhile (cnt > 0) {\n\t\t\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\t\t\treturn 0;\n\t\t\t\t*len <<= 8;\n\t\t\t\t*len |= ch;\n\t\t\t\tcnt--;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* don't trust len bigger than ctx buffer */\n\tif (*len > ctx->end - ctx->pointer)\n\t\treturn 0;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asn1_octet_decode",
          "args": [
            "ctx",
            "&ch"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_octet_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "117-126",
          "snippet": "static unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_EMPTY\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n\nstatic unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_length_decode(struct asn1_ctx *ctx, unsigned int *def, unsigned int *len)\n{\n\tunsigned char ch, cnt;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\tif (ch == 0x80)\n\t\t*def = 0;\n\telse {\n\t\t*def = 1;\n\n\t\tif (ch < 0x80)\n\t\t\t*len = ch;\n\t\telse {\n\t\t\tcnt = (unsigned char) (ch & 0x7F);\n\t\t\t*len = 0;\n\n\t\t\twhile (cnt > 0) {\n\t\t\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\t\t\treturn 0;\n\t\t\t\t*len <<= 8;\n\t\t\t\t*len |= ch;\n\t\t\t\tcnt--;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* don't trust len bigger than ctx buffer */\n\tif (*len > ctx->end - ctx->pointer)\n\t\treturn 0;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_id_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "166-184",
    "snippet": "static unsigned char\nasn1_id_decode(struct asn1_ctx *ctx,\n\t       unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\t*cls = (ch & 0xC0) >> 6;\n\t*con = (ch & 0x20) >> 5;\n\t*tag = (ch & 0x1F);\n\n\tif (*tag == 0x1F) {\n\t\tif (!asn1_tag_decode(ctx, tag))\n\t\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asn1_tag_decode",
          "args": [
            "ctx",
            "tag"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_tag_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "150-164",
          "snippet": "static unsigned char\nasn1_tag_decode(struct asn1_ctx *ctx, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\t*tag = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\t\t*tag <<= 7;\n\t\t*tag |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_tag_decode(struct asn1_ctx *ctx, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\t*tag = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\t\t*tag <<= 7;\n\t\t*tag |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "asn1_octet_decode",
          "args": [
            "ctx",
            "&ch"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_octet_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "117-126",
          "snippet": "static unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_EMPTY\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n\nstatic unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_id_decode(struct asn1_ctx *ctx,\n\t       unsigned int *cls, unsigned int *con, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\tif (!asn1_octet_decode(ctx, &ch))\n\t\treturn 0;\n\n\t*cls = (ch & 0xC0) >> 6;\n\t*con = (ch & 0x20) >> 5;\n\t*tag = (ch & 0x1F);\n\n\tif (*tag == 0x1F) {\n\t\tif (!asn1_tag_decode(ctx, tag))\n\t\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_tag_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "150-164",
    "snippet": "static unsigned char\nasn1_tag_decode(struct asn1_ctx *ctx, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\t*tag = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\t\t*tag <<= 7;\n\t\t*tag |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asn1_octet_decode",
          "args": [
            "ctx",
            "&ch"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "asn1_octet_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
          "lines": "117-126",
          "snippet": "static unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}",
          "includes": [
            "#include \"cifsproto.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ASN1_ERR_DEC_EMPTY\t\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n\nstatic unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic unsigned char\nasn1_tag_decode(struct asn1_ctx *ctx, unsigned int *tag)\n{\n\tunsigned char ch;\n\n\t*tag = 0;\n\n\tdo {\n\t\tif (!asn1_octet_decode(ctx, &ch))\n\t\t\treturn 0;\n\t\t*tag <<= 7;\n\t\t*tag |= ch & 0x7F;\n\t} while ((ch & 0x80) == 0x80);\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_enum_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "129-147",
    "snippet": "static unsigned char\nasn1_enum_decode(struct asn1_ctx *ctx, __le32 *val)\n{\n\tunsigned char ch;\n\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\n\tch = *(ctx->pointer)++; /* ch has 0xa, ptr points to length octet */\n\tif ((ch) == ASN1_ENUM)  /* if ch value is ENUM, 0xa */\n\t\t*val = *(++(ctx->pointer)); /* value has enum value */\n\telse\n\t\treturn 0;\n\n\tctx->pointer++;\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ASN1_ERR_DEC_EMPTY\t\t2",
      "#define ASN1_ENUM\t10\t/* Enumerated */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n#define ASN1_ENUM\t10\t/* Enumerated */\n\nstatic unsigned char\nasn1_enum_decode(struct asn1_ctx *ctx, __le32 *val)\n{\n\tunsigned char ch;\n\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\n\tch = *(ctx->pointer)++; /* ch has 0xa, ptr points to length octet */\n\tif ((ch) == ASN1_ENUM)  /* if ch value is ENUM, 0xa */\n\t\t*val = *(++(ctx->pointer)); /* value has enum value */\n\telse\n\t\treturn 0;\n\n\tctx->pointer++;\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_octet_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "117-126",
    "snippet": "static unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ASN1_ERR_DEC_EMPTY\t\t2"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_DEC_EMPTY\t\t2\n\nstatic unsigned char\nasn1_octet_decode(struct asn1_ctx *ctx, unsigned char *ch)\n{\n\tif (ctx->pointer >= ctx->end) {\n\t\tctx->error = ASN1_ERR_DEC_EMPTY;\n\t\treturn 0;\n\t}\n\t*ch = *(ctx->pointer)++;\n\treturn 1;\n}"
  },
  {
    "function_name": "asn1_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/asn1.c",
    "lines": "108-115",
    "snippet": "static void\nasn1_open(struct asn1_ctx *ctx, unsigned char *buf, unsigned int len)\n{\n\tctx->begin = buf;\n\tctx->end = buf + len;\n\tctx->pointer = buf;\n\tctx->error = ASN1_ERR_NOERROR;\n}",
    "includes": [
      "#include \"cifsproto.h\"",
      "#include \"cifs_debug.h\"",
      "#include \"cifsglob.h\"",
      "#include \"cifspdu.h\"",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ASN1_ERR_NOERROR\t\t0"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cifsproto.h\"\n#include \"cifs_debug.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define ASN1_ERR_NOERROR\t\t0\n\nstatic void\nasn1_open(struct asn1_ctx *ctx, unsigned char *buf, unsigned int len)\n{\n\tctx->begin = buf;\n\tctx->end = buf + len;\n\tctx->pointer = buf;\n\tctx->error = ASN1_ERR_NOERROR;\n}"
  }
]