[
  {
    "function_name": "nr_pages_to_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "731-750",
    "snippet": "static inline long nr_pages_to_write(struct f2fs_sb_info *sbi, int type,\n\t\t\t\t\tstruct writeback_control *wbc)\n{\n\tlong nr_to_write, desired;\n\n\tif (wbc->sync_mode != WB_SYNC_NONE)\n\t\treturn 0;\n\n\tnr_to_write = wbc->nr_to_write;\n\n\tif (type == DATA)\n\t\tdesired = 4096;\n\telse if (type == NODE)\n\t\tdesired = 3 * max_hw_blocks(sbi);\n\telse\n\t\tdesired = MAX_BIO_BLOCKS(sbi);\n\n\twbc->nr_to_write = desired;\n\treturn desired - nr_to_write;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MAX_BIO_BLOCKS",
          "args": [
            "sbi"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max_hw_blocks",
          "args": [
            "sbi"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "max_hw_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "699-704",
          "snippet": "static inline unsigned int max_hw_blocks(struct f2fs_sb_info *sbi)\n{\n\tstruct block_device *bdev = sbi->sb->s_bdev;\n\tstruct request_queue *q = bdev_get_queue(bdev);\n\treturn SECTOR_TO_BLOCK(queue_max_sectors(q));\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int max_hw_blocks(struct f2fs_sb_info *sbi)\n{\n\tstruct block_device *bdev = sbi->sb->s_bdev;\n\tstruct request_queue *q = bdev_get_queue(bdev);\n\treturn SECTOR_TO_BLOCK(queue_max_sectors(q));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline long nr_pages_to_write(struct f2fs_sb_info *sbi, int type,\n\t\t\t\t\tstruct writeback_control *wbc)\n{\n\tlong nr_to_write, desired;\n\n\tif (wbc->sync_mode != WB_SYNC_NONE)\n\t\treturn 0;\n\n\tnr_to_write = wbc->nr_to_write;\n\n\tif (type == DATA)\n\t\tdesired = 4096;\n\telse if (type == NODE)\n\t\tdesired = 3 * max_hw_blocks(sbi);\n\telse\n\t\tdesired = MAX_BIO_BLOCKS(sbi);\n\n\twbc->nr_to_write = desired;\n\treturn desired - nr_to_write;\n}"
  },
  {
    "function_name": "nr_pages_to_skip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "713-726",
    "snippet": "static inline int nr_pages_to_skip(struct f2fs_sb_info *sbi, int type)\n{\n\tif (sbi->sb->s_bdi->dirty_exceeded)\n\t\treturn 0;\n\n\tif (type == DATA)\n\t\treturn sbi->blocks_per_seg;\n\telse if (type == NODE)\n\t\treturn 3 * sbi->blocks_per_seg;\n\telse if (type == META)\n\t\treturn MAX_BIO_BLOCKS(sbi);\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MAX_BIO_BLOCKS",
          "args": [
            "sbi"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int nr_pages_to_skip(struct f2fs_sb_info *sbi, int type)\n{\n\tif (sbi->sb->s_bdi->dirty_exceeded)\n\t\treturn 0;\n\n\tif (type == DATA)\n\t\treturn sbi->blocks_per_seg;\n\telse if (type == NODE)\n\t\treturn 3 * sbi->blocks_per_seg;\n\telse if (type == META)\n\t\treturn MAX_BIO_BLOCKS(sbi);\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "max_hw_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "699-704",
    "snippet": "static inline unsigned int max_hw_blocks(struct f2fs_sb_info *sbi)\n{\n\tstruct block_device *bdev = sbi->sb->s_bdev;\n\tstruct request_queue *q = bdev_get_queue(bdev);\n\treturn SECTOR_TO_BLOCK(queue_max_sectors(q));\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SECTOR_TO_BLOCK",
          "args": [
            "queue_max_sectors(q)"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_max_sectors",
          "args": [
            "q"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdev_get_queue",
          "args": [
            "bdev"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int max_hw_blocks(struct f2fs_sb_info *sbi)\n{\n\tstruct block_device *bdev = sbi->sb->s_bdev;\n\tstruct request_queue *q = bdev_get_queue(bdev);\n\treturn SECTOR_TO_BLOCK(queue_max_sectors(q));\n}"
  },
  {
    "function_name": "sec_usage_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "692-697",
    "snippet": "static inline bool sec_usage_check(struct f2fs_sb_info *sbi, unsigned int secno)\n{\n\tif (IS_CURSEC(sbi, secno) || (sbi->cur_victim_sec == secno))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_CURSEC",
          "args": [
            "sbi",
            "secno"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline bool sec_usage_check(struct f2fs_sb_info *sbi, unsigned int secno)\n{\n\tif (IS_CURSEC(sbi, secno) || (sbi->cur_victim_sec == secno))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "sum_blk_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "685-690",
    "snippet": "static inline block_t sum_blk_addr(struct f2fs_sb_info *sbi, int base, int type)\n{\n\treturn __start_cp_addr(sbi) +\n\t\tle32_to_cpu(F2FS_CKPT(sbi)->cp_pack_total_block_count)\n\t\t\t\t- (base + 1) + type;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "F2FS_CKPT(sbi)->cp_pack_total_block_count"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "F2FS_CKPT",
          "args": [
            "sbi"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "F2FS_CKPT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "665-668",
          "snippet": "static inline struct f2fs_checkpoint *F2FS_CKPT(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_checkpoint *)(sbi->ckpt);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_checkpoint *F2FS_CKPT(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_checkpoint *)(sbi->ckpt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__start_cp_addr",
          "args": [
            "sbi"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "__start_cp_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "940-956",
          "snippet": "static inline block_t __start_cp_addr(struct f2fs_sb_info *sbi)\n{\n\tblock_t start_addr;\n\tstruct f2fs_checkpoint *ckpt = F2FS_CKPT(sbi);\n\tunsigned long long ckpt_version = cur_cp_version(ckpt);\n\n\tstart_addr = le32_to_cpu(F2FS_RAW_SUPER(sbi)->cp_blkaddr);\n\n\t/*\n\t * odd numbered checkpoint should at cp segment 0\n\t * and even segment must be at cp segment 1\n\t */\n\tif (!(ckpt_version & 1))\n\t\tstart_addr += sbi->blocks_per_seg;\n\n\treturn start_addr;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline block_t __start_cp_addr(struct f2fs_sb_info *sbi)\n{\n\tblock_t start_addr;\n\tstruct f2fs_checkpoint *ckpt = F2FS_CKPT(sbi);\n\tunsigned long long ckpt_version = cur_cp_version(ckpt);\n\n\tstart_addr = le32_to_cpu(F2FS_RAW_SUPER(sbi)->cp_blkaddr);\n\n\t/*\n\t * odd numbered checkpoint should at cp segment 0\n\t * and even segment must be at cp segment 1\n\t */\n\tif (!(ckpt_version & 1))\n\t\tstart_addr += sbi->blocks_per_seg;\n\n\treturn start_addr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline block_t sum_blk_addr(struct f2fs_sb_info *sbi, int base, int type)\n{\n\treturn __start_cp_addr(sbi) +\n\t\tle32_to_cpu(F2FS_CKPT(sbi)->cp_pack_total_block_count)\n\t\t\t\t- (base + 1) + type;\n}"
  },
  {
    "function_name": "start_sum_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "679-683",
    "snippet": "static inline block_t start_sum_block(struct f2fs_sb_info *sbi)\n{\n\treturn __start_cp_addr(sbi) +\n\t\tle32_to_cpu(F2FS_CKPT(sbi)->cp_pack_start_sum);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "F2FS_CKPT(sbi)->cp_pack_start_sum"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "F2FS_CKPT",
          "args": [
            "sbi"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "F2FS_CKPT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "665-668",
          "snippet": "static inline struct f2fs_checkpoint *F2FS_CKPT(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_checkpoint *)(sbi->ckpt);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_checkpoint *F2FS_CKPT(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_checkpoint *)(sbi->ckpt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__start_cp_addr",
          "args": [
            "sbi"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "__start_cp_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "940-956",
          "snippet": "static inline block_t __start_cp_addr(struct f2fs_sb_info *sbi)\n{\n\tblock_t start_addr;\n\tstruct f2fs_checkpoint *ckpt = F2FS_CKPT(sbi);\n\tunsigned long long ckpt_version = cur_cp_version(ckpt);\n\n\tstart_addr = le32_to_cpu(F2FS_RAW_SUPER(sbi)->cp_blkaddr);\n\n\t/*\n\t * odd numbered checkpoint should at cp segment 0\n\t * and even segment must be at cp segment 1\n\t */\n\tif (!(ckpt_version & 1))\n\t\tstart_addr += sbi->blocks_per_seg;\n\n\treturn start_addr;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline block_t __start_cp_addr(struct f2fs_sb_info *sbi)\n{\n\tblock_t start_addr;\n\tstruct f2fs_checkpoint *ckpt = F2FS_CKPT(sbi);\n\tunsigned long long ckpt_version = cur_cp_version(ckpt);\n\n\tstart_addr = le32_to_cpu(F2FS_RAW_SUPER(sbi)->cp_blkaddr);\n\n\t/*\n\t * odd numbered checkpoint should at cp segment 0\n\t * and even segment must be at cp segment 1\n\t */\n\tif (!(ckpt_version & 1))\n\t\tstart_addr += sbi->blocks_per_seg;\n\n\treturn start_addr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline block_t start_sum_block(struct f2fs_sb_info *sbi)\n{\n\treturn __start_cp_addr(sbi) +\n\t\tle32_to_cpu(F2FS_CKPT(sbi)->cp_pack_start_sum);\n}"
  },
  {
    "function_name": "set_summary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "671-677",
    "snippet": "static inline void set_summary(struct f2fs_summary *sum, nid_t nid,\n\t\t\tunsigned int ofs_in_node, unsigned char version)\n{\n\tsum->nid = cpu_to_le32(nid);\n\tsum->ofs_in_node = cpu_to_le16(ofs_in_node);\n\tsum->version = version;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "ofs_in_node"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "nid"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void set_summary(struct f2fs_summary *sum, nid_t nid,\n\t\t\tunsigned int ofs_in_node, unsigned char version)\n{\n\tsum->nid = cpu_to_le32(nid);\n\tsum->ofs_in_node = cpu_to_le16(ofs_in_node);\n\tsum->version = version;\n}"
  },
  {
    "function_name": "get_mtime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "664-669",
    "snippet": "static inline unsigned long long get_mtime(struct f2fs_sb_info *sbi)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn sit_i->elapsed_time + CURRENT_TIME_SEC.tv_sec -\n\t\t\t\t\t\tsit_i->mounted_time;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned long long get_mtime(struct f2fs_sb_info *sbi)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn sit_i->elapsed_time + CURRENT_TIME_SEC.tv_sec -\n\t\t\t\t\t\tsit_i->mounted_time;\n}"
  },
  {
    "function_name": "set_to_next_sit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "657-662",
    "snippet": "static inline void set_to_next_sit(struct sit_info *sit_i, unsigned int start)\n{\n\tunsigned int block_off = SIT_BLOCK_OFFSET(start);\n\n\tf2fs_change_bit(block_off, sit_i->sit_bitmap);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "f2fs_change_bit",
          "args": [
            "block_off",
            "sit_i->sit_bitmap"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_change_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1141-1148",
          "snippet": "static inline void f2fs_change_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\t*addr ^= mask;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void f2fs_change_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\t*addr ^= mask;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIT_BLOCK_OFFSET",
          "args": [
            "start"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void set_to_next_sit(struct sit_info *sit_i, unsigned int start)\n{\n\tunsigned int block_off = SIT_BLOCK_OFFSET(start);\n\n\tf2fs_change_bit(block_off, sit_i->sit_bitmap);\n}"
  },
  {
    "function_name": "next_sit_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "644-655",
    "snippet": "static inline pgoff_t next_sit_addr(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tpgoff_t block_addr)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\tblock_addr -= sit_i->sit_base_addr;\n\tif (block_addr < sit_i->sit_blocks)\n\t\tblock_addr += sit_i->sit_blocks;\n\telse\n\t\tblock_addr -= sit_i->sit_blocks;\n\n\treturn block_addr + sit_i->sit_base_addr;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline pgoff_t next_sit_addr(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tpgoff_t block_addr)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\tblock_addr -= sit_i->sit_base_addr;\n\tif (block_addr < sit_i->sit_blocks)\n\t\tblock_addr += sit_i->sit_blocks;\n\telse\n\t\tblock_addr -= sit_i->sit_blocks;\n\n\treturn block_addr + sit_i->sit_base_addr;\n}"
  },
  {
    "function_name": "current_sit_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "628-642",
    "snippet": "static inline pgoff_t current_sit_addr(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int start)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\tunsigned int offset = SIT_BLOCK_OFFSET(start);\n\tblock_t blk_addr = sit_i->sit_base_addr + offset;\n\n\tcheck_seg_range(sbi, start);\n\n\t/* calculate sit block address */\n\tif (f2fs_test_bit(offset, sit_i->sit_bitmap))\n\t\tblk_addr += sit_i->sit_blocks;\n\n\treturn blk_addr;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "f2fs_test_bit",
          "args": [
            "offset",
            "sit_i->sit_bitmap"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1108-1115",
          "snippet": "static inline int f2fs_test_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\treturn mask & *addr;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\treturn mask & *addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_seg_range",
          "args": [
            "sbi",
            "start"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "check_seg_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "600-604",
          "snippet": "static inline void check_seg_range(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tif (segno > TOTAL_SEGS(sbi) - 1)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void check_seg_range(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tif (segno > TOTAL_SEGS(sbi) - 1)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIT_BLOCK_OFFSET",
          "args": [
            "start"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline pgoff_t current_sit_addr(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int start)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\tunsigned int offset = SIT_BLOCK_OFFSET(start);\n\tblock_t blk_addr = sit_i->sit_base_addr + offset;\n\n\tcheck_seg_range(sbi, start);\n\n\t/* calculate sit block address */\n\tif (f2fs_test_bit(offset, sit_i->sit_bitmap))\n\t\tblk_addr += sit_i->sit_blocks;\n\n\treturn blk_addr;\n}"
  },
  {
    "function_name": "check_block_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "615-625",
    "snippet": "static inline void check_block_count(struct f2fs_sb_info *sbi,\n\t\tint segno, struct f2fs_sit_entry *raw_sit)\n{\n\t/* check segment usage */\n\tif (GET_SIT_VBLOCKS(raw_sit) > sbi->blocks_per_seg)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n\n\t/* check boundary of a given segment number */\n\tif (segno > TOTAL_SEGS(sbi) - 1)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_sbi_flag",
          "args": [
            "sbi",
            "SBI_NEED_FSCK"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "set_sbi_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "720-723",
          "snippet": "static inline void set_sbi_flag(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\tsbi->s_flag |= (0x01 << type);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void set_sbi_flag(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\tsbi->s_flag |= (0x01 << type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TOTAL_SEGS",
          "args": [
            "sbi"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_SIT_VBLOCKS",
          "args": [
            "raw_sit"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void check_block_count(struct f2fs_sb_info *sbi,\n\t\tint segno, struct f2fs_sit_entry *raw_sit)\n{\n\t/* check segment usage */\n\tif (GET_SIT_VBLOCKS(raw_sit) > sbi->blocks_per_seg)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n\n\t/* check boundary of a given segment number */\n\tif (segno > TOTAL_SEGS(sbi) - 1)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}"
  },
  {
    "function_name": "verify_block_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "606-610",
    "snippet": "static inline void verify_block_addr(struct f2fs_sb_info *sbi, block_t blk_addr)\n{\n\tif (blk_addr < SEG0_BLKADDR(sbi) || blk_addr >= MAX_BLKADDR(sbi))\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_sbi_flag",
          "args": [
            "sbi",
            "SBI_NEED_FSCK"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "set_sbi_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "720-723",
          "snippet": "static inline void set_sbi_flag(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\tsbi->s_flag |= (0x01 << type);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void set_sbi_flag(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\tsbi->s_flag |= (0x01 << type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MAX_BLKADDR",
          "args": [
            "sbi"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEG0_BLKADDR",
          "args": [
            "sbi"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void verify_block_addr(struct f2fs_sb_info *sbi, block_t blk_addr)\n{\n\tif (blk_addr < SEG0_BLKADDR(sbi) || blk_addr >= MAX_BLKADDR(sbi))\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}"
  },
  {
    "function_name": "check_seg_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "600-604",
    "snippet": "static inline void check_seg_range(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tif (segno > TOTAL_SEGS(sbi) - 1)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_sbi_flag",
          "args": [
            "sbi",
            "SBI_NEED_FSCK"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "set_sbi_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "720-723",
          "snippet": "static inline void set_sbi_flag(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\tsbi->s_flag |= (0x01 << type);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void set_sbi_flag(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\tsbi->s_flag |= (0x01 << type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TOTAL_SEGS",
          "args": [
            "sbi"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void check_seg_range(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tif (segno > TOTAL_SEGS(sbi) - 1)\n\t\tset_sbi_flag(sbi, SBI_NEED_FSCK);\n}"
  },
  {
    "function_name": "check_block_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "570-598",
    "snippet": "static inline void check_block_count(struct f2fs_sb_info *sbi,\n\t\tint segno, struct f2fs_sit_entry *raw_sit)\n{\n\tbool is_valid  = test_bit_le(0, raw_sit->valid_map) ? true : false;\n\tint valid_blocks = 0;\n\tint cur_pos = 0, next_pos;\n\n\t/* check segment usage */\n\tBUG_ON(GET_SIT_VBLOCKS(raw_sit) > sbi->blocks_per_seg);\n\n\t/* check boundary of a given segment number */\n\tBUG_ON(segno > TOTAL_SEGS(sbi) - 1);\n\n\t/* check bitmap with valid block count */\n\tdo {\n\t\tif (is_valid) {\n\t\t\tnext_pos = find_next_zero_bit_le(&raw_sit->valid_map,\n\t\t\t\t\tsbi->blocks_per_seg,\n\t\t\t\t\tcur_pos);\n\t\t\tvalid_blocks += next_pos - cur_pos;\n\t\t} else\n\t\t\tnext_pos = find_next_bit_le(&raw_sit->valid_map,\n\t\t\t\t\tsbi->blocks_per_seg,\n\t\t\t\t\tcur_pos);\n\t\tcur_pos = next_pos;\n\t\tis_valid = !is_valid;\n\t} while (cur_pos < sbi->blocks_per_seg);\n\tBUG_ON(GET_SIT_VBLOCKS(raw_sit) != valid_blocks);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "GET_SIT_VBLOCKS(raw_sit) != valid_blocks"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_SIT_VBLOCKS",
          "args": [
            "raw_sit"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_next_bit_le",
          "args": [
            "&raw_sit->valid_map",
            "sbi->blocks_per_seg",
            "cur_pos"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_next_zero_bit_le",
          "args": [
            "&raw_sit->valid_map",
            "sbi->blocks_per_seg",
            "cur_pos"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "segno > TOTAL_SEGS(sbi) - 1"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOTAL_SEGS",
          "args": [
            "sbi"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "GET_SIT_VBLOCKS(raw_sit) > sbi->blocks_per_seg"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_SIT_VBLOCKS",
          "args": [
            "raw_sit"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit_le",
          "args": [
            "0",
            "raw_sit->valid_map"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void check_block_count(struct f2fs_sb_info *sbi,\n\t\tint segno, struct f2fs_sit_entry *raw_sit)\n{\n\tbool is_valid  = test_bit_le(0, raw_sit->valid_map) ? true : false;\n\tint valid_blocks = 0;\n\tint cur_pos = 0, next_pos;\n\n\t/* check segment usage */\n\tBUG_ON(GET_SIT_VBLOCKS(raw_sit) > sbi->blocks_per_seg);\n\n\t/* check boundary of a given segment number */\n\tBUG_ON(segno > TOTAL_SEGS(sbi) - 1);\n\n\t/* check bitmap with valid block count */\n\tdo {\n\t\tif (is_valid) {\n\t\t\tnext_pos = find_next_zero_bit_le(&raw_sit->valid_map,\n\t\t\t\t\tsbi->blocks_per_seg,\n\t\t\t\t\tcur_pos);\n\t\t\tvalid_blocks += next_pos - cur_pos;\n\t\t} else\n\t\t\tnext_pos = find_next_bit_le(&raw_sit->valid_map,\n\t\t\t\t\tsbi->blocks_per_seg,\n\t\t\t\t\tcur_pos);\n\t\tcur_pos = next_pos;\n\t\tis_valid = !is_valid;\n\t} while (cur_pos < sbi->blocks_per_seg);\n\tBUG_ON(GET_SIT_VBLOCKS(raw_sit) != valid_blocks);\n}"
  },
  {
    "function_name": "verify_block_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "561-565",
    "snippet": "static inline void verify_block_addr(struct f2fs_sb_info *sbi, block_t blk_addr)\n{\n\tBUG_ON(blk_addr < SEG0_BLKADDR(sbi));\n\tBUG_ON(blk_addr >= MAX_BLKADDR(sbi));\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "blk_addr >= MAX_BLKADDR(sbi)"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAX_BLKADDR",
          "args": [
            "sbi"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "blk_addr < SEG0_BLKADDR(sbi)"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SEG0_BLKADDR",
          "args": [
            "sbi"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void verify_block_addr(struct f2fs_sb_info *sbi, block_t blk_addr)\n{\n\tBUG_ON(blk_addr < SEG0_BLKADDR(sbi));\n\tBUG_ON(blk_addr >= MAX_BLKADDR(sbi));\n}"
  },
  {
    "function_name": "check_seg_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "556-559",
    "snippet": "static inline void check_seg_range(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tBUG_ON(segno > TOTAL_SEGS(sbi) - 1);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "segno > TOTAL_SEGS(sbi) - 1"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TOTAL_SEGS",
          "args": [
            "sbi"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void check_seg_range(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tBUG_ON(segno > TOTAL_SEGS(sbi) - 1);\n}"
  },
  {
    "function_name": "curseg_blkoff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "549-553",
    "snippet": "static inline unsigned short curseg_blkoff(struct f2fs_sb_info *sbi, int type)\n{\n\tstruct curseg_info *curseg = CURSEG_I(sbi, type);\n\treturn curseg->next_blkoff;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CURSEG_I",
          "args": [
            "sbi",
            "type"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "CURSEG_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "263-266",
          "snippet": "static inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned short curseg_blkoff(struct f2fs_sb_info *sbi, int type)\n{\n\tstruct curseg_info *curseg = CURSEG_I(sbi, type);\n\treturn curseg->next_blkoff;\n}"
  },
  {
    "function_name": "curseg_alloc_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "542-547",
    "snippet": "static inline unsigned char curseg_alloc_type(struct f2fs_sb_info *sbi,\n\t\tint type)\n{\n\tstruct curseg_info *curseg = CURSEG_I(sbi, type);\n\treturn curseg->alloc_type;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CURSEG_I",
          "args": [
            "sbi",
            "type"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "CURSEG_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "263-266",
          "snippet": "static inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned char curseg_alloc_type(struct f2fs_sb_info *sbi,\n\t\tint type)\n{\n\tstruct curseg_info *curseg = CURSEG_I(sbi, type);\n\treturn curseg->alloc_type;\n}"
  },
  {
    "function_name": "curseg_segno",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "535-540",
    "snippet": "static inline unsigned int curseg_segno(struct f2fs_sb_info *sbi,\n\t\tint type)\n{\n\tstruct curseg_info *curseg = CURSEG_I(sbi, type);\n\treturn curseg->segno;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CURSEG_I",
          "args": [
            "sbi",
            "type"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "CURSEG_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "263-266",
          "snippet": "static inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int curseg_segno(struct f2fs_sb_info *sbi,\n\t\tint type)\n{\n\tstruct curseg_info *curseg = CURSEG_I(sbi, type);\n\treturn curseg->segno;\n}"
  },
  {
    "function_name": "need_inplace_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "507-533",
    "snippet": "static inline bool need_inplace_update(struct inode *inode)\n{\n\tstruct f2fs_sb_info *sbi = F2FS_I_SB(inode);\n\tunsigned int policy = SM_I(sbi)->ipu_policy;\n\n\t/* IPU can be done only for the user data */\n\tif (S_ISDIR(inode->i_mode) || f2fs_is_atomic_file(inode))\n\t\treturn false;\n\n\tif (policy & (0x1 << F2FS_IPU_FORCE))\n\t\treturn true;\n\tif (policy & (0x1 << F2FS_IPU_SSR) && need_SSR(sbi))\n\t\treturn true;\n\tif (policy & (0x1 << F2FS_IPU_UTIL) &&\n\t\t\tutilization(sbi) > SM_I(sbi)->min_ipu_util)\n\t\treturn true;\n\tif (policy & (0x1 << F2FS_IPU_SSR_UTIL) && need_SSR(sbi) &&\n\t\t\tutilization(sbi) > SM_I(sbi)->min_ipu_util)\n\t\treturn true;\n\n\t/* this is only set during fdatasync */\n\tif (policy & (0x1 << F2FS_IPU_FSYNC) &&\n\t\t\tis_inode_flag_set(F2FS_I(inode), FI_NEED_IPU))\n\t\treturn true;\n\n\treturn false;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_inode_flag_set",
          "args": [
            "F2FS_I(inode)",
            "FI_NEED_IPU"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "is_inode_flag_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1179-1182",
          "snippet": "static inline int is_inode_flag_set(struct f2fs_inode_info *fi, int flag)\n{\n\treturn test_bit(flag, &fi->flags);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int is_inode_flag_set(struct f2fs_inode_info *fi, int flag)\n{\n\treturn test_bit(flag, &fi->flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "F2FS_I",
          "args": [
            "inode"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "F2FS_INODE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "675-678",
          "snippet": "static inline struct f2fs_inode *F2FS_INODE(struct page *page)\n{\n\treturn &((struct f2fs_node *)page_address(page))->i;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_inode *F2FS_INODE(struct page *page)\n{\n\treturn &((struct f2fs_node *)page_address(page))->i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SM_I",
          "args": [
            "sbi"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "SM_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "685-688",
          "snippet": "static inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "utilization",
          "args": [
            "sbi"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "utilization",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "476-480",
          "snippet": "static inline int utilization(struct f2fs_sb_info *sbi)\n{\n\treturn div_u64((u64)valid_user_blocks(sbi) * 100,\n\t\t\t\t\tsbi->user_block_count);\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int utilization(struct f2fs_sb_info *sbi)\n{\n\treturn div_u64((u64)valid_user_blocks(sbi) * 100,\n\t\t\t\t\tsbi->user_block_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "need_SSR",
          "args": [
            "sbi"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "need_SSR",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "451-457",
          "snippet": "static inline bool need_SSR(struct f2fs_sb_info *sbi)\n{\n\tint node_secs = get_blocktype_secs(sbi, F2FS_DIRTY_NODES);\n\tint dent_secs = get_blocktype_secs(sbi, F2FS_DIRTY_DENTS);\n\treturn free_sections(sbi) <= (node_secs + 2 * dent_secs +\n\t\t\t\t\t\treserved_sections(sbi) + 1);\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline bool need_SSR(struct f2fs_sb_info *sbi)\n{\n\tint node_secs = get_blocktype_secs(sbi, F2FS_DIRTY_NODES);\n\tint dent_secs = get_blocktype_secs(sbi, F2FS_DIRTY_DENTS);\n\treturn free_sections(sbi) <= (node_secs + 2 * dent_secs +\n\t\t\t\t\t\treserved_sections(sbi) + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "f2fs_is_atomic_file",
          "args": [
            "inode"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_is_atomic_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1267-1270",
          "snippet": "static inline bool f2fs_is_atomic_file(struct inode *inode)\n{\n\treturn is_inode_flag_set(F2FS_I(inode), FI_ATOMIC_FILE);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline bool f2fs_is_atomic_file(struct inode *inode)\n{\n\treturn is_inode_flag_set(F2FS_I(inode), FI_ATOMIC_FILE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "F2FS_I_SB",
          "args": [
            "inode"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "F2FS_I_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "645-648",
          "snippet": "static inline struct f2fs_sb_info *F2FS_I_SB(struct inode *inode)\n{\n\treturn F2FS_SB(inode->i_sb);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sb_info *F2FS_I_SB(struct inode *inode)\n{\n\treturn F2FS_SB(inode->i_sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline bool need_inplace_update(struct inode *inode)\n{\n\tstruct f2fs_sb_info *sbi = F2FS_I_SB(inode);\n\tunsigned int policy = SM_I(sbi)->ipu_policy;\n\n\t/* IPU can be done only for the user data */\n\tif (S_ISDIR(inode->i_mode) || f2fs_is_atomic_file(inode))\n\t\treturn false;\n\n\tif (policy & (0x1 << F2FS_IPU_FORCE))\n\t\treturn true;\n\tif (policy & (0x1 << F2FS_IPU_SSR) && need_SSR(sbi))\n\t\treturn true;\n\tif (policy & (0x1 << F2FS_IPU_UTIL) &&\n\t\t\tutilization(sbi) > SM_I(sbi)->min_ipu_util)\n\t\treturn true;\n\tif (policy & (0x1 << F2FS_IPU_SSR_UTIL) && need_SSR(sbi) &&\n\t\t\tutilization(sbi) > SM_I(sbi)->min_ipu_util)\n\t\treturn true;\n\n\t/* this is only set during fdatasync */\n\tif (policy & (0x1 << F2FS_IPU_FSYNC) &&\n\t\t\tis_inode_flag_set(F2FS_I(inode), FI_NEED_IPU))\n\t\treturn true;\n\n\treturn false;\n}"
  },
  {
    "function_name": "utilization",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "476-480",
    "snippet": "static inline int utilization(struct f2fs_sb_info *sbi)\n{\n\treturn div_u64((u64)valid_user_blocks(sbi) * 100,\n\t\t\t\t\tsbi->user_block_count);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "(u64)valid_user_blocks(sbi) * 100",
            "sbi->user_block_count"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valid_user_blocks",
          "args": [
            "sbi"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "valid_user_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "905-908",
          "snippet": "static inline block_t valid_user_blocks(struct f2fs_sb_info *sbi)\n{\n\treturn sbi->total_valid_block_count;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline block_t valid_user_blocks(struct f2fs_sb_info *sbi)\n{\n\treturn sbi->total_valid_block_count;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int utilization(struct f2fs_sb_info *sbi)\n{\n\treturn div_u64((u64)valid_user_blocks(sbi) * 100,\n\t\t\t\t\tsbi->user_block_count);\n}"
  },
  {
    "function_name": "excess_prefree_segs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "471-474",
    "snippet": "static inline bool excess_prefree_segs(struct f2fs_sb_info *sbi)\n{\n\treturn prefree_segments(sbi) > SM_I(sbi)->rec_prefree_segments;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SM_I",
          "args": [
            "sbi"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "SM_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "685-688",
          "snippet": "static inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prefree_segments",
          "args": [
            "sbi"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "prefree_segments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "421-424",
          "snippet": "static inline unsigned int prefree_segments(struct f2fs_sb_info *sbi)\n{\n\treturn DIRTY_I(sbi)->nr_dirty[PRE];\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int prefree_segments(struct f2fs_sb_info *sbi)\n{\n\treturn DIRTY_I(sbi)->nr_dirty[PRE];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline bool excess_prefree_segs(struct f2fs_sb_info *sbi)\n{\n\treturn prefree_segments(sbi) > SM_I(sbi)->rec_prefree_segments;\n}"
  },
  {
    "function_name": "has_not_enough_free_secs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "459-469",
    "snippet": "static inline bool has_not_enough_free_secs(struct f2fs_sb_info *sbi, int freed)\n{\n\tint node_secs = get_blocktype_secs(sbi, F2FS_DIRTY_NODES);\n\tint dent_secs = get_blocktype_secs(sbi, F2FS_DIRTY_DENTS);\n\n\tif (unlikely(is_sbi_flag_set(sbi, SBI_POR_DOING)))\n\t\treturn false;\n\n\treturn (free_sections(sbi) + freed) <= (node_secs + 2 * dent_secs +\n\t\t\t\t\t\treserved_sections(sbi));\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reserved_sections",
          "args": [
            "sbi"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "reserved_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "446-449",
          "snippet": "static inline int reserved_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) reserved_segments(sbi)) / sbi->segs_per_sec;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int reserved_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) reserved_segments(sbi)) / sbi->segs_per_sec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_sections",
          "args": [
            "sbi"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "free_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "416-419",
          "snippet": "static inline unsigned int free_sections(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_sections;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int free_sections(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_sections;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "is_sbi_flag_set(sbi, SBI_POR_DOING)"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_sbi_flag_set",
          "args": [
            "sbi",
            "SBI_POR_DOING"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "is_sbi_flag_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "715-718",
          "snippet": "static inline bool is_sbi_flag_set(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\treturn sbi->s_flag & (0x01 << type);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline bool is_sbi_flag_set(struct f2fs_sb_info *sbi, unsigned int type)\n{\n\treturn sbi->s_flag & (0x01 << type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_blocktype_secs",
          "args": [
            "sbi",
            "F2FS_DIRTY_DENTS"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "get_blocktype_secs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "897-903",
          "snippet": "static inline int get_blocktype_secs(struct f2fs_sb_info *sbi, int block_type)\n{\n\tunsigned int pages_per_sec = sbi->segs_per_sec *\n\t\t\t\t\t(1 << sbi->log_blocks_per_seg);\n\treturn ((get_pages(sbi, block_type) + pages_per_sec - 1)\n\t\t\t>> sbi->log_blocks_per_seg) / sbi->segs_per_sec;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int get_blocktype_secs(struct f2fs_sb_info *sbi, int block_type)\n{\n\tunsigned int pages_per_sec = sbi->segs_per_sec *\n\t\t\t\t\t(1 << sbi->log_blocks_per_seg);\n\treturn ((get_pages(sbi, block_type) + pages_per_sec - 1)\n\t\t\t>> sbi->log_blocks_per_seg) / sbi->segs_per_sec;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline bool has_not_enough_free_secs(struct f2fs_sb_info *sbi, int freed)\n{\n\tint node_secs = get_blocktype_secs(sbi, F2FS_DIRTY_NODES);\n\tint dent_secs = get_blocktype_secs(sbi, F2FS_DIRTY_DENTS);\n\n\tif (unlikely(is_sbi_flag_set(sbi, SBI_POR_DOING)))\n\t\treturn false;\n\n\treturn (free_sections(sbi) + freed) <= (node_secs + 2 * dent_secs +\n\t\t\t\t\t\treserved_sections(sbi));\n}"
  },
  {
    "function_name": "need_SSR",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "451-457",
    "snippet": "static inline bool need_SSR(struct f2fs_sb_info *sbi)\n{\n\tint node_secs = get_blocktype_secs(sbi, F2FS_DIRTY_NODES);\n\tint dent_secs = get_blocktype_secs(sbi, F2FS_DIRTY_DENTS);\n\treturn free_sections(sbi) <= (node_secs + 2 * dent_secs +\n\t\t\t\t\t\treserved_sections(sbi) + 1);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reserved_sections",
          "args": [
            "sbi"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "reserved_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "446-449",
          "snippet": "static inline int reserved_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) reserved_segments(sbi)) / sbi->segs_per_sec;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int reserved_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) reserved_segments(sbi)) / sbi->segs_per_sec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_sections",
          "args": [
            "sbi"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "free_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "416-419",
          "snippet": "static inline unsigned int free_sections(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_sections;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int free_sections(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_sections;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_blocktype_secs",
          "args": [
            "sbi",
            "F2FS_DIRTY_DENTS"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "get_blocktype_secs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "897-903",
          "snippet": "static inline int get_blocktype_secs(struct f2fs_sb_info *sbi, int block_type)\n{\n\tunsigned int pages_per_sec = sbi->segs_per_sec *\n\t\t\t\t\t(1 << sbi->log_blocks_per_seg);\n\treturn ((get_pages(sbi, block_type) + pages_per_sec - 1)\n\t\t\t>> sbi->log_blocks_per_seg) / sbi->segs_per_sec;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int get_blocktype_secs(struct f2fs_sb_info *sbi, int block_type)\n{\n\tunsigned int pages_per_sec = sbi->segs_per_sec *\n\t\t\t\t\t(1 << sbi->log_blocks_per_seg);\n\treturn ((get_pages(sbi, block_type) + pages_per_sec - 1)\n\t\t\t>> sbi->log_blocks_per_seg) / sbi->segs_per_sec;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline bool need_SSR(struct f2fs_sb_info *sbi)\n{\n\tint node_secs = get_blocktype_secs(sbi, F2FS_DIRTY_NODES);\n\tint dent_secs = get_blocktype_secs(sbi, F2FS_DIRTY_DENTS);\n\treturn free_sections(sbi) <= (node_secs + 2 * dent_secs +\n\t\t\t\t\t\treserved_sections(sbi) + 1);\n}"
  },
  {
    "function_name": "reserved_sections",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "446-449",
    "snippet": "static inline int reserved_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) reserved_segments(sbi)) / sbi->segs_per_sec;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reserved_segments",
          "args": [
            "sbi"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "reserved_segments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "411-414",
          "snippet": "static inline int reserved_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->reserved_segments;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int reserved_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->reserved_segments;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int reserved_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) reserved_segments(sbi)) / sbi->segs_per_sec;\n}"
  },
  {
    "function_name": "overprovision_sections",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "441-444",
    "snippet": "static inline int overprovision_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) overprovision_segments(sbi)) / sbi->segs_per_sec;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "overprovision_segments",
          "args": [
            "sbi"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "overprovision_segments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "436-439",
          "snippet": "static inline int overprovision_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->ovp_segments;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int overprovision_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->ovp_segments;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int overprovision_sections(struct f2fs_sb_info *sbi)\n{\n\treturn ((unsigned int) overprovision_segments(sbi)) / sbi->segs_per_sec;\n}"
  },
  {
    "function_name": "overprovision_segments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "436-439",
    "snippet": "static inline int overprovision_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->ovp_segments;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SM_I",
          "args": [
            "sbi"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "SM_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "685-688",
          "snippet": "static inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int overprovision_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->ovp_segments;\n}"
  },
  {
    "function_name": "dirty_segments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "426-434",
    "snippet": "static inline unsigned int dirty_segments(struct f2fs_sb_info *sbi)\n{\n\treturn DIRTY_I(sbi)->nr_dirty[DIRTY_HOT_DATA] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_WARM_DATA] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_COLD_DATA] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_HOT_NODE] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_WARM_NODE] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_COLD_NODE];\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIRTY_I",
          "args": [
            "sbi"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "DIRTY_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "700-703",
          "snippet": "static inline struct dirty_seglist_info *DIRTY_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct dirty_seglist_info *)(SM_I(sbi)->dirty_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct dirty_seglist_info *DIRTY_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct dirty_seglist_info *)(SM_I(sbi)->dirty_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int dirty_segments(struct f2fs_sb_info *sbi)\n{\n\treturn DIRTY_I(sbi)->nr_dirty[DIRTY_HOT_DATA] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_WARM_DATA] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_COLD_DATA] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_HOT_NODE] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_WARM_NODE] +\n\t\tDIRTY_I(sbi)->nr_dirty[DIRTY_COLD_NODE];\n}"
  },
  {
    "function_name": "prefree_segments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "421-424",
    "snippet": "static inline unsigned int prefree_segments(struct f2fs_sb_info *sbi)\n{\n\treturn DIRTY_I(sbi)->nr_dirty[PRE];\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIRTY_I",
          "args": [
            "sbi"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "DIRTY_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "700-703",
          "snippet": "static inline struct dirty_seglist_info *DIRTY_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct dirty_seglist_info *)(SM_I(sbi)->dirty_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct dirty_seglist_info *DIRTY_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct dirty_seglist_info *)(SM_I(sbi)->dirty_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int prefree_segments(struct f2fs_sb_info *sbi)\n{\n\treturn DIRTY_I(sbi)->nr_dirty[PRE];\n}"
  },
  {
    "function_name": "free_sections",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "416-419",
    "snippet": "static inline unsigned int free_sections(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_sections;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FREE_I",
          "args": [
            "sbi"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "FREE_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "695-698",
          "snippet": "static inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int free_sections(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_sections;\n}"
  },
  {
    "function_name": "reserved_segments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "411-414",
    "snippet": "static inline int reserved_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->reserved_segments;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SM_I",
          "args": [
            "sbi"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "SM_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "685-688",
          "snippet": "static inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int reserved_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->reserved_segments;\n}"
  },
  {
    "function_name": "free_segments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "406-409",
    "snippet": "static inline unsigned int free_segments(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_segments;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FREE_I",
          "args": [
            "sbi"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "FREE_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "695-698",
          "snippet": "static inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int free_segments(struct f2fs_sb_info *sbi)\n{\n\treturn FREE_I(sbi)->free_segments;\n}"
  },
  {
    "function_name": "written_block_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "401-404",
    "snippet": "static inline block_t written_block_count(struct f2fs_sb_info *sbi)\n{\n\treturn SIT_I(sbi)->written_valid_blocks;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline block_t written_block_count(struct f2fs_sb_info *sbi)\n{\n\treturn SIT_I(sbi)->written_valid_blocks;\n}"
  },
  {
    "function_name": "get_sit_bitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "394-399",
    "snippet": "static inline void get_sit_bitmap(struct f2fs_sb_info *sbi,\n\t\tvoid *dst_addr)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\tmemcpy(dst_addr, sit_i->sit_bitmap, sit_i->bitmap_size);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst_addr",
            "sit_i->sit_bitmap",
            "sit_i->bitmap_size"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void get_sit_bitmap(struct f2fs_sb_info *sbi,\n\t\tvoid *dst_addr)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\tmemcpy(dst_addr, sit_i->sit_bitmap, sit_i->bitmap_size);\n}"
  },
  {
    "function_name": "__set_test_and_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "380-392",
    "snippet": "static inline void __set_test_and_inuse(struct f2fs_sb_info *sbi,\n\t\tunsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tspin_lock(&free_i->segmap_lock);\n\tif (!test_and_set_bit(segno, free_i->free_segmap)) {\n\t\tfree_i->free_segments--;\n\t\tif (!test_and_set_bit(secno, free_i->free_secmap))\n\t\t\tfree_i->free_sections--;\n\t}\n\tspin_unlock(&free_i->segmap_lock);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "secno",
            "free_i->free_secmap"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "FREE_I",
          "args": [
            "sbi"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "FREE_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "695-698",
          "snippet": "static inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void __set_test_and_inuse(struct f2fs_sb_info *sbi,\n\t\tunsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tspin_lock(&free_i->segmap_lock);\n\tif (!test_and_set_bit(segno, free_i->free_segmap)) {\n\t\tfree_i->free_segments--;\n\t\tif (!test_and_set_bit(secno, free_i->free_secmap))\n\t\t\tfree_i->free_sections--;\n\t}\n\tspin_unlock(&free_i->segmap_lock);\n}"
  },
  {
    "function_name": "__set_test_and_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "358-378",
    "snippet": "static inline void __set_test_and_free(struct f2fs_sb_info *sbi,\n\t\tunsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tunsigned int start_segno = secno * sbi->segs_per_sec;\n\tunsigned int next;\n\n\tspin_lock(&free_i->segmap_lock);\n\tif (test_and_clear_bit(segno, free_i->free_segmap)) {\n\t\tfree_i->free_segments++;\n\n\t\tnext = find_next_bit(free_i->free_segmap,\n\t\t\t\tstart_segno + sbi->segs_per_sec, start_segno);\n\t\tif (next >= start_segno + sbi->segs_per_sec) {\n\t\t\tif (test_and_clear_bit(secno, free_i->free_secmap))\n\t\t\t\tfree_i->free_sections++;\n\t\t}\n\t}\n\tspin_unlock(&free_i->segmap_lock);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "secno",
            "free_i->free_secmap"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "free_i->free_segmap",
            "start_segno + sbi->segs_per_sec",
            "start_segno"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "FREE_I",
          "args": [
            "sbi"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "FREE_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "695-698",
          "snippet": "static inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void __set_test_and_free(struct f2fs_sb_info *sbi,\n\t\tunsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tunsigned int start_segno = secno * sbi->segs_per_sec;\n\tunsigned int next;\n\n\tspin_lock(&free_i->segmap_lock);\n\tif (test_and_clear_bit(segno, free_i->free_segmap)) {\n\t\tfree_i->free_segments++;\n\n\t\tnext = find_next_bit(free_i->free_segmap,\n\t\t\t\tstart_segno + sbi->segs_per_sec, start_segno);\n\t\tif (next >= start_segno + sbi->segs_per_sec) {\n\t\t\tif (test_and_clear_bit(secno, free_i->free_secmap))\n\t\t\t\tfree_i->free_sections++;\n\t\t}\n\t}\n\tspin_unlock(&free_i->segmap_lock);\n}"
  },
  {
    "function_name": "__set_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "347-356",
    "snippet": "static inline void __set_inuse(struct f2fs_sb_info *sbi,\n\t\tunsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tset_bit(segno, free_i->free_segmap);\n\tfree_i->free_segments--;\n\tif (!test_and_set_bit(secno, free_i->free_secmap))\n\t\tfree_i->free_sections--;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "secno",
            "free_i->free_secmap"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FREE_I",
          "args": [
            "sbi"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "FREE_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "695-698",
          "snippet": "static inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void __set_inuse(struct f2fs_sb_info *sbi,\n\t\tunsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tset_bit(segno, free_i->free_segmap);\n\tfree_i->free_segments--;\n\tif (!test_and_set_bit(secno, free_i->free_secmap))\n\t\tfree_i->free_sections--;\n}"
  },
  {
    "function_name": "__set_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "328-345",
    "snippet": "static inline void __set_free(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tunsigned int start_segno = secno * sbi->segs_per_sec;\n\tunsigned int next;\n\n\tspin_lock(&free_i->segmap_lock);\n\tclear_bit(segno, free_i->free_segmap);\n\tfree_i->free_segments++;\n\n\tnext = find_next_bit(free_i->free_segmap, MAIN_SEGS(sbi), start_segno);\n\tif (next >= start_segno + sbi->segs_per_sec) {\n\t\tclear_bit(secno, free_i->free_secmap);\n\t\tfree_i->free_sections++;\n\t}\n\tspin_unlock(&free_i->segmap_lock);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "secno",
            "free_i->free_secmap"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "free_i->free_segmap",
            "MAIN_SEGS(sbi)",
            "start_segno"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MAIN_SEGS",
          "args": [
            "sbi"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "FREE_I",
          "args": [
            "sbi"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "FREE_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "695-698",
          "snippet": "static inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct free_segmap_info *FREE_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct free_segmap_info *)(SM_I(sbi)->free_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void __set_free(struct f2fs_sb_info *sbi, unsigned int segno)\n{\n\tstruct free_segmap_info *free_i = FREE_I(sbi);\n\tunsigned int secno = segno / sbi->segs_per_sec;\n\tunsigned int start_segno = secno * sbi->segs_per_sec;\n\tunsigned int next;\n\n\tspin_lock(&free_i->segmap_lock);\n\tclear_bit(segno, free_i->free_segmap);\n\tfree_i->free_segments++;\n\n\tnext = find_next_bit(free_i->free_segmap, MAIN_SEGS(sbi), start_segno);\n\tif (next >= start_segno + sbi->segs_per_sec) {\n\t\tclear_bit(secno, free_i->free_secmap);\n\t\tfree_i->free_sections++;\n\t}\n\tspin_unlock(&free_i->segmap_lock);\n}"
  },
  {
    "function_name": "find_next_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "318-326",
    "snippet": "static inline unsigned int find_next_inuse(struct free_segmap_info *free_i,\n\t\tunsigned int max, unsigned int segno)\n{\n\tunsigned int ret;\n\tspin_lock(&free_i->segmap_lock);\n\tret = find_next_bit(free_i->free_segmap, max, segno);\n\tspin_unlock(&free_i->segmap_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "free_i->free_segmap",
            "max",
            "segno"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&free_i->segmap_lock"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int find_next_inuse(struct free_segmap_info *free_i,\n\t\tunsigned int max, unsigned int segno)\n{\n\tunsigned int ret;\n\tspin_lock(&free_i->segmap_lock);\n\tret = find_next_bit(free_i->free_segmap, max, segno);\n\tspin_unlock(&free_i->segmap_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "seg_info_to_raw_sit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "306-316",
    "snippet": "static inline void seg_info_to_raw_sit(struct seg_entry *se,\n\t\t\t\t\tstruct f2fs_sit_entry *rs)\n{\n\tunsigned short raw_vblocks = (se->type << SIT_VBLOCKS_SHIFT) |\n\t\t\t\t\tse->valid_blocks;\n\trs->vblocks = cpu_to_le16(raw_vblocks);\n\tmemcpy(rs->valid_map, se->cur_valid_map, SIT_VBLOCK_MAP_SIZE);\n\tmemcpy(se->ckpt_valid_map, rs->valid_map, SIT_VBLOCK_MAP_SIZE);\n\tse->ckpt_valid_blocks = se->valid_blocks;\n\trs->mtime = cpu_to_le64(se->mtime);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "se->mtime"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "se->ckpt_valid_map",
            "rs->valid_map",
            "SIT_VBLOCK_MAP_SIZE"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "rs->valid_map",
            "se->cur_valid_map",
            "SIT_VBLOCK_MAP_SIZE"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "raw_vblocks"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void seg_info_to_raw_sit(struct seg_entry *se,\n\t\t\t\t\tstruct f2fs_sit_entry *rs)\n{\n\tunsigned short raw_vblocks = (se->type << SIT_VBLOCKS_SHIFT) |\n\t\t\t\t\tse->valid_blocks;\n\trs->vblocks = cpu_to_le16(raw_vblocks);\n\tmemcpy(rs->valid_map, se->cur_valid_map, SIT_VBLOCK_MAP_SIZE);\n\tmemcpy(se->ckpt_valid_map, rs->valid_map, SIT_VBLOCK_MAP_SIZE);\n\tse->ckpt_valid_blocks = se->valid_blocks;\n\trs->mtime = cpu_to_le64(se->mtime);\n}"
  },
  {
    "function_name": "seg_info_from_raw_sit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "295-304",
    "snippet": "static inline void seg_info_from_raw_sit(struct seg_entry *se,\n\t\t\t\t\tstruct f2fs_sit_entry *rs)\n{\n\tse->valid_blocks = GET_SIT_VBLOCKS(rs);\n\tse->ckpt_valid_blocks = GET_SIT_VBLOCKS(rs);\n\tmemcpy(se->cur_valid_map, rs->valid_map, SIT_VBLOCK_MAP_SIZE);\n\tmemcpy(se->ckpt_valid_map, rs->valid_map, SIT_VBLOCK_MAP_SIZE);\n\tse->type = GET_SIT_TYPE(rs);\n\tse->mtime = le64_to_cpu(rs->mtime);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "rs->mtime"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_SIT_TYPE",
          "args": [
            "rs"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "se->ckpt_valid_map",
            "rs->valid_map",
            "SIT_VBLOCK_MAP_SIZE"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "se->cur_valid_map",
            "rs->valid_map",
            "SIT_VBLOCK_MAP_SIZE"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_SIT_VBLOCKS",
          "args": [
            "rs"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_SIT_VBLOCKS",
          "args": [
            "rs"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline void seg_info_from_raw_sit(struct seg_entry *se,\n\t\t\t\t\tstruct f2fs_sit_entry *rs)\n{\n\tse->valid_blocks = GET_SIT_VBLOCKS(rs);\n\tse->ckpt_valid_blocks = GET_SIT_VBLOCKS(rs);\n\tmemcpy(se->cur_valid_map, rs->valid_map, SIT_VBLOCK_MAP_SIZE);\n\tmemcpy(se->ckpt_valid_map, rs->valid_map, SIT_VBLOCK_MAP_SIZE);\n\tse->type = GET_SIT_TYPE(rs);\n\tse->mtime = le64_to_cpu(rs->mtime);\n}"
  },
  {
    "function_name": "get_valid_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "282-293",
    "snippet": "static inline unsigned int get_valid_blocks(struct f2fs_sb_info *sbi,\n\t\t\t\tunsigned int segno, int section)\n{\n\t/*\n\t * In order to get # of valid blocks in a section instantly from many\n\t * segments, f2fs manages two counting structures separately.\n\t */\n\tif (section > 1)\n\t\treturn get_sec_entry(sbi, segno)->valid_blocks;\n\telse\n\t\treturn get_seg_entry(sbi, segno)->valid_blocks;\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_seg_entry",
          "args": [
            "sbi",
            "segno"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "get_seg_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "268-273",
          "snippet": "static inline struct seg_entry *get_seg_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sentries[segno];\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct seg_entry *get_seg_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sentries[segno];\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_sec_entry",
          "args": [
            "sbi",
            "segno"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "get_sec_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "275-280",
          "snippet": "static inline struct sec_entry *get_sec_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sec_entries[GET_SECNO(sbi, segno)];\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct sec_entry *get_sec_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sec_entries[GET_SECNO(sbi, segno)];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline unsigned int get_valid_blocks(struct f2fs_sb_info *sbi,\n\t\t\t\tunsigned int segno, int section)\n{\n\t/*\n\t * In order to get # of valid blocks in a section instantly from many\n\t * segments, f2fs manages two counting structures separately.\n\t */\n\tif (section > 1)\n\t\treturn get_sec_entry(sbi, segno)->valid_blocks;\n\telse\n\t\treturn get_seg_entry(sbi, segno)->valid_blocks;\n}"
  },
  {
    "function_name": "get_sec_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "275-280",
    "snippet": "static inline struct sec_entry *get_sec_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sec_entries[GET_SECNO(sbi, segno)];\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GET_SECNO",
          "args": [
            "sbi",
            "segno"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct sec_entry *get_sec_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sec_entries[GET_SECNO(sbi, segno)];\n}"
  },
  {
    "function_name": "get_seg_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "268-273",
    "snippet": "static inline struct seg_entry *get_seg_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sentries[segno];\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SIT_I",
          "args": [
            "sbi"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "SIT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "690-693",
          "snippet": "static inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct sit_info *SIT_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct sit_info *)(SM_I(sbi)->sit_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct seg_entry *get_seg_entry(struct f2fs_sb_info *sbi,\n\t\t\t\t\t\tunsigned int segno)\n{\n\tstruct sit_info *sit_i = SIT_I(sbi);\n\treturn &sit_i->sentries[segno];\n}"
  },
  {
    "function_name": "CURSEG_I",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
    "lines": "263-266",
    "snippet": "static inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}",
    "includes": [
      "#include <linux/blkdev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SM_I",
          "args": [
            "sbi"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "SM_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "685-688",
          "snippet": "static inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sm_info *SM_I(struct f2fs_sb_info *sbi)\n{\n\treturn (struct f2fs_sm_info *)(sbi->sm_info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline struct curseg_info *CURSEG_I(struct f2fs_sb_info *sbi, int type)\n{\n\treturn (struct curseg_info *)(SM_I(sbi)->curseg_array + type);\n}"
  }
]