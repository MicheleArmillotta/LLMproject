[
  {
    "function_name": "nfsd_stat_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/stats.c",
    "lines": "100-104",
    "snippet": "void\nnfsd_stat_shutdown(void)\n{\n\tsvc_proc_unregister(&init_net, \"nfsd\");\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/module.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "svc_proc_unregister",
          "args": [
            "&init_net",
            "\"nfsd\""
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfsd.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n\nvoid\nnfsd_stat_shutdown(void)\n{\n\tsvc_proc_unregister(&init_net, \"nfsd\");\n}"
  },
  {
    "function_name": "nfsd_stat_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/stats.c",
    "lines": "94-98",
    "snippet": "void\nnfsd_stat_init(void)\n{\n\tsvc_proc_register(&init_net, &nfsd_svcstats, &nfsd_proc_fops);\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/module.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct svc_stat\t\tnfsd_svcstats = {\n\t.program\t= &nfsd_program,\n};",
      "static const struct file_operations nfsd_proc_fops = {\n\t.owner = THIS_MODULE,\n\t.open = nfsd_proc_open,\n\t.read  = seq_read,\n\t.llseek = seq_lseek,\n\t.release = single_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "svc_proc_register",
          "args": [
            "&init_net",
            "&nfsd_svcstats",
            "&nfsd_proc_fops"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfsd.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n\nstruct svc_stat\t\tnfsd_svcstats = {\n\t.program\t= &nfsd_program,\n};\nstatic const struct file_operations nfsd_proc_fops = {\n\t.owner = THIS_MODULE,\n\t.open = nfsd_proc_open,\n\t.read  = seq_read,\n\t.llseek = seq_lseek,\n\t.release = single_release,\n};\n\nvoid\nnfsd_stat_init(void)\n{\n\tsvc_proc_register(&init_net, &nfsd_svcstats, &nfsd_proc_fops);\n}"
  },
  {
    "function_name": "nfsd_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/stats.c",
    "lines": "81-84",
    "snippet": "static int nfsd_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, nfsd_proc_show, NULL);\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/module.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "nfsd_proc_show",
            "NULL"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "single_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "557-575",
          "snippet": "int single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint single_open(struct file *file, int (*show)(struct seq_file *, void *),\n\t\tvoid *data)\n{\n\tstruct seq_operations *op = kmalloc(sizeof(*op), GFP_KERNEL);\n\tint res = -ENOMEM;\n\n\tif (op) {\n\t\top->start = single_start;\n\t\top->next = single_next;\n\t\top->stop = single_stop;\n\t\top->show = show;\n\t\tres = seq_open(file, op);\n\t\tif (!res)\n\t\t\t((struct seq_file *)file->private_data)->private = data;\n\t\telse\n\t\t\tkfree(op);\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfsd.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n\nstatic int nfsd_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, nfsd_proc_show, NULL);\n}"
  },
  {
    "function_name": "nfsd_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/stats.c",
    "lines": "36-79",
    "snippet": "static int nfsd_proc_show(struct seq_file *seq, void *v)\n{\n\tint i;\n\n\tseq_printf(seq, \"rc %u %u %u\\nfh %u %u %u %u %u\\nio %u %u\\n\",\n\t\t      nfsdstats.rchits,\n\t\t      nfsdstats.rcmisses,\n\t\t      nfsdstats.rcnocache,\n\t\t      nfsdstats.fh_stale,\n\t\t      nfsdstats.fh_lookup,\n\t\t      nfsdstats.fh_anon,\n\t\t      nfsdstats.fh_nocache_dir,\n\t\t      nfsdstats.fh_nocache_nondir,\n\t\t      nfsdstats.io_read,\n\t\t      nfsdstats.io_write);\n\t/* thread usage: */\n\tseq_printf(seq, \"th %u %u\", nfsdstats.th_cnt, nfsdstats.th_fullcnt);\n\tfor (i=0; i<10; i++) {\n\t\tunsigned int jifs = nfsdstats.th_usage[i];\n\t\tunsigned int sec = jifs / HZ, msec = (jifs % HZ)*1000/HZ;\n\t\tseq_printf(seq, \" %u.%03u\", sec, msec);\n\t}\n\n\t/* newline and ra-cache */\n\tseq_printf(seq, \"\\nra %u\", nfsdstats.ra_size);\n\tfor (i=0; i<11; i++)\n\t\tseq_printf(seq, \" %u\", nfsdstats.ra_depth[i]);\n\tseq_putc(seq, '\\n');\n\t\n\t/* show my rpc info */\n\tsvc_seq_show(seq, &nfsd_svcstats);\n\n#ifdef CONFIG_NFSD_V4\n\t/* Show count for individual nfsv4 operations */\n\t/* Writing operation numbers 0 1 2 also for maintaining uniformity */\n\tseq_printf(seq,\"proc4ops %u\", LAST_NFS4_OP + 1);\n\tfor (i = 0; i <= LAST_NFS4_OP; i++)\n\t\tseq_printf(seq, \" %u\", nfsdstats.nfs4_opcount[i]);\n\n\tseq_putc(seq, '\\n');\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/module.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct nfsd_stats\tnfsdstats;",
      "struct svc_stat\t\tnfsd_svcstats = {\n\t.program\t= &nfsd_program,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_putc",
          "args": [
            "seq",
            "'\\n'"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "seq_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "648-655",
          "snippet": "int seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\" %u\"",
            "nfsdstats.nfs4_opcount[i]"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "svc_seq_show",
          "args": [
            "seq",
            "&nfsd_svcstats"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfsd.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n\nstruct nfsd_stats\tnfsdstats;\nstruct svc_stat\t\tnfsd_svcstats = {\n\t.program\t= &nfsd_program,\n};\n\nstatic int nfsd_proc_show(struct seq_file *seq, void *v)\n{\n\tint i;\n\n\tseq_printf(seq, \"rc %u %u %u\\nfh %u %u %u %u %u\\nio %u %u\\n\",\n\t\t      nfsdstats.rchits,\n\t\t      nfsdstats.rcmisses,\n\t\t      nfsdstats.rcnocache,\n\t\t      nfsdstats.fh_stale,\n\t\t      nfsdstats.fh_lookup,\n\t\t      nfsdstats.fh_anon,\n\t\t      nfsdstats.fh_nocache_dir,\n\t\t      nfsdstats.fh_nocache_nondir,\n\t\t      nfsdstats.io_read,\n\t\t      nfsdstats.io_write);\n\t/* thread usage: */\n\tseq_printf(seq, \"th %u %u\", nfsdstats.th_cnt, nfsdstats.th_fullcnt);\n\tfor (i=0; i<10; i++) {\n\t\tunsigned int jifs = nfsdstats.th_usage[i];\n\t\tunsigned int sec = jifs / HZ, msec = (jifs % HZ)*1000/HZ;\n\t\tseq_printf(seq, \" %u.%03u\", sec, msec);\n\t}\n\n\t/* newline and ra-cache */\n\tseq_printf(seq, \"\\nra %u\", nfsdstats.ra_size);\n\tfor (i=0; i<11; i++)\n\t\tseq_printf(seq, \" %u\", nfsdstats.ra_depth[i]);\n\tseq_putc(seq, '\\n');\n\t\n\t/* show my rpc info */\n\tsvc_seq_show(seq, &nfsd_svcstats);\n\n#ifdef CONFIG_NFSD_V4\n\t/* Show count for individual nfsv4 operations */\n\t/* Writing operation numbers 0 1 2 also for maintaining uniformity */\n\tseq_printf(seq,\"proc4ops %u\", LAST_NFS4_OP + 1);\n\tfor (i = 0; i <= LAST_NFS4_OP; i++)\n\t\tseq_printf(seq, \" %u\", nfsdstats.nfs4_opcount[i]);\n\n\tseq_putc(seq, '\\n');\n#endif\n\n\treturn 0;\n}"
  }
]