[
  {
    "function_name": "proc_loadavg_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/loadavg.c",
    "lines": "40-44",
    "snippet": "static int __init proc_loadavg_init(void)\n{\n\tproc_create(\"loadavg\", 0, NULL, &loadavg_proc_fops);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/time.h>",
      "#include <linux/seqlock.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations loadavg_proc_fops = {\n\t.open\t\t= loadavg_proc_open,\n\t.read\t\t= seq_read,\n\t.llseek\t\t= seq_lseek,\n\t.release\t= single_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"loadavg\"",
            "0",
            "NULL",
            "&loadavg_proc_fops"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/time.h>\n#include <linux/seqlock.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/pid_namespace.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic const struct file_operations loadavg_proc_fops = {\n\t.open\t\t= loadavg_proc_open,\n\t.read\t\t= seq_read,\n\t.llseek\t\t= seq_lseek,\n\t.release\t= single_release,\n};\n\nstatic int __init proc_loadavg_init(void)\n{\n\tproc_create(\"loadavg\", 0, NULL, &loadavg_proc_fops);\n\treturn 0;\n}"
  },
  {
    "function_name": "loadavg_proc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/loadavg.c",
    "lines": "28-31",
    "snippet": "static int loadavg_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, loadavg_proc_show, NULL);\n}",
    "includes": [
      "#include <linux/time.h>",
      "#include <linux/seqlock.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "loadavg_proc_show",
            "NULL"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "single_open_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_net.c",
          "lines": "63-84",
          "snippet": "int single_open_net(struct inode *inode, struct file *file,\n\t\tint (*show)(struct seq_file *, void *))\n{\n\tint err;\n\tstruct net *net;\n\n\terr = -ENXIO;\n\tnet = get_proc_net(inode);\n\tif (net == NULL)\n\t\tgoto err_net;\n\n\terr = single_open(file, show, net);\n\tif (err < 0)\n\t\tgoto err_open;\n\n\treturn 0;\n\nerr_open:\n\tput_net(net);\nerr_net:\n\treturn err;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/seq_file.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/mount.h>",
            "#include <linux/bitops.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <asm/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <net/net_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/mount.h>\n#include <linux/bitops.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <asm/uaccess.h>\n\nint single_open_net(struct inode *inode, struct file *file,\n\t\tint (*show)(struct seq_file *, void *))\n{\n\tint err;\n\tstruct net *net;\n\n\terr = -ENXIO;\n\tnet = get_proc_net(inode);\n\tif (net == NULL)\n\t\tgoto err_net;\n\n\terr = single_open(file, show, net);\n\tif (err < 0)\n\t\tgoto err_open;\n\n\treturn 0;\n\nerr_open:\n\tput_net(net);\nerr_net:\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/time.h>\n#include <linux/seqlock.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/pid_namespace.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int loadavg_proc_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, loadavg_proc_show, NULL);\n}"
  },
  {
    "function_name": "loadavg_proc_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/loadavg.c",
    "lines": "13-26",
    "snippet": "static int loadavg_proc_show(struct seq_file *m, void *v)\n{\n\tunsigned long avnrun[3];\n\n\tget_avenrun(avnrun, FIXED_1/200, 0);\n\n\tseq_printf(m, \"%lu.%02lu %lu.%02lu %lu.%02lu %ld/%d %d\\n\",\n\t\tLOAD_INT(avnrun[0]), LOAD_FRAC(avnrun[0]),\n\t\tLOAD_INT(avnrun[1]), LOAD_FRAC(avnrun[1]),\n\t\tLOAD_INT(avnrun[2]), LOAD_FRAC(avnrun[2]),\n\t\tnr_running(), nr_threads,\n\t\ttask_active_pid_ns(current)->last_pid);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/time.h>",
      "#include <linux/seqlock.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/sched.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%lu.%02lu %lu.%02lu %lu.%02lu %ld/%d %d\\n\"",
            "LOAD_INT(avnrun[0])",
            "LOAD_FRAC(avnrun[0])",
            "LOAD_INT(avnrun[1])",
            "LOAD_FRAC(avnrun[1])",
            "LOAD_INT(avnrun[2])",
            "LOAD_FRAC(avnrun[2])",
            "nr_running()",
            "nr_threads",
            "task_active_pid_ns(current)->last_pid"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_active_pid_ns",
          "args": [
            "current"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nr_running",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD_FRAC",
          "args": [
            "avnrun[2]"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD_INT",
          "args": [
            "avnrun[2]"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD_FRAC",
          "args": [
            "avnrun[1]"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD_INT",
          "args": [
            "avnrun[1]"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD_FRAC",
          "args": [
            "avnrun[0]"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD_INT",
          "args": [
            "avnrun[0]"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_avenrun",
          "args": [
            "avnrun",
            "FIXED_1/200",
            "0"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/time.h>\n#include <linux/seqlock.h>\n#include <linux/seq_file.h>\n#include <linux/sched.h>\n#include <linux/proc_fs.h>\n#include <linux/pid_namespace.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int loadavg_proc_show(struct seq_file *m, void *v)\n{\n\tunsigned long avnrun[3];\n\n\tget_avenrun(avnrun, FIXED_1/200, 0);\n\n\tseq_printf(m, \"%lu.%02lu %lu.%02lu %lu.%02lu %ld/%d %d\\n\",\n\t\tLOAD_INT(avnrun[0]), LOAD_FRAC(avnrun[0]),\n\t\tLOAD_INT(avnrun[1]), LOAD_FRAC(avnrun[1]),\n\t\tLOAD_INT(avnrun[2]), LOAD_FRAC(avnrun[2]),\n\t\tnr_running(), nr_threads,\n\t\ttask_active_pid_ns(current)->last_pid);\n\treturn 0;\n}"
  }
]