[
  {
    "function_name": "nfs4_stat_to_errno",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7333-7351",
    "snippet": "static int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs4_stat_to_errno(int);",
      "static struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\nstatic struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}"
  },
  {
    "function_name": "nfs4_decode_dirent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7225-7287",
    "snippet": "int nfs4_decode_dirent(struct xdr_stream *xdr, struct nfs_entry *entry,\n\t\t       int plus)\n{\n\tunsigned int savep;\n\tuint32_t bitmap[3] = {0};\n\tuint32_t len;\n\t__be32 *p = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (*p == xdr_zero) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (*p == xdr_zero)\n\t\t\treturn -EAGAIN;\n\t\tentry->eof = 1;\n\t\treturn -EBADCOOKIE;\n\t}\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tentry->prev_cookie = entry->cookie;\n\tp = xdr_decode_hyper(p, &entry->cookie);\n\tentry->len = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, entry->len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tentry->name = (const char *) p;\n\n\t/*\n\t * In case the server doesn't return an inode number,\n\t * we fake one here.  (We don't use inode number 0,\n\t * since glibc seems to choke on it...)\n\t */\n\tentry->ino = 1;\n\tentry->fattr->valid = 0;\n\n\tif (decode_attr_bitmap(xdr, bitmap) < 0)\n\t\tgoto out_overflow;\n\n\tif (decode_attr_length(xdr, &len, &savep) < 0)\n\t\tgoto out_overflow;\n\n\tif (decode_getfattr_attrs(xdr, bitmap, entry->fattr, entry->fh,\n\t\t\tNULL, entry->label, entry->server) < 0)\n\t\tgoto out_overflow;\n\tif (entry->fattr->valid & NFS_ATTR_FATTR_MOUNTED_ON_FILEID)\n\t\tentry->ino = entry->fattr->mounted_on_fileid;\n\telse if (entry->fattr->valid & NFS_ATTR_FATTR_FILEID)\n\t\tentry->ino = entry->fattr->fileid;\n\n\tentry->d_type = DT_UNKNOWN;\n\tif (entry->fattr->valid & NFS_ATTR_FATTR_TYPE)\n\t\tentry->d_type = nfs_umode_to_dtype(entry->fattr->mode);\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EAGAIN;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 7285
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_umode_to_dtype",
          "args": [
            "entry->fattr->mode"
          ],
          "line": 7280
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_umode_to_dtype",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "636-640",
          "snippet": "static inline\nunsigned char nfs_umode_to_dtype(umode_t mode)\n{\n\treturn (mode >> 12) & 15;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nfs_create(struct inode *, struct dentry *, umode_t, bool);",
            "int nfs_mkdir(struct inode *, struct dentry *, umode_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nint nfs_create(struct inode *, struct dentry *, umode_t, bool);\nint nfs_mkdir(struct inode *, struct dentry *, umode_t);\n\nstatic inline\nunsigned char nfs_umode_to_dtype(umode_t mode)\n{\n\treturn (mode >> 12) & 15;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfattr_attrs",
          "args": [
            "xdr",
            "bitmap",
            "entry->fattr",
            "entry->fh",
            "NULL",
            "entry->label",
            "entry->server"
          ],
          "line": 7270
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4491-4611",
          "snippet": "static int decode_getfattr_attrs(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tstruct nfs_fattr *fattr, struct nfs_fh *fh,\n\t\tstruct nfs4_fs_locations *fs_loc, struct nfs4_label *label,\n\t\tconst struct nfs_server *server)\n{\n\tint status;\n\tumode_t fmode = 0;\n\tuint32_t type;\n\tint32_t err;\n\n\tstatus = decode_attr_type(xdr, bitmap, &type);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->mode = 0;\n\tif (status != 0) {\n\t\tfattr->mode |= nfs_type2fmt[type];\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_change(xdr, bitmap, &fattr->change_attr);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_size(xdr, bitmap, &fattr->size);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fsid(xdr, bitmap, &fattr->fsid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\terr = 0;\n\tstatus = decode_attr_error(xdr, bitmap, &err);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_filehandle(xdr, bitmap, fh);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_fileid(xdr, bitmap, &fattr->fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fs_locations(xdr, bitmap, fs_loc);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mode(xdr, bitmap, &fmode);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tif (status != 0) {\n\t\tfattr->mode |= fmode;\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_nlink(xdr, bitmap, &fattr->nlink);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_owner(xdr, bitmap, server, &fattr->uid, fattr->owner_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_group(xdr, bitmap, server, &fattr->gid, fattr->group_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_rdev(xdr, bitmap, &fattr->rdev);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_space_used(xdr, bitmap, &fattr->du.nfs3.used);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_access(xdr, bitmap, &fattr->atime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_metadata(xdr, bitmap, &fattr->ctime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_modify(xdr, bitmap, &fattr->mtime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mounted_on_fileid(xdr, bitmap, &fattr->mounted_on_fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mdsthreshold(xdr, bitmap, fattr->mdsthreshold);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tif (label) {\n\t\tstatus = decode_attr_security_label(xdr, bitmap, label);\n\t\tif (status < 0)\n\t\t\tgoto xdr_error;\n\t\tfattr->valid |= status;\n\t}\n\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};\n\nstatic int decode_getfattr_attrs(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tstruct nfs_fattr *fattr, struct nfs_fh *fh,\n\t\tstruct nfs4_fs_locations *fs_loc, struct nfs4_label *label,\n\t\tconst struct nfs_server *server)\n{\n\tint status;\n\tumode_t fmode = 0;\n\tuint32_t type;\n\tint32_t err;\n\n\tstatus = decode_attr_type(xdr, bitmap, &type);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->mode = 0;\n\tif (status != 0) {\n\t\tfattr->mode |= nfs_type2fmt[type];\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_change(xdr, bitmap, &fattr->change_attr);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_size(xdr, bitmap, &fattr->size);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fsid(xdr, bitmap, &fattr->fsid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\terr = 0;\n\tstatus = decode_attr_error(xdr, bitmap, &err);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_filehandle(xdr, bitmap, fh);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_fileid(xdr, bitmap, &fattr->fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fs_locations(xdr, bitmap, fs_loc);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mode(xdr, bitmap, &fmode);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tif (status != 0) {\n\t\tfattr->mode |= fmode;\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_nlink(xdr, bitmap, &fattr->nlink);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_owner(xdr, bitmap, server, &fattr->uid, fattr->owner_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_group(xdr, bitmap, server, &fattr->gid, fattr->group_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_rdev(xdr, bitmap, &fattr->rdev);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_space_used(xdr, bitmap, &fattr->du.nfs3.used);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_access(xdr, bitmap, &fattr->atime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_metadata(xdr, bitmap, &fattr->ctime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_modify(xdr, bitmap, &fattr->mtime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mounted_on_fileid(xdr, bitmap, &fattr->mounted_on_fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mdsthreshold(xdr, bitmap, fattr->mdsthreshold);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tif (label) {\n\t\tstatus = decode_attr_security_label(xdr, bitmap, label);\n\t\tif (status < 0)\n\t\t\tgoto xdr_error;\n\t\tfattr->valid |= status;\n\t}\n\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&len",
            "&savep"
          ],
          "line": 7267
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 7264
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 7252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "entry->len"
          ],
          "line": 7251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 7249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&entry->cookie"
          ],
          "line": 7248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 7245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "12"
          ],
          "line": 7244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 7236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 7235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 7232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 7231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nint nfs4_decode_dirent(struct xdr_stream *xdr, struct nfs_entry *entry,\n\t\t       int plus)\n{\n\tunsigned int savep;\n\tuint32_t bitmap[3] = {0};\n\tuint32_t len;\n\t__be32 *p = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (*p == xdr_zero) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (*p == xdr_zero)\n\t\t\treturn -EAGAIN;\n\t\tentry->eof = 1;\n\t\treturn -EBADCOOKIE;\n\t}\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tentry->prev_cookie = entry->cookie;\n\tp = xdr_decode_hyper(p, &entry->cookie);\n\tentry->len = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, entry->len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tentry->name = (const char *) p;\n\n\t/*\n\t * In case the server doesn't return an inode number,\n\t * we fake one here.  (We don't use inode number 0,\n\t * since glibc seems to choke on it...)\n\t */\n\tentry->ino = 1;\n\tentry->fattr->valid = 0;\n\n\tif (decode_attr_bitmap(xdr, bitmap) < 0)\n\t\tgoto out_overflow;\n\n\tif (decode_attr_length(xdr, &len, &savep) < 0)\n\t\tgoto out_overflow;\n\n\tif (decode_getfattr_attrs(xdr, bitmap, entry->fattr, entry->fh,\n\t\t\tNULL, entry->label, entry->server) < 0)\n\t\tgoto out_overflow;\n\tif (entry->fattr->valid & NFS_ATTR_FATTR_MOUNTED_ON_FILEID)\n\t\tentry->ino = entry->fattr->mounted_on_fileid;\n\telse if (entry->fattr->valid & NFS_ATTR_FATTR_FILEID)\n\t\tentry->ino = entry->fattr->fileid;\n\n\tentry->d_type = DT_UNKNOWN;\n\tif (entry->fattr->valid & NFS_ATTR_FATTR_TYPE)\n\t\tentry->d_type = nfs_umode_to_dtype(entry->fattr->mode);\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EAGAIN;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_free_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7192-7208",
    "snippet": "static int nfs4_xdr_dec_free_stateid(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_free_stateid_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_free_stateid(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_free_stateid",
          "args": [
            "xdr",
            "res"
          ],
          "line": 7205
        },
        "resolved": true,
        "details": {
          "function_name": "decode_free_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5973-5978",
          "snippet": "static int decode_free_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_free_stateid_res *res)\n{\n\tres->status = decode_op_hdr(xdr, OP_FREE_STATEID);\n\treturn res->status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_free_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_free_stateid_res *res)\n{\n\tres->status = decode_op_hdr(xdr, OP_FREE_STATEID);\n\treturn res->status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7202
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7199
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_free_stateid(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_free_stateid_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_free_stateid(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_test_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7171-7187",
    "snippet": "static int nfs4_xdr_dec_test_stateid(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_test_stateid_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_test_stateid(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_test_stateid",
          "args": [
            "xdr",
            "res"
          ],
          "line": 7184
        },
        "resolved": true,
        "details": {
          "function_name": "decode_test_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5943-5971",
          "snippet": "static int decode_test_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_test_stateid_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tint num_res;\n\n\tstatus = decode_op_hdr(xdr, OP_TEST_STATEID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum_res = be32_to_cpup(p++);\n\tif (num_res != 1)\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->status = be32_to_cpup(p++);\n\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout:\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_test_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_test_stateid_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tint num_res;\n\n\tstatus = decode_op_hdr(xdr, OP_TEST_STATEID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum_res = be32_to_cpup(p++);\n\tif (num_res != 1)\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->status = be32_to_cpup(p++);\n\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout:\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7181
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7178
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_test_stateid(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_test_stateid_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_test_stateid(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_secinfo_no_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7147-7166",
    "snippet": "static int nfs4_xdr_dec_secinfo_no_name(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_secinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putrootfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_secinfo_no_name(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_secinfo_no_name",
          "args": [
            "xdr",
            "res"
          ],
          "line": 7163
        },
        "resolved": true,
        "details": {
          "function_name": "decode_secinfo_no_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5442-5448",
          "snippet": "static int decode_secinfo_no_name(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO_NO_NAME);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_no_name(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO_NO_NAME);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putrootfh",
          "args": [
            "xdr"
          ],
          "line": 7160
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putrootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5074-5077",
          "snippet": "static int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7157
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7154
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_secinfo_no_name(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_secinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putrootfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_secinfo_no_name(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_layoutcommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7120-7142",
    "snippet": "static int nfs4_xdr_dec_layoutcommit(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_layoutcommit_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_layoutcommit(xdr, rqstp, res);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->fattr",
            "res->server"
          ],
          "line": 7139
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_layoutcommit",
          "args": [
            "xdr",
            "rqstp",
            "res"
          ],
          "line": 7136
        },
        "resolved": true,
        "details": {
          "function_name": "decode_layoutcommit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5913-5941",
          "snippet": "static int decode_layoutcommit(struct xdr_stream *xdr,\n\t\t\t       struct rpc_rqst *req,\n\t\t\t       struct nfs4_layoutcommit_res *res)\n{\n\t__be32 *p;\n\t__u32 sizechanged;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTCOMMIT);\n\tres->status = status;\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsizechanged = be32_to_cpup(p);\n\n\tif (sizechanged) {\n\t\t/* throw away new size */\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_layoutcommit(struct xdr_stream *xdr,\n\t\t\t       struct rpc_rqst *req,\n\t\t\t       struct nfs4_layoutcommit_res *res)\n{\n\t__be32 *p;\n\t__u32 sizechanged;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTCOMMIT);\n\tres->status = status;\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsizechanged = be32_to_cpup(p);\n\n\tif (sizechanged) {\n\t\t/* throw away new size */\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 7133
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7130
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7127
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_layoutcommit(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_layoutcommit_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_layoutcommit(xdr, rqstp, res);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_layoutreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7096-7115",
    "snippet": "static int nfs4_xdr_dec_layoutreturn(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_layoutreturn_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_layoutreturn(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_layoutreturn",
          "args": [
            "xdr",
            "res"
          ],
          "line": 7112
        },
        "resolved": true,
        "details": {
          "function_name": "decode_layoutreturn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5892-5911",
          "snippet": "static int decode_layoutreturn(struct xdr_stream *xdr,\n\t\t\t       struct nfs4_layoutreturn_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTRETURN);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->lrs_present = be32_to_cpup(p);\n\tif (res->lrs_present)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_layoutreturn(struct xdr_stream *xdr,\n\t\t\t       struct nfs4_layoutreturn_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTRETURN);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->lrs_present = be32_to_cpup(p);\n\tif (res->lrs_present)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 7109
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7106
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7103
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_layoutreturn(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_layoutreturn_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_layoutreturn(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_layoutget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7072-7091",
    "snippet": "static int nfs4_xdr_dec_layoutget(struct rpc_rqst *rqstp,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  struct nfs4_layoutget_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_layoutget(xdr, rqstp, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_layoutget",
          "args": [
            "xdr",
            "rqstp",
            "res"
          ],
          "line": 7088
        },
        "resolved": true,
        "details": {
          "function_name": "decode_layoutget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5825-5890",
          "snippet": "static int decode_layoutget(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t    struct nfs4_layoutget_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tu32 layout_count;\n\tu32 recvd;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTGET);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->return_on_close = be32_to_cpup(p);\n\tdecode_stateid(xdr, &res->stateid);\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlayout_count = be32_to_cpup(p);\n\tif (!layout_count) {\n\t\tdprintk(\"%s: server responded with empty layout array\\n\",\n\t\t\t__func__);\n\t\treturn -EINVAL;\n\t}\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->range.offset);\n\tp = xdr_decode_hyper(p, &res->range.length);\n\tres->range.iomode = be32_to_cpup(p++);\n\tres->type = be32_to_cpup(p++);\n\tres->layoutp->len = be32_to_cpup(p);\n\n\tdprintk(\"%s roff:%lu rlen:%lu riomode:%d, lo_type:0x%x, lo.len:%d\\n\",\n\t\t__func__,\n\t\t(unsigned long)res->range.offset,\n\t\t(unsigned long)res->range.length,\n\t\tres->range.iomode,\n\t\tres->type,\n\t\tres->layoutp->len);\n\n\trecvd = xdr_read_pages(xdr, res->layoutp->len);\n\tif (res->layoutp->len > recvd) {\n\t\tdprintk(\"NFS: server cheating in layoutget reply: \"\n\t\t\t\t\"layout len %u > recvd %u\\n\",\n\t\t\t\tres->layoutp->len, recvd);\n\t\treturn -EINVAL;\n\t}\n\n\tif (layout_count > 1) {\n\t\t/* We only handle a length one array at the moment.  Any\n\t\t * further entries are just ignored.  Note that this means\n\t\t * the client may see a response that is less than the\n\t\t * minimum it requested.\n\t\t */\n\t\tdprintk(\"%s: server responded with %d layouts, dropping tail\\n\",\n\t\t\t__func__, layout_count);\n\t}\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_layoutget(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t    struct nfs4_layoutget_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tu32 layout_count;\n\tu32 recvd;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTGET);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->return_on_close = be32_to_cpup(p);\n\tdecode_stateid(xdr, &res->stateid);\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlayout_count = be32_to_cpup(p);\n\tif (!layout_count) {\n\t\tdprintk(\"%s: server responded with empty layout array\\n\",\n\t\t\t__func__);\n\t\treturn -EINVAL;\n\t}\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->range.offset);\n\tp = xdr_decode_hyper(p, &res->range.length);\n\tres->range.iomode = be32_to_cpup(p++);\n\tres->type = be32_to_cpup(p++);\n\tres->layoutp->len = be32_to_cpup(p);\n\n\tdprintk(\"%s roff:%lu rlen:%lu riomode:%d, lo_type:0x%x, lo.len:%d\\n\",\n\t\t__func__,\n\t\t(unsigned long)res->range.offset,\n\t\t(unsigned long)res->range.length,\n\t\tres->range.iomode,\n\t\tres->type,\n\t\tres->layoutp->len);\n\n\trecvd = xdr_read_pages(xdr, res->layoutp->len);\n\tif (res->layoutp->len > recvd) {\n\t\tdprintk(\"NFS: server cheating in layoutget reply: \"\n\t\t\t\t\"layout len %u > recvd %u\\n\",\n\t\t\t\tres->layoutp->len, recvd);\n\t\treturn -EINVAL;\n\t}\n\n\tif (layout_count > 1) {\n\t\t/* We only handle a length one array at the moment.  Any\n\t\t * further entries are just ignored.  Note that this means\n\t\t * the client may see a response that is less than the\n\t\t * minimum it requested.\n\t\t */\n\t\tdprintk(\"%s: server responded with %d layouts, dropping tail\\n\",\n\t\t\t__func__, layout_count);\n\t}\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 7085
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7082
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7079
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_layoutget(struct rpc_rqst *rqstp,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  struct nfs4_layoutget_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_layoutget(xdr, rqstp, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_getdeviceinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7051-7067",
    "snippet": "static int nfs4_xdr_dec_getdeviceinfo(struct rpc_rqst *rqstp,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_getdeviceinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_getdeviceinfo(xdr, res->pdev);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getdeviceinfo",
          "args": [
            "xdr",
            "res->pdev"
          ],
          "line": 7064
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getdeviceinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5755-5823",
          "snippet": "static int decode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t\t\tstruct pnfs_device *pdev)\n{\n\t__be32 *p;\n\tuint32_t len, type;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETDEVICEINFO);\n\tif (status) {\n\t\tif (status == -ETOOSMALL) {\n\t\t\tp = xdr_inline_decode(xdr, 4);\n\t\t\tif (unlikely(!p))\n\t\t\t\tgoto out_overflow;\n\t\t\tpdev->mincount = be32_to_cpup(p);\n\t\t\tdprintk(\"%s: Min count too small. mincnt = %u\\n\",\n\t\t\t\t__func__, pdev->mincount);\n\t\t}\n\t\treturn status;\n\t}\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\ttype = be32_to_cpup(p++);\n\tif (type != pdev->layout_type) {\n\t\tdprintk(\"%s: layout mismatch req: %u pdev: %u\\n\",\n\t\t\t__func__, pdev->layout_type, type);\n\t\treturn -EINVAL;\n\t}\n\t/*\n\t * Get the length of the opaque device_addr4. xdr_read_pages places\n\t * the opaque device_addr4 in the xdr_buf->pages (pnfs_device->pages)\n\t * and places the remaining xdr data in xdr_buf->tail\n\t */\n\tpdev->mincount = be32_to_cpup(p);\n\tif (xdr_read_pages(xdr, pdev->mincount) != pdev->mincount)\n\t\tgoto out_overflow;\n\n\t/* Parse notification bitmap, verifying that it is zero. */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len) {\n\t\tuint32_t i;\n\n\t\tp = xdr_inline_decode(xdr, 4 * len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\tif (be32_to_cpup(p++) &\n\t\t    ~(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE)) {\n\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t__func__);\n\t\t}\n\n\t\tfor (i = 1; i < len; i++) {\n\t\t\tif (be32_to_cpup(p++)) {\n\t\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t\t__func__);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t\t\tstruct pnfs_device *pdev)\n{\n\t__be32 *p;\n\tuint32_t len, type;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETDEVICEINFO);\n\tif (status) {\n\t\tif (status == -ETOOSMALL) {\n\t\t\tp = xdr_inline_decode(xdr, 4);\n\t\t\tif (unlikely(!p))\n\t\t\t\tgoto out_overflow;\n\t\t\tpdev->mincount = be32_to_cpup(p);\n\t\t\tdprintk(\"%s: Min count too small. mincnt = %u\\n\",\n\t\t\t\t__func__, pdev->mincount);\n\t\t}\n\t\treturn status;\n\t}\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\ttype = be32_to_cpup(p++);\n\tif (type != pdev->layout_type) {\n\t\tdprintk(\"%s: layout mismatch req: %u pdev: %u\\n\",\n\t\t\t__func__, pdev->layout_type, type);\n\t\treturn -EINVAL;\n\t}\n\t/*\n\t * Get the length of the opaque device_addr4. xdr_read_pages places\n\t * the opaque device_addr4 in the xdr_buf->pages (pnfs_device->pages)\n\t * and places the remaining xdr data in xdr_buf->tail\n\t */\n\tpdev->mincount = be32_to_cpup(p);\n\tif (xdr_read_pages(xdr, pdev->mincount) != pdev->mincount)\n\t\tgoto out_overflow;\n\n\t/* Parse notification bitmap, verifying that it is zero. */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len) {\n\t\tuint32_t i;\n\n\t\tp = xdr_inline_decode(xdr, 4 * len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\tif (be32_to_cpup(p++) &\n\t\t    ~(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE)) {\n\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t__func__);\n\t\t}\n\n\t\tfor (i = 1; i < len; i++) {\n\t\t\tif (be32_to_cpup(p++)) {\n\t\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t\t__func__);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7061
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7058
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_getdeviceinfo(struct rpc_rqst *rqstp,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_getdeviceinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_getdeviceinfo(xdr, res->pdev);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_reclaim_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7033-7046",
    "snippet": "static int nfs4_xdr_dec_reclaim_complete(struct rpc_rqst *rqstp,\n\t\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t\t struct nfs41_reclaim_complete_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (!status)\n\t\tstatus = decode_reclaim_complete(xdr, NULL);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_reclaim_complete",
          "args": [
            "xdr",
            "NULL"
          ],
          "line": 7044
        },
        "resolved": true,
        "details": {
          "function_name": "decode_reclaim_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5678-5681",
          "snippet": "static int decode_reclaim_complete(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_RECLAIM_COMPLETE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_reclaim_complete(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_RECLAIM_COMPLETE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 7042
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7040
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_reclaim_complete(struct rpc_rqst *rqstp,\n\t\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t\t struct nfs41_reclaim_complete_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (!status)\n\t\tstatus = decode_reclaim_complete(xdr, NULL);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_get_lease_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "7013-7028",
    "snippet": "static int nfs4_xdr_dec_get_lease_time(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs4_get_lease_time_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->lr_seq_res, rqstp);\n\tif (!status)\n\t\tstatus = decode_putrootfh(xdr);\n\tif (!status)\n\t\tstatus = decode_fsinfo(xdr, res->lr_fsinfo);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_fsinfo",
          "args": [
            "xdr",
            "res->lr_fsinfo"
          ],
          "line": 7026
        },
        "resolved": true,
        "details": {
          "function_name": "decode_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4734-4773",
          "snippet": "static int decode_fsinfo(struct xdr_stream *xdr, struct nfs_fsinfo *fsinfo)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3];\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tfsinfo->rtmult = fsinfo->wtmult = 512;\t/* ??? */\n\n\tif ((status = decode_attr_lease_time(xdr, bitmap, &fsinfo->lease_time)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxfilesize(xdr, bitmap, &fsinfo->maxfilesize)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxread(xdr, bitmap, &fsinfo->rtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->rtpref = fsinfo->dtpref = fsinfo->rtmax;\n\tif ((status = decode_attr_maxwrite(xdr, bitmap, &fsinfo->wtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->wtpref = fsinfo->wtmax;\n\tstatus = decode_attr_time_delta(xdr, bitmap, &fsinfo->time_delta);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_pnfstype(xdr, bitmap, &fsinfo->layouttype);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_layout_blksize(xdr, bitmap, &fsinfo->blksize);\n\tif (status)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_fsinfo(struct xdr_stream *xdr, struct nfs_fsinfo *fsinfo)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3];\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tfsinfo->rtmult = fsinfo->wtmult = 512;\t/* ??? */\n\n\tif ((status = decode_attr_lease_time(xdr, bitmap, &fsinfo->lease_time)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxfilesize(xdr, bitmap, &fsinfo->maxfilesize)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxread(xdr, bitmap, &fsinfo->rtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->rtpref = fsinfo->dtpref = fsinfo->rtmax;\n\tif ((status = decode_attr_maxwrite(xdr, bitmap, &fsinfo->wtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->wtpref = fsinfo->wtmax;\n\tstatus = decode_attr_time_delta(xdr, bitmap, &fsinfo->time_delta);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_pnfstype(xdr, bitmap, &fsinfo->layouttype);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_layout_blksize(xdr, bitmap, &fsinfo->blksize);\n\tif (status)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putrootfh",
          "args": [
            "xdr"
          ],
          "line": 7024
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putrootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5074-5077",
          "snippet": "static int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->lr_seq_res",
            "rqstp"
          ],
          "line": 7022
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7020
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_get_lease_time(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs4_get_lease_time_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->lr_seq_res, rqstp);\n\tif (!status)\n\t\tstatus = decode_putrootfh(xdr);\n\tif (!status)\n\t\tstatus = decode_fsinfo(xdr, res->lr_fsinfo);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6997-7008",
    "snippet": "static int nfs4_xdr_dec_sequence(struct rpc_rqst *rqstp,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t struct nfs4_sequence_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, res, rqstp);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "res",
            "rqstp"
          ],
          "line": 7006
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 7004
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_sequence(struct rpc_rqst *rqstp,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t struct nfs4_sequence_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, res, rqstp);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_destroy_clientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6981-6992",
    "snippet": "static int nfs4_xdr_dec_destroy_clientid(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tvoid *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_destroy_clientid(xdr, res);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_destroy_clientid",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6990
        },
        "resolved": true,
        "details": {
          "function_name": "decode_destroy_clientid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5673-5676",
          "snippet": "static int decode_destroy_clientid(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_CLIENTID);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_destroy_clientid(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_CLIENTID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6988
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_destroy_clientid(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tvoid *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_destroy_clientid(xdr, res);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_destroy_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6965-6976",
    "snippet": "static int nfs4_xdr_dec_destroy_session(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tvoid *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_destroy_session(xdr, res);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_destroy_session",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6974
        },
        "resolved": true,
        "details": {
          "function_name": "decode_destroy_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5668-5671",
          "snippet": "static int decode_destroy_session(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_SESSION);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_destroy_session(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_SESSION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6972
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_destroy_session(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tvoid *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_destroy_session(xdr, res);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_create_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6949-6960",
    "snippet": "static int nfs4_xdr_dec_create_session(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs41_create_session_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_create_session(xdr, res);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_create_session",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6958
        },
        "resolved": true,
        "details": {
          "function_name": "decode_create_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5639-5666",
          "snippet": "static int decode_create_session(struct xdr_stream *xdr,\n\t\t\t\t struct nfs41_create_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* seqid, flags */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p);\n\n\t/* Channel attributes */\n\tstatus = decode_chan_attrs(xdr, &res->fc_attrs);\n\tif (!status)\n\t\tstatus = decode_chan_attrs(xdr, &res->bc_attrs);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_create_session(struct xdr_stream *xdr,\n\t\t\t\t struct nfs41_create_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* seqid, flags */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p);\n\n\t/* Channel attributes */\n\tstatus = decode_chan_attrs(xdr, &res->fc_attrs);\n\tif (!status)\n\t\tstatus = decode_chan_attrs(xdr, &res->bc_attrs);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6956
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_create_session(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs41_create_session_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_create_session(xdr, res);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_exchange_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6933-6944",
    "snippet": "static int nfs4_xdr_dec_exchange_id(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    void *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_exchange_id(xdr, res);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_exchange_id",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6942
        },
        "resolved": true,
        "details": {
          "function_name": "decode_exchange_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5467-5567",
          "snippet": "static int decode_exchange_id(struct xdr_stream *xdr,\n\t\t\t      struct nfs41_exchange_id_res *res)\n{\n\t__be32 *p;\n\tuint32_t dummy;\n\tchar *dummy_str;\n\tint status;\n\tuint32_t impl_id_count;\n\n\tstatus = decode_op_hdr(xdr, OP_EXCHANGE_ID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\txdr_decode_hyper(p, &res->clientid);\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p++);\n\n\tres->state_protect.how = be32_to_cpup(p);\n\tswitch (res->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tstatus = decode_op_map(xdr, &res->state_protect.enforce);\n\t\tif (status)\n\t\t\treturn status;\n\t\tstatus = decode_op_map(xdr, &res->state_protect.allow);\n\t\tif (status)\n\t\t\treturn status;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\treturn -EIO;\n\t}\n\n\t/* server_owner4.so_minor_id */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->server_owner->minor_id);\n\n\t/* server_owner4.so_major_id */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_owner->major_id, dummy_str, dummy);\n\tres->server_owner->major_id_sz = dummy;\n\n\t/* server_scope4 */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_scope->server_scope, dummy_str, dummy);\n\tres->server_scope->server_scope_sz = dummy;\n\n\t/* Implementation Id */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\timpl_id_count = be32_to_cpup(p++);\n\n\tif (impl_id_count) {\n\t\t/* nii_domain */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->domain, dummy_str, dummy);\n\n\t\t/* nii_name */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->name, dummy_str, dummy);\n\n\t\t/* nii_date */\n\t\tp = xdr_inline_decode(xdr, 12);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->impl_id->date.seconds);\n\t\tres->impl_id->date.nseconds = be32_to_cpup(p);\n\n\t\t/* if there's more than one entry, ignore the rest */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_exchange_id(struct xdr_stream *xdr,\n\t\t\t      struct nfs41_exchange_id_res *res)\n{\n\t__be32 *p;\n\tuint32_t dummy;\n\tchar *dummy_str;\n\tint status;\n\tuint32_t impl_id_count;\n\n\tstatus = decode_op_hdr(xdr, OP_EXCHANGE_ID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\txdr_decode_hyper(p, &res->clientid);\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p++);\n\n\tres->state_protect.how = be32_to_cpup(p);\n\tswitch (res->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tstatus = decode_op_map(xdr, &res->state_protect.enforce);\n\t\tif (status)\n\t\t\treturn status;\n\t\tstatus = decode_op_map(xdr, &res->state_protect.allow);\n\t\tif (status)\n\t\t\treturn status;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\treturn -EIO;\n\t}\n\n\t/* server_owner4.so_minor_id */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->server_owner->minor_id);\n\n\t/* server_owner4.so_major_id */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_owner->major_id, dummy_str, dummy);\n\tres->server_owner->major_id_sz = dummy;\n\n\t/* server_scope4 */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_scope->server_scope, dummy_str, dummy);\n\tres->server_scope->server_scope_sz = dummy;\n\n\t/* Implementation Id */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\timpl_id_count = be32_to_cpup(p++);\n\n\tif (impl_id_count) {\n\t\t/* nii_domain */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->domain, dummy_str, dummy);\n\n\t\t/* nii_name */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->name, dummy_str, dummy);\n\n\t\t/* nii_date */\n\t\tp = xdr_inline_decode(xdr, 12);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->impl_id->date.seconds);\n\t\tres->impl_id->date.nseconds = be32_to_cpup(p);\n\n\t\t/* if there's more than one entry, ignore the rest */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6940
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_exchange_id(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    void *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_exchange_id(xdr, res);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_bind_conn_to_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6917-6928",
    "snippet": "static int nfs4_xdr_dec_bind_conn_to_session(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tvoid *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_bind_conn_to_session(xdr, res);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_bind_conn_to_session",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6926
        },
        "resolved": true,
        "details": {
          "function_name": "decode_bind_conn_to_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5608-5637",
          "snippet": "static int decode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_bind_conn_to_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* dir flags, rdma mode bool */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->dir = be32_to_cpup(p++);\n\tif (res->dir == 0 || res->dir > NFS4_CDFS4_BOTH)\n\t\treturn -EIO;\n\tif (be32_to_cpup(p) == 0)\n\t\tres->use_conn_in_rdma_mode = false;\n\telse\n\t\tres->use_conn_in_rdma_mode = true;\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_bind_conn_to_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* dir flags, rdma mode bool */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->dir = be32_to_cpup(p++);\n\tif (res->dir == 0 || res->dir > NFS4_CDFS4_BOTH)\n\t\treturn -EIO;\n\tif (be32_to_cpup(p) == 0)\n\t\tres->use_conn_in_rdma_mode = false;\n\telse\n\t\tres->use_conn_in_rdma_mode = true;\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6924
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_bind_conn_to_session(struct rpc_rqst *rqstp,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tvoid *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_bind_conn_to_session(xdr, res);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_fsid_present",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6888-6911",
    "snippet": "static int nfs4_xdr_dec_fsid_present(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_fsid_present_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status)\n\t\tgoto out;\n\tif (res->renew)\n\t\tstatus = decode_renew(xdr);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_renew",
          "args": [
            "xdr"
          ],
          "line": 6908
        },
        "resolved": true,
        "details": {
          "function_name": "decode_renew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5192-5195",
          "snippet": "static int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfh",
          "args": [
            "xdr",
            "res->fh"
          ],
          "line": 6904
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4775-4803",
          "snippet": "static int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6901
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6898
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6895
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_fsid_present(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_fsid_present_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status)\n\t\tgoto out;\n\tif (res->renew)\n\t\tstatus = decode_renew(xdr);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_secinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6864-6883",
    "snippet": "static int nfs4_xdr_dec_secinfo(struct rpc_rqst *rqstp,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_secinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_secinfo(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_secinfo",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6880
        },
        "resolved": true,
        "details": {
          "function_name": "decode_secinfo_no_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5442-5448",
          "snippet": "static int decode_secinfo_no_name(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO_NO_NAME);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_no_name(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO_NO_NAME);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6877
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6874
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6871
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_secinfo(struct rpc_rqst *rqstp,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_secinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_secinfo(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_fs_locations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6821-6859",
    "snippet": "static int nfs4_xdr_dec_fs_locations(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_fs_locations_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tif (res->migration) {\n\t\txdr_enter_page(xdr, PAGE_SIZE);\n\t\tstatus = decode_getfattr_generic(xdr,\n\t\t\t\t\t&res->fs_locations->fattr,\n\t\t\t\t\t NULL, res->fs_locations,\n\t\t\t\t\t NULL, res->fs_locations->server);\n\t\tif (status)\n\t\t\tgoto out;\n\t\tif (res->renew)\n\t\t\tstatus = decode_renew(xdr);\n\t} else {\n\t\tstatus = decode_lookup(xdr);\n\t\tif (status)\n\t\t\tgoto out;\n\t\txdr_enter_page(xdr, PAGE_SIZE);\n\t\tstatus = decode_getfattr_generic(xdr,\n\t\t\t\t\t&res->fs_locations->fattr,\n\t\t\t\t\t NULL, res->fs_locations,\n\t\t\t\t\t NULL, res->fs_locations->server);\n\t}\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_generic",
          "args": [
            "xdr",
            "&res->fs_locations->fattr",
            "NULL",
            "res->fs_locations",
            "NULL",
            "res->fs_locations->server"
          ],
          "line": 6852
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_generic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4613-4643",
          "snippet": "static int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_enter_page",
          "args": [
            "xdr",
            "PAGE_SIZE"
          ],
          "line": 6851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_lookup",
          "args": [
            "xdr"
          ],
          "line": 6848
        },
        "resolved": true,
        "details": {
          "function_name": "decode_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4896-4899",
          "snippet": "static int decode_lookup(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_LOOKUP);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lookup(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_LOOKUP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_renew",
          "args": [
            "xdr"
          ],
          "line": 6846
        },
        "resolved": true,
        "details": {
          "function_name": "decode_renew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5192-5195",
          "snippet": "static int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_enter_page",
          "args": [
            "xdr",
            "PAGE_SIZE"
          ],
          "line": 6838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6834
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "req"
          ],
          "line": 6831
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6828
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_fs_locations(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_fs_locations_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tif (res->migration) {\n\t\txdr_enter_page(xdr, PAGE_SIZE);\n\t\tstatus = decode_getfattr_generic(xdr,\n\t\t\t\t\t&res->fs_locations->fattr,\n\t\t\t\t\t NULL, res->fs_locations,\n\t\t\t\t\t NULL, res->fs_locations->server);\n\t\tif (status)\n\t\t\tgoto out;\n\t\tif (res->renew)\n\t\t\tstatus = decode_renew(xdr);\n\t} else {\n\t\tstatus = decode_lookup(xdr);\n\t\tif (status)\n\t\t\tgoto out;\n\t\txdr_enter_page(xdr, PAGE_SIZE);\n\t\tstatus = decode_getfattr_generic(xdr,\n\t\t\t\t\t&res->fs_locations->fattr,\n\t\t\t\t\t NULL, res->fs_locations,\n\t\t\t\t\t NULL, res->fs_locations->server);\n\t}\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_delegreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6794-6816",
    "snippet": "static int nfs4_xdr_dec_delegreturn(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_delegreturnres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_getfattr(xdr, res->fattr, res->server);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_delegreturn(xdr);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_delegreturn",
          "args": [
            "xdr"
          ],
          "line": 6813
        },
        "resolved": true,
        "details": {
          "function_name": "decode_delegreturn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5354-5357",
          "snippet": "static int decode_delegreturn(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_DELEGRETURN);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_delegreturn(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_DELEGRETURN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->fattr",
            "res->server"
          ],
          "line": 6810
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6807
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6804
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6801
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_delegreturn(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_delegreturnres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_getfattr(xdr, res->fattr, res->server);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_delegreturn(xdr);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_setclientid_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6779-6789",
    "snippet": "static int nfs4_xdr_dec_setclientid_confirm(struct rpc_rqst *req,\n\t\t\t\t\t    struct xdr_stream *xdr)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_setclientid_confirm(xdr);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_setclientid_confirm",
          "args": [
            "xdr"
          ],
          "line": 6787
        },
        "resolved": true,
        "details": {
          "function_name": "decode_setclientid_confirm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5329-5332",
          "snippet": "static int decode_setclientid_confirm(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_setclientid_confirm(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6785
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_setclientid_confirm(struct rpc_rqst *req,\n\t\t\t\t\t    struct xdr_stream *xdr)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_setclientid_confirm(xdr);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_setclientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6763-6774",
    "snippet": "static int nfs4_xdr_dec_setclientid(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_setclientid_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_setclientid(xdr, res);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_setclientid",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6772
        },
        "resolved": true,
        "details": {
          "function_name": "decode_setclientid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5277-5327",
          "snippet": "static int decode_setclientid(struct xdr_stream *xdr, struct nfs4_setclientid_res *res)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (opnum != OP_SETCLIENTID) {\n\t\tdprintk(\"nfs: decode_setclientid: Server returned operation\"\n\t\t\t\" %d\\n\", opnum);\n\t\treturn -EIO;\n\t}\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK) {\n\t\tp = xdr_inline_decode(xdr, 8 + NFS4_VERIFIER_SIZE);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->clientid);\n\t\tmemcpy(res->confirm.data, p, NFS4_VERIFIER_SIZE);\n\t} else if (nfserr == NFSERR_CLID_INUSE) {\n\t\tuint32_t len;\n\n\t\t/* skip netid string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\t/* skip uaddr string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\treturn -NFSERR_CLID_INUSE;\n\t} else\n\t\treturn nfs4_stat_to_errno(nfserr);\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_setclientid(struct xdr_stream *xdr, struct nfs4_setclientid_res *res)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (opnum != OP_SETCLIENTID) {\n\t\tdprintk(\"nfs: decode_setclientid: Server returned operation\"\n\t\t\t\" %d\\n\", opnum);\n\t\treturn -EIO;\n\t}\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK) {\n\t\tp = xdr_inline_decode(xdr, 8 + NFS4_VERIFIER_SIZE);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->clientid);\n\t\tmemcpy(res->confirm.data, p, NFS4_VERIFIER_SIZE);\n\t} else if (nfserr == NFSERR_CLID_INUSE) {\n\t\tuint32_t len;\n\n\t\t/* skip netid string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\t/* skip uaddr string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\treturn -NFSERR_CLID_INUSE;\n\t} else\n\t\treturn nfs4_stat_to_errno(nfserr);\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6770
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_setclientid(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_setclientid_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_setclientid(xdr, res);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_renew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6748-6758",
    "snippet": "static int nfs4_xdr_dec_renew(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      void *__unused)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_renew(xdr);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_renew",
          "args": [
            "xdr"
          ],
          "line": 6756
        },
        "resolved": true,
        "details": {
          "function_name": "decode_renew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5192-5195",
          "snippet": "static int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6754
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_renew(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      void *__unused)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_renew(xdr);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_server_caps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6724-6743",
    "snippet": "static int nfs4_xdr_dec_server_caps(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_server_caps_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_server_caps(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_server_caps",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6740
        },
        "resolved": true,
        "details": {
          "function_name": "decode_server_caps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4297-4324",
          "snippet": "static int decode_server_caps(struct xdr_stream *xdr, struct nfs4_server_caps_res *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_supported(xdr, bitmap, res->attr_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_fh_expire_type(xdr, bitmap,\n\t\t\t\t\t\t &res->fh_expire_type)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_link_support(xdr, bitmap, &res->has_links)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_symlink_support(xdr, bitmap, &res->has_symlinks)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_aclsupport(xdr, bitmap, &res->acl_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_server_caps(struct xdr_stream *xdr, struct nfs4_server_caps_res *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_supported(xdr, bitmap, res->attr_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_fh_expire_type(xdr, bitmap,\n\t\t\t\t\t\t &res->fh_expire_type)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_link_support(xdr, bitmap, &res->has_links)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_symlink_support(xdr, bitmap, &res->has_symlinks)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_aclsupport(xdr, bitmap, &res->acl_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6737
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "req"
          ],
          "line": 6734
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6731
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_server_caps(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_server_caps_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_server_caps(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6705-6719",
    "snippet": "static int nfs4_xdr_dec_statfs(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_statfs_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (!status)\n\t\tstatus = decode_putfh(xdr);\n\tif (!status)\n\t\tstatus = decode_statfs(xdr, res->fsstat);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_statfs",
          "args": [
            "xdr",
            "res->fsstat"
          ],
          "line": 6717
        },
        "resolved": true,
        "details": {
          "function_name": "decode_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4326-4356",
          "snippet": "static int decode_statfs(struct xdr_stream *xdr, struct nfs_fsstat *fsstat)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_files_avail(xdr, bitmap, &fsstat->afiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_free(xdr, bitmap, &fsstat->ffiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_total(xdr, bitmap, &fsstat->tfiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_avail(xdr, bitmap, &fsstat->abytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_free(xdr, bitmap, &fsstat->fbytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_total(xdr, bitmap, &fsstat->tbytes)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_statfs(struct xdr_stream *xdr, struct nfs_fsstat *fsstat)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_files_avail(xdr, bitmap, &fsstat->afiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_free(xdr, bitmap, &fsstat->ffiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_total(xdr, bitmap, &fsstat->tfiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_avail(xdr, bitmap, &fsstat->abytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_free(xdr, bitmap, &fsstat->fbytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_total(xdr, bitmap, &fsstat->tbytes)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6715
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "req"
          ],
          "line": 6713
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6711
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_statfs(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_statfs_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (!status)\n\t\tstatus = decode_putfh(xdr);\n\tif (!status)\n\t\tstatus = decode_statfs(xdr, res->fsstat);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_pathconf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6686-6700",
    "snippet": "static int nfs4_xdr_dec_pathconf(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs4_pathconf_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (!status)\n\t\tstatus = decode_putfh(xdr);\n\tif (!status)\n\t\tstatus = decode_pathconf(xdr, res->pathconf);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_pathconf",
          "args": [
            "xdr",
            "res->pathconf"
          ],
          "line": 6698
        },
        "resolved": true,
        "details": {
          "function_name": "decode_pathconf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4358-4380",
          "snippet": "static int decode_pathconf(struct xdr_stream *xdr, struct nfs_pathconf *pathconf)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_maxlink(xdr, bitmap, &pathconf->max_link)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxname(xdr, bitmap, &pathconf->max_namelen)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_pathconf(struct xdr_stream *xdr, struct nfs_pathconf *pathconf)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_maxlink(xdr, bitmap, &pathconf->max_link)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxname(xdr, bitmap, &pathconf->max_namelen)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6696
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "req"
          ],
          "line": 6694
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6692
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_pathconf(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs4_pathconf_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (!status)\n\t\tstatus = decode_putfh(xdr);\n\tif (!status)\n\t\tstatus = decode_pathconf(xdr, res->pathconf);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6667-6681",
    "snippet": "static int nfs4_xdr_dec_fsinfo(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_fsinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (!status)\n\t\tstatus = decode_putfh(xdr);\n\tif (!status)\n\t\tstatus = decode_fsinfo(xdr, res->fsinfo);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_fsinfo",
          "args": [
            "xdr",
            "res->fsinfo"
          ],
          "line": 6679
        },
        "resolved": true,
        "details": {
          "function_name": "decode_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4734-4773",
          "snippet": "static int decode_fsinfo(struct xdr_stream *xdr, struct nfs_fsinfo *fsinfo)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3];\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tfsinfo->rtmult = fsinfo->wtmult = 512;\t/* ??? */\n\n\tif ((status = decode_attr_lease_time(xdr, bitmap, &fsinfo->lease_time)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxfilesize(xdr, bitmap, &fsinfo->maxfilesize)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxread(xdr, bitmap, &fsinfo->rtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->rtpref = fsinfo->dtpref = fsinfo->rtmax;\n\tif ((status = decode_attr_maxwrite(xdr, bitmap, &fsinfo->wtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->wtpref = fsinfo->wtmax;\n\tstatus = decode_attr_time_delta(xdr, bitmap, &fsinfo->time_delta);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_pnfstype(xdr, bitmap, &fsinfo->layouttype);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_layout_blksize(xdr, bitmap, &fsinfo->blksize);\n\tif (status)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_fsinfo(struct xdr_stream *xdr, struct nfs_fsinfo *fsinfo)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3];\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tfsinfo->rtmult = fsinfo->wtmult = 512;\t/* ??? */\n\n\tif ((status = decode_attr_lease_time(xdr, bitmap, &fsinfo->lease_time)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxfilesize(xdr, bitmap, &fsinfo->maxfilesize)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxread(xdr, bitmap, &fsinfo->rtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->rtpref = fsinfo->dtpref = fsinfo->rtmax;\n\tif ((status = decode_attr_maxwrite(xdr, bitmap, &fsinfo->wtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->wtpref = fsinfo->wtmax;\n\tstatus = decode_attr_time_delta(xdr, bitmap, &fsinfo->time_delta);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_pnfstype(xdr, bitmap, &fsinfo->layouttype);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_layout_blksize(xdr, bitmap, &fsinfo->blksize);\n\tif (status)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6677
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "req"
          ],
          "line": 6675
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6673
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_fsinfo(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_fsinfo_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_sequence(xdr, &res->seq_res, req);\n\tif (!status)\n\t\tstatus = decode_putfh(xdr);\n\tif (!status)\n\t\tstatus = decode_fsinfo(xdr, res->fsinfo);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6643-6662",
    "snippet": "static int nfs4_xdr_dec_commit(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs_commitres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tres->op_status = hdr.status;\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_commit(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_commit",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6659
        },
        "resolved": true,
        "details": {
          "function_name": "decode_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4264-4272",
          "snippet": "static int decode_commit(struct xdr_stream *xdr, struct nfs_commitres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_COMMIT);\n\tif (!status)\n\t\tstatus = decode_write_verifier(xdr, &res->verf->verifier);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_commit(struct xdr_stream *xdr, struct nfs_commitres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_COMMIT);\n\tif (!status)\n\t\tstatus = decode_write_verifier(xdr, &res->verf->verifier);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6656
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6653
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6649
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_commit(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs_commitres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tres->op_status = hdr.status;\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_commit(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6613-6638",
    "snippet": "static int nfs4_xdr_dec_write(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_pgio_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tres->op_status = hdr.status;\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_write(xdr, res);\n\tif (status)\n\t\tgoto out;\n\tif (res->fattr)\n\t\tdecode_getfattr(xdr, res->fattr, res->server);\n\tif (!status)\n\t\tstatus = res->count;\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->fattr",
            "res->server"
          ],
          "line": 6633
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_write",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6629
        },
        "resolved": true,
        "details": {
          "function_name": "decode_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5334-5352",
          "snippet": "static int decode_write(struct xdr_stream *xdr, struct nfs_pgio_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_WRITE);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->count = be32_to_cpup(p++);\n\tres->verf->committed = be32_to_cpup(p++);\n\treturn decode_write_verifier(xdr, &res->verf->verifier);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_write(struct xdr_stream *xdr, struct nfs_pgio_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_WRITE);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->count = be32_to_cpup(p++);\n\tres->verf->committed = be32_to_cpup(p++);\n\treturn decode_write_verifier(xdr, &res->verf->verifier);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6626
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6623
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6619
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_write(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_pgio_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tres->op_status = hdr.status;\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_write(xdr, res);\n\tif (status)\n\t\tgoto out;\n\tif (res->fattr)\n\t\tdecode_getfattr(xdr, res->fattr, res->server);\n\tif (!status)\n\t\tstatus = res->count;\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6587-6608",
    "snippet": "static int nfs4_xdr_dec_read(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs_pgio_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tres->op_status = hdr.status;\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_read(xdr, rqstp, res);\n\tif (!status)\n\t\tstatus = res->count;\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_read",
          "args": [
            "xdr",
            "rqstp",
            "res"
          ],
          "line": 6603
        },
        "resolved": true,
        "details": {
          "function_name": "decode_readdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5109-5123",
          "snippet": "static int decode_readdir(struct xdr_stream *xdr, struct rpc_rqst *req, struct nfs4_readdir_res *readdir)\n{\n\tint\t\tstatus;\n\t__be32\t\tverf[2];\n\n\tstatus = decode_op_hdr(xdr, OP_READDIR);\n\tif (!status)\n\t\tstatus = decode_verifier(xdr, readdir->verifier.data);\n\tif (unlikely(status))\n\t\treturn status;\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\tdprintk(\"%s: verifier = %08x:%08x\\n\",\n\t\t\t__func__, verf[0], verf[1]);\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readdir(struct xdr_stream *xdr, struct rpc_rqst *req, struct nfs4_readdir_res *readdir)\n{\n\tint\t\tstatus;\n\t__be32\t\tverf[2];\n\n\tstatus = decode_op_hdr(xdr, OP_READDIR);\n\tif (!status)\n\t\tstatus = decode_verifier(xdr, readdir->verifier.data);\n\tif (unlikely(status))\n\t\treturn status;\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\tdprintk(\"%s: verifier = %08x:%08x\\n\",\n\t\t\t__func__, verf[0], verf[1]);\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6600
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6597
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6593
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_read(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs_pgio_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tres->op_status = hdr.status;\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_read(xdr, rqstp, res);\n\tif (!status)\n\t\tstatus = res->count;\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6564-6582",
    "snippet": "static int nfs4_xdr_dec_readdir(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_readdir_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_readdir(xdr, rqstp, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_readdir",
          "args": [
            "xdr",
            "rqstp",
            "res"
          ],
          "line": 6579
        },
        "resolved": true,
        "details": {
          "function_name": "decode_readdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5109-5123",
          "snippet": "static int decode_readdir(struct xdr_stream *xdr, struct rpc_rqst *req, struct nfs4_readdir_res *readdir)\n{\n\tint\t\tstatus;\n\t__be32\t\tverf[2];\n\n\tstatus = decode_op_hdr(xdr, OP_READDIR);\n\tif (!status)\n\t\tstatus = decode_verifier(xdr, readdir->verifier.data);\n\tif (unlikely(status))\n\t\treturn status;\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\tdprintk(\"%s: verifier = %08x:%08x\\n\",\n\t\t\t__func__, verf[0], verf[1]);\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readdir(struct xdr_stream *xdr, struct rpc_rqst *req, struct nfs4_readdir_res *readdir)\n{\n\tint\t\tstatus;\n\t__be32\t\tverf[2];\n\n\tstatus = decode_op_hdr(xdr, OP_READDIR);\n\tif (!status)\n\t\tstatus = decode_verifier(xdr, readdir->verifier.data);\n\tif (unlikely(status))\n\t\treturn status;\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\tdprintk(\"%s: verifier = %08x:%08x\\n\",\n\t\t\t__func__, verf[0], verf[1]);\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6576
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6573
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6570
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_readdir(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_readdir_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_readdir(xdr, rqstp, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6540-6559",
    "snippet": "static int nfs4_xdr_dec_readlink(struct rpc_rqst *rqstp,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t struct nfs4_readlink_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_readlink(xdr, rqstp);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_readlink",
          "args": [
            "xdr",
            "rqstp"
          ],
          "line": 6556
        },
        "resolved": true,
        "details": {
          "function_name": "decode_readlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5125-5163",
          "snippet": "static int decode_readlink(struct xdr_stream *xdr, struct rpc_rqst *req)\n{\n\tstruct xdr_buf *rcvbuf = &req->rq_rcv_buf;\n\tu32 len, recvd;\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_READLINK);\n\tif (status)\n\t\treturn status;\n\n\t/* Convert length of symlink */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len >= rcvbuf->page_len || len <= 0) {\n\t\tdprintk(\"nfs: server returned giant symlink!\\n\");\n\t\treturn -ENAMETOOLONG;\n\t}\n\trecvd = xdr_read_pages(xdr, len);\n\tif (recvd < len) {\n\t\tdprintk(\"NFS: server cheating in readlink reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\", len, recvd);\n\t\treturn -EIO;\n\t}\n\t/*\n\t * The XDR encode routine has set things up so that\n\t * the link text will be copied directly into the\n\t * buffer.  We just have to do overflow-checking,\n\t * and and null-terminate the text (the VFS expects\n\t * null-termination).\n\t */\n\txdr_terminate_string(rcvbuf, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readlink(struct xdr_stream *xdr, struct rpc_rqst *req)\n{\n\tstruct xdr_buf *rcvbuf = &req->rq_rcv_buf;\n\tu32 len, recvd;\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_READLINK);\n\tif (status)\n\t\treturn status;\n\n\t/* Convert length of symlink */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len >= rcvbuf->page_len || len <= 0) {\n\t\tdprintk(\"nfs: server returned giant symlink!\\n\");\n\t\treturn -ENAMETOOLONG;\n\t}\n\trecvd = xdr_read_pages(xdr, len);\n\tif (recvd < len) {\n\t\tdprintk(\"NFS: server cheating in readlink reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\", len, recvd);\n\t\treturn -EIO;\n\t}\n\t/*\n\t * The XDR encode routine has set things up so that\n\t * the link text will be copied directly into the\n\t * buffer.  We just have to do overflow-checking,\n\t * and and null-terminate the text (the VFS expects\n\t * null-termination).\n\t */\n\txdr_terminate_string(rcvbuf, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6553
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6550
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6547
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_readlink(struct rpc_rqst *rqstp,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t struct nfs4_readlink_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_readlink(xdr, rqstp);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_release_lockowner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6525-6535",
    "snippet": "static int nfs4_xdr_dec_release_lockowner(struct rpc_rqst *rqstp,\n\t\t\t\t\t  struct xdr_stream *xdr, void *dummy)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_release_lockowner(xdr);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_release_lockowner",
          "args": [
            "xdr"
          ],
          "line": 6533
        },
        "resolved": true,
        "details": {
          "function_name": "decode_release_lockowner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4891-4894",
          "snippet": "static int decode_release_lockowner(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RELEASE_LOCKOWNER);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_release_lockowner(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RELEASE_LOCKOWNER);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6531
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_release_lockowner(struct rpc_rqst *rqstp,\n\t\t\t\t\t  struct xdr_stream *xdr, void *dummy)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_release_lockowner(xdr);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_locku",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6505-6523",
    "snippet": "static int nfs4_xdr_dec_locku(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_locku_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_locku(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_locku",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6520
        },
        "resolved": true,
        "details": {
          "function_name": "decode_locku",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4879-4889",
          "snippet": "static int decode_locku(struct xdr_stream *xdr, struct nfs_locku_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCKU);\n\tif (status != -EIO)\n\t\tnfs_increment_lock_seqid(status, res->seqid);\n\tif (status == 0)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_locku(struct xdr_stream *xdr, struct nfs_locku_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCKU);\n\tif (status != -EIO)\n\t\tnfs_increment_lock_seqid(status, res->seqid);\n\tif (status == 0)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6517
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6514
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6511
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_locku(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_locku_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_locku(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_lockt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6482-6500",
    "snippet": "static int nfs4_xdr_dec_lockt(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_lockt_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_lockt(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_lockt",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6497
        },
        "resolved": true,
        "details": {
          "function_name": "decode_lockt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4870-4877",
          "snippet": "static int decode_lockt(struct xdr_stream *xdr, struct nfs_lockt_res *res)\n{\n\tint status;\n\tstatus = decode_op_hdr(xdr, OP_LOCKT);\n\tif (status == -NFS4ERR_DENIED)\n\t\treturn decode_lock_denied(xdr, res->denied);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lockt(struct xdr_stream *xdr, struct nfs_lockt_res *res)\n{\n\tint status;\n\tstatus = decode_op_hdr(xdr, OP_LOCKT);\n\tif (status == -NFS4ERR_DENIED)\n\t\treturn decode_lock_denied(xdr, res->denied);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6494
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6491
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6488
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_lockt(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_lockt_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_lockt(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6459-6477",
    "snippet": "static int nfs4_xdr_dec_lock(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs_lock_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_lock(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_lock",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6474
        },
        "resolved": true,
        "details": {
          "function_name": "decode_locku",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4879-4889",
          "snippet": "static int decode_locku(struct xdr_stream *xdr, struct nfs_locku_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCKU);\n\tif (status != -EIO)\n\t\tnfs_increment_lock_seqid(status, res->seqid);\n\tif (status == 0)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_locku(struct xdr_stream *xdr, struct nfs_locku_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCKU);\n\tif (status != -EIO)\n\t\tnfs_increment_lock_seqid(status, res->seqid);\n\tif (status == 0)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6471
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6468
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6465
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_lock(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs_lock_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_lock(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6432-6454",
    "snippet": "static int nfs4_xdr_dec_setattr(struct rpc_rqst *rqstp,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs_setattrres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_setattr(xdr);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->fattr",
            "res->label",
            "res->server"
          ],
          "line": 6451
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_setattr",
          "args": [
            "xdr"
          ],
          "line": 6448
        },
        "resolved": true,
        "details": {
          "function_name": "decode_setattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5256-5275",
          "snippet": "static int decode_setattr(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_SETATTR);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_setattr(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_SETATTR);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6445
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6442
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6439
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_setattr(struct rpc_rqst *rqstp,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs_setattrres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_setattr(xdr);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_open_noattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6403-6427",
    "snippet": "static int nfs4_xdr_dec_open_noattr(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs_openres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open(xdr, res);\n\tif (status)\n\t\tgoto out;\n\tif (res->access_request)\n\t\tdecode_access(xdr, &res->access_supported, &res->access_result);\n\tdecode_getfattr(xdr, res->f_attr, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->f_attr",
            "res->server"
          ],
          "line": 6424
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_access",
          "args": [
            "xdr",
            "&res->access_supported",
            "&res->access_result"
          ],
          "line": 6423
        },
        "resolved": true,
        "details": {
          "function_name": "decode_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4202-4222",
          "snippet": "static int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_open",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6419
        },
        "resolved": true,
        "details": {
          "function_name": "decode_open_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5057-5067",
          "snippet": "static int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6416
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6413
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6410
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_open_noattr(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs_openres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open(xdr, res);\n\tif (status)\n\t\tgoto out;\n\tif (res->access_request)\n\t\tdecode_access(xdr, &res->access_supported, &res->access_result);\n\tdecode_getfattr(xdr, res->f_attr, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_open_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6382-6398",
    "snippet": "static int nfs4_xdr_dec_open_confirm(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs_open_confirmres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open_confirm(xdr, res);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_open_confirm",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6395
        },
        "resolved": true,
        "details": {
          "function_name": "decode_open_confirm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5045-5055",
          "snippet": "static int decode_open_confirm(struct xdr_stream *xdr, struct nfs_open_confirmres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_CONFIRM);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open_confirm(struct xdr_stream *xdr, struct nfs_open_confirmres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_CONFIRM);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6392
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6389
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_open_confirm(struct rpc_rqst *rqstp,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs_open_confirmres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open_confirm(xdr, res);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6351-6377",
    "snippet": "static int nfs4_xdr_dec_open(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs_openres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open(xdr, res);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, &res->fh);\n\tif (status)\n\t\tgoto out;\n\tif (res->access_request)\n\t\tdecode_access(xdr, &res->access_supported, &res->access_result);\n\tdecode_getfattr_label(xdr, res->f_attr, res->f_label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->f_attr",
            "res->f_label",
            "res->server"
          ],
          "line": 6374
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_access",
          "args": [
            "xdr",
            "&res->access_supported",
            "&res->access_result"
          ],
          "line": 6373
        },
        "resolved": true,
        "details": {
          "function_name": "decode_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4202-4222",
          "snippet": "static int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfh",
          "args": [
            "xdr",
            "&res->fh"
          ],
          "line": 6369
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4775-4803",
          "snippet": "static int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_open",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6366
        },
        "resolved": true,
        "details": {
          "function_name": "decode_open_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5057-5067",
          "snippet": "static int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6363
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6360
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6357
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_open(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs_openres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open(xdr, res);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, &res->fh);\n\tif (status)\n\t\tgoto out;\n\tif (res->access_request)\n\t\tdecode_access(xdr, &res->access_supported, &res->access_result);\n\tdecode_getfattr_label(xdr, res->f_attr, res->f_label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6319-6346",
    "snippet": "static int nfs4_xdr_dec_close(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_closeres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_close(xdr, res);\n\tif (status != 0)\n\t\tgoto out;\n\t/*\n\t * Note: Server may do delete on close for this file\n\t * \tin which case the getattr call will fail with\n\t * \tan ESTALE error. Shouldn't be a problem,\n\t * \tthough, since fattr->valid will remain unset.\n\t */\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->fattr",
            "res->server"
          ],
          "line": 6343
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_close",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6334
        },
        "resolved": true,
        "details": {
          "function_name": "decode_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4242-4252",
          "snippet": "static int decode_close(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CLOSE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_close(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CLOSE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6331
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6328
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6325
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_close(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t      struct nfs_closeres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_close(xdr, res);\n\tif (status != 0)\n\t\tgoto out;\n\t/*\n\t * Note: Server may do delete on close for this file\n\t * \tin which case the getattr call will fail with\n\t * \tan ESTALE error. Shouldn't be a problem,\n\t * \tthough, since fattr->valid will remain unset.\n\t */\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_getacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6290-6314",
    "snippet": "static int\nnfs4_xdr_dec_getacl(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t    struct nfs_getaclres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tif (res->acl_scratch != NULL) {\n\t\tvoid *p = page_address(res->acl_scratch);\n\t\txdr_set_scratch_buffer(xdr, p, PAGE_SIZE);\n\t}\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getacl(xdr, rqstp, res);\n\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getacl",
          "args": [
            "xdr",
            "rqstp",
            "res"
          ],
          "line": 6310
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5203-5248",
          "snippet": "static int decode_getacl(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t struct nfs_getaclres *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\tunsigned int pg_offset;\n\n\tres->acl_len = 0;\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto out;\n\n\txdr_enter_page(xdr, xdr->buf->page_len);\n\n\t/* Calculate the offset of the page data */\n\tpg_offset = xdr->buf->head[0].iov_len;\n\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto out;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto out;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACL)) {\n\n\t\t/* The bitmap (xdr len + bitmaps) and the attr xdr len words\n\t\t * are stored with the acl data to handle the problem of\n\t\t * variable length bitmaps.*/\n\t\tres->acl_data_offset = xdr_stream_pos(xdr) - pg_offset;\n\t\tres->acl_len = attrlen;\n\n\t\t/* Check for receive buffer overflow */\n\t\tif (res->acl_len > (xdr->nwords << 2) ||\n\t\t    res->acl_len + res->acl_data_offset > xdr->buf->page_len) {\n\t\t\tres->acl_flags |= NFS4_ACL_TRUNC;\n\t\t\tdprintk(\"NFS: acl reply: attrlen %u > page_len %u\\n\",\n\t\t\t\t\tattrlen, xdr->nwords << 2);\n\t\t}\n\t} else\n\t\tstatus = -EOPNOTSUPP;\n\nout:\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getacl(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t struct nfs_getaclres *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\tunsigned int pg_offset;\n\n\tres->acl_len = 0;\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto out;\n\n\txdr_enter_page(xdr, xdr->buf->page_len);\n\n\t/* Calculate the offset of the page data */\n\tpg_offset = xdr->buf->head[0].iov_len;\n\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto out;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto out;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACL)) {\n\n\t\t/* The bitmap (xdr len + bitmaps) and the attr xdr len words\n\t\t * are stored with the acl data to handle the problem of\n\t\t * variable length bitmaps.*/\n\t\tres->acl_data_offset = xdr_stream_pos(xdr) - pg_offset;\n\t\tres->acl_len = attrlen;\n\n\t\t/* Check for receive buffer overflow */\n\t\tif (res->acl_len > (xdr->nwords << 2) ||\n\t\t    res->acl_len + res->acl_data_offset > xdr->buf->page_len) {\n\t\t\tres->acl_flags |= NFS4_ACL_TRUNC;\n\t\t\tdprintk(\"NFS: acl reply: attrlen %u > page_len %u\\n\",\n\t\t\t\t\tattrlen, xdr->nwords << 2);\n\t\t}\n\t} else\n\t\tstatus = -EOPNOTSUPP;\n\nout:\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6307
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6304
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6301
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_set_scratch_buffer",
          "args": [
            "xdr",
            "p",
            "PAGE_SIZE"
          ],
          "line": 6299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "res->acl_scratch"
          ],
          "line": 6298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\nnfs4_xdr_dec_getacl(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t    struct nfs_getaclres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tif (res->acl_scratch != NULL) {\n\t\tvoid *p = page_address(res->acl_scratch);\n\t\txdr_set_scratch_buffer(xdr, p, PAGE_SIZE);\n\t}\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getacl(xdr, rqstp, res);\n\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_setacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6266-6285",
    "snippet": "static int\nnfs4_xdr_dec_setacl(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t    struct nfs_setaclres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_setattr(xdr);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_setattr",
          "args": [
            "xdr"
          ],
          "line": 6282
        },
        "resolved": true,
        "details": {
          "function_name": "decode_setattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5256-5275",
          "snippet": "static int decode_setattr(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_SETATTR);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_setattr(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_SETATTR);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6279
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6276
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6273
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\nnfs4_xdr_dec_setacl(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t    struct nfs_setaclres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_setattr(xdr);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_setacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6249-6261",
    "snippet": "static void nfs4_xdr_enc_setacl(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_setaclargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_setacl(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 6260
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_setacl",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 6259
        },
        "resolved": true,
        "details": {
          "function_name": "encode_setacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1635-1648",
          "snippet": "static void\nencode_setacl(struct xdr_stream *xdr, struct nfs_setaclargs *arg, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setacl_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &zero_stateid);\n\tp = reserve_space(xdr, 2*4);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(FATTR4_WORD0_ACL);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(arg->acl_len);\n\txdr_write_pages(xdr, arg->acl_pages, arg->acl_pgbase, arg->acl_len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_setacl_maxsz\t(decode_setattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setacl_maxsz\t(decode_setattr_maxsz)\n\nstatic void\nencode_setacl(struct xdr_stream *xdr, struct nfs_setaclargs *arg, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setacl_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &zero_stateid);\n\tp = reserve_space(xdr, 2*4);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(FATTR4_WORD0_ACL);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(arg->acl_len);\n\txdr_write_pages(xdr, arg->acl_pages, arg->acl_pgbase, arg->acl_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 6258
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 6257
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 6256
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 6253
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_setacl(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_setaclargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_setacl(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6226-6244",
    "snippet": "static int nfs4_xdr_dec_getattr(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_getattr_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->fattr",
            "res->label",
            "res->server"
          ],
          "line": 6241
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6238
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6235
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6232
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_getattr(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_getattr_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6217-6221",
    "snippet": "static int nfs4_xdr_dec_symlink(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_create_res *res)\n{\n\treturn nfs4_xdr_dec_create(rqstp, xdr, res);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_xdr_dec_create",
          "args": [
            "rqstp",
            "xdr",
            "res"
          ],
          "line": 6220
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_dec_create_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "6949-6960",
          "snippet": "static int nfs4_xdr_dec_create_session(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs41_create_session_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_create_session(xdr, res);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_create_session(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs41_create_session_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (!status)\n\t\tstatus = decode_create_session(xdr, res);\n\treturn status;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_symlink(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_create_res *res)\n{\n\treturn nfs4_xdr_dec_create(rqstp, xdr, res);\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6188-6212",
    "snippet": "static int nfs4_xdr_dec_create(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_create_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_create(xdr, &res->dir_cinfo);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->fattr",
            "res->label",
            "res->server"
          ],
          "line": 6209
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfh",
          "args": [
            "xdr",
            "res->fh"
          ],
          "line": 6206
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4775-4803",
          "snippet": "static int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_create",
          "args": [
            "xdr",
            "&res->dir_cinfo"
          ],
          "line": 6203
        },
        "resolved": true,
        "details": {
          "function_name": "decode_create_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5639-5666",
          "snippet": "static int decode_create_session(struct xdr_stream *xdr,\n\t\t\t\t struct nfs41_create_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* seqid, flags */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p);\n\n\t/* Channel attributes */\n\tstatus = decode_chan_attrs(xdr, &res->fc_attrs);\n\tif (!status)\n\t\tstatus = decode_chan_attrs(xdr, &res->bc_attrs);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_create_session(struct xdr_stream *xdr,\n\t\t\t\t struct nfs41_create_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* seqid, flags */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p);\n\n\t/* Channel attributes */\n\tstatus = decode_chan_attrs(xdr, &res->fc_attrs);\n\tif (!status)\n\t\tstatus = decode_chan_attrs(xdr, &res->bc_attrs);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6200
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6197
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6194
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_create(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_create_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_create(xdr, &res->dir_cinfo);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6149-6183",
    "snippet": "static int nfs4_xdr_dec_link(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs4_link_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_savefh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_link(xdr, &res->cinfo);\n\tif (status)\n\t\tgoto out;\n\t/*\n\t * Note order: OP_LINK leaves the directory as the current\n\t *             filehandle.\n\t */\n\tstatus = decode_restorefh(xdr);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->fattr",
            "res->label",
            "res->server"
          ],
          "line": 6180
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_restorefh",
          "args": [
            "xdr"
          ],
          "line": 6177
        },
        "resolved": true,
        "details": {
          "function_name": "decode_restorefh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5197-5201",
          "snippet": "static int\ndecode_restorefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RESTOREFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\ndecode_restorefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RESTOREFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_link",
          "args": [
            "xdr",
            "&res->cinfo"
          ],
          "line": 6170
        },
        "resolved": true,
        "details": {
          "function_name": "decode_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4805-4813",
          "snippet": "static int decode_link(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LINK);\n\tif (status)\n\t\treturn status;\n\treturn decode_change_info(xdr, cinfo);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_link(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LINK);\n\tif (status)\n\t\treturn status;\n\treturn decode_change_info(xdr, cinfo);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6167
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_savefh",
          "args": [
            "xdr"
          ],
          "line": 6164
        },
        "resolved": true,
        "details": {
          "function_name": "decode_savefh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5250-5254",
          "snippet": "static int\ndecode_savefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SAVEFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\ndecode_savefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SAVEFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6158
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6155
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_link(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t     struct nfs4_link_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_savefh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_link(xdr, &res->cinfo);\n\tif (status)\n\t\tgoto out;\n\t/*\n\t * Note order: OP_LINK leaves the directory as the current\n\t *             filehandle.\n\t */\n\tstatus = decode_restorefh(xdr);\n\tif (status)\n\t\tgoto out;\n\tdecode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6120-6144",
    "snippet": "static int nfs4_xdr_dec_rename(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs_renameres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_savefh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_rename(xdr, &res->old_cinfo, &res->new_cinfo);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_rename",
          "args": [
            "xdr",
            "&res->old_cinfo",
            "&res->new_cinfo"
          ],
          "line": 6141
        },
        "resolved": true,
        "details": {
          "function_name": "decode_rename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5177-5190",
          "snippet": "static int decode_rename(struct xdr_stream *xdr, struct nfs4_change_info *old_cinfo,\n\t      struct nfs4_change_info *new_cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_RENAME);\n\tif (status)\n\t\tgoto out;\n\tif ((status = decode_change_info(xdr, old_cinfo)))\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, new_cinfo);\nout:\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_rename(struct xdr_stream *xdr, struct nfs4_change_info *old_cinfo,\n\t      struct nfs4_change_info *new_cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_RENAME);\n\tif (status)\n\t\tgoto out;\n\tif ((status = decode_change_info(xdr, old_cinfo)))\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, new_cinfo);\nout:\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6138
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_savefh",
          "args": [
            "xdr"
          ],
          "line": 6135
        },
        "resolved": true,
        "details": {
          "function_name": "decode_savefh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5250-5254",
          "snippet": "static int\ndecode_savefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SAVEFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\ndecode_savefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SAVEFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6129
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6126
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_rename(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs_renameres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_savefh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_rename(xdr, &res->old_cinfo, &res->new_cinfo);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6097-6115",
    "snippet": "static int nfs4_xdr_dec_remove(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs_removeres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_remove(xdr, &res->cinfo);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_remove",
          "args": [
            "xdr",
            "&res->cinfo"
          ],
          "line": 6112
        },
        "resolved": true,
        "details": {
          "function_name": "decode_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5165-5175",
          "snippet": "static int decode_remove(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_REMOVE);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, cinfo);\nout:\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_remove(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_REMOVE);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, cinfo);\nout:\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6109
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6106
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6103
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_remove(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs_removeres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_remove(xdr, &res->cinfo);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_lookup_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6070-6092",
    "snippet": "static int nfs4_xdr_dec_lookup_root(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_lookup_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putrootfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status == 0)\n\t\tstatus = decode_getfattr_label(xdr, res->fattr,\n\t\t\t\t\t\tres->label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->fattr",
            "res->label",
            "res->server"
          ],
          "line": 6088
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfh",
          "args": [
            "xdr",
            "res->fh"
          ],
          "line": 6086
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4775-4803",
          "snippet": "static int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putrootfh",
          "args": [
            "xdr"
          ],
          "line": 6083
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putrootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5074-5077",
          "snippet": "static int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6080
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6077
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_lookup_root(struct rpc_rqst *rqstp,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    struct nfs4_lookup_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putrootfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status == 0)\n\t\tstatus = decode_getfattr_label(xdr, res->fattr,\n\t\t\t\t\t\tres->label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6041-6065",
    "snippet": "static int nfs4_xdr_dec_lookup(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_lookup_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_lookup(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_label",
          "args": [
            "xdr",
            "res->fattr",
            "res->label",
            "res->server"
          ],
          "line": 6062
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4645-4649",
          "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfh",
          "args": [
            "xdr",
            "res->fh"
          ],
          "line": 6059
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4775-4803",
          "snippet": "static int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_lookup",
          "args": [
            "xdr"
          ],
          "line": 6056
        },
        "resolved": true,
        "details": {
          "function_name": "decode_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4896-4899",
          "snippet": "static int decode_lookup(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_LOOKUP);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lookup(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_LOOKUP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6053
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6050
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6047
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_lookup(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_lookup_res *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_lookup(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfh(xdr, res->fh);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_getfattr_label(xdr, res->fattr, res->label, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "6015-6036",
    "snippet": "static int nfs4_xdr_dec_access(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_accessres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_access(xdr, &res->supported, &res->access);\n\tif (status != 0)\n\t\tgoto out;\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->fattr",
            "res->server"
          ],
          "line": 6033
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_access",
          "args": [
            "xdr",
            "&res->supported",
            "&res->access"
          ],
          "line": 6030
        },
        "resolved": true,
        "details": {
          "function_name": "decode_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4202-4222",
          "snippet": "static int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6027
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 6024
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 6021
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_access(struct rpc_rqst *rqstp, struct xdr_stream *xdr,\n\t\t\t       struct nfs4_accessres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status != 0)\n\t\tgoto out;\n\tstatus = decode_access(xdr, &res->supported, &res->access);\n\tif (status != 0)\n\t\tgoto out;\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_xdr_dec_open_downgrade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5988-6010",
    "snippet": "static int nfs4_xdr_dec_open_downgrade(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs_closeres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open_downgrade(xdr, res);\n\tif (status != 0)\n\t\tgoto out;\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr",
          "args": [
            "xdr",
            "res->fattr",
            "res->server"
          ],
          "line": 6007
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4651-4655",
          "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_open_downgrade",
          "args": [
            "xdr",
            "res"
          ],
          "line": 6004
        },
        "resolved": true,
        "details": {
          "function_name": "decode_open_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5057-5067",
          "snippet": "static int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_putfh",
          "args": [
            "xdr"
          ],
          "line": 6001
        },
        "resolved": true,
        "details": {
          "function_name": "decode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5069-5072",
          "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_sequence",
          "args": [
            "xdr",
            "&res->seq_res",
            "rqstp"
          ],
          "line": 5998
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5684-5752",
          "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_compound_hdr",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 5995
        },
        "resolved": true,
        "details": {
          "function_name": "decode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3027-3049",
          "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_dec_open_downgrade(struct rpc_rqst *rqstp,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs_closeres *res)\n{\n\tstruct compound_hdr hdr;\n\tint status;\n\n\tstatus = decode_compound_hdr(xdr, &hdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_sequence(xdr, &res->seq_res, rqstp);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_putfh(xdr);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_open_downgrade(xdr, res);\n\tif (status != 0)\n\t\tgoto out;\n\tdecode_getfattr(xdr, res->fattr, res->server);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "decode_free_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5973-5978",
    "snippet": "static int decode_free_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_free_stateid_res *res)\n{\n\tres->status = decode_op_hdr(xdr, OP_FREE_STATEID);\n\treturn res->status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_FREE_STATEID"
          ],
          "line": 5976
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_free_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_free_stateid_res *res)\n{\n\tres->status = decode_op_hdr(xdr, OP_FREE_STATEID);\n\treturn res->status;\n}"
  },
  {
    "function_name": "decode_test_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5943-5971",
    "snippet": "static int decode_test_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_test_stateid_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tint num_res;\n\n\tstatus = decode_op_hdr(xdr, OP_TEST_STATEID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum_res = be32_to_cpup(p++);\n\tif (num_res != 1)\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->status = be32_to_cpup(p++);\n\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout:\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5968
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_TEST_STATEID"
          ],
          "line": 5950
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_test_stateid(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_test_stateid_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tint num_res;\n\n\tstatus = decode_op_hdr(xdr, OP_TEST_STATEID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum_res = be32_to_cpup(p++);\n\tif (num_res != 1)\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->status = be32_to_cpup(p++);\n\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout:\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_layoutcommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5913-5941",
    "snippet": "static int decode_layoutcommit(struct xdr_stream *xdr,\n\t\t\t       struct rpc_rqst *req,\n\t\t\t       struct nfs4_layoutcommit_res *res)\n{\n\t__be32 *p;\n\t__u32 sizechanged;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTCOMMIT);\n\tres->status = status;\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsizechanged = be32_to_cpup(p);\n\n\tif (sizechanged) {\n\t\t/* throw away new size */\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5939
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LAYOUTCOMMIT"
          ],
          "line": 5921
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_layoutcommit(struct xdr_stream *xdr,\n\t\t\t       struct rpc_rqst *req,\n\t\t\t       struct nfs4_layoutcommit_res *res)\n{\n\t__be32 *p;\n\t__u32 sizechanged;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTCOMMIT);\n\tres->status = status;\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsizechanged = be32_to_cpup(p);\n\n\tif (sizechanged) {\n\t\t/* throw away new size */\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_layoutreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5892-5911",
    "snippet": "static int decode_layoutreturn(struct xdr_stream *xdr,\n\t\t\t       struct nfs4_layoutreturn_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTRETURN);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->lrs_present = be32_to_cpup(p);\n\tif (res->lrs_present)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5909
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 5906
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LAYOUTRETURN"
          ],
          "line": 5898
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_layoutreturn(struct xdr_stream *xdr,\n\t\t\t       struct nfs4_layoutreturn_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTRETURN);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->lrs_present = be32_to_cpup(p);\n\tif (res->lrs_present)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_layoutget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5825-5890",
    "snippet": "static int decode_layoutget(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t    struct nfs4_layoutget_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tu32 layout_count;\n\tu32 recvd;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTGET);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->return_on_close = be32_to_cpup(p);\n\tdecode_stateid(xdr, &res->stateid);\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlayout_count = be32_to_cpup(p);\n\tif (!layout_count) {\n\t\tdprintk(\"%s: server responded with empty layout array\\n\",\n\t\t\t__func__);\n\t\treturn -EINVAL;\n\t}\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->range.offset);\n\tp = xdr_decode_hyper(p, &res->range.length);\n\tres->range.iomode = be32_to_cpup(p++);\n\tres->type = be32_to_cpup(p++);\n\tres->layoutp->len = be32_to_cpup(p);\n\n\tdprintk(\"%s roff:%lu rlen:%lu riomode:%d, lo_type:0x%x, lo.len:%d\\n\",\n\t\t__func__,\n\t\t(unsigned long)res->range.offset,\n\t\t(unsigned long)res->range.length,\n\t\tres->range.iomode,\n\t\tres->type,\n\t\tres->layoutp->len);\n\n\trecvd = xdr_read_pages(xdr, res->layoutp->len);\n\tif (res->layoutp->len > recvd) {\n\t\tdprintk(\"NFS: server cheating in layoutget reply: \"\n\t\t\t\t\"layout len %u > recvd %u\\n\",\n\t\t\t\tres->layoutp->len, recvd);\n\t\treturn -EINVAL;\n\t}\n\n\tif (layout_count > 1) {\n\t\t/* We only handle a length one array at the moment.  Any\n\t\t * further entries are just ignored.  Note that this means\n\t\t * the client may see a response that is less than the\n\t\t * minimum it requested.\n\t\t */\n\t\tdprintk(\"%s: server responded with %d layouts, dropping tail\\n\",\n\t\t\t__func__, layout_count);\n\t}\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5888
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: server responded with %d layouts, dropping tail\\n\"",
            "__func__",
            "layout_count"
          ],
          "line": 5882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: server cheating in layoutget reply: \"\n\t\t\t\t\"layout len %u > recvd %u\\n\"",
            "res->layoutp->len",
            "recvd"
          ],
          "line": 5870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "res->layoutp->len"
          ],
          "line": 5868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s roff:%lu rlen:%lu riomode:%d, lo_type:0x%x, lo.len:%d\\n\"",
            "__func__",
            "(unsigned long)res->range.offset",
            "(unsigned long)res->range.length",
            "res->range.iomode",
            "res->type",
            "res->layoutp->len"
          ],
          "line": 5860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&res->range.length"
          ],
          "line": 5855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&res->range.offset"
          ],
          "line": 5854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "28"
          ],
          "line": 5851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: server responded with empty layout array\\n\"",
            "__func__"
          ],
          "line": 5846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 5840
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LAYOUTGET"
          ],
          "line": 5833
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_layoutget(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t    struct nfs4_layoutget_res *res)\n{\n\t__be32 *p;\n\tint status;\n\tu32 layout_count;\n\tu32 recvd;\n\n\tstatus = decode_op_hdr(xdr, OP_LAYOUTGET);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->return_on_close = be32_to_cpup(p);\n\tdecode_stateid(xdr, &res->stateid);\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlayout_count = be32_to_cpup(p);\n\tif (!layout_count) {\n\t\tdprintk(\"%s: server responded with empty layout array\\n\",\n\t\t\t__func__);\n\t\treturn -EINVAL;\n\t}\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->range.offset);\n\tp = xdr_decode_hyper(p, &res->range.length);\n\tres->range.iomode = be32_to_cpup(p++);\n\tres->type = be32_to_cpup(p++);\n\tres->layoutp->len = be32_to_cpup(p);\n\n\tdprintk(\"%s roff:%lu rlen:%lu riomode:%d, lo_type:0x%x, lo.len:%d\\n\",\n\t\t__func__,\n\t\t(unsigned long)res->range.offset,\n\t\t(unsigned long)res->range.length,\n\t\tres->range.iomode,\n\t\tres->type,\n\t\tres->layoutp->len);\n\n\trecvd = xdr_read_pages(xdr, res->layoutp->len);\n\tif (res->layoutp->len > recvd) {\n\t\tdprintk(\"NFS: server cheating in layoutget reply: \"\n\t\t\t\t\"layout len %u > recvd %u\\n\",\n\t\t\t\tres->layoutp->len, recvd);\n\t\treturn -EINVAL;\n\t}\n\n\tif (layout_count > 1) {\n\t\t/* We only handle a length one array at the moment.  Any\n\t\t * further entries are just ignored.  Note that this means\n\t\t * the client may see a response that is less than the\n\t\t * minimum it requested.\n\t\t */\n\t\tdprintk(\"%s: server responded with %d layouts, dropping tail\\n\",\n\t\t\t__func__, layout_count);\n\t}\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_getdeviceinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5755-5823",
    "snippet": "static int decode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t\t\tstruct pnfs_device *pdev)\n{\n\t__be32 *p;\n\tuint32_t len, type;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETDEVICEINFO);\n\tif (status) {\n\t\tif (status == -ETOOSMALL) {\n\t\t\tp = xdr_inline_decode(xdr, 4);\n\t\t\tif (unlikely(!p))\n\t\t\t\tgoto out_overflow;\n\t\t\tpdev->mincount = be32_to_cpup(p);\n\t\t\tdprintk(\"%s: Min count too small. mincnt = %u\\n\",\n\t\t\t\t__func__, pdev->mincount);\n\t\t}\n\t\treturn status;\n\t}\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\ttype = be32_to_cpup(p++);\n\tif (type != pdev->layout_type) {\n\t\tdprintk(\"%s: layout mismatch req: %u pdev: %u\\n\",\n\t\t\t__func__, pdev->layout_type, type);\n\t\treturn -EINVAL;\n\t}\n\t/*\n\t * Get the length of the opaque device_addr4. xdr_read_pages places\n\t * the opaque device_addr4 in the xdr_buf->pages (pnfs_device->pages)\n\t * and places the remaining xdr data in xdr_buf->tail\n\t */\n\tpdev->mincount = be32_to_cpup(p);\n\tif (xdr_read_pages(xdr, pdev->mincount) != pdev->mincount)\n\t\tgoto out_overflow;\n\n\t/* Parse notification bitmap, verifying that it is zero. */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len) {\n\t\tuint32_t i;\n\n\t\tp = xdr_inline_decode(xdr, 4 * len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\tif (be32_to_cpup(p++) &\n\t\t    ~(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE)) {\n\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t__func__);\n\t\t}\n\n\t\tfor (i = 1; i < len; i++) {\n\t\t\tif (be32_to_cpup(p++)) {\n\t\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t\t__func__);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5821
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: unsupported notification\\n\"",
            "__func__"
          ],
          "line": 5813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: unsupported notification\\n\"",
            "__func__"
          ],
          "line": 5807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4 * len"
          ],
          "line": 5801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "pdev->mincount"
          ],
          "line": 5790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: layout mismatch req: %u pdev: %u\\n\"",
            "__func__",
            "pdev->layout_type",
            "type"
          ],
          "line": 5780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: Min count too small. mincnt = %u\\n\"",
            "__func__",
            "pdev->mincount"
          ],
          "line": 5769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETDEVICEINFO"
          ],
          "line": 5762
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t\t\tstruct pnfs_device *pdev)\n{\n\t__be32 *p;\n\tuint32_t len, type;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETDEVICEINFO);\n\tif (status) {\n\t\tif (status == -ETOOSMALL) {\n\t\t\tp = xdr_inline_decode(xdr, 4);\n\t\t\tif (unlikely(!p))\n\t\t\t\tgoto out_overflow;\n\t\t\tpdev->mincount = be32_to_cpup(p);\n\t\t\tdprintk(\"%s: Min count too small. mincnt = %u\\n\",\n\t\t\t\t__func__, pdev->mincount);\n\t\t}\n\t\treturn status;\n\t}\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\ttype = be32_to_cpup(p++);\n\tif (type != pdev->layout_type) {\n\t\tdprintk(\"%s: layout mismatch req: %u pdev: %u\\n\",\n\t\t\t__func__, pdev->layout_type, type);\n\t\treturn -EINVAL;\n\t}\n\t/*\n\t * Get the length of the opaque device_addr4. xdr_read_pages places\n\t * the opaque device_addr4 in the xdr_buf->pages (pnfs_device->pages)\n\t * and places the remaining xdr data in xdr_buf->tail\n\t */\n\tpdev->mincount = be32_to_cpup(p);\n\tif (xdr_read_pages(xdr, pdev->mincount) != pdev->mincount)\n\t\tgoto out_overflow;\n\n\t/* Parse notification bitmap, verifying that it is zero. */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len) {\n\t\tuint32_t i;\n\n\t\tp = xdr_inline_decode(xdr, 4 * len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\tif (be32_to_cpup(p++) &\n\t\t    ~(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE)) {\n\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t__func__);\n\t\t}\n\n\t\tfor (i = 1; i < len; i++) {\n\t\t\tif (be32_to_cpup(p++)) {\n\t\t\t\tdprintk(\"%s: unsupported notification\\n\",\n\t\t\t\t\t__func__);\n\t\t\t\treturn -EIO;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5684-5752",
    "snippet": "static int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5746
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s Invalid slot id\\n\"",
            "__func__"
          ],
          "line": 5732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s Invalid sequence number\\n\"",
            "__func__"
          ],
          "line": 5726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "20"
          ],
          "line": 5719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s Invalid session id\\n\"",
            "__func__"
          ],
          "line": 5715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "id.data",
            "session->sess_id.data",
            "NFS4_MAX_SESSIONID_LEN"
          ],
          "line": 5713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_sessionid",
          "args": [
            "xdr",
            "&id"
          ],
          "line": 5702
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sessionid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5603-5606",
          "snippet": "static int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_SEQUENCE"
          ],
          "line": 5700
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sequence(struct xdr_stream *xdr,\n\t\t\t   struct nfs4_sequence_res *res,\n\t\t\t   struct rpc_rqst *rqstp)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_sessionid id;\n\tu32 dummy;\n\tint status;\n\t__be32 *p;\n\n\tif (res->sr_slot == NULL)\n\t\treturn 0;\n\tif (!res->sr_slot->table->session)\n\t\treturn 0;\n\n\tstatus = decode_op_hdr(xdr, OP_SEQUENCE);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &id);\n\tif (unlikely(status))\n\t\tgoto out_err;\n\n\t/*\n\t * If the server returns different values for sessionID, slotID or\n\t * sequence number, the server is looney tunes.\n\t */\n\tstatus = -EREMOTEIO;\n\tsession = res->sr_slot->table->session;\n\n\tif (memcmp(id.data, session->sess_id.data,\n\t\t   NFS4_MAX_SESSIONID_LEN)) {\n\t\tdprintk(\"%s Invalid session id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\t/* seqid */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->seq_nr) {\n\t\tdprintk(\"%s Invalid sequence number\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* slot id */\n\tdummy = be32_to_cpup(p++);\n\tif (dummy != res->sr_slot->slot_nr) {\n\t\tdprintk(\"%s Invalid slot id\\n\", __func__);\n\t\tgoto out_err;\n\t}\n\t/* highest slot id */\n\tres->sr_highest_slotid = be32_to_cpup(p++);\n\t/* target highest slot id */\n\tres->sr_target_highest_slotid = be32_to_cpup(p++);\n\t/* result flags */\n\tres->sr_status_flags = be32_to_cpup(p);\n\tstatus = 0;\nout_err:\n\tres->sr_status = status;\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\tstatus = -EIO;\n\tgoto out_err;\n#else  /* CONFIG_NFS_V4_1 */\n\treturn 0;\n#endif /* CONFIG_NFS_V4_1 */\n}"
  },
  {
    "function_name": "decode_reclaim_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5678-5681",
    "snippet": "static int decode_reclaim_complete(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_RECLAIM_COMPLETE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_RECLAIM_COMPLETE"
          ],
          "line": 5680
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_reclaim_complete(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_RECLAIM_COMPLETE);\n}"
  },
  {
    "function_name": "decode_destroy_clientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5673-5676",
    "snippet": "static int decode_destroy_clientid(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_CLIENTID);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_DESTROY_CLIENTID"
          ],
          "line": 5675
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_destroy_clientid(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_CLIENTID);\n}"
  },
  {
    "function_name": "decode_destroy_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5668-5671",
    "snippet": "static int decode_destroy_session(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_SESSION);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_DESTROY_SESSION"
          ],
          "line": 5670
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_destroy_session(struct xdr_stream *xdr, void *dummy)\n{\n\treturn decode_op_hdr(xdr, OP_DESTROY_SESSION);\n}"
  },
  {
    "function_name": "decode_create_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5639-5666",
    "snippet": "static int decode_create_session(struct xdr_stream *xdr,\n\t\t\t\t struct nfs41_create_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* seqid, flags */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p);\n\n\t/* Channel attributes */\n\tstatus = decode_chan_attrs(xdr, &res->fc_attrs);\n\tif (!status)\n\t\tstatus = decode_chan_attrs(xdr, &res->bc_attrs);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5664
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_chan_attrs",
          "args": [
            "xdr",
            "&res->bc_attrs"
          ],
          "line": 5661
        },
        "resolved": true,
        "details": {
          "function_name": "decode_chan_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5569-5601",
          "snippet": "static int decode_chan_attrs(struct xdr_stream *xdr,\n\t\t\t     struct nfs4_channel_attrs *attrs)\n{\n\t__be32 *p;\n\tu32 nr_attrs, val;\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tval = be32_to_cpup(p++);\t/* headerpadsz */\n\tif (val)\n\t\treturn -EINVAL;\t\t/* no support for header padding yet */\n\tattrs->max_rqst_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz_cached = be32_to_cpup(p++);\n\tattrs->max_ops = be32_to_cpup(p++);\n\tattrs->max_reqs = be32_to_cpup(p++);\n\tnr_attrs = be32_to_cpup(p);\n\tif (unlikely(nr_attrs > 1)) {\n\t\tprintk(KERN_WARNING \"NFS: %s: Invalid rdma channel attrs \"\n\t\t\t\"count %u\\n\", __func__, nr_attrs);\n\t\treturn -EINVAL;\n\t}\n\tif (nr_attrs == 1) {\n\t\tp = xdr_inline_decode(xdr, 4); /* skip rdma_attrs */\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_chan_attrs(struct xdr_stream *xdr,\n\t\t\t     struct nfs4_channel_attrs *attrs)\n{\n\t__be32 *p;\n\tu32 nr_attrs, val;\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tval = be32_to_cpup(p++);\t/* headerpadsz */\n\tif (val)\n\t\treturn -EINVAL;\t\t/* no support for header padding yet */\n\tattrs->max_rqst_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz_cached = be32_to_cpup(p++);\n\tattrs->max_ops = be32_to_cpup(p++);\n\tattrs->max_reqs = be32_to_cpup(p++);\n\tnr_attrs = be32_to_cpup(p);\n\tif (unlikely(nr_attrs > 1)) {\n\t\tprintk(KERN_WARNING \"NFS: %s: Invalid rdma channel attrs \"\n\t\t\t\"count %u\\n\", __func__, nr_attrs);\n\t\treturn -EINVAL;\n\t}\n\tif (nr_attrs == 1) {\n\t\tp = xdr_inline_decode(xdr, 4); /* skip rdma_attrs */\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_sessionid",
          "args": [
            "xdr",
            "&res->sessionid"
          ],
          "line": 5647
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sessionid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5603-5606",
          "snippet": "static int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_CREATE_SESSION"
          ],
          "line": 5645
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_create_session(struct xdr_stream *xdr,\n\t\t\t\t struct nfs41_create_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* seqid, flags */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p);\n\n\t/* Channel attributes */\n\tstatus = decode_chan_attrs(xdr, &res->fc_attrs);\n\tif (!status)\n\t\tstatus = decode_chan_attrs(xdr, &res->bc_attrs);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_bind_conn_to_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5608-5637",
    "snippet": "static int decode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_bind_conn_to_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* dir flags, rdma mode bool */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->dir = be32_to_cpup(p++);\n\tif (res->dir == 0 || res->dir > NFS4_CDFS4_BOTH)\n\t\treturn -EIO;\n\tif (be32_to_cpup(p) == 0)\n\t\tres->use_conn_in_rdma_mode = false;\n\telse\n\t\tres->use_conn_in_rdma_mode = true;\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5635
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_sessionid",
          "args": [
            "xdr",
            "&res->sessionid"
          ],
          "line": 5616
        },
        "resolved": true,
        "details": {
          "function_name": "decode_sessionid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5603-5606",
          "snippet": "static int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_BIND_CONN_TO_SESSION"
          ],
          "line": 5614
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_bind_conn_to_session_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION);\n\tif (!status)\n\t\tstatus = decode_sessionid(xdr, &res->sessionid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\t/* dir flags, rdma mode bool */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->dir = be32_to_cpup(p++);\n\tif (res->dir == 0 || res->dir > NFS4_CDFS4_BOTH)\n\t\treturn -EIO;\n\tif (be32_to_cpup(p) == 0)\n\t\tres->use_conn_in_rdma_mode = false;\n\telse\n\t\tres->use_conn_in_rdma_mode = true;\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_sessionid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5603-5606",
    "snippet": "static int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_opaque_fixed",
          "args": [
            "xdr",
            "sid->data",
            "NFS4_MAX_SESSIONID_LEN"
          ],
          "line": 5605
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4224-4235",
          "snippet": "static int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_sessionid(struct xdr_stream *xdr, struct nfs4_sessionid *sid)\n{\n\treturn decode_opaque_fixed(xdr, sid->data, NFS4_MAX_SESSIONID_LEN);\n}"
  },
  {
    "function_name": "decode_chan_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5569-5601",
    "snippet": "static int decode_chan_attrs(struct xdr_stream *xdr,\n\t\t\t     struct nfs4_channel_attrs *attrs)\n{\n\t__be32 *p;\n\tu32 nr_attrs, val;\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tval = be32_to_cpup(p++);\t/* headerpadsz */\n\tif (val)\n\t\treturn -EINVAL;\t\t/* no support for header padding yet */\n\tattrs->max_rqst_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz_cached = be32_to_cpup(p++);\n\tattrs->max_ops = be32_to_cpup(p++);\n\tattrs->max_reqs = be32_to_cpup(p++);\n\tnr_attrs = be32_to_cpup(p);\n\tif (unlikely(nr_attrs > 1)) {\n\t\tprintk(KERN_WARNING \"NFS: %s: Invalid rdma channel attrs \"\n\t\t\t\"count %u\\n\", __func__, nr_attrs);\n\t\treturn -EINVAL;\n\t}\n\tif (nr_attrs == 1) {\n\t\tp = xdr_inline_decode(xdr, 4); /* skip rdma_attrs */\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5599
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"NFS: %s: Invalid rdma channel attrs \"\n\t\t\t\"count %u\\n\"",
            "__func__",
            "nr_attrs"
          ],
          "line": 5588
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "nr_attrs > 1"
          ],
          "line": 5587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "28"
          ],
          "line": 5575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_chan_attrs(struct xdr_stream *xdr,\n\t\t\t     struct nfs4_channel_attrs *attrs)\n{\n\t__be32 *p;\n\tu32 nr_attrs, val;\n\n\tp = xdr_inline_decode(xdr, 28);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tval = be32_to_cpup(p++);\t/* headerpadsz */\n\tif (val)\n\t\treturn -EINVAL;\t\t/* no support for header padding yet */\n\tattrs->max_rqst_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz = be32_to_cpup(p++);\n\tattrs->max_resp_sz_cached = be32_to_cpup(p++);\n\tattrs->max_ops = be32_to_cpup(p++);\n\tattrs->max_reqs = be32_to_cpup(p++);\n\tnr_attrs = be32_to_cpup(p);\n\tif (unlikely(nr_attrs > 1)) {\n\t\tprintk(KERN_WARNING \"NFS: %s: Invalid rdma channel attrs \"\n\t\t\t\"count %u\\n\", __func__, nr_attrs);\n\t\treturn -EINVAL;\n\t}\n\tif (nr_attrs == 1) {\n\t\tp = xdr_inline_decode(xdr, 4); /* skip rdma_attrs */\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_exchange_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5467-5567",
    "snippet": "static int decode_exchange_id(struct xdr_stream *xdr,\n\t\t\t      struct nfs41_exchange_id_res *res)\n{\n\t__be32 *p;\n\tuint32_t dummy;\n\tchar *dummy_str;\n\tint status;\n\tuint32_t impl_id_count;\n\n\tstatus = decode_op_hdr(xdr, OP_EXCHANGE_ID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\txdr_decode_hyper(p, &res->clientid);\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p++);\n\n\tres->state_protect.how = be32_to_cpup(p);\n\tswitch (res->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tstatus = decode_op_map(xdr, &res->state_protect.enforce);\n\t\tif (status)\n\t\t\treturn status;\n\t\tstatus = decode_op_map(xdr, &res->state_protect.allow);\n\t\tif (status)\n\t\t\treturn status;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\treturn -EIO;\n\t}\n\n\t/* server_owner4.so_minor_id */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->server_owner->minor_id);\n\n\t/* server_owner4.so_major_id */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_owner->major_id, dummy_str, dummy);\n\tres->server_owner->major_id_sz = dummy;\n\n\t/* server_scope4 */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_scope->server_scope, dummy_str, dummy);\n\tres->server_scope->server_scope_sz = dummy;\n\n\t/* Implementation Id */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\timpl_id_count = be32_to_cpup(p++);\n\n\tif (impl_id_count) {\n\t\t/* nii_domain */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->domain, dummy_str, dummy);\n\n\t\t/* nii_name */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->name, dummy_str, dummy);\n\n\t\t/* nii_date */\n\t\tp = xdr_inline_decode(xdr, 12);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->impl_id->date.seconds);\n\t\tres->impl_id->date.nseconds = be32_to_cpup(p);\n\n\t\t/* if there's more than one entry, ignore the rest */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5565
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&res->impl_id->date.seconds"
          ],
          "line": 5558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "12"
          ],
          "line": 5555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "res->impl_id->name",
            "dummy_str",
            "dummy"
          ],
          "line": 5552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "dummy > NFS4_OPAQUE_LIMIT"
          ],
          "line": 5550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_opaque_inline",
          "args": [
            "xdr",
            "&dummy",
            "&dummy_str"
          ],
          "line": 5547
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_inline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3009-3025",
          "snippet": "static int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "res->impl_id->domain",
            "dummy_str",
            "dummy"
          ],
          "line": 5544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "dummy > NFS4_OPAQUE_LIMIT"
          ],
          "line": 5542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "res->server_scope->server_scope",
            "dummy_str",
            "dummy"
          ],
          "line": 5528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "dummy > NFS4_OPAQUE_LIMIT"
          ],
          "line": 5526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "res->server_owner->major_id",
            "dummy_str",
            "dummy"
          ],
          "line": 5519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "dummy > NFS4_OPAQUE_LIMIT"
          ],
          "line": 5517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&res->server_owner->minor_id"
          ],
          "line": 5511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 5503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_map",
          "args": [
            "xdr",
            "&res->state_protect.allow"
          ],
          "line": 5498
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5450-5465",
          "snippet": "static int decode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\t__be32 *p;\n\tuint32_t bitmap_words;\n\tunsigned int i;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tbitmap_words = be32_to_cpup(p++);\n\tif (bitmap_words > NFS4_OP_MAP_NUM_WORDS)\n\t\treturn -EIO;\n\tp = xdr_inline_decode(xdr, 4 * bitmap_words);\n\tfor (i = 0; i < bitmap_words; i++)\n\t\top_map->u.words[i] = be32_to_cpup(p++);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\t__be32 *p;\n\tuint32_t bitmap_words;\n\tunsigned int i;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tbitmap_words = be32_to_cpup(p++);\n\tif (bitmap_words > NFS4_OP_MAP_NUM_WORDS)\n\t\treturn -EIO;\n\tp = xdr_inline_decode(xdr, 4 * bitmap_words);\n\tfor (i = 0; i < bitmap_words; i++)\n\t\top_map->u.words[i] = be32_to_cpup(p++);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "12"
          ],
          "line": 5484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&res->clientid"
          ],
          "line": 5483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_EXCHANGE_ID"
          ],
          "line": 5476
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_exchange_id(struct xdr_stream *xdr,\n\t\t\t      struct nfs41_exchange_id_res *res)\n{\n\t__be32 *p;\n\tuint32_t dummy;\n\tchar *dummy_str;\n\tint status;\n\tuint32_t impl_id_count;\n\n\tstatus = decode_op_hdr(xdr, OP_EXCHANGE_ID);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\txdr_decode_hyper(p, &res->clientid);\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->seqid = be32_to_cpup(p++);\n\tres->flags = be32_to_cpup(p++);\n\n\tres->state_protect.how = be32_to_cpup(p);\n\tswitch (res->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tstatus = decode_op_map(xdr, &res->state_protect.enforce);\n\t\tif (status)\n\t\t\treturn status;\n\t\tstatus = decode_op_map(xdr, &res->state_protect.allow);\n\t\tif (status)\n\t\t\treturn status;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\treturn -EIO;\n\t}\n\n\t/* server_owner4.so_minor_id */\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &res->server_owner->minor_id);\n\n\t/* server_owner4.so_major_id */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_owner->major_id, dummy_str, dummy);\n\tres->server_owner->major_id_sz = dummy;\n\n\t/* server_scope4 */\n\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\tif (unlikely(status))\n\t\treturn status;\n\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\treturn -EIO;\n\tmemcpy(res->server_scope->server_scope, dummy_str, dummy);\n\tres->server_scope->server_scope_sz = dummy;\n\n\t/* Implementation Id */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\timpl_id_count = be32_to_cpup(p++);\n\n\tif (impl_id_count) {\n\t\t/* nii_domain */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->domain, dummy_str, dummy);\n\n\t\t/* nii_name */\n\t\tstatus = decode_opaque_inline(xdr, &dummy, &dummy_str);\n\t\tif (unlikely(status))\n\t\t\treturn status;\n\t\tif (unlikely(dummy > NFS4_OPAQUE_LIMIT))\n\t\t\treturn -EIO;\n\t\tmemcpy(res->impl_id->name, dummy_str, dummy);\n\n\t\t/* nii_date */\n\t\tp = xdr_inline_decode(xdr, 12);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->impl_id->date.seconds);\n\t\tres->impl_id->date.nseconds = be32_to_cpup(p);\n\n\t\t/* if there's more than one entry, ignore the rest */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_op_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5450-5465",
    "snippet": "static int decode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\t__be32 *p;\n\tuint32_t bitmap_words;\n\tunsigned int i;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tbitmap_words = be32_to_cpup(p++);\n\tif (bitmap_words > NFS4_OP_MAP_NUM_WORDS)\n\t\treturn -EIO;\n\tp = xdr_inline_decode(xdr, 4 * bitmap_words);\n\tfor (i = 0; i < bitmap_words; i++)\n\t\top_map->u.words[i] = be32_to_cpup(p++);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4 * bitmap_words"
          ],
          "line": 5460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\t__be32 *p;\n\tuint32_t bitmap_words;\n\tunsigned int i;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tbitmap_words = be32_to_cpup(p++);\n\tif (bitmap_words > NFS4_OP_MAP_NUM_WORDS)\n\t\treturn -EIO;\n\tp = xdr_inline_decode(xdr, 4 * bitmap_words);\n\tfor (i = 0; i < bitmap_words; i++)\n\t\top_map->u.words[i] = be32_to_cpup(p++);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "decode_secinfo_no_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5442-5448",
    "snippet": "static int decode_secinfo_no_name(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO_NO_NAME);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_secinfo_common",
          "args": [
            "xdr",
            "res"
          ],
          "line": 5447
        },
        "resolved": true,
        "details": {
          "function_name": "decode_secinfo_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5393-5431",
          "snippet": "static int decode_secinfo_common(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tstruct nfs4_secinfo4 *sec_flavor;\n\tunsigned int i, num_flavors;\n\tint status;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->flavors->num_flavors = 0;\n\tnum_flavors = be32_to_cpup(p);\n\n\tfor (i = 0; i < num_flavors; i++) {\n\t\tsec_flavor = &res->flavors->flavors[i];\n\t\tif ((char *)&sec_flavor[1] - (char *)res->flavors > PAGE_SIZE)\n\t\t\tbreak;\n\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tsec_flavor->flavor = be32_to_cpup(p);\n\n\t\tif (sec_flavor->flavor == RPC_AUTH_GSS) {\n\t\t\tstatus = decode_secinfo_gss(xdr, sec_flavor);\n\t\t\tif (status)\n\t\t\t\tgoto out;\n\t\t}\n\t\tres->flavors->num_flavors++;\n\t}\n\n\tstatus = 0;\nout:\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_common(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tstruct nfs4_secinfo4 *sec_flavor;\n\tunsigned int i, num_flavors;\n\tint status;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->flavors->num_flavors = 0;\n\tnum_flavors = be32_to_cpup(p);\n\n\tfor (i = 0; i < num_flavors; i++) {\n\t\tsec_flavor = &res->flavors->flavors[i];\n\t\tif ((char *)&sec_flavor[1] - (char *)res->flavors > PAGE_SIZE)\n\t\t\tbreak;\n\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tsec_flavor->flavor = be32_to_cpup(p);\n\n\t\tif (sec_flavor->flavor == RPC_AUTH_GSS) {\n\t\t\tstatus = decode_secinfo_gss(xdr, sec_flavor);\n\t\t\tif (status)\n\t\t\t\tgoto out;\n\t\t}\n\t\tres->flavors->num_flavors++;\n\t}\n\n\tstatus = 0;\nout:\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_SECINFO_NO_NAME"
          ],
          "line": 5444
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_no_name(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO_NO_NAME);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}"
  },
  {
    "function_name": "decode_secinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5433-5439",
    "snippet": "static int decode_secinfo(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_secinfo_common",
          "args": [
            "xdr",
            "res"
          ],
          "line": 5438
        },
        "resolved": true,
        "details": {
          "function_name": "decode_secinfo_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5393-5431",
          "snippet": "static int decode_secinfo_common(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tstruct nfs4_secinfo4 *sec_flavor;\n\tunsigned int i, num_flavors;\n\tint status;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->flavors->num_flavors = 0;\n\tnum_flavors = be32_to_cpup(p);\n\n\tfor (i = 0; i < num_flavors; i++) {\n\t\tsec_flavor = &res->flavors->flavors[i];\n\t\tif ((char *)&sec_flavor[1] - (char *)res->flavors > PAGE_SIZE)\n\t\t\tbreak;\n\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tsec_flavor->flavor = be32_to_cpup(p);\n\n\t\tif (sec_flavor->flavor == RPC_AUTH_GSS) {\n\t\t\tstatus = decode_secinfo_gss(xdr, sec_flavor);\n\t\t\tif (status)\n\t\t\t\tgoto out;\n\t\t}\n\t\tres->flavors->num_flavors++;\n\t}\n\n\tstatus = 0;\nout:\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_common(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tstruct nfs4_secinfo4 *sec_flavor;\n\tunsigned int i, num_flavors;\n\tint status;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->flavors->num_flavors = 0;\n\tnum_flavors = be32_to_cpup(p);\n\n\tfor (i = 0; i < num_flavors; i++) {\n\t\tsec_flavor = &res->flavors->flavors[i];\n\t\tif ((char *)&sec_flavor[1] - (char *)res->flavors > PAGE_SIZE)\n\t\t\tbreak;\n\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tsec_flavor->flavor = be32_to_cpup(p);\n\n\t\tif (sec_flavor->flavor == RPC_AUTH_GSS) {\n\t\t\tstatus = decode_secinfo_gss(xdr, sec_flavor);\n\t\t\tif (status)\n\t\t\t\tgoto out;\n\t\t}\n\t\tres->flavors->num_flavors++;\n\t}\n\n\tstatus = 0;\nout:\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_SECINFO"
          ],
          "line": 5435
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tint status = decode_op_hdr(xdr, OP_SECINFO);\n\tif (status)\n\t\treturn status;\n\treturn decode_secinfo_common(xdr, res);\n}"
  },
  {
    "function_name": "decode_secinfo_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5393-5431",
    "snippet": "static int decode_secinfo_common(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tstruct nfs4_secinfo4 *sec_flavor;\n\tunsigned int i, num_flavors;\n\tint status;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->flavors->num_flavors = 0;\n\tnum_flavors = be32_to_cpup(p);\n\n\tfor (i = 0; i < num_flavors; i++) {\n\t\tsec_flavor = &res->flavors->flavors[i];\n\t\tif ((char *)&sec_flavor[1] - (char *)res->flavors > PAGE_SIZE)\n\t\t\tbreak;\n\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tsec_flavor->flavor = be32_to_cpup(p);\n\n\t\tif (sec_flavor->flavor == RPC_AUTH_GSS) {\n\t\t\tstatus = decode_secinfo_gss(xdr, sec_flavor);\n\t\t\tif (status)\n\t\t\t\tgoto out;\n\t\t}\n\t\tres->flavors->num_flavors++;\n\t}\n\n\tstatus = 0;\nout:\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5429
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_secinfo_gss",
          "args": [
            "xdr",
            "sec_flavor"
          ],
          "line": 5418
        },
        "resolved": true,
        "details": {
          "function_name": "decode_secinfo_gss",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "5359-5391",
          "snippet": "static int decode_secinfo_gss(struct xdr_stream *xdr,\n\t\t\t      struct nfs4_secinfo4 *flavor)\n{\n\tu32 oid_len;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\toid_len = be32_to_cpup(p);\n\tif (oid_len > GSS_OID_MAX_LEN)\n\t\tgoto out_err;\n\n\tp = xdr_inline_decode(xdr, oid_len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(flavor->flavor_info.oid.data, p, oid_len);\n\tflavor->flavor_info.oid.len = oid_len;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tflavor->flavor_info.qop = be32_to_cpup(p++);\n\tflavor->flavor_info.service = be32_to_cpup(p);\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\nout_err:\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_gss(struct xdr_stream *xdr,\n\t\t\t      struct nfs4_secinfo4 *flavor)\n{\n\tu32 oid_len;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\toid_len = be32_to_cpup(p);\n\tif (oid_len > GSS_OID_MAX_LEN)\n\t\tgoto out_err;\n\n\tp = xdr_inline_decode(xdr, oid_len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(flavor->flavor_info.oid.data, p, oid_len);\n\tflavor->flavor_info.oid.len = oid_len;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tflavor->flavor_info.qop = be32_to_cpup(p++);\n\tflavor->flavor_info.service = be32_to_cpup(p);\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\nout_err:\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5400
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_common(struct xdr_stream *xdr, struct nfs4_secinfo_res *res)\n{\n\tstruct nfs4_secinfo4 *sec_flavor;\n\tunsigned int i, num_flavors;\n\tint status;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\n\tres->flavors->num_flavors = 0;\n\tnum_flavors = be32_to_cpup(p);\n\n\tfor (i = 0; i < num_flavors; i++) {\n\t\tsec_flavor = &res->flavors->flavors[i];\n\t\tif ((char *)&sec_flavor[1] - (char *)res->flavors > PAGE_SIZE)\n\t\t\tbreak;\n\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tsec_flavor->flavor = be32_to_cpup(p);\n\n\t\tif (sec_flavor->flavor == RPC_AUTH_GSS) {\n\t\t\tstatus = decode_secinfo_gss(xdr, sec_flavor);\n\t\t\tif (status)\n\t\t\t\tgoto out;\n\t\t}\n\t\tres->flavors->num_flavors++;\n\t}\n\n\tstatus = 0;\nout:\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_secinfo_gss",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5359-5391",
    "snippet": "static int decode_secinfo_gss(struct xdr_stream *xdr,\n\t\t\t      struct nfs4_secinfo4 *flavor)\n{\n\tu32 oid_len;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\toid_len = be32_to_cpup(p);\n\tif (oid_len > GSS_OID_MAX_LEN)\n\t\tgoto out_err;\n\n\tp = xdr_inline_decode(xdr, oid_len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(flavor->flavor_info.oid.data, p, oid_len);\n\tflavor->flavor_info.oid.len = oid_len;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tflavor->flavor_info.qop = be32_to_cpup(p++);\n\tflavor->flavor_info.service = be32_to_cpup(p);\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\nout_err:\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5387
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "flavor->flavor_info.oid.data",
            "p",
            "oid_len"
          ],
          "line": 5375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "oid_len"
          ],
          "line": 5372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_secinfo_gss(struct xdr_stream *xdr,\n\t\t\t      struct nfs4_secinfo4 *flavor)\n{\n\tu32 oid_len;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\toid_len = be32_to_cpup(p);\n\tif (oid_len > GSS_OID_MAX_LEN)\n\t\tgoto out_err;\n\n\tp = xdr_inline_decode(xdr, oid_len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(flavor->flavor_info.oid.data, p, oid_len);\n\tflavor->flavor_info.oid.len = oid_len;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tflavor->flavor_info.qop = be32_to_cpup(p++);\n\tflavor->flavor_info.service = be32_to_cpup(p);\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\nout_err:\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "decode_delegreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5354-5357",
    "snippet": "static int decode_delegreturn(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_DELEGRETURN);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_DELEGRETURN"
          ],
          "line": 5356
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_delegreturn(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_DELEGRETURN);\n}"
  },
  {
    "function_name": "decode_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5334-5352",
    "snippet": "static int decode_write(struct xdr_stream *xdr, struct nfs_pgio_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_WRITE);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->count = be32_to_cpup(p++);\n\tres->verf->committed = be32_to_cpup(p++);\n\treturn decode_write_verifier(xdr, &res->verf->verifier);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5350
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_write_verifier",
          "args": [
            "xdr",
            "&res->verf->verifier"
          ],
          "line": 5348
        },
        "resolved": true,
        "details": {
          "function_name": "decode_write_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4259-4262",
          "snippet": "static int decode_write_verifier(struct xdr_stream *xdr, struct nfs_write_verifier *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_write_verifier(struct xdr_stream *xdr, struct nfs_write_verifier *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_WRITE"
          ],
          "line": 5339
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_write(struct xdr_stream *xdr, struct nfs_pgio_res *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_WRITE);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->count = be32_to_cpup(p++);\n\tres->verf->committed = be32_to_cpup(p++);\n\treturn decode_write_verifier(xdr, &res->verf->verifier);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_setclientid_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5329-5332",
    "snippet": "static int decode_setclientid_confirm(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_SETCLIENTID_CONFIRM"
          ],
          "line": 5331
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_setclientid_confirm(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM);\n}"
  },
  {
    "function_name": "decode_setclientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5277-5327",
    "snippet": "static int decode_setclientid(struct xdr_stream *xdr, struct nfs4_setclientid_res *res)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (opnum != OP_SETCLIENTID) {\n\t\tdprintk(\"nfs: decode_setclientid: Server returned operation\"\n\t\t\t\" %d\\n\", opnum);\n\t\treturn -EIO;\n\t}\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK) {\n\t\tp = xdr_inline_decode(xdr, 8 + NFS4_VERIFIER_SIZE);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->clientid);\n\t\tmemcpy(res->confirm.data, p, NFS4_VERIFIER_SIZE);\n\t} else if (nfserr == NFSERR_CLID_INUSE) {\n\t\tuint32_t len;\n\n\t\t/* skip netid string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\t/* skip uaddr string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\treturn -NFSERR_CLID_INUSE;\n\t} else\n\t\treturn nfs4_stat_to_errno(nfserr);\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs4_stat_to_errno(int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5325
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_stat_to_errno",
          "args": [
            "nfserr"
          ],
          "line": 5321
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "7333-7351",
          "snippet": "static int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);",
            "static struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\nstatic struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 5316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 5307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "res->confirm.data",
            "p",
            "NFS4_VERIFIER_SIZE"
          ],
          "line": 5298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&res->clientid"
          ],
          "line": 5297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8 + NFS4_VERIFIER_SIZE"
          ],
          "line": 5294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs: decode_setclientid: Server returned operation\"\n\t\t\t\" %d\\n\"",
            "opnum"
          ],
          "line": 5288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_setclientid(struct xdr_stream *xdr, struct nfs4_setclientid_res *res)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (opnum != OP_SETCLIENTID) {\n\t\tdprintk(\"nfs: decode_setclientid: Server returned operation\"\n\t\t\t\" %d\\n\", opnum);\n\t\treturn -EIO;\n\t}\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK) {\n\t\tp = xdr_inline_decode(xdr, 8 + NFS4_VERIFIER_SIZE);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &res->clientid);\n\t\tmemcpy(res->confirm.data, p, NFS4_VERIFIER_SIZE);\n\t} else if (nfserr == NFSERR_CLID_INUSE) {\n\t\tuint32_t len;\n\n\t\t/* skip netid string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\n\t\t/* skip uaddr string */\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\treturn -NFSERR_CLID_INUSE;\n\t} else\n\t\treturn nfs4_stat_to_errno(nfserr);\n\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5256-5275",
    "snippet": "static int decode_setattr(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_SETATTR);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5273
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "p"
          ],
          "line": 5270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "bmlen << 2"
          ],
          "line": 5269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_SETATTR"
          ],
          "line": 5262
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_setattr(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_SETATTR);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_savefh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5250-5254",
    "snippet": "static int\ndecode_savefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SAVEFH);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_SAVEFH"
          ],
          "line": 5253
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\ndecode_savefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_SAVEFH);\n}"
  },
  {
    "function_name": "decode_getacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5203-5248",
    "snippet": "static int decode_getacl(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t struct nfs_getaclres *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\tunsigned int pg_offset;\n\n\tres->acl_len = 0;\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto out;\n\n\txdr_enter_page(xdr, xdr->buf->page_len);\n\n\t/* Calculate the offset of the page data */\n\tpg_offset = xdr->buf->head[0].iov_len;\n\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto out;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto out;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACL)) {\n\n\t\t/* The bitmap (xdr len + bitmaps) and the attr xdr len words\n\t\t * are stored with the acl data to handle the problem of\n\t\t * variable length bitmaps.*/\n\t\tres->acl_data_offset = xdr_stream_pos(xdr) - pg_offset;\n\t\tres->acl_len = attrlen;\n\n\t\t/* Check for receive buffer overflow */\n\t\tif (res->acl_len > (xdr->nwords << 2) ||\n\t\t    res->acl_len + res->acl_data_offset > xdr->buf->page_len) {\n\t\t\tres->acl_flags |= NFS4_ACL_TRUNC;\n\t\t\tdprintk(\"NFS: acl reply: attrlen %u > page_len %u\\n\",\n\t\t\t\t\tattrlen, xdr->nwords << 2);\n\t\t}\n\t} else\n\t\tstatus = -EOPNOTSUPP;\n\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: acl reply: attrlen %u > page_len %u\\n\"",
            "attrlen",
            "xdr->nwords << 2"
          ],
          "line": 5240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_stream_pos",
          "args": [
            "xdr"
          ],
          "line": 5233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_ACL"
          ],
          "line": 5228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_ACL - 1U)"
          ],
          "line": 5226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 5223
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 5221
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_enter_page",
          "args": [
            "xdr",
            "xdr->buf->page_len"
          ],
          "line": 5216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR"
          ],
          "line": 5213
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getacl(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t\t struct nfs_getaclres *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\tunsigned int pg_offset;\n\n\tres->acl_len = 0;\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto out;\n\n\txdr_enter_page(xdr, xdr->buf->page_len);\n\n\t/* Calculate the offset of the page data */\n\tpg_offset = xdr->buf->head[0].iov_len;\n\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto out;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto out;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACL)) {\n\n\t\t/* The bitmap (xdr len + bitmaps) and the attr xdr len words\n\t\t * are stored with the acl data to handle the problem of\n\t\t * variable length bitmaps.*/\n\t\tres->acl_data_offset = xdr_stream_pos(xdr) - pg_offset;\n\t\tres->acl_len = attrlen;\n\n\t\t/* Check for receive buffer overflow */\n\t\tif (res->acl_len > (xdr->nwords << 2) ||\n\t\t    res->acl_len + res->acl_data_offset > xdr->buf->page_len) {\n\t\t\tres->acl_flags |= NFS4_ACL_TRUNC;\n\t\t\tdprintk(\"NFS: acl reply: attrlen %u > page_len %u\\n\",\n\t\t\t\t\tattrlen, xdr->nwords << 2);\n\t\t}\n\t} else\n\t\tstatus = -EOPNOTSUPP;\n\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "decode_restorefh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5197-5201",
    "snippet": "static int\ndecode_restorefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RESTOREFH);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_RESTOREFH"
          ],
          "line": 5200
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int\ndecode_restorefh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RESTOREFH);\n}"
  },
  {
    "function_name": "decode_renew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5192-5195",
    "snippet": "static int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_RENEW"
          ],
          "line": 5194
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_renew(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RENEW);\n}"
  },
  {
    "function_name": "decode_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5177-5190",
    "snippet": "static int decode_rename(struct xdr_stream *xdr, struct nfs4_change_info *old_cinfo,\n\t      struct nfs4_change_info *new_cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_RENAME);\n\tif (status)\n\t\tgoto out;\n\tif ((status = decode_change_info(xdr, old_cinfo)))\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, new_cinfo);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_change_info",
          "args": [
            "xdr",
            "new_cinfo"
          ],
          "line": 5187
        },
        "resolved": true,
        "details": {
          "function_name": "decode_change_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4186-4200",
          "snippet": "static int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_RENAME"
          ],
          "line": 5182
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_rename(struct xdr_stream *xdr, struct nfs4_change_info *old_cinfo,\n\t      struct nfs4_change_info *new_cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_RENAME);\n\tif (status)\n\t\tgoto out;\n\tif ((status = decode_change_info(xdr, old_cinfo)))\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, new_cinfo);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "decode_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5165-5175",
    "snippet": "static int decode_remove(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_REMOVE);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, cinfo);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_change_info",
          "args": [
            "xdr",
            "cinfo"
          ],
          "line": 5172
        },
        "resolved": true,
        "details": {
          "function_name": "decode_change_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4186-4200",
          "snippet": "static int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_REMOVE"
          ],
          "line": 5169
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_remove(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_REMOVE);\n\tif (status)\n\t\tgoto out;\n\tstatus = decode_change_info(xdr, cinfo);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "decode_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5125-5163",
    "snippet": "static int decode_readlink(struct xdr_stream *xdr, struct rpc_rqst *req)\n{\n\tstruct xdr_buf *rcvbuf = &req->rq_rcv_buf;\n\tu32 len, recvd;\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_READLINK);\n\tif (status)\n\t\treturn status;\n\n\t/* Convert length of symlink */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len >= rcvbuf->page_len || len <= 0) {\n\t\tdprintk(\"nfs: server returned giant symlink!\\n\");\n\t\treturn -ENAMETOOLONG;\n\t}\n\trecvd = xdr_read_pages(xdr, len);\n\tif (recvd < len) {\n\t\tdprintk(\"NFS: server cheating in readlink reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\", len, recvd);\n\t\treturn -EIO;\n\t}\n\t/*\n\t * The XDR encode routine has set things up so that\n\t * the link text will be copied directly into the\n\t * buffer.  We just have to do overflow-checking,\n\t * and and null-terminate the text (the VFS expects\n\t * null-termination).\n\t */\n\txdr_terminate_string(rcvbuf, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5161
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_terminate_string",
          "args": [
            "rcvbuf",
            "len"
          ],
          "line": 5158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: server cheating in readlink reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\"",
            "len",
            "recvd"
          ],
          "line": 5147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "len"
          ],
          "line": 5145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs: server returned giant symlink!\\n\""
          ],
          "line": 5142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 5137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_READLINK"
          ],
          "line": 5132
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readlink(struct xdr_stream *xdr, struct rpc_rqst *req)\n{\n\tstruct xdr_buf *rcvbuf = &req->rq_rcv_buf;\n\tu32 len, recvd;\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_READLINK);\n\tif (status)\n\t\treturn status;\n\n\t/* Convert length of symlink */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len >= rcvbuf->page_len || len <= 0) {\n\t\tdprintk(\"nfs: server returned giant symlink!\\n\");\n\t\treturn -ENAMETOOLONG;\n\t}\n\trecvd = xdr_read_pages(xdr, len);\n\tif (recvd < len) {\n\t\tdprintk(\"NFS: server cheating in readlink reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\", len, recvd);\n\t\treturn -EIO;\n\t}\n\t/*\n\t * The XDR encode routine has set things up so that\n\t * the link text will be copied directly into the\n\t * buffer.  We just have to do overflow-checking,\n\t * and and null-terminate the text (the VFS expects\n\t * null-termination).\n\t */\n\txdr_terminate_string(rcvbuf, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5109-5123",
    "snippet": "static int decode_readdir(struct xdr_stream *xdr, struct rpc_rqst *req, struct nfs4_readdir_res *readdir)\n{\n\tint\t\tstatus;\n\t__be32\t\tverf[2];\n\n\tstatus = decode_op_hdr(xdr, OP_READDIR);\n\tif (!status)\n\t\tstatus = decode_verifier(xdr, readdir->verifier.data);\n\tif (unlikely(status))\n\t\treturn status;\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\tdprintk(\"%s: verifier = %08x:%08x\\n\",\n\t\t\t__func__, verf[0], verf[1]);\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "xdr->buf->page_len"
          ],
          "line": 5122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: verifier = %08x:%08x\\n\"",
            "__func__",
            "verf[0]",
            "verf[1]"
          ],
          "line": 5120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "verf",
            "readdir->verifier.data",
            "sizeof(verf)"
          ],
          "line": 5119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_verifier",
          "args": [
            "xdr",
            "readdir->verifier.data"
          ],
          "line": 5116
        },
        "resolved": true,
        "details": {
          "function_name": "decode_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4254-4257",
          "snippet": "static int decode_verifier(struct xdr_stream *xdr, void *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_verifier(struct xdr_stream *xdr, void *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_READDIR"
          ],
          "line": 5114
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readdir(struct xdr_stream *xdr, struct rpc_rqst *req, struct nfs4_readdir_res *readdir)\n{\n\tint\t\tstatus;\n\t__be32\t\tverf[2];\n\n\tstatus = decode_op_hdr(xdr, OP_READDIR);\n\tif (!status)\n\t\tstatus = decode_verifier(xdr, readdir->verifier.data);\n\tif (unlikely(status))\n\t\treturn status;\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\tdprintk(\"%s: verifier = %08x:%08x\\n\",\n\t\t\t__func__, verf[0], verf[1]);\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}"
  },
  {
    "function_name": "decode_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5079-5107",
    "snippet": "static int decode_read(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t       struct nfs_pgio_res *res)\n{\n\t__be32 *p;\n\tuint32_t count, eof, recvd;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_READ);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\teof = be32_to_cpup(p++);\n\tcount = be32_to_cpup(p);\n\trecvd = xdr_read_pages(xdr, count);\n\tif (count > recvd) {\n\t\tdprintk(\"NFS: server cheating in read reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\", count, recvd);\n\t\tcount = recvd;\n\t\teof = 0;\n\t}\n\tres->eof = eof;\n\tres->count = count;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5105
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: server cheating in read reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\"",
            "count",
            "recvd"
          ],
          "line": 5096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "count"
          ],
          "line": 5094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_READ"
          ],
          "line": 5086
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_read(struct xdr_stream *xdr, struct rpc_rqst *req,\n\t\t       struct nfs_pgio_res *res)\n{\n\t__be32 *p;\n\tuint32_t count, eof, recvd;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_READ);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\teof = be32_to_cpup(p++);\n\tcount = be32_to_cpup(p);\n\trecvd = xdr_read_pages(xdr, count);\n\tif (count > recvd) {\n\t\tdprintk(\"NFS: server cheating in read reply: \"\n\t\t\t\t\"count %u > recvd %u\\n\", count, recvd);\n\t\tcount = recvd;\n\t\teof = 0;\n\t}\n\tres->eof = eof;\n\tres->count = count;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_putrootfh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5074-5077",
    "snippet": "static int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_PUTROOTFH"
          ],
          "line": 5076
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putrootfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTROOTFH);\n}"
  },
  {
    "function_name": "decode_putfh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5069-5072",
    "snippet": "static int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_PUTFH"
          ],
          "line": 5071
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_putfh(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_PUTFH);\n}"
  },
  {
    "function_name": "decode_open_downgrade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5057-5067",
    "snippet": "static int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 5065
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_increment_open_seqid",
          "args": [
            "status",
            "res->seqid"
          ],
          "line": 5063
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_open_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1086-1098",
          "snippet": "void nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_OPEN_DOWNGRADE"
          ],
          "line": 5061
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open_downgrade(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_DOWNGRADE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_open_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5045-5055",
    "snippet": "static int decode_open_confirm(struct xdr_stream *xdr, struct nfs_open_confirmres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_CONFIRM);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 5053
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_increment_open_seqid",
          "args": [
            "status",
            "res->seqid"
          ],
          "line": 5051
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_open_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1086-1098",
          "snippet": "void nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_OPEN_CONFIRM"
          ],
          "line": 5049
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open_confirm(struct xdr_stream *xdr, struct nfs_open_confirmres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_OPEN_CONFIRM);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "5002-5043",
    "snippet": "static int decode_open(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t savewords, bmlen, i;\n\tint status;\n\n\tif (!__decode_op_hdr(xdr, OP_OPEN, &status))\n\t\treturn status;\n\tnfs_increment_open_seqid(status, res->seqid);\n\tif (status)\n\t\treturn status;\n\tstatus = decode_stateid(xdr, &res->stateid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\tdecode_change_info(xdr, &res->cinfo);\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->rflags = be32_to_cpup(p++);\n\tbmlen = be32_to_cpup(p);\n\tif (bmlen > 10)\n\t\tgoto xdr_error;\n\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsavewords = min_t(uint32_t, bmlen, NFS4_BITMAP_SIZE);\n\tfor (i = 0; i < savewords; ++i)\n\t\tres->attrset[i] = be32_to_cpup(p++);\n\tfor (; i < NFS4_BITMAP_SIZE; i++)\n\t\tres->attrset[i] = 0;\n\n\treturn decode_delegation(xdr, res);\nxdr_error:\n\tdprintk(\"%s: Bitmap too large! Length = %u\\n\", __func__, bmlen);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 5041
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: Bitmap too large! Length = %u\\n\"",
            "__func__",
            "bmlen"
          ],
          "line": 5038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_delegation",
          "args": [
            "xdr",
            "res"
          ],
          "line": 5036
        },
        "resolved": true,
        "details": {
          "function_name": "decode_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4977-5000",
          "snippet": "static int decode_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t delegation_type;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tdelegation_type = be32_to_cpup(p);\n\tres->delegation_type = 0;\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_NONE:\n\t\treturn 0;\n\tcase NFS4_OPEN_DELEGATE_READ:\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\treturn decode_rw_delegation(xdr, delegation_type, res);\n\tcase NFS4_OPEN_DELEGATE_NONE_EXT:\n\t\treturn decode_no_delegation(xdr, res);\n\t}\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t delegation_type;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tdelegation_type = be32_to_cpup(p);\n\tres->delegation_type = 0;\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_NONE:\n\t\treturn 0;\n\tcase NFS4_OPEN_DELEGATE_READ:\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\treturn decode_rw_delegation(xdr, delegation_type, res);\n\tcase NFS4_OPEN_DELEGATE_NONE_EXT:\n\t\treturn decode_no_delegation(xdr, res);\n\t}\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "uint32_t",
            "bmlen",
            "NFS4_BITMAP_SIZE"
          ],
          "line": 5030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "bmlen << 2"
          ],
          "line": 5027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 5023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 5022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 5020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 5019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_change_info",
          "args": [
            "xdr",
            "&res->cinfo"
          ],
          "line": 5017
        },
        "resolved": true,
        "details": {
          "function_name": "decode_change_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4186-4200",
          "snippet": "static int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 5014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 5013
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_increment_open_seqid",
          "args": [
            "status",
            "res->seqid"
          ],
          "line": 5010
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_open_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1086-1098",
          "snippet": "void nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__decode_op_hdr",
          "args": [
            "xdr",
            "OP_OPEN",
            "&status"
          ],
          "line": 5008
        },
        "resolved": true,
        "details": {
          "function_name": "__decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3051-3080",
          "snippet": "static bool __decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected,\n\t\tint *nfs_retval)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (unlikely(opnum != expected))\n\t\tgoto out_bad_operation;\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK)\n\t\t*nfs_retval = 0;\n\telse\n\t\t*nfs_retval = nfs4_stat_to_errno(nfserr);\n\treturn true;\nout_bad_operation:\n\tdprintk(\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\",\n\t\t\topnum, expected);\n\t*nfs_retval = -EREMOTEIO;\n\treturn false;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\t*nfs_retval = -EIO;\n\treturn false;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic bool __decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected,\n\t\tint *nfs_retval)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (unlikely(opnum != expected))\n\t\tgoto out_bad_operation;\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK)\n\t\t*nfs_retval = 0;\n\telse\n\t\t*nfs_retval = nfs4_stat_to_errno(nfserr);\n\treturn true;\nout_bad_operation:\n\tdprintk(\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\",\n\t\t\topnum, expected);\n\t*nfs_retval = -EREMOTEIO;\n\treturn false;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\t*nfs_retval = -EIO;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_open(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t savewords, bmlen, i;\n\tint status;\n\n\tif (!__decode_op_hdr(xdr, OP_OPEN, &status))\n\t\treturn status;\n\tnfs_increment_open_seqid(status, res->seqid);\n\tif (status)\n\t\treturn status;\n\tstatus = decode_stateid(xdr, &res->stateid);\n\tif (unlikely(status))\n\t\treturn status;\n\n\tdecode_change_info(xdr, &res->cinfo);\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->rflags = be32_to_cpup(p++);\n\tbmlen = be32_to_cpup(p);\n\tif (bmlen > 10)\n\t\tgoto xdr_error;\n\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsavewords = min_t(uint32_t, bmlen, NFS4_BITMAP_SIZE);\n\tfor (i = 0; i < savewords; ++i)\n\t\tres->attrset[i] = be32_to_cpup(p++);\n\tfor (; i < NFS4_BITMAP_SIZE; i++)\n\t\tres->attrset[i] = 0;\n\n\treturn decode_delegation(xdr, res);\nxdr_error:\n\tdprintk(\"%s: Bitmap too large! Length = %u\\n\", __func__, bmlen);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4977-5000",
    "snippet": "static int decode_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t delegation_type;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tdelegation_type = be32_to_cpup(p);\n\tres->delegation_type = 0;\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_NONE:\n\t\treturn 0;\n\tcase NFS4_OPEN_DELEGATE_READ:\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\treturn decode_rw_delegation(xdr, delegation_type, res);\n\tcase NFS4_OPEN_DELEGATE_NONE_EXT:\n\t\treturn decode_no_delegation(xdr, res);\n\t}\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4998
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_no_delegation",
          "args": [
            "xdr",
            "res"
          ],
          "line": 4994
        },
        "resolved": true,
        "details": {
          "function_name": "decode_no_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4956-4975",
          "snippet": "static int decode_no_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t why_no_delegation;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\twhy_no_delegation = be32_to_cpup(p);\n\tswitch (why_no_delegation) {\n\t\tcase WND4_CONTENTION:\n\t\tcase WND4_RESOURCE:\n\t\t\txdr_inline_decode(xdr, 4);\n\t\t\t/* Ignore for now */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_no_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t why_no_delegation;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\twhy_no_delegation = be32_to_cpup(p);\n\tswitch (why_no_delegation) {\n\t\tcase WND4_CONTENTION:\n\t\tcase WND4_RESOURCE:\n\t\t\txdr_inline_decode(xdr, 4);\n\t\t\t/* Ignore for now */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_rw_delegation",
          "args": [
            "xdr",
            "delegation_type",
            "res"
          ],
          "line": 4992
        },
        "resolved": true,
        "details": {
          "function_name": "decode_rw_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4926-4954",
          "snippet": "static int decode_rw_delegation(struct xdr_stream *xdr,\n\t\tuint32_t delegation_type,\n\t\tstruct nfs_openres *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_stateid(xdr, &res->delegation);\n\tif (unlikely(status))\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->do_recall = be32_to_cpup(p);\n\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_READ:\n\t\tres->delegation_type = FMODE_READ;\n\t\tbreak;\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\tres->delegation_type = FMODE_WRITE|FMODE_READ;\n\t\tif (decode_space_limit(xdr, &res->maxsize) < 0)\n\t\t\t\treturn -EIO;\n\t}\n\treturn decode_ace(xdr, NULL, res->server->nfs_client);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_rw_delegation(struct xdr_stream *xdr,\n\t\tuint32_t delegation_type,\n\t\tstruct nfs_openres *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_stateid(xdr, &res->delegation);\n\tif (unlikely(status))\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->do_recall = be32_to_cpup(p);\n\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_READ:\n\t\tres->delegation_type = FMODE_READ;\n\t\tbreak;\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\tres->delegation_type = FMODE_WRITE|FMODE_READ;\n\t\tif (decode_space_limit(xdr, &res->maxsize) < 0)\n\t\t\t\treturn -EIO;\n\t}\n\treturn decode_ace(xdr, NULL, res->server->nfs_client);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t delegation_type;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tdelegation_type = be32_to_cpup(p);\n\tres->delegation_type = 0;\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_NONE:\n\t\treturn 0;\n\tcase NFS4_OPEN_DELEGATE_READ:\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\treturn decode_rw_delegation(xdr, delegation_type, res);\n\tcase NFS4_OPEN_DELEGATE_NONE_EXT:\n\t\treturn decode_no_delegation(xdr, res);\n\t}\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_no_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4956-4975",
    "snippet": "static int decode_no_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t why_no_delegation;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\twhy_no_delegation = be32_to_cpup(p);\n\tswitch (why_no_delegation) {\n\t\tcase WND4_CONTENTION:\n\t\tcase WND4_RESOURCE:\n\t\t\txdr_inline_decode(xdr, 4);\n\t\t\t/* Ignore for now */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4973
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_no_delegation(struct xdr_stream *xdr, struct nfs_openres *res)\n{\n\t__be32 *p;\n\tuint32_t why_no_delegation;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\twhy_no_delegation = be32_to_cpup(p);\n\tswitch (why_no_delegation) {\n\t\tcase WND4_CONTENTION:\n\t\tcase WND4_RESOURCE:\n\t\t\txdr_inline_decode(xdr, 4);\n\t\t\t/* Ignore for now */\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_rw_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4926-4954",
    "snippet": "static int decode_rw_delegation(struct xdr_stream *xdr,\n\t\tuint32_t delegation_type,\n\t\tstruct nfs_openres *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_stateid(xdr, &res->delegation);\n\tif (unlikely(status))\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->do_recall = be32_to_cpup(p);\n\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_READ:\n\t\tres->delegation_type = FMODE_READ;\n\t\tbreak;\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\tres->delegation_type = FMODE_WRITE|FMODE_READ;\n\t\tif (decode_space_limit(xdr, &res->maxsize) < 0)\n\t\t\t\treturn -EIO;\n\t}\n\treturn decode_ace(xdr, NULL, res->server->nfs_client);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4952
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_ace",
          "args": [
            "xdr",
            "NULL",
            "res->server->nfs_client"
          ],
          "line": 4950
        },
        "resolved": true,
        "details": {
          "function_name": "decode_ace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3091-3102",
          "snippet": "static int decode_ace(struct xdr_stream *xdr, void *ace, struct nfs_client *clp)\n{\n\t__be32 *p;\n\tunsigned int strlen;\n\tchar *str;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (likely(p))\n\t\treturn decode_opaque_inline(xdr, &strlen, &str);\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_ace(struct xdr_stream *xdr, void *ace, struct nfs_client *clp)\n{\n\t__be32 *p;\n\tunsigned int strlen;\n\tchar *str;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (likely(p))\n\t\treturn decode_opaque_inline(xdr, &strlen, &str);\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_space_limit",
          "args": [
            "xdr",
            "&res->maxsize"
          ],
          "line": 4947
        },
        "resolved": true,
        "details": {
          "function_name": "decode_space_limit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4902-4924",
          "snippet": "static int decode_space_limit(struct xdr_stream *xdr, u64 *maxsize)\n{\n\t__be32 *p;\n\tuint32_t limit_type, nblocks, blocksize;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlimit_type = be32_to_cpup(p++);\n\tswitch (limit_type) {\n\tcase 1:\n\t\txdr_decode_hyper(p, maxsize);\n\t\tbreak;\n\tcase 2:\n\t\tnblocks = be32_to_cpup(p++);\n\t\tblocksize = be32_to_cpup(p);\n\t\t*maxsize = (uint64_t)nblocks * (uint64_t)blocksize;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_space_limit(struct xdr_stream *xdr, u64 *maxsize)\n{\n\t__be32 *p;\n\tuint32_t limit_type, nblocks, blocksize;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlimit_type = be32_to_cpup(p++);\n\tswitch (limit_type) {\n\tcase 1:\n\t\txdr_decode_hyper(p, maxsize);\n\t\tbreak;\n\tcase 2:\n\t\tnblocks = be32_to_cpup(p++);\n\t\tblocksize = be32_to_cpup(p);\n\t\t*maxsize = (uint64_t)nblocks * (uint64_t)blocksize;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 4934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->delegation"
          ],
          "line": 4933
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_rw_delegation(struct xdr_stream *xdr,\n\t\tuint32_t delegation_type,\n\t\tstruct nfs_openres *res)\n{\n\t__be32 *p;\n\tint status;\n\n\tstatus = decode_stateid(xdr, &res->delegation);\n\tif (unlikely(status))\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tres->do_recall = be32_to_cpup(p);\n\n\tswitch (delegation_type) {\n\tcase NFS4_OPEN_DELEGATE_READ:\n\t\tres->delegation_type = FMODE_READ;\n\t\tbreak;\n\tcase NFS4_OPEN_DELEGATE_WRITE:\n\t\tres->delegation_type = FMODE_WRITE|FMODE_READ;\n\t\tif (decode_space_limit(xdr, &res->maxsize) < 0)\n\t\t\t\treturn -EIO;\n\t}\n\treturn decode_ace(xdr, NULL, res->server->nfs_client);\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_space_limit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4902-4924",
    "snippet": "static int decode_space_limit(struct xdr_stream *xdr, u64 *maxsize)\n{\n\t__be32 *p;\n\tuint32_t limit_type, nblocks, blocksize;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlimit_type = be32_to_cpup(p++);\n\tswitch (limit_type) {\n\tcase 1:\n\t\txdr_decode_hyper(p, maxsize);\n\t\tbreak;\n\tcase 2:\n\t\tnblocks = be32_to_cpup(p++);\n\t\tblocksize = be32_to_cpup(p);\n\t\t*maxsize = (uint64_t)nblocks * (uint64_t)blocksize;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4922
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "maxsize"
          ],
          "line": 4913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "12"
          ],
          "line": 4907
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_space_limit(struct xdr_stream *xdr, u64 *maxsize)\n{\n\t__be32 *p;\n\tuint32_t limit_type, nblocks, blocksize;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlimit_type = be32_to_cpup(p++);\n\tswitch (limit_type) {\n\tcase 1:\n\t\txdr_decode_hyper(p, maxsize);\n\t\tbreak;\n\tcase 2:\n\t\tnblocks = be32_to_cpup(p++);\n\t\tblocksize = be32_to_cpup(p);\n\t\t*maxsize = (uint64_t)nblocks * (uint64_t)blocksize;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4896-4899",
    "snippet": "static int decode_lookup(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_LOOKUP);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LOOKUP"
          ],
          "line": 4898
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lookup(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_LOOKUP);\n}"
  },
  {
    "function_name": "decode_release_lockowner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4891-4894",
    "snippet": "static int decode_release_lockowner(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RELEASE_LOCKOWNER);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_RELEASE_LOCKOWNER"
          ],
          "line": 4893
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_release_lockowner(struct xdr_stream *xdr)\n{\n\treturn decode_op_hdr(xdr, OP_RELEASE_LOCKOWNER);\n}"
  },
  {
    "function_name": "decode_locku",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4879-4889",
    "snippet": "static int decode_locku(struct xdr_stream *xdr, struct nfs_locku_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCKU);\n\tif (status != -EIO)\n\t\tnfs_increment_lock_seqid(status, res->seqid);\n\tif (status == 0)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 4887
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_increment_lock_seqid",
          "args": [
            "status",
            "res->seqid"
          ],
          "line": 4885
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_lock_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1105-1109",
          "snippet": "void nfs_increment_lock_seqid(int status, struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_lock_seqid(int status, struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LOCKU"
          ],
          "line": 4883
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_locku(struct xdr_stream *xdr, struct nfs_locku_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCKU);\n\tif (status != -EIO)\n\t\tnfs_increment_lock_seqid(status, res->seqid);\n\tif (status == 0)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_lockt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4870-4877",
    "snippet": "static int decode_lockt(struct xdr_stream *xdr, struct nfs_lockt_res *res)\n{\n\tint status;\n\tstatus = decode_op_hdr(xdr, OP_LOCKT);\n\tif (status == -NFS4ERR_DENIED)\n\t\treturn decode_lock_denied(xdr, res->denied);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_lock_denied",
          "args": [
            "xdr",
            "res->denied"
          ],
          "line": 4875
        },
        "resolved": true,
        "details": {
          "function_name": "decode_lock_denied",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4818-4848",
          "snippet": "static int decode_lock_denied (struct xdr_stream *xdr, struct file_lock *fl)\n{\n\tuint64_t offset, length, clientid;\n\t__be32 *p;\n\tuint32_t namelen, type;\n\n\tp = xdr_inline_decode(xdr, 32); /* read 32 bytes */\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &offset); /* read 2 8-byte long words */\n\tp = xdr_decode_hyper(p, &length);\n\ttype = be32_to_cpup(p++); /* 4 byte read */\n\tif (fl != NULL) { /* manipulate file lock */\n\t\tfl->fl_start = (loff_t)offset;\n\t\tfl->fl_end = fl->fl_start + (loff_t)length - 1;\n\t\tif (length == ~(uint64_t)0)\n\t\t\tfl->fl_end = OFFSET_MAX;\n\t\tfl->fl_type = F_WRLCK;\n\t\tif (type & 1)\n\t\t\tfl->fl_type = F_RDLCK;\n\t\tfl->fl_pid = 0;\n\t}\n\tp = xdr_decode_hyper(p, &clientid); /* read 8 bytes */\n\tnamelen = be32_to_cpup(p); /* read 4 bytes */  /* have read all 32 bytes now */\n\tp = xdr_inline_decode(xdr, namelen); /* variable size field */\n\tif (likely(p))\n\t\treturn -NFS4ERR_DENIED;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lock_denied (struct xdr_stream *xdr, struct file_lock *fl)\n{\n\tuint64_t offset, length, clientid;\n\t__be32 *p;\n\tuint32_t namelen, type;\n\n\tp = xdr_inline_decode(xdr, 32); /* read 32 bytes */\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &offset); /* read 2 8-byte long words */\n\tp = xdr_decode_hyper(p, &length);\n\ttype = be32_to_cpup(p++); /* 4 byte read */\n\tif (fl != NULL) { /* manipulate file lock */\n\t\tfl->fl_start = (loff_t)offset;\n\t\tfl->fl_end = fl->fl_start + (loff_t)length - 1;\n\t\tif (length == ~(uint64_t)0)\n\t\t\tfl->fl_end = OFFSET_MAX;\n\t\tfl->fl_type = F_WRLCK;\n\t\tif (type & 1)\n\t\t\tfl->fl_type = F_RDLCK;\n\t\tfl->fl_pid = 0;\n\t}\n\tp = xdr_decode_hyper(p, &clientid); /* read 8 bytes */\n\tnamelen = be32_to_cpup(p); /* read 4 bytes */  /* have read all 32 bytes now */\n\tp = xdr_inline_decode(xdr, namelen); /* variable size field */\n\tif (likely(p))\n\t\treturn -NFS4ERR_DENIED;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LOCKT"
          ],
          "line": 4873
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lockt(struct xdr_stream *xdr, struct nfs_lockt_res *res)\n{\n\tint status;\n\tstatus = decode_op_hdr(xdr, OP_LOCKT);\n\tif (status == -NFS4ERR_DENIED)\n\t\treturn decode_lock_denied(xdr, res->denied);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4850-4868",
    "snippet": "static int decode_lock(struct xdr_stream *xdr, struct nfs_lock_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCK);\n\tif (status == -EIO)\n\t\tgoto out;\n\tif (status == 0) {\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\t\tif (unlikely(status))\n\t\t\tgoto out;\n\t} else if (status == -NFS4ERR_DENIED)\n\t\tstatus = decode_lock_denied(xdr, NULL);\n\tif (res->open_seqid != NULL)\n\t\tnfs_increment_open_seqid(status, res->open_seqid);\n\tnfs_increment_lock_seqid(status, res->lock_seqid);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_increment_lock_seqid",
          "args": [
            "status",
            "res->lock_seqid"
          ],
          "line": 4865
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_lock_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1105-1109",
          "snippet": "void nfs_increment_lock_seqid(int status, struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_lock_seqid(int status, struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_increment_open_seqid",
          "args": [
            "status",
            "res->open_seqid"
          ],
          "line": 4864
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_open_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1086-1098",
          "snippet": "void nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_lock_denied",
          "args": [
            "xdr",
            "NULL"
          ],
          "line": 4862
        },
        "resolved": true,
        "details": {
          "function_name": "decode_lock_denied",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4818-4848",
          "snippet": "static int decode_lock_denied (struct xdr_stream *xdr, struct file_lock *fl)\n{\n\tuint64_t offset, length, clientid;\n\t__be32 *p;\n\tuint32_t namelen, type;\n\n\tp = xdr_inline_decode(xdr, 32); /* read 32 bytes */\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &offset); /* read 2 8-byte long words */\n\tp = xdr_decode_hyper(p, &length);\n\ttype = be32_to_cpup(p++); /* 4 byte read */\n\tif (fl != NULL) { /* manipulate file lock */\n\t\tfl->fl_start = (loff_t)offset;\n\t\tfl->fl_end = fl->fl_start + (loff_t)length - 1;\n\t\tif (length == ~(uint64_t)0)\n\t\t\tfl->fl_end = OFFSET_MAX;\n\t\tfl->fl_type = F_WRLCK;\n\t\tif (type & 1)\n\t\t\tfl->fl_type = F_RDLCK;\n\t\tfl->fl_pid = 0;\n\t}\n\tp = xdr_decode_hyper(p, &clientid); /* read 8 bytes */\n\tnamelen = be32_to_cpup(p); /* read 4 bytes */  /* have read all 32 bytes now */\n\tp = xdr_inline_decode(xdr, namelen); /* variable size field */\n\tif (likely(p))\n\t\treturn -NFS4ERR_DENIED;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lock_denied (struct xdr_stream *xdr, struct file_lock *fl)\n{\n\tuint64_t offset, length, clientid;\n\t__be32 *p;\n\tuint32_t namelen, type;\n\n\tp = xdr_inline_decode(xdr, 32); /* read 32 bytes */\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &offset); /* read 2 8-byte long words */\n\tp = xdr_decode_hyper(p, &length);\n\ttype = be32_to_cpup(p++); /* 4 byte read */\n\tif (fl != NULL) { /* manipulate file lock */\n\t\tfl->fl_start = (loff_t)offset;\n\t\tfl->fl_end = fl->fl_start + (loff_t)length - 1;\n\t\tif (length == ~(uint64_t)0)\n\t\t\tfl->fl_end = OFFSET_MAX;\n\t\tfl->fl_type = F_WRLCK;\n\t\tif (type & 1)\n\t\t\tfl->fl_type = F_RDLCK;\n\t\tfl->fl_pid = 0;\n\t}\n\tp = xdr_decode_hyper(p, &clientid); /* read 8 bytes */\n\tnamelen = be32_to_cpup(p); /* read 4 bytes */  /* have read all 32 bytes now */\n\tp = xdr_inline_decode(xdr, namelen); /* variable size field */\n\tif (likely(p))\n\t\treturn -NFS4ERR_DENIED;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status"
          ],
          "line": 4859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 4858
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LOCK"
          ],
          "line": 4854
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lock(struct xdr_stream *xdr, struct nfs_lock_res *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LOCK);\n\tif (status == -EIO)\n\t\tgoto out;\n\tif (status == 0) {\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\t\tif (unlikely(status))\n\t\t\tgoto out;\n\t} else if (status == -NFS4ERR_DENIED)\n\t\tstatus = decode_lock_denied(xdr, NULL);\n\tif (res->open_seqid != NULL)\n\t\tnfs_increment_open_seqid(status, res->open_seqid);\n\tnfs_increment_lock_seqid(status, res->lock_seqid);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "decode_lock_denied",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4818-4848",
    "snippet": "static int decode_lock_denied (struct xdr_stream *xdr, struct file_lock *fl)\n{\n\tuint64_t offset, length, clientid;\n\t__be32 *p;\n\tuint32_t namelen, type;\n\n\tp = xdr_inline_decode(xdr, 32); /* read 32 bytes */\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &offset); /* read 2 8-byte long words */\n\tp = xdr_decode_hyper(p, &length);\n\ttype = be32_to_cpup(p++); /* 4 byte read */\n\tif (fl != NULL) { /* manipulate file lock */\n\t\tfl->fl_start = (loff_t)offset;\n\t\tfl->fl_end = fl->fl_start + (loff_t)length - 1;\n\t\tif (length == ~(uint64_t)0)\n\t\t\tfl->fl_end = OFFSET_MAX;\n\t\tfl->fl_type = F_WRLCK;\n\t\tif (type & 1)\n\t\t\tfl->fl_type = F_RDLCK;\n\t\tfl->fl_pid = 0;\n\t}\n\tp = xdr_decode_hyper(p, &clientid); /* read 8 bytes */\n\tnamelen = be32_to_cpup(p); /* read 4 bytes */  /* have read all 32 bytes now */\n\tp = xdr_inline_decode(xdr, namelen); /* variable size field */\n\tif (likely(p))\n\t\treturn -NFS4ERR_DENIED;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4846
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "p"
          ],
          "line": 4843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "namelen"
          ],
          "line": 4842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&clientid"
          ],
          "line": 4840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&length"
          ],
          "line": 4828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&offset"
          ],
          "line": 4827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "32"
          ],
          "line": 4824
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_lock_denied (struct xdr_stream *xdr, struct file_lock *fl)\n{\n\tuint64_t offset, length, clientid;\n\t__be32 *p;\n\tuint32_t namelen, type;\n\n\tp = xdr_inline_decode(xdr, 32); /* read 32 bytes */\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &offset); /* read 2 8-byte long words */\n\tp = xdr_decode_hyper(p, &length);\n\ttype = be32_to_cpup(p++); /* 4 byte read */\n\tif (fl != NULL) { /* manipulate file lock */\n\t\tfl->fl_start = (loff_t)offset;\n\t\tfl->fl_end = fl->fl_start + (loff_t)length - 1;\n\t\tif (length == ~(uint64_t)0)\n\t\t\tfl->fl_end = OFFSET_MAX;\n\t\tfl->fl_type = F_WRLCK;\n\t\tif (type & 1)\n\t\t\tfl->fl_type = F_RDLCK;\n\t\tfl->fl_pid = 0;\n\t}\n\tp = xdr_decode_hyper(p, &clientid); /* read 8 bytes */\n\tnamelen = be32_to_cpup(p); /* read 4 bytes */  /* have read all 32 bytes now */\n\tp = xdr_inline_decode(xdr, namelen); /* variable size field */\n\tif (likely(p))\n\t\treturn -NFS4ERR_DENIED;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4805-4813",
    "snippet": "static int decode_link(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LINK);\n\tif (status)\n\t\treturn status;\n\treturn decode_change_info(xdr, cinfo);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_change_info",
          "args": [
            "xdr",
            "cinfo"
          ],
          "line": 4812
        },
        "resolved": true,
        "details": {
          "function_name": "decode_change_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4186-4200",
          "snippet": "static int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_LINK"
          ],
          "line": 4809
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_link(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_LINK);\n\tif (status)\n\t\treturn status;\n\treturn decode_change_info(xdr, cinfo);\n}"
  },
  {
    "function_name": "decode_getfh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4775-4803",
    "snippet": "static int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4801
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fh->data",
            "p",
            "len"
          ],
          "line": 4798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 4795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETFH"
          ],
          "line": 4784
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fh",
            "0",
            "sizeof(*fh)"
          ],
          "line": 4782
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfh(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tuint32_t len;\n\tint status;\n\n\t/* Zero handle first to allow comparisons */\n\tmemset(fh, 0, sizeof(*fh));\n\n\tstatus = decode_op_hdr(xdr, OP_GETFH);\n\tif (status)\n\t\treturn status;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tlen = be32_to_cpup(p);\n\tif (len > NFS4_FHSIZE)\n\t\treturn -EIO;\n\tfh->size = len;\n\tp = xdr_inline_decode(xdr, len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tmemcpy(fh->data, p, len);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4734-4773",
    "snippet": "static int decode_fsinfo(struct xdr_stream *xdr, struct nfs_fsinfo *fsinfo)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3];\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tfsinfo->rtmult = fsinfo->wtmult = 512;\t/* ??? */\n\n\tif ((status = decode_attr_lease_time(xdr, bitmap, &fsinfo->lease_time)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxfilesize(xdr, bitmap, &fsinfo->maxfilesize)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxread(xdr, bitmap, &fsinfo->rtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->rtpref = fsinfo->dtpref = fsinfo->rtmax;\n\tif ((status = decode_attr_maxwrite(xdr, bitmap, &fsinfo->wtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->wtpref = fsinfo->wtmax;\n\tstatus = decode_attr_time_delta(xdr, bitmap, &fsinfo->time_delta);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_pnfstype(xdr, bitmap, &fsinfo->layouttype);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_layout_blksize(xdr, bitmap, &fsinfo->blksize);\n\tif (status)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: xdr returned %d!\\n\"",
            "__func__",
            "-status"
          ],
          "line": 4771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_attr_len",
          "args": [
            "xdr",
            "savep",
            "attrlen"
          ],
          "line": 4769
        },
        "resolved": true,
        "details": {
          "function_name": "verify_attr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4169-4184",
          "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_layout_blksize",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->blksize"
          ],
          "line": 4765
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_layout_blksize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4715-4732",
          "snippet": "static int decode_attr_layout_blksize(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t      uint32_t *res)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[2]);\n\t*res = 0;\n\tif (bitmap[2] & FATTR4_WORD2_LAYOUT_BLKSIZE) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p)) {\n\t\t\tprint_overflow_msg(__func__, xdr);\n\t\t\treturn -EIO;\n\t\t}\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[2] &= ~FATTR4_WORD2_LAYOUT_BLKSIZE;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_layout_blksize(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t      uint32_t *res)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[2]);\n\t*res = 0;\n\tif (bitmap[2] & FATTR4_WORD2_LAYOUT_BLKSIZE) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p)) {\n\t\t\tprint_overflow_msg(__func__, xdr);\n\t\t\treturn -EIO;\n\t\t}\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[2] &= ~FATTR4_WORD2_LAYOUT_BLKSIZE;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_pnfstype",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->layouttype"
          ],
          "line": 4762
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_pnfstype",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4696-4710",
          "snippet": "static int decode_attr_pnfstype(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\tuint32_t *layouttype)\n{\n\tint status = 0;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[1]);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_FS_LAYOUT_TYPES - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[1] & FATTR4_WORD1_FS_LAYOUT_TYPES) {\n\t\tstatus = decode_first_pnfs_layout_type(xdr, layouttype);\n\t\tbitmap[1] &= ~FATTR4_WORD1_FS_LAYOUT_TYPES;\n\t} else\n\t\t*layouttype = 0;\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_pnfstype(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\tuint32_t *layouttype)\n{\n\tint status = 0;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[1]);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_FS_LAYOUT_TYPES - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[1] & FATTR4_WORD1_FS_LAYOUT_TYPES) {\n\t\tstatus = decode_first_pnfs_layout_type(xdr, layouttype);\n\t\tbitmap[1] &= ~FATTR4_WORD1_FS_LAYOUT_TYPES;\n\t} else\n\t\t*layouttype = 0;\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_time_delta",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->time_delta"
          ],
          "line": 4759
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4083-4099",
          "snippet": "static int decode_attr_time_delta(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t  struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_DELTA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_DELTA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_DELTA;\n\t}\n\tdprintk(\"%s: time_delta=%ld %ld\\n\", __func__, (long)time->tv_sec,\n\t\t(long)time->tv_nsec);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_delta(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t  struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_DELTA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_DELTA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_DELTA;\n\t}\n\tdprintk(\"%s: time_delta=%ld %ld\\n\", __func__, (long)time->tv_sec,\n\t\t(long)time->tv_nsec);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_maxwrite",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->wtmax"
          ],
          "line": 4756
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_maxwrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3748-3772",
          "snippet": "static int decode_attr_maxwrite(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXWRITE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXWRITE)) {\n\t\tuint64_t maxwrite;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxwrite);\n\t\tif (maxwrite > 0x7FFFFFFF)\n\t\t\tmaxwrite = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxwrite;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXWRITE;\n\t}\n\tdprintk(\"%s: maxwrite=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxwrite(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXWRITE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXWRITE)) {\n\t\tuint64_t maxwrite;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxwrite);\n\t\tif (maxwrite > 0x7FFFFFFF)\n\t\t\tmaxwrite = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxwrite;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXWRITE;\n\t}\n\tdprintk(\"%s: maxwrite=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_maxread",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->rtmax"
          ],
          "line": 4753
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_maxread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3722-3746",
          "snippet": "static int decode_attr_maxread(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXREAD - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXREAD)) {\n\t\tuint64_t maxread;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxread);\n\t\tif (maxread > 0x7FFFFFFF)\n\t\t\tmaxread = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxread;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXREAD;\n\t}\n\tdprintk(\"%s: maxread=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxread(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXREAD - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXREAD)) {\n\t\tuint64_t maxread;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxread);\n\t\tif (maxread > 0x7FFFFFFF)\n\t\t\tmaxread = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxread;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXREAD;\n\t}\n\tdprintk(\"%s: maxread=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_maxfilesize",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->maxfilesize"
          ],
          "line": 4751
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_maxfilesize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3656-3676",
          "snippet": "static int decode_attr_maxfilesize(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXFILESIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXFILESIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXFILESIZE;\n\t}\n\tdprintk(\"%s: maxfilesize=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxfilesize(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXFILESIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXFILESIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXFILESIZE;\n\t}\n\tdprintk(\"%s: maxfilesize=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_lease_time",
          "args": [
            "xdr",
            "bitmap",
            "&fsinfo->lease_time"
          ],
          "line": 4749
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_lease_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3327-3346",
          "snippet": "static int decode_attr_lease_time(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 60;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LEASE_TIME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LEASE_TIME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LEASE_TIME;\n\t}\n\tdprintk(\"%s: file size=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_lease_time(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 60;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LEASE_TIME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LEASE_TIME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LEASE_TIME;\n\t}\n\tdprintk(\"%s: file size=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 4744
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 4742
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR"
          ],
          "line": 4740
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_fsinfo(struct xdr_stream *xdr, struct nfs_fsinfo *fsinfo)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3];\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tfsinfo->rtmult = fsinfo->wtmult = 512;\t/* ??? */\n\n\tif ((status = decode_attr_lease_time(xdr, bitmap, &fsinfo->lease_time)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxfilesize(xdr, bitmap, &fsinfo->maxfilesize)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxread(xdr, bitmap, &fsinfo->rtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->rtpref = fsinfo->dtpref = fsinfo->rtmax;\n\tif ((status = decode_attr_maxwrite(xdr, bitmap, &fsinfo->wtmax)) != 0)\n\t\tgoto xdr_error;\n\tfsinfo->wtpref = fsinfo->wtmax;\n\tstatus = decode_attr_time_delta(xdr, bitmap, &fsinfo->time_delta);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_pnfstype(xdr, bitmap, &fsinfo->layouttype);\n\tif (status != 0)\n\t\tgoto xdr_error;\n\tstatus = decode_attr_layout_blksize(xdr, bitmap, &fsinfo->blksize);\n\tif (status)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_attr_layout_blksize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4715-4732",
    "snippet": "static int decode_attr_layout_blksize(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t      uint32_t *res)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[2]);\n\t*res = 0;\n\tif (bitmap[2] & FATTR4_WORD2_LAYOUT_BLKSIZE) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p)) {\n\t\t\tprint_overflow_msg(__func__, xdr);\n\t\t\treturn -EIO;\n\t\t}\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[2] &= ~FATTR4_WORD2_LAYOUT_BLKSIZE;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4725
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: bitmap is %x\\n\"",
            "__func__",
            "bitmap[2]"
          ],
          "line": 4720
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_layout_blksize(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t      uint32_t *res)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[2]);\n\t*res = 0;\n\tif (bitmap[2] & FATTR4_WORD2_LAYOUT_BLKSIZE) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p)) {\n\t\t\tprint_overflow_msg(__func__, xdr);\n\t\t\treturn -EIO;\n\t\t}\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[2] &= ~FATTR4_WORD2_LAYOUT_BLKSIZE;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "decode_attr_pnfstype",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4696-4710",
    "snippet": "static int decode_attr_pnfstype(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\tuint32_t *layouttype)\n{\n\tint status = 0;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[1]);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_FS_LAYOUT_TYPES - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[1] & FATTR4_WORD1_FS_LAYOUT_TYPES) {\n\t\tstatus = decode_first_pnfs_layout_type(xdr, layouttype);\n\t\tbitmap[1] &= ~FATTR4_WORD1_FS_LAYOUT_TYPES;\n\t} else\n\t\t*layouttype = 0;\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_first_pnfs_layout_type",
          "args": [
            "xdr",
            "layouttype"
          ],
          "line": 4705
        },
        "resolved": true,
        "details": {
          "function_name": "decode_first_pnfs_layout_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4661-4690",
          "snippet": "static int decode_first_pnfs_layout_type(struct xdr_stream *xdr,\n\t\t\t\t\t uint32_t *layouttype)\n{\n\t__be32 *p;\n\tint num;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum = be32_to_cpup(p);\n\n\t/* pNFS is not supported by the underlying file system */\n\tif (num == 0) {\n\t\t*layouttype = 0;\n\t\treturn 0;\n\t}\n\tif (num > 1)\n\t\tprintk(KERN_INFO \"NFS: %s: Warning: Multiple pNFS layout \"\n\t\t\t\"drivers per filesystem not supported\\n\", __func__);\n\n\t/* Decode and set first layout type, move xdr->p past unused types */\n\tp = xdr_inline_decode(xdr, num * 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*layouttype = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_first_pnfs_layout_type(struct xdr_stream *xdr,\n\t\t\t\t\t uint32_t *layouttype)\n{\n\t__be32 *p;\n\tint num;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum = be32_to_cpup(p);\n\n\t/* pNFS is not supported by the underlying file system */\n\tif (num == 0) {\n\t\t*layouttype = 0;\n\t\treturn 0;\n\t}\n\tif (num > 1)\n\t\tprintk(KERN_INFO \"NFS: %s: Warning: Multiple pNFS layout \"\n\t\t\t\"drivers per filesystem not supported\\n\", __func__);\n\n\t/* Decode and set first layout type, move xdr->p past unused types */\n\tp = xdr_inline_decode(xdr, num * 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*layouttype = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_FS_LAYOUT_TYPES - 1U)"
          ],
          "line": 4702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: bitmap is %x\\n\"",
            "__func__",
            "bitmap[1]"
          ],
          "line": 4701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_pnfstype(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\tuint32_t *layouttype)\n{\n\tint status = 0;\n\n\tdprintk(\"%s: bitmap is %x\\n\", __func__, bitmap[1]);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_FS_LAYOUT_TYPES - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[1] & FATTR4_WORD1_FS_LAYOUT_TYPES) {\n\t\tstatus = decode_first_pnfs_layout_type(xdr, layouttype);\n\t\tbitmap[1] &= ~FATTR4_WORD1_FS_LAYOUT_TYPES;\n\t} else\n\t\t*layouttype = 0;\n\treturn status;\n}"
  },
  {
    "function_name": "decode_first_pnfs_layout_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4661-4690",
    "snippet": "static int decode_first_pnfs_layout_type(struct xdr_stream *xdr,\n\t\t\t\t\t uint32_t *layouttype)\n{\n\t__be32 *p;\n\tint num;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum = be32_to_cpup(p);\n\n\t/* pNFS is not supported by the underlying file system */\n\tif (num == 0) {\n\t\t*layouttype = 0;\n\t\treturn 0;\n\t}\n\tif (num > 1)\n\t\tprintk(KERN_INFO \"NFS: %s: Warning: Multiple pNFS layout \"\n\t\t\t\"drivers per filesystem not supported\\n\", __func__);\n\n\t/* Decode and set first layout type, move xdr->p past unused types */\n\tp = xdr_inline_decode(xdr, num * 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*layouttype = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4688
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "num * 4"
          ],
          "line": 4682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"NFS: %s: Warning: Multiple pNFS layout \"\n\t\t\t\"drivers per filesystem not supported\\n\"",
            "__func__"
          ],
          "line": 4678
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_first_pnfs_layout_type(struct xdr_stream *xdr,\n\t\t\t\t\t uint32_t *layouttype)\n{\n\t__be32 *p;\n\tint num;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tnum = be32_to_cpup(p);\n\n\t/* pNFS is not supported by the underlying file system */\n\tif (num == 0) {\n\t\t*layouttype = 0;\n\t\treturn 0;\n\t}\n\tif (num > 1)\n\t\tprintk(KERN_INFO \"NFS: %s: Warning: Multiple pNFS layout \"\n\t\t\t\"drivers per filesystem not supported\\n\", __func__);\n\n\t/* Decode and set first layout type, move xdr->p past unused types */\n\tp = xdr_inline_decode(xdr, num * 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*layouttype = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_getfattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4651-4655",
    "snippet": "static int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_generic",
          "args": [
            "xdr",
            "fattr",
            "NULL",
            "NULL",
            "NULL",
            "server"
          ],
          "line": 4654
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_generic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4613-4643",
          "snippet": "static int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tconst struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, NULL, server);\n}"
  },
  {
    "function_name": "decode_getfattr_label",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4645-4649",
    "snippet": "static int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_getfattr_generic",
          "args": [
            "xdr",
            "fattr",
            "NULL",
            "NULL",
            "label",
            "server"
          ],
          "line": 4648
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_generic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4613-4643",
          "snippet": "static int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_label(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\treturn decode_getfattr_generic(xdr, fattr, NULL, NULL, label, server);\n}"
  },
  {
    "function_name": "decode_getfattr_generic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4613-4643",
    "snippet": "static int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: xdr returned %d\\n\"",
            "__func__",
            "-status"
          ],
          "line": 4641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_attr_len",
          "args": [
            "xdr",
            "savep",
            "attrlen"
          ],
          "line": 4639
        },
        "resolved": true,
        "details": {
          "function_name": "verify_attr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4169-4184",
          "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_getfattr_attrs",
          "args": [
            "xdr",
            "bitmap",
            "fattr",
            "fh",
            "fs_loc",
            "label",
            "server"
          ],
          "line": 4634
        },
        "resolved": true,
        "details": {
          "function_name": "decode_getfattr_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4491-4611",
          "snippet": "static int decode_getfattr_attrs(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tstruct nfs_fattr *fattr, struct nfs_fh *fh,\n\t\tstruct nfs4_fs_locations *fs_loc, struct nfs4_label *label,\n\t\tconst struct nfs_server *server)\n{\n\tint status;\n\tumode_t fmode = 0;\n\tuint32_t type;\n\tint32_t err;\n\n\tstatus = decode_attr_type(xdr, bitmap, &type);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->mode = 0;\n\tif (status != 0) {\n\t\tfattr->mode |= nfs_type2fmt[type];\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_change(xdr, bitmap, &fattr->change_attr);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_size(xdr, bitmap, &fattr->size);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fsid(xdr, bitmap, &fattr->fsid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\terr = 0;\n\tstatus = decode_attr_error(xdr, bitmap, &err);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_filehandle(xdr, bitmap, fh);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_fileid(xdr, bitmap, &fattr->fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fs_locations(xdr, bitmap, fs_loc);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mode(xdr, bitmap, &fmode);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tif (status != 0) {\n\t\tfattr->mode |= fmode;\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_nlink(xdr, bitmap, &fattr->nlink);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_owner(xdr, bitmap, server, &fattr->uid, fattr->owner_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_group(xdr, bitmap, server, &fattr->gid, fattr->group_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_rdev(xdr, bitmap, &fattr->rdev);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_space_used(xdr, bitmap, &fattr->du.nfs3.used);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_access(xdr, bitmap, &fattr->atime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_metadata(xdr, bitmap, &fattr->ctime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_modify(xdr, bitmap, &fattr->mtime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mounted_on_fileid(xdr, bitmap, &fattr->mounted_on_fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mdsthreshold(xdr, bitmap, fattr->mdsthreshold);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tif (label) {\n\t\tstatus = decode_attr_security_label(xdr, bitmap, label);\n\t\tif (status < 0)\n\t\t\tgoto xdr_error;\n\t\tfattr->valid |= status;\n\t}\n\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};\n\nstatic int decode_getfattr_attrs(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tstruct nfs_fattr *fattr, struct nfs_fh *fh,\n\t\tstruct nfs4_fs_locations *fs_loc, struct nfs4_label *label,\n\t\tconst struct nfs_server *server)\n{\n\tint status;\n\tumode_t fmode = 0;\n\tuint32_t type;\n\tint32_t err;\n\n\tstatus = decode_attr_type(xdr, bitmap, &type);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->mode = 0;\n\tif (status != 0) {\n\t\tfattr->mode |= nfs_type2fmt[type];\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_change(xdr, bitmap, &fattr->change_attr);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_size(xdr, bitmap, &fattr->size);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fsid(xdr, bitmap, &fattr->fsid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\terr = 0;\n\tstatus = decode_attr_error(xdr, bitmap, &err);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_filehandle(xdr, bitmap, fh);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_fileid(xdr, bitmap, &fattr->fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fs_locations(xdr, bitmap, fs_loc);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mode(xdr, bitmap, &fmode);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tif (status != 0) {\n\t\tfattr->mode |= fmode;\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_nlink(xdr, bitmap, &fattr->nlink);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_owner(xdr, bitmap, server, &fattr->uid, fattr->owner_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_group(xdr, bitmap, server, &fattr->gid, fattr->group_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_rdev(xdr, bitmap, &fattr->rdev);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_space_used(xdr, bitmap, &fattr->du.nfs3.used);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_access(xdr, bitmap, &fattr->atime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_metadata(xdr, bitmap, &fattr->ctime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_modify(xdr, bitmap, &fattr->mtime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mounted_on_fileid(xdr, bitmap, &fattr->mounted_on_fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mdsthreshold(xdr, bitmap, fattr->mdsthreshold);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tif (label) {\n\t\tstatus = decode_attr_security_label(xdr, bitmap, label);\n\t\tif (status < 0)\n\t\t\tgoto xdr_error;\n\t\tfattr->valid |= status;\n\t}\n\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 4630
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 4626
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR"
          ],
          "line": 4622
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_getfattr_generic(struct xdr_stream *xdr, struct nfs_fattr *fattr,\n\t\tstruct nfs_fh *fh, struct nfs4_fs_locations *fs_loc,\n\t\tstruct nfs4_label *label, const struct nfs_server *server)\n{\n\tunsigned int savep;\n\tuint32_t attrlen,\n\t\t bitmap[3] = {0};\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_GETATTR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_getfattr_attrs(xdr, bitmap, fattr, fh, fs_loc,\n\t\t\t\t\tlabel, server);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_getfattr_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4491-4611",
    "snippet": "static int decode_getfattr_attrs(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tstruct nfs_fattr *fattr, struct nfs_fh *fh,\n\t\tstruct nfs4_fs_locations *fs_loc, struct nfs4_label *label,\n\t\tconst struct nfs_server *server)\n{\n\tint status;\n\tumode_t fmode = 0;\n\tuint32_t type;\n\tint32_t err;\n\n\tstatus = decode_attr_type(xdr, bitmap, &type);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->mode = 0;\n\tif (status != 0) {\n\t\tfattr->mode |= nfs_type2fmt[type];\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_change(xdr, bitmap, &fattr->change_attr);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_size(xdr, bitmap, &fattr->size);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fsid(xdr, bitmap, &fattr->fsid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\terr = 0;\n\tstatus = decode_attr_error(xdr, bitmap, &err);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_filehandle(xdr, bitmap, fh);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_fileid(xdr, bitmap, &fattr->fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fs_locations(xdr, bitmap, fs_loc);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mode(xdr, bitmap, &fmode);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tif (status != 0) {\n\t\tfattr->mode |= fmode;\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_nlink(xdr, bitmap, &fattr->nlink);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_owner(xdr, bitmap, server, &fattr->uid, fattr->owner_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_group(xdr, bitmap, server, &fattr->gid, fattr->group_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_rdev(xdr, bitmap, &fattr->rdev);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_space_used(xdr, bitmap, &fattr->du.nfs3.used);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_access(xdr, bitmap, &fattr->atime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_metadata(xdr, bitmap, &fattr->ctime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_modify(xdr, bitmap, &fattr->mtime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mounted_on_fileid(xdr, bitmap, &fattr->mounted_on_fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mdsthreshold(xdr, bitmap, fattr->mdsthreshold);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tif (label) {\n\t\tstatus = decode_attr_security_label(xdr, bitmap, label);\n\t\tif (status < 0)\n\t\t\tgoto xdr_error;\n\t\tfattr->valid |= status;\n\t}\n\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: xdr returned %d\\n\"",
            "__func__",
            "-status"
          ],
          "line": 4609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_security_label",
          "args": [
            "xdr",
            "bitmap",
            "label"
          ],
          "line": 4602
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_security_label",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4101-4149",
          "snippet": "static int decode_attr_security_label(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n\tuint32_t pi = 0;\n\tuint32_t lfs = 0;\n\t__u32 len;\n\t__be32 *p;\n\tint status = 0;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_SECURITY_LABEL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[2] & FATTR4_WORD2_SECURITY_LABEL)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlfs = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tpi = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (len < NFS4_MAXLABELLEN) {\n\t\t\tif (label) {\n\t\t\t\tmemcpy(label->label, p, len);\n\t\t\t\tlabel->len = len;\n\t\t\t\tlabel->pi = pi;\n\t\t\t\tlabel->lfs = lfs;\n\t\t\t\tstatus = NFS_ATTR_FATTR_V4_SECURITY_LABEL;\n\t\t\t}\n\t\t\tbitmap[2] &= ~FATTR4_WORD2_SECURITY_LABEL;\n\t\t} else\n\t\t\tprintk(KERN_WARNING \"%s: label too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t}\n\tif (label && label->label)\n\t\tdprintk(\"%s: label=%s, len=%d, PI=%d, LFS=%d\\n\", __func__,\n\t\t\t(char *)label->label, label->len, label->pi, label->lfs);\n\treturn status;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_security_label(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n\tuint32_t pi = 0;\n\tuint32_t lfs = 0;\n\t__u32 len;\n\t__be32 *p;\n\tint status = 0;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_SECURITY_LABEL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[2] & FATTR4_WORD2_SECURITY_LABEL)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlfs = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tpi = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (len < NFS4_MAXLABELLEN) {\n\t\t\tif (label) {\n\t\t\t\tmemcpy(label->label, p, len);\n\t\t\t\tlabel->len = len;\n\t\t\t\tlabel->pi = pi;\n\t\t\t\tlabel->lfs = lfs;\n\t\t\t\tstatus = NFS_ATTR_FATTR_V4_SECURITY_LABEL;\n\t\t\t}\n\t\t\tbitmap[2] &= ~FATTR4_WORD2_SECURITY_LABEL;\n\t\t} else\n\t\t\tprintk(KERN_WARNING \"%s: label too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t}\n\tif (label && label->label)\n\t\tdprintk(\"%s: label=%s, len=%d, PI=%d, LFS=%d\\n\", __func__,\n\t\t\t(char *)label->label, label->len, label->pi, label->lfs);\n\treturn status;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_mdsthreshold",
          "args": [
            "xdr",
            "bitmap",
            "fattr->mdsthreshold"
          ],
          "line": 4597
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_mdsthreshold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4457-4489",
          "snippet": "static int decode_attr_mdsthreshold(struct xdr_stream *xdr,\n\t\t\t\t    uint32_t *bitmap,\n\t\t\t\t    struct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\tuint32_t num;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_MDSTHRESHOLD - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[2] & FATTR4_WORD2_MDSTHRESHOLD) {\n\t\t/* Did the server return an unrequested attribute? */\n\t\tif (unlikely(res == NULL))\n\t\t\treturn -EREMOTEIO;\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tnum = be32_to_cpup(p);\n\t\tif (num == 0)\n\t\t\treturn 0;\n\t\tif (num > 1)\n\t\t\tprintk(KERN_INFO \"%s: Warning: Multiple pNFS layout \"\n\t\t\t\t\"drivers per filesystem not supported\\n\",\n\t\t\t\t__func__);\n\n\t\tstatus = decode_first_threshold_item4(xdr, res);\n\t\tbitmap[2] &= ~FATTR4_WORD2_MDSTHRESHOLD;\n\t}\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_mdsthreshold(struct xdr_stream *xdr,\n\t\t\t\t    uint32_t *bitmap,\n\t\t\t\t    struct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\tuint32_t num;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_MDSTHRESHOLD - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[2] & FATTR4_WORD2_MDSTHRESHOLD) {\n\t\t/* Did the server return an unrequested attribute? */\n\t\tif (unlikely(res == NULL))\n\t\t\treturn -EREMOTEIO;\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tnum = be32_to_cpup(p);\n\t\tif (num == 0)\n\t\t\treturn 0;\n\t\tif (num > 1)\n\t\t\tprintk(KERN_INFO \"%s: Warning: Multiple pNFS layout \"\n\t\t\t\t\"drivers per filesystem not supported\\n\",\n\t\t\t\t__func__);\n\n\t\tstatus = decode_first_threshold_item4(xdr, res);\n\t\tbitmap[2] &= ~FATTR4_WORD2_MDSTHRESHOLD;\n\t}\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_mounted_on_fileid",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->mounted_on_fileid"
          ],
          "line": 4592
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_mounted_on_fileid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3443-3464",
          "snippet": "static int decode_attr_mounted_on_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MOUNTED_ON_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MOUNTED_ON_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[1] &= ~FATTR4_WORD1_MOUNTED_ON_FILEID;\n\t\tret = NFS_ATTR_FATTR_MOUNTED_ON_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_mounted_on_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MOUNTED_ON_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MOUNTED_ON_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[1] &= ~FATTR4_WORD1_MOUNTED_ON_FILEID;\n\t\tret = NFS_ATTR_FATTR_MOUNTED_ON_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_time_modify",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->mtime"
          ],
          "line": 4587
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time_modify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4151-4167",
          "snippet": "static int decode_attr_time_modify(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_MODIFY - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_MODIFY)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_MTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_MODIFY;\n\t}\n\tdprintk(\"%s: mtime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_modify(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_MODIFY - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_MODIFY)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_MTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_MODIFY;\n\t}\n\tdprintk(\"%s: mtime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_time_metadata",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->ctime"
          ],
          "line": 4582
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time_metadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4065-4081",
          "snippet": "static int decode_attr_time_metadata(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_METADATA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_METADATA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_CTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_METADATA;\n\t}\n\tdprintk(\"%s: ctime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_metadata(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_METADATA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_METADATA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_CTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_METADATA;\n\t}\n\tdprintk(\"%s: ctime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_time_access",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->atime"
          ],
          "line": 4577
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4047-4063",
          "snippet": "static int decode_attr_time_access(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_ACCESS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_ACCESS)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_ATIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_ACCESS;\n\t}\n\tdprintk(\"%s: atime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_access(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_ACCESS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_ACCESS)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_ATIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_ACCESS;\n\t}\n\tdprintk(\"%s: atime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_space_used",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->du.nfs3.used"
          ],
          "line": 4572
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_space_used",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4004-4026",
          "snippet": "static int decode_attr_space_used(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *used)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*used = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_USED - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_USED)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, used);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_USED;\n\t\tret = NFS_ATTR_FATTR_SPACE_USED;\n\t}\n\tdprintk(\"%s: space used=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*used);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_used(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *used)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*used = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_USED - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_USED)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, used);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_USED;\n\t\tret = NFS_ATTR_FATTR_SPACE_USED;\n\t}\n\tdprintk(\"%s: space used=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*used);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_rdev",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->rdev"
          ],
          "line": 4567
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_rdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3908-3936",
          "snippet": "static int decode_attr_rdev(struct xdr_stream *xdr, uint32_t *bitmap, dev_t *rdev)\n{\n\tuint32_t major = 0, minor = 0;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*rdev = MKDEV(0,0);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_RAWDEV - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_RAWDEV)) {\n\t\tdev_t tmp;\n\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tmajor = be32_to_cpup(p++);\n\t\tminor = be32_to_cpup(p);\n\t\ttmp = MKDEV(major, minor);\n\t\tif (MAJOR(tmp) == major && MINOR(tmp) == minor)\n\t\t\t*rdev = tmp;\n\t\tbitmap[1] &= ~ FATTR4_WORD1_RAWDEV;\n\t\tret = NFS_ATTR_FATTR_RDEV;\n\t}\n\tdprintk(\"%s: rdev=(0x%x:0x%x)\\n\", __func__, major, minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_rdev(struct xdr_stream *xdr, uint32_t *bitmap, dev_t *rdev)\n{\n\tuint32_t major = 0, minor = 0;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*rdev = MKDEV(0,0);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_RAWDEV - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_RAWDEV)) {\n\t\tdev_t tmp;\n\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tmajor = be32_to_cpup(p++);\n\t\tminor = be32_to_cpup(p);\n\t\ttmp = MKDEV(major, minor);\n\t\tif (MAJOR(tmp) == major && MINOR(tmp) == minor)\n\t\t\t*rdev = tmp;\n\t\tbitmap[1] &= ~ FATTR4_WORD1_RAWDEV;\n\t\tret = NFS_ATTR_FATTR_RDEV;\n\t}\n\tdprintk(\"%s: rdev=(0x%x:0x%x)\\n\", __func__, major, minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_group",
          "args": [
            "xdr",
            "bitmap",
            "server",
            "&fattr->gid",
            "fattr->group_name"
          ],
          "line": 4562
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3865-3906",
          "snippet": "static int decode_attr_group(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kgid_t *gid,\n\t\tstruct nfs4_string *group_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*gid = make_kgid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER_GROUP - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER_GROUP)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (group_name != NULL) {\n\t\t\tgroup_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (group_name->data != NULL) {\n\t\t\t\tgroup_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_group_to_gid(server, (char *)p, len, gid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_group_to_gid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER_GROUP;\n\t}\n\tdprintk(\"%s: gid=%d\\n\", __func__, (int)from_kgid(&init_user_ns, *gid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_group(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kgid_t *gid,\n\t\tstruct nfs4_string *group_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*gid = make_kgid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER_GROUP - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER_GROUP)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (group_name != NULL) {\n\t\t\tgroup_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (group_name->data != NULL) {\n\t\t\t\tgroup_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_group_to_gid(server, (char *)p, len, gid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_group_to_gid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER_GROUP;\n\t}\n\tdprintk(\"%s: gid=%d\\n\", __func__, (int)from_kgid(&init_user_ns, *gid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_owner",
          "args": [
            "xdr",
            "bitmap",
            "server",
            "&fattr->uid",
            "fattr->owner_name"
          ],
          "line": 4557
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3822-3863",
          "snippet": "static int decode_attr_owner(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kuid_t *uid,\n\t\tstruct nfs4_string *owner_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*uid = make_kuid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (owner_name != NULL) {\n\t\t\towner_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (owner_name->data != NULL) {\n\t\t\t\towner_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_name_to_uid(server, (char *)p, len, uid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_name_to_uid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER;\n\t}\n\tdprintk(\"%s: uid=%d\\n\", __func__, (int)from_kuid(&init_user_ns, *uid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_owner(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kuid_t *uid,\n\t\tstruct nfs4_string *owner_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*uid = make_kuid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (owner_name != NULL) {\n\t\t\towner_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (owner_name->data != NULL) {\n\t\t\t\towner_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_name_to_uid(server, (char *)p, len, uid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_name_to_uid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER;\n\t}\n\tdprintk(\"%s: uid=%d\\n\", __func__, (int)from_kuid(&init_user_ns, *uid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_nlink",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->nlink"
          ],
          "line": 4552
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_nlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3799-3820",
          "snippet": "static int decode_attr_nlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *nlink)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*nlink = 1;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_NUMLINKS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_NUMLINKS)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*nlink = be32_to_cpup(p);\n\t\tbitmap[1] &= ~FATTR4_WORD1_NUMLINKS;\n\t\tret = NFS_ATTR_FATTR_NLINK;\n\t}\n\tdprintk(\"%s: nlink=%u\\n\", __func__, (unsigned int)*nlink);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_nlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *nlink)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*nlink = 1;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_NUMLINKS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_NUMLINKS)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*nlink = be32_to_cpup(p);\n\t\tbitmap[1] &= ~FATTR4_WORD1_NUMLINKS;\n\t\tret = NFS_ATTR_FATTR_NLINK;\n\t}\n\tdprintk(\"%s: nlink=%u\\n\", __func__, (unsigned int)*nlink);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_mode",
          "args": [
            "xdr",
            "bitmap",
            "&fmode"
          ],
          "line": 4544
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3774-3797",
          "snippet": "static int decode_attr_mode(struct xdr_stream *xdr, uint32_t *bitmap, umode_t *mode)\n{\n\tuint32_t tmp;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*mode = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MODE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MODE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\ttmp = be32_to_cpup(p);\n\t\t*mode = tmp & ~S_IFMT;\n\t\tbitmap[1] &= ~FATTR4_WORD1_MODE;\n\t\tret = NFS_ATTR_FATTR_MODE;\n\t}\n\tdprintk(\"%s: file mode=0%o\\n\", __func__, (unsigned int)*mode);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_mode(struct xdr_stream *xdr, uint32_t *bitmap, umode_t *mode)\n{\n\tuint32_t tmp;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*mode = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MODE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MODE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\ttmp = be32_to_cpup(p);\n\t\t*mode = tmp & ~S_IFMT;\n\t\tbitmap[1] &= ~FATTR4_WORD1_MODE;\n\t\tret = NFS_ATTR_FATTR_MODE;\n\t}\n\tdprintk(\"%s: file mode=0%o\\n\", __func__, (unsigned int)*mode);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_fs_locations",
          "args": [
            "xdr",
            "bitmap",
            "fs_loc"
          ],
          "line": 4539
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_fs_locations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3577-3654",
          "snippet": "static int decode_attr_fs_locations(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs4_fs_locations *res)\n{\n\tint n;\n\t__be32 *p;\n\tint status = -EIO;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FS_LOCATIONS -1U)))\n\t\tgoto out;\n\tstatus = 0;\n\tif (unlikely(!(bitmap[0] & FATTR4_WORD0_FS_LOCATIONS)))\n\t\tgoto out;\n\tstatus = -EIO;\n\t/* Ignore borken servers that return unrequested attrs */\n\tif (unlikely(res == NULL))\n\t\tgoto out;\n\tdprintk(\"%s: fsroot:\\n\", __func__);\n\tstatus = decode_pathname(xdr, &res->fs_path);\n\tif (unlikely(status != 0))\n\t\tgoto out;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n <= 0)\n\t\tgoto out_eio;\n\tfor (res->nlocations = 0; res->nlocations < n; res->nlocations++) {\n\t\tu32 m;\n\t\tstruct nfs4_fs_location *loc;\n\n\t\tif (res->nlocations == NFS4_FS_LOCATIONS_MAXENTRIES)\n\t\t\tbreak;\n\t\tloc = &res->locations[res->nlocations];\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tm = be32_to_cpup(p);\n\n\t\tdprintk(\"%s: servers:\\n\", __func__);\n\t\tfor (loc->nservers = 0; loc->nservers < m; loc->nservers++) {\n\t\t\tstruct nfs4_string *server;\n\n\t\t\tif (loc->nservers == NFS4_FS_LOCATION_MAXSERVERS) {\n\t\t\t\tunsigned int i;\n\t\t\t\tdprintk(\"%s: using first %u of %u servers \"\n\t\t\t\t\t\"returned for location %u\\n\",\n\t\t\t\t\t\t__func__,\n\t\t\t\t\t\tNFS4_FS_LOCATION_MAXSERVERS,\n\t\t\t\t\t\tm, res->nlocations);\n\t\t\t\tfor (i = loc->nservers; i < m; i++) {\n\t\t\t\t\tunsigned int len;\n\t\t\t\t\tchar *data;\n\t\t\t\t\tstatus = decode_opaque_inline(xdr, &len, &data);\n\t\t\t\t\tif (unlikely(status != 0))\n\t\t\t\t\t\tgoto out_eio;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tserver = &loc->servers[loc->nservers];\n\t\t\tstatus = decode_opaque_inline(xdr, &server->len, &server->data);\n\t\t\tif (unlikely(status != 0))\n\t\t\t\tgoto out_eio;\n\t\t\tdprintk(\"%s \", server->data);\n\t\t}\n\t\tstatus = decode_pathname(xdr, &loc->rootpath);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t}\n\tif (res->nlocations != 0)\n\t\tstatus = NFS_ATTR_FATTR_V4_LOCATIONS;\nout:\n\tdprintk(\"%s: fs_locations done, error = %d\\n\", __func__, status);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout_eio:\n\tstatus = -EIO;\n\tgoto out;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fs_locations(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs4_fs_locations *res)\n{\n\tint n;\n\t__be32 *p;\n\tint status = -EIO;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FS_LOCATIONS -1U)))\n\t\tgoto out;\n\tstatus = 0;\n\tif (unlikely(!(bitmap[0] & FATTR4_WORD0_FS_LOCATIONS)))\n\t\tgoto out;\n\tstatus = -EIO;\n\t/* Ignore borken servers that return unrequested attrs */\n\tif (unlikely(res == NULL))\n\t\tgoto out;\n\tdprintk(\"%s: fsroot:\\n\", __func__);\n\tstatus = decode_pathname(xdr, &res->fs_path);\n\tif (unlikely(status != 0))\n\t\tgoto out;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n <= 0)\n\t\tgoto out_eio;\n\tfor (res->nlocations = 0; res->nlocations < n; res->nlocations++) {\n\t\tu32 m;\n\t\tstruct nfs4_fs_location *loc;\n\n\t\tif (res->nlocations == NFS4_FS_LOCATIONS_MAXENTRIES)\n\t\t\tbreak;\n\t\tloc = &res->locations[res->nlocations];\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tm = be32_to_cpup(p);\n\n\t\tdprintk(\"%s: servers:\\n\", __func__);\n\t\tfor (loc->nservers = 0; loc->nservers < m; loc->nservers++) {\n\t\t\tstruct nfs4_string *server;\n\n\t\t\tif (loc->nservers == NFS4_FS_LOCATION_MAXSERVERS) {\n\t\t\t\tunsigned int i;\n\t\t\t\tdprintk(\"%s: using first %u of %u servers \"\n\t\t\t\t\t\"returned for location %u\\n\",\n\t\t\t\t\t\t__func__,\n\t\t\t\t\t\tNFS4_FS_LOCATION_MAXSERVERS,\n\t\t\t\t\t\tm, res->nlocations);\n\t\t\t\tfor (i = loc->nservers; i < m; i++) {\n\t\t\t\t\tunsigned int len;\n\t\t\t\t\tchar *data;\n\t\t\t\t\tstatus = decode_opaque_inline(xdr, &len, &data);\n\t\t\t\t\tif (unlikely(status != 0))\n\t\t\t\t\t\tgoto out_eio;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tserver = &loc->servers[loc->nservers];\n\t\t\tstatus = decode_opaque_inline(xdr, &server->len, &server->data);\n\t\t\tif (unlikely(status != 0))\n\t\t\t\tgoto out_eio;\n\t\t\tdprintk(\"%s \", server->data);\n\t\t}\n\t\tstatus = decode_pathname(xdr, &loc->rootpath);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t}\n\tif (res->nlocations != 0)\n\t\tstatus = NFS_ATTR_FATTR_V4_LOCATIONS;\nout:\n\tdprintk(\"%s: fs_locations done, error = %d\\n\", __func__, status);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout_eio:\n\tstatus = -EIO;\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_fileid",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->fileid"
          ],
          "line": 4534
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_fileid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3420-3441",
          "snippet": "static int decode_attr_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEID;\n\t\tret = NFS_ATTR_FATTR_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEID;\n\t\tret = NFS_ATTR_FATTR_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_filehandle",
          "args": [
            "xdr",
            "bitmap",
            "fh"
          ],
          "line": 4530
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_filehandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3367-3397",
          "snippet": "static int decode_attr_filehandle(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tint len;\n\n\tif (fh != NULL)\n\t\tmemset(fh, 0, sizeof(*fh));\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEHANDLE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEHANDLE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tif (len > NFS4_FHSIZE)\n\t\t\treturn -EIO;\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (fh != NULL) {\n\t\t\tmemcpy(fh->data, p, len);\n\t\t\tfh->size = len;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEHANDLE;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_filehandle(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tint len;\n\n\tif (fh != NULL)\n\t\tmemset(fh, 0, sizeof(*fh));\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEHANDLE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEHANDLE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tif (len > NFS4_FHSIZE)\n\t\t\treturn -EIO;\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (fh != NULL) {\n\t\t\tmemcpy(fh->data, p, len);\n\t\t\tfh->size = len;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEHANDLE;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_error",
          "args": [
            "xdr",
            "bitmap",
            "&err"
          ],
          "line": 4526
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3348-3365",
          "snippet": "static int decode_attr_error(struct xdr_stream *xdr, uint32_t *bitmap, int32_t *res)\n{\n\t__be32 *p;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_RDATTR_ERROR - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_RDATTR_ERROR)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tbitmap[0] &= ~FATTR4_WORD0_RDATTR_ERROR;\n\t\t*res = -be32_to_cpup(p);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_error(struct xdr_stream *xdr, uint32_t *bitmap, int32_t *res)\n{\n\t__be32 *p;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_RDATTR_ERROR - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_RDATTR_ERROR)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tbitmap[0] &= ~FATTR4_WORD0_RDATTR_ERROR;\n\t\t*res = -be32_to_cpup(p);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_fsid",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->fsid"
          ],
          "line": 4520
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_fsid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3300-3325",
          "snippet": "static int decode_attr_fsid(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fsid *fsid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\tfsid->major = 0;\n\tfsid->minor = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FSID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FSID)) {\n\t\tp = xdr_inline_decode(xdr, 16);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &fsid->major);\n\t\txdr_decode_hyper(p, &fsid->minor);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FSID;\n\t\tret = NFS_ATTR_FATTR_FSID;\n\t}\n\tdprintk(\"%s: fsid=(0x%Lx/0x%Lx)\\n\", __func__,\n\t\t\t(unsigned long long)fsid->major,\n\t\t\t(unsigned long long)fsid->minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fsid(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fsid *fsid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\tfsid->major = 0;\n\tfsid->minor = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FSID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FSID)) {\n\t\tp = xdr_inline_decode(xdr, 16);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &fsid->major);\n\t\txdr_decode_hyper(p, &fsid->minor);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FSID;\n\t\tret = NFS_ATTR_FATTR_FSID;\n\t}\n\tdprintk(\"%s: fsid=(0x%Lx/0x%Lx)\\n\", __func__,\n\t\t\t(unsigned long long)fsid->major,\n\t\t\t(unsigned long long)fsid->minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_size",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->size"
          ],
          "line": 4515
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3235-3256",
          "snippet": "static int decode_attr_size(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *size)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*size = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, size);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SIZE;\n\t\tret = NFS_ATTR_FATTR_SIZE;\n\t}\n\tdprintk(\"%s: file size=%Lu\\n\", __func__, (unsigned long long)*size);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_size(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *size)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*size = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, size);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SIZE;\n\t\tret = NFS_ATTR_FATTR_SIZE;\n\t}\n\tdprintk(\"%s: file size=%Lu\\n\", __func__, (unsigned long long)*size);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_change",
          "args": [
            "xdr",
            "bitmap",
            "&fattr->change_attr"
          ],
          "line": 4510
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_change",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3211-3233",
          "snippet": "static int decode_attr_change(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *change)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*change = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_CHANGE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_CHANGE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, change);\n\t\tbitmap[0] &= ~FATTR4_WORD0_CHANGE;\n\t\tret = NFS_ATTR_FATTR_CHANGE;\n\t}\n\tdprintk(\"%s: change attribute=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*change);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_change(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *change)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*change = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_CHANGE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_CHANGE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, change);\n\t\tbitmap[0] &= ~FATTR4_WORD0_CHANGE;\n\t\tret = NFS_ATTR_FATTR_CHANGE;\n\t}\n\tdprintk(\"%s: change attribute=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*change);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_type",
          "args": [
            "xdr",
            "bitmap",
            "&type"
          ],
          "line": 4501
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3162-3187",
          "snippet": "static int decode_attr_type(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tif (*type < NF4REG || *type > NF4NAMEDATTR) {\n\t\t\tdprintk(\"%s: bad type %d\\n\", __func__, *type);\n\t\t\treturn -EIO;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_TYPE;\n\t\tret = NFS_ATTR_FATTR_TYPE;\n\t}\n\tdprintk(\"%s: type=0%o\\n\", __func__, nfs_type2fmt[*type]);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};\n\nstatic int decode_attr_type(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tif (*type < NF4REG || *type > NF4NAMEDATTR) {\n\t\t\tdprintk(\"%s: bad type %d\\n\", __func__, *type);\n\t\t\treturn -EIO;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_TYPE;\n\t\tret = NFS_ATTR_FATTR_TYPE;\n\t}\n\tdprintk(\"%s: type=0%o\\n\", __func__, nfs_type2fmt[*type]);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};\n\nstatic int decode_getfattr_attrs(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tstruct nfs_fattr *fattr, struct nfs_fh *fh,\n\t\tstruct nfs4_fs_locations *fs_loc, struct nfs4_label *label,\n\t\tconst struct nfs_server *server)\n{\n\tint status;\n\tumode_t fmode = 0;\n\tuint32_t type;\n\tint32_t err;\n\n\tstatus = decode_attr_type(xdr, bitmap, &type);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->mode = 0;\n\tif (status != 0) {\n\t\tfattr->mode |= nfs_type2fmt[type];\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_change(xdr, bitmap, &fattr->change_attr);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_size(xdr, bitmap, &fattr->size);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fsid(xdr, bitmap, &fattr->fsid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\terr = 0;\n\tstatus = decode_attr_error(xdr, bitmap, &err);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_filehandle(xdr, bitmap, fh);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = decode_attr_fileid(xdr, bitmap, &fattr->fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_fs_locations(xdr, bitmap, fs_loc);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mode(xdr, bitmap, &fmode);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tif (status != 0) {\n\t\tfattr->mode |= fmode;\n\t\tfattr->valid |= status;\n\t}\n\n\tstatus = decode_attr_nlink(xdr, bitmap, &fattr->nlink);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_owner(xdr, bitmap, server, &fattr->uid, fattr->owner_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_group(xdr, bitmap, server, &fattr->gid, fattr->group_name);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_rdev(xdr, bitmap, &fattr->rdev);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_space_used(xdr, bitmap, &fattr->du.nfs3.used);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_access(xdr, bitmap, &fattr->atime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_metadata(xdr, bitmap, &fattr->ctime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_time_modify(xdr, bitmap, &fattr->mtime);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mounted_on_fileid(xdr, bitmap, &fattr->mounted_on_fileid);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tfattr->valid |= status;\n\n\tstatus = decode_attr_mdsthreshold(xdr, bitmap, fattr->mdsthreshold);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tif (label) {\n\t\tstatus = decode_attr_security_label(xdr, bitmap, label);\n\t\tif (status < 0)\n\t\t\tgoto xdr_error;\n\t\tfattr->valid |= status;\n\t}\n\nxdr_error:\n\tdprintk(\"%s: xdr returned %d\\n\", __func__, -status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_attr_mdsthreshold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4457-4489",
    "snippet": "static int decode_attr_mdsthreshold(struct xdr_stream *xdr,\n\t\t\t\t    uint32_t *bitmap,\n\t\t\t\t    struct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\tuint32_t num;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_MDSTHRESHOLD - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[2] & FATTR4_WORD2_MDSTHRESHOLD) {\n\t\t/* Did the server return an unrequested attribute? */\n\t\tif (unlikely(res == NULL))\n\t\t\treturn -EREMOTEIO;\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tnum = be32_to_cpup(p);\n\t\tif (num == 0)\n\t\t\treturn 0;\n\t\tif (num > 1)\n\t\t\tprintk(KERN_INFO \"%s: Warning: Multiple pNFS layout \"\n\t\t\t\t\"drivers per filesystem not supported\\n\",\n\t\t\t\t__func__);\n\n\t\tstatus = decode_first_threshold_item4(xdr, res);\n\t\tbitmap[2] &= ~FATTR4_WORD2_MDSTHRESHOLD;\n\t}\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4487
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_first_threshold_item4",
          "args": [
            "xdr",
            "res"
          ],
          "line": 4482
        },
        "resolved": true,
        "details": {
          "function_name": "decode_first_threshold_item4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4402-4452",
          "snippet": "static int decode_first_threshold_item4(struct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tunsigned int savep;\n\tuint32_t bitmap[3] = {0,}, attrlen;\n\tint status;\n\n\t/* layout type */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p)) {\n\t\tprint_overflow_msg(__func__, xdr);\n\t\treturn -EIO;\n\t}\n\tres->l_type = be32_to_cpup(p);\n\n\t/* thi_hintset bitmap */\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\t/* thi_hintlist length */\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\t/* thi_hintlist */\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_sz, THRESHOLD_RD);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_sz, THRESHOLD_WR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_io_sz,\n\t\t\t\t       THRESHOLD_RD_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_io_sz,\n\t\t\t\t       THRESHOLD_WR_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\n\tres->bm = bitmap[0];\n\n\tdprintk(\"%s bm=0x%x rd_sz=%llu wr_sz=%llu rd_io=%llu wr_io=%llu\\n\",\n\t\t __func__, res->bm, res->rd_sz, res->wr_sz, res->rd_io_sz,\n\t\tres->wr_io_sz);\nxdr_error:\n\tdprintk(\"%s ret=%d!\\n\", __func__, status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_first_threshold_item4(struct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tunsigned int savep;\n\tuint32_t bitmap[3] = {0,}, attrlen;\n\tint status;\n\n\t/* layout type */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p)) {\n\t\tprint_overflow_msg(__func__, xdr);\n\t\treturn -EIO;\n\t}\n\tres->l_type = be32_to_cpup(p);\n\n\t/* thi_hintset bitmap */\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\t/* thi_hintlist length */\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\t/* thi_hintlist */\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_sz, THRESHOLD_RD);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_sz, THRESHOLD_WR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_io_sz,\n\t\t\t\t       THRESHOLD_RD_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_io_sz,\n\t\t\t\t       THRESHOLD_WR_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\n\tres->bm = bitmap[0];\n\n\tdprintk(\"%s bm=0x%x rd_sz=%llu wr_sz=%llu rd_io=%llu wr_io=%llu\\n\",\n\t\t __func__, res->bm, res->rd_sz, res->wr_sz, res->rd_io_sz,\n\t\tres->wr_io_sz);\nxdr_error:\n\tdprintk(\"%s ret=%d!\\n\", __func__, status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"%s: Warning: Multiple pNFS layout \"\n\t\t\t\t\"drivers per filesystem not supported\\n\"",
            "__func__"
          ],
          "line": 4478
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "res == NULL"
          ],
          "line": 4469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[2] & (FATTR4_WORD2_MDSTHRESHOLD - 1U)"
          ],
          "line": 4465
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_mdsthreshold(struct xdr_stream *xdr,\n\t\t\t\t    uint32_t *bitmap,\n\t\t\t\t    struct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\tuint32_t num;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_MDSTHRESHOLD - 1U)))\n\t\treturn -EIO;\n\tif (bitmap[2] & FATTR4_WORD2_MDSTHRESHOLD) {\n\t\t/* Did the server return an unrequested attribute? */\n\t\tif (unlikely(res == NULL))\n\t\t\treturn -EREMOTEIO;\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tnum = be32_to_cpup(p);\n\t\tif (num == 0)\n\t\t\treturn 0;\n\t\tif (num > 1)\n\t\t\tprintk(KERN_INFO \"%s: Warning: Multiple pNFS layout \"\n\t\t\t\t\"drivers per filesystem not supported\\n\",\n\t\t\t\t__func__);\n\n\t\tstatus = decode_first_threshold_item4(xdr, res);\n\t\tbitmap[2] &= ~FATTR4_WORD2_MDSTHRESHOLD;\n\t}\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_first_threshold_item4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4402-4452",
    "snippet": "static int decode_first_threshold_item4(struct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tunsigned int savep;\n\tuint32_t bitmap[3] = {0,}, attrlen;\n\tint status;\n\n\t/* layout type */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p)) {\n\t\tprint_overflow_msg(__func__, xdr);\n\t\treturn -EIO;\n\t}\n\tres->l_type = be32_to_cpup(p);\n\n\t/* thi_hintset bitmap */\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\t/* thi_hintlist length */\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\t/* thi_hintlist */\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_sz, THRESHOLD_RD);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_sz, THRESHOLD_WR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_io_sz,\n\t\t\t\t       THRESHOLD_RD_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_io_sz,\n\t\t\t\t       THRESHOLD_WR_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\n\tres->bm = bitmap[0];\n\n\tdprintk(\"%s bm=0x%x rd_sz=%llu wr_sz=%llu rd_io=%llu wr_io=%llu\\n\",\n\t\t __func__, res->bm, res->rd_sz, res->wr_sz, res->rd_io_sz,\n\t\tres->wr_io_sz);\nxdr_error:\n\tdprintk(\"%s ret=%d!\\n\", __func__, status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s ret=%d!\\n\"",
            "__func__",
            "status"
          ],
          "line": 4450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s bm=0x%x rd_sz=%llu wr_sz=%llu rd_io=%llu wr_io=%llu\\n\"",
            "__func__",
            "res->bm",
            "res->rd_sz",
            "res->wr_sz",
            "res->rd_io_sz",
            "res->wr_io_sz"
          ],
          "line": 4446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_attr_len",
          "args": [
            "xdr",
            "savep",
            "attrlen"
          ],
          "line": 4443
        },
        "resolved": true,
        "details": {
          "function_name": "verify_attr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4169-4184",
          "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_threshold_hint",
          "args": [
            "xdr",
            "bitmap",
            "&res->wr_io_sz",
            "THRESHOLD_WR_IO"
          ],
          "line": 4438
        },
        "resolved": true,
        "details": {
          "function_name": "decode_threshold_hint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4382-4400",
          "snippet": "static int decode_threshold_hint(struct xdr_stream *xdr,\n\t\t\t\t  uint32_t *bitmap,\n\t\t\t\t  uint64_t *res,\n\t\t\t\t  uint32_t hint_bit)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (likely(bitmap[0] & hint_bit)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_threshold_hint(struct xdr_stream *xdr,\n\t\t\t\t  uint32_t *bitmap,\n\t\t\t\t  uint64_t *res,\n\t\t\t\t  uint32_t hint_bit)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (likely(bitmap[0] & hint_bit)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 4424
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 4419
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4413
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_first_threshold_item4(struct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_threshold *res)\n{\n\t__be32 *p;\n\tunsigned int savep;\n\tuint32_t bitmap[3] = {0,}, attrlen;\n\tint status;\n\n\t/* layout type */\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p)) {\n\t\tprint_overflow_msg(__func__, xdr);\n\t\treturn -EIO;\n\t}\n\tres->l_type = be32_to_cpup(p);\n\n\t/* thi_hintset bitmap */\n\tstatus = decode_attr_bitmap(xdr, bitmap);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\t/* thi_hintlist length */\n\tstatus = decode_attr_length(xdr, &attrlen, &savep);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\t/* thi_hintlist */\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_sz, THRESHOLD_RD);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_sz, THRESHOLD_WR);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->rd_io_sz,\n\t\t\t\t       THRESHOLD_RD_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\tstatus = decode_threshold_hint(xdr, bitmap, &res->wr_io_sz,\n\t\t\t\t       THRESHOLD_WR_IO);\n\tif (status < 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\n\tres->bm = bitmap[0];\n\n\tdprintk(\"%s bm=0x%x rd_sz=%llu wr_sz=%llu rd_io=%llu wr_io=%llu\\n\",\n\t\t __func__, res->bm, res->rd_sz, res->wr_sz, res->rd_io_sz,\n\t\tres->wr_io_sz);\nxdr_error:\n\tdprintk(\"%s ret=%d!\\n\", __func__, status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_threshold_hint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4382-4400",
    "snippet": "static int decode_threshold_hint(struct xdr_stream *xdr,\n\t\t\t\t  uint32_t *bitmap,\n\t\t\t\t  uint64_t *res,\n\t\t\t\t  uint32_t hint_bit)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (likely(bitmap[0] & hint_bit)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4398
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 4394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 4391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & hint_bit"
          ],
          "line": 4390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_threshold_hint(struct xdr_stream *xdr,\n\t\t\t\t  uint32_t *bitmap,\n\t\t\t\t  uint64_t *res,\n\t\t\t\t  uint32_t hint_bit)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (likely(bitmap[0] & hint_bit)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_pathconf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4358-4380",
    "snippet": "static int decode_pathconf(struct xdr_stream *xdr, struct nfs_pathconf *pathconf)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_maxlink(xdr, bitmap, &pathconf->max_link)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxname(xdr, bitmap, &pathconf->max_namelen)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: xdr returned %d!\\n\"",
            "__func__",
            "-status"
          ],
          "line": 4378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_attr_len",
          "args": [
            "xdr",
            "savep",
            "attrlen"
          ],
          "line": 4376
        },
        "resolved": true,
        "details": {
          "function_name": "verify_attr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4169-4184",
          "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_maxname",
          "args": [
            "xdr",
            "bitmap",
            "&pathconf->max_namelen"
          ],
          "line": 4373
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_maxname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3700-3720",
          "snippet": "static int decode_attr_maxname(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxname)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxname = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXNAME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXNAME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxname = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXNAME;\n\t}\n\tdprintk(\"%s: maxname=%u\\n\", __func__, *maxname);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxname(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxname)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxname = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXNAME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXNAME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxname = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXNAME;\n\t}\n\tdprintk(\"%s: maxname=%u\\n\", __func__, *maxname);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_maxlink",
          "args": [
            "xdr",
            "bitmap",
            "&pathconf->max_link"
          ],
          "line": 4371
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_maxlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3678-3698",
          "snippet": "static int decode_attr_maxlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxlink)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxlink = 1;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXLINK - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXLINK)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxlink = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXLINK;\n\t}\n\tdprintk(\"%s: maxlink=%u\\n\", __func__, *maxlink);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxlink)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxlink = 1;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXLINK - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXLINK)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxlink = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXLINK;\n\t}\n\tdprintk(\"%s: maxlink=%u\\n\", __func__, *maxlink);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 4368
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 4366
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR"
          ],
          "line": 4364
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_pathconf(struct xdr_stream *xdr, struct nfs_pathconf *pathconf)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_maxlink(xdr, bitmap, &pathconf->max_link)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_maxname(xdr, bitmap, &pathconf->max_namelen)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4326-4356",
    "snippet": "static int decode_statfs(struct xdr_stream *xdr, struct nfs_fsstat *fsstat)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_files_avail(xdr, bitmap, &fsstat->afiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_free(xdr, bitmap, &fsstat->ffiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_total(xdr, bitmap, &fsstat->tfiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_avail(xdr, bitmap, &fsstat->abytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_free(xdr, bitmap, &fsstat->fbytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_total(xdr, bitmap, &fsstat->tbytes)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: xdr returned %d!\\n\"",
            "__func__",
            "-status"
          ],
          "line": 4354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_attr_len",
          "args": [
            "xdr",
            "savep",
            "attrlen"
          ],
          "line": 4352
        },
        "resolved": true,
        "details": {
          "function_name": "verify_attr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4169-4184",
          "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_space_total",
          "args": [
            "xdr",
            "bitmap",
            "&fsstat->tbytes"
          ],
          "line": 4349
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_space_total",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3982-4002",
          "snippet": "static int decode_attr_space_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_TOTAL;\n\t}\n\tdprintk(\"%s: space total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_TOTAL;\n\t}\n\tdprintk(\"%s: space total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_space_free",
          "args": [
            "xdr",
            "bitmap",
            "&fsstat->fbytes"
          ],
          "line": 4347
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_space_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3960-3980",
          "snippet": "static int decode_attr_space_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_FREE;\n\t}\n\tdprintk(\"%s: space free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_FREE;\n\t}\n\tdprintk(\"%s: space free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_space_avail",
          "args": [
            "xdr",
            "bitmap",
            "&fsstat->abytes"
          ],
          "line": 4345
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_space_avail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3938-3958",
          "snippet": "static int decode_attr_space_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_AVAIL;\n\t}\n\tdprintk(\"%s: space avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_AVAIL;\n\t}\n\tdprintk(\"%s: space avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_files_total",
          "args": [
            "xdr",
            "bitmap",
            "&fsstat->tfiles"
          ],
          "line": 4343
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_files_total",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3510-3530",
          "snippet": "static int decode_attr_files_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_TOTAL;\n\t}\n\tdprintk(\"%s: files total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_files_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_TOTAL;\n\t}\n\tdprintk(\"%s: files total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_files_free",
          "args": [
            "xdr",
            "bitmap",
            "&fsstat->ffiles"
          ],
          "line": 4341
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_files_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3488-3508",
          "snippet": "static int decode_attr_files_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_FREE;\n\t}\n\tdprintk(\"%s: files free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_files_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_FREE;\n\t}\n\tdprintk(\"%s: files free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_files_avail",
          "args": [
            "xdr",
            "bitmap",
            "&fsstat->afiles"
          ],
          "line": 4339
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_files_avail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3466-3486",
          "snippet": "static int decode_attr_files_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_AVAIL;\n\t}\n\tdprintk(\"%s: files avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_files_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_AVAIL;\n\t}\n\tdprintk(\"%s: files avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 4336
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 4334
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR"
          ],
          "line": 4332
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_statfs(struct xdr_stream *xdr, struct nfs_fsstat *fsstat)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\n\tif ((status = decode_attr_files_avail(xdr, bitmap, &fsstat->afiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_free(xdr, bitmap, &fsstat->ffiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_files_total(xdr, bitmap, &fsstat->tfiles)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_avail(xdr, bitmap, &fsstat->abytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_free(xdr, bitmap, &fsstat->fbytes)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_space_total(xdr, bitmap, &fsstat->tbytes)) != 0)\n\t\tgoto xdr_error;\n\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_server_caps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4297-4324",
    "snippet": "static int decode_server_caps(struct xdr_stream *xdr, struct nfs4_server_caps_res *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_supported(xdr, bitmap, res->attr_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_fh_expire_type(xdr, bitmap,\n\t\t\t\t\t\t &res->fh_expire_type)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_link_support(xdr, bitmap, &res->has_links)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_symlink_support(xdr, bitmap, &res->has_symlinks)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_aclsupport(xdr, bitmap, &res->acl_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: xdr returned %d!\\n\"",
            "__func__",
            "-status"
          ],
          "line": 4322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_attr_len",
          "args": [
            "xdr",
            "savep",
            "attrlen"
          ],
          "line": 4320
        },
        "resolved": true,
        "details": {
          "function_name": "verify_attr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4169-4184",
          "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_aclsupport",
          "args": [
            "xdr",
            "bitmap",
            "&res->acl_bitmask"
          ],
          "line": 4318
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_aclsupport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3399-3418",
          "snippet": "static int decode_attr_aclsupport(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACLSUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACLSUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_ACLSUPPORT;\n\t}\n\tdprintk(\"%s: ACLs supported=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_aclsupport(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACLSUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACLSUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_ACLSUPPORT;\n\t}\n\tdprintk(\"%s: ACLs supported=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_symlink_support",
          "args": [
            "xdr",
            "bitmap",
            "&res->has_symlinks"
          ],
          "line": 4316
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_symlink_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3279-3298",
          "snippet": "static int decode_attr_symlink_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SYMLINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SYMLINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SYMLINK_SUPPORT;\n\t}\n\tdprintk(\"%s: symlink support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_symlink_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SYMLINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SYMLINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SYMLINK_SUPPORT;\n\t}\n\tdprintk(\"%s: symlink support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_link_support",
          "args": [
            "xdr",
            "bitmap",
            "&res->has_links"
          ],
          "line": 4314
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_link_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3258-3277",
          "snippet": "static int decode_attr_link_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LINK_SUPPORT;\n\t}\n\tdprintk(\"%s: link support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_link_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LINK_SUPPORT;\n\t}\n\tdprintk(\"%s: link support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_fh_expire_type",
          "args": [
            "xdr",
            "bitmap",
            "&res->fh_expire_type"
          ],
          "line": 4311
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_fh_expire_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3189-3209",
          "snippet": "static int decode_attr_fh_expire_type(struct xdr_stream *xdr,\n\t\t\t\t      uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FH_EXPIRE_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FH_EXPIRE_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FH_EXPIRE_TYPE;\n\t}\n\tdprintk(\"%s: expire type=0x%x\\n\", __func__, *type);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fh_expire_type(struct xdr_stream *xdr,\n\t\t\t\t      uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FH_EXPIRE_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FH_EXPIRE_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FH_EXPIRE_TYPE;\n\t}\n\tdprintk(\"%s: expire type=0x%x\\n\", __func__, *type);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_supported",
          "args": [
            "xdr",
            "bitmap",
            "res->attr_bitmask"
          ],
          "line": 4309
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_supported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3147-3160",
          "snippet": "static int decode_attr_supported(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *bitmask)\n{\n\tif (likely(bitmap[0] & FATTR4_WORD0_SUPPORTED_ATTRS)) {\n\t\tint ret;\n\t\tret = decode_attr_bitmap(xdr, bitmask);\n\t\tif (unlikely(ret < 0))\n\t\t\treturn ret;\n\t\tbitmap[0] &= ~FATTR4_WORD0_SUPPORTED_ATTRS;\n\t} else\n\t\tbitmask[0] = bitmask[1] = bitmask[2] = 0;\n\tdprintk(\"%s: bitmask=%08x:%08x:%08x\\n\", __func__,\n\t\tbitmask[0], bitmask[1], bitmask[2]);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_supported(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *bitmask)\n{\n\tif (likely(bitmap[0] & FATTR4_WORD0_SUPPORTED_ATTRS)) {\n\t\tint ret;\n\t\tret = decode_attr_bitmap(xdr, bitmask);\n\t\tif (unlikely(ret < 0))\n\t\t\treturn ret;\n\t\tbitmap[0] &= ~FATTR4_WORD0_SUPPORTED_ATTRS;\n\t} else\n\t\tbitmask[0] = bitmask[1] = bitmask[2] = 0;\n\tdprintk(\"%s: bitmask=%08x:%08x:%08x\\n\", __func__,\n\t\tbitmask[0], bitmask[1], bitmask[2]);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_length",
          "args": [
            "xdr",
            "&attrlen",
            "&savep"
          ],
          "line": 4307
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3132-3145",
          "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmap"
          ],
          "line": 4305
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR"
          ],
          "line": 4303
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_server_caps(struct xdr_stream *xdr, struct nfs4_server_caps_res *res)\n{\n\tunsigned int savep;\n\tuint32_t attrlen, bitmap[3] = {0};\n\tint status;\n\n\tif ((status = decode_op_hdr(xdr, OP_GETATTR)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_bitmap(xdr, bitmap)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_length(xdr, &attrlen, &savep)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_supported(xdr, bitmap, res->attr_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_fh_expire_type(xdr, bitmap,\n\t\t\t\t\t\t &res->fh_expire_type)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_link_support(xdr, bitmap, &res->has_links)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_symlink_support(xdr, bitmap, &res->has_symlinks)) != 0)\n\t\tgoto xdr_error;\n\tif ((status = decode_attr_aclsupport(xdr, bitmap, &res->acl_bitmask)) != 0)\n\t\tgoto xdr_error;\n\tstatus = verify_attr_len(xdr, savep, attrlen);\nxdr_error:\n\tdprintk(\"%s: xdr returned %d!\\n\", __func__, -status);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4274-4295",
    "snippet": "static int decode_create(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE);\n\tif (status)\n\t\treturn status;\n\tif ((status = decode_change_info(xdr, cinfo)))\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4293
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "p"
          ],
          "line": 4290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "bmlen << 2"
          ],
          "line": 4289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_change_info",
          "args": [
            "xdr",
            "cinfo"
          ],
          "line": 4283
        },
        "resolved": true,
        "details": {
          "function_name": "decode_change_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4186-4200",
          "snippet": "static int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_CREATE"
          ],
          "line": 4280
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_create(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\tuint32_t bmlen;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CREATE);\n\tif (status)\n\t\treturn status;\n\tif ((status = decode_change_info(xdr, cinfo)))\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, bmlen << 2);\n\tif (likely(p))\n\t\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4264-4272",
    "snippet": "static int decode_commit(struct xdr_stream *xdr, struct nfs_commitres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_COMMIT);\n\tif (!status)\n\t\tstatus = decode_write_verifier(xdr, &res->verf->verifier);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_write_verifier",
          "args": [
            "xdr",
            "&res->verf->verifier"
          ],
          "line": 4270
        },
        "resolved": true,
        "details": {
          "function_name": "decode_write_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4259-4262",
          "snippet": "static int decode_write_verifier(struct xdr_stream *xdr, struct nfs_write_verifier *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_write_verifier(struct xdr_stream *xdr, struct nfs_write_verifier *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_COMMIT"
          ],
          "line": 4268
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_commit(struct xdr_stream *xdr, struct nfs_commitres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_COMMIT);\n\tif (!status)\n\t\tstatus = decode_write_verifier(xdr, &res->verf->verifier);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_write_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4259-4262",
    "snippet": "static int decode_write_verifier(struct xdr_stream *xdr, struct nfs_write_verifier *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier->data, NFS4_VERIFIER_SIZE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_opaque_fixed",
          "args": [
            "xdr",
            "verifier->data",
            "NFS4_VERIFIER_SIZE"
          ],
          "line": 4261
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4224-4235",
          "snippet": "static int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_write_verifier(struct xdr_stream *xdr, struct nfs_write_verifier *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier->data, NFS4_VERIFIER_SIZE);\n}"
  },
  {
    "function_name": "decode_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4254-4257",
    "snippet": "static int decode_verifier(struct xdr_stream *xdr, void *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier, NFS4_VERIFIER_SIZE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_opaque_fixed",
          "args": [
            "xdr",
            "verifier",
            "NFS4_VERIFIER_SIZE"
          ],
          "line": 4256
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4224-4235",
          "snippet": "static int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_verifier(struct xdr_stream *xdr, void *verifier)\n{\n\treturn decode_opaque_fixed(xdr, verifier, NFS4_VERIFIER_SIZE);\n}"
  },
  {
    "function_name": "decode_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4242-4252",
    "snippet": "static int decode_close(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CLOSE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_stateid",
          "args": [
            "xdr",
            "&res->stateid"
          ],
          "line": 4250
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4237-4240",
          "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_increment_open_seqid",
          "args": [
            "status",
            "res->seqid"
          ],
          "line": 4248
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_increment_open_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1086-1098",
          "snippet": "void nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_increment_open_seqid(int status, struct nfs_seqid *seqid)\n{\n\tstruct nfs4_state_owner *sp;\n\n\tif (seqid == NULL)\n\t\treturn;\n\n\tsp = container_of(seqid->sequence, struct nfs4_state_owner, so_seqid);\n\tif (status == -NFS4ERR_BAD_SEQID)\n\t\tnfs4_drop_state_owner(sp);\n\tif (!nfs4_has_session(sp->so_server->nfs_client))\n\t\tnfs_increment_seqid(status, seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_CLOSE"
          ],
          "line": 4246
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_close(struct xdr_stream *xdr, struct nfs_closeres *res)\n{\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_CLOSE);\n\tif (status != -EIO)\n\t\tnfs_increment_open_seqid(status, res->seqid);\n\tif (!status)\n\t\tstatus = decode_stateid(xdr, &res->stateid);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4237-4240",
    "snippet": "static int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_opaque_fixed",
          "args": [
            "xdr",
            "stateid",
            "NFS4_STATEID_SIZE"
          ],
          "line": 4239
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4224-4235",
          "snippet": "static int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_stateid(struct xdr_stream *xdr, nfs4_stateid *stateid)\n{\n\treturn decode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
  },
  {
    "function_name": "decode_opaque_fixed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4224-4235",
    "snippet": "static int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4233
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "p",
            "len"
          ],
          "line": 4230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "p"
          ],
          "line": 4229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 4228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_fixed(struct xdr_stream *xdr, void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, len);\n\tif (likely(p)) {\n\t\tmemcpy(buf, p, len);\n\t\treturn 0;\n\t}\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4202-4222",
    "snippet": "static int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4220
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 4211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_op_hdr",
          "args": [
            "xdr",
            "OP_ACCESS"
          ],
          "line": 4208
        },
        "resolved": true,
        "details": {
          "function_name": "decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3082-3088",
          "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_access(struct xdr_stream *xdr, u32 *supported, u32 *access)\n{\n\t__be32 *p;\n\tuint32_t supp, acc;\n\tint status;\n\n\tstatus = decode_op_hdr(xdr, OP_ACCESS);\n\tif (status)\n\t\treturn status;\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tsupp = be32_to_cpup(p++);\n\tacc = be32_to_cpup(p);\n\t*supported = supp;\n\t*access = acc;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_change_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4186-4200",
    "snippet": "static int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4198
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&cinfo->after"
          ],
          "line": 4195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&cinfo->before"
          ],
          "line": 4194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "20"
          ],
          "line": 4190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_change_info(struct xdr_stream *xdr, struct nfs4_change_info *cinfo)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 20);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tcinfo->atomic = be32_to_cpup(p++);\n\tp = xdr_decode_hyper(p, &cinfo->before);\n\txdr_decode_hyper(p, &cinfo->after);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "verify_attr_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4169-4184",
    "snippet": "static int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\"",
            "__func__",
            "attrwords << 2",
            "(attrwords < nwords) ? '<' : '>'",
            "nwords << 2"
          ],
          "line": 4175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "attrwords != nwords"
          ],
          "line": 4174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_stream_pos",
          "args": [
            "xdr"
          ],
          "line": 4172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "attrlen"
          ],
          "line": 4171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int verify_attr_len(struct xdr_stream *xdr, unsigned int savep, uint32_t attrlen)\n{\n\tunsigned int attrwords = XDR_QUADLEN(attrlen);\n\tunsigned int nwords = (xdr_stream_pos(xdr) - savep) >> 2;\n\n\tif (unlikely(attrwords != nwords)) {\n\t\tdprintk(\"%s: server returned incorrect attribute length: \"\n\t\t\t\"%u %c %u\\n\",\n\t\t\t\t__func__,\n\t\t\t\tattrwords << 2,\n\t\t\t\t(attrwords < nwords) ? '<' : '>',\n\t\t\t\tnwords << 2);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "decode_attr_time_modify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4151-4167",
    "snippet": "static int decode_attr_time_modify(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_MODIFY - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_MODIFY)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_MTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_MODIFY;\n\t}\n\tdprintk(\"%s: mtime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: mtime=%ld\\n\"",
            "__func__",
            "(long)time->tv_sec"
          ],
          "line": 4165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_time",
          "args": [
            "xdr",
            "time"
          ],
          "line": 4160
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4028-4045",
          "snippet": "static int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_TIME_MODIFY"
          ],
          "line": 4159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_TIME_MODIFY - 1U)"
          ],
          "line": 4157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_modify(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_MODIFY - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_MODIFY)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_MTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_MODIFY;\n\t}\n\tdprintk(\"%s: mtime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_attr_security_label",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4101-4149",
    "snippet": "static int decode_attr_security_label(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n\tuint32_t pi = 0;\n\tuint32_t lfs = 0;\n\t__u32 len;\n\t__be32 *p;\n\tint status = 0;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_SECURITY_LABEL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[2] & FATTR4_WORD2_SECURITY_LABEL)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlfs = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tpi = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (len < NFS4_MAXLABELLEN) {\n\t\t\tif (label) {\n\t\t\t\tmemcpy(label->label, p, len);\n\t\t\t\tlabel->len = len;\n\t\t\t\tlabel->pi = pi;\n\t\t\t\tlabel->lfs = lfs;\n\t\t\t\tstatus = NFS_ATTR_FATTR_V4_SECURITY_LABEL;\n\t\t\t}\n\t\t\tbitmap[2] &= ~FATTR4_WORD2_SECURITY_LABEL;\n\t\t} else\n\t\t\tprintk(KERN_WARNING \"%s: label too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t}\n\tif (label && label->label)\n\t\tdprintk(\"%s: label=%s, len=%d, PI=%d, LFS=%d\\n\", __func__,\n\t\t\t(char *)label->label, label->len, label->pi, label->lfs);\n\treturn status;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4147
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: label=%s, len=%d, PI=%d, LFS=%d\\n\"",
            "__func__",
            "(char *)label->label",
            "label->len",
            "label->pi",
            "label->lfs"
          ],
          "line": 4142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: label too long (%u)!\\n\"",
            "__func__",
            "len"
          ],
          "line": 4138
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "label->label",
            "p",
            "len"
          ],
          "line": 4130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 4125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 4116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 4113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[2] & FATTR4_WORD2_SECURITY_LABEL"
          ],
          "line": 4112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[2] & (FATTR4_WORD2_SECURITY_LABEL - 1U)"
          ],
          "line": 4110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_security_label(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t\tstruct nfs4_label *label)\n{\n\tuint32_t pi = 0;\n\tuint32_t lfs = 0;\n\t__u32 len;\n\t__be32 *p;\n\tint status = 0;\n\n\tif (unlikely(bitmap[2] & (FATTR4_WORD2_SECURITY_LABEL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[2] & FATTR4_WORD2_SECURITY_LABEL)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlfs = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tpi = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p++);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (len < NFS4_MAXLABELLEN) {\n\t\t\tif (label) {\n\t\t\t\tmemcpy(label->label, p, len);\n\t\t\t\tlabel->len = len;\n\t\t\t\tlabel->pi = pi;\n\t\t\t\tlabel->lfs = lfs;\n\t\t\t\tstatus = NFS_ATTR_FATTR_V4_SECURITY_LABEL;\n\t\t\t}\n\t\t\tbitmap[2] &= ~FATTR4_WORD2_SECURITY_LABEL;\n\t\t} else\n\t\t\tprintk(KERN_WARNING \"%s: label too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t}\n\tif (label && label->label)\n\t\tdprintk(\"%s: label=%s, len=%d, PI=%d, LFS=%d\\n\", __func__,\n\t\t\t(char *)label->label, label->len, label->pi, label->lfs);\n\treturn status;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_time_delta",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4083-4099",
    "snippet": "static int decode_attr_time_delta(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t  struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_DELTA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_DELTA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_DELTA;\n\t}\n\tdprintk(\"%s: time_delta=%ld %ld\\n\", __func__, (long)time->tv_sec,\n\t\t(long)time->tv_nsec);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: time_delta=%ld %ld\\n\"",
            "__func__",
            "(long)time->tv_sec",
            "(long)time->tv_nsec"
          ],
          "line": 4096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_time",
          "args": [
            "xdr",
            "time"
          ],
          "line": 4093
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4028-4045",
          "snippet": "static int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_TIME_DELTA"
          ],
          "line": 4092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_TIME_DELTA - 1U)"
          ],
          "line": 4090
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_delta(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\t\t\t  struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_DELTA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_DELTA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_DELTA;\n\t}\n\tdprintk(\"%s: time_delta=%ld %ld\\n\", __func__, (long)time->tv_sec,\n\t\t(long)time->tv_nsec);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_attr_time_metadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4065-4081",
    "snippet": "static int decode_attr_time_metadata(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_METADATA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_METADATA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_CTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_METADATA;\n\t}\n\tdprintk(\"%s: ctime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: ctime=%ld\\n\"",
            "__func__",
            "(long)time->tv_sec"
          ],
          "line": 4079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_time",
          "args": [
            "xdr",
            "time"
          ],
          "line": 4074
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4028-4045",
          "snippet": "static int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_TIME_METADATA"
          ],
          "line": 4073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_TIME_METADATA - 1U)"
          ],
          "line": 4071
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_metadata(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_METADATA - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_METADATA)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_CTIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_METADATA;\n\t}\n\tdprintk(\"%s: ctime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_attr_time_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4047-4063",
    "snippet": "static int decode_attr_time_access(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_ACCESS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_ACCESS)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_ATIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_ACCESS;\n\t}\n\tdprintk(\"%s: atime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: atime=%ld\\n\"",
            "__func__",
            "(long)time->tv_sec"
          ],
          "line": 4061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_time",
          "args": [
            "xdr",
            "time"
          ],
          "line": 4056
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "4028-4045",
          "snippet": "static int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_TIME_ACCESS"
          ],
          "line": 4055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_TIME_ACCESS - 1U)"
          ],
          "line": 4053
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time_access(struct xdr_stream *xdr, uint32_t *bitmap, struct timespec *time)\n{\n\tint status = 0;\n\n\ttime->tv_sec = 0;\n\ttime->tv_nsec = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_TIME_ACCESS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_TIME_ACCESS)) {\n\t\tstatus = decode_attr_time(xdr, time);\n\t\tif (status == 0)\n\t\t\tstatus = NFS_ATTR_FATTR_ATIME;\n\t\tbitmap[1] &= ~FATTR4_WORD1_TIME_ACCESS;\n\t}\n\tdprintk(\"%s: atime=%ld\\n\", __func__, (long)time->tv_sec);\n\treturn status;\n}"
  },
  {
    "function_name": "decode_attr_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4028-4045",
    "snippet": "static int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4043
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&sec"
          ],
          "line": 4037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "12"
          ],
          "line": 4034
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_time(struct xdr_stream *xdr, struct timespec *time)\n{\n\t__be32 *p;\n\tuint64_t sec;\n\tuint32_t nsec;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tp = xdr_decode_hyper(p, &sec);\n\tnsec = be32_to_cpup(p);\n\ttime->tv_sec = (time_t)sec;\n\ttime->tv_nsec = (long)nsec;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_space_used",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "4004-4026",
    "snippet": "static int decode_attr_space_used(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *used)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*used = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_USED - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_USED)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, used);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_USED;\n\t\tret = NFS_ATTR_FATTR_SPACE_USED;\n\t}\n\tdprintk(\"%s: space used=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*used);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4024
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: space used=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*used"
          ],
          "line": 4020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "used"
          ],
          "line": 4016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 4014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 4013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_SPACE_USED"
          ],
          "line": 4012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_SPACE_USED - 1U)"
          ],
          "line": 4010
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_used(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *used)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*used = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_USED - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_USED)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, used);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_USED;\n\t\tret = NFS_ATTR_FATTR_SPACE_USED;\n\t}\n\tdprintk(\"%s: space used=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*used);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_space_total",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3982-4002",
    "snippet": "static int decode_attr_space_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_TOTAL;\n\t}\n\tdprintk(\"%s: space total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 4000
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: space total=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_SPACE_TOTAL"
          ],
          "line": 3990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_SPACE_TOTAL - 1U)"
          ],
          "line": 3988
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_TOTAL;\n\t}\n\tdprintk(\"%s: space total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_space_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3960-3980",
    "snippet": "static int decode_attr_space_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_FREE;\n\t}\n\tdprintk(\"%s: space free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3978
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: space free=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_SPACE_FREE"
          ],
          "line": 3968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_SPACE_FREE - 1U)"
          ],
          "line": 3966
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_FREE;\n\t}\n\tdprintk(\"%s: space free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_space_avail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3938-3958",
    "snippet": "static int decode_attr_space_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_AVAIL;\n\t}\n\tdprintk(\"%s: space avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3956
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: space avail=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_SPACE_AVAIL"
          ],
          "line": 3946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_SPACE_AVAIL - 1U)"
          ],
          "line": 3944
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_space_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_SPACE_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_SPACE_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[1] &= ~FATTR4_WORD1_SPACE_AVAIL;\n\t}\n\tdprintk(\"%s: space avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_rdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3908-3936",
    "snippet": "static int decode_attr_rdev(struct xdr_stream *xdr, uint32_t *bitmap, dev_t *rdev)\n{\n\tuint32_t major = 0, minor = 0;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*rdev = MKDEV(0,0);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_RAWDEV - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_RAWDEV)) {\n\t\tdev_t tmp;\n\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tmajor = be32_to_cpup(p++);\n\t\tminor = be32_to_cpup(p);\n\t\ttmp = MKDEV(major, minor);\n\t\tif (MAJOR(tmp) == major && MINOR(tmp) == minor)\n\t\t\t*rdev = tmp;\n\t\tbitmap[1] &= ~ FATTR4_WORD1_RAWDEV;\n\t\tret = NFS_ATTR_FATTR_RDEV;\n\t}\n\tdprintk(\"%s: rdev=(0x%x:0x%x)\\n\", __func__, major, minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3934
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: rdev=(0x%x:0x%x)\\n\"",
            "__func__",
            "major",
            "minor"
          ],
          "line": 3931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "tmp"
          ],
          "line": 3926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "tmp"
          ],
          "line": 3926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "major",
            "minor"
          ],
          "line": 3925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 3923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_RAWDEV"
          ],
          "line": 3917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_RAWDEV - 1U)"
          ],
          "line": 3915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "0",
            "0"
          ],
          "line": 3914
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_rdev(struct xdr_stream *xdr, uint32_t *bitmap, dev_t *rdev)\n{\n\tuint32_t major = 0, minor = 0;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*rdev = MKDEV(0,0);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_RAWDEV - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_RAWDEV)) {\n\t\tdev_t tmp;\n\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tmajor = be32_to_cpup(p++);\n\t\tminor = be32_to_cpup(p);\n\t\ttmp = MKDEV(major, minor);\n\t\tif (MAJOR(tmp) == major && MINOR(tmp) == minor)\n\t\t\t*rdev = tmp;\n\t\tbitmap[1] &= ~ FATTR4_WORD1_RAWDEV;\n\t\tret = NFS_ATTR_FATTR_RDEV;\n\t}\n\tdprintk(\"%s: rdev=(0x%x:0x%x)\\n\", __func__, major, minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3865-3906",
    "snippet": "static int decode_attr_group(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kgid_t *gid,\n\t\tstruct nfs4_string *group_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*gid = make_kgid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER_GROUP - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER_GROUP)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (group_name != NULL) {\n\t\t\tgroup_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (group_name->data != NULL) {\n\t\t\t\tgroup_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_group_to_gid(server, (char *)p, len, gid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_group_to_gid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER_GROUP;\n\t}\n\tdprintk(\"%s: gid=%d\\n\", __func__, (int)from_kgid(&init_user_ns, *gid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3904
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: gid=%d\\n\"",
            "__func__",
            "(int)from_kgid(&init_user_ns, *gid)"
          ],
          "line": 3901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "&init_user_ns",
            "*gid"
          ],
          "line": 3901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: name too long (%u)!\\n\"",
            "__func__",
            "len"
          ],
          "line": 3897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: nfs_map_group_to_gid failed!\\n\"",
            "__func__"
          ],
          "line": 3894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_map_group_to_gid",
          "args": [
            "server",
            "(char *)p",
            "len",
            "gid"
          ],
          "line": 3891
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_group_to_gid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "748-763",
          "snippet": "int nfs_map_group_to_gid(const struct nfs_server *server, const char *name, size_t namelen, kgid_t *gid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"gid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*gid = make_kgid(&init_user_ns, id);\n\t\tif (!gid_valid(*gid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_group_to_gid(name, namelen, id, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_group_to_gid(const struct nfs_server *server, const char *name, size_t namelen, kgid_t *gid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"gid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*gid = make_kgid(&init_user_ns, id);\n\t\tif (!gid_valid(*gid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_group_to_gid(name, namelen, id, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "p",
            "len",
            "GFP_NOWAIT"
          ],
          "line": 3885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 3881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_OWNER_GROUP"
          ],
          "line": 3876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_OWNER_GROUP - 1U)"
          ],
          "line": 3874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "&init_user_ns",
            "-2"
          ],
          "line": 3873
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_group(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kgid_t *gid,\n\t\tstruct nfs4_string *group_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*gid = make_kgid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER_GROUP - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER_GROUP)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (group_name != NULL) {\n\t\t\tgroup_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (group_name->data != NULL) {\n\t\t\t\tgroup_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_group_to_gid(server, (char *)p, len, gid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_GROUP;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_group_to_gid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER_GROUP;\n\t}\n\tdprintk(\"%s: gid=%d\\n\", __func__, (int)from_kgid(&init_user_ns, *gid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3822-3863",
    "snippet": "static int decode_attr_owner(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kuid_t *uid,\n\t\tstruct nfs4_string *owner_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*uid = make_kuid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (owner_name != NULL) {\n\t\t\towner_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (owner_name->data != NULL) {\n\t\t\t\towner_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_name_to_uid(server, (char *)p, len, uid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_name_to_uid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER;\n\t}\n\tdprintk(\"%s: uid=%d\\n\", __func__, (int)from_kuid(&init_user_ns, *uid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3861
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: uid=%d\\n\"",
            "__func__",
            "(int)from_kuid(&init_user_ns, *uid)"
          ],
          "line": 3858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "&init_user_ns",
            "*uid"
          ],
          "line": 3858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: name too long (%u)!\\n\"",
            "__func__",
            "len"
          ],
          "line": 3854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: nfs_map_name_to_uid failed!\\n\"",
            "__func__"
          ],
          "line": 3851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_map_name_to_uid",
          "args": [
            "server",
            "(char *)p",
            "len",
            "uid"
          ],
          "line": 3848
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_name_to_uid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "731-746",
          "snippet": "int nfs_map_name_to_uid(const struct nfs_server *server, const char *name, size_t namelen, kuid_t *uid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"uid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*uid = make_kuid(&init_user_ns, id);\n\t\tif (!uid_valid(*uid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_name_to_uid(name, namelen, id, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_name_to_uid(const struct nfs_server *server, const char *name, size_t namelen, kuid_t *uid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"uid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*uid = make_kuid(&init_user_ns, id);\n\t\tif (!uid_valid(*uid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_name_to_uid(name, namelen, id, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "p",
            "len",
            "GFP_NOWAIT"
          ],
          "line": 3842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 3838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_OWNER"
          ],
          "line": 3833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_OWNER - 1U)"
          ],
          "line": 3831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "&init_user_ns",
            "-2"
          ],
          "line": 3830
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_owner(struct xdr_stream *xdr, uint32_t *bitmap,\n\t\tconst struct nfs_server *server, kuid_t *uid,\n\t\tstruct nfs4_string *owner_name)\n{\n\tuint32_t len;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*uid = make_kuid(&init_user_ns, -2);\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_OWNER - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_OWNER)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (owner_name != NULL) {\n\t\t\towner_name->data = kmemdup(p, len, GFP_NOWAIT);\n\t\t\tif (owner_name->data != NULL) {\n\t\t\t\towner_name->len = len;\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER_NAME;\n\t\t\t}\n\t\t} else if (len < XDR_MAX_NETOBJ) {\n\t\t\tif (nfs_map_name_to_uid(server, (char *)p, len, uid) == 0)\n\t\t\t\tret = NFS_ATTR_FATTR_OWNER;\n\t\t\telse\n\t\t\t\tdprintk(\"%s: nfs_map_name_to_uid failed!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t} else\n\t\t\tdprintk(\"%s: name too long (%u)!\\n\",\n\t\t\t\t\t__func__, len);\n\t\tbitmap[1] &= ~FATTR4_WORD1_OWNER;\n\t}\n\tdprintk(\"%s: uid=%d\\n\", __func__, (int)from_kuid(&init_user_ns, *uid));\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_nlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3799-3820",
    "snippet": "static int decode_attr_nlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *nlink)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*nlink = 1;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_NUMLINKS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_NUMLINKS)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*nlink = be32_to_cpup(p);\n\t\tbitmap[1] &= ~FATTR4_WORD1_NUMLINKS;\n\t\tret = NFS_ATTR_FATTR_NLINK;\n\t}\n\tdprintk(\"%s: nlink=%u\\n\", __func__, (unsigned int)*nlink);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3818
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: nlink=%u\\n\"",
            "__func__",
            "(unsigned int)*nlink"
          ],
          "line": 3815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_NUMLINKS"
          ],
          "line": 3807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_NUMLINKS - 1U)"
          ],
          "line": 3805
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_nlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *nlink)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*nlink = 1;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_NUMLINKS - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_NUMLINKS)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*nlink = be32_to_cpup(p);\n\t\tbitmap[1] &= ~FATTR4_WORD1_NUMLINKS;\n\t\tret = NFS_ATTR_FATTR_NLINK;\n\t}\n\tdprintk(\"%s: nlink=%u\\n\", __func__, (unsigned int)*nlink);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3774-3797",
    "snippet": "static int decode_attr_mode(struct xdr_stream *xdr, uint32_t *bitmap, umode_t *mode)\n{\n\tuint32_t tmp;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*mode = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MODE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MODE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\ttmp = be32_to_cpup(p);\n\t\t*mode = tmp & ~S_IFMT;\n\t\tbitmap[1] &= ~FATTR4_WORD1_MODE;\n\t\tret = NFS_ATTR_FATTR_MODE;\n\t}\n\tdprintk(\"%s: file mode=0%o\\n\", __func__, (unsigned int)*mode);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3795
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: file mode=0%o\\n\"",
            "__func__",
            "(unsigned int)*mode"
          ],
          "line": 3792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_MODE"
          ],
          "line": 3783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_MODE - 1U)"
          ],
          "line": 3781
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_mode(struct xdr_stream *xdr, uint32_t *bitmap, umode_t *mode)\n{\n\tuint32_t tmp;\n\t__be32 *p;\n\tint ret = 0;\n\n\t*mode = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MODE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MODE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\ttmp = be32_to_cpup(p);\n\t\t*mode = tmp & ~S_IFMT;\n\t\tbitmap[1] &= ~FATTR4_WORD1_MODE;\n\t\tret = NFS_ATTR_FATTR_MODE;\n\t}\n\tdprintk(\"%s: file mode=0%o\\n\", __func__, (unsigned int)*mode);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_maxwrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3748-3772",
    "snippet": "static int decode_attr_maxwrite(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXWRITE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXWRITE)) {\n\t\tuint64_t maxwrite;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxwrite);\n\t\tif (maxwrite > 0x7FFFFFFF)\n\t\t\tmaxwrite = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxwrite;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXWRITE;\n\t}\n\tdprintk(\"%s: maxwrite=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3770
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: maxwrite=%lu\\n\"",
            "__func__",
            "(unsigned long)*res"
          ],
          "line": 3767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&maxwrite"
          ],
          "line": 3761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_MAXWRITE"
          ],
          "line": 3756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_MAXWRITE - 1U)"
          ],
          "line": 3754
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxwrite(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXWRITE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXWRITE)) {\n\t\tuint64_t maxwrite;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxwrite);\n\t\tif (maxwrite > 0x7FFFFFFF)\n\t\t\tmaxwrite = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxwrite;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXWRITE;\n\t}\n\tdprintk(\"%s: maxwrite=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_maxread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3722-3746",
    "snippet": "static int decode_attr_maxread(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXREAD - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXREAD)) {\n\t\tuint64_t maxread;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxread);\n\t\tif (maxread > 0x7FFFFFFF)\n\t\t\tmaxread = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxread;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXREAD;\n\t}\n\tdprintk(\"%s: maxread=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3744
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: maxread=%lu\\n\"",
            "__func__",
            "(unsigned long)*res"
          ],
          "line": 3741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&maxread"
          ],
          "line": 3735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_MAXREAD"
          ],
          "line": 3730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_MAXREAD - 1U)"
          ],
          "line": 3728
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxread(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXREAD - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXREAD)) {\n\t\tuint64_t maxread;\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, &maxread);\n\t\tif (maxread > 0x7FFFFFFF)\n\t\t\tmaxread = 0x7FFFFFFF;\n\t\t*res = (uint32_t)maxread;\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXREAD;\n\t}\n\tdprintk(\"%s: maxread=%lu\\n\", __func__, (unsigned long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_maxname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3700-3720",
    "snippet": "static int decode_attr_maxname(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxname)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxname = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXNAME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXNAME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxname = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXNAME;\n\t}\n\tdprintk(\"%s: maxname=%u\\n\", __func__, *maxname);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3718
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: maxname=%u\\n\"",
            "__func__",
            "*maxname"
          ],
          "line": 3715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_MAXNAME"
          ],
          "line": 3708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_MAXNAME - 1U)"
          ],
          "line": 3706
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxname(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxname)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxname = 1024;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXNAME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXNAME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxname = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXNAME;\n\t}\n\tdprintk(\"%s: maxname=%u\\n\", __func__, *maxname);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_maxlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3678-3698",
    "snippet": "static int decode_attr_maxlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxlink)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxlink = 1;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXLINK - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXLINK)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxlink = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXLINK;\n\t}\n\tdprintk(\"%s: maxlink=%u\\n\", __func__, *maxlink);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3696
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: maxlink=%u\\n\"",
            "__func__",
            "*maxlink"
          ],
          "line": 3693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_MAXLINK"
          ],
          "line": 3686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_MAXLINK - 1U)"
          ],
          "line": 3684
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxlink(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *maxlink)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*maxlink = 1;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXLINK - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXLINK)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*maxlink = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXLINK;\n\t}\n\tdprintk(\"%s: maxlink=%u\\n\", __func__, *maxlink);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_maxfilesize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3656-3676",
    "snippet": "static int decode_attr_maxfilesize(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXFILESIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXFILESIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXFILESIZE;\n\t}\n\tdprintk(\"%s: maxfilesize=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3674
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: maxfilesize=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_MAXFILESIZE"
          ],
          "line": 3664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_MAXFILESIZE - 1U)"
          ],
          "line": 3662
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_maxfilesize(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_MAXFILESIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_MAXFILESIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_MAXFILESIZE;\n\t}\n\tdprintk(\"%s: maxfilesize=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_fs_locations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3577-3654",
    "snippet": "static int decode_attr_fs_locations(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs4_fs_locations *res)\n{\n\tint n;\n\t__be32 *p;\n\tint status = -EIO;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FS_LOCATIONS -1U)))\n\t\tgoto out;\n\tstatus = 0;\n\tif (unlikely(!(bitmap[0] & FATTR4_WORD0_FS_LOCATIONS)))\n\t\tgoto out;\n\tstatus = -EIO;\n\t/* Ignore borken servers that return unrequested attrs */\n\tif (unlikely(res == NULL))\n\t\tgoto out;\n\tdprintk(\"%s: fsroot:\\n\", __func__);\n\tstatus = decode_pathname(xdr, &res->fs_path);\n\tif (unlikely(status != 0))\n\t\tgoto out;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n <= 0)\n\t\tgoto out_eio;\n\tfor (res->nlocations = 0; res->nlocations < n; res->nlocations++) {\n\t\tu32 m;\n\t\tstruct nfs4_fs_location *loc;\n\n\t\tif (res->nlocations == NFS4_FS_LOCATIONS_MAXENTRIES)\n\t\t\tbreak;\n\t\tloc = &res->locations[res->nlocations];\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tm = be32_to_cpup(p);\n\n\t\tdprintk(\"%s: servers:\\n\", __func__);\n\t\tfor (loc->nservers = 0; loc->nservers < m; loc->nservers++) {\n\t\t\tstruct nfs4_string *server;\n\n\t\t\tif (loc->nservers == NFS4_FS_LOCATION_MAXSERVERS) {\n\t\t\t\tunsigned int i;\n\t\t\t\tdprintk(\"%s: using first %u of %u servers \"\n\t\t\t\t\t\"returned for location %u\\n\",\n\t\t\t\t\t\t__func__,\n\t\t\t\t\t\tNFS4_FS_LOCATION_MAXSERVERS,\n\t\t\t\t\t\tm, res->nlocations);\n\t\t\t\tfor (i = loc->nservers; i < m; i++) {\n\t\t\t\t\tunsigned int len;\n\t\t\t\t\tchar *data;\n\t\t\t\t\tstatus = decode_opaque_inline(xdr, &len, &data);\n\t\t\t\t\tif (unlikely(status != 0))\n\t\t\t\t\t\tgoto out_eio;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tserver = &loc->servers[loc->nservers];\n\t\t\tstatus = decode_opaque_inline(xdr, &server->len, &server->data);\n\t\t\tif (unlikely(status != 0))\n\t\t\t\tgoto out_eio;\n\t\t\tdprintk(\"%s \", server->data);\n\t\t}\n\t\tstatus = decode_pathname(xdr, &loc->rootpath);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t}\n\tif (res->nlocations != 0)\n\t\tstatus = NFS_ATTR_FATTR_V4_LOCATIONS;\nout:\n\tdprintk(\"%s: fs_locations done, error = %d\\n\", __func__, status);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout_eio:\n\tstatus = -EIO;\n\tgoto out;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3650
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: fs_locations done, error = %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 3647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status != 0"
          ],
          "line": 3641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_pathname",
          "args": [
            "xdr",
            "&loc->rootpath"
          ],
          "line": 3640
        },
        "resolved": true,
        "details": {
          "function_name": "decode_pathname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3532-3575",
          "snippet": "static int decode_pathname(struct xdr_stream *xdr, struct nfs4_pathname *path)\n{\n\tu32 n;\n\t__be32 *p;\n\tint status = 0;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n == 0)\n\t\tgoto root_path;\n\tdprintk(\"pathname4: \");\n\tif (n > NFS4_PATHNAME_MAXCOMPONENTS) {\n\t\tdprintk(\"cannot parse %d components in path\\n\", n);\n\t\tgoto out_eio;\n\t}\n\tfor (path->ncomponents = 0; path->ncomponents < n; path->ncomponents++) {\n\t\tstruct nfs4_string *component = &path->components[path->ncomponents];\n\t\tstatus = decode_opaque_inline(xdr, &component->len, &component->data);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t\tifdebug (XDR)\n\t\t\tpr_cont(\"%s%.*s \",\n\t\t\t\t(path->ncomponents != n ? \"/ \" : \"\"),\n\t\t\t\tcomponent->len, component->data);\n\t}\nout:\n\treturn status;\nroot_path:\n/* a root pathname is sent as a zero component4 */\n\tpath->ncomponents = 1;\n\tpath->components[0].len=0;\n\tpath->components[0].data=NULL;\n\tdprintk(\"pathname4: /\\n\");\n\tgoto out;\nout_eio:\n\tdprintk(\" status %d\", status);\n\tstatus = -EIO;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_pathname(struct xdr_stream *xdr, struct nfs4_pathname *path)\n{\n\tu32 n;\n\t__be32 *p;\n\tint status = 0;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n == 0)\n\t\tgoto root_path;\n\tdprintk(\"pathname4: \");\n\tif (n > NFS4_PATHNAME_MAXCOMPONENTS) {\n\t\tdprintk(\"cannot parse %d components in path\\n\", n);\n\t\tgoto out_eio;\n\t}\n\tfor (path->ncomponents = 0; path->ncomponents < n; path->ncomponents++) {\n\t\tstruct nfs4_string *component = &path->components[path->ncomponents];\n\t\tstatus = decode_opaque_inline(xdr, &component->len, &component->data);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t\tifdebug (XDR)\n\t\t\tpr_cont(\"%s%.*s \",\n\t\t\t\t(path->ncomponents != n ? \"/ \" : \"\"),\n\t\t\t\tcomponent->len, component->data);\n\t}\nout:\n\treturn status;\nroot_path:\n/* a root pathname is sent as a zero component4 */\n\tpath->ncomponents = 1;\n\tpath->components[0].len=0;\n\tpath->components[0].data=NULL;\n\tdprintk(\"pathname4: /\\n\");\n\tgoto out;\nout_eio:\n\tdprintk(\" status %d\", status);\n\tstatus = -EIO;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s \"",
            "server->data"
          ],
          "line": 3638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status != 0"
          ],
          "line": 3636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_opaque_inline",
          "args": [
            "xdr",
            "&server->len",
            "&server->data"
          ],
          "line": 3635
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_inline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3009-3025",
          "snippet": "static int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status != 0"
          ],
          "line": 3629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: using first %u of %u servers \"\n\t\t\t\t\t\"returned for location %u\\n\"",
            "__func__",
            "NFS4_FS_LOCATION_MAXSERVERS",
            "m",
            "res->nlocations"
          ],
          "line": 3620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: servers:\\n\"",
            "__func__"
          ],
          "line": 3614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status != 0"
          ],
          "line": 3594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: fsroot:\\n\"",
            "__func__"
          ],
          "line": 3592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "res == NULL"
          ],
          "line": 3590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!(bitmap[0] & FATTR4_WORD0_FS_LOCATIONS)"
          ],
          "line": 3586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FS_LOCATIONS -1U)"
          ],
          "line": 3583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fs_locations(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs4_fs_locations *res)\n{\n\tint n;\n\t__be32 *p;\n\tint status = -EIO;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FS_LOCATIONS -1U)))\n\t\tgoto out;\n\tstatus = 0;\n\tif (unlikely(!(bitmap[0] & FATTR4_WORD0_FS_LOCATIONS)))\n\t\tgoto out;\n\tstatus = -EIO;\n\t/* Ignore borken servers that return unrequested attrs */\n\tif (unlikely(res == NULL))\n\t\tgoto out;\n\tdprintk(\"%s: fsroot:\\n\", __func__);\n\tstatus = decode_pathname(xdr, &res->fs_path);\n\tif (unlikely(status != 0))\n\t\tgoto out;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n <= 0)\n\t\tgoto out_eio;\n\tfor (res->nlocations = 0; res->nlocations < n; res->nlocations++) {\n\t\tu32 m;\n\t\tstruct nfs4_fs_location *loc;\n\n\t\tif (res->nlocations == NFS4_FS_LOCATIONS_MAXENTRIES)\n\t\t\tbreak;\n\t\tloc = &res->locations[res->nlocations];\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tm = be32_to_cpup(p);\n\n\t\tdprintk(\"%s: servers:\\n\", __func__);\n\t\tfor (loc->nservers = 0; loc->nservers < m; loc->nservers++) {\n\t\t\tstruct nfs4_string *server;\n\n\t\t\tif (loc->nservers == NFS4_FS_LOCATION_MAXSERVERS) {\n\t\t\t\tunsigned int i;\n\t\t\t\tdprintk(\"%s: using first %u of %u servers \"\n\t\t\t\t\t\"returned for location %u\\n\",\n\t\t\t\t\t\t__func__,\n\t\t\t\t\t\tNFS4_FS_LOCATION_MAXSERVERS,\n\t\t\t\t\t\tm, res->nlocations);\n\t\t\t\tfor (i = loc->nservers; i < m; i++) {\n\t\t\t\t\tunsigned int len;\n\t\t\t\t\tchar *data;\n\t\t\t\t\tstatus = decode_opaque_inline(xdr, &len, &data);\n\t\t\t\t\tif (unlikely(status != 0))\n\t\t\t\t\t\tgoto out_eio;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tserver = &loc->servers[loc->nservers];\n\t\t\tstatus = decode_opaque_inline(xdr, &server->len, &server->data);\n\t\t\tif (unlikely(status != 0))\n\t\t\t\tgoto out_eio;\n\t\t\tdprintk(\"%s \", server->data);\n\t\t}\n\t\tstatus = decode_pathname(xdr, &loc->rootpath);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t}\n\tif (res->nlocations != 0)\n\t\tstatus = NFS_ATTR_FATTR_V4_LOCATIONS;\nout:\n\tdprintk(\"%s: fs_locations done, error = %d\\n\", __func__, status);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\nout_eio:\n\tstatus = -EIO;\n\tgoto out;\n}"
  },
  {
    "function_name": "decode_pathname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3532-3575",
    "snippet": "static int decode_pathname(struct xdr_stream *xdr, struct nfs4_pathname *path)\n{\n\tu32 n;\n\t__be32 *p;\n\tint status = 0;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n == 0)\n\t\tgoto root_path;\n\tdprintk(\"pathname4: \");\n\tif (n > NFS4_PATHNAME_MAXCOMPONENTS) {\n\t\tdprintk(\"cannot parse %d components in path\\n\", n);\n\t\tgoto out_eio;\n\t}\n\tfor (path->ncomponents = 0; path->ncomponents < n; path->ncomponents++) {\n\t\tstruct nfs4_string *component = &path->components[path->ncomponents];\n\t\tstatus = decode_opaque_inline(xdr, &component->len, &component->data);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t\tifdebug (XDR)\n\t\t\tpr_cont(\"%s%.*s \",\n\t\t\t\t(path->ncomponents != n ? \"/ \" : \"\"),\n\t\t\t\tcomponent->len, component->data);\n\t}\nout:\n\treturn status;\nroot_path:\n/* a root pathname is sent as a zero component4 */\n\tpath->ncomponents = 1;\n\tpath->components[0].len=0;\n\tpath->components[0].data=NULL;\n\tdprintk(\"pathname4: /\\n\");\n\tgoto out;\nout_eio:\n\tdprintk(\" status %d\", status);\n\tstatus = -EIO;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3573
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\" status %d\"",
            "status"
          ],
          "line": 3569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"pathname4: /\\n\""
          ],
          "line": 3566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "status != 0"
          ],
          "line": 3552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_opaque_inline",
          "args": [
            "xdr",
            "&component->len",
            "&component->data"
          ],
          "line": 3551
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_inline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3009-3025",
          "snippet": "static int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"cannot parse %d components in path\\n\"",
            "n"
          ],
          "line": 3546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"pathname4: \""
          ],
          "line": 3544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3538
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_pathname(struct xdr_stream *xdr, struct nfs4_pathname *path)\n{\n\tu32 n;\n\t__be32 *p;\n\tint status = 0;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tn = be32_to_cpup(p);\n\tif (n == 0)\n\t\tgoto root_path;\n\tdprintk(\"pathname4: \");\n\tif (n > NFS4_PATHNAME_MAXCOMPONENTS) {\n\t\tdprintk(\"cannot parse %d components in path\\n\", n);\n\t\tgoto out_eio;\n\t}\n\tfor (path->ncomponents = 0; path->ncomponents < n; path->ncomponents++) {\n\t\tstruct nfs4_string *component = &path->components[path->ncomponents];\n\t\tstatus = decode_opaque_inline(xdr, &component->len, &component->data);\n\t\tif (unlikely(status != 0))\n\t\t\tgoto out_eio;\n\t\tifdebug (XDR)\n\t\t\tpr_cont(\"%s%.*s \",\n\t\t\t\t(path->ncomponents != n ? \"/ \" : \"\"),\n\t\t\t\tcomponent->len, component->data);\n\t}\nout:\n\treturn status;\nroot_path:\n/* a root pathname is sent as a zero component4 */\n\tpath->ncomponents = 1;\n\tpath->components[0].len=0;\n\tpath->components[0].data=NULL;\n\tdprintk(\"pathname4: /\\n\");\n\tgoto out;\nout_eio:\n\tdprintk(\" status %d\", status);\n\tstatus = -EIO;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_files_total",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3510-3530",
    "snippet": "static int decode_attr_files_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_TOTAL;\n\t}\n\tdprintk(\"%s: files total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3528
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: files total=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FILES_TOTAL"
          ],
          "line": 3518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FILES_TOTAL - 1U)"
          ],
          "line": 3516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_files_total(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_TOTAL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_TOTAL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_TOTAL;\n\t}\n\tdprintk(\"%s: files total=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_files_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3488-3508",
    "snippet": "static int decode_attr_files_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_FREE;\n\t}\n\tdprintk(\"%s: files free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3506
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: files free=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FILES_FREE"
          ],
          "line": 3496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FILES_FREE - 1U)"
          ],
          "line": 3494
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_files_free(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_FREE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_FREE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_FREE;\n\t}\n\tdprintk(\"%s: files free=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_files_avail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3466-3486",
    "snippet": "static int decode_attr_files_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_AVAIL;\n\t}\n\tdprintk(\"%s: files avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3484
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: files avail=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*res"
          ],
          "line": 3481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "res"
          ],
          "line": 3478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FILES_AVAIL"
          ],
          "line": 3474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FILES_AVAIL - 1U)"
          ],
          "line": 3472
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_files_avail(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *res)\n{\n\t__be32 *p;\n\tint status = 0;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILES_AVAIL - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILES_AVAIL)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, res);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILES_AVAIL;\n\t}\n\tdprintk(\"%s: files avail=%Lu\\n\", __func__, (unsigned long long)*res);\n\treturn status;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_mounted_on_fileid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3443-3464",
    "snippet": "static int decode_attr_mounted_on_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MOUNTED_ON_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MOUNTED_ON_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[1] &= ~FATTR4_WORD1_MOUNTED_ON_FILEID;\n\t\tret = NFS_ATTR_FATTR_MOUNTED_ON_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3462
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: fileid=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*fileid"
          ],
          "line": 3459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "fileid"
          ],
          "line": 3455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[1] & FATTR4_WORD1_MOUNTED_ON_FILEID"
          ],
          "line": 3451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[1] & (FATTR4_WORD1_MOUNTED_ON_FILEID - 1U)"
          ],
          "line": 3449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_mounted_on_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[1] & (FATTR4_WORD1_MOUNTED_ON_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[1] & FATTR4_WORD1_MOUNTED_ON_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[1] &= ~FATTR4_WORD1_MOUNTED_ON_FILEID;\n\t\tret = NFS_ATTR_FATTR_MOUNTED_ON_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_fileid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3420-3441",
    "snippet": "static int decode_attr_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEID;\n\t\tret = NFS_ATTR_FATTR_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3439
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: fileid=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*fileid"
          ],
          "line": 3436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "fileid"
          ],
          "line": 3432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FILEID"
          ],
          "line": 3428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FILEID - 1U)"
          ],
          "line": 3426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fileid(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *fileid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*fileid = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEID)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, fileid);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEID;\n\t\tret = NFS_ATTR_FATTR_FILEID;\n\t}\n\tdprintk(\"%s: fileid=%Lu\\n\", __func__, (unsigned long long)*fileid);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_aclsupport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3399-3418",
    "snippet": "static int decode_attr_aclsupport(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACLSUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACLSUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_ACLSUPPORT;\n\t}\n\tdprintk(\"%s: ACLs supported=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3416
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: ACLs supported=%u\\n\"",
            "__func__",
            "(unsigned int)*res"
          ],
          "line": 3413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_ACLSUPPORT"
          ],
          "line": 3406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_ACLSUPPORT - 1U)"
          ],
          "line": 3404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_aclsupport(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_ACLSUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_ACLSUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_ACLSUPPORT;\n\t}\n\tdprintk(\"%s: ACLs supported=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_filehandle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3367-3397",
    "snippet": "static int decode_attr_filehandle(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tint len;\n\n\tif (fh != NULL)\n\t\tmemset(fh, 0, sizeof(*fh));\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEHANDLE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEHANDLE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tif (len > NFS4_FHSIZE)\n\t\t\treturn -EIO;\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (fh != NULL) {\n\t\t\tmemcpy(fh->data, p, len);\n\t\t\tfh->size = len;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEHANDLE;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3395
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fh->data",
            "p",
            "len"
          ],
          "line": 3388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "len"
          ],
          "line": 3384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FILEHANDLE"
          ],
          "line": 3377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FILEHANDLE - 1U)"
          ],
          "line": 3375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fh",
            "0",
            "sizeof(*fh)"
          ],
          "line": 3373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_filehandle(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\tint len;\n\n\tif (fh != NULL)\n\t\tmemset(fh, 0, sizeof(*fh));\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FILEHANDLE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FILEHANDLE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tlen = be32_to_cpup(p);\n\t\tif (len > NFS4_FHSIZE)\n\t\t\treturn -EIO;\n\t\tp = xdr_inline_decode(xdr, len);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tif (fh != NULL) {\n\t\t\tmemcpy(fh->data, p, len);\n\t\t\tfh->size = len;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_FILEHANDLE;\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3348-3365",
    "snippet": "static int decode_attr_error(struct xdr_stream *xdr, uint32_t *bitmap, int32_t *res)\n{\n\t__be32 *p;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_RDATTR_ERROR - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_RDATTR_ERROR)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tbitmap[0] &= ~FATTR4_WORD0_RDATTR_ERROR;\n\t\t*res = -be32_to_cpup(p);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3363
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_RDATTR_ERROR"
          ],
          "line": 3354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_RDATTR_ERROR - 1U)"
          ],
          "line": 3352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_error(struct xdr_stream *xdr, uint32_t *bitmap, int32_t *res)\n{\n\t__be32 *p;\n\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_RDATTR_ERROR - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_RDATTR_ERROR)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tbitmap[0] &= ~FATTR4_WORD0_RDATTR_ERROR;\n\t\t*res = -be32_to_cpup(p);\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_lease_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3327-3346",
    "snippet": "static int decode_attr_lease_time(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 60;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LEASE_TIME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LEASE_TIME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LEASE_TIME;\n\t}\n\tdprintk(\"%s: file size=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3344
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: file size=%u\\n\"",
            "__func__",
            "(unsigned int)*res"
          ],
          "line": 3341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_LEASE_TIME"
          ],
          "line": 3334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_LEASE_TIME - 1U)"
          ],
          "line": 3332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_lease_time(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 60;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LEASE_TIME - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LEASE_TIME)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LEASE_TIME;\n\t}\n\tdprintk(\"%s: file size=%u\\n\", __func__, (unsigned int)*res);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_fsid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3300-3325",
    "snippet": "static int decode_attr_fsid(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fsid *fsid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\tfsid->major = 0;\n\tfsid->minor = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FSID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FSID)) {\n\t\tp = xdr_inline_decode(xdr, 16);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &fsid->major);\n\t\txdr_decode_hyper(p, &fsid->minor);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FSID;\n\t\tret = NFS_ATTR_FATTR_FSID;\n\t}\n\tdprintk(\"%s: fsid=(0x%Lx/0x%Lx)\\n\", __func__,\n\t\t\t(unsigned long long)fsid->major,\n\t\t\t(unsigned long long)fsid->minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3323
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: fsid=(0x%Lx/0x%Lx)\\n\"",
            "__func__",
            "(unsigned long long)fsid->major",
            "(unsigned long long)fsid->minor"
          ],
          "line": 3318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&fsid->minor"
          ],
          "line": 3314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&fsid->major"
          ],
          "line": 3313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "16"
          ],
          "line": 3310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FSID"
          ],
          "line": 3309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FSID - 1U)"
          ],
          "line": 3307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fsid(struct xdr_stream *xdr, uint32_t *bitmap, struct nfs_fsid *fsid)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\tfsid->major = 0;\n\tfsid->minor = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FSID - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FSID)) {\n\t\tp = xdr_inline_decode(xdr, 16);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\tp = xdr_decode_hyper(p, &fsid->major);\n\t\txdr_decode_hyper(p, &fsid->minor);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FSID;\n\t\tret = NFS_ATTR_FATTR_FSID;\n\t}\n\tdprintk(\"%s: fsid=(0x%Lx/0x%Lx)\\n\", __func__,\n\t\t\t(unsigned long long)fsid->major,\n\t\t\t(unsigned long long)fsid->minor);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_symlink_support",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3279-3298",
    "snippet": "static int decode_attr_symlink_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SYMLINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SYMLINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SYMLINK_SUPPORT;\n\t}\n\tdprintk(\"%s: symlink support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3296
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: symlink support=%s\\n\"",
            "__func__",
            "*res == 0 ? \"false\" : \"true\""
          ],
          "line": 3293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_SYMLINK_SUPPORT"
          ],
          "line": 3286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_SYMLINK_SUPPORT - 1U)"
          ],
          "line": 3284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_symlink_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SYMLINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SYMLINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SYMLINK_SUPPORT;\n\t}\n\tdprintk(\"%s: symlink support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_link_support",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3258-3277",
    "snippet": "static int decode_attr_link_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LINK_SUPPORT;\n\t}\n\tdprintk(\"%s: link support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3275
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: link support=%s\\n\"",
            "__func__",
            "*res == 0 ? \"false\" : \"true\""
          ],
          "line": 3272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_LINK_SUPPORT"
          ],
          "line": 3265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_LINK_SUPPORT - 1U)"
          ],
          "line": 3263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_link_support(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *res)\n{\n\t__be32 *p;\n\n\t*res = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_LINK_SUPPORT - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_LINK_SUPPORT)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*res = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_LINK_SUPPORT;\n\t}\n\tdprintk(\"%s: link support=%s\\n\", __func__, *res == 0 ? \"false\" : \"true\");\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3235-3256",
    "snippet": "static int decode_attr_size(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *size)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*size = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, size);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SIZE;\n\t\tret = NFS_ATTR_FATTR_SIZE;\n\t}\n\tdprintk(\"%s: file size=%Lu\\n\", __func__, (unsigned long long)*size);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3254
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: file size=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*size"
          ],
          "line": 3251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "size"
          ],
          "line": 3247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_SIZE"
          ],
          "line": 3243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_SIZE - 1U)"
          ],
          "line": 3241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_size(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *size)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*size = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_SIZE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_SIZE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, size);\n\t\tbitmap[0] &= ~FATTR4_WORD0_SIZE;\n\t\tret = NFS_ATTR_FATTR_SIZE;\n\t}\n\tdprintk(\"%s: file size=%Lu\\n\", __func__, (unsigned long long)*size);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_change",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3211-3233",
    "snippet": "static int decode_attr_change(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *change)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*change = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_CHANGE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_CHANGE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, change);\n\t\tbitmap[0] &= ~FATTR4_WORD0_CHANGE;\n\t\tret = NFS_ATTR_FATTR_CHANGE;\n\t}\n\tdprintk(\"%s: change attribute=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*change);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3231
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: change attribute=%Lu\\n\"",
            "__func__",
            "(unsigned long long)*change"
          ],
          "line": 3227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "change"
          ],
          "line": 3223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_CHANGE"
          ],
          "line": 3219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_CHANGE - 1U)"
          ],
          "line": 3217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_change(struct xdr_stream *xdr, uint32_t *bitmap, uint64_t *change)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*change = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_CHANGE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_CHANGE)) {\n\t\tp = xdr_inline_decode(xdr, 8);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\txdr_decode_hyper(p, change);\n\t\tbitmap[0] &= ~FATTR4_WORD0_CHANGE;\n\t\tret = NFS_ATTR_FATTR_CHANGE;\n\t}\n\tdprintk(\"%s: change attribute=%Lu\\n\", __func__,\n\t\t\t(unsigned long long)*change);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_fh_expire_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3189-3209",
    "snippet": "static int decode_attr_fh_expire_type(struct xdr_stream *xdr,\n\t\t\t\t      uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FH_EXPIRE_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FH_EXPIRE_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FH_EXPIRE_TYPE;\n\t}\n\tdprintk(\"%s: expire type=0x%x\\n\", __func__, *type);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3207
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: expire type=0x%x\\n\"",
            "__func__",
            "*type"
          ],
          "line": 3204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_FH_EXPIRE_TYPE"
          ],
          "line": 3197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_FH_EXPIRE_TYPE - 1U)"
          ],
          "line": 3195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_fh_expire_type(struct xdr_stream *xdr,\n\t\t\t\t      uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_FH_EXPIRE_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_FH_EXPIRE_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tbitmap[0] &= ~FATTR4_WORD0_FH_EXPIRE_TYPE;\n\t}\n\tdprintk(\"%s: expire type=0x%x\\n\", __func__, *type);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3162-3187",
    "snippet": "static int decode_attr_type(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tif (*type < NF4REG || *type > NF4NAMEDATTR) {\n\t\t\tdprintk(\"%s: bad type %d\\n\", __func__, *type);\n\t\t\treturn -EIO;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_TYPE;\n\t\tret = NFS_ATTR_FATTR_TYPE;\n\t}\n\tdprintk(\"%s: type=0%o\\n\", __func__, nfs_type2fmt[*type]);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3185
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: type=0%o\\n\"",
            "__func__",
            "nfs_type2fmt[*type]"
          ],
          "line": 3182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: bad type %d\\n\"",
            "__func__",
            "*type"
          ],
          "line": 3176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_TYPE"
          ],
          "line": 3170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "bitmap[0] & (FATTR4_WORD0_TYPE - 1U)"
          ],
          "line": 3168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic const umode_t nfs_type2fmt[] = {\n\t[NF4BAD] = 0,\n\t[NF4REG] = S_IFREG,\n\t[NF4DIR] = S_IFDIR,\n\t[NF4BLK] = S_IFBLK,\n\t[NF4CHR] = S_IFCHR,\n\t[NF4LNK] = S_IFLNK,\n\t[NF4SOCK] = S_IFSOCK,\n\t[NF4FIFO] = S_IFIFO,\n\t[NF4ATTRDIR] = 0,\n\t[NF4NAMEDATTR] = 0,\n};\n\nstatic int decode_attr_type(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *type)\n{\n\t__be32 *p;\n\tint ret = 0;\n\n\t*type = 0;\n\tif (unlikely(bitmap[0] & (FATTR4_WORD0_TYPE - 1U)))\n\t\treturn -EIO;\n\tif (likely(bitmap[0] & FATTR4_WORD0_TYPE)) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(!p))\n\t\t\tgoto out_overflow;\n\t\t*type = be32_to_cpup(p);\n\t\tif (*type < NF4REG || *type > NF4NAMEDATTR) {\n\t\t\tdprintk(\"%s: bad type %d\\n\", __func__, *type);\n\t\t\treturn -EIO;\n\t\t}\n\t\tbitmap[0] &= ~FATTR4_WORD0_TYPE;\n\t\tret = NFS_ATTR_FATTR_TYPE;\n\t}\n\tdprintk(\"%s: type=0%o\\n\", __func__, nfs_type2fmt[*type]);\n\treturn ret;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_supported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3147-3160",
    "snippet": "static int decode_attr_supported(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *bitmask)\n{\n\tif (likely(bitmap[0] & FATTR4_WORD0_SUPPORTED_ATTRS)) {\n\t\tint ret;\n\t\tret = decode_attr_bitmap(xdr, bitmask);\n\t\tif (unlikely(ret < 0))\n\t\t\treturn ret;\n\t\tbitmap[0] &= ~FATTR4_WORD0_SUPPORTED_ATTRS;\n\t} else\n\t\tbitmask[0] = bitmask[1] = bitmask[2] = 0;\n\tdprintk(\"%s: bitmask=%08x:%08x:%08x\\n\", __func__,\n\t\tbitmask[0], bitmask[1], bitmask[2]);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: bitmask=%08x:%08x:%08x\\n\"",
            "__func__",
            "bitmask[0]",
            "bitmask[1]",
            "bitmask[2]"
          ],
          "line": 3157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret < 0"
          ],
          "line": 3152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_attr_bitmap",
          "args": [
            "xdr",
            "bitmask"
          ],
          "line": 3151
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attr_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3104-3130",
          "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bitmap[0] & FATTR4_WORD0_SUPPORTED_ATTRS"
          ],
          "line": 3149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_supported(struct xdr_stream *xdr, uint32_t *bitmap, uint32_t *bitmask)\n{\n\tif (likely(bitmap[0] & FATTR4_WORD0_SUPPORTED_ATTRS)) {\n\t\tint ret;\n\t\tret = decode_attr_bitmap(xdr, bitmask);\n\t\tif (unlikely(ret < 0))\n\t\t\treturn ret;\n\t\tbitmap[0] &= ~FATTR4_WORD0_SUPPORTED_ATTRS;\n\t} else\n\t\tbitmask[0] = bitmask[1] = bitmask[2] = 0;\n\tdprintk(\"%s: bitmask=%08x:%08x:%08x\\n\", __func__,\n\t\tbitmask[0], bitmask[1], bitmask[2]);\n\treturn 0;\n}"
  },
  {
    "function_name": "decode_attr_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3132-3145",
    "snippet": "static int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3143
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_stream_pos",
          "args": [
            "xdr"
          ],
          "line": 3140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_length(struct xdr_stream *xdr, uint32_t *attrlen, unsigned int *savep)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*attrlen = be32_to_cpup(p);\n\t*savep = xdr_stream_pos(xdr);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_attr_bitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3104-3130",
    "snippet": "static int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3128
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 3121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 3119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "(bmlen << 2)"
          ],
          "line": 3115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_attr_bitmap(struct xdr_stream *xdr, uint32_t *bitmap)\n{\n\tuint32_t bmlen;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tbmlen = be32_to_cpup(p);\n\n\tbitmap[0] = bitmap[1] = bitmap[2] = 0;\n\tp = xdr_inline_decode(xdr, (bmlen << 2));\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\tif (bmlen > 0) {\n\t\tbitmap[0] = be32_to_cpup(p++);\n\t\tif (bmlen > 1) {\n\t\t\tbitmap[1] = be32_to_cpup(p++);\n\t\t\tif (bmlen > 2)\n\t\t\t\tbitmap[2] = be32_to_cpup(p);\n\t\t}\n\t}\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_ace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3091-3102",
    "snippet": "static int decode_ace(struct xdr_stream *xdr, void *ace, struct nfs_client *clp)\n{\n\t__be32 *p;\n\tunsigned int strlen;\n\tchar *str;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (likely(p))\n\t\treturn decode_opaque_inline(xdr, &strlen, &str);\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3100
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_opaque_inline",
          "args": [
            "xdr",
            "&strlen",
            "&str"
          ],
          "line": 3099
        },
        "resolved": true,
        "details": {
          "function_name": "decode_opaque_inline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3009-3025",
          "snippet": "static int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "p"
          ],
          "line": 3098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "12"
          ],
          "line": 3097
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_ace(struct xdr_stream *xdr, void *ace, struct nfs_client *clp)\n{\n\t__be32 *p;\n\tunsigned int strlen;\n\tchar *str;\n\n\tp = xdr_inline_decode(xdr, 12);\n\tif (likely(p))\n\t\treturn decode_opaque_inline(xdr, &strlen, &str);\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_op_hdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3082-3088",
    "snippet": "static int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__decode_op_hdr",
          "args": [
            "xdr",
            "expected",
            "&retval"
          ],
          "line": 3086
        },
        "resolved": true,
        "details": {
          "function_name": "__decode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3051-3080",
          "snippet": "static bool __decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected,\n\t\tint *nfs_retval)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (unlikely(opnum != expected))\n\t\tgoto out_bad_operation;\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK)\n\t\t*nfs_retval = 0;\n\telse\n\t\t*nfs_retval = nfs4_stat_to_errno(nfserr);\n\treturn true;\nout_bad_operation:\n\tdprintk(\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\",\n\t\t\topnum, expected);\n\t*nfs_retval = -EREMOTEIO;\n\treturn false;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\t*nfs_retval = -EIO;\n\treturn false;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic bool __decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected,\n\t\tint *nfs_retval)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (unlikely(opnum != expected))\n\t\tgoto out_bad_operation;\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK)\n\t\t*nfs_retval = 0;\n\telse\n\t\t*nfs_retval = nfs4_stat_to_errno(nfserr);\n\treturn true;\nout_bad_operation:\n\tdprintk(\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\",\n\t\t\topnum, expected);\n\t*nfs_retval = -EREMOTEIO;\n\treturn false;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\t*nfs_retval = -EIO;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected)\n{\n\tint retval;\n\n\t__decode_op_hdr(xdr, expected, &retval);\n\treturn retval;\n}"
  },
  {
    "function_name": "__decode_op_hdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3051-3080",
    "snippet": "static bool __decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected,\n\t\tint *nfs_retval)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (unlikely(opnum != expected))\n\t\tgoto out_bad_operation;\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK)\n\t\t*nfs_retval = 0;\n\telse\n\t\t*nfs_retval = nfs4_stat_to_errno(nfserr);\n\treturn true;\nout_bad_operation:\n\tdprintk(\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\",\n\t\t\topnum, expected);\n\t*nfs_retval = -EREMOTEIO;\n\treturn false;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\t*nfs_retval = -EIO;\n\treturn false;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs4_stat_to_errno(int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3077
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\"",
            "opnum",
            "expected"
          ],
          "line": 3071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_stat_to_errno",
          "args": [
            "nfserr"
          ],
          "line": 3068
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "7333-7351",
          "snippet": "static int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);",
            "static struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\nstatic struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "opnum != expected"
          ],
          "line": 3062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 3061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3058
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic bool __decode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 expected,\n\t\tint *nfs_retval)\n{\n\t__be32 *p;\n\tuint32_t opnum;\n\tint32_t nfserr;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\topnum = be32_to_cpup(p++);\n\tif (unlikely(opnum != expected))\n\t\tgoto out_bad_operation;\n\tnfserr = be32_to_cpup(p);\n\tif (nfserr == NFS_OK)\n\t\t*nfs_retval = 0;\n\telse\n\t\t*nfs_retval = nfs4_stat_to_errno(nfserr);\n\treturn true;\nout_bad_operation:\n\tdprintk(\"nfs: Server returned operation\"\n\t\t\" %d but we issued a request for %d\\n\",\n\t\t\topnum, expected);\n\t*nfs_retval = -EREMOTEIO;\n\treturn false;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\t*nfs_retval = -EIO;\n\treturn false;\n}"
  },
  {
    "function_name": "decode_compound_hdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3027-3049",
    "snippet": "static int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs4_stat_to_errno(int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3047
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_stat_to_errno",
          "args": [
            "hdr->status"
          ],
          "line": 3044
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "7333-7351",
          "snippet": "static int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_stat_to_errno(int);",
            "static struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\nstatic struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS4_OK,\t\t0\t\t},\n\t{ NFS4ERR_PERM,\t\t-EPERM\t\t},\n\t{ NFS4ERR_NOENT,\t-ENOENT\t\t},\n\t{ NFS4ERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFS4ERR_NXIO,\t\t-ENXIO\t\t},\n\t{ NFS4ERR_ACCESS,\t-EACCES\t\t},\n\t{ NFS4ERR_EXIST,\t-EEXIST\t\t},\n\t{ NFS4ERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFS4ERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFS4ERR_ISDIR,\t-EISDIR\t\t},\n\t{ NFS4ERR_INVAL,\t-EINVAL\t\t},\n\t{ NFS4ERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFS4ERR_NOSPC,\t-ENOSPC\t\t},\n\t{ NFS4ERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFS4ERR_MLINK,\t-EMLINK\t\t},\n\t{ NFS4ERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFS4ERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFS4ERR_DQUOT,\t-EDQUOT\t\t},\n\t{ NFS4ERR_STALE,\t-ESTALE\t\t},\n\t{ NFS4ERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFS4ERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFS4ERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFS4ERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFS4ERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFS4ERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFS4ERR_LOCKED,\t-EAGAIN\t\t},\n\t{ NFS4ERR_SYMLINK,\t-ELOOP\t\t},\n\t{ NFS4ERR_OP_ILLEGAL,\t-EOPNOTSUPP\t},\n\t{ NFS4ERR_DEADLOCK,\t-EDEADLK\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int\nnfs4_stat_to_errno(int stat)\n{\n\tint i;\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == stat)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tif (stat <= 10000 || stat > 10100) {\n\t\t/* The server is looney tunes. */\n\t\treturn -EREMOTEIO;\n\t}\n\t/* If we cannot translate the error, the recovery routines should\n\t * handle it.\n\t * Note: remaining NFSv4 error codes have values > 10000, so should\n\t * not conflict with native Linux error codes.\n\t */\n\treturn -stat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "hdr->nops < 1"
          ],
          "line": 3043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "hdr->taglen"
          ],
          "line": 3041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "hdr->taglen + 4"
          ],
          "line": 3037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 3034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8"
          ],
          "line": 3031
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_stat_to_errno(int);\n\nstatic int decode_compound_hdr(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 8);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->status = be32_to_cpup(p++);\n\thdr->taglen = be32_to_cpup(p);\n\n\tp = xdr_inline_decode(xdr, hdr->taglen + 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\thdr->tag = (char *)p;\n\tp += XDR_QUADLEN(hdr->taglen);\n\thdr->nops = be32_to_cpup(p);\n\tif (unlikely(hdr->nops < 1))\n\t\treturn nfs4_stat_to_errno(hdr->status);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_opaque_inline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3009-3025",
    "snippet": "static int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 3023
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "3002-3007",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "*len"
          ],
          "line": 3017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 3016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!p"
          ],
          "line": 3014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 3013
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_opaque_inline(struct xdr_stream *xdr, unsigned int *len, char **string)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*len = be32_to_cpup(p);\n\tp = xdr_inline_decode(xdr, *len);\n\tif (unlikely(!p))\n\t\tgoto out_overflow;\n\t*string = (char *)p;\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "print_overflow_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "3002-3007",
    "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\"",
            "func",
            "xdr->end - xdr->p"
          ],
          "line": 3004
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"nfs: %s: prematurely hit end of receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_free_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2987-2999",
    "snippet": "static void nfs4_xdr_enc_free_stateid(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_free_stateid_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_free_stateid(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2998
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_free_stateid",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2997
        },
        "resolved": true,
        "details": {
          "function_name": "encode_free_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2036-2042",
          "snippet": "static void encode_free_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_free_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_FREE_STATEID, decode_free_stateid_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_free_stateid_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_free_stateid_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_free_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_free_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_FREE_STATEID, decode_free_stateid_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2996
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2995
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2992
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_free_stateid(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_free_stateid_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_free_stateid(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_test_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2970-2982",
    "snippet": "static void nfs4_xdr_enc_test_stateid(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs41_test_stateid_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_test_stateid(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2981
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_test_stateid",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2980
        },
        "resolved": true,
        "details": {
          "function_name": "encode_test_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2027-2034",
          "snippet": "static void encode_test_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_test_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_TEST_STATEID, decode_test_stateid_maxsz, hdr);\n\tencode_uint32(xdr, 1);\n\tencode_nfs4_stateid(xdr, args->stateid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_test_stateid_maxsz\t(op_decode_hdr_maxsz + 2 + 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_test_stateid_maxsz\t(op_decode_hdr_maxsz + 2 + 1)\n\nstatic void encode_test_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_test_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_TEST_STATEID, decode_test_stateid_maxsz, hdr);\n\tencode_uint32(xdr, 1);\n\tencode_nfs4_stateid(xdr, args->stateid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2979
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2978
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2975
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_test_stateid(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs41_test_stateid_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_test_stateid(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_secinfo_no_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2951-2965",
    "snippet": "static int nfs4_xdr_enc_secinfo_no_name(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs41_secinfo_no_name_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putrootfh(xdr, &hdr);\n\tencode_secinfo_no_name(xdr, args, &hdr);\n\tencode_nops(&hdr);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2963
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_secinfo_no_name",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2962
        },
        "resolved": true,
        "details": {
          "function_name": "encode_secinfo_no_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2017-2025",
          "snippet": "static int\nencode_secinfo_no_name(struct xdr_stream *xdr,\n\t\t       const struct nfs41_secinfo_no_name_args *args,\n\t\t       struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO_NO_NAME, decode_secinfo_no_name_maxsz, hdr);\n\tencode_uint32(xdr, args->style);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_secinfo_no_name_maxsz decode_secinfo_maxsz"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_secinfo_no_name_maxsz decode_secinfo_maxsz\n\nstatic int\nencode_secinfo_no_name(struct xdr_stream *xdr,\n\t\t       const struct nfs41_secinfo_no_name_args *args,\n\t\t       struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO_NO_NAME, decode_secinfo_no_name_maxsz, hdr);\n\tencode_uint32(xdr, args->style);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putrootfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2961
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putrootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1536-1539",
          "snippet": "static void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2960
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2959
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2956
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs4_xdr_enc_secinfo_no_name(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs41_secinfo_no_name_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putrootfh(xdr, &hdr);\n\tencode_secinfo_no_name(xdr, args, &hdr);\n\tencode_nops(&hdr);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_layoutreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2933-2946",
    "snippet": "static void nfs4_xdr_enc_layoutreturn(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_layoutreturn_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, NFS_FH(args->inode), &hdr);\n\tencode_layoutreturn(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2945
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_layoutreturn",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2944
        },
        "resolved": true,
        "details": {
          "function_name": "encode_layoutreturn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1991-2015",
          "snippet": "static void\nencode_layoutreturn(struct xdr_stream *xdr,\n\t\t    const struct nfs4_layoutreturn_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTRETURN, decode_layoutreturn_maxsz, hdr);\n\tp = reserve_space(xdr, 16);\n\t*p++ = cpu_to_be32(0);\t\t/* reclaim. always 0 for now */\n\t*p++ = cpu_to_be32(args->layout_type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\t*p = cpu_to_be32(RETURN_FILE);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tspin_lock(&args->inode->i_lock);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tspin_unlock(&args->inode->i_lock);\n\tif (NFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn) {\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn(\n\t\t\tNFS_I(args->inode)->layout, xdr, args);\n\t} else\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_layoutreturn_maxsz (op_decode_hdr_maxsz + \\\n\t\t\t\t1 + decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_layoutreturn_maxsz (op_decode_hdr_maxsz + \\\n\t\t\t\t1 + decode_stateid_maxsz)\n\nstatic void\nencode_layoutreturn(struct xdr_stream *xdr,\n\t\t    const struct nfs4_layoutreturn_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTRETURN, decode_layoutreturn_maxsz, hdr);\n\tp = reserve_space(xdr, 16);\n\t*p++ = cpu_to_be32(0);\t\t/* reclaim. always 0 for now */\n\t*p++ = cpu_to_be32(args->layout_type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\t*p = cpu_to_be32(RETURN_FILE);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tspin_lock(&args->inode->i_lock);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tspin_unlock(&args->inode->i_lock);\n\tif (NFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn) {\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn(\n\t\t\tNFS_I(args->inode)->layout, xdr, args);\n\t} else\n\t\tencode_uint32(xdr, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "NFS_FH(args->inode)",
            "&hdr"
          ],
          "line": 2943
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "args->inode"
          ],
          "line": 2943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2942
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2941
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2938
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_layoutreturn(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_layoutreturn_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, NFS_FH(args->inode), &hdr);\n\tencode_layoutreturn(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_layoutcommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2912-2928",
    "snippet": "static void nfs4_xdr_enc_layoutcommit(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_layoutcommit_args *args)\n{\n\tstruct nfs4_layoutcommit_data *data =\n\t\tcontainer_of(args, struct nfs4_layoutcommit_data, args);\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, NFS_FH(args->inode), &hdr);\n\tencode_layoutcommit(xdr, data->args.inode, args, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2927
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2926
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_layoutcommit",
          "args": [
            "xdr",
            "data->args.inode",
            "args",
            "&hdr"
          ],
          "line": 2925
        },
        "resolved": true,
        "details": {
          "function_name": "encode_layoutcommit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1953-1989",
          "snippet": "static int\nencode_layoutcommit(struct xdr_stream *xdr,\n\t\t    struct inode *inode,\n\t\t    struct nfs4_layoutcommit_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: lbw: %llu type: %d\\n\", __func__, args->lastbytewritten,\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->id);\n\n\tencode_op_hdr(xdr, OP_LAYOUTCOMMIT, decode_layoutcommit_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t/* Only whole file layouts */\n\tp = xdr_encode_hyper(p, 0); /* offset */\n\tp = xdr_encode_hyper(p, args->lastbytewritten + 1);\t/* length */\n\t*p = cpu_to_be32(0); /* reclaim */\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(1); /* newoffset = TRUE */\n\tp = xdr_encode_hyper(p, args->lastbytewritten);\n\t*p++ = cpu_to_be32(0); /* Never send time_modify_changed */\n\t*p++ = cpu_to_be32(NFS_SERVER(args->inode)->pnfs_curr_ld->id);/* type */\n\n\tif (NFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit) {\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit(\n\t\t\tNFS_I(inode)->layout, xdr, args);\n\t} else {\n\t\tencode_uint32(xdr, args->layoutupdate_len);\n\t\tif (args->layoutupdate_pages) {\n\t\t\txdr_write_pages(xdr, args->layoutupdate_pages, 0,\n\t\t\t\t\targs->layoutupdate_len);\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_layoutcommit_maxsz (op_decode_hdr_maxsz + 3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_layoutcommit_maxsz (op_decode_hdr_maxsz + 3)\n\nstatic int\nencode_layoutcommit(struct xdr_stream *xdr,\n\t\t    struct inode *inode,\n\t\t    struct nfs4_layoutcommit_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: lbw: %llu type: %d\\n\", __func__, args->lastbytewritten,\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->id);\n\n\tencode_op_hdr(xdr, OP_LAYOUTCOMMIT, decode_layoutcommit_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t/* Only whole file layouts */\n\tp = xdr_encode_hyper(p, 0); /* offset */\n\tp = xdr_encode_hyper(p, args->lastbytewritten + 1);\t/* length */\n\t*p = cpu_to_be32(0); /* reclaim */\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(1); /* newoffset = TRUE */\n\tp = xdr_encode_hyper(p, args->lastbytewritten);\n\t*p++ = cpu_to_be32(0); /* Never send time_modify_changed */\n\t*p++ = cpu_to_be32(NFS_SERVER(args->inode)->pnfs_curr_ld->id);/* type */\n\n\tif (NFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit) {\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit(\n\t\t\tNFS_I(inode)->layout, xdr, args);\n\t} else {\n\t\tencode_uint32(xdr, args->layoutupdate_len);\n\t\tif (args->layoutupdate_pages) {\n\t\t\txdr_write_pages(xdr, args->layoutupdate_pages, 0,\n\t\t\t\t\targs->layoutupdate_len);\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "NFS_FH(args->inode)",
            "&hdr"
          ],
          "line": 2924
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "args->inode"
          ],
          "line": 2924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2923
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2922
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2919
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "args",
            "structnfs4_layoutcommit_data",
            "args"
          ],
          "line": 2917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_layoutcommit(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_layoutcommit_args *args)\n{\n\tstruct nfs4_layoutcommit_data *data =\n\t\tcontainer_of(args, struct nfs4_layoutcommit_data, args);\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, NFS_FH(args->inode), &hdr);\n\tencode_layoutcommit(xdr, data->args.inode, args, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_layoutget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2890-2907",
    "snippet": "static void nfs4_xdr_enc_layoutget(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   struct nfs4_layoutget_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, NFS_FH(args->inode), &hdr);\n\tencode_layoutget(xdr, args, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2,\n\t    args->layout.pages, 0, args->layout.pglen);\n\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2906
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "hdr.replen << 2",
            "args->layout.pages",
            "0",
            "args->layout.pglen"
          ],
          "line": 2903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_layoutget",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2901
        },
        "resolved": true,
        "details": {
          "function_name": "encode_layoutget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1926-1951",
          "snippet": "static void\nencode_layoutget(struct xdr_stream *xdr,\n\t\t      const struct nfs4_layoutget_args *args,\n\t\t      struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTGET, decode_layoutget_maxsz, hdr);\n\tp = reserve_space(xdr, 36);\n\t*p++ = cpu_to_be32(0);     /* Signal layout available */\n\t*p++ = cpu_to_be32(args->type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tp = xdr_encode_hyper(p, args->minlength);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tencode_uint32(xdr, args->maxcount);\n\n\tdprintk(\"%s: 1st type:0x%x iomode:%d off:%lu len:%lu mc:%d\\n\",\n\t\t__func__,\n\t\targs->type,\n\t\targs->range.iomode,\n\t\t(unsigned long)args->range.offset,\n\t\t(unsigned long)args->range.length,\n\t\targs->maxcount);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_layoutget_maxsz\t(op_decode_hdr_maxsz + 8 + \\\n\t\t\t\tdecode_stateid_maxsz + \\\n\t\t\t\tXDR_QUADLEN(PNFS_LAYOUT_MAXSIZE))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_layoutget_maxsz\t(op_decode_hdr_maxsz + 8 + \\\n\t\t\t\tdecode_stateid_maxsz + \\\n\t\t\t\tXDR_QUADLEN(PNFS_LAYOUT_MAXSIZE))\n\nstatic void\nencode_layoutget(struct xdr_stream *xdr,\n\t\t      const struct nfs4_layoutget_args *args,\n\t\t      struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTGET, decode_layoutget_maxsz, hdr);\n\tp = reserve_space(xdr, 36);\n\t*p++ = cpu_to_be32(0);     /* Signal layout available */\n\t*p++ = cpu_to_be32(args->type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tp = xdr_encode_hyper(p, args->minlength);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tencode_uint32(xdr, args->maxcount);\n\n\tdprintk(\"%s: 1st type:0x%x iomode:%d off:%lu len:%lu mc:%d\\n\",\n\t\t__func__,\n\t\targs->type,\n\t\targs->range.iomode,\n\t\t(unsigned long)args->range.offset,\n\t\t(unsigned long)args->range.length,\n\t\targs->maxcount);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "NFS_FH(args->inode)",
            "&hdr"
          ],
          "line": 2900
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "args->inode"
          ],
          "line": 2900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2899
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2898
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2895
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_layoutget(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   struct nfs4_layoutget_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, NFS_FH(args->inode), &hdr);\n\tencode_layoutget(xdr, args, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2,\n\t    args->layout.pages, 0, args->layout.pglen);\n\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_getdeviceinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2866-2885",
    "snippet": "static void nfs4_xdr_enc_getdeviceinfo(struct rpc_rqst *req,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs4_getdeviceinfo_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_getdeviceinfo(xdr, args, &hdr);\n\n\t/* set up reply kvec. Subtract notification bitmap max size (2)\n\t * so that notification bitmap is put in xdr_buf tail */\n\txdr_inline_pages(&req->rq_rcv_buf, (hdr.replen - 2) << 2,\n\t\t\t args->pdev->pages, args->pdev->pgbase,\n\t\t\t args->pdev->pglen);\n\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2884
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "(hdr.replen - 2) << 2",
            "args->pdev->pages",
            "args->pdev->pgbase",
            "args->pdev->pglen"
          ],
          "line": 2880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_getdeviceinfo",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2876
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getdeviceinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1907-1924",
          "snippet": "static void\nencode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t     const struct nfs4_getdeviceinfo_args *args,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETDEVICEINFO, decode_getdeviceinfo_maxsz, hdr);\n\tp = reserve_space(xdr, NFS4_DEVICEID4_SIZE + 4 + 4);\n\tp = xdr_encode_opaque_fixed(p, args->pdev->dev_id.data,\n\t\t\t\t    NFS4_DEVICEID4_SIZE);\n\t*p++ = cpu_to_be32(args->pdev->layout_type);\n\t*p++ = cpu_to_be32(args->pdev->maxcount);\t/* gdia_maxcount */\n\n\tp = reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(1);\t\t\t/* bitmap length */\n\t*p++ = cpu_to_be32(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void\nencode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t     const struct nfs4_getdeviceinfo_args *args,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETDEVICEINFO, decode_getdeviceinfo_maxsz, hdr);\n\tp = reserve_space(xdr, NFS4_DEVICEID4_SIZE + 4 + 4);\n\tp = xdr_encode_opaque_fixed(p, args->pdev->dev_id.data,\n\t\t\t\t    NFS4_DEVICEID4_SIZE);\n\t*p++ = cpu_to_be32(args->pdev->layout_type);\n\t*p++ = cpu_to_be32(args->pdev->maxcount);\t/* gdia_maxcount */\n\n\tp = reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(1);\t\t\t/* bitmap length */\n\t*p++ = cpu_to_be32(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2875
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2874
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2871
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_getdeviceinfo(struct rpc_rqst *req,\n\t\t\t\t       struct xdr_stream *xdr,\n\t\t\t\t       struct nfs4_getdeviceinfo_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_getdeviceinfo(xdr, args, &hdr);\n\n\t/* set up reply kvec. Subtract notification bitmap max size (2)\n\t * so that notification bitmap is put in xdr_buf tail */\n\txdr_inline_pages(&req->rq_rcv_buf, (hdr.replen - 2) << 2,\n\t\t\t args->pdev->pages, args->pdev->pgbase,\n\t\t\t args->pdev->pglen);\n\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_reclaim_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2849-2861",
    "snippet": "static void nfs4_xdr_enc_reclaim_complete(struct rpc_rqst *req,\n\t\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_reclaim_complete_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args)\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_reclaim_complete(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2860
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_reclaim_complete",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2859
        },
        "resolved": true,
        "details": {
          "function_name": "encode_reclaim_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1859-1865",
          "snippet": "static void encode_reclaim_complete(struct xdr_stream *xdr,\n\t\t\t\t    struct nfs41_reclaim_complete_args *args,\n\t\t\t\t    struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RECLAIM_COMPLETE, decode_reclaim_complete_maxsz, hdr);\n\tencode_uint32(xdr, args->one_fs);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_reclaim_complete_maxsz\t(op_decode_hdr_maxsz + 4)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_reclaim_complete_maxsz\t(op_decode_hdr_maxsz + 4)\n\nstatic void encode_reclaim_complete(struct xdr_stream *xdr,\n\t\t\t\t    struct nfs41_reclaim_complete_args *args,\n\t\t\t\t    struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RECLAIM_COMPLETE, decode_reclaim_complete_maxsz, hdr);\n\tencode_uint32(xdr, args->one_fs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2858
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2857
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2854
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_reclaim_complete(struct rpc_rqst *req,\n\t\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_reclaim_complete_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args)\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_reclaim_complete(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_get_lease_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2830-2844",
    "snippet": "static void nfs4_xdr_enc_get_lease_time(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_get_lease_time_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->la_seq_args),\n\t};\n\tconst u32 lease_bitmap[3] = { FATTR4_WORD0_LEASE_TIME };\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->la_seq_args, &hdr);\n\tencode_putrootfh(xdr, &hdr);\n\tencode_fsinfo(xdr, lease_bitmap, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2843
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fsinfo",
          "args": [
            "xdr",
            "lease_bitmap",
            "&hdr"
          ],
          "line": 2842
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1238-1245",
          "snippet": "static void encode_fsinfo(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & nfs4_fsinfo_bitmap[0],\n\t\t\t     bitmask[1] & nfs4_fsinfo_bitmap[1],\n\t\t\t     bitmask[2] & nfs4_fsinfo_bitmap[2],\n\t\t\t     hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fsinfo(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & nfs4_fsinfo_bitmap[0],\n\t\t\t     bitmask[1] & nfs4_fsinfo_bitmap[1],\n\t\t\t     bitmask[2] & nfs4_fsinfo_bitmap[2],\n\t\t\t     hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putrootfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2841
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putrootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1536-1539",
          "snippet": "static void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->la_seq_args",
            "&hdr"
          ],
          "line": 2840
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2839
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->la_seq_args"
          ],
          "line": 2835
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_get_lease_time(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs4_get_lease_time_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->la_seq_args),\n\t};\n\tconst u32 lease_bitmap[3] = { FATTR4_WORD0_LEASE_TIME };\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->la_seq_args, &hdr);\n\tencode_putrootfh(xdr, &hdr);\n\tencode_fsinfo(xdr, lease_bitmap, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2815-2825",
    "snippet": "static void nfs4_xdr_enc_sequence(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  struct nfs4_sequence_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2824
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2823
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2822
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "args"
          ],
          "line": 2819
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_sequence(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  struct nfs4_sequence_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_destroy_clientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2799-2810",
    "snippet": "static void nfs4_xdr_enc_destroy_clientid(struct rpc_rqst *req,\n\t\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t\t struct nfs_client *clp)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = clp->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_destroy_clientid(xdr, clp->cl_clientid, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2809
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_destroy_clientid",
          "args": [
            "xdr",
            "clp->cl_clientid",
            "&hdr"
          ],
          "line": 2808
        },
        "resolved": true,
        "details": {
          "function_name": "encode_destroy_clientid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1851-1857",
          "snippet": "static void encode_destroy_clientid(struct xdr_stream *xdr,\n\t\t\t\t   uint64_t clientid,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_CLIENTID, decode_destroy_clientid_maxsz, hdr);\n\tencode_uint64(xdr, clientid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_destroy_clientid_maxsz   (op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_destroy_clientid_maxsz   (op_decode_hdr_maxsz)\n\nstatic void encode_destroy_clientid(struct xdr_stream *xdr,\n\t\t\t\t   uint64_t clientid,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_CLIENTID, decode_destroy_clientid_maxsz, hdr);\n\tencode_uint64(xdr, clientid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2807
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_destroy_clientid(struct rpc_rqst *req,\n\t\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t\t struct nfs_client *clp)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = clp->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_destroy_clientid(xdr, clp->cl_clientid, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_destroy_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2783-2794",
    "snippet": "static void nfs4_xdr_enc_destroy_session(struct rpc_rqst *req,\n\t\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t\t struct nfs4_session *session)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = session->clp->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_destroy_session(xdr, session, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2793
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_destroy_session",
          "args": [
            "xdr",
            "session",
            "&hdr"
          ],
          "line": 2792
        },
        "resolved": true,
        "details": {
          "function_name": "encode_destroy_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1843-1849",
          "snippet": "static void encode_destroy_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs4_session *session,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_SESSION, decode_destroy_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_destroy_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs4_session *session,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_SESSION, decode_destroy_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2791
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_destroy_session(struct rpc_rqst *req,\n\t\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t\t struct nfs4_session *session)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = session->clp->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_destroy_session(xdr, session, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_create_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2767-2778",
    "snippet": "static void nfs4_xdr_enc_create_session(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs41_create_session_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_create_session(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2777
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_create_session",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2776
        },
        "resolved": true,
        "details": {
          "function_name": "encode_create_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1790-1841",
          "snippet": "static void encode_create_session(struct xdr_stream *xdr,\n\t\t\t\t  struct nfs41_create_session_args *args,\n\t\t\t\t  struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct nfs_client *clp = args->client;\n\tstruct rpc_clnt *clnt = clp->cl_rpcclient;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\tu32 max_resp_sz_cached;\n\n\t/*\n\t * Assumes OPEN is the biggest non-idempotent compound.\n\t * 2 is the verifier.\n\t */\n\tmax_resp_sz_cached = (NFS4_dec_open_sz + RPC_REPHDRSIZE +\n\t\t\t      RPC_MAX_AUTH_SIZE + 2) * XDR_UNIT;\n\n\tencode_op_hdr(xdr, OP_CREATE_SESSION, decode_create_session_maxsz, hdr);\n\tp = reserve_space(xdr, 16 + 2*28 + 20 + clnt->cl_nodelen + 12);\n\tp = xdr_encode_hyper(p, args->clientid);\n\t*p++ = cpu_to_be32(args->seqid);\t\t\t/*Sequence id */\n\t*p++ = cpu_to_be32(args->flags);\t\t\t/*flags */\n\n\t/* Fore Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(max_resp_sz_cached);\t\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t/* Back Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz_cached);\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t*p++ = cpu_to_be32(args->cb_program);\t\t/* cb_program */\n\t*p++ = cpu_to_be32(1);\n\t*p++ = cpu_to_be32(RPC_AUTH_UNIX);\t\t\t/* auth_sys */\n\n\t/* authsys_parms rfc1831 */\n\t*p++ = cpu_to_be32(nn->boot_time.tv_nsec);\t/* stamp */\n\tp = xdr_encode_array(p, clnt->cl_nodename, clnt->cl_nodelen);\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* UID */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* GID */\n\t*p = cpu_to_be32(0);\t\t\t\t/* No more gids */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_dec_open_sz        (compound_decode_hdr_maxsz + \\\n\t\t\t\tdecode_sequence_maxsz + \\\n\t\t\t\tdecode_putfh_maxsz + \\\n\t\t\t\tdecode_open_maxsz + \\\n\t\t\t\tdecode_access_maxsz + \\\n\t\t\t\tdecode_getfh_maxsz + \\\n\t\t\t\tdecode_getattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_dec_open_sz        (compound_decode_hdr_maxsz + \\\n\t\t\t\tdecode_sequence_maxsz + \\\n\t\t\t\tdecode_putfh_maxsz + \\\n\t\t\t\tdecode_open_maxsz + \\\n\t\t\t\tdecode_access_maxsz + \\\n\t\t\t\tdecode_getfh_maxsz + \\\n\t\t\t\tdecode_getattr_maxsz)\n\nstatic void encode_create_session(struct xdr_stream *xdr,\n\t\t\t\t  struct nfs41_create_session_args *args,\n\t\t\t\t  struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct nfs_client *clp = args->client;\n\tstruct rpc_clnt *clnt = clp->cl_rpcclient;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\tu32 max_resp_sz_cached;\n\n\t/*\n\t * Assumes OPEN is the biggest non-idempotent compound.\n\t * 2 is the verifier.\n\t */\n\tmax_resp_sz_cached = (NFS4_dec_open_sz + RPC_REPHDRSIZE +\n\t\t\t      RPC_MAX_AUTH_SIZE + 2) * XDR_UNIT;\n\n\tencode_op_hdr(xdr, OP_CREATE_SESSION, decode_create_session_maxsz, hdr);\n\tp = reserve_space(xdr, 16 + 2*28 + 20 + clnt->cl_nodelen + 12);\n\tp = xdr_encode_hyper(p, args->clientid);\n\t*p++ = cpu_to_be32(args->seqid);\t\t\t/*Sequence id */\n\t*p++ = cpu_to_be32(args->flags);\t\t\t/*flags */\n\n\t/* Fore Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(max_resp_sz_cached);\t\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t/* Back Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz_cached);\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t*p++ = cpu_to_be32(args->cb_program);\t\t/* cb_program */\n\t*p++ = cpu_to_be32(1);\n\t*p++ = cpu_to_be32(RPC_AUTH_UNIX);\t\t\t/* auth_sys */\n\n\t/* authsys_parms rfc1831 */\n\t*p++ = cpu_to_be32(nn->boot_time.tv_nsec);\t/* stamp */\n\tp = xdr_encode_array(p, clnt->cl_nodename, clnt->cl_nodelen);\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* UID */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* GID */\n\t*p = cpu_to_be32(0);\t\t\t\t/* No more gids */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2775
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_create_session(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs41_create_session_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_create_session(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_exchange_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2751-2762",
    "snippet": "static void nfs4_xdr_enc_exchange_id(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_exchange_id_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_exchange_id(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2761
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_exchange_id",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2760
        },
        "resolved": true,
        "details": {
          "function_name": "encode_exchange_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1739-1788",
          "snippet": "static void encode_exchange_id(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_exchange_id_args *args,\n\t\t\t       struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tchar impl_name[IMPL_NAME_LIMIT];\n\tint len = 0;\n\n\tencode_op_hdr(xdr, OP_EXCHANGE_ID, decode_exchange_id_maxsz, hdr);\n\tencode_nfs4_verifier(xdr, args->verifier);\n\n\tencode_string(xdr, args->id_len, args->id);\n\n\tencode_uint32(xdr, args->flags);\n\tencode_uint32(xdr, args->state_protect.how);\n\n\tswitch (args->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tencode_op_map(xdr, &args->state_protect.enforce);\n\t\tencode_op_map(xdr, &args->state_protect.allow);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\tif (send_implementation_id &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) > 1 &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN)\n\t\t<= sizeof(impl_name) + 1)\n\t\tlen = snprintf(impl_name, sizeof(impl_name), \"%s %s %s %s\",\n\t\t\t       utsname()->sysname, utsname()->release,\n\t\t\t       utsname()->version, utsname()->machine);\n\n\tif (len > 0) {\n\t\tencode_uint32(xdr, 1);\t/* implementation id array length=1 */\n\n\t\tencode_string(xdr,\n\t\t\tsizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) - 1,\n\t\t\tCONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN);\n\t\tencode_string(xdr, len, impl_name);\n\t\t/* just send zeros for nii_date - the date is in nii_name */\n\t\tp = reserve_space(xdr, 12);\n\t\tp = xdr_encode_hyper(p, 0);\n\t\t*p = cpu_to_be32(0);\n\t} else\n\t\tencode_uint32(xdr, 0);\t/* implementation id array length=0 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define IMPL_NAME_LIMIT (sizeof(utsname()->sysname) + sizeof(utsname()->release) + \\\n\t\t\t sizeof(utsname()->version) + sizeof(utsname()->machine) + 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define IMPL_NAME_LIMIT (sizeof(utsname()->sysname) + sizeof(utsname()->release) + \\\n\t\t\t sizeof(utsname()->version) + sizeof(utsname()->machine) + 8)\n\nstatic void encode_exchange_id(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_exchange_id_args *args,\n\t\t\t       struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tchar impl_name[IMPL_NAME_LIMIT];\n\tint len = 0;\n\n\tencode_op_hdr(xdr, OP_EXCHANGE_ID, decode_exchange_id_maxsz, hdr);\n\tencode_nfs4_verifier(xdr, args->verifier);\n\n\tencode_string(xdr, args->id_len, args->id);\n\n\tencode_uint32(xdr, args->flags);\n\tencode_uint32(xdr, args->state_protect.how);\n\n\tswitch (args->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tencode_op_map(xdr, &args->state_protect.enforce);\n\t\tencode_op_map(xdr, &args->state_protect.allow);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\tif (send_implementation_id &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) > 1 &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN)\n\t\t<= sizeof(impl_name) + 1)\n\t\tlen = snprintf(impl_name, sizeof(impl_name), \"%s %s %s %s\",\n\t\t\t       utsname()->sysname, utsname()->release,\n\t\t\t       utsname()->version, utsname()->machine);\n\n\tif (len > 0) {\n\t\tencode_uint32(xdr, 1);\t/* implementation id array length=1 */\n\n\t\tencode_string(xdr,\n\t\t\tsizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) - 1,\n\t\t\tCONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN);\n\t\tencode_string(xdr, len, impl_name);\n\t\t/* just send zeros for nii_date - the date is in nii_name */\n\t\tp = reserve_space(xdr, 12);\n\t\tp = xdr_encode_hyper(p, 0);\n\t\t*p = cpu_to_be32(0);\n\t} else\n\t\tencode_uint32(xdr, 0);\t/* implementation id array length=0 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2759
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_exchange_id(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs41_exchange_id_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_exchange_id(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_bind_conn_to_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2735-2746",
    "snippet": "static void nfs4_xdr_enc_bind_conn_to_session(struct rpc_rqst *req,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_bind_conn_to_session_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_bind_conn_to_session(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2745
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_bind_conn_to_session",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2744
        },
        "resolved": true,
        "details": {
          "function_name": "encode_bind_conn_to_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1717-1729",
          "snippet": "static void encode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs41_bind_conn_to_session_args *args,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION,\n\t\tdecode_bind_conn_to_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, args->sessionid.data, NFS4_MAX_SESSIONID_LEN);\n\tp = xdr_reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(args->dir);\n\t*p = (args->use_conn_in_rdma_mode) ? cpu_to_be32(1) : cpu_to_be32(0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs41_bind_conn_to_session_args *args,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION,\n\t\tdecode_bind_conn_to_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, args->sessionid.data, NFS4_MAX_SESSIONID_LEN);\n\tp = xdr_reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(args->dir);\n\t*p = (args->use_conn_in_rdma_mode) ? cpu_to_be32(1) : cpu_to_be32(0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2743
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_bind_conn_to_session(struct rpc_rqst *req,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_bind_conn_to_session_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_bind_conn_to_session(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_fsid_present",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2714-2729",
    "snippet": "static void nfs4_xdr_enc_fsid_present(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_fsid_present_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tif (args->renew)\n\t\tencode_renew(xdr, args->clientid, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2728
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_renew",
          "args": [
            "xdr",
            "args->clientid",
            "&hdr"
          ],
          "line": 2727
        },
        "resolved": true,
        "details": {
          "function_name": "encode_renew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1622-1627",
          "snippet": "static void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_renew_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_renew_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2725
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1253-1256",
          "snippet": "static void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))\n\nstatic void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2724
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2723
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2722
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2719
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_fsid_present(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_fsid_present_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tif (args->renew)\n\t\tencode_renew(xdr, args->clientid, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_secinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2696-2709",
    "snippet": "static void nfs4_xdr_enc_secinfo(struct rpc_rqst *req,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_secinfo_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_secinfo(xdr, args->name, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2708
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_secinfo",
          "args": [
            "xdr",
            "args->name",
            "&hdr"
          ],
          "line": 2707
        },
        "resolved": true,
        "details": {
          "function_name": "encode_secinfo_no_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2017-2025",
          "snippet": "static int\nencode_secinfo_no_name(struct xdr_stream *xdr,\n\t\t       const struct nfs41_secinfo_no_name_args *args,\n\t\t       struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO_NO_NAME, decode_secinfo_no_name_maxsz, hdr);\n\tencode_uint32(xdr, args->style);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_secinfo_no_name_maxsz decode_secinfo_maxsz"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_secinfo_no_name_maxsz decode_secinfo_maxsz\n\nstatic int\nencode_secinfo_no_name(struct xdr_stream *xdr,\n\t\t       const struct nfs41_secinfo_no_name_args *args,\n\t\t       struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO_NO_NAME, decode_secinfo_no_name_maxsz, hdr);\n\tencode_uint32(xdr, args->style);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->dir_fh",
            "&hdr"
          ],
          "line": 2706
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2705
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2704
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2701
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_secinfo(struct rpc_rqst *req,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_secinfo_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_secinfo(xdr, args->name, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_fs_locations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2663-2691",
    "snippet": "static void nfs4_xdr_enc_fs_locations(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_fs_locations_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\tuint32_t replen;\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tif (args->migration) {\n\t\tencode_putfh(xdr, args->fh, &hdr);\n\t\treplen = hdr.replen;\n\t\tencode_fs_locations(xdr, args->bitmask, &hdr);\n\t\tif (args->renew)\n\t\t\tencode_renew(xdr, args->clientid, &hdr);\n\t} else {\n\t\tencode_putfh(xdr, args->dir_fh, &hdr);\n\t\tencode_lookup(xdr, args->name, &hdr);\n\t\treplen = hdr.replen;\n\t\tencode_fs_locations(xdr, args->bitmask, &hdr);\n\t}\n\n\t/* Set up reply kvec to capture returned fs_locations array. */\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, &args->page,\n\t\t\t0, PAGE_SIZE);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2690
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "replen << 2",
            "&args->page",
            "0",
            "PAGE_SIZE"
          ],
          "line": 2688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_fs_locations",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2684
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fs_locations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1247-1251",
          "snippet": "static void encode_fs_locations(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_two(xdr, bitmask[0] & nfs4_fs_locations_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fs_locations_bitmap[1], hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fs_locations(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_two(xdr, bitmask[0] & nfs4_fs_locations_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fs_locations_bitmap[1], hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_lookup",
          "args": [
            "xdr",
            "args->name",
            "&hdr"
          ],
          "line": 2682
        },
        "resolved": true,
        "details": {
          "function_name": "encode_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1348-1352",
          "snippet": "static void encode_lookup(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LOOKUP, decode_lookup_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_lookup_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_lookup_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_lookup(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LOOKUP, decode_lookup_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->dir_fh",
            "&hdr"
          ],
          "line": 2681
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_renew",
          "args": [
            "xdr",
            "args->clientid",
            "&hdr"
          ],
          "line": 2679
        },
        "resolved": true,
        "details": {
          "function_name": "encode_renew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1622-1627",
          "snippet": "static void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_renew_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_renew_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2673
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2672
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2668
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_fs_locations(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs4_fs_locations_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\tuint32_t replen;\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tif (args->migration) {\n\t\tencode_putfh(xdr, args->fh, &hdr);\n\t\treplen = hdr.replen;\n\t\tencode_fs_locations(xdr, args->bitmask, &hdr);\n\t\tif (args->renew)\n\t\t\tencode_renew(xdr, args->clientid, &hdr);\n\t} else {\n\t\tencode_putfh(xdr, args->dir_fh, &hdr);\n\t\tencode_lookup(xdr, args->name, &hdr);\n\t\treplen = hdr.replen;\n\t\tencode_fs_locations(xdr, args->bitmask, &hdr);\n\t}\n\n\t/* Set up reply kvec to capture returned fs_locations array. */\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, &args->page,\n\t\t\t0, PAGE_SIZE);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_delegreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2644-2658",
    "snippet": "static void nfs4_xdr_enc_delegreturn(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs4_delegreturnargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fhandle, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_delegreturn(xdr, args->stateid, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2657
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_delegreturn",
          "args": [
            "xdr",
            "args->stateid",
            "&hdr"
          ],
          "line": 2656
        },
        "resolved": true,
        "details": {
          "function_name": "encode_delegreturn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1703-1707",
          "snippet": "static void encode_delegreturn(struct xdr_stream *xdr, const nfs4_stateid *stateid, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DELEGRETURN, decode_delegreturn_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, stateid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_delegreturn_maxsz (op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_delegreturn_maxsz (op_decode_hdr_maxsz)\n\nstatic void encode_delegreturn(struct xdr_stream *xdr, const nfs4_stateid *stateid, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DELEGRETURN, decode_delegreturn_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, stateid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2655
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fhandle",
            "&hdr"
          ],
          "line": 2654
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2653
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2652
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2649
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_delegreturn(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs4_delegreturnargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fhandle, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_delegreturn(xdr, args->stateid, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_setclientid_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2628-2639",
    "snippet": "static void nfs4_xdr_enc_setclientid_confirm(struct rpc_rqst *req,\n\t\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t\t     struct nfs4_setclientid_res *arg)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops\t= 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_setclientid_confirm(xdr, arg, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2638
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_setclientid_confirm",
          "args": [
            "xdr",
            "arg",
            "&hdr"
          ],
          "line": 2637
        },
        "resolved": true,
        "details": {
          "function_name": "encode_setclientid_confirm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1679-1685",
          "snippet": "static void encode_setclientid_confirm(struct xdr_stream *xdr, const struct nfs4_setclientid_res *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM,\n\t\t\tdecode_setclientid_confirm_maxsz, hdr);\n\tencode_uint64(xdr, arg->clientid);\n\tencode_nfs4_verifier(xdr, &arg->confirm);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_setclientid_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setclientid_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)\n\nstatic void encode_setclientid_confirm(struct xdr_stream *xdr, const struct nfs4_setclientid_res *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM,\n\t\t\tdecode_setclientid_confirm_maxsz, hdr);\n\tencode_uint64(xdr, arg->clientid);\n\tencode_nfs4_verifier(xdr, &arg->confirm);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2636
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_setclientid_confirm(struct rpc_rqst *req,\n\t\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t\t     struct nfs4_setclientid_res *arg)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops\t= 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_setclientid_confirm(xdr, arg, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_setclientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2612-2623",
    "snippet": "static void nfs4_xdr_enc_setclientid(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_setclientid *sc)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops\t= 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_setclientid(xdr, sc, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2622
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_setclientid",
          "args": [
            "xdr",
            "sc",
            "&hdr"
          ],
          "line": 2621
        },
        "resolved": true,
        "details": {
          "function_name": "encode_setclientid_confirm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1679-1685",
          "snippet": "static void encode_setclientid_confirm(struct xdr_stream *xdr, const struct nfs4_setclientid_res *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM,\n\t\t\tdecode_setclientid_confirm_maxsz, hdr);\n\tencode_uint64(xdr, arg->clientid);\n\tencode_nfs4_verifier(xdr, &arg->confirm);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_setclientid_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setclientid_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)\n\nstatic void encode_setclientid_confirm(struct xdr_stream *xdr, const struct nfs4_setclientid_res *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM,\n\t\t\tdecode_setclientid_confirm_maxsz, hdr);\n\tencode_uint64(xdr, arg->clientid);\n\tencode_nfs4_verifier(xdr, &arg->confirm);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2620
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_setclientid(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_setclientid *sc)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops\t= 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_setclientid(xdr, sc, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_renew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2597-2607",
    "snippet": "static void nfs4_xdr_enc_renew(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_client *clp)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops\t= 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_renew(xdr, clp->cl_clientid, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2606
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_renew",
          "args": [
            "xdr",
            "clp->cl_clientid",
            "&hdr"
          ],
          "line": 2605
        },
        "resolved": true,
        "details": {
          "function_name": "encode_renew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1622-1627",
          "snippet": "static void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_renew_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_renew_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2604
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_renew(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_client *clp)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops\t= 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_renew(xdr, clp->cl_clientid, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_server_caps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2575-2592",
    "snippet": "static void nfs4_xdr_enc_server_caps(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_server_caps_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fhandle, &hdr);\n\tencode_getattr_one(xdr, FATTR4_WORD0_SUPPORTED_ATTRS|\n\t\t\t   FATTR4_WORD0_FH_EXPIRE_TYPE|\n\t\t\t   FATTR4_WORD0_LINK_SUPPORT|\n\t\t\t   FATTR4_WORD0_SYMLINK_SUPPORT|\n\t\t\t   FATTR4_WORD0_ACLSUPPORT, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2591
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getattr_one",
          "args": [
            "xdr",
            "FATTR4_WORD0_SUPPORTED_ATTRS|\n\t\t\t   FATTR4_WORD0_FH_EXPIRE_TYPE|\n\t\t\t   FATTR4_WORD0_LINK_SUPPORT|\n\t\t\t   FATTR4_WORD0_SYMLINK_SUPPORT|\n\t\t\t   FATTR4_WORD0_ACLSUPPORT",
            "&hdr"
          ],
          "line": 2586
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1172-1180",
          "snippet": "static void encode_getattr_one(struct xdr_stream *xdr, uint32_t bitmap, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(bitmap);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_one(struct xdr_stream *xdr, uint32_t bitmap, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fhandle",
            "&hdr"
          ],
          "line": 2585
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2584
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2583
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2580
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_server_caps(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs4_server_caps_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fhandle, &hdr);\n\tencode_getattr_one(xdr, FATTR4_WORD0_SUPPORTED_ATTRS|\n\t\t\t   FATTR4_WORD0_FH_EXPIRE_TYPE|\n\t\t\t   FATTR4_WORD0_LINK_SUPPORT|\n\t\t\t   FATTR4_WORD0_SYMLINK_SUPPORT|\n\t\t\t   FATTR4_WORD0_ACLSUPPORT, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2557-2570",
    "snippet": "static void nfs4_xdr_enc_statfs(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_statfs_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getattr_two(xdr, args->bitmask[0] & nfs4_statfs_bitmap[0],\n\t\t\t   args->bitmask[1] & nfs4_statfs_bitmap[1], &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2569
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getattr_two",
          "args": [
            "xdr",
            "args->bitmask[0] & nfs4_statfs_bitmap[0]",
            "args->bitmask[1] & nfs4_statfs_bitmap[1]",
            "&hdr"
          ],
          "line": 2567
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_two",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1182-1191",
          "snippet": "static void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2566
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2565
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2564
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2561
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_statfs(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_statfs_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getattr_two(xdr, args->bitmask[0] & nfs4_statfs_bitmap[0],\n\t\t\t   args->bitmask[1] & nfs4_statfs_bitmap[1], &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_pathconf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2539-2552",
    "snippet": "static void nfs4_xdr_enc_pathconf(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs4_pathconf_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getattr_one(xdr, args->bitmask[0] & nfs4_pathconf_bitmap[0],\n\t\t\t   &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2551
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getattr_one",
          "args": [
            "xdr",
            "args->bitmask[0] & nfs4_pathconf_bitmap[0]",
            "&hdr"
          ],
          "line": 2549
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1172-1180",
          "snippet": "static void encode_getattr_one(struct xdr_stream *xdr, uint32_t bitmap, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(bitmap);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_one(struct xdr_stream *xdr, uint32_t bitmap, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2548
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2547
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2546
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2543
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_pathconf(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs4_pathconf_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getattr_one(xdr, args->bitmask[0] & nfs4_pathconf_bitmap[0],\n\t\t\t   &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2522-2534",
    "snippet": "static void nfs4_xdr_enc_fsinfo(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_fsinfo_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_fsinfo(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2533
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fsinfo",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2532
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1238-1245",
          "snippet": "static void encode_fsinfo(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & nfs4_fsinfo_bitmap[0],\n\t\t\t     bitmask[1] & nfs4_fsinfo_bitmap[1],\n\t\t\t     bitmask[2] & nfs4_fsinfo_bitmap[2],\n\t\t\t     hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fsinfo(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & nfs4_fsinfo_bitmap[0],\n\t\t\t     bitmask[1] & nfs4_fsinfo_bitmap[1],\n\t\t\t     bitmask[2] & nfs4_fsinfo_bitmap[2],\n\t\t\t     hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2531
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2530
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2529
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2526
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_fsinfo(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs4_fsinfo_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_fsinfo(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2505-2517",
    "snippet": "static void nfs4_xdr_enc_commit(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_commitargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_commit(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2516
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_commit",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2515
        },
        "resolved": true,
        "details": {
          "function_name": "encode_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1134-1142",
          "snippet": "static void encode_commit(struct xdr_stream *xdr, const struct nfs_commitargs *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_COMMIT, decode_commit_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_commit_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_commit_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)\n\nstatic void encode_commit(struct xdr_stream *xdr, const struct nfs_commitargs *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_COMMIT, decode_commit_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2514
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2513
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2512
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2509
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_commit(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_commitargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_commit(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2485-2500",
    "snippet": "static void nfs4_xdr_enc_write(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_pgio_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_write(xdr, args, &hdr);\n\treq->rq_snd_buf.flags |= XDRBUF_WRITE;\n\tif (args->bitmask)\n\t\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2499
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2498
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_write",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2495
        },
        "resolved": true,
        "details": {
          "function_name": "encode_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1687-1701",
          "snippet": "static void encode_write(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\t struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_WRITE, decode_write_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p++ = cpu_to_be32(args->stable);\n\t*p = cpu_to_be32(args->count);\n\n\txdr_write_pages(xdr, args->pages, args->pgbase, args->count);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_write_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t 2 + decode_verifier_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_write_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t 2 + decode_verifier_maxsz)\n\nstatic void encode_write(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\t struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_WRITE, decode_write_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p++ = cpu_to_be32(args->stable);\n\t*p = cpu_to_be32(args->count);\n\n\txdr_write_pages(xdr, args->pages, args->pgbase, args->count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2494
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2493
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2492
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2489
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_write(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_pgio_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_write(xdr, args, &hdr);\n\treq->rq_snd_buf.flags |= XDRBUF_WRITE;\n\tif (args->bitmask)\n\t\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_getacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2462-2480",
    "snippet": "static void nfs4_xdr_enc_getacl(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_getaclargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\tuint32_t replen;\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\treplen = hdr.replen + op_decode_hdr_maxsz + 1;\n\tencode_getattr_two(xdr, FATTR4_WORD0_ACL, 0, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2,\n\t\targs->acl_pages, args->acl_pgbase, args->acl_len);\n\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define op_decode_hdr_maxsz\t(2)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2479
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "replen << 2",
            "args->acl_pages",
            "args->acl_pgbase",
            "args->acl_len"
          ],
          "line": 2476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_getattr_two",
          "args": [
            "xdr",
            "FATTR4_WORD0_ACL",
            "0",
            "&hdr"
          ],
          "line": 2474
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_two",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1182-1191",
          "snippet": "static void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2472
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2471
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2470
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2466
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define op_decode_hdr_maxsz\t(2)\n\nstatic void nfs4_xdr_enc_getacl(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_getaclargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\tuint32_t replen;\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\treplen = hdr.replen + op_decode_hdr_maxsz + 1;\n\tencode_getattr_two(xdr, FATTR4_WORD0_ACL, 0, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2,\n\t\targs->acl_pages, args->acl_pgbase, args->acl_len);\n\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2444-2457",
    "snippet": "static void nfs4_xdr_enc_setattr(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_setattrargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_setattr(xdr, args, args->server, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2456
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2455
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_setattr",
          "args": [
            "xdr",
            "args",
            "args->server",
            "&hdr"
          ],
          "line": 2454
        },
        "resolved": true,
        "details": {
          "function_name": "encode_setattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1656-1661",
          "snippet": "static void encode_setattr(struct xdr_stream *xdr, const struct nfs_setattrargs *arg, const struct nfs_server *server, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setattr_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_attrs(xdr, arg->iap, arg->label, server);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_setattr_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t nfs4_fattr_bitmap_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setattr_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t nfs4_fattr_bitmap_maxsz)\n\nstatic void encode_setattr(struct xdr_stream *xdr, const struct nfs_setattrargs *arg, const struct nfs_server *server, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setattr_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_attrs(xdr, arg->iap, arg->label, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2453
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2452
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2451
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2448
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_setattr(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_setattrargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_setattr(xdr, args, args->server, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2423-2439",
    "snippet": "static void nfs4_xdr_enc_read(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      struct nfs_pgio_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_read(xdr, args, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2,\n\t\t\t args->pages, args->pgbase, args->count);\n\treq->rq_rcv_buf.flags |= XDRBUF_READ;\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2438
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "hdr.replen << 2",
            "args->pages",
            "args->pgbase",
            "args->count"
          ],
          "line": 2435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_read",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2433
        },
        "resolved": true,
        "details": {
          "function_name": "encode_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1541-1552",
          "snippet": "static void encode_read(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_READ, decode_read_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_read_maxsz\t(op_decode_hdr_maxsz + 2)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_read_maxsz\t(op_decode_hdr_maxsz + 2)\n\nstatic void encode_read(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_READ, decode_read_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2432
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2431
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2430
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2427
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_read(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      struct nfs_pgio_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_read(xdr, args, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2,\n\t\t\t args->pages, args->pgbase, args->count);\n\treq->rq_rcv_buf.flags |= XDRBUF_READ;\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2400-2418",
    "snippet": "static void nfs4_xdr_enc_readdir(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t const struct nfs4_readdir_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_readdir(xdr, args, req, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2, args->pages,\n\t\t\t args->pgbase, args->count);\n\tdprintk(\"%s: inlined page args = (%u, %p, %u, %u)\\n\",\n\t\t\t__func__, hdr.replen << 2, args->pages,\n\t\t\targs->pgbase, args->count);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2417
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: inlined page args = (%u, %p, %u, %u)\\n\"",
            "__func__",
            "hdr.replen << 2",
            "args->pages",
            "args->pgbase",
            "args->count"
          ],
          "line": 2414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "hdr.replen << 2",
            "args->pages",
            "args->pgbase",
            "args->count"
          ],
          "line": 2412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_readdir",
          "args": [
            "xdr",
            "args",
            "req",
            "&hdr"
          ],
          "line": 2410
        },
        "resolved": true,
        "details": {
          "function_name": "encode_readdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1554-1602",
          "snippet": "static void encode_readdir(struct xdr_stream *xdr, const struct nfs4_readdir_arg *readdir, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tuint32_t attrs[3] = {\n\t\tFATTR4_WORD0_RDATTR_ERROR,\n\t\tFATTR4_WORD1_MOUNTED_ON_FILEID,\n\t};\n\tuint32_t dircount = readdir->count >> 1;\n\t__be32 *p, verf[2];\n\tuint32_t attrlen = 0;\n\tunsigned int i;\n\n\tif (readdir->plus) {\n\t\tattrs[0] |= FATTR4_WORD0_TYPE|FATTR4_WORD0_CHANGE|FATTR4_WORD0_SIZE|\n\t\t\tFATTR4_WORD0_FSID|FATTR4_WORD0_FILEHANDLE|FATTR4_WORD0_FILEID;\n\t\tattrs[1] |= FATTR4_WORD1_MODE|FATTR4_WORD1_NUMLINKS|FATTR4_WORD1_OWNER|\n\t\t\tFATTR4_WORD1_OWNER_GROUP|FATTR4_WORD1_RAWDEV|\n\t\t\tFATTR4_WORD1_SPACE_USED|FATTR4_WORD1_TIME_ACCESS|\n\t\t\tFATTR4_WORD1_TIME_METADATA|FATTR4_WORD1_TIME_MODIFY;\n\t\tattrs[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t\tdircount >>= 1;\n\t}\n\t/* Use mounted_on_fileid only if the server supports it */\n\tif (!(readdir->bitmask[1] & FATTR4_WORD1_MOUNTED_ON_FILEID))\n\t\tattrs[0] |= FATTR4_WORD0_FILEID;\n\tfor (i = 0; i < ARRAY_SIZE(attrs); i++) {\n\t\tattrs[i] &= readdir->bitmask[i];\n\t\tif (attrs[i] != 0)\n\t\t\tattrlen = i+1;\n\t}\n\n\tencode_op_hdr(xdr, OP_READDIR, decode_readdir_maxsz, hdr);\n\tencode_uint64(xdr, readdir->cookie);\n\tencode_nfs4_verifier(xdr, &readdir->verifier);\n\tp = reserve_space(xdr, 12 + (attrlen << 2));\n\t*p++ = cpu_to_be32(dircount);\n\t*p++ = cpu_to_be32(readdir->count);\n\t*p++ = cpu_to_be32(attrlen);\n\tfor (i = 0; i < attrlen; i++)\n\t\t*p++ = cpu_to_be32(attrs[i]);\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\n\tdprintk(\"%s: cookie = %llu, verifier = %08x:%08x, bitmap = %08x:%08x:%08x\\n\",\n\t\t\t__func__,\n\t\t\t(unsigned long long)readdir->cookie,\n\t\t\tverf[0], verf[1],\n\t\t\tattrs[0] & readdir->bitmask[0],\n\t\t\tattrs[1] & readdir->bitmask[1],\n\t\t\tattrs[2] & readdir->bitmask[2]);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_readdir_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_readdir_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)\n\nstatic void encode_readdir(struct xdr_stream *xdr, const struct nfs4_readdir_arg *readdir, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tuint32_t attrs[3] = {\n\t\tFATTR4_WORD0_RDATTR_ERROR,\n\t\tFATTR4_WORD1_MOUNTED_ON_FILEID,\n\t};\n\tuint32_t dircount = readdir->count >> 1;\n\t__be32 *p, verf[2];\n\tuint32_t attrlen = 0;\n\tunsigned int i;\n\n\tif (readdir->plus) {\n\t\tattrs[0] |= FATTR4_WORD0_TYPE|FATTR4_WORD0_CHANGE|FATTR4_WORD0_SIZE|\n\t\t\tFATTR4_WORD0_FSID|FATTR4_WORD0_FILEHANDLE|FATTR4_WORD0_FILEID;\n\t\tattrs[1] |= FATTR4_WORD1_MODE|FATTR4_WORD1_NUMLINKS|FATTR4_WORD1_OWNER|\n\t\t\tFATTR4_WORD1_OWNER_GROUP|FATTR4_WORD1_RAWDEV|\n\t\t\tFATTR4_WORD1_SPACE_USED|FATTR4_WORD1_TIME_ACCESS|\n\t\t\tFATTR4_WORD1_TIME_METADATA|FATTR4_WORD1_TIME_MODIFY;\n\t\tattrs[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t\tdircount >>= 1;\n\t}\n\t/* Use mounted_on_fileid only if the server supports it */\n\tif (!(readdir->bitmask[1] & FATTR4_WORD1_MOUNTED_ON_FILEID))\n\t\tattrs[0] |= FATTR4_WORD0_FILEID;\n\tfor (i = 0; i < ARRAY_SIZE(attrs); i++) {\n\t\tattrs[i] &= readdir->bitmask[i];\n\t\tif (attrs[i] != 0)\n\t\t\tattrlen = i+1;\n\t}\n\n\tencode_op_hdr(xdr, OP_READDIR, decode_readdir_maxsz, hdr);\n\tencode_uint64(xdr, readdir->cookie);\n\tencode_nfs4_verifier(xdr, &readdir->verifier);\n\tp = reserve_space(xdr, 12 + (attrlen << 2));\n\t*p++ = cpu_to_be32(dircount);\n\t*p++ = cpu_to_be32(readdir->count);\n\t*p++ = cpu_to_be32(attrlen);\n\tfor (i = 0; i < attrlen; i++)\n\t\t*p++ = cpu_to_be32(attrs[i]);\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\n\tdprintk(\"%s: cookie = %llu, verifier = %08x:%08x, bitmap = %08x:%08x:%08x\\n\",\n\t\t\t__func__,\n\t\t\t(unsigned long long)readdir->cookie,\n\t\t\tverf[0], verf[1],\n\t\t\tattrs[0] & readdir->bitmask[0],\n\t\t\tattrs[1] & readdir->bitmask[1],\n\t\t\tattrs[2] & readdir->bitmask[2]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2409
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2408
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2407
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2404
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_readdir(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t const struct nfs4_readdir_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_readdir(xdr, args, req, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2, args->pages,\n\t\t\t args->pgbase, args->count);\n\tdprintk(\"%s: inlined page args = (%u, %p, %u, %u)\\n\",\n\t\t\t__func__, hdr.replen << 2, args->pages,\n\t\t\targs->pgbase, args->count);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2380-2395",
    "snippet": "static void nfs4_xdr_enc_readlink(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs4_readlink *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_readlink(xdr, args, req, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2, args->pages,\n\t\t\targs->pgbase, args->pglen);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2394
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "hdr.replen << 2",
            "args->pages",
            "args->pgbase",
            "args->pglen"
          ],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_readlink",
          "args": [
            "xdr",
            "args",
            "req",
            "&hdr"
          ],
          "line": 2390
        },
        "resolved": true,
        "details": {
          "function_name": "encode_readlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1604-1607",
          "snippet": "static void encode_readlink(struct xdr_stream *xdr, const struct nfs4_readlink *readlink, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_READLINK, decode_readlink_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_readlink_maxsz\t(op_decode_hdr_maxsz + 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_readlink_maxsz\t(op_decode_hdr_maxsz + 1)\n\nstatic void encode_readlink(struct xdr_stream *xdr, const struct nfs4_readlink *readlink, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_READLINK, decode_readlink_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2389
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2388
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2387
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2384
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_readlink(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs4_readlink *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_readlink(xdr, args, req, &hdr);\n\n\txdr_inline_pages(&req->rq_rcv_buf, hdr.replen << 2, args->pages,\n\t\t\targs->pgbase, args->pglen);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_release_lockowner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2364-2375",
    "snippet": "static void nfs4_xdr_enc_release_lockowner(struct rpc_rqst *req,\n\t\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs_release_lockowner_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_release_lockowner(xdr, &args->lock_owner, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2374
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_release_lockowner",
          "args": [
            "xdr",
            "&args->lock_owner",
            "&hdr"
          ],
          "line": 2373
        },
        "resolved": true,
        "details": {
          "function_name": "encode_release_lockowner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1342-1346",
          "snippet": "static void encode_release_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RELEASE_LOCKOWNER, decode_release_lockowner_maxsz, hdr);\n\tencode_lockowner(xdr, lowner);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_release_lockowner_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_release_lockowner_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)\n\nstatic void encode_release_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RELEASE_LOCKOWNER, decode_release_lockowner_maxsz, hdr);\n\tencode_lockowner(xdr, lowner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2372
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_release_lockowner(struct rpc_rqst *req,\n\t\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs_release_lockowner_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_release_lockowner(xdr, &args->lock_owner, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_locku",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2350-2362",
    "snippet": "static void nfs4_xdr_enc_locku(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_locku_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_locku(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2361
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_locku",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2360
        },
        "resolved": true,
        "details": {
          "function_name": "encode_locku",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1329-1340",
          "snippet": "static void encode_locku(struct xdr_stream *xdr, const struct nfs_locku_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKU, decode_locku_maxsz, hdr);\n\tencode_uint32(xdr, nfs4_lock_type(args->fl, 0));\n\tencode_nfs4_seqid(xdr, args->seqid);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\txdr_encode_hyper(p, nfs4_lock_length(args->fl));\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_locku_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_locku_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_locku(struct xdr_stream *xdr, const struct nfs_locku_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKU, decode_locku_maxsz, hdr);\n\tencode_uint32(xdr, nfs4_lock_type(args->fl, 0));\n\tencode_nfs4_seqid(xdr, args->seqid);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\txdr_encode_hyper(p, nfs4_lock_length(args->fl));\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2359
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2358
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2357
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2354
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_locku(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_locku_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_locku(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_lockt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2333-2345",
    "snippet": "static void nfs4_xdr_enc_lockt(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_lockt_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_lockt(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2344
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_lockt",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2343
        },
        "resolved": true,
        "details": {
          "function_name": "encode_lockt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1317-1327",
          "snippet": "static void encode_lockt(struct xdr_stream *xdr, const struct nfs_lockt_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKT, decode_lockt_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(nfs4_lock_type(args->fl, 0));\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\tp = xdr_encode_hyper(p, nfs4_lock_length(args->fl));\n\tencode_lockowner(xdr, &args->lock_owner);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_lockt_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_lock_denied_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_lockt_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_lock_denied_maxsz)\n\nstatic void encode_lockt(struct xdr_stream *xdr, const struct nfs_lockt_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKT, decode_lockt_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(nfs4_lock_type(args->fl, 0));\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\tp = xdr_encode_hyper(p, nfs4_lock_length(args->fl));\n\tencode_lockowner(xdr, &args->lock_owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2341
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2340
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2337
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_lockt(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_lockt_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_lockt(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2316-2328",
    "snippet": "static void nfs4_xdr_enc_lock(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      struct nfs_lock_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_lock(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2327
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_lock",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2326
        },
        "resolved": true,
        "details": {
          "function_name": "encode_locku",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1329-1340",
          "snippet": "static void encode_locku(struct xdr_stream *xdr, const struct nfs_locku_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKU, decode_locku_maxsz, hdr);\n\tencode_uint32(xdr, nfs4_lock_type(args->fl, 0));\n\tencode_nfs4_seqid(xdr, args->seqid);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\txdr_encode_hyper(p, nfs4_lock_length(args->fl));\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_locku_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_locku_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_locku(struct xdr_stream *xdr, const struct nfs_locku_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKU, decode_locku_maxsz, hdr);\n\tencode_uint32(xdr, nfs4_lock_type(args->fl, 0));\n\tencode_nfs4_seqid(xdr, args->seqid);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\txdr_encode_hyper(p, nfs4_lock_length(args->fl));\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2325
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2324
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2323
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2320
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_lock(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      struct nfs_lock_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_lock(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_open_downgrade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2297-2311",
    "snippet": "static void nfs4_xdr_enc_open_downgrade(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs_closeargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open_downgrade(xdr, args, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2310
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2309
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_open_downgrade",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2308
        },
        "resolved": true,
        "details": {
          "function_name": "encode_open_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1521-1527",
          "snippet": "static void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2307
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2306
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2305
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2302
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_open_downgrade(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs_closeargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open_downgrade(xdr, args, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_open_noattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2276-2292",
    "snippet": "static void nfs4_xdr_enc_open_noattr(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs_openargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open(xdr, args, &hdr);\n\tif (args->access)\n\t\tencode_access(xdr, args->access, &hdr);\n\tencode_getfattr_open(xdr, args->bitmask, args->open_bitmap, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2291
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr_open",
          "args": [
            "xdr",
            "args->bitmask",
            "args->open_bitmap",
            "&hdr"
          ],
          "line": 2290
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1227-1236",
          "snippet": "static void encode_getfattr_open(struct xdr_stream *xdr, const u32 *bitmask,\n\t\t\t\t const u32 *open_bitmap,\n\t\t\t\t struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & open_bitmap[0],\n\t\t\t     bitmask[1] & open_bitmap[1],\n\t\t\t     bitmask[2] & open_bitmap[2],\n\t\t\t     hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr_open(struct xdr_stream *xdr, const u32 *bitmask,\n\t\t\t\t const u32 *open_bitmap,\n\t\t\t\t struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & open_bitmap[0],\n\t\t\t     bitmask[1] & open_bitmap[1],\n\t\t\t     bitmask[2] & open_bitmap[2],\n\t\t\t     hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_access",
          "args": [
            "xdr",
            "args->access",
            "&hdr"
          ],
          "line": 2289
        },
        "resolved": true,
        "details": {
          "function_name": "encode_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1121-1125",
          "snippet": "static void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)\n\nstatic void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_open",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2287
        },
        "resolved": true,
        "details": {
          "function_name": "encode_open_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1521-1527",
          "snippet": "static void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2286
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2285
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2284
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2281
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_open_noattr(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     struct nfs_openargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open(xdr, args, &hdr);\n\tif (args->access)\n\t\tencode_access(xdr, args->access, &hdr);\n\tencode_getfattr_open(xdr, args->bitmask, args->open_bitmap, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_open_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2259-2271",
    "snippet": "static void nfs4_xdr_enc_open_confirm(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs_open_confirmargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops   = 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open_confirm(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2270
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_open_confirm",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2269
        },
        "resolved": true,
        "details": {
          "function_name": "encode_open_confirm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1514-1519",
          "snippet": "static void encode_open_confirm(struct xdr_stream *xdr, const struct nfs_open_confirmargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_CONFIRM, decode_open_confirm_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_open_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_open_confirm(struct xdr_stream *xdr, const struct nfs_open_confirmargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_CONFIRM, decode_open_confirm_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2268
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2267
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_open_confirm(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      struct nfs_open_confirmargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.nops   = 0,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open_confirm(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2238-2254",
    "snippet": "static void nfs4_xdr_enc_open(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      struct nfs_openargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open(xdr, args, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tif (args->access)\n\t\tencode_access(xdr, args->access, &hdr);\n\tencode_getfattr_open(xdr, args->bitmask, args->open_bitmap, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2253
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr_open",
          "args": [
            "xdr",
            "args->bitmask",
            "args->open_bitmap",
            "&hdr"
          ],
          "line": 2252
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1227-1236",
          "snippet": "static void encode_getfattr_open(struct xdr_stream *xdr, const u32 *bitmask,\n\t\t\t\t const u32 *open_bitmap,\n\t\t\t\t struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & open_bitmap[0],\n\t\t\t     bitmask[1] & open_bitmap[1],\n\t\t\t     bitmask[2] & open_bitmap[2],\n\t\t\t     hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr_open(struct xdr_stream *xdr, const u32 *bitmask,\n\t\t\t\t const u32 *open_bitmap,\n\t\t\t\t struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & open_bitmap[0],\n\t\t\t     bitmask[1] & open_bitmap[1],\n\t\t\t     bitmask[2] & open_bitmap[2],\n\t\t\t     hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_access",
          "args": [
            "xdr",
            "args->access",
            "&hdr"
          ],
          "line": 2251
        },
        "resolved": true,
        "details": {
          "function_name": "encode_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1121-1125",
          "snippet": "static void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)\n\nstatic void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2249
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1253-1256",
          "snippet": "static void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))\n\nstatic void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_open",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2248
        },
        "resolved": true,
        "details": {
          "function_name": "encode_open_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1521-1527",
          "snippet": "static void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2247
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2246
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2242
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_open(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t      struct nfs_openargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_open(xdr, args, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tif (args->access)\n\t\tencode_access(xdr, args->access, &hdr);\n\tencode_getfattr_open(xdr, args->bitmask, args->open_bitmap, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2220-2233",
    "snippet": "static void nfs4_xdr_enc_close(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_closeargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_close(xdr, args, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2232
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2231
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_close",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2230
        },
        "resolved": true,
        "details": {
          "function_name": "encode_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1127-1132",
          "snippet": "static void encode_close(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_CLOSE, decode_close_maxsz, hdr);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_close_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_close_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_close(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_CLOSE, decode_close_maxsz, hdr);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2229
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2228
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2227
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2224
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_close(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t       struct nfs_closeargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_close(xdr, args, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2203-2215",
    "snippet": "static void nfs4_xdr_enc_getattr(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t const struct nfs4_getattr_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2214
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2213
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2212
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2211
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2210
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2207
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_getattr(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t const struct nfs4_getattr_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2194-2198",
    "snippet": "static void nfs4_xdr_enc_symlink(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t const struct nfs4_create_arg *args)\n{\n\tnfs4_xdr_enc_create(req, xdr, args);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_xdr_enc_create",
          "args": [
            "req",
            "xdr",
            "args"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_enc_create_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2767-2778",
          "snippet": "static void nfs4_xdr_enc_create_session(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs41_create_session_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_create_session(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_create_session(struct rpc_rqst *req,\n\t\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\t\tstruct nfs41_create_session_args *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = args->client->cl_mvops->minor_version,\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_create_session(xdr, args, &hdr);\n\tencode_nops(&hdr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_symlink(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t const struct nfs4_create_arg *args)\n{\n\tnfs4_xdr_enc_create(req, xdr, args);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2175-2189",
    "snippet": "static void nfs4_xdr_enc_create(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_create_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_create(xdr, args, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2188
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2187
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2186
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1253-1256",
          "snippet": "static void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))\n\nstatic void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_create",
          "args": [
            "xdr",
            "args",
            "&hdr"
          ],
          "line": 2185
        },
        "resolved": true,
        "details": {
          "function_name": "encode_create_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1790-1841",
          "snippet": "static void encode_create_session(struct xdr_stream *xdr,\n\t\t\t\t  struct nfs41_create_session_args *args,\n\t\t\t\t  struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct nfs_client *clp = args->client;\n\tstruct rpc_clnt *clnt = clp->cl_rpcclient;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\tu32 max_resp_sz_cached;\n\n\t/*\n\t * Assumes OPEN is the biggest non-idempotent compound.\n\t * 2 is the verifier.\n\t */\n\tmax_resp_sz_cached = (NFS4_dec_open_sz + RPC_REPHDRSIZE +\n\t\t\t      RPC_MAX_AUTH_SIZE + 2) * XDR_UNIT;\n\n\tencode_op_hdr(xdr, OP_CREATE_SESSION, decode_create_session_maxsz, hdr);\n\tp = reserve_space(xdr, 16 + 2*28 + 20 + clnt->cl_nodelen + 12);\n\tp = xdr_encode_hyper(p, args->clientid);\n\t*p++ = cpu_to_be32(args->seqid);\t\t\t/*Sequence id */\n\t*p++ = cpu_to_be32(args->flags);\t\t\t/*flags */\n\n\t/* Fore Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(max_resp_sz_cached);\t\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t/* Back Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz_cached);\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t*p++ = cpu_to_be32(args->cb_program);\t\t/* cb_program */\n\t*p++ = cpu_to_be32(1);\n\t*p++ = cpu_to_be32(RPC_AUTH_UNIX);\t\t\t/* auth_sys */\n\n\t/* authsys_parms rfc1831 */\n\t*p++ = cpu_to_be32(nn->boot_time.tv_nsec);\t/* stamp */\n\tp = xdr_encode_array(p, clnt->cl_nodename, clnt->cl_nodelen);\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* UID */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* GID */\n\t*p = cpu_to_be32(0);\t\t\t\t/* No more gids */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_dec_open_sz        (compound_decode_hdr_maxsz + \\\n\t\t\t\tdecode_sequence_maxsz + \\\n\t\t\t\tdecode_putfh_maxsz + \\\n\t\t\t\tdecode_open_maxsz + \\\n\t\t\t\tdecode_access_maxsz + \\\n\t\t\t\tdecode_getfh_maxsz + \\\n\t\t\t\tdecode_getattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_dec_open_sz        (compound_decode_hdr_maxsz + \\\n\t\t\t\tdecode_sequence_maxsz + \\\n\t\t\t\tdecode_putfh_maxsz + \\\n\t\t\t\tdecode_open_maxsz + \\\n\t\t\t\tdecode_access_maxsz + \\\n\t\t\t\tdecode_getfh_maxsz + \\\n\t\t\t\tdecode_getattr_maxsz)\n\nstatic void encode_create_session(struct xdr_stream *xdr,\n\t\t\t\t  struct nfs41_create_session_args *args,\n\t\t\t\t  struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct nfs_client *clp = args->client;\n\tstruct rpc_clnt *clnt = clp->cl_rpcclient;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\tu32 max_resp_sz_cached;\n\n\t/*\n\t * Assumes OPEN is the biggest non-idempotent compound.\n\t * 2 is the verifier.\n\t */\n\tmax_resp_sz_cached = (NFS4_dec_open_sz + RPC_REPHDRSIZE +\n\t\t\t      RPC_MAX_AUTH_SIZE + 2) * XDR_UNIT;\n\n\tencode_op_hdr(xdr, OP_CREATE_SESSION, decode_create_session_maxsz, hdr);\n\tp = reserve_space(xdr, 16 + 2*28 + 20 + clnt->cl_nodelen + 12);\n\tp = xdr_encode_hyper(p, args->clientid);\n\t*p++ = cpu_to_be32(args->seqid);\t\t\t/*Sequence id */\n\t*p++ = cpu_to_be32(args->flags);\t\t\t/*flags */\n\n\t/* Fore Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(max_resp_sz_cached);\t\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t/* Back Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz_cached);\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t*p++ = cpu_to_be32(args->cb_program);\t\t/* cb_program */\n\t*p++ = cpu_to_be32(1);\n\t*p++ = cpu_to_be32(RPC_AUTH_UNIX);\t\t\t/* auth_sys */\n\n\t/* authsys_parms rfc1831 */\n\t*p++ = cpu_to_be32(nn->boot_time.tv_nsec);\t/* stamp */\n\tp = xdr_encode_array(p, clnt->cl_nodename, clnt->cl_nodelen);\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* UID */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* GID */\n\t*p = cpu_to_be32(0);\t\t\t\t/* No more gids */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->dir_fh",
            "&hdr"
          ],
          "line": 2184
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2183
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2182
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2179
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_create(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_create_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_create(xdr, args, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2154-2170",
    "snippet": "static void nfs4_xdr_enc_link(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t     const struct nfs4_link_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_savefh(xdr, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_link(xdr, args->name, &hdr);\n\tencode_restorefh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2169
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2168
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_restorefh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2167
        },
        "resolved": true,
        "details": {
          "function_name": "encode_restorefh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1629-1633",
          "snippet": "static void\nencode_restorefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RESTOREFH, decode_restorefh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_restorefh_maxsz  (op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_restorefh_maxsz  (op_decode_hdr_maxsz)\n\nstatic void\nencode_restorefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RESTOREFH, decode_restorefh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_link",
          "args": [
            "xdr",
            "args->name",
            "&hdr"
          ],
          "line": 2166
        },
        "resolved": true,
        "details": {
          "function_name": "encode_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1258-1262",
          "snippet": "static void encode_link(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LINK, decode_link_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_link_maxsz\t(op_decode_hdr_maxsz + decode_change_info_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_link_maxsz\t(op_decode_hdr_maxsz + decode_change_info_maxsz)\n\nstatic void encode_link(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LINK, decode_link_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->dir_fh",
            "&hdr"
          ],
          "line": 2165
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_savefh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2164
        },
        "resolved": true,
        "details": {
          "function_name": "encode_savefh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1650-1654",
          "snippet": "static void\nencode_savefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SAVEFH, decode_savefh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_savefh_maxsz     (op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_savefh_maxsz     (op_decode_hdr_maxsz)\n\nstatic void\nencode_savefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SAVEFH, decode_savefh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2162
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2161
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2158
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_link(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t     const struct nfs4_link_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_savefh(xdr, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_link(xdr, args->name, &hdr);\n\tencode_restorefh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2135-2149",
    "snippet": "static void nfs4_xdr_enc_rename(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs_renameargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->old_dir, &hdr);\n\tencode_savefh(xdr, &hdr);\n\tencode_putfh(xdr, args->new_dir, &hdr);\n\tencode_rename(xdr, args->old_name, args->new_name, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_rename",
          "args": [
            "xdr",
            "args->old_name",
            "args->new_name",
            "&hdr"
          ],
          "line": 2147
        },
        "resolved": true,
        "details": {
          "function_name": "encode_rename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1615-1620",
          "snippet": "static void encode_rename(struct xdr_stream *xdr, const struct qstr *oldname, const struct qstr *newname, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENAME, decode_rename_maxsz, hdr);\n\tencode_string(xdr, oldname->len, oldname->name);\n\tencode_string(xdr, newname->len, newname->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_rename_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_rename_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)\n\nstatic void encode_rename(struct xdr_stream *xdr, const struct qstr *oldname, const struct qstr *newname, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENAME, decode_rename_maxsz, hdr);\n\tencode_string(xdr, oldname->len, oldname->name);\n\tencode_string(xdr, newname->len, newname->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->new_dir",
            "&hdr"
          ],
          "line": 2146
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_savefh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2145
        },
        "resolved": true,
        "details": {
          "function_name": "encode_savefh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1650-1654",
          "snippet": "static void\nencode_savefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SAVEFH, decode_savefh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_savefh_maxsz     (op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_savefh_maxsz     (op_decode_hdr_maxsz)\n\nstatic void\nencode_savefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SAVEFH, decode_savefh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2143
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2142
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2139
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_rename(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs_renameargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->old_dir, &hdr);\n\tencode_savefh(xdr, &hdr);\n\tencode_putfh(xdr, args->new_dir, &hdr);\n\tencode_rename(xdr, args->old_name, args->new_name, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2118-2130",
    "snippet": "static void nfs4_xdr_enc_remove(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs_removeargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_remove(xdr, &args->name, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_remove",
          "args": [
            "xdr",
            "&args->name",
            "&hdr"
          ],
          "line": 2128
        },
        "resolved": true,
        "details": {
          "function_name": "encode_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1609-1613",
          "snippet": "static void encode_remove(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_REMOVE, decode_remove_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_remove_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_remove_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)\n\nstatic void encode_remove(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_REMOVE, decode_remove_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2127
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2126
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2125
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2122
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_remove(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs_removeargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_remove(xdr, &args->name, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_lookup_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2099-2113",
    "snippet": "static void nfs4_xdr_enc_lookup_root(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs4_lookup_root_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putrootfh(xdr, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2112
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2111
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1253-1256",
          "snippet": "static void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))\n\nstatic void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putrootfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2109
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putrootfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1536-1539",
          "snippet": "static void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2108
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2107
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2104
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_lookup_root(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs4_lookup_root_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putrootfh(xdr, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2080-2094",
    "snippet": "static void nfs4_xdr_enc_lookup(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_lookup_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_lookup(xdr, args->name, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2093
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfh",
          "args": [
            "xdr",
            "&hdr"
          ],
          "line": 2091
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1253-1256",
          "snippet": "static void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))\n\nstatic void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_lookup",
          "args": [
            "xdr",
            "args->name",
            "&hdr"
          ],
          "line": 2090
        },
        "resolved": true,
        "details": {
          "function_name": "encode_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1348-1352",
          "snippet": "static void encode_lookup(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LOOKUP, decode_lookup_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_lookup_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_lookup_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_lookup(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LOOKUP, decode_lookup_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->dir_fh",
            "&hdr"
          ],
          "line": 2089
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2088
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2087
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2084
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_lookup(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_lookup_arg *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->dir_fh, &hdr);\n\tencode_lookup(xdr, args->name, &hdr);\n\tencode_getfh(xdr, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_enc_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2062-2075",
    "snippet": "static void nfs4_xdr_enc_access(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_accessargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_access(xdr, args->access, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nops",
          "args": [
            "&hdr"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "984-988",
          "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_getfattr",
          "args": [
            "xdr",
            "args->bitmask",
            "&hdr"
          ],
          "line": 2073
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getfattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1219-1225",
          "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_access",
          "args": [
            "xdr",
            "args->access",
            "&hdr"
          ],
          "line": 2072
        },
        "resolved": true,
        "details": {
          "function_name": "encode_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1121-1125",
          "snippet": "static void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)\n\nstatic void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_putfh",
          "args": [
            "xdr",
            "args->fh",
            "&hdr"
          ],
          "line": 2071
        },
        "resolved": true,
        "details": {
          "function_name": "encode_putfh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1529-1534",
          "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_sequence",
          "args": [
            "xdr",
            "&args->seq_args",
            "&hdr"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1868-1904",
          "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_sequence_maxsz\t0",
            "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_compound_hdr",
          "args": [
            "xdr",
            "req",
            "&hdr"
          ],
          "line": 2069
        },
        "resolved": true,
        "details": {
          "function_name": "encode_compound_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "955-973",
          "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS4_MAXTAGLEN\t\t0",
            "#define NFS4_MAXTAGLEN\t\t20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_xdr_minorversion",
          "args": [
            "&args->seq_args"
          ],
          "line": 2066
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_xdr_minorversion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "2049-2057",
          "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs4_xdr_enc_access(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tconst struct nfs4_accessargs *args)\n{\n\tstruct compound_hdr hdr = {\n\t\t.minorversion = nfs4_xdr_minorversion(&args->seq_args),\n\t};\n\n\tencode_compound_hdr(xdr, req, &hdr);\n\tencode_sequence(xdr, &args->seq_args, &hdr);\n\tencode_putfh(xdr, args->fh, &hdr);\n\tencode_access(xdr, args->access, &hdr);\n\tencode_getfattr(xdr, args->bitmask, &hdr);\n\tencode_nops(&hdr);\n}"
  },
  {
    "function_name": "nfs4_xdr_minorversion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2049-2057",
    "snippet": "static u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic u32 nfs4_xdr_minorversion(const struct nfs4_sequence_args *args)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session = args->sa_slot->table->session;\n\tif (session)\n\t\treturn session->clp->cl_mvops->minor_version;\n#endif /* CONFIG_NFS_V4_1 */\n\treturn 0;\n}"
  },
  {
    "function_name": "encode_free_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2036-2042",
    "snippet": "static void encode_free_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_free_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_FREE_STATEID, decode_free_stateid_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_free_stateid_maxsz\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 2041
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_FREE_STATEID",
            "decode_free_stateid_maxsz",
            "hdr"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_free_stateid_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_free_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_free_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_FREE_STATEID, decode_free_stateid_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n}"
  },
  {
    "function_name": "encode_test_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2027-2034",
    "snippet": "static void encode_test_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_test_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_TEST_STATEID, decode_test_stateid_maxsz, hdr);\n\tencode_uint32(xdr, 1);\n\tencode_nfs4_stateid(xdr, args->stateid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_test_stateid_maxsz\t(op_decode_hdr_maxsz + 2 + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "args->stateid"
          ],
          "line": 2033
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "1"
          ],
          "line": 2032
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_TEST_STATEID",
            "decode_test_stateid_maxsz",
            "hdr"
          ],
          "line": 2031
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_test_stateid_maxsz\t(op_decode_hdr_maxsz + 2 + 1)\n\nstatic void encode_test_stateid(struct xdr_stream *xdr,\n\t\t\t\tstruct nfs41_test_stateid_args *args,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_TEST_STATEID, decode_test_stateid_maxsz, hdr);\n\tencode_uint32(xdr, 1);\n\tencode_nfs4_stateid(xdr, args->stateid);\n}"
  },
  {
    "function_name": "encode_secinfo_no_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "2017-2025",
    "snippet": "static int\nencode_secinfo_no_name(struct xdr_stream *xdr,\n\t\t       const struct nfs41_secinfo_no_name_args *args,\n\t\t       struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO_NO_NAME, decode_secinfo_no_name_maxsz, hdr);\n\tencode_uint32(xdr, args->style);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_secinfo_no_name_maxsz decode_secinfo_maxsz"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "args->style"
          ],
          "line": 2023
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SECINFO_NO_NAME",
            "decode_secinfo_no_name_maxsz",
            "hdr"
          ],
          "line": 2022
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_secinfo_no_name_maxsz decode_secinfo_maxsz\n\nstatic int\nencode_secinfo_no_name(struct xdr_stream *xdr,\n\t\t       const struct nfs41_secinfo_no_name_args *args,\n\t\t       struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO_NO_NAME, decode_secinfo_no_name_maxsz, hdr);\n\tencode_uint32(xdr, args->style);\n\treturn 0;\n}"
  },
  {
    "function_name": "encode_layoutreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1991-2015",
    "snippet": "static void\nencode_layoutreturn(struct xdr_stream *xdr,\n\t\t    const struct nfs4_layoutreturn_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTRETURN, decode_layoutreturn_maxsz, hdr);\n\tp = reserve_space(xdr, 16);\n\t*p++ = cpu_to_be32(0);\t\t/* reclaim. always 0 for now */\n\t*p++ = cpu_to_be32(args->layout_type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\t*p = cpu_to_be32(RETURN_FILE);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tspin_lock(&args->inode->i_lock);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tspin_unlock(&args->inode->i_lock);\n\tif (NFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn) {\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn(\n\t\t\tNFS_I(args->inode)->layout, xdr, args);\n\t} else\n\t\tencode_uint32(xdr, 0);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_layoutreturn_maxsz (op_decode_hdr_maxsz + \\\n\t\t\t\t1 + decode_stateid_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "0"
          ],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "NFS_I(args->inode)->layout",
            "xdr",
            "args"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "args->inode"
          ],
          "line": 2012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "args->inode"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "args->inode"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&args->inode->i_lock"
          ],
          "line": 2009
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 2008
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&args->inode->i_lock"
          ],
          "line": 2007
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->range.length"
          ],
          "line": 2006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->range.offset"
          ],
          "line": 2005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "16"
          ],
          "line": 2004
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "RETURN_FILE"
          ],
          "line": 2003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->range.iomode"
          ],
          "line": 2002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->layout_type"
          ],
          "line": 2001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 2000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LAYOUTRETURN",
            "decode_layoutreturn_maxsz",
            "hdr"
          ],
          "line": 1998
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_layoutreturn_maxsz (op_decode_hdr_maxsz + \\\n\t\t\t\t1 + decode_stateid_maxsz)\n\nstatic void\nencode_layoutreturn(struct xdr_stream *xdr,\n\t\t    const struct nfs4_layoutreturn_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTRETURN, decode_layoutreturn_maxsz, hdr);\n\tp = reserve_space(xdr, 16);\n\t*p++ = cpu_to_be32(0);\t\t/* reclaim. always 0 for now */\n\t*p++ = cpu_to_be32(args->layout_type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\t*p = cpu_to_be32(RETURN_FILE);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tspin_lock(&args->inode->i_lock);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tspin_unlock(&args->inode->i_lock);\n\tif (NFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn) {\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->encode_layoutreturn(\n\t\t\tNFS_I(args->inode)->layout, xdr, args);\n\t} else\n\t\tencode_uint32(xdr, 0);\n}"
  },
  {
    "function_name": "encode_layoutcommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1953-1989",
    "snippet": "static int\nencode_layoutcommit(struct xdr_stream *xdr,\n\t\t    struct inode *inode,\n\t\t    struct nfs4_layoutcommit_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: lbw: %llu type: %d\\n\", __func__, args->lastbytewritten,\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->id);\n\n\tencode_op_hdr(xdr, OP_LAYOUTCOMMIT, decode_layoutcommit_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t/* Only whole file layouts */\n\tp = xdr_encode_hyper(p, 0); /* offset */\n\tp = xdr_encode_hyper(p, args->lastbytewritten + 1);\t/* length */\n\t*p = cpu_to_be32(0); /* reclaim */\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(1); /* newoffset = TRUE */\n\tp = xdr_encode_hyper(p, args->lastbytewritten);\n\t*p++ = cpu_to_be32(0); /* Never send time_modify_changed */\n\t*p++ = cpu_to_be32(NFS_SERVER(args->inode)->pnfs_curr_ld->id);/* type */\n\n\tif (NFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit) {\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit(\n\t\t\tNFS_I(inode)->layout, xdr, args);\n\t} else {\n\t\tencode_uint32(xdr, args->layoutupdate_len);\n\t\tif (args->layoutupdate_pages) {\n\t\t\txdr_write_pages(xdr, args->layoutupdate_pages, 0,\n\t\t\t\t\targs->layoutupdate_len);\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_layoutcommit_maxsz (op_decode_hdr_maxsz + 3)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_write_pages",
          "args": [
            "xdr",
            "args->layoutupdate_pages",
            "0",
            "args->layoutupdate_len"
          ],
          "line": 1983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "args->layoutupdate_len"
          ],
          "line": 1981
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "NFS_I(inode)->layout",
            "xdr",
            "args"
          ],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 1979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 1977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS_SERVER(args->inode)->pnfs_curr_ld->id"
          ],
          "line": 1975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "args->inode"
          ],
          "line": 1975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->lastbytewritten"
          ],
          "line": 1973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "20"
          ],
          "line": 1971
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 1970
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->lastbytewritten + 1"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "0"
          ],
          "line": 1967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LAYOUTCOMMIT",
            "decode_layoutcommit_maxsz",
            "hdr"
          ],
          "line": 1964
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: lbw: %llu type: %d\\n\"",
            "__func__",
            "args->lastbytewritten",
            "NFS_SERVER(args->inode)->pnfs_curr_ld->id"
          ],
          "line": 1961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "args->inode"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_layoutcommit_maxsz (op_decode_hdr_maxsz + 3)\n\nstatic int\nencode_layoutcommit(struct xdr_stream *xdr,\n\t\t    struct inode *inode,\n\t\t    struct nfs4_layoutcommit_args *args,\n\t\t    struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tdprintk(\"%s: lbw: %llu type: %d\\n\", __func__, args->lastbytewritten,\n\t\tNFS_SERVER(args->inode)->pnfs_curr_ld->id);\n\n\tencode_op_hdr(xdr, OP_LAYOUTCOMMIT, decode_layoutcommit_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t/* Only whole file layouts */\n\tp = xdr_encode_hyper(p, 0); /* offset */\n\tp = xdr_encode_hyper(p, args->lastbytewritten + 1);\t/* length */\n\t*p = cpu_to_be32(0); /* reclaim */\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(1); /* newoffset = TRUE */\n\tp = xdr_encode_hyper(p, args->lastbytewritten);\n\t*p++ = cpu_to_be32(0); /* Never send time_modify_changed */\n\t*p++ = cpu_to_be32(NFS_SERVER(args->inode)->pnfs_curr_ld->id);/* type */\n\n\tif (NFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit) {\n\t\tNFS_SERVER(inode)->pnfs_curr_ld->encode_layoutcommit(\n\t\t\tNFS_I(inode)->layout, xdr, args);\n\t} else {\n\t\tencode_uint32(xdr, args->layoutupdate_len);\n\t\tif (args->layoutupdate_pages) {\n\t\t\txdr_write_pages(xdr, args->layoutupdate_pages, 0,\n\t\t\t\t\targs->layoutupdate_len);\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "encode_layoutget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1926-1951",
    "snippet": "static void\nencode_layoutget(struct xdr_stream *xdr,\n\t\t      const struct nfs4_layoutget_args *args,\n\t\t      struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTGET, decode_layoutget_maxsz, hdr);\n\tp = reserve_space(xdr, 36);\n\t*p++ = cpu_to_be32(0);     /* Signal layout available */\n\t*p++ = cpu_to_be32(args->type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tp = xdr_encode_hyper(p, args->minlength);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tencode_uint32(xdr, args->maxcount);\n\n\tdprintk(\"%s: 1st type:0x%x iomode:%d off:%lu len:%lu mc:%d\\n\",\n\t\t__func__,\n\t\targs->type,\n\t\targs->range.iomode,\n\t\t(unsigned long)args->range.offset,\n\t\t(unsigned long)args->range.length,\n\t\targs->maxcount);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_layoutget_maxsz\t(op_decode_hdr_maxsz + 8 + \\\n\t\t\t\tdecode_stateid_maxsz + \\\n\t\t\t\tXDR_QUADLEN(PNFS_LAYOUT_MAXSIZE))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: 1st type:0x%x iomode:%d off:%lu len:%lu mc:%d\\n\"",
            "__func__",
            "args->type",
            "args->range.iomode",
            "(unsigned long)args->range.offset",
            "(unsigned long)args->range.length",
            "args->maxcount"
          ],
          "line": 1944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "args->maxcount"
          ],
          "line": 1942
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 1941
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->minlength"
          ],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->range.length"
          ],
          "line": 1939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->range.offset"
          ],
          "line": 1938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->range.iomode"
          ],
          "line": 1937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->type"
          ],
          "line": 1936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "36"
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LAYOUTGET",
            "decode_layoutget_maxsz",
            "hdr"
          ],
          "line": 1933
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_layoutget_maxsz\t(op_decode_hdr_maxsz + 8 + \\\n\t\t\t\tdecode_stateid_maxsz + \\\n\t\t\t\tXDR_QUADLEN(PNFS_LAYOUT_MAXSIZE))\n\nstatic void\nencode_layoutget(struct xdr_stream *xdr,\n\t\t      const struct nfs4_layoutget_args *args,\n\t\t      struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LAYOUTGET, decode_layoutget_maxsz, hdr);\n\tp = reserve_space(xdr, 36);\n\t*p++ = cpu_to_be32(0);     /* Signal layout available */\n\t*p++ = cpu_to_be32(args->type);\n\t*p++ = cpu_to_be32(args->range.iomode);\n\tp = xdr_encode_hyper(p, args->range.offset);\n\tp = xdr_encode_hyper(p, args->range.length);\n\tp = xdr_encode_hyper(p, args->minlength);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tencode_uint32(xdr, args->maxcount);\n\n\tdprintk(\"%s: 1st type:0x%x iomode:%d off:%lu len:%lu mc:%d\\n\",\n\t\t__func__,\n\t\targs->type,\n\t\targs->range.iomode,\n\t\t(unsigned long)args->range.offset,\n\t\t(unsigned long)args->range.length,\n\t\targs->maxcount);\n}"
  },
  {
    "function_name": "encode_getdeviceinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1907-1924",
    "snippet": "static void\nencode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t     const struct nfs4_getdeviceinfo_args *args,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETDEVICEINFO, decode_getdeviceinfo_maxsz, hdr);\n\tp = reserve_space(xdr, NFS4_DEVICEID4_SIZE + 4 + 4);\n\tp = xdr_encode_opaque_fixed(p, args->pdev->dev_id.data,\n\t\t\t\t    NFS4_DEVICEID4_SIZE);\n\t*p++ = cpu_to_be32(args->pdev->layout_type);\n\t*p++ = cpu_to_be32(args->pdev->maxcount);\t/* gdia_maxcount */\n\n\tp = reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(1);\t\t\t/* bitmap length */\n\t*p++ = cpu_to_be32(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE"
          ],
          "line": 1923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4 + 4"
          ],
          "line": 1921
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->pdev->maxcount"
          ],
          "line": 1919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->pdev->layout_type"
          ],
          "line": 1918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "args->pdev->dev_id.data",
            "NFS4_DEVICEID4_SIZE"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_GETDEVICEINFO",
            "decode_getdeviceinfo_maxsz",
            "hdr"
          ],
          "line": 1914
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void\nencode_getdeviceinfo(struct xdr_stream *xdr,\n\t\t     const struct nfs4_getdeviceinfo_args *args,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETDEVICEINFO, decode_getdeviceinfo_maxsz, hdr);\n\tp = reserve_space(xdr, NFS4_DEVICEID4_SIZE + 4 + 4);\n\tp = xdr_encode_opaque_fixed(p, args->pdev->dev_id.data,\n\t\t\t\t    NFS4_DEVICEID4_SIZE);\n\t*p++ = cpu_to_be32(args->pdev->layout_type);\n\t*p++ = cpu_to_be32(args->pdev->maxcount);\t/* gdia_maxcount */\n\n\tp = reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(1);\t\t\t/* bitmap length */\n\t*p++ = cpu_to_be32(NOTIFY_DEVICEID4_CHANGE | NOTIFY_DEVICEID4_DELETE);\n}"
  },
  {
    "function_name": "encode_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1868-1904",
    "snippet": "static void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_sequence_maxsz\t0",
      "#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->sa_cache_this"
          ],
          "line": 1902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "tp->highest_used_slotid"
          ],
          "line": 1901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "slot->slot_nr"
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "slot->seq_nr"
          ],
          "line": 1899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "session->sess_id.data",
            "NFS4_MAX_SESSIONID_LEN"
          ],
          "line": 1898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "NFS4_MAX_SESSIONID_LEN + 16"
          ],
          "line": 1897
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\"",
            "__func__",
            "((u32 *)session->sess_id.data)[0]",
            "((u32 *)session->sess_id.data)[1]",
            "((u32 *)session->sess_id.data)[2]",
            "((u32 *)session->sess_id.data)[3]",
            "slot->seq_nr",
            "slot->slot_nr",
            "tp->highest_used_slotid",
            "args->sa_cache_this"
          ],
          "line": 1888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SEQUENCE",
            "decode_sequence_maxsz",
            "hdr"
          ],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_sequence_maxsz\t0\n#define decode_sequence_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tXDR_QUADLEN(NFS4_MAX_SESSIONID_LEN) + 5)\n\nstatic void encode_sequence(struct xdr_stream *xdr,\n\t\t\t    const struct nfs4_sequence_args *args,\n\t\t\t    struct compound_hdr *hdr)\n{\n#if defined(CONFIG_NFS_V4_1)\n\tstruct nfs4_session *session;\n\tstruct nfs4_slot_table *tp;\n\tstruct nfs4_slot *slot = args->sa_slot;\n\t__be32 *p;\n\n\ttp = slot->table;\n\tsession = tp->session;\n\tif (!session)\n\t\treturn;\n\n\tencode_op_hdr(xdr, OP_SEQUENCE, decode_sequence_maxsz, hdr);\n\n\t/*\n\t * Sessionid + seqid + slotid + max slotid + cache_this\n\t */\n\tdprintk(\"%s: sessionid=%u:%u:%u:%u seqid=%d slotid=%d \"\n\t\t\"max_slotid=%d cache_this=%d\\n\",\n\t\t__func__,\n\t\t((u32 *)session->sess_id.data)[0],\n\t\t((u32 *)session->sess_id.data)[1],\n\t\t((u32 *)session->sess_id.data)[2],\n\t\t((u32 *)session->sess_id.data)[3],\n\t\tslot->seq_nr, slot->slot_nr,\n\t\ttp->highest_used_slotid, args->sa_cache_this);\n\tp = reserve_space(xdr, NFS4_MAX_SESSIONID_LEN + 16);\n\tp = xdr_encode_opaque_fixed(p, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n\t*p++ = cpu_to_be32(slot->seq_nr);\n\t*p++ = cpu_to_be32(slot->slot_nr);\n\t*p++ = cpu_to_be32(tp->highest_used_slotid);\n\t*p = cpu_to_be32(args->sa_cache_this);\n#endif /* CONFIG_NFS_V4_1 */\n}"
  },
  {
    "function_name": "encode_reclaim_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1859-1865",
    "snippet": "static void encode_reclaim_complete(struct xdr_stream *xdr,\n\t\t\t\t    struct nfs41_reclaim_complete_args *args,\n\t\t\t\t    struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RECLAIM_COMPLETE, decode_reclaim_complete_maxsz, hdr);\n\tencode_uint32(xdr, args->one_fs);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_reclaim_complete_maxsz\t(op_decode_hdr_maxsz + 4)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "args->one_fs"
          ],
          "line": 1864
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_RECLAIM_COMPLETE",
            "decode_reclaim_complete_maxsz",
            "hdr"
          ],
          "line": 1863
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_reclaim_complete_maxsz\t(op_decode_hdr_maxsz + 4)\n\nstatic void encode_reclaim_complete(struct xdr_stream *xdr,\n\t\t\t\t    struct nfs41_reclaim_complete_args *args,\n\t\t\t\t    struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RECLAIM_COMPLETE, decode_reclaim_complete_maxsz, hdr);\n\tencode_uint32(xdr, args->one_fs);\n}"
  },
  {
    "function_name": "encode_destroy_clientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1851-1857",
    "snippet": "static void encode_destroy_clientid(struct xdr_stream *xdr,\n\t\t\t\t   uint64_t clientid,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_CLIENTID, decode_destroy_clientid_maxsz, hdr);\n\tencode_uint64(xdr, clientid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_destroy_clientid_maxsz   (op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint64",
          "args": [
            "xdr",
            "clientid"
          ],
          "line": 1856
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "938-944",
          "snippet": "static void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_DESTROY_CLIENTID",
            "decode_destroy_clientid_maxsz",
            "hdr"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_destroy_clientid_maxsz   (op_decode_hdr_maxsz)\n\nstatic void encode_destroy_clientid(struct xdr_stream *xdr,\n\t\t\t\t   uint64_t clientid,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_CLIENTID, decode_destroy_clientid_maxsz, hdr);\n\tencode_uint64(xdr, clientid);\n}"
  },
  {
    "function_name": "encode_destroy_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1843-1849",
    "snippet": "static void encode_destroy_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs4_session *session,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_SESSION, decode_destroy_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_opaque_fixed",
          "args": [
            "xdr",
            "session->sess_id.data",
            "NFS4_MAX_SESSIONID_LEN"
          ],
          "line": 1848
        },
        "resolved": true,
        "details": {
          "function_name": "encode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "914-920",
          "snippet": "static void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_DESTROY_SESSION",
            "decode_destroy_session_maxsz",
            "hdr"
          ],
          "line": 1847
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_destroy_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs4_session *session,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DESTROY_SESSION, decode_destroy_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, session->sess_id.data, NFS4_MAX_SESSIONID_LEN);\n}"
  },
  {
    "function_name": "encode_create_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1790-1841",
    "snippet": "static void encode_create_session(struct xdr_stream *xdr,\n\t\t\t\t  struct nfs41_create_session_args *args,\n\t\t\t\t  struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct nfs_client *clp = args->client;\n\tstruct rpc_clnt *clnt = clp->cl_rpcclient;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\tu32 max_resp_sz_cached;\n\n\t/*\n\t * Assumes OPEN is the biggest non-idempotent compound.\n\t * 2 is the verifier.\n\t */\n\tmax_resp_sz_cached = (NFS4_dec_open_sz + RPC_REPHDRSIZE +\n\t\t\t      RPC_MAX_AUTH_SIZE + 2) * XDR_UNIT;\n\n\tencode_op_hdr(xdr, OP_CREATE_SESSION, decode_create_session_maxsz, hdr);\n\tp = reserve_space(xdr, 16 + 2*28 + 20 + clnt->cl_nodelen + 12);\n\tp = xdr_encode_hyper(p, args->clientid);\n\t*p++ = cpu_to_be32(args->seqid);\t\t\t/*Sequence id */\n\t*p++ = cpu_to_be32(args->flags);\t\t\t/*flags */\n\n\t/* Fore Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(max_resp_sz_cached);\t\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t/* Back Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz_cached);\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t*p++ = cpu_to_be32(args->cb_program);\t\t/* cb_program */\n\t*p++ = cpu_to_be32(1);\n\t*p++ = cpu_to_be32(RPC_AUTH_UNIX);\t\t\t/* auth_sys */\n\n\t/* authsys_parms rfc1831 */\n\t*p++ = cpu_to_be32(nn->boot_time.tv_nsec);\t/* stamp */\n\tp = xdr_encode_array(p, clnt->cl_nodename, clnt->cl_nodelen);\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* UID */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* GID */\n\t*p = cpu_to_be32(0);\t\t\t\t/* No more gids */\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS4_dec_open_sz        (compound_decode_hdr_maxsz + \\\n\t\t\t\tdecode_sequence_maxsz + \\\n\t\t\t\tdecode_putfh_maxsz + \\\n\t\t\t\tdecode_open_maxsz + \\\n\t\t\t\tdecode_access_maxsz + \\\n\t\t\t\tdecode_getfh_maxsz + \\\n\t\t\t\tdecode_getattr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_array",
          "args": [
            "p",
            "clnt->cl_nodename",
            "clnt->cl_nodelen"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nn->boot_time.tv_nsec"
          ],
          "line": 1836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "RPC_AUTH_UNIX"
          ],
          "line": 1833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->cb_program"
          ],
          "line": 1831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->bc_attrs.max_reqs"
          ],
          "line": 1828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->bc_attrs.max_ops"
          ],
          "line": 1827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->bc_attrs.max_resp_sz_cached"
          ],
          "line": 1826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->bc_attrs.max_resp_sz"
          ],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->bc_attrs.max_rqst_sz"
          ],
          "line": 1824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->fc_attrs.max_reqs"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->fc_attrs.max_ops"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "max_resp_sz_cached"
          ],
          "line": 1817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->fc_attrs.max_resp_sz"
          ],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->fc_attrs.max_rqst_sz"
          ],
          "line": 1815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->flags"
          ],
          "line": 1811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->seqid"
          ],
          "line": 1810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->clientid"
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "16 + 2*28 + 20 + clnt->cl_nodelen + 12"
          ],
          "line": 1808
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_CREATE_SESSION",
            "decode_create_session_maxsz",
            "hdr"
          ],
          "line": 1807
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "clp->cl_net",
            "nfs_net_id"
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_dec_open_sz        (compound_decode_hdr_maxsz + \\\n\t\t\t\tdecode_sequence_maxsz + \\\n\t\t\t\tdecode_putfh_maxsz + \\\n\t\t\t\tdecode_open_maxsz + \\\n\t\t\t\tdecode_access_maxsz + \\\n\t\t\t\tdecode_getfh_maxsz + \\\n\t\t\t\tdecode_getattr_maxsz)\n\nstatic void encode_create_session(struct xdr_stream *xdr,\n\t\t\t\t  struct nfs41_create_session_args *args,\n\t\t\t\t  struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct nfs_client *clp = args->client;\n\tstruct rpc_clnt *clnt = clp->cl_rpcclient;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\tu32 max_resp_sz_cached;\n\n\t/*\n\t * Assumes OPEN is the biggest non-idempotent compound.\n\t * 2 is the verifier.\n\t */\n\tmax_resp_sz_cached = (NFS4_dec_open_sz + RPC_REPHDRSIZE +\n\t\t\t      RPC_MAX_AUTH_SIZE + 2) * XDR_UNIT;\n\n\tencode_op_hdr(xdr, OP_CREATE_SESSION, decode_create_session_maxsz, hdr);\n\tp = reserve_space(xdr, 16 + 2*28 + 20 + clnt->cl_nodelen + 12);\n\tp = xdr_encode_hyper(p, args->clientid);\n\t*p++ = cpu_to_be32(args->seqid);\t\t\t/*Sequence id */\n\t*p++ = cpu_to_be32(args->flags);\t\t\t/*flags */\n\n\t/* Fore Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(max_resp_sz_cached);\t\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->fc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t/* Back Channel */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* header padding size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_rqst_sz);\t/* max req size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz);\t/* max resp size */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_resp_sz_cached);\t/* Max resp sz cached */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_ops);\t/* max operations */\n\t*p++ = cpu_to_be32(args->bc_attrs.max_reqs);\t/* max requests */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* rdmachannel_attrs */\n\n\t*p++ = cpu_to_be32(args->cb_program);\t\t/* cb_program */\n\t*p++ = cpu_to_be32(1);\n\t*p++ = cpu_to_be32(RPC_AUTH_UNIX);\t\t\t/* auth_sys */\n\n\t/* authsys_parms rfc1831 */\n\t*p++ = cpu_to_be32(nn->boot_time.tv_nsec);\t/* stamp */\n\tp = xdr_encode_array(p, clnt->cl_nodename, clnt->cl_nodelen);\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* UID */\n\t*p++ = cpu_to_be32(0);\t\t\t\t/* GID */\n\t*p = cpu_to_be32(0);\t\t\t\t/* No more gids */\n}"
  },
  {
    "function_name": "encode_exchange_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1739-1788",
    "snippet": "static void encode_exchange_id(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_exchange_id_args *args,\n\t\t\t       struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tchar impl_name[IMPL_NAME_LIMIT];\n\tint len = 0;\n\n\tencode_op_hdr(xdr, OP_EXCHANGE_ID, decode_exchange_id_maxsz, hdr);\n\tencode_nfs4_verifier(xdr, args->verifier);\n\n\tencode_string(xdr, args->id_len, args->id);\n\n\tencode_uint32(xdr, args->flags);\n\tencode_uint32(xdr, args->state_protect.how);\n\n\tswitch (args->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tencode_op_map(xdr, &args->state_protect.enforce);\n\t\tencode_op_map(xdr, &args->state_protect.allow);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\tif (send_implementation_id &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) > 1 &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN)\n\t\t<= sizeof(impl_name) + 1)\n\t\tlen = snprintf(impl_name, sizeof(impl_name), \"%s %s %s %s\",\n\t\t\t       utsname()->sysname, utsname()->release,\n\t\t\t       utsname()->version, utsname()->machine);\n\n\tif (len > 0) {\n\t\tencode_uint32(xdr, 1);\t/* implementation id array length=1 */\n\n\t\tencode_string(xdr,\n\t\t\tsizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) - 1,\n\t\t\tCONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN);\n\t\tencode_string(xdr, len, impl_name);\n\t\t/* just send zeros for nii_date - the date is in nii_name */\n\t\tp = reserve_space(xdr, 12);\n\t\tp = xdr_encode_hyper(p, 0);\n\t\t*p = cpu_to_be32(0);\n\t} else\n\t\tencode_uint32(xdr, 0);\t/* implementation id array length=0 */\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define IMPL_NAME_LIMIT (sizeof(utsname()->sysname) + sizeof(utsname()->release) + \\\n\t\t\t sizeof(utsname()->version) + sizeof(utsname()->machine) + 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "0"
          ],
          "line": 1787
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "0"
          ],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "12"
          ],
          "line": 1783
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "len",
            "impl_name"
          ],
          "line": 1781
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "impl_name",
            "sizeof(impl_name)",
            "\"%s %s %s %s\"",
            "utsname()->sysname",
            "utsname()->release",
            "utsname()->version",
            "utsname()->machine"
          ],
          "line": 1771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utsname",
          "args": [],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utsname",
          "args": [],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utsname",
          "args": [],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utsname",
          "args": [],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_op_map",
          "args": [
            "xdr",
            "&args->state_protect.allow"
          ],
          "line": 1760
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1731-1737",
          "snippet": "static void encode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\tunsigned int i;\n\tencode_uint32(xdr, NFS4_OP_MAP_NUM_WORDS);\n\tfor (i = 0; i < NFS4_OP_MAP_NUM_WORDS; i++)\n\t\tencode_uint32(xdr, op_map->u.words[i]);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\tunsigned int i;\n\tencode_uint32(xdr, NFS4_OP_MAP_NUM_WORDS);\n\tfor (i = 0; i < NFS4_OP_MAP_NUM_WORDS; i++)\n\t\tencode_uint32(xdr, op_map->u.words[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_verifier",
          "args": [
            "xdr",
            "args->verifier"
          ],
          "line": 1748
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "995-998",
          "snippet": "static void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_EXCHANGE_ID",
            "decode_exchange_id_maxsz",
            "hdr"
          ],
          "line": 1747
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define IMPL_NAME_LIMIT (sizeof(utsname()->sysname) + sizeof(utsname()->release) + \\\n\t\t\t sizeof(utsname()->version) + sizeof(utsname()->machine) + 8)\n\nstatic void encode_exchange_id(struct xdr_stream *xdr,\n\t\t\t       struct nfs41_exchange_id_args *args,\n\t\t\t       struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tchar impl_name[IMPL_NAME_LIMIT];\n\tint len = 0;\n\n\tencode_op_hdr(xdr, OP_EXCHANGE_ID, decode_exchange_id_maxsz, hdr);\n\tencode_nfs4_verifier(xdr, args->verifier);\n\n\tencode_string(xdr, args->id_len, args->id);\n\n\tencode_uint32(xdr, args->flags);\n\tencode_uint32(xdr, args->state_protect.how);\n\n\tswitch (args->state_protect.how) {\n\tcase SP4_NONE:\n\t\tbreak;\n\tcase SP4_MACH_CRED:\n\t\tencode_op_map(xdr, &args->state_protect.enforce);\n\t\tencode_op_map(xdr, &args->state_protect.allow);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\tif (send_implementation_id &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) > 1 &&\n\t    sizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN)\n\t\t<= sizeof(impl_name) + 1)\n\t\tlen = snprintf(impl_name, sizeof(impl_name), \"%s %s %s %s\",\n\t\t\t       utsname()->sysname, utsname()->release,\n\t\t\t       utsname()->version, utsname()->machine);\n\n\tif (len > 0) {\n\t\tencode_uint32(xdr, 1);\t/* implementation id array length=1 */\n\n\t\tencode_string(xdr,\n\t\t\tsizeof(CONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN) - 1,\n\t\t\tCONFIG_NFS_V4_1_IMPLEMENTATION_ID_DOMAIN);\n\t\tencode_string(xdr, len, impl_name);\n\t\t/* just send zeros for nii_date - the date is in nii_name */\n\t\tp = reserve_space(xdr, 12);\n\t\tp = xdr_encode_hyper(p, 0);\n\t\t*p = cpu_to_be32(0);\n\t} else\n\t\tencode_uint32(xdr, 0);\t/* implementation id array length=0 */\n}"
  },
  {
    "function_name": "encode_op_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1731-1737",
    "snippet": "static void encode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\tunsigned int i;\n\tencode_uint32(xdr, NFS4_OP_MAP_NUM_WORDS);\n\tfor (i = 0; i < NFS4_OP_MAP_NUM_WORDS; i++)\n\t\tencode_uint32(xdr, op_map->u.words[i]);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "op_map->u.words[i]"
          ],
          "line": 1736
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_map(struct xdr_stream *xdr, struct nfs4_op_map *op_map)\n{\n\tunsigned int i;\n\tencode_uint32(xdr, NFS4_OP_MAP_NUM_WORDS);\n\tfor (i = 0; i < NFS4_OP_MAP_NUM_WORDS; i++)\n\t\tencode_uint32(xdr, op_map->u.words[i]);\n}"
  },
  {
    "function_name": "encode_bind_conn_to_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1717-1729",
    "snippet": "static void encode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs41_bind_conn_to_session_args *args,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION,\n\t\tdecode_bind_conn_to_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, args->sessionid.data, NFS4_MAX_SESSIONID_LEN);\n\tp = xdr_reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(args->dir);\n\t*p = (args->use_conn_in_rdma_mode) ? cpu_to_be32(1) : cpu_to_be32(0);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->dir"
          ],
          "line": 1727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_opaque_fixed",
          "args": [
            "xdr",
            "args->sessionid.data",
            "NFS4_MAX_SESSIONID_LEN"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "encode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "914-920",
          "snippet": "static void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_BIND_CONN_TO_SESSION",
            "decode_bind_conn_to_session_maxsz",
            "hdr"
          ],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_bind_conn_to_session(struct xdr_stream *xdr,\n\t\t\t\t   struct nfs41_bind_conn_to_session_args *args,\n\t\t\t\t   struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_BIND_CONN_TO_SESSION,\n\t\tdecode_bind_conn_to_session_maxsz, hdr);\n\tencode_opaque_fixed(xdr, args->sessionid.data, NFS4_MAX_SESSIONID_LEN);\n\tp = xdr_reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(args->dir);\n\t*p = (args->use_conn_in_rdma_mode) ? cpu_to_be32(1) : cpu_to_be32(0);\n}"
  },
  {
    "function_name": "encode_secinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1709-1713",
    "snippet": "static void encode_secinfo(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO, decode_secinfo_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_secinfo_maxsz\t(op_decode_hdr_maxsz + 1 + ((NFS_MAX_SECFLAVORS * (16 + GSS_OID_MAX_LEN)) / 4))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "name->len",
            "name->name"
          ],
          "line": 1712
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SECINFO",
            "decode_secinfo_maxsz",
            "hdr"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_secinfo_maxsz\t(op_decode_hdr_maxsz + 1 + ((NFS_MAX_SECFLAVORS * (16 + GSS_OID_MAX_LEN)) / 4))\n\nstatic void encode_secinfo(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SECINFO, decode_secinfo_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
  },
  {
    "function_name": "encode_delegreturn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1703-1707",
    "snippet": "static void encode_delegreturn(struct xdr_stream *xdr, const nfs4_stateid *stateid, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DELEGRETURN, decode_delegreturn_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, stateid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_delegreturn_maxsz (op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "stateid"
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_DELEGRETURN",
            "decode_delegreturn_maxsz",
            "hdr"
          ],
          "line": 1705
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_delegreturn_maxsz (op_decode_hdr_maxsz)\n\nstatic void encode_delegreturn(struct xdr_stream *xdr, const nfs4_stateid *stateid, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_DELEGRETURN, decode_delegreturn_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, stateid);\n}"
  },
  {
    "function_name": "encode_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1687-1701",
    "snippet": "static void encode_write(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\t struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_WRITE, decode_write_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p++ = cpu_to_be32(args->stable);\n\t*p = cpu_to_be32(args->count);\n\n\txdr_write_pages(xdr, args->pages, args->pgbase, args->count);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_write_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t 2 + decode_verifier_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_write_pages",
          "args": [
            "xdr",
            "args->pages",
            "args->pgbase",
            "args->count"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->count"
          ],
          "line": 1698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->stable"
          ],
          "line": 1697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->offset"
          ],
          "line": 1696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "16"
          ],
          "line": 1695
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 1693
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_WRITE",
            "decode_write_maxsz",
            "hdr"
          ],
          "line": 1692
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_write_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t 2 + decode_verifier_maxsz)\n\nstatic void encode_write(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\t struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_WRITE, decode_write_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p++ = cpu_to_be32(args->stable);\n\t*p = cpu_to_be32(args->count);\n\n\txdr_write_pages(xdr, args->pages, args->pgbase, args->count);\n}"
  },
  {
    "function_name": "encode_setclientid_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1679-1685",
    "snippet": "static void encode_setclientid_confirm(struct xdr_stream *xdr, const struct nfs4_setclientid_res *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM,\n\t\t\tdecode_setclientid_confirm_maxsz, hdr);\n\tencode_uint64(xdr, arg->clientid);\n\tencode_nfs4_verifier(xdr, &arg->confirm);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_setclientid_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_verifier",
          "args": [
            "xdr",
            "&arg->confirm"
          ],
          "line": 1684
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "995-998",
          "snippet": "static void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_uint64",
          "args": [
            "xdr",
            "arg->clientid"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "938-944",
          "snippet": "static void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SETCLIENTID_CONFIRM",
            "decode_setclientid_confirm_maxsz",
            "hdr"
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setclientid_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)\n\nstatic void encode_setclientid_confirm(struct xdr_stream *xdr, const struct nfs4_setclientid_res *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETCLIENTID_CONFIRM,\n\t\t\tdecode_setclientid_confirm_maxsz, hdr);\n\tencode_uint64(xdr, arg->clientid);\n\tencode_nfs4_verifier(xdr, &arg->confirm);\n}"
  },
  {
    "function_name": "encode_setclientid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1663-1677",
    "snippet": "static void encode_setclientid(struct xdr_stream *xdr, const struct nfs4_setclientid *setclientid, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_SETCLIENTID, decode_setclientid_maxsz, hdr);\n\tencode_nfs4_verifier(xdr, setclientid->sc_verifier);\n\n\tencode_string(xdr, setclientid->sc_name_len, setclientid->sc_name);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(setclientid->sc_prog);\n\tencode_string(xdr, setclientid->sc_netid_len, setclientid->sc_netid);\n\tencode_string(xdr, setclientid->sc_uaddr_len, setclientid->sc_uaddr);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(setclientid->sc_cb_ident);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_setclientid_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t2 /* clientid */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "setclientid->sc_cb_ident"
          ],
          "line": 1676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1675
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "setclientid->sc_uaddr_len",
            "setclientid->sc_uaddr"
          ],
          "line": 1674
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "setclientid->sc_prog"
          ],
          "line": 1672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_nfs4_verifier",
          "args": [
            "xdr",
            "setclientid->sc_verifier"
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "995-998",
          "snippet": "static void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SETCLIENTID",
            "decode_setclientid_maxsz",
            "hdr"
          ],
          "line": 1667
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setclientid_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t2 /* clientid */\n\nstatic void encode_setclientid(struct xdr_stream *xdr, const struct nfs4_setclientid *setclientid, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_SETCLIENTID, decode_setclientid_maxsz, hdr);\n\tencode_nfs4_verifier(xdr, setclientid->sc_verifier);\n\n\tencode_string(xdr, setclientid->sc_name_len, setclientid->sc_name);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(setclientid->sc_prog);\n\tencode_string(xdr, setclientid->sc_netid_len, setclientid->sc_netid);\n\tencode_string(xdr, setclientid->sc_uaddr_len, setclientid->sc_uaddr);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(setclientid->sc_cb_ident);\n}"
  },
  {
    "function_name": "encode_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1656-1661",
    "snippet": "static void encode_setattr(struct xdr_stream *xdr, const struct nfs_setattrargs *arg, const struct nfs_server *server, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setattr_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_attrs(xdr, arg->iap, arg->label, server);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_setattr_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t nfs4_fattr_bitmap_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_attrs",
          "args": [
            "xdr",
            "arg->iap",
            "arg->label",
            "server"
          ],
          "line": 1660
        },
        "resolved": true,
        "details": {
          "function_name": "encode_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1000-1119",
          "snippet": "static void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&arg->stateid"
          ],
          "line": 1659
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SETATTR",
            "decode_setattr_maxsz",
            "hdr"
          ],
          "line": 1658
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setattr_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t nfs4_fattr_bitmap_maxsz)\n\nstatic void encode_setattr(struct xdr_stream *xdr, const struct nfs_setattrargs *arg, const struct nfs_server *server, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setattr_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_attrs(xdr, arg->iap, arg->label, server);\n}"
  },
  {
    "function_name": "encode_savefh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1650-1654",
    "snippet": "static void\nencode_savefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SAVEFH, decode_savefh_maxsz, hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_savefh_maxsz     (op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SAVEFH",
            "decode_savefh_maxsz",
            "hdr"
          ],
          "line": 1653
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_savefh_maxsz     (op_decode_hdr_maxsz)\n\nstatic void\nencode_savefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_SAVEFH, decode_savefh_maxsz, hdr);\n}"
  },
  {
    "function_name": "encode_setacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1635-1648",
    "snippet": "static void\nencode_setacl(struct xdr_stream *xdr, struct nfs_setaclargs *arg, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setacl_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &zero_stateid);\n\tp = reserve_space(xdr, 2*4);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(FATTR4_WORD0_ACL);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(arg->acl_len);\n\txdr_write_pages(xdr, arg->acl_pages, arg->acl_pgbase, arg->acl_len);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_setacl_maxsz\t(decode_setattr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_write_pages",
          "args": [
            "xdr",
            "arg->acl_pages",
            "arg->acl_pgbase",
            "arg->acl_len"
          ],
          "line": 1647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "arg->acl_len"
          ],
          "line": 1646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "FATTR4_WORD0_ACL"
          ],
          "line": 1644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&zero_stateid"
          ],
          "line": 1641
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_SETATTR",
            "decode_setacl_maxsz",
            "hdr"
          ],
          "line": 1640
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_setacl_maxsz\t(decode_setattr_maxsz)\n\nstatic void\nencode_setacl(struct xdr_stream *xdr, struct nfs_setaclargs *arg, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_SETATTR, decode_setacl_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &zero_stateid);\n\tp = reserve_space(xdr, 2*4);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(FATTR4_WORD0_ACL);\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(arg->acl_len);\n\txdr_write_pages(xdr, arg->acl_pages, arg->acl_pgbase, arg->acl_len);\n}"
  },
  {
    "function_name": "encode_restorefh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1629-1633",
    "snippet": "static void\nencode_restorefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RESTOREFH, decode_restorefh_maxsz, hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_restorefh_maxsz  (op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_RESTOREFH",
            "decode_restorefh_maxsz",
            "hdr"
          ],
          "line": 1632
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_restorefh_maxsz  (op_decode_hdr_maxsz)\n\nstatic void\nencode_restorefh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RESTOREFH, decode_restorefh_maxsz, hdr);\n}"
  },
  {
    "function_name": "encode_renew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1622-1627",
    "snippet": "static void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_renew_maxsz\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint64",
          "args": [
            "xdr",
            "clid"
          ],
          "line": 1626
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "938-944",
          "snippet": "static void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_RENEW",
            "decode_renew_maxsz",
            "hdr"
          ],
          "line": 1625
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_renew_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_renew(struct xdr_stream *xdr, clientid4 clid,\n\t\t\t struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENEW, decode_renew_maxsz, hdr);\n\tencode_uint64(xdr, clid);\n}"
  },
  {
    "function_name": "encode_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1615-1620",
    "snippet": "static void encode_rename(struct xdr_stream *xdr, const struct qstr *oldname, const struct qstr *newname, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENAME, decode_rename_maxsz, hdr);\n\tencode_string(xdr, oldname->len, oldname->name);\n\tencode_string(xdr, newname->len, newname->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_rename_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "newname->len",
            "newname->name"
          ],
          "line": 1619
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_RENAME",
            "decode_rename_maxsz",
            "hdr"
          ],
          "line": 1617
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_rename_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)\n\nstatic void encode_rename(struct xdr_stream *xdr, const struct qstr *oldname, const struct qstr *newname, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RENAME, decode_rename_maxsz, hdr);\n\tencode_string(xdr, oldname->len, oldname->name);\n\tencode_string(xdr, newname->len, newname->name);\n}"
  },
  {
    "function_name": "encode_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1609-1613",
    "snippet": "static void encode_remove(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_REMOVE, decode_remove_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_remove_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "name->len",
            "name->name"
          ],
          "line": 1612
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_REMOVE",
            "decode_remove_maxsz",
            "hdr"
          ],
          "line": 1611
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_remove_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_change_info_maxsz)\n\nstatic void encode_remove(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_REMOVE, decode_remove_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
  },
  {
    "function_name": "encode_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1604-1607",
    "snippet": "static void encode_readlink(struct xdr_stream *xdr, const struct nfs4_readlink *readlink, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_READLINK, decode_readlink_maxsz, hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_readlink_maxsz\t(op_decode_hdr_maxsz + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_READLINK",
            "decode_readlink_maxsz",
            "hdr"
          ],
          "line": 1606
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_readlink_maxsz\t(op_decode_hdr_maxsz + 1)\n\nstatic void encode_readlink(struct xdr_stream *xdr, const struct nfs4_readlink *readlink, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_READLINK, decode_readlink_maxsz, hdr);\n}"
  },
  {
    "function_name": "encode_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1554-1602",
    "snippet": "static void encode_readdir(struct xdr_stream *xdr, const struct nfs4_readdir_arg *readdir, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tuint32_t attrs[3] = {\n\t\tFATTR4_WORD0_RDATTR_ERROR,\n\t\tFATTR4_WORD1_MOUNTED_ON_FILEID,\n\t};\n\tuint32_t dircount = readdir->count >> 1;\n\t__be32 *p, verf[2];\n\tuint32_t attrlen = 0;\n\tunsigned int i;\n\n\tif (readdir->plus) {\n\t\tattrs[0] |= FATTR4_WORD0_TYPE|FATTR4_WORD0_CHANGE|FATTR4_WORD0_SIZE|\n\t\t\tFATTR4_WORD0_FSID|FATTR4_WORD0_FILEHANDLE|FATTR4_WORD0_FILEID;\n\t\tattrs[1] |= FATTR4_WORD1_MODE|FATTR4_WORD1_NUMLINKS|FATTR4_WORD1_OWNER|\n\t\t\tFATTR4_WORD1_OWNER_GROUP|FATTR4_WORD1_RAWDEV|\n\t\t\tFATTR4_WORD1_SPACE_USED|FATTR4_WORD1_TIME_ACCESS|\n\t\t\tFATTR4_WORD1_TIME_METADATA|FATTR4_WORD1_TIME_MODIFY;\n\t\tattrs[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t\tdircount >>= 1;\n\t}\n\t/* Use mounted_on_fileid only if the server supports it */\n\tif (!(readdir->bitmask[1] & FATTR4_WORD1_MOUNTED_ON_FILEID))\n\t\tattrs[0] |= FATTR4_WORD0_FILEID;\n\tfor (i = 0; i < ARRAY_SIZE(attrs); i++) {\n\t\tattrs[i] &= readdir->bitmask[i];\n\t\tif (attrs[i] != 0)\n\t\t\tattrlen = i+1;\n\t}\n\n\tencode_op_hdr(xdr, OP_READDIR, decode_readdir_maxsz, hdr);\n\tencode_uint64(xdr, readdir->cookie);\n\tencode_nfs4_verifier(xdr, &readdir->verifier);\n\tp = reserve_space(xdr, 12 + (attrlen << 2));\n\t*p++ = cpu_to_be32(dircount);\n\t*p++ = cpu_to_be32(readdir->count);\n\t*p++ = cpu_to_be32(attrlen);\n\tfor (i = 0; i < attrlen; i++)\n\t\t*p++ = cpu_to_be32(attrs[i]);\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\n\tdprintk(\"%s: cookie = %llu, verifier = %08x:%08x, bitmap = %08x:%08x:%08x\\n\",\n\t\t\t__func__,\n\t\t\t(unsigned long long)readdir->cookie,\n\t\t\tverf[0], verf[1],\n\t\t\tattrs[0] & readdir->bitmask[0],\n\t\t\tattrs[1] & readdir->bitmask[1],\n\t\t\tattrs[2] & readdir->bitmask[2]);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_readdir_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: cookie = %llu, verifier = %08x:%08x, bitmap = %08x:%08x:%08x\\n\"",
            "__func__",
            "(unsigned long long)readdir->cookie",
            "verf[0]",
            "verf[1]",
            "attrs[0] & readdir->bitmask[0]",
            "attrs[1] & readdir->bitmask[1]",
            "attrs[2] & readdir->bitmask[2]"
          ],
          "line": 1595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "verf",
            "readdir->verifier.data",
            "sizeof(verf)"
          ],
          "line": 1593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "attrs[i]"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "attrlen"
          ],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "readdir->count"
          ],
          "line": 1589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dircount"
          ],
          "line": 1588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "12 + (attrlen << 2)"
          ],
          "line": 1587
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_verifier",
          "args": [
            "xdr",
            "&readdir->verifier"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "995-998",
          "snippet": "static void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_uint64",
          "args": [
            "xdr",
            "readdir->cookie"
          ],
          "line": 1585
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "938-944",
          "snippet": "static void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_READDIR",
            "decode_readdir_maxsz",
            "hdr"
          ],
          "line": 1584
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "attrs"
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_readdir_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)\n\nstatic void encode_readdir(struct xdr_stream *xdr, const struct nfs4_readdir_arg *readdir, struct rpc_rqst *req, struct compound_hdr *hdr)\n{\n\tuint32_t attrs[3] = {\n\t\tFATTR4_WORD0_RDATTR_ERROR,\n\t\tFATTR4_WORD1_MOUNTED_ON_FILEID,\n\t};\n\tuint32_t dircount = readdir->count >> 1;\n\t__be32 *p, verf[2];\n\tuint32_t attrlen = 0;\n\tunsigned int i;\n\n\tif (readdir->plus) {\n\t\tattrs[0] |= FATTR4_WORD0_TYPE|FATTR4_WORD0_CHANGE|FATTR4_WORD0_SIZE|\n\t\t\tFATTR4_WORD0_FSID|FATTR4_WORD0_FILEHANDLE|FATTR4_WORD0_FILEID;\n\t\tattrs[1] |= FATTR4_WORD1_MODE|FATTR4_WORD1_NUMLINKS|FATTR4_WORD1_OWNER|\n\t\t\tFATTR4_WORD1_OWNER_GROUP|FATTR4_WORD1_RAWDEV|\n\t\t\tFATTR4_WORD1_SPACE_USED|FATTR4_WORD1_TIME_ACCESS|\n\t\t\tFATTR4_WORD1_TIME_METADATA|FATTR4_WORD1_TIME_MODIFY;\n\t\tattrs[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t\tdircount >>= 1;\n\t}\n\t/* Use mounted_on_fileid only if the server supports it */\n\tif (!(readdir->bitmask[1] & FATTR4_WORD1_MOUNTED_ON_FILEID))\n\t\tattrs[0] |= FATTR4_WORD0_FILEID;\n\tfor (i = 0; i < ARRAY_SIZE(attrs); i++) {\n\t\tattrs[i] &= readdir->bitmask[i];\n\t\tif (attrs[i] != 0)\n\t\t\tattrlen = i+1;\n\t}\n\n\tencode_op_hdr(xdr, OP_READDIR, decode_readdir_maxsz, hdr);\n\tencode_uint64(xdr, readdir->cookie);\n\tencode_nfs4_verifier(xdr, &readdir->verifier);\n\tp = reserve_space(xdr, 12 + (attrlen << 2));\n\t*p++ = cpu_to_be32(dircount);\n\t*p++ = cpu_to_be32(readdir->count);\n\t*p++ = cpu_to_be32(attrlen);\n\tfor (i = 0; i < attrlen; i++)\n\t\t*p++ = cpu_to_be32(attrs[i]);\n\tmemcpy(verf, readdir->verifier.data, sizeof(verf));\n\n\tdprintk(\"%s: cookie = %llu, verifier = %08x:%08x, bitmap = %08x:%08x:%08x\\n\",\n\t\t\t__func__,\n\t\t\t(unsigned long long)readdir->cookie,\n\t\t\tverf[0], verf[1],\n\t\t\tattrs[0] & readdir->bitmask[0],\n\t\t\tattrs[1] & readdir->bitmask[1],\n\t\t\tattrs[2] & readdir->bitmask[2]);\n}"
  },
  {
    "function_name": "encode_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1541-1552",
    "snippet": "static void encode_read(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_READ, decode_read_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_read_maxsz\t(op_decode_hdr_maxsz + 2)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->count"
          ],
          "line": 1551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->offset"
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "12"
          ],
          "line": 1549
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_READ",
            "decode_read_maxsz",
            "hdr"
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_read_maxsz\t(op_decode_hdr_maxsz + 2)\n\nstatic void encode_read(struct xdr_stream *xdr, const struct nfs_pgio_args *args,\n\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_READ, decode_read_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}"
  },
  {
    "function_name": "encode_putrootfh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1536-1539",
    "snippet": "static void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_PUTROOTFH",
            "decode_putrootfh_maxsz",
            "hdr"
          ],
          "line": 1538
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putrootfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_putrootfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTROOTFH, decode_putrootfh_maxsz, hdr);\n}"
  },
  {
    "function_name": "encode_putfh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1529-1534",
    "snippet": "static void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "fh->size",
            "fh->data"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_PUTFH",
            "decode_putfh_maxsz",
            "hdr"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_putfh_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void\nencode_putfh(struct xdr_stream *xdr, const struct nfs_fh *fh, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_PUTFH, decode_putfh_maxsz, hdr);\n\tencode_string(xdr, fh->size, fh->data);\n}"
  },
  {
    "function_name": "encode_open_downgrade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1521-1527",
    "snippet": "static void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_share_access",
          "args": [
            "xdr",
            "arg->share_access"
          ],
          "line": 1526
        },
        "resolved": true,
        "details": {
          "function_name": "encode_share_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1354-1361",
          "snippet": "static void encode_share_access(struct xdr_stream *xdr, u32 share_access)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(share_access);\n\t*p = cpu_to_be32(0);\t\t/* for linux, share_deny = 0 always */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_share_access(struct xdr_stream *xdr, u32 share_access)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(share_access);\n\t*p = cpu_to_be32(0);\t\t/* for linux, share_deny = 0 always */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_seqid",
          "args": [
            "xdr",
            "arg->seqid"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "946-953",
          "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&arg->stateid"
          ],
          "line": 1524
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_OPEN_DOWNGRADE",
            "decode_open_downgrade_maxsz",
            "hdr"
          ],
          "line": 1523
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_downgrade_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_open_downgrade(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_DOWNGRADE, decode_open_downgrade_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n}"
  },
  {
    "function_name": "encode_open_confirm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1514-1519",
    "snippet": "static void encode_open_confirm(struct xdr_stream *xdr, const struct nfs_open_confirmargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_CONFIRM, decode_open_confirm_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_open_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_seqid",
          "args": [
            "xdr",
            "arg->seqid"
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "946-953",
          "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "arg->stateid"
          ],
          "line": 1517
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_OPEN_CONFIRM",
            "decode_open_confirm_maxsz",
            "hdr"
          ],
          "line": 1516
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_confirm_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_open_confirm(struct xdr_stream *xdr, const struct nfs_open_confirmargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN_CONFIRM, decode_open_confirm_maxsz, hdr);\n\tencode_nfs4_stateid(xdr, arg->stateid);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n}"
  },
  {
    "function_name": "encode_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1488-1512",
    "snippet": "static void encode_open(struct xdr_stream *xdr, const struct nfs_openargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN, decode_open_maxsz, hdr);\n\tencode_openhdr(xdr, arg);\n\tencode_opentype(xdr, arg);\n\tswitch (arg->claim) {\n\tcase NFS4_OPEN_CLAIM_NULL:\n\t\tencode_claim_null(xdr, arg->name);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_PREVIOUS:\n\t\tencode_claim_previous(xdr, arg->u.delegation_type);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_DELEGATE_CUR:\n\t\tencode_claim_delegate_cur(xdr, arg->name, &arg->u.delegation);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_FH:\n\t\tencode_claim_fh(xdr);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_DELEG_CUR_FH:\n\t\tencode_claim_delegate_cur_fh(xdr, &arg->u.delegation);\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_open_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tdecode_stateid_maxsz + \\\n\t\t\t\tdecode_change_info_maxsz + 1 + \\\n\t\t\t\tnfs4_fattr_bitmap_maxsz + \\\n\t\t\t\tdecode_delegation_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_claim_delegate_cur_fh",
          "args": [
            "xdr",
            "&arg->u.delegation"
          ],
          "line": 1507
        },
        "resolved": true,
        "details": {
          "function_name": "encode_claim_delegate_cur_fh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1479-1486",
          "snippet": "static inline void encode_claim_delegate_cur_fh(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEG_CUR_FH);\n\tencode_nfs4_stateid(xdr, stateid);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_delegate_cur_fh(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEG_CUR_FH);\n\tencode_nfs4_stateid(xdr, stateid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_claim_fh",
          "args": [
            "xdr"
          ],
          "line": 1504
        },
        "resolved": true,
        "details": {
          "function_name": "encode_claim_fh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1471-1477",
          "snippet": "static inline void encode_claim_fh(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_FH);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_fh(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_FH);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_claim_delegate_cur",
          "args": [
            "xdr",
            "arg->name",
            "&arg->u.delegation"
          ],
          "line": 1501
        },
        "resolved": true,
        "details": {
          "function_name": "encode_claim_delegate_cur",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1461-1469",
          "snippet": "static inline void encode_claim_delegate_cur(struct xdr_stream *xdr, const struct qstr *name, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEGATE_CUR);\n\tencode_nfs4_stateid(xdr, stateid);\n\tencode_string(xdr, name->len, name->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_delegate_cur(struct xdr_stream *xdr, const struct qstr *name, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEGATE_CUR);\n\tencode_nfs4_stateid(xdr, stateid);\n\tencode_string(xdr, name->len, name->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_claim_previous",
          "args": [
            "xdr",
            "arg->u.delegation_type"
          ],
          "line": 1498
        },
        "resolved": true,
        "details": {
          "function_name": "encode_claim_previous",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1452-1459",
          "snippet": "static inline void encode_claim_previous(struct xdr_stream *xdr, fmode_t type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_PREVIOUS);\n\tencode_delegation_type(xdr, type);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_previous(struct xdr_stream *xdr, fmode_t type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_PREVIOUS);\n\tencode_delegation_type(xdr, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_claim_null",
          "args": [
            "xdr",
            "arg->name"
          ],
          "line": 1495
        },
        "resolved": true,
        "details": {
          "function_name": "encode_claim_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1443-1450",
          "snippet": "static inline void encode_claim_null(struct xdr_stream *xdr, const struct qstr *name)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_NULL);\n\tencode_string(xdr, name->len, name->name);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_null(struct xdr_stream *xdr, const struct qstr *name)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_NULL);\n\tencode_string(xdr, name->len, name->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_opentype",
          "args": [
            "xdr",
            "arg"
          ],
          "line": 1492
        },
        "resolved": true,
        "details": {
          "function_name": "encode_opentype",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1408-1421",
          "snippet": "static void encode_opentype(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (arg->open_flags & O_CREAT) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_NOCREATE);\n\t\tbreak;\n\tdefault:\n\t\t*p = cpu_to_be32(NFS4_OPEN_CREATE);\n\t\tencode_createmode(xdr, arg);\n\t}\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opentype(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (arg->open_flags & O_CREAT) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_NOCREATE);\n\t\tbreak;\n\tdefault:\n\t\t*p = cpu_to_be32(NFS4_OPEN_CREATE);\n\t\tencode_createmode(xdr, arg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_openhdr",
          "args": [
            "xdr",
            "arg"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "encode_openhdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1363-1379",
          "snippet": "static inline void encode_openhdr(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n /*\n * opcode 4, seqid 4, share_access 4, share_deny 4, clientid 8, ownerlen 4,\n * owner 4 = 32\n */\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n\tp = reserve_space(xdr, 36);\n\tp = xdr_encode_hyper(p, arg->clientid);\n\t*p++ = cpu_to_be32(24);\n\tp = xdr_encode_opaque_fixed(p, \"open id:\", 8);\n\t*p++ = cpu_to_be32(arg->server->s_dev);\n\t*p++ = cpu_to_be32(arg->id.uniquifier);\n\txdr_encode_hyper(p, arg->id.create_time);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_openhdr(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n /*\n * opcode 4, seqid 4, share_access 4, share_deny 4, clientid 8, ownerlen 4,\n * owner 4 = 32\n */\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n\tp = reserve_space(xdr, 36);\n\tp = xdr_encode_hyper(p, arg->clientid);\n\t*p++ = cpu_to_be32(24);\n\tp = xdr_encode_opaque_fixed(p, \"open id:\", 8);\n\t*p++ = cpu_to_be32(arg->server->s_dev);\n\t*p++ = cpu_to_be32(arg->id.uniquifier);\n\txdr_encode_hyper(p, arg->id.create_time);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_OPEN",
            "decode_open_maxsz",
            "hdr"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_open_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tdecode_stateid_maxsz + \\\n\t\t\t\tdecode_change_info_maxsz + 1 + \\\n\t\t\t\tnfs4_fattr_bitmap_maxsz + \\\n\t\t\t\tdecode_delegation_maxsz)\n\nstatic void encode_open(struct xdr_stream *xdr, const struct nfs_openargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_OPEN, decode_open_maxsz, hdr);\n\tencode_openhdr(xdr, arg);\n\tencode_opentype(xdr, arg);\n\tswitch (arg->claim) {\n\tcase NFS4_OPEN_CLAIM_NULL:\n\t\tencode_claim_null(xdr, arg->name);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_PREVIOUS:\n\t\tencode_claim_previous(xdr, arg->u.delegation_type);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_DELEGATE_CUR:\n\t\tencode_claim_delegate_cur(xdr, arg->name, &arg->u.delegation);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_FH:\n\t\tencode_claim_fh(xdr);\n\t\tbreak;\n\tcase NFS4_OPEN_CLAIM_DELEG_CUR_FH:\n\t\tencode_claim_delegate_cur_fh(xdr, &arg->u.delegation);\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "encode_claim_delegate_cur_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1479-1486",
    "snippet": "static inline void encode_claim_delegate_cur_fh(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEG_CUR_FH);\n\tencode_nfs4_stateid(xdr, stateid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "stateid"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_CLAIM_DELEG_CUR_FH"
          ],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1483
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_delegate_cur_fh(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEG_CUR_FH);\n\tencode_nfs4_stateid(xdr, stateid);\n}"
  },
  {
    "function_name": "encode_claim_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1471-1477",
    "snippet": "static inline void encode_claim_fh(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_FH);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_CLAIM_FH"
          ],
          "line": 1476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_fh(struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_FH);\n}"
  },
  {
    "function_name": "encode_claim_delegate_cur",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1461-1469",
    "snippet": "static inline void encode_claim_delegate_cur(struct xdr_stream *xdr, const struct qstr *name, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEGATE_CUR);\n\tencode_nfs4_stateid(xdr, stateid);\n\tencode_string(xdr, name->len, name->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "name->len",
            "name->name"
          ],
          "line": 1468
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "stateid"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_CLAIM_DELEGATE_CUR"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1465
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_delegate_cur(struct xdr_stream *xdr, const struct qstr *name, const nfs4_stateid *stateid)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_DELEGATE_CUR);\n\tencode_nfs4_stateid(xdr, stateid);\n\tencode_string(xdr, name->len, name->name);\n}"
  },
  {
    "function_name": "encode_claim_previous",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1452-1459",
    "snippet": "static inline void encode_claim_previous(struct xdr_stream *xdr, fmode_t type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_PREVIOUS);\n\tencode_delegation_type(xdr, type);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_delegation_type",
          "args": [
            "xdr",
            "type"
          ],
          "line": 1458
        },
        "resolved": true,
        "details": {
          "function_name": "encode_delegation_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1423-1441",
          "snippet": "static inline void encode_delegation_type(struct xdr_stream *xdr, fmode_t delegation_type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (delegation_type) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_NONE);\n\t\tbreak;\n\tcase FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_READ);\n\t\tbreak;\n\tcase FMODE_WRITE|FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_WRITE);\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_delegation_type(struct xdr_stream *xdr, fmode_t delegation_type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (delegation_type) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_NONE);\n\t\tbreak;\n\tcase FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_READ);\n\t\tbreak;\n\tcase FMODE_WRITE|FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_WRITE);\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_CLAIM_PREVIOUS"
          ],
          "line": 1457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_previous(struct xdr_stream *xdr, fmode_t type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_PREVIOUS);\n\tencode_delegation_type(xdr, type);\n}"
  },
  {
    "function_name": "encode_claim_null",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1443-1450",
    "snippet": "static inline void encode_claim_null(struct xdr_stream *xdr, const struct qstr *name)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_NULL);\n\tencode_string(xdr, name->len, name->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "name->len",
            "name->name"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_CLAIM_NULL"
          ],
          "line": 1448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1447
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_claim_null(struct xdr_stream *xdr, const struct qstr *name)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(NFS4_OPEN_CLAIM_NULL);\n\tencode_string(xdr, name->len, name->name);\n}"
  },
  {
    "function_name": "encode_delegation_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1423-1441",
    "snippet": "static inline void encode_delegation_type(struct xdr_stream *xdr, fmode_t delegation_type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (delegation_type) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_NONE);\n\t\tbreak;\n\tcase FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_READ);\n\t\tbreak;\n\tcase FMODE_WRITE|FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_WRITE);\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_DELEGATE_WRITE"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_DELEGATE_READ"
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_DELEGATE_NONE"
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1427
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_delegation_type(struct xdr_stream *xdr, fmode_t delegation_type)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (delegation_type) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_NONE);\n\t\tbreak;\n\tcase FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_READ);\n\t\tbreak;\n\tcase FMODE_WRITE|FMODE_READ:\n\t\t*p = cpu_to_be32(NFS4_OPEN_DELEGATE_WRITE);\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "encode_opentype",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1408-1421",
    "snippet": "static void encode_opentype(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (arg->open_flags & O_CREAT) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_NOCREATE);\n\t\tbreak;\n\tdefault:\n\t\t*p = cpu_to_be32(NFS4_OPEN_CREATE);\n\t\tencode_createmode(xdr, arg);\n\t}\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_createmode",
          "args": [
            "xdr",
            "arg"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "encode_createmode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1381-1406",
          "snippet": "static inline void encode_createmode(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\tstruct iattr dummy;\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch(arg->createmode) {\n\tcase NFS4_CREATE_UNCHECKED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_UNCHECKED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_GUARDED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_GUARDED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE4_1:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE4_1);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tdummy.ia_valid = 0;\n\t\tencode_attrs(xdr, &dummy, arg->label, arg->server);\n\t}\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_createmode(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\tstruct iattr dummy;\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch(arg->createmode) {\n\tcase NFS4_CREATE_UNCHECKED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_UNCHECKED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_GUARDED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_GUARDED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE4_1:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE4_1);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tdummy.ia_valid = 0;\n\t\tencode_attrs(xdr, &dummy, arg->label, arg->server);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_CREATE"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_OPEN_NOCREATE"
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opentype(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch (arg->open_flags & O_CREAT) {\n\tcase 0:\n\t\t*p = cpu_to_be32(NFS4_OPEN_NOCREATE);\n\t\tbreak;\n\tdefault:\n\t\t*p = cpu_to_be32(NFS4_OPEN_CREATE);\n\t\tencode_createmode(xdr, arg);\n\t}\n}"
  },
  {
    "function_name": "encode_createmode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1381-1406",
    "snippet": "static inline void encode_createmode(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\tstruct iattr dummy;\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch(arg->createmode) {\n\tcase NFS4_CREATE_UNCHECKED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_UNCHECKED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_GUARDED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_GUARDED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE4_1:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE4_1);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tdummy.ia_valid = 0;\n\t\tencode_attrs(xdr, &dummy, arg->label, arg->server);\n\t}\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_attrs",
          "args": [
            "xdr",
            "&dummy",
            "arg->label",
            "arg->server"
          ],
          "line": 1404
        },
        "resolved": true,
        "details": {
          "function_name": "encode_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1000-1119",
          "snippet": "static void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_verifier",
          "args": [
            "xdr",
            "&arg->u.verifier"
          ],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_verifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "995-998",
          "snippet": "static void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_CREATE_EXCLUSIVE4_1"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_CREATE_EXCLUSIVE"
          ],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_CREATE_GUARDED"
          ],
          "line": 1393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_CREATE_UNCHECKED"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 1386
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_createmode(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\tstruct iattr dummy;\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\tswitch(arg->createmode) {\n\tcase NFS4_CREATE_UNCHECKED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_UNCHECKED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_GUARDED:\n\t\t*p = cpu_to_be32(NFS4_CREATE_GUARDED);\n\t\tencode_attrs(xdr, arg->u.attrs, arg->label, arg->server);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tbreak;\n\tcase NFS4_CREATE_EXCLUSIVE4_1:\n\t\t*p = cpu_to_be32(NFS4_CREATE_EXCLUSIVE4_1);\n\t\tencode_nfs4_verifier(xdr, &arg->u.verifier);\n\t\tdummy.ia_valid = 0;\n\t\tencode_attrs(xdr, &dummy, arg->label, arg->server);\n\t}\n}"
  },
  {
    "function_name": "encode_openhdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1363-1379",
    "snippet": "static inline void encode_openhdr(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n /*\n * opcode 4, seqid 4, share_access 4, share_deny 4, clientid 8, ownerlen 4,\n * owner 4 = 32\n */\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n\tp = reserve_space(xdr, 36);\n\tp = xdr_encode_hyper(p, arg->clientid);\n\t*p++ = cpu_to_be32(24);\n\tp = xdr_encode_opaque_fixed(p, \"open id:\", 8);\n\t*p++ = cpu_to_be32(arg->server->s_dev);\n\t*p++ = cpu_to_be32(arg->id.uniquifier);\n\txdr_encode_hyper(p, arg->id.create_time);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "arg->id.create_time"
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "arg->id.uniquifier"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "arg->server->s_dev"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "\"open id:\"",
            "8"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "24"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "arg->clientid"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "36"
          ],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_share_access",
          "args": [
            "xdr",
            "arg->share_access"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "encode_share_access",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1354-1361",
          "snippet": "static void encode_share_access(struct xdr_stream *xdr, u32 share_access)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(share_access);\n\t*p = cpu_to_be32(0);\t\t/* for linux, share_deny = 0 always */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_share_access(struct xdr_stream *xdr, u32 share_access)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(share_access);\n\t*p = cpu_to_be32(0);\t\t/* for linux, share_deny = 0 always */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_seqid",
          "args": [
            "xdr",
            "arg->seqid"
          ],
          "line": 1370
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "946-953",
          "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline void encode_openhdr(struct xdr_stream *xdr, const struct nfs_openargs *arg)\n{\n\t__be32 *p;\n /*\n * opcode 4, seqid 4, share_access 4, share_deny 4, clientid 8, ownerlen 4,\n * owner 4 = 32\n */\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_share_access(xdr, arg->share_access);\n\tp = reserve_space(xdr, 36);\n\tp = xdr_encode_hyper(p, arg->clientid);\n\t*p++ = cpu_to_be32(24);\n\tp = xdr_encode_opaque_fixed(p, \"open id:\", 8);\n\t*p++ = cpu_to_be32(arg->server->s_dev);\n\t*p++ = cpu_to_be32(arg->id.uniquifier);\n\txdr_encode_hyper(p, arg->id.create_time);\n}"
  },
  {
    "function_name": "encode_share_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1354-1361",
    "snippet": "static void encode_share_access(struct xdr_stream *xdr, u32 share_access)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(share_access);\n\t*p = cpu_to_be32(0);\t\t/* for linux, share_deny = 0 always */\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 1360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "share_access"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 1358
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_share_access(struct xdr_stream *xdr, u32 share_access)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(share_access);\n\t*p = cpu_to_be32(0);\t\t/* for linux, share_deny = 0 always */\n}"
  },
  {
    "function_name": "encode_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1348-1352",
    "snippet": "static void encode_lookup(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LOOKUP, decode_lookup_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_lookup_maxsz\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "name->len",
            "name->name"
          ],
          "line": 1351
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LOOKUP",
            "decode_lookup_maxsz",
            "hdr"
          ],
          "line": 1350
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_lookup_maxsz\t(op_decode_hdr_maxsz)\n\nstatic void encode_lookup(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LOOKUP, decode_lookup_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
  },
  {
    "function_name": "encode_release_lockowner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1342-1346",
    "snippet": "static void encode_release_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RELEASE_LOCKOWNER, decode_release_lockowner_maxsz, hdr);\n\tencode_lockowner(xdr, lowner);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_release_lockowner_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_lockowner",
          "args": [
            "xdr",
            "lowner"
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "encode_lockowner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1278-1288",
          "snippet": "static void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_RELEASE_LOCKOWNER",
            "decode_release_lockowner_maxsz",
            "hdr"
          ],
          "line": 1344
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_release_lockowner_maxsz \\\n\t\t\t\t(op_decode_hdr_maxsz)\n\nstatic void encode_release_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_RELEASE_LOCKOWNER, decode_release_lockowner_maxsz, hdr);\n\tencode_lockowner(xdr, lowner);\n}"
  },
  {
    "function_name": "encode_locku",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1329-1340",
    "snippet": "static void encode_locku(struct xdr_stream *xdr, const struct nfs_locku_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKU, decode_locku_maxsz, hdr);\n\tencode_uint32(xdr, nfs4_lock_type(args->fl, 0));\n\tencode_nfs4_seqid(xdr, args->seqid);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\txdr_encode_hyper(p, nfs4_lock_length(args->fl));\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_locku_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "nfs4_lock_length(args->fl)"
          ],
          "line": 1339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_lock_length",
          "args": [
            "args->fl"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1271-1276",
          "snippet": "static inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->fl->fl_start"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "16"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->stateid"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_seqid",
          "args": [
            "xdr",
            "args->seqid"
          ],
          "line": 1335
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "946-953",
          "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "nfs4_lock_type(args->fl, 0)"
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_lock_type",
          "args": [
            "args->fl",
            "0"
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1264-1269",
          "snippet": "static inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LOCKU",
            "decode_locku_maxsz",
            "hdr"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_locku_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_locku(struct xdr_stream *xdr, const struct nfs_locku_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKU, decode_locku_maxsz, hdr);\n\tencode_uint32(xdr, nfs4_lock_type(args->fl, 0));\n\tencode_nfs4_seqid(xdr, args->seqid);\n\tencode_nfs4_stateid(xdr, &args->stateid);\n\tp = reserve_space(xdr, 16);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\txdr_encode_hyper(p, nfs4_lock_length(args->fl));\n}"
  },
  {
    "function_name": "encode_lockt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1317-1327",
    "snippet": "static void encode_lockt(struct xdr_stream *xdr, const struct nfs_lockt_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKT, decode_lockt_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(nfs4_lock_type(args->fl, 0));\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\tp = xdr_encode_hyper(p, nfs4_lock_length(args->fl));\n\tencode_lockowner(xdr, &args->lock_owner);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_lockt_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_lock_denied_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_lockowner",
          "args": [
            "xdr",
            "&args->lock_owner"
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "encode_lockowner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1278-1288",
          "snippet": "static void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "nfs4_lock_length(args->fl)"
          ],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_lock_length",
          "args": [
            "args->fl"
          ],
          "line": 1325
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1271-1276",
          "snippet": "static inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->fl->fl_start"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nfs4_lock_type(args->fl, 0)"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_lock_type",
          "args": [
            "args->fl",
            "0"
          ],
          "line": 1323
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1264-1269",
          "snippet": "static inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "20"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LOCKT",
            "decode_lockt_maxsz",
            "hdr"
          ],
          "line": 1321
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_lockt_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_lock_denied_maxsz)\n\nstatic void encode_lockt(struct xdr_stream *xdr, const struct nfs_lockt_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCKT, decode_lockt_maxsz, hdr);\n\tp = reserve_space(xdr, 20);\n\t*p++ = cpu_to_be32(nfs4_lock_type(args->fl, 0));\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\tp = xdr_encode_hyper(p, nfs4_lock_length(args->fl));\n\tencode_lockowner(xdr, &args->lock_owner);\n}"
  },
  {
    "function_name": "encode_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1294-1315",
    "snippet": "static void encode_lock(struct xdr_stream *xdr, const struct nfs_lock_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCK, decode_lock_maxsz, hdr);\n\tp = reserve_space(xdr, 28);\n\t*p++ = cpu_to_be32(nfs4_lock_type(args->fl, args->block));\n\t*p++ = cpu_to_be32(args->reclaim);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\tp = xdr_encode_hyper(p, nfs4_lock_length(args->fl));\n\t*p = cpu_to_be32(args->new_lock_owner);\n\tif (args->new_lock_owner){\n\t\tencode_nfs4_seqid(xdr, args->open_seqid);\n\t\tencode_nfs4_stateid(xdr, &args->open_stateid);\n\t\tencode_nfs4_seqid(xdr, args->lock_seqid);\n\t\tencode_lockowner(xdr, &args->lock_owner);\n\t}\n\telse {\n\t\tencode_nfs4_stateid(xdr, &args->lock_stateid);\n\t\tencode_nfs4_seqid(xdr, args->lock_seqid);\n\t}\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_lock_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_lock_denied_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_seqid",
          "args": [
            "xdr",
            "args->lock_seqid"
          ],
          "line": 1313
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "946-953",
          "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&args->lock_stateid"
          ],
          "line": 1312
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_lockowner",
          "args": [
            "xdr",
            "&args->lock_owner"
          ],
          "line": 1309
        },
        "resolved": true,
        "details": {
          "function_name": "encode_lockowner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1278-1288",
          "snippet": "static void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->new_lock_owner"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "nfs4_lock_length(args->fl)"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_lock_length",
          "args": [
            "args->fl"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1271-1276",
          "snippet": "static inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->fl->fl_start"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->reclaim"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nfs4_lock_type(args->fl, args->block)"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_lock_type",
          "args": [
            "args->fl",
            "args->block"
          ],
          "line": 1300
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1264-1269",
          "snippet": "static inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "28"
          ],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LOCK",
            "decode_lock_maxsz",
            "hdr"
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_lock_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_lock_denied_maxsz)\n\nstatic void encode_lock(struct xdr_stream *xdr, const struct nfs_lock_args *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_LOCK, decode_lock_maxsz, hdr);\n\tp = reserve_space(xdr, 28);\n\t*p++ = cpu_to_be32(nfs4_lock_type(args->fl, args->block));\n\t*p++ = cpu_to_be32(args->reclaim);\n\tp = xdr_encode_hyper(p, args->fl->fl_start);\n\tp = xdr_encode_hyper(p, nfs4_lock_length(args->fl));\n\t*p = cpu_to_be32(args->new_lock_owner);\n\tif (args->new_lock_owner){\n\t\tencode_nfs4_seqid(xdr, args->open_seqid);\n\t\tencode_nfs4_stateid(xdr, &args->open_stateid);\n\t\tencode_nfs4_seqid(xdr, args->lock_seqid);\n\t\tencode_lockowner(xdr, &args->lock_owner);\n\t}\n\telse {\n\t\tencode_nfs4_stateid(xdr, &args->lock_stateid);\n\t\tencode_nfs4_seqid(xdr, args->lock_seqid);\n\t}\n}"
  },
  {
    "function_name": "encode_lockowner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1278-1288",
    "snippet": "static void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "lowner->id"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "lowner->s_dev"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "\"lock id:\"",
            "8"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "20"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "lowner->clientid"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "32"
          ],
          "line": 1282
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_lockowner(struct xdr_stream *xdr, const struct nfs_lowner *lowner)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 32);\n\tp = xdr_encode_hyper(p, lowner->clientid);\n\t*p++ = cpu_to_be32(20);\n\tp = xdr_encode_opaque_fixed(p, \"lock id:\", 8);\n\t*p++ = cpu_to_be32(lowner->s_dev);\n\txdr_encode_hyper(p, lowner->id);\n}"
  },
  {
    "function_name": "nfs4_lock_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1271-1276",
    "snippet": "static inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline uint64_t nfs4_lock_length(struct file_lock *fl)\n{\n\tif (fl->fl_end == OFFSET_MAX)\n\t\treturn ~(uint64_t)0;\n\treturn fl->fl_end - fl->fl_start + 1;\n}"
  },
  {
    "function_name": "nfs4_lock_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1264-1269",
    "snippet": "static inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic inline int nfs4_lock_type(struct file_lock *fl, int block)\n{\n\tif (fl->fl_type == F_RDLCK)\n\t\treturn block ? NFS4_READW_LT : NFS4_READ_LT;\n\treturn block ? NFS4_WRITEW_LT : NFS4_WRITE_LT;\n}"
  },
  {
    "function_name": "encode_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1258-1262",
    "snippet": "static void encode_link(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LINK, decode_link_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_link_maxsz\t(op_decode_hdr_maxsz + decode_change_info_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "name->len",
            "name->name"
          ],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_LINK",
            "decode_link_maxsz",
            "hdr"
          ],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_link_maxsz\t(op_decode_hdr_maxsz + decode_change_info_maxsz)\n\nstatic void encode_link(struct xdr_stream *xdr, const struct qstr *name, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_LINK, decode_link_maxsz, hdr);\n\tencode_string(xdr, name->len, name->name);\n}"
  },
  {
    "function_name": "encode_getfh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1253-1256",
    "snippet": "static void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_GETFH",
            "decode_getfh_maxsz",
            "hdr"
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getfh_maxsz      (op_decode_hdr_maxsz + 1 + \\\n\t\t\t\t((3+NFS4_FHSIZE) >> 2))\n\nstatic void encode_getfh(struct xdr_stream *xdr, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_GETFH, decode_getfh_maxsz, hdr);\n}"
  },
  {
    "function_name": "encode_fs_locations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1247-1251",
    "snippet": "static void encode_fs_locations(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_two(xdr, bitmask[0] & nfs4_fs_locations_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fs_locations_bitmap[1], hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_getattr_two",
          "args": [
            "xdr",
            "bitmask[0] & nfs4_fs_locations_bitmap[0]",
            "bitmask[1] & nfs4_fs_locations_bitmap[1]",
            "hdr"
          ],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_two",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1182-1191",
          "snippet": "static void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fs_locations(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_two(xdr, bitmask[0] & nfs4_fs_locations_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fs_locations_bitmap[1], hdr);\n}"
  },
  {
    "function_name": "encode_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1238-1245",
    "snippet": "static void encode_fsinfo(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & nfs4_fsinfo_bitmap[0],\n\t\t\t     bitmask[1] & nfs4_fsinfo_bitmap[1],\n\t\t\t     bitmask[2] & nfs4_fsinfo_bitmap[2],\n\t\t\t     hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_getattr_three",
          "args": [
            "xdr",
            "bitmask[0] & nfs4_fsinfo_bitmap[0]",
            "bitmask[1] & nfs4_fsinfo_bitmap[1]",
            "bitmask[2] & nfs4_fsinfo_bitmap[2]",
            "hdr"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_three",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1193-1217",
          "snippet": "static void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fsinfo(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & nfs4_fsinfo_bitmap[0],\n\t\t\t     bitmask[1] & nfs4_fsinfo_bitmap[1],\n\t\t\t     bitmask[2] & nfs4_fsinfo_bitmap[2],\n\t\t\t     hdr);\n}"
  },
  {
    "function_name": "encode_getfattr_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1227-1236",
    "snippet": "static void encode_getfattr_open(struct xdr_stream *xdr, const u32 *bitmask,\n\t\t\t\t const u32 *open_bitmap,\n\t\t\t\t struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & open_bitmap[0],\n\t\t\t     bitmask[1] & open_bitmap[1],\n\t\t\t     bitmask[2] & open_bitmap[2],\n\t\t\t     hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_getattr_three",
          "args": [
            "xdr",
            "bitmask[0] & open_bitmap[0]",
            "bitmask[1] & open_bitmap[1]",
            "bitmask[2] & open_bitmap[2]",
            "hdr"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_three",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1193-1217",
          "snippet": "static void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr_open(struct xdr_stream *xdr, const u32 *bitmask,\n\t\t\t\t const u32 *open_bitmap,\n\t\t\t\t struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr,\n\t\t\t     bitmask[0] & open_bitmap[0],\n\t\t\t     bitmask[1] & open_bitmap[1],\n\t\t\t     bitmask[2] & open_bitmap[2],\n\t\t\t     hdr);\n}"
  },
  {
    "function_name": "encode_getfattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1219-1225",
    "snippet": "static void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_getattr_three",
          "args": [
            "xdr",
            "bitmask[0] & nfs4_fattr_bitmap[0]",
            "bitmask[1] & nfs4_fattr_bitmap[1]",
            "bitmask[2] & nfs4_fattr_bitmap[2]",
            "hdr"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "encode_getattr_three",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1193-1217",
          "snippet": "static void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_getfattr(struct xdr_stream *xdr, const u32* bitmask, struct compound_hdr *hdr)\n{\n\tencode_getattr_three(xdr, bitmask[0] & nfs4_fattr_bitmap[0],\n\t\t\t   bitmask[1] & nfs4_fattr_bitmap[1],\n\t\t\t   bitmask[2] & nfs4_fattr_bitmap[2],\n\t\t\t   hdr);\n}"
  },
  {
    "function_name": "encode_getattr_three",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1193-1217",
    "snippet": "static void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm0"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 1213
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm1"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm0"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "2"
          ],
          "line": 1209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm2"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm1"
          ],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm0"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "3"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR",
            "decode_getattr_maxsz",
            "hdr"
          ],
          "line": 1200
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void\nencode_getattr_three(struct xdr_stream *xdr,\n\t\t     uint32_t bm0, uint32_t bm1, uint32_t bm2,\n\t\t     struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tif (bm2) {\n\t\tp = reserve_space(xdr, 16);\n\t\t*p++ = cpu_to_be32(3);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p++ = cpu_to_be32(bm1);\n\t\t*p = cpu_to_be32(bm2);\n\t} else if (bm1) {\n\t\tp = reserve_space(xdr, 12);\n\t\t*p++ = cpu_to_be32(2);\n\t\t*p++ = cpu_to_be32(bm0);\n\t\t*p = cpu_to_be32(bm1);\n\t} else {\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(1);\n\t\t*p = cpu_to_be32(bm0);\n\t}\n}"
  },
  {
    "function_name": "encode_getattr_two",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1182-1191",
    "snippet": "static void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm1"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bm0"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "2"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "12"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR",
            "decode_getattr_maxsz",
            "hdr"
          ],
          "line": 1186
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_two(struct xdr_stream *xdr, uint32_t bm0, uint32_t bm1, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\t*p++ = cpu_to_be32(2);\n\t*p++ = cpu_to_be32(bm0);\n\t*p = cpu_to_be32(bm1);\n}"
  },
  {
    "function_name": "encode_getattr_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1172-1180",
    "snippet": "static void encode_getattr_one(struct xdr_stream *xdr, uint32_t bitmap, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(bitmap);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bitmap"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_GETATTR",
            "decode_getattr_maxsz",
            "hdr"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_getattr_maxsz    (op_decode_hdr_maxsz + nfs4_fattr_maxsz)\n\nstatic void encode_getattr_one(struct xdr_stream *xdr, uint32_t bitmap, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_GETATTR, decode_getattr_maxsz, hdr);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(1);\n\t*p = cpu_to_be32(bitmap);\n}"
  },
  {
    "function_name": "encode_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1144-1170",
    "snippet": "static void encode_create(struct xdr_stream *xdr, const struct nfs4_create_arg *create, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_CREATE, decode_create_maxsz, hdr);\n\tencode_uint32(xdr, create->ftype);\n\n\tswitch (create->ftype) {\n\tcase NF4LNK:\n\t\tp = reserve_space(xdr, 4);\n\t\t*p = cpu_to_be32(create->u.symlink.len);\n\t\txdr_write_pages(xdr, create->u.symlink.pages, 0, create->u.symlink.len);\n\t\tbreak;\n\n\tcase NF4BLK: case NF4CHR:\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(create->u.device.specdata1);\n\t\t*p = cpu_to_be32(create->u.device.specdata2);\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\tencode_string(xdr, create->name->len, create->name->name);\n\tencode_attrs(xdr, create->attrs, create->label, create->server);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_create_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tdecode_change_info_maxsz + \\\n\t\t\t\tnfs4_fattr_bitmap_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_attrs",
          "args": [
            "xdr",
            "create->attrs",
            "create->label",
            "create->server"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "encode_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "1000-1119",
          "snippet": "static void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "create->name->len",
            "create->name->name"
          ],
          "line": 1168
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "create->u.device.specdata2"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "create->u.device.specdata1"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_write_pages",
          "args": [
            "xdr",
            "create->u.symlink.pages",
            "0",
            "create->u.symlink.len"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "create->u.symlink.len"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "create->ftype"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_CREATE",
            "decode_create_maxsz",
            "hdr"
          ],
          "line": 1148
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_create_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\tdecode_change_info_maxsz + \\\n\t\t\t\tnfs4_fattr_bitmap_maxsz)\n\nstatic void encode_create(struct xdr_stream *xdr, const struct nfs4_create_arg *create, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_CREATE, decode_create_maxsz, hdr);\n\tencode_uint32(xdr, create->ftype);\n\n\tswitch (create->ftype) {\n\tcase NF4LNK:\n\t\tp = reserve_space(xdr, 4);\n\t\t*p = cpu_to_be32(create->u.symlink.len);\n\t\txdr_write_pages(xdr, create->u.symlink.pages, 0, create->u.symlink.len);\n\t\tbreak;\n\n\tcase NF4BLK: case NF4CHR:\n\t\tp = reserve_space(xdr, 8);\n\t\t*p++ = cpu_to_be32(create->u.device.specdata1);\n\t\t*p = cpu_to_be32(create->u.device.specdata2);\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\tencode_string(xdr, create->name->len, create->name->name);\n\tencode_attrs(xdr, create->attrs, create->label, create->server);\n}"
  },
  {
    "function_name": "encode_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1134-1142",
    "snippet": "static void encode_commit(struct xdr_stream *xdr, const struct nfs_commitargs *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_COMMIT, decode_commit_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_commit_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->count"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "args->offset"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "12"
          ],
          "line": 1139
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_COMMIT",
            "decode_commit_maxsz",
            "hdr"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_commit_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_verifier_maxsz)\n\nstatic void encode_commit(struct xdr_stream *xdr, const struct nfs_commitargs *args, struct compound_hdr *hdr)\n{\n\t__be32 *p;\n\n\tencode_op_hdr(xdr, OP_COMMIT, decode_commit_maxsz, hdr);\n\tp = reserve_space(xdr, 12);\n\tp = xdr_encode_hyper(p, args->offset);\n\t*p = cpu_to_be32(args->count);\n}"
  },
  {
    "function_name": "encode_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1127-1132",
    "snippet": "static void encode_close(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_CLOSE, decode_close_maxsz, hdr);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_close_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nfs4_stateid",
          "args": [
            "xdr",
            "&arg->stateid"
          ],
          "line": 1131
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "990-993",
          "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nfs4_seqid",
          "args": [
            "xdr",
            "arg->seqid"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nfs4_seqid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "946-953",
          "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_CLOSE",
            "decode_close_maxsz",
            "hdr"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_close_maxsz\t(op_decode_hdr_maxsz + \\\n\t\t\t\t decode_stateid_maxsz)\n\nstatic void encode_close(struct xdr_stream *xdr, const struct nfs_closeargs *arg, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_CLOSE, decode_close_maxsz, hdr);\n\tencode_nfs4_seqid(xdr, arg->seqid);\n\tencode_nfs4_stateid(xdr, &arg->stateid);\n}"
  },
  {
    "function_name": "encode_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1121-1125",
    "snippet": "static void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "access"
          ],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_op_hdr",
          "args": [
            "xdr",
            "OP_ACCESS",
            "decode_access_maxsz",
            "hdr"
          ],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "encode_op_hdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "975-982",
          "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define decode_access_maxsz\t(op_decode_hdr_maxsz + 2)\n\nstatic void encode_access(struct xdr_stream *xdr, u32 access, struct compound_hdr *hdr)\n{\n\tencode_op_hdr(xdr, OP_ACCESS, decode_access_maxsz, hdr);\n\tencode_uint32(xdr, access);\n}"
  },
  {
    "function_name": "encode_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "1000-1119",
    "snippet": "static void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "label->label",
            "label->len"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "label->len"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "label->pi"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "label->lfs"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_SET_TO_SERVER_TIME"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "iap->ia_mtime.tv_nsec"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "(s64)iap->ia_mtime.tv_sec"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_SET_TO_CLIENT_TIME"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_SET_TO_SERVER_TIME"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "iap->ia_atime.tv_nsec"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "(s64)iap->ia_atime.tv_sec"
          ],
          "line": 1098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS4_SET_TO_CLIENT_TIME"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "owner_group",
            "owner_grouplen"
          ],
          "line": 1094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "owner_name",
            "owner_namelen"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "iap->ia_mode & S_IALLUGO"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "iap->ia_size"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "len"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bmval[i]"
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "bmval_len"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4 + (bmval_len << 2) + 4 + len"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "label->len"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "owner_grouplen"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "owner_group",
            "\"nobody\""
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs: couldn't resolve gid %d to string\\n\"",
            "from_kgid(&init_user_ns, iap->ia_gid)"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "&init_user_ns",
            "iap->ia_gid"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_map_gid_to_group",
          "args": [
            "server",
            "iap->ia_gid",
            "owner_group",
            "IDMAP_NAMESZ"
          ],
          "line": 1043
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_gid_to_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "779-792",
          "snippet": "int nfs_map_gid_to_group(const struct nfs_server *server, kgid_t gid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kgid(&init_user_ns, gid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"group\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_gid_to_group(buf, ret, id, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_gid_to_group(const struct nfs_server *server, kgid_t gid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kgid(&init_user_ns, gid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"group\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_gid_to_group(buf, ret, id, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XDR_QUADLEN",
          "args": [
            "owner_namelen"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "owner_name",
            "\"nobody\""
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs: couldn't resolve uid %d to string\\n\"",
            "from_kuid(&init_user_ns, iap->ia_uid)"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "&init_user_ns",
            "iap->ia_uid"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_map_uid_to_name",
          "args": [
            "server",
            "iap->ia_uid",
            "owner_name",
            "IDMAP_NAMESZ"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_uid_to_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "765-778",
          "snippet": "int nfs_map_uid_to_name(const struct nfs_server *server, kuid_t uid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kuid(&init_user_ns, uid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"user\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_uid_to_name(buf, ret, id, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_uid_to_name(const struct nfs_server *server, kuid_t uid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kuid(&init_user_ns, uid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"user\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_uid_to_name(buf, ret, id, ret);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_attrs(struct xdr_stream *xdr, const struct iattr *iap,\n\t\t\t\tconst struct nfs4_label *label,\n\t\t\t\tconst struct nfs_server *server)\n{\n\tchar owner_name[IDMAP_NAMESZ];\n\tchar owner_group[IDMAP_NAMESZ];\n\tint owner_namelen = 0;\n\tint owner_grouplen = 0;\n\t__be32 *p;\n\tunsigned i;\n\tuint32_t len = 0;\n\tuint32_t bmval_len;\n\tuint32_t bmval[3] = { 0 };\n\n\t/*\n\t * We reserve enough space to write the entire attribute buffer at once.\n\t * In the worst-case, this would be\n\t * 16(bitmap) + 4(attrlen) + 8(size) + 4(mode) + 4(atime) + 4(mtime)\n\t * = 40 bytes, plus any contribution from variable-length fields\n\t *            such as owner/group.\n\t */\n\tif (iap->ia_valid & ATTR_SIZE) {\n\t\tbmval[0] |= FATTR4_WORD0_SIZE;\n\t\tlen += 8;\n\t}\n\tif (iap->ia_valid & ATTR_MODE) {\n\t\tbmval[1] |= FATTR4_WORD1_MODE;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_UID) {\n\t\towner_namelen = nfs_map_uid_to_name(server, iap->ia_uid, owner_name, IDMAP_NAMESZ);\n\t\tif (owner_namelen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve uid %d to string\\n\",\n\t\t\t\t\tfrom_kuid(&init_user_ns, iap->ia_uid));\n\t\t\t/* XXX */\n\t\t\tstrcpy(owner_name, \"nobody\");\n\t\t\towner_namelen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER;\n\t\tlen += 4 + (XDR_QUADLEN(owner_namelen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_GID) {\n\t\towner_grouplen = nfs_map_gid_to_group(server, iap->ia_gid, owner_group, IDMAP_NAMESZ);\n\t\tif (owner_grouplen < 0) {\n\t\t\tdprintk(\"nfs: couldn't resolve gid %d to string\\n\",\n\t\t\t\t\tfrom_kgid(&init_user_ns, iap->ia_gid));\n\t\t\tstrcpy(owner_group, \"nobody\");\n\t\t\towner_grouplen = sizeof(\"nobody\") - 1;\n\t\t\t/* goto out; */\n\t\t}\n\t\tbmval[1] |= FATTR4_WORD1_OWNER_GROUP;\n\t\tlen += 4 + (XDR_QUADLEN(owner_grouplen) << 2);\n\t}\n\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_ATIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_ACCESS_SET;\n\t\tlen += 4;\n\t}\n\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 16;\n\t} else if (iap->ia_valid & ATTR_MTIME) {\n\t\tbmval[1] |= FATTR4_WORD1_TIME_MODIFY_SET;\n\t\tlen += 4;\n\t}\n\tif (label) {\n\t\tlen += 4 + 4 + 4 + (XDR_QUADLEN(label->len) << 2);\n\t\tbmval[2] |= FATTR4_WORD2_SECURITY_LABEL;\n\t}\n\n\tif (bmval[2] != 0)\n\t\tbmval_len = 3;\n\telse if (bmval[1] != 0)\n\t\tbmval_len = 2;\n\telse\n\t\tbmval_len = 1;\n\n\tp = reserve_space(xdr, 4 + (bmval_len << 2) + 4 + len);\n\n\t*p++ = cpu_to_be32(bmval_len);\n\tfor (i = 0; i < bmval_len; i++)\n\t\t*p++ = cpu_to_be32(bmval[i]);\n\t*p++ = cpu_to_be32(len);\n\n\tif (bmval[0] & FATTR4_WORD0_SIZE)\n\t\tp = xdr_encode_hyper(p, iap->ia_size);\n\tif (bmval[1] & FATTR4_WORD1_MODE)\n\t\t*p++ = cpu_to_be32(iap->ia_mode & S_IALLUGO);\n\tif (bmval[1] & FATTR4_WORD1_OWNER)\n\t\tp = xdr_encode_opaque(p, owner_name, owner_namelen);\n\tif (bmval[1] & FATTR4_WORD1_OWNER_GROUP)\n\t\tp = xdr_encode_opaque(p, owner_group, owner_grouplen);\n\tif (bmval[1] & FATTR4_WORD1_TIME_ACCESS_SET) {\n\t\tif (iap->ia_valid & ATTR_ATIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_atime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_atime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[1] & FATTR4_WORD1_TIME_MODIFY_SET) {\n\t\tif (iap->ia_valid & ATTR_MTIME_SET) {\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_CLIENT_TIME);\n\t\t\tp = xdr_encode_hyper(p, (s64)iap->ia_mtime.tv_sec);\n\t\t\t*p++ = cpu_to_be32(iap->ia_mtime.tv_nsec);\n\t\t} else\n\t\t\t*p++ = cpu_to_be32(NFS4_SET_TO_SERVER_TIME);\n\t}\n\tif (bmval[2] & FATTR4_WORD2_SECURITY_LABEL) {\n\t\t*p++ = cpu_to_be32(label->lfs);\n\t\t*p++ = cpu_to_be32(label->pi);\n\t\t*p++ = cpu_to_be32(label->len);\n\t\tp = xdr_encode_opaque_fixed(p, label->label, label->len);\n\t}\n\n/* out: */\n}"
  },
  {
    "function_name": "encode_nfs4_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "995-998",
    "snippet": "static void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_opaque_fixed",
          "args": [
            "xdr",
            "verf->data",
            "NFS4_VERIFIER_SIZE"
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "encode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "914-920",
          "snippet": "static void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_verifier(struct xdr_stream *xdr, const nfs4_verifier *verf)\n{\n\tencode_opaque_fixed(xdr, verf->data, NFS4_VERIFIER_SIZE);\n}"
  },
  {
    "function_name": "encode_nfs4_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "990-993",
    "snippet": "static void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_opaque_fixed",
          "args": [
            "xdr",
            "stateid",
            "NFS4_STATEID_SIZE"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "encode_opaque_fixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "914-920",
          "snippet": "static void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_stateid(struct xdr_stream *xdr, const nfs4_stateid *stateid)\n{\n\tencode_opaque_fixed(xdr, stateid, NFS4_STATEID_SIZE);\n}"
  },
  {
    "function_name": "encode_nops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "984-988",
    "snippet": "static void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "hdr->nops"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "hdr->nops > NFS4_MAX_OPS"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nops(struct compound_hdr *hdr)\n{\n\tWARN_ON_ONCE(hdr->nops > NFS4_MAX_OPS);\n\t*hdr->nops_p = htonl(hdr->nops);\n}"
  },
  {
    "function_name": "encode_op_hdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "975-982",
    "snippet": "static void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "op"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_op_hdr(struct xdr_stream *xdr, enum nfs_opnum4 op,\n\t\tuint32_t replen,\n\t\tstruct compound_hdr *hdr)\n{\n\tencode_uint32(xdr, op);\n\thdr->nops++;\n\thdr->replen += replen;\n}"
  },
  {
    "function_name": "encode_compound_hdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "955-973",
    "snippet": "static void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS4_MAXTAGLEN\t\t0",
      "#define NFS4_MAXTAGLEN\t\t20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "hdr->nops"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "hdr->minorversion"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_string",
          "args": [
            "xdr",
            "hdr->taglen",
            "hdr->tag"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "encode_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "922-928",
          "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "hdr->taglen > NFS4_MAXTAGLEN"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS4_MAXTAGLEN\t\t0\n#define NFS4_MAXTAGLEN\t\t20\n\nstatic void encode_compound_hdr(struct xdr_stream *xdr,\n\t\t\t\tstruct rpc_rqst *req,\n\t\t\t\tstruct compound_hdr *hdr)\n{\n\t__be32 *p;\n\tstruct rpc_auth *auth = req->rq_cred->cr_auth;\n\n\t/* initialize running count of expected bytes in reply.\n\t * NOTE: the replied tag SHOULD be the same is the one sent,\n\t * but this is not required as a MUST for the server to do so. */\n\thdr->replen = RPC_REPHDRSIZE + auth->au_rslack + 3 + hdr->taglen;\n\n\tWARN_ON_ONCE(hdr->taglen > NFS4_MAXTAGLEN);\n\tencode_string(xdr, hdr->taglen, hdr->tag);\n\tp = reserve_space(xdr, 8);\n\t*p++ = cpu_to_be32(hdr->minorversion);\n\thdr->nops_p = p;\n\t*p = cpu_to_be32(hdr->nops);\n}"
  },
  {
    "function_name": "encode_nfs4_seqid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "946-953",
    "snippet": "static void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_uint32",
          "args": [
            "xdr",
            "0"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "encode_uint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "930-936",
          "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_nfs4_seqid(struct xdr_stream *xdr,\n\t\tconst struct nfs_seqid *seqid)\n{\n\tif (seqid != NULL)\n\t\tencode_uint32(xdr, seqid->sequence->counter);\n\telse\n\t\tencode_uint32(xdr, 0);\n}"
  },
  {
    "function_name": "encode_uint64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "938-944",
    "snippet": "static void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "n"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "8"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint64(struct xdr_stream *xdr, u64 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 8);\n\txdr_encode_hyper(p, n);\n}"
  },
  {
    "function_name": "encode_uint32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "930-936",
    "snippet": "static void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "n"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_uint32(struct xdr_stream *xdr, u32 n)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4);\n\t*p = cpu_to_be32(n);\n}"
  },
  {
    "function_name": "encode_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "922-928",
    "snippet": "static void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "str",
            "len"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_space",
          "args": [
            "xdr",
            "4 + len"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
          "lines": "907-912",
          "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
          "includes": [
            "#include \"nfs42xdr.c\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/sunrpc/msg_prot.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/utsname.h>",
            "#include <linux/module.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_string(struct xdr_stream *xdr, unsigned int len, const char *str)\n{\n\t__be32 *p;\n\n\tp = reserve_space(xdr, 4 + len);\n\txdr_encode_opaque(p, str, len);\n}"
  },
  {
    "function_name": "encode_opaque_fixed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "914-920",
    "snippet": "static void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque_fixed",
          "args": [
            "p",
            "buf",
            "len"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "len"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_opaque_fixed(struct xdr_stream *xdr, const void *buf, size_t len)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, len);\n\txdr_encode_opaque_fixed(p, buf, len);\n}"
  },
  {
    "function_name": "reserve_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4xdr.c",
    "lines": "907-912",
    "snippet": "static __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}",
    "includes": [
      "#include \"nfs42xdr.c\"",
      "#include \"netns.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/gss_api.h>",
      "#include <linux/sunrpc/msg_prot.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/utsname.h>",
      "#include <linux/module.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!p"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "nbytes"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs42xdr.c\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/utsname.h>\n#include <linux/module.h>\n#include <linux/kdev_t.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *reserve_space(struct xdr_stream *xdr, size_t nbytes)\n{\n\t__be32 *p = xdr_reserve_space(xdr, nbytes);\n\tBUG_ON(!p);\n\treturn p;\n}"
  }
]