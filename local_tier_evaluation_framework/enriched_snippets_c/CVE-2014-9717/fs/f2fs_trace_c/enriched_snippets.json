[
  {
    "function_name": "f2fs_destroy_trace_ios",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "144-159",
    "snippet": "void f2fs_destroy_trace_ios(void)\n{\n\tpid_t pid[PIDVEC_SIZE];\n\tpid_t next_pid = 0;\n\tunsigned int found;\n\n\tspin_lock(&pids_lock);\n\twhile ((found = gang_lookup_pids(pid, next_pid, PIDVEC_SIZE))) {\n\t\tunsigned idx;\n\n\t\tnext_pid = pid[found - 1] + 1;\n\t\tfor (idx = 0; idx < found; idx++)\n\t\t\tradix_tree_delete(&pids, pid[idx]);\n\t}\n\tspin_unlock(&pids_lock);\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define PIDVEC_SIZE\t128"
    ],
    "globals_used": [
      "static spinlock_t pids_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&pids_lock"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "radix_tree_delete",
          "args": [
            "&pids",
            "pid[idx]"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gang_lookup_pids",
          "args": [
            "pid",
            "next_pid",
            "PIDVEC_SIZE"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "gang_lookup_pids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
          "lines": "126-142",
          "snippet": "static unsigned int gang_lookup_pids(pid_t *results, unsigned long first_index,\n\t\t\t\t\t\t\tunsigned int max_items)\n{\n\tstruct radix_tree_iter iter;\n\tvoid **slot;\n\tunsigned int ret = 0;\n\n\tif (unlikely(!max_items))\n\t\treturn 0;\n\n\tradix_tree_for_each_slot(slot, &pids, &iter, first_index) {\n\t\tresults[ret] = iter.index;\n\t\tif (++ret == PIDVEC_SIZE)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"trace.h\"",
            "#include \"f2fs.h\"",
            "#include <linux/radix-tree.h>",
            "#include <linux/sched.h>",
            "#include <linux/f2fs_fs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define PIDVEC_SIZE\t128"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\n#define PIDVEC_SIZE\t128\n\nstatic unsigned int gang_lookup_pids(pid_t *results, unsigned long first_index,\n\t\t\t\t\t\t\tunsigned int max_items)\n{\n\tstruct radix_tree_iter iter;\n\tvoid **slot;\n\tunsigned int ret = 0;\n\n\tif (unlikely(!max_items))\n\t\treturn 0;\n\n\tradix_tree_for_each_slot(slot, &pids, &iter, first_index) {\n\t\tresults[ret] = iter.index;\n\t\tif (++ret == PIDVEC_SIZE)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&pids_lock"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\n#define PIDVEC_SIZE\t128\n\nstatic spinlock_t pids_lock;\n\nvoid f2fs_destroy_trace_ios(void)\n{\n\tpid_t pid[PIDVEC_SIZE];\n\tpid_t next_pid = 0;\n\tunsigned int found;\n\n\tspin_lock(&pids_lock);\n\twhile ((found = gang_lookup_pids(pid, next_pid, PIDVEC_SIZE))) {\n\t\tunsigned idx;\n\n\t\tnext_pid = pid[found - 1] + 1;\n\t\tfor (idx = 0; idx < found; idx++)\n\t\t\tradix_tree_delete(&pids, pid[idx]);\n\t}\n\tspin_unlock(&pids_lock);\n}"
  },
  {
    "function_name": "gang_lookup_pids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "126-142",
    "snippet": "static unsigned int gang_lookup_pids(pid_t *results, unsigned long first_index,\n\t\t\t\t\t\t\tunsigned int max_items)\n{\n\tstruct radix_tree_iter iter;\n\tvoid **slot;\n\tunsigned int ret = 0;\n\n\tif (unlikely(!max_items))\n\t\treturn 0;\n\n\tradix_tree_for_each_slot(slot, &pids, &iter, first_index) {\n\t\tresults[ret] = iter.index;\n\t\tif (++ret == PIDVEC_SIZE)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define PIDVEC_SIZE\t128"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "radix_tree_for_each_slot",
          "args": [
            "slot",
            "&pids",
            "&iter",
            "first_index"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!max_items"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\n#define PIDVEC_SIZE\t128\n\nstatic unsigned int gang_lookup_pids(pid_t *results, unsigned long first_index,\n\t\t\t\t\t\t\tunsigned int max_items)\n{\n\tstruct radix_tree_iter iter;\n\tvoid **slot;\n\tunsigned int ret = 0;\n\n\tif (unlikely(!max_items))\n\t\treturn 0;\n\n\tradix_tree_for_each_slot(slot, &pids, &iter, first_index) {\n\t\tresults[ret] = iter.index;\n\t\tif (++ret == PIDVEC_SIZE)\n\t\t\tbreak;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "f2fs_build_trace_ios",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "120-123",
    "snippet": "void f2fs_build_trace_ios(void)\n{\n\tspin_lock_init(&pids_lock);\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static spinlock_t pids_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&pids_lock"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic spinlock_t pids_lock;\n\nvoid f2fs_build_trace_ios(void)\n{\n\tspin_lock_init(&pids_lock);\n}"
  },
  {
    "function_name": "f2fs_trace_ios",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "83-118",
    "snippet": "void f2fs_trace_ios(struct page *page, struct f2fs_io_info *fio, int flush)\n{\n\tstruct inode *inode;\n\tpid_t pid;\n\tint major, minor;\n\n\tif (flush) {\n\t\t__print_last_io();\n\t\treturn;\n\t}\n\n\tinode = page->mapping->host;\n\tpid = page_private(page);\n\n\tmajor = MAJOR(inode->i_sb->s_dev);\n\tminor = MINOR(inode->i_sb->s_dev);\n\n\tif (last_io.major == major && last_io.minor == minor &&\n\t\t\tlast_io.pid == pid &&\n\t\t\tlast_io.type == __file_type(inode, pid) &&\n\t\t\tlast_io.fio.rw == fio->rw &&\n\t\t\tlast_io.fio.blk_addr + last_io.len == fio->blk_addr) {\n\t\tlast_io.len++;\n\t\treturn;\n\t}\n\n\t__print_last_io();\n\n\tlast_io.major = major;\n\tlast_io.minor = minor;\n\tlast_io.pid = pid;\n\tlast_io.type = __file_type(inode, pid);\n\tlast_io.fio = *fio;\n\tlast_io.len = 1;\n\treturn;\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct last_io_info last_io;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__file_type",
          "args": [
            "inode",
            "pid"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "__file_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
          "lines": "37-53",
          "snippet": "static int __file_type(struct inode *inode, pid_t pid)\n{\n\tif (f2fs_is_atomic_file(inode))\n\t\treturn __ATOMIC_FILE;\n\telse if (f2fs_is_volatile_file(inode))\n\t\treturn __VOLATILE_FILE;\n\telse if (S_ISDIR(inode->i_mode))\n\t\treturn __DIR_FILE;\n\telse if (inode->i_ino == F2FS_NODE_INO(F2FS_I_SB(inode)))\n\t\treturn __NODE_FILE;\n\telse if (inode->i_ino == F2FS_META_INO(F2FS_I_SB(inode)))\n\t\treturn __META_FILE;\n\telse if (pid)\n\t\treturn __NORMAL_FILE;\n\telse\n\t\treturn __MISC_FILE;\n}",
          "includes": [
            "#include \"trace.h\"",
            "#include \"f2fs.h\"",
            "#include <linux/radix-tree.h>",
            "#include <linux/sched.h>",
            "#include <linux/f2fs_fs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic int __file_type(struct inode *inode, pid_t pid)\n{\n\tif (f2fs_is_atomic_file(inode))\n\t\treturn __ATOMIC_FILE;\n\telse if (f2fs_is_volatile_file(inode))\n\t\treturn __VOLATILE_FILE;\n\telse if (S_ISDIR(inode->i_mode))\n\t\treturn __DIR_FILE;\n\telse if (inode->i_ino == F2FS_NODE_INO(F2FS_I_SB(inode)))\n\t\treturn __NODE_FILE;\n\telse if (inode->i_ino == F2FS_META_INO(F2FS_I_SB(inode)))\n\t\treturn __META_FILE;\n\telse if (pid)\n\t\treturn __NORMAL_FILE;\n\telse\n\t\treturn __MISC_FILE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__print_last_io",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "__print_last_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
          "lines": "23-35",
          "snippet": "static inline void __print_last_io(void)\n{\n\tif (!last_io.len)\n\t\treturn;\n\n\ttrace_printk(\"%3x:%3x %4x %-16s %2x %5x %12x %4x\\n\",\n\t\t\tlast_io.major, last_io.minor,\n\t\t\tlast_io.pid, \"----------------\",\n\t\t\tlast_io.type,\n\t\t\tlast_io.fio.rw, last_io.fio.blk_addr,\n\t\t\tlast_io.len);\n\tmemset(&last_io, 0, sizeof(last_io));\n}",
          "includes": [
            "#include \"trace.h\"",
            "#include \"f2fs.h\"",
            "#include <linux/radix-tree.h>",
            "#include <linux/sched.h>",
            "#include <linux/f2fs_fs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct last_io_info last_io;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic struct last_io_info last_io;\n\nstatic inline void __print_last_io(void)\n{\n\tif (!last_io.len)\n\t\treturn;\n\n\ttrace_printk(\"%3x:%3x %4x %-16s %2x %5x %12x %4x\\n\",\n\t\t\tlast_io.major, last_io.minor,\n\t\t\tlast_io.pid, \"----------------\",\n\t\t\tlast_io.type,\n\t\t\tlast_io.fio.rw, last_io.fio.blk_addr,\n\t\t\tlast_io.len);\n\tmemset(&last_io, 0, sizeof(last_io));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "inode->i_sb->s_dev"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "inode->i_sb->s_dev"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_private",
          "args": [
            "page"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic struct last_io_info last_io;\n\nvoid f2fs_trace_ios(struct page *page, struct f2fs_io_info *fio, int flush)\n{\n\tstruct inode *inode;\n\tpid_t pid;\n\tint major, minor;\n\n\tif (flush) {\n\t\t__print_last_io();\n\t\treturn;\n\t}\n\n\tinode = page->mapping->host;\n\tpid = page_private(page);\n\n\tmajor = MAJOR(inode->i_sb->s_dev);\n\tminor = MINOR(inode->i_sb->s_dev);\n\n\tif (last_io.major == major && last_io.minor == minor &&\n\t\t\tlast_io.pid == pid &&\n\t\t\tlast_io.type == __file_type(inode, pid) &&\n\t\t\tlast_io.fio.rw == fio->rw &&\n\t\t\tlast_io.fio.blk_addr + last_io.len == fio->blk_addr) {\n\t\tlast_io.len++;\n\t\treturn;\n\t}\n\n\t__print_last_io();\n\n\tlast_io.major = major;\n\tlast_io.minor = minor;\n\tlast_io.pid = pid;\n\tlast_io.type = __file_type(inode, pid);\n\tlast_io.fio = *fio;\n\tlast_io.len = 1;\n\treturn;\n}"
  },
  {
    "function_name": "f2fs_trace_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "55-81",
    "snippet": "void f2fs_trace_pid(struct page *page)\n{\n\tstruct inode *inode = page->mapping->host;\n\tpid_t pid = task_pid_nr(current);\n\tvoid *p;\n\n\tpage->private = pid;\n\n\tif (radix_tree_preload(GFP_NOFS))\n\t\treturn;\n\n\tspin_lock(&pids_lock);\n\tp = radix_tree_lookup(&pids, pid);\n\tif (p == current)\n\t\tgoto out;\n\tif (p)\n\t\tradix_tree_delete(&pids, pid);\n\n\tf2fs_radix_tree_insert(&pids, pid, current);\n\n\ttrace_printk(\"%3x:%3x %4x %-16s\\n\",\n\t\t\tMAJOR(inode->i_sb->s_dev), MINOR(inode->i_sb->s_dev),\n\t\t\tpid, current->comm);\nout:\n\tspin_unlock(&pids_lock);\n\tradix_tree_preload_end();\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static spinlock_t pids_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "radix_tree_preload_end",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&pids_lock"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_printk",
          "args": [
            "\"%3x:%3x %4x %-16s\\n\"",
            "MAJOR(inode->i_sb->s_dev)",
            "MINOR(inode->i_sb->s_dev)",
            "pid",
            "current->comm"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "inode->i_sb->s_dev"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "inode->i_sb->s_dev"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f2fs_radix_tree_insert",
          "args": [
            "&pids",
            "pid",
            "current"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_radix_tree_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1078-1083",
          "snippet": "static inline void f2fs_radix_tree_insert(struct radix_tree_root *root,\n\t\t\t\tunsigned long index, void *item)\n{\n\twhile (radix_tree_insert(root, index, item))\n\t\tcond_resched();\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void f2fs_radix_tree_insert(struct radix_tree_root *root,\n\t\t\t\tunsigned long index, void *item)\n{\n\twhile (radix_tree_insert(root, index, item))\n\t\tcond_resched();\n}"
        }
      },
      {
        "call_info": {
          "callee": "radix_tree_delete",
          "args": [
            "&pids",
            "pid"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_tree_lookup",
          "args": [
            "&pids",
            "pid"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&pids_lock"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "radix_tree_preload",
          "args": [
            "GFP_NOFS"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "current"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic spinlock_t pids_lock;\n\nvoid f2fs_trace_pid(struct page *page)\n{\n\tstruct inode *inode = page->mapping->host;\n\tpid_t pid = task_pid_nr(current);\n\tvoid *p;\n\n\tpage->private = pid;\n\n\tif (radix_tree_preload(GFP_NOFS))\n\t\treturn;\n\n\tspin_lock(&pids_lock);\n\tp = radix_tree_lookup(&pids, pid);\n\tif (p == current)\n\t\tgoto out;\n\tif (p)\n\t\tradix_tree_delete(&pids, pid);\n\n\tf2fs_radix_tree_insert(&pids, pid, current);\n\n\ttrace_printk(\"%3x:%3x %4x %-16s\\n\",\n\t\t\tMAJOR(inode->i_sb->s_dev), MINOR(inode->i_sb->s_dev),\n\t\t\tpid, current->comm);\nout:\n\tspin_unlock(&pids_lock);\n\tradix_tree_preload_end();\n}"
  },
  {
    "function_name": "__file_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "37-53",
    "snippet": "static int __file_type(struct inode *inode, pid_t pid)\n{\n\tif (f2fs_is_atomic_file(inode))\n\t\treturn __ATOMIC_FILE;\n\telse if (f2fs_is_volatile_file(inode))\n\t\treturn __VOLATILE_FILE;\n\telse if (S_ISDIR(inode->i_mode))\n\t\treturn __DIR_FILE;\n\telse if (inode->i_ino == F2FS_NODE_INO(F2FS_I_SB(inode)))\n\t\treturn __NODE_FILE;\n\telse if (inode->i_ino == F2FS_META_INO(F2FS_I_SB(inode)))\n\t\treturn __META_FILE;\n\telse if (pid)\n\t\treturn __NORMAL_FILE;\n\telse\n\t\treturn __MISC_FILE;\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "F2FS_META_INO",
          "args": [
            "F2FS_I_SB(inode)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "F2FS_I_SB",
          "args": [
            "inode"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "F2FS_I_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "645-648",
          "snippet": "static inline struct f2fs_sb_info *F2FS_I_SB(struct inode *inode)\n{\n\treturn F2FS_SB(inode->i_sb);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline struct f2fs_sb_info *F2FS_I_SB(struct inode *inode)\n{\n\treturn F2FS_SB(inode->i_sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "F2FS_NODE_INO",
          "args": [
            "F2FS_I_SB(inode)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f2fs_is_volatile_file",
          "args": [
            "inode"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_is_volatile_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1272-1275",
          "snippet": "static inline bool f2fs_is_volatile_file(struct inode *inode)\n{\n\treturn is_inode_flag_set(F2FS_I(inode), FI_VOLATILE_FILE);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline bool f2fs_is_volatile_file(struct inode *inode)\n{\n\treturn is_inode_flag_set(F2FS_I(inode), FI_VOLATILE_FILE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "f2fs_is_atomic_file",
          "args": [
            "inode"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_is_atomic_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1267-1270",
          "snippet": "static inline bool f2fs_is_atomic_file(struct inode *inode)\n{\n\treturn is_inode_flag_set(F2FS_I(inode), FI_ATOMIC_FILE);\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline bool f2fs_is_atomic_file(struct inode *inode)\n{\n\treturn is_inode_flag_set(F2FS_I(inode), FI_ATOMIC_FILE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic int __file_type(struct inode *inode, pid_t pid)\n{\n\tif (f2fs_is_atomic_file(inode))\n\t\treturn __ATOMIC_FILE;\n\telse if (f2fs_is_volatile_file(inode))\n\t\treturn __VOLATILE_FILE;\n\telse if (S_ISDIR(inode->i_mode))\n\t\treturn __DIR_FILE;\n\telse if (inode->i_ino == F2FS_NODE_INO(F2FS_I_SB(inode)))\n\t\treturn __NODE_FILE;\n\telse if (inode->i_ino == F2FS_META_INO(F2FS_I_SB(inode)))\n\t\treturn __META_FILE;\n\telse if (pid)\n\t\treturn __NORMAL_FILE;\n\telse\n\t\treturn __MISC_FILE;\n}"
  },
  {
    "function_name": "__print_last_io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/trace.c",
    "lines": "23-35",
    "snippet": "static inline void __print_last_io(void)\n{\n\tif (!last_io.len)\n\t\treturn;\n\n\ttrace_printk(\"%3x:%3x %4x %-16s %2x %5x %12x %4x\\n\",\n\t\t\tlast_io.major, last_io.minor,\n\t\t\tlast_io.pid, \"----------------\",\n\t\t\tlast_io.type,\n\t\t\tlast_io.fio.rw, last_io.fio.blk_addr,\n\t\t\tlast_io.len);\n\tmemset(&last_io, 0, sizeof(last_io));\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include \"f2fs.h\"",
      "#include <linux/radix-tree.h>",
      "#include <linux/sched.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct last_io_info last_io;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&last_io",
            "0",
            "sizeof(last_io)"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_printk",
          "args": [
            "\"%3x:%3x %4x %-16s %2x %5x %12x %4x\\n\"",
            "last_io.major",
            "last_io.minor",
            "last_io.pid",
            "\"----------------\"",
            "last_io.type",
            "last_io.fio.rw",
            "last_io.fio.blk_addr",
            "last_io.len"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include \"f2fs.h\"\n#include <linux/radix-tree.h>\n#include <linux/sched.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstatic struct last_io_info last_io;\n\nstatic inline void __print_last_io(void)\n{\n\tif (!last_io.len)\n\t\treturn;\n\n\ttrace_printk(\"%3x:%3x %4x %-16s %2x %5x %12x %4x\\n\",\n\t\t\tlast_io.major, last_io.minor,\n\t\t\tlast_io.pid, \"----------------\",\n\t\t\tlast_io.type,\n\t\t\tlast_io.fio.rw, last_io.fio.blk_addr,\n\t\t\tlast_io.len);\n\tmemset(&last_io, 0, sizeof(last_io));\n}"
  }
]