[
  {
    "function_name": "dlm_timeout_warn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "112-135",
    "snippet": "void dlm_timeout_warn(struct dlm_lkb *lkb)\n{\n\tstruct sk_buff *uninitialized_var(send_skb);\n\tstruct dlm_lock_data *data;\n\tsize_t size;\n\tint rv;\n\n\tsize = nla_total_size(sizeof(struct dlm_lock_data)) +\n\t       nla_total_size(0); /* why this? */\n\n\trv = prepare_data(DLM_CMD_TIMEOUT, &send_skb, size);\n\tif (rv < 0)\n\t\treturn;\n\n\tdata = mk_data(send_skb);\n\tif (!data) {\n\t\tnlmsg_free(send_skb);\n\t\treturn;\n\t}\n\n\tfill_data(data, lkb);\n\n\tsend_data(send_skb);\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_data",
          "args": [
            "send_skb"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "send_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "55-63",
          "snippet": "static int send_data(struct sk_buff *skb)\n{\n\tstruct genlmsghdr *genlhdr = nlmsg_data((struct nlmsghdr *)skb->data);\n\tvoid *data = genlmsg_data(genlhdr);\n\n\tgenlmsg_end(skb, data);\n\n\treturn genlmsg_unicast(&init_net, skb, listener_nlportid);\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static uint32_t listener_nlportid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic uint32_t listener_nlportid;\n\nstatic int send_data(struct sk_buff *skb)\n{\n\tstruct genlmsghdr *genlhdr = nlmsg_data((struct nlmsghdr *)skb->data);\n\tvoid *data = genlmsg_data(genlhdr);\n\n\tgenlmsg_end(skb, data);\n\n\treturn genlmsg_unicast(&init_net, skb, listener_nlportid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fill_data",
          "args": [
            "data",
            "lkb"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "fill_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "89-110",
          "snippet": "static void fill_data(struct dlm_lock_data *data, struct dlm_lkb *lkb)\n{\n\tstruct dlm_rsb *r = lkb->lkb_resource;\n\n\tmemset(data, 0, sizeof(struct dlm_lock_data));\n\n\tdata->version = DLM_LOCK_DATA_VERSION;\n\tdata->nodeid = lkb->lkb_nodeid;\n\tdata->ownpid = lkb->lkb_ownpid;\n\tdata->id = lkb->lkb_id;\n\tdata->remid = lkb->lkb_remid;\n\tdata->status = lkb->lkb_status;\n\tdata->grmode = lkb->lkb_grmode;\n\tdata->rqmode = lkb->lkb_rqmode;\n\tif (lkb->lkb_ua)\n\t\tdata->xid = lkb->lkb_ua->xid;\n\tif (r) {\n\t\tdata->lockspace_id = r->res_ls->ls_global_id;\n\t\tdata->resource_namelen = r->res_length;\n\t\tmemcpy(data->resource_name, r->res_name, r->res_length);\n\t}\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic void fill_data(struct dlm_lock_data *data, struct dlm_lkb *lkb)\n{\n\tstruct dlm_rsb *r = lkb->lkb_resource;\n\n\tmemset(data, 0, sizeof(struct dlm_lock_data));\n\n\tdata->version = DLM_LOCK_DATA_VERSION;\n\tdata->nodeid = lkb->lkb_nodeid;\n\tdata->ownpid = lkb->lkb_ownpid;\n\tdata->id = lkb->lkb_id;\n\tdata->remid = lkb->lkb_remid;\n\tdata->status = lkb->lkb_status;\n\tdata->grmode = lkb->lkb_grmode;\n\tdata->rqmode = lkb->lkb_rqmode;\n\tif (lkb->lkb_ua)\n\t\tdata->xid = lkb->lkb_ua->xid;\n\tif (r) {\n\t\tdata->lockspace_id = r->res_ls->ls_global_id;\n\t\tdata->resource_namelen = r->res_length;\n\t\tmemcpy(data->resource_name, r->res_name, r->res_length);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_free",
          "args": [
            "send_skb"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mk_data",
          "args": [
            "send_skb"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "mk_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "45-53",
          "snippet": "static struct dlm_lock_data *mk_data(struct sk_buff *skb)\n{\n\tstruct nlattr *ret;\n\n\tret = nla_reserve(skb, DLM_TYPE_LOCK, sizeof(struct dlm_lock_data));\n\tif (!ret)\n\t\treturn NULL;\n\treturn nla_data(ret);\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct dlm_lock_data *mk_data(struct sk_buff *skb)\n{\n\tstruct nlattr *ret;\n\n\tret = nla_reserve(skb, DLM_TYPE_LOCK, sizeof(struct dlm_lock_data));\n\tif (!ret)\n\t\treturn NULL;\n\treturn nla_data(ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_data",
          "args": [
            "DLM_CMD_TIMEOUT",
            "&send_skb",
            "size"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "25-43",
          "snippet": "static int prepare_data(u8 cmd, struct sk_buff **skbp, size_t size)\n{\n\tstruct sk_buff *skb;\n\tvoid *data;\n\n\tskb = genlmsg_new(size, GFP_NOFS);\n\tif (!skb)\n\t\treturn -ENOMEM;\n\n\t/* add the message headers */\n\tdata = genlmsg_put(skb, 0, dlm_nl_seqnum++, &family, 0, cmd);\n\tif (!data) {\n\t\tnlmsg_free(skb);\n\t\treturn -EINVAL;\n\t}\n\n\t*skbp = skb;\n\treturn 0;\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static uint32_t dlm_nl_seqnum;",
            "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic uint32_t dlm_nl_seqnum;\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\n\nstatic int prepare_data(u8 cmd, struct sk_buff **skbp, size_t size)\n{\n\tstruct sk_buff *skb;\n\tvoid *data;\n\n\tskb = genlmsg_new(size, GFP_NOFS);\n\tif (!skb)\n\t\treturn -ENOMEM;\n\n\t/* add the message headers */\n\tdata = genlmsg_put(skb, 0, dlm_nl_seqnum++, &family, 0, cmd);\n\tif (!data) {\n\t\tnlmsg_free(skb);\n\t\treturn -EINVAL;\n\t}\n\n\t*skbp = skb;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nla_total_size",
          "args": [
            "0"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_total_size",
          "args": [
            "sizeof(struct dlm_lock_data)"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nvoid dlm_timeout_warn(struct dlm_lkb *lkb)\n{\n\tstruct sk_buff *uninitialized_var(send_skb);\n\tstruct dlm_lock_data *data;\n\tsize_t size;\n\tint rv;\n\n\tsize = nla_total_size(sizeof(struct dlm_lock_data)) +\n\t       nla_total_size(0); /* why this? */\n\n\trv = prepare_data(DLM_CMD_TIMEOUT, &send_skb, size);\n\tif (rv < 0)\n\t\treturn;\n\n\tdata = mk_data(send_skb);\n\tif (!data) {\n\t\tnlmsg_free(send_skb);\n\t\treturn;\n\t}\n\n\tfill_data(data, lkb);\n\n\tsend_data(send_skb);\n}"
  },
  {
    "function_name": "fill_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "89-110",
    "snippet": "static void fill_data(struct dlm_lock_data *data, struct dlm_lkb *lkb)\n{\n\tstruct dlm_rsb *r = lkb->lkb_resource;\n\n\tmemset(data, 0, sizeof(struct dlm_lock_data));\n\n\tdata->version = DLM_LOCK_DATA_VERSION;\n\tdata->nodeid = lkb->lkb_nodeid;\n\tdata->ownpid = lkb->lkb_ownpid;\n\tdata->id = lkb->lkb_id;\n\tdata->remid = lkb->lkb_remid;\n\tdata->status = lkb->lkb_status;\n\tdata->grmode = lkb->lkb_grmode;\n\tdata->rqmode = lkb->lkb_rqmode;\n\tif (lkb->lkb_ua)\n\t\tdata->xid = lkb->lkb_ua->xid;\n\tif (r) {\n\t\tdata->lockspace_id = r->res_ls->ls_global_id;\n\t\tdata->resource_namelen = r->res_length;\n\t\tmemcpy(data->resource_name, r->res_name, r->res_length);\n\t}\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "data->resource_name",
            "r->res_name",
            "r->res_length"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0",
            "sizeof(struct dlm_lock_data)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic void fill_data(struct dlm_lock_data *data, struct dlm_lkb *lkb)\n{\n\tstruct dlm_rsb *r = lkb->lkb_resource;\n\n\tmemset(data, 0, sizeof(struct dlm_lock_data));\n\n\tdata->version = DLM_LOCK_DATA_VERSION;\n\tdata->nodeid = lkb->lkb_nodeid;\n\tdata->ownpid = lkb->lkb_ownpid;\n\tdata->id = lkb->lkb_id;\n\tdata->remid = lkb->lkb_remid;\n\tdata->status = lkb->lkb_status;\n\tdata->grmode = lkb->lkb_grmode;\n\tdata->rqmode = lkb->lkb_rqmode;\n\tif (lkb->lkb_ua)\n\t\tdata->xid = lkb->lkb_ua->xid;\n\tif (r) {\n\t\tdata->lockspace_id = r->res_ls->ls_global_id;\n\t\tdata->resource_namelen = r->res_length;\n\t\tmemcpy(data->resource_name, r->res_name, r->res_length);\n\t}\n}"
  },
  {
    "function_name": "dlm_netlink_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "84-87",
    "snippet": "void dlm_netlink_exit(void)\n{\n\tgenl_unregister_family(&family);\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "genl_unregister_family",
          "args": [
            "&family"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\n\nvoid dlm_netlink_exit(void)\n{\n\tgenl_unregister_family(&family);\n}"
  },
  {
    "function_name": "dlm_netlink_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "79-82",
    "snippet": "int __init dlm_netlink_init(void)\n{\n\treturn genl_register_family_with_ops(&family, dlm_nl_ops);\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};",
      "static struct genl_ops dlm_nl_ops[] = {\n\t{\n\t\t.cmd\t= DLM_CMD_HELLO,\n\t\t.doit\t= user_cmd,\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "genl_register_family_with_ops",
          "args": [
            "&family",
            "dlm_nl_ops"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\nstatic struct genl_ops dlm_nl_ops[] = {\n\t{\n\t\t.cmd\t= DLM_CMD_HELLO,\n\t\t.doit\t= user_cmd,\n\t},\n};\n\nint __init dlm_netlink_init(void)\n{\n\treturn genl_register_family_with_ops(&family, dlm_nl_ops);\n}"
  },
  {
    "function_name": "user_cmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "65-70",
    "snippet": "static int user_cmd(struct sk_buff *skb, struct genl_info *info)\n{\n\tlistener_nlportid = info->snd_portid;\n\tprintk(\"user_cmd nlpid %u\\n\", listener_nlportid);\n\treturn 0;\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static uint32_t listener_nlportid;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"user_cmd nlpid %u\\n\"",
            "listener_nlportid"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic uint32_t listener_nlportid;\n\nstatic int user_cmd(struct sk_buff *skb, struct genl_info *info)\n{\n\tlistener_nlportid = info->snd_portid;\n\tprintk(\"user_cmd nlpid %u\\n\", listener_nlportid);\n\treturn 0;\n}"
  },
  {
    "function_name": "send_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "55-63",
    "snippet": "static int send_data(struct sk_buff *skb)\n{\n\tstruct genlmsghdr *genlhdr = nlmsg_data((struct nlmsghdr *)skb->data);\n\tvoid *data = genlmsg_data(genlhdr);\n\n\tgenlmsg_end(skb, data);\n\n\treturn genlmsg_unicast(&init_net, skb, listener_nlportid);\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static uint32_t listener_nlportid;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "genlmsg_unicast",
          "args": [
            "&init_net",
            "skb",
            "listener_nlportid"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "genlmsg_end",
          "args": [
            "skb",
            "data"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "genlmsg_data",
          "args": [
            "genlhdr"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_data",
          "args": [
            "(struct nlmsghdr *)skb->data"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic uint32_t listener_nlportid;\n\nstatic int send_data(struct sk_buff *skb)\n{\n\tstruct genlmsghdr *genlhdr = nlmsg_data((struct nlmsghdr *)skb->data);\n\tvoid *data = genlmsg_data(genlhdr);\n\n\tgenlmsg_end(skb, data);\n\n\treturn genlmsg_unicast(&init_net, skb, listener_nlportid);\n}"
  },
  {
    "function_name": "mk_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "45-53",
    "snippet": "static struct dlm_lock_data *mk_data(struct sk_buff *skb)\n{\n\tstruct nlattr *ret;\n\n\tret = nla_reserve(skb, DLM_TYPE_LOCK, sizeof(struct dlm_lock_data));\n\tif (!ret)\n\t\treturn NULL;\n\treturn nla_data(ret);\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_data",
          "args": [
            "ret"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_reserve",
          "args": [
            "skb",
            "DLM_TYPE_LOCK",
            "sizeof(struct dlm_lock_data)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct dlm_lock_data *mk_data(struct sk_buff *skb)\n{\n\tstruct nlattr *ret;\n\n\tret = nla_reserve(skb, DLM_TYPE_LOCK, sizeof(struct dlm_lock_data));\n\tif (!ret)\n\t\treturn NULL;\n\treturn nla_data(ret);\n}"
  },
  {
    "function_name": "prepare_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
    "lines": "25-43",
    "snippet": "static int prepare_data(u8 cmd, struct sk_buff **skbp, size_t size)\n{\n\tstruct sk_buff *skb;\n\tvoid *data;\n\n\tskb = genlmsg_new(size, GFP_NOFS);\n\tif (!skb)\n\t\treturn -ENOMEM;\n\n\t/* add the message headers */\n\tdata = genlmsg_put(skb, 0, dlm_nl_seqnum++, &family, 0, cmd);\n\tif (!data) {\n\t\tnlmsg_free(skb);\n\t\treturn -EINVAL;\n\t}\n\n\t*skbp = skb;\n\treturn 0;\n}",
    "includes": [
      "#include \"dlm_internal.h\"",
      "#include <linux/gfp.h>",
      "#include <linux/dlm_netlink.h>",
      "#include <linux/dlm.h>",
      "#include <net/genetlink.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static uint32_t dlm_nl_seqnum;",
      "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlmsg_free",
          "args": [
            "skb"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "genlmsg_put",
          "args": [
            "skb",
            "0",
            "dlm_nl_seqnum++",
            "&family",
            "0",
            "cmd"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "genlmsg_new",
          "args": [
            "size",
            "GFP_NOFS"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic uint32_t dlm_nl_seqnum;\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\n\nstatic int prepare_data(u8 cmd, struct sk_buff **skbp, size_t size)\n{\n\tstruct sk_buff *skb;\n\tvoid *data;\n\n\tskb = genlmsg_new(size, GFP_NOFS);\n\tif (!skb)\n\t\treturn -ENOMEM;\n\n\t/* add the message headers */\n\tdata = genlmsg_put(skb, 0, dlm_nl_seqnum++, &family, 0, cmd);\n\tif (!data) {\n\t\tnlmsg_free(skb);\n\t\treturn -EINVAL;\n\t}\n\n\t*skbp = skb;\n\treturn 0;\n}"
  }
]