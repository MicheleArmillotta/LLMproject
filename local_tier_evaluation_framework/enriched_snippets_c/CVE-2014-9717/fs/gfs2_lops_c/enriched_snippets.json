[
  {
    "function_name": "databuf_lo_after_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "837-851",
    "snippet": "static void databuf_lo_after_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct list_head *head;\n\tstruct gfs2_bufdata *bd;\n\n\tif (tr == NULL)\n\t\treturn;\n\n\thead = &tr->tr_databuf;\n\twhile (!list_empty(head)) {\n\t\tbd = list_entry(head->next, struct gfs2_bufdata, bd_list);\n\t\tlist_del_init(&bd->bd_list);\n\t\tgfs2_unpin(sdp, bd->bd_bh, tr);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_unpin",
          "args": [
            "sdp",
            "bd->bd_bh",
            "tr"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_unpin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "98-130",
          "snippet": "static void gfs2_unpin(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       struct gfs2_trans *tr)\n{\n\tstruct gfs2_bufdata *bd = bh->b_private;\n\n\tBUG_ON(!buffer_uptodate(bh));\n\tBUG_ON(!buffer_pinned(bh));\n\n\tlock_buffer(bh);\n\tmark_buffer_dirty(bh);\n\tclear_buffer_pinned(bh);\n\n\tif (buffer_is_rgrp(bd))\n\t\tmaybe_release_space(bd);\n\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr) {\n\t\tlist_del(&bd->bd_ail_st_list);\n\t\tbrelse(bh);\n\t} else {\n\t\tstruct gfs2_glock *gl = bd->bd_gl;\n\t\tlist_add(&bd->bd_ail_gl_list, &gl->gl_ail_list);\n\t\tatomic_inc(&gl->gl_ail_count);\n\t}\n\tbd->bd_tr = tr;\n\tlist_add(&bd->bd_ail_st_list, &tr->tr_ail1_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\n\tclear_bit(GLF_LFLUSH, &bd->bd_gl->gl_flags);\n\ttrace_gfs2_pin(bd, 0);\n\tunlock_buffer(bh);\n\tatomic_dec(&sdp->sd_log_pinned);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_unpin(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       struct gfs2_trans *tr)\n{\n\tstruct gfs2_bufdata *bd = bh->b_private;\n\n\tBUG_ON(!buffer_uptodate(bh));\n\tBUG_ON(!buffer_pinned(bh));\n\n\tlock_buffer(bh);\n\tmark_buffer_dirty(bh);\n\tclear_buffer_pinned(bh);\n\n\tif (buffer_is_rgrp(bd))\n\t\tmaybe_release_space(bd);\n\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr) {\n\t\tlist_del(&bd->bd_ail_st_list);\n\t\tbrelse(bh);\n\t} else {\n\t\tstruct gfs2_glock *gl = bd->bd_gl;\n\t\tlist_add(&bd->bd_ail_gl_list, &gl->gl_ail_list);\n\t\tatomic_inc(&gl->gl_ail_count);\n\t}\n\tbd->bd_tr = tr;\n\tlist_add(&bd->bd_ail_st_list, &tr->tr_ail1_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\n\tclear_bit(GLF_LFLUSH, &bd->bd_gl->gl_flags);\n\ttrace_gfs2_pin(bd, 0);\n\tunlock_buffer(bh);\n\tatomic_dec(&sdp->sd_log_pinned);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&bd->bd_list"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "head->next",
            "structgfs2_bufdata",
            "bd_list"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "head"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void databuf_lo_after_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct list_head *head;\n\tstruct gfs2_bufdata *bd;\n\n\tif (tr == NULL)\n\t\treturn;\n\n\thead = &tr->tr_databuf;\n\twhile (!list_empty(head)) {\n\t\tbd = list_entry(head->next, struct gfs2_bufdata, bd_list);\n\t\tlist_del_init(&bd->bd_list);\n\t\tgfs2_unpin(sdp, bd->bd_bh, tr);\n\t}\n}"
  },
  {
    "function_name": "databuf_lo_after_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "818-835",
    "snippet": "static void databuf_lo_after_scan(struct gfs2_jdesc *jd, int error, int pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\n\tif (error) {\n\t\tgfs2_meta_sync(ip->i_gl);\n\t\treturn;\n\t}\n\tif (pass != 1)\n\t\treturn;\n\n\t/* data sync? */\n\tgfs2_meta_sync(ip->i_gl);\n\n\tfs_info(sdp, \"jid=%u: Replayed %u of %u data blocks\\n\",\n\t\tjd->jd_jid, jd->jd_replayed_blocks, jd->jd_found_blocks);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs_info",
          "args": [
            "sdp",
            "\"jid=%u: Replayed %u of %u data blocks\\n\"",
            "jd->jd_jid",
            "jd->jd_replayed_blocks",
            "jd->jd_found_blocks"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "280-288",
          "snippet": "void reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_meta_sync",
          "args": [
            "ip->i_gl"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "585-599",
          "snippet": "static void gfs2_meta_sync(struct gfs2_glock *gl)\n{\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error;\n\n\tif (mapping == NULL)\n\t\tmapping = &sdp->sd_aspace;\n\n\tfilemap_fdatawrite(mapping);\n\terror = filemap_fdatawait(mapping);\n\n\tif (error)\n\t\tgfs2_io_error(gl->gl_sbd);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_meta_sync(struct gfs2_glock *gl)\n{\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error;\n\n\tif (mapping == NULL)\n\t\tmapping = &sdp->sd_aspace;\n\n\tfilemap_fdatawrite(mapping);\n\terror = filemap_fdatawait(mapping);\n\n\tif (error)\n\t\tgfs2_io_error(gl->gl_sbd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "jd->jd_inode"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "jd->jd_inode"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void databuf_lo_after_scan(struct gfs2_jdesc *jd, int error, int pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\n\tif (error) {\n\t\tgfs2_meta_sync(ip->i_gl);\n\t\treturn;\n\t}\n\tif (pass != 1)\n\t\treturn;\n\n\t/* data sync? */\n\tgfs2_meta_sync(ip->i_gl);\n\n\tfs_info(sdp, \"jid=%u: Replayed %u of %u data blocks\\n\",\n\t\tjd->jd_jid, jd->jd_replayed_blocks, jd->jd_found_blocks);\n}"
  },
  {
    "function_name": "databuf_lo_scan_elements",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "767-814",
    "snippet": "static int databuf_lo_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\t    struct gfs2_log_descriptor *ld,\n\t\t\t\t    __be64 *ptr, int pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tunsigned int blks = be32_to_cpu(ld->ld_data1);\n\tstruct buffer_head *bh_log, *bh_ip;\n\tu64 blkno;\n\tu64 esc;\n\tint error = 0;\n\n\tif (pass != 1 || be32_to_cpu(ld->ld_type) != GFS2_LOG_DESC_JDATA)\n\t\treturn 0;\n\n\tgfs2_replay_incr_blk(sdp, &start);\n\tfor (; blks; gfs2_replay_incr_blk(sdp, &start), blks--) {\n\t\tblkno = be64_to_cpu(*ptr++);\n\t\tesc = be64_to_cpu(*ptr++);\n\n\t\tjd->jd_found_blocks++;\n\n\t\tif (gfs2_revoke_check(jd, blkno, start))\n\t\t\tcontinue;\n\n\t\terror = gfs2_replay_read_block(jd, start, &bh_log);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tbh_ip = gfs2_meta_new(gl, blkno);\n\t\tmemcpy(bh_ip->b_data, bh_log->b_data, bh_log->b_size);\n\n\t\t/* Unescape */\n\t\tif (esc) {\n\t\t\t__be32 *eptr = (__be32 *)bh_ip->b_data;\n\t\t\t*eptr = cpu_to_be32(GFS2_MAGIC);\n\t\t}\n\t\tmark_buffer_dirty(bh_ip);\n\n\t\tbrelse(bh_log);\n\t\tbrelse(bh_ip);\n\n\t\tjd->jd_replayed_blocks++;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh_ip"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh_ip"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_MAGIC"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "bh_ip->b_data",
            "bh_log->b_data",
            "bh_log->b_size"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_meta_new",
          "args": [
            "gl",
            "blkno"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.c",
          "lines": "182-188",
          "snippet": "struct buffer_head *gfs2_meta_new(struct gfs2_glock *gl, u64 blkno)\n{\n\tstruct buffer_head *bh;\n\tbh = gfs2_getbuf(gl, blkno, CREATE);\n\tmeta_prep_new(bh);\n\treturn bh;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/delay.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/delay.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstruct buffer_head *gfs2_meta_new(struct gfs2_glock *gl, u64 blkno)\n{\n\tstruct buffer_head *bh;\n\tbh = gfs2_getbuf(gl, blkno, CREATE);\n\tmeta_prep_new(bh);\n\treturn bh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_replay_read_block",
          "args": [
            "jd",
            "start",
            "&bh_log"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_replay_read_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "32-53",
          "snippet": "int gfs2_replay_read_block(struct gfs2_jdesc *jd, unsigned int blk,\n\t\t\t   struct buffer_head **bh)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint new = 0;\n\tu64 dblock;\n\tu32 extlen;\n\tint error;\n\n\terror = gfs2_extent_map(&ip->i_inode, blk, &new, &dblock, &extlen);\n\tif (error)\n\t\treturn error;\n\tif (!dblock) {\n\t\tgfs2_consist_inode(ip);\n\t\treturn -EIO;\n\t}\n\n\t*bh = gfs2_meta_ra(gl, dblock, extlen);\n\n\treturn error;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nint gfs2_replay_read_block(struct gfs2_jdesc *jd, unsigned int blk,\n\t\t\t   struct buffer_head **bh)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint new = 0;\n\tu64 dblock;\n\tu32 extlen;\n\tint error;\n\n\terror = gfs2_extent_map(&ip->i_inode, blk, &new, &dblock, &extlen);\n\tif (error)\n\t\treturn error;\n\tif (!dblock) {\n\t\tgfs2_consist_inode(ip);\n\t\treturn -EIO;\n\t}\n\n\t*bh = gfs2_meta_ra(gl, dblock, extlen);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_revoke_check",
          "args": [
            "jd",
            "blkno",
            "start"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_revoke_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "84-106",
          "snippet": "int gfs2_revoke_check(struct gfs2_jdesc *jd, u64 blkno, unsigned int where)\n{\n\tstruct gfs2_revoke_replay *rr;\n\tint wrap, a, b, revoke;\n\tint found = 0;\n\n\tlist_for_each_entry(rr, &jd->jd_revoke_list, rr_list) {\n\t\tif (rr->rr_blkno == blkno) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn 0;\n\n\twrap = (rr->rr_where < jd->jd_replay_tail);\n\ta = (jd->jd_replay_tail < where);\n\tb = (where < rr->rr_where);\n\trevoke = (wrap) ? (a || b) : (a && b);\n\n\treturn revoke;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nint gfs2_revoke_check(struct gfs2_jdesc *jd, u64 blkno, unsigned int where)\n{\n\tstruct gfs2_revoke_replay *rr;\n\tint wrap, a, b, revoke;\n\tint found = 0;\n\n\tlist_for_each_entry(rr, &jd->jd_revoke_list, rr_list) {\n\t\tif (rr->rr_blkno == blkno) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn 0;\n\n\twrap = (rr->rr_where < jd->jd_replay_tail);\n\ta = (jd->jd_replay_tail < where);\n\tb = (where < rr->rr_where);\n\trevoke = (wrap) ? (a || b) : (a && b);\n\n\treturn revoke;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "*ptr++"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "*ptr++"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_replay_incr_blk",
          "args": [
            "sdp",
            "&start"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_replay_incr_blk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.h",
          "lines": "17-21",
          "snippet": "static inline void gfs2_replay_incr_blk(struct gfs2_sbd *sdp, unsigned int *blk)\n{\n\tif (++*blk == sdp->sd_jdesc->jd_blocks)\n\t        *blk = 0;\n}",
          "includes": [
            "#include \"incore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n\nstatic inline void gfs2_replay_incr_blk(struct gfs2_sbd *sdp, unsigned int *blk)\n{\n\tif (++*blk == sdp->sd_jdesc->jd_blocks)\n\t        *blk = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_type"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_data1"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "jd->jd_inode"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "jd->jd_inode"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int databuf_lo_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\t    struct gfs2_log_descriptor *ld,\n\t\t\t\t    __be64 *ptr, int pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tunsigned int blks = be32_to_cpu(ld->ld_data1);\n\tstruct buffer_head *bh_log, *bh_ip;\n\tu64 blkno;\n\tu64 esc;\n\tint error = 0;\n\n\tif (pass != 1 || be32_to_cpu(ld->ld_type) != GFS2_LOG_DESC_JDATA)\n\t\treturn 0;\n\n\tgfs2_replay_incr_blk(sdp, &start);\n\tfor (; blks; gfs2_replay_incr_blk(sdp, &start), blks--) {\n\t\tblkno = be64_to_cpu(*ptr++);\n\t\tesc = be64_to_cpu(*ptr++);\n\n\t\tjd->jd_found_blocks++;\n\n\t\tif (gfs2_revoke_check(jd, blkno, start))\n\t\t\tcontinue;\n\n\t\terror = gfs2_replay_read_block(jd, start, &bh_log);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tbh_ip = gfs2_meta_new(gl, blkno);\n\t\tmemcpy(bh_ip->b_data, bh_log->b_data, bh_log->b_size);\n\n\t\t/* Unescape */\n\t\tif (esc) {\n\t\t\t__be32 *eptr = (__be32 *)bh_ip->b_data;\n\t\t\t*eptr = cpu_to_be32(GFS2_MAGIC);\n\t\t}\n\t\tmark_buffer_dirty(bh_ip);\n\n\t\tbrelse(bh_log);\n\t\tbrelse(bh_ip);\n\n\t\tjd->jd_replayed_blocks++;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "databuf_lo_before_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "757-765",
    "snippet": "static void databuf_lo_before_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tunsigned int limit = databuf_limit(sdp);\n\tunsigned int nbuf;\n\tif (tr == NULL)\n\t\treturn;\n\tnbuf = tr->tr_num_databuf_new - tr->tr_num_databuf_rm;\n\tgfs2_before_commit(sdp, limit, nbuf, &tr->tr_databuf, 1);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_before_commit",
          "args": [
            "sdp",
            "limit",
            "nbuf",
            "&tr->tr_databuf",
            "1"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_before_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "420-492",
          "snippet": "static void gfs2_before_commit(struct gfs2_sbd *sdp, unsigned int limit,\n\t\t\t\tunsigned int total, struct list_head *blist,\n\t\t\t\tbool is_databuf)\n{\n\tstruct gfs2_log_descriptor *ld;\n\tstruct gfs2_bufdata *bd1 = NULL, *bd2;\n\tstruct page *page;\n\tunsigned int num;\n\tunsigned n;\n\t__be64 *ptr;\n\n\tgfs2_log_lock(sdp);\n\tlist_sort(NULL, blist, blocknr_cmp);\n\tbd1 = bd2 = list_prepare_entry(bd1, blist, bd_list);\n\twhile(total) {\n\t\tnum = total;\n\t\tif (total > limit)\n\t\t\tnum = limit;\n\t\tgfs2_log_unlock(sdp);\n\t\tpage = gfs2_get_log_desc(sdp,\n\t\t\t\t\t is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA, num + 1, num);\n\t\tld = page_address(page);\n\t\tgfs2_log_lock(sdp);\n\t\tptr = (__be64 *)(ld + 1);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd1, blist, bd_list) {\n\t\t\t*ptr++ = cpu_to_be64(bd1->bd_bh->b_blocknr);\n\t\t\tif (is_databuf) {\n\t\t\t\tgfs2_check_magic(bd1->bd_bh);\n\t\t\t\t*ptr++ = cpu_to_be64(buffer_escaped(bd1->bd_bh) ? 1 : 0);\n\t\t\t}\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tgfs2_log_unlock(sdp);\n\t\tgfs2_log_write_page(sdp, page);\n\t\tgfs2_log_lock(sdp);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd2, blist, bd_list) {\n\t\t\tget_bh(bd2->bd_bh);\n\t\t\tgfs2_log_unlock(sdp);\n\t\t\tlock_buffer(bd2->bd_bh);\n\n\t\t\tif (buffer_escaped(bd2->bd_bh)) {\n\t\t\t\tvoid *kaddr;\n\t\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\t\tptr = page_address(page);\n\t\t\t\tkaddr = kmap_atomic(bd2->bd_bh->b_page);\n\t\t\t\tmemcpy(ptr, kaddr + bh_offset(bd2->bd_bh),\n\t\t\t\t       bd2->bd_bh->b_size);\n\t\t\t\tkunmap_atomic(kaddr);\n\t\t\t\t*(__be32 *)ptr = 0;\n\t\t\t\tclear_buffer_escaped(bd2->bd_bh);\n\t\t\t\tunlock_buffer(bd2->bd_bh);\n\t\t\t\tbrelse(bd2->bd_bh);\n\t\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\t} else {\n\t\t\t\tgfs2_log_write_bh(sdp, bd2->bd_bh);\n\t\t\t}\n\t\t\tgfs2_log_lock(sdp);\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tBUG_ON(total < num);\n\t\ttotal -= num;\n\t}\n\tgfs2_log_unlock(sdp);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_before_commit(struct gfs2_sbd *sdp, unsigned int limit,\n\t\t\t\tunsigned int total, struct list_head *blist,\n\t\t\t\tbool is_databuf)\n{\n\tstruct gfs2_log_descriptor *ld;\n\tstruct gfs2_bufdata *bd1 = NULL, *bd2;\n\tstruct page *page;\n\tunsigned int num;\n\tunsigned n;\n\t__be64 *ptr;\n\n\tgfs2_log_lock(sdp);\n\tlist_sort(NULL, blist, blocknr_cmp);\n\tbd1 = bd2 = list_prepare_entry(bd1, blist, bd_list);\n\twhile(total) {\n\t\tnum = total;\n\t\tif (total > limit)\n\t\t\tnum = limit;\n\t\tgfs2_log_unlock(sdp);\n\t\tpage = gfs2_get_log_desc(sdp,\n\t\t\t\t\t is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA, num + 1, num);\n\t\tld = page_address(page);\n\t\tgfs2_log_lock(sdp);\n\t\tptr = (__be64 *)(ld + 1);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd1, blist, bd_list) {\n\t\t\t*ptr++ = cpu_to_be64(bd1->bd_bh->b_blocknr);\n\t\t\tif (is_databuf) {\n\t\t\t\tgfs2_check_magic(bd1->bd_bh);\n\t\t\t\t*ptr++ = cpu_to_be64(buffer_escaped(bd1->bd_bh) ? 1 : 0);\n\t\t\t}\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tgfs2_log_unlock(sdp);\n\t\tgfs2_log_write_page(sdp, page);\n\t\tgfs2_log_lock(sdp);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd2, blist, bd_list) {\n\t\t\tget_bh(bd2->bd_bh);\n\t\t\tgfs2_log_unlock(sdp);\n\t\t\tlock_buffer(bd2->bd_bh);\n\n\t\t\tif (buffer_escaped(bd2->bd_bh)) {\n\t\t\t\tvoid *kaddr;\n\t\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\t\tptr = page_address(page);\n\t\t\t\tkaddr = kmap_atomic(bd2->bd_bh->b_page);\n\t\t\t\tmemcpy(ptr, kaddr + bh_offset(bd2->bd_bh),\n\t\t\t\t       bd2->bd_bh->b_size);\n\t\t\t\tkunmap_atomic(kaddr);\n\t\t\t\t*(__be32 *)ptr = 0;\n\t\t\t\tclear_buffer_escaped(bd2->bd_bh);\n\t\t\t\tunlock_buffer(bd2->bd_bh);\n\t\t\t\tbrelse(bd2->bd_bh);\n\t\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\t} else {\n\t\t\t\tgfs2_log_write_bh(sdp, bd2->bd_bh);\n\t\t\t}\n\t\t\tgfs2_log_lock(sdp);\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tBUG_ON(total < num);\n\t\ttotal -= num;\n\t}\n\tgfs2_log_unlock(sdp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "databuf_limit",
          "args": [
            "sdp"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "databuf_limit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
          "lines": "41-47",
          "snippet": "static inline unsigned int databuf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - DATABUF_OFFSET) / (2 * sizeof(__be64));\n\treturn limit;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/list.h>"
          ],
          "macros_used": [
            "#define DATABUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + (2 * sizeof(__be64) - 1)) & \\\n\t ~(2 * sizeof(__be64) - 1))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\n#define DATABUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + (2 * sizeof(__be64) - 1)) & \\\n\t ~(2 * sizeof(__be64) - 1))\n\nstatic inline unsigned int databuf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - DATABUF_OFFSET) / (2 * sizeof(__be64));\n\treturn limit;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void databuf_lo_before_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tunsigned int limit = databuf_limit(sdp);\n\tunsigned int nbuf;\n\tif (tr == NULL)\n\t\treturn;\n\tnbuf = tr->tr_num_databuf_new - tr->tr_num_databuf_rm;\n\tgfs2_before_commit(sdp, limit, nbuf, &tr->tr_databuf, 1);\n}"
  },
  {
    "function_name": "revoke_lo_after_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "735-750",
    "snippet": "static void revoke_lo_after_scan(struct gfs2_jdesc *jd, int error, int pass)\n{\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\n\tif (error) {\n\t\tgfs2_revoke_clean(jd);\n\t\treturn;\n\t}\n\tif (pass != 1)\n\t\treturn;\n\n\tfs_info(sdp, \"jid=%u: Found %u revoke tags\\n\",\n\t        jd->jd_jid, jd->jd_found_revokes);\n\n\tgfs2_revoke_clean(jd);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_revoke_clean",
          "args": [
            "jd"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_revoke_clean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "108-118",
          "snippet": "void gfs2_revoke_clean(struct gfs2_jdesc *jd)\n{\n\tstruct list_head *head = &jd->jd_revoke_list;\n\tstruct gfs2_revoke_replay *rr;\n\n\twhile (!list_empty(head)) {\n\t\trr = list_entry(head->next, struct gfs2_revoke_replay, rr_list);\n\t\tlist_del(&rr->rr_list);\n\t\tkfree(rr);\n\t}\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nvoid gfs2_revoke_clean(struct gfs2_jdesc *jd)\n{\n\tstruct list_head *head = &jd->jd_revoke_list;\n\tstruct gfs2_revoke_replay *rr;\n\n\twhile (!list_empty(head)) {\n\t\trr = list_entry(head->next, struct gfs2_revoke_replay, rr_list);\n\t\tlist_del(&rr->rr_list);\n\t\tkfree(rr);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs_info",
          "args": [
            "sdp",
            "\"jid=%u: Found %u revoke tags\\n\"",
            "jd->jd_jid",
            "jd->jd_found_revokes"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "280-288",
          "snippet": "void reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "jd->jd_inode"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void revoke_lo_after_scan(struct gfs2_jdesc *jd, int error, int pass)\n{\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\n\tif (error) {\n\t\tgfs2_revoke_clean(jd);\n\t\treturn;\n\t}\n\tif (pass != 1)\n\t\treturn;\n\n\tfs_info(sdp, \"jid=%u: Found %u revoke tags\\n\",\n\t        jd->jd_jid, jd->jd_found_revokes);\n\n\tgfs2_revoke_clean(jd);\n}"
  },
  {
    "function_name": "revoke_lo_scan_elements",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "685-733",
    "snippet": "static int revoke_lo_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\t   struct gfs2_log_descriptor *ld, __be64 *ptr,\n\t\t\t\t   int pass)\n{\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\tunsigned int blks = be32_to_cpu(ld->ld_length);\n\tunsigned int revokes = be32_to_cpu(ld->ld_data1);\n\tstruct buffer_head *bh;\n\tunsigned int offset;\n\tu64 blkno;\n\tint first = 1;\n\tint error;\n\n\tif (pass != 0 || be32_to_cpu(ld->ld_type) != GFS2_LOG_DESC_REVOKE)\n\t\treturn 0;\n\n\toffset = sizeof(struct gfs2_log_descriptor);\n\n\tfor (; blks; gfs2_replay_incr_blk(sdp, &start), blks--) {\n\t\terror = gfs2_replay_read_block(jd, start, &bh);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tif (!first)\n\t\t\tgfs2_metatype_check(sdp, bh, GFS2_METATYPE_LB);\n\n\t\twhile (offset + sizeof(u64) <= sdp->sd_sb.sb_bsize) {\n\t\t\tblkno = be64_to_cpu(*(__be64 *)(bh->b_data + offset));\n\n\t\t\terror = gfs2_revoke_add(jd, blkno, start);\n\t\t\tif (error < 0) {\n\t\t\t\tbrelse(bh);\n\t\t\t\treturn error;\n\t\t\t}\n\t\t\telse if (error)\n\t\t\t\tjd->jd_found_revokes++;\n\n\t\t\tif (!--revokes)\n\t\t\t\tbreak;\n\t\t\toffset += sizeof(u64);\n\t\t}\n\n\t\tbrelse(bh);\n\t\toffset = sizeof(struct gfs2_meta_header);\n\t\tfirst = 0;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_revoke_add",
          "args": [
            "jd",
            "blkno",
            "start"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_revoke_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "55-82",
          "snippet": "int gfs2_revoke_add(struct gfs2_jdesc *jd, u64 blkno, unsigned int where)\n{\n\tstruct list_head *head = &jd->jd_revoke_list;\n\tstruct gfs2_revoke_replay *rr;\n\tint found = 0;\n\n\tlist_for_each_entry(rr, head, rr_list) {\n\t\tif (rr->rr_blkno == blkno) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (found) {\n\t\trr->rr_where = where;\n\t\treturn 0;\n\t}\n\n\trr = kmalloc(sizeof(struct gfs2_revoke_replay), GFP_NOFS);\n\tif (!rr)\n\t\treturn -ENOMEM;\n\n\trr->rr_blkno = blkno;\n\trr->rr_where = where;\n\tlist_add(&rr->rr_list, head);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nint gfs2_revoke_add(struct gfs2_jdesc *jd, u64 blkno, unsigned int where)\n{\n\tstruct list_head *head = &jd->jd_revoke_list;\n\tstruct gfs2_revoke_replay *rr;\n\tint found = 0;\n\n\tlist_for_each_entry(rr, head, rr_list) {\n\t\tif (rr->rr_blkno == blkno) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (found) {\n\t\trr->rr_where = where;\n\t\treturn 0;\n\t}\n\n\trr = kmalloc(sizeof(struct gfs2_revoke_replay), GFP_NOFS);\n\tif (!rr)\n\t\treturn -ENOMEM;\n\n\trr->rr_blkno = blkno;\n\trr->rr_where = where;\n\tlist_add(&rr->rr_list, head);\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "*(__be64 *)(bh->b_data + offset)"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_metatype_check",
          "args": [
            "sdp",
            "bh",
            "GFS2_METATYPE_LB"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_replay_read_block",
          "args": [
            "jd",
            "start",
            "&bh"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_replay_read_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "32-53",
          "snippet": "int gfs2_replay_read_block(struct gfs2_jdesc *jd, unsigned int blk,\n\t\t\t   struct buffer_head **bh)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint new = 0;\n\tu64 dblock;\n\tu32 extlen;\n\tint error;\n\n\terror = gfs2_extent_map(&ip->i_inode, blk, &new, &dblock, &extlen);\n\tif (error)\n\t\treturn error;\n\tif (!dblock) {\n\t\tgfs2_consist_inode(ip);\n\t\treturn -EIO;\n\t}\n\n\t*bh = gfs2_meta_ra(gl, dblock, extlen);\n\n\treturn error;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nint gfs2_replay_read_block(struct gfs2_jdesc *jd, unsigned int blk,\n\t\t\t   struct buffer_head **bh)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint new = 0;\n\tu64 dblock;\n\tu32 extlen;\n\tint error;\n\n\terror = gfs2_extent_map(&ip->i_inode, blk, &new, &dblock, &extlen);\n\tif (error)\n\t\treturn error;\n\tif (!dblock) {\n\t\tgfs2_consist_inode(ip);\n\t\treturn -EIO;\n\t}\n\n\t*bh = gfs2_meta_ra(gl, dblock, extlen);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_replay_incr_blk",
          "args": [
            "sdp",
            "&start"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_replay_incr_blk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.h",
          "lines": "17-21",
          "snippet": "static inline void gfs2_replay_incr_blk(struct gfs2_sbd *sdp, unsigned int *blk)\n{\n\tif (++*blk == sdp->sd_jdesc->jd_blocks)\n\t        *blk = 0;\n}",
          "includes": [
            "#include \"incore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n\nstatic inline void gfs2_replay_incr_blk(struct gfs2_sbd *sdp, unsigned int *blk)\n{\n\tif (++*blk == sdp->sd_jdesc->jd_blocks)\n\t        *blk = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_type"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_data1"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_length"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "jd->jd_inode"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int revoke_lo_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\t   struct gfs2_log_descriptor *ld, __be64 *ptr,\n\t\t\t\t   int pass)\n{\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\tunsigned int blks = be32_to_cpu(ld->ld_length);\n\tunsigned int revokes = be32_to_cpu(ld->ld_data1);\n\tstruct buffer_head *bh;\n\tunsigned int offset;\n\tu64 blkno;\n\tint first = 1;\n\tint error;\n\n\tif (pass != 0 || be32_to_cpu(ld->ld_type) != GFS2_LOG_DESC_REVOKE)\n\t\treturn 0;\n\n\toffset = sizeof(struct gfs2_log_descriptor);\n\n\tfor (; blks; gfs2_replay_incr_blk(sdp, &start), blks--) {\n\t\terror = gfs2_replay_read_block(jd, start, &bh);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tif (!first)\n\t\t\tgfs2_metatype_check(sdp, bh, GFS2_METATYPE_LB);\n\n\t\twhile (offset + sizeof(u64) <= sdp->sd_sb.sb_bsize) {\n\t\t\tblkno = be64_to_cpu(*(__be64 *)(bh->b_data + offset));\n\n\t\t\terror = gfs2_revoke_add(jd, blkno, start);\n\t\t\tif (error < 0) {\n\t\t\t\tbrelse(bh);\n\t\t\t\treturn error;\n\t\t\t}\n\t\t\telse if (error)\n\t\t\t\tjd->jd_found_revokes++;\n\n\t\t\tif (!--revokes)\n\t\t\t\tbreak;\n\t\t\toffset += sizeof(u64);\n\t\t}\n\n\t\tbrelse(bh);\n\t\toffset = sizeof(struct gfs2_meta_header);\n\t\tfirst = 0;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "revoke_lo_before_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "675-683",
    "snippet": "static void revoke_lo_before_scan(struct gfs2_jdesc *jd,\n\t\t\t\t  struct gfs2_log_header_host *head, int pass)\n{\n\tif (pass != 0)\n\t\treturn;\n\n\tjd->jd_found_revokes = 0;\n\tjd->jd_replay_tail = head->lh_tail;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void revoke_lo_before_scan(struct gfs2_jdesc *jd,\n\t\t\t\t  struct gfs2_log_header_host *head, int pass)\n{\n\tif (pass != 0)\n\t\treturn;\n\n\tjd->jd_found_revokes = 0;\n\tjd->jd_replay_tail = head->lh_tail;\n}"
  },
  {
    "function_name": "revoke_lo_after_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "659-673",
    "snippet": "static void revoke_lo_after_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct list_head *head = &sdp->sd_log_le_revoke;\n\tstruct gfs2_bufdata *bd;\n\tstruct gfs2_glock *gl;\n\n\twhile (!list_empty(head)) {\n\t\tbd = list_entry(head->next, struct gfs2_bufdata, bd_list);\n\t\tlist_del_init(&bd->bd_list);\n\t\tgl = bd->bd_gl;\n\t\tatomic_dec(&gl->gl_revokes);\n\t\tclear_bit(GLF_LFLUSH, &gl->gl_flags);\n\t\tkmem_cache_free(gfs2_bufdata_cachep, bd);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "gfs2_bufdata_cachep",
            "bd"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LFLUSH",
            "&gl->gl_flags"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&gl->gl_revokes"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&bd->bd_list"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "head->next",
            "structgfs2_bufdata",
            "bd_list"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "head"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void revoke_lo_after_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct list_head *head = &sdp->sd_log_le_revoke;\n\tstruct gfs2_bufdata *bd;\n\tstruct gfs2_glock *gl;\n\n\twhile (!list_empty(head)) {\n\t\tbd = list_entry(head->next, struct gfs2_bufdata, bd_list);\n\t\tlist_del_init(&bd->bd_list);\n\t\tgl = bd->bd_gl;\n\t\tatomic_dec(&gl->gl_revokes);\n\t\tclear_bit(GLF_LFLUSH, &gl->gl_flags);\n\t\tkmem_cache_free(gfs2_bufdata_cachep, bd);\n\t}\n}"
  },
  {
    "function_name": "revoke_lo_before_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "619-657",
    "snippet": "static void revoke_lo_before_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct gfs2_meta_header *mh;\n\tunsigned int offset;\n\tstruct list_head *head = &sdp->sd_log_le_revoke;\n\tstruct gfs2_bufdata *bd;\n\tstruct page *page;\n\tunsigned int length;\n\n\tgfs2_write_revokes(sdp);\n\tif (!sdp->sd_log_num_revoke)\n\t\treturn;\n\n\tlength = gfs2_struct2blk(sdp, sdp->sd_log_num_revoke, sizeof(u64));\n\tpage = gfs2_get_log_desc(sdp, GFS2_LOG_DESC_REVOKE, length, sdp->sd_log_num_revoke);\n\toffset = sizeof(struct gfs2_log_descriptor);\n\n\tlist_for_each_entry(bd, head, bd_list) {\n\t\tsdp->sd_log_num_revoke--;\n\n\t\tif (offset + sizeof(u64) > sdp->sd_sb.sb_bsize) {\n\n\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\tmh = page_address(page);\n\t\t\tclear_page(mh);\n\t\t\tmh->mh_magic = cpu_to_be32(GFS2_MAGIC);\n\t\t\tmh->mh_type = cpu_to_be32(GFS2_METATYPE_LB);\n\t\t\tmh->mh_format = cpu_to_be32(GFS2_FORMAT_LB);\n\t\t\toffset = sizeof(struct gfs2_meta_header);\n\t\t}\n\n\t\t*(__be64 *)(page_address(page) + offset) = cpu_to_be64(bd->bd_blkno);\n\t\toffset += sizeof(u64);\n\t}\n\tgfs2_assert_withdraw(sdp, !sdp->sd_log_num_revoke);\n\n\tgfs2_log_write_page(sdp, page);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_write_page",
          "args": [
            "sdp",
            "page"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_write_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "371-375",
          "snippet": "void gfs2_log_write_page(struct gfs2_sbd *sdp, struct page *page)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tgfs2_log_write(sdp, page, sb->s_blocksize, 0);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_log_write_page(struct gfs2_sbd *sdp, struct page *page)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tgfs2_log_write(sdp, page, sb->s_blocksize, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_assert_withdraw",
          "args": [
            "sdp",
            "!sdp->sd_log_num_revoke"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "bd->bd_blkno"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_FORMAT_LB"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_METATYPE_LB"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_MAGIC"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_page",
          "args": [
            "mh"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "__clear_page_buffers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "123-129",
          "snippet": "static void\n__clear_page_buffers(struct page *page)\n{\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nstatic void\n__clear_page_buffers(struct page *page)\n{\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_cache_release(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mempool_alloc",
          "args": [
            "gfs2_page_pool",
            "GFP_NOIO"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "bd",
            "head",
            "bd_list"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_get_log_desc",
          "args": [
            "sdp",
            "GFS2_LOG_DESC_REVOKE",
            "length",
            "sdp->sd_log_num_revoke"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_get_log_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "377-391",
          "snippet": "static struct page *gfs2_get_log_desc(struct gfs2_sbd *sdp, u32 ld_type,\n\t\t\t\t      u32 ld_length, u32 ld_data1)\n{\n\tstruct page *page = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\tstruct gfs2_log_descriptor *ld = page_address(page);\n\tclear_page(ld);\n\tld->ld_header.mh_magic = cpu_to_be32(GFS2_MAGIC);\n\tld->ld_header.mh_type = cpu_to_be32(GFS2_METATYPE_LD);\n\tld->ld_header.mh_format = cpu_to_be32(GFS2_FORMAT_LD);\n\tld->ld_type = cpu_to_be32(ld_type);\n\tld->ld_length = cpu_to_be32(ld_length);\n\tld->ld_data1 = cpu_to_be32(ld_data1);\n\tld->ld_data2 = 0;\n\treturn page;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct page *gfs2_get_log_desc(struct gfs2_sbd *sdp, u32 ld_type,\n\t\t\t\t      u32 ld_length, u32 ld_data1)\n{\n\tstruct page *page = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\tstruct gfs2_log_descriptor *ld = page_address(page);\n\tclear_page(ld);\n\tld->ld_header.mh_magic = cpu_to_be32(GFS2_MAGIC);\n\tld->ld_header.mh_type = cpu_to_be32(GFS2_METATYPE_LD);\n\tld->ld_header.mh_format = cpu_to_be32(GFS2_FORMAT_LD);\n\tld->ld_type = cpu_to_be32(ld_type);\n\tld->ld_length = cpu_to_be32(ld_length);\n\tld->ld_data1 = cpu_to_be32(ld_data1);\n\tld->ld_data2 = 0;\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_struct2blk",
          "args": [
            "sdp",
            "sdp->sd_log_num_revoke",
            "sizeof(u64)"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_struct2blk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/log.c",
          "lines": "48-64",
          "snippet": "unsigned int gfs2_struct2blk(struct gfs2_sbd *sdp, unsigned int nstruct,\n\t\t\t     unsigned int ssize)\n{\n\tunsigned int blks;\n\tunsigned int first, second;\n\n\tblks = 1;\n\tfirst = (sdp->sd_sb.sb_bsize - sizeof(struct gfs2_log_descriptor)) / ssize;\n\n\tif (nstruct > first) {\n\t\tsecond = (sdp->sd_sb.sb_bsize -\n\t\t\t  sizeof(struct gfs2_meta_header)) / ssize;\n\t\tblks += DIV_ROUND_UP(nstruct - first, second);\n\t}\n\n\treturn blks;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/writeback.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/delay.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"dir.h\"\n#include \"util.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/writeback.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/delay.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nunsigned int gfs2_struct2blk(struct gfs2_sbd *sdp, unsigned int nstruct,\n\t\t\t     unsigned int ssize)\n{\n\tunsigned int blks;\n\tunsigned int first, second;\n\n\tblks = 1;\n\tfirst = (sdp->sd_sb.sb_bsize - sizeof(struct gfs2_log_descriptor)) / ssize;\n\n\tif (nstruct > first) {\n\t\tsecond = (sdp->sd_sb.sb_bsize -\n\t\t\t  sizeof(struct gfs2_meta_header)) / ssize;\n\t\tblks += DIV_ROUND_UP(nstruct - first, second);\n\t}\n\n\treturn blks;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_write_revokes",
          "args": [
            "sdp"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_write_revokes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/log.c",
          "lines": "594-646",
          "snippet": "void gfs2_write_revokes(struct gfs2_sbd *sdp)\n{\n\tstruct gfs2_trans *tr;\n\tstruct gfs2_bufdata *bd, *tmp;\n\tint have_revokes = 0;\n\tint max_revokes = (sdp->sd_sb.sb_bsize - sizeof(struct gfs2_log_descriptor)) / sizeof(u64);\n\n\tgfs2_ail1_empty(sdp);\n\tspin_lock(&sdp->sd_ail_lock);\n\tlist_for_each_entry(tr, &sdp->sd_ail1_list, tr_list) {\n\t\tlist_for_each_entry(bd, &tr->tr_ail2_list, bd_ail_st_list) {\n\t\t\tif (list_empty(&bd->bd_list)) {\n\t\t\t\thave_revokes = 1;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock(&sdp->sd_ail_lock);\n\tif (have_revokes == 0)\n\t\treturn;\n\twhile (sdp->sd_log_num_revoke > max_revokes)\n\t\tmax_revokes += (sdp->sd_sb.sb_bsize - sizeof(struct gfs2_meta_header)) / sizeof(u64);\n\tmax_revokes -= sdp->sd_log_num_revoke;\n\tif (!sdp->sd_log_num_revoke) {\n\t\tatomic_dec(&sdp->sd_log_blks_free);\n\t\t/* If no blocks have been reserved, we need to also\n\t\t * reserve a block for the header */\n\t\tif (!sdp->sd_log_blks_reserved)\n\t\t\tatomic_dec(&sdp->sd_log_blks_free);\n\t}\n\tgfs2_log_lock(sdp);\n\tspin_lock(&sdp->sd_ail_lock);\n\tlist_for_each_entry(tr, &sdp->sd_ail1_list, tr_list) {\n\t\tlist_for_each_entry_safe(bd, tmp, &tr->tr_ail2_list, bd_ail_st_list) {\n\t\t\tif (max_revokes == 0)\n\t\t\t\tgoto out_of_blocks;\n\t\t\tif (!list_empty(&bd->bd_list))\n\t\t\t\tcontinue;\n\t\t\tgfs2_add_revoke(sdp, bd);\n\t\t\tmax_revokes--;\n\t\t}\n\t}\nout_of_blocks:\n\tspin_unlock(&sdp->sd_ail_lock);\n\tgfs2_log_unlock(sdp);\n\n\tif (!sdp->sd_log_num_revoke) {\n\t\tatomic_inc(&sdp->sd_log_blks_free);\n\t\tif (!sdp->sd_log_blks_reserved)\n\t\t\tatomic_inc(&sdp->sd_log_blks_free);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/writeback.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/delay.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"dir.h\"\n#include \"util.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/writeback.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/delay.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_write_revokes(struct gfs2_sbd *sdp)\n{\n\tstruct gfs2_trans *tr;\n\tstruct gfs2_bufdata *bd, *tmp;\n\tint have_revokes = 0;\n\tint max_revokes = (sdp->sd_sb.sb_bsize - sizeof(struct gfs2_log_descriptor)) / sizeof(u64);\n\n\tgfs2_ail1_empty(sdp);\n\tspin_lock(&sdp->sd_ail_lock);\n\tlist_for_each_entry(tr, &sdp->sd_ail1_list, tr_list) {\n\t\tlist_for_each_entry(bd, &tr->tr_ail2_list, bd_ail_st_list) {\n\t\t\tif (list_empty(&bd->bd_list)) {\n\t\t\t\thave_revokes = 1;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock(&sdp->sd_ail_lock);\n\tif (have_revokes == 0)\n\t\treturn;\n\twhile (sdp->sd_log_num_revoke > max_revokes)\n\t\tmax_revokes += (sdp->sd_sb.sb_bsize - sizeof(struct gfs2_meta_header)) / sizeof(u64);\n\tmax_revokes -= sdp->sd_log_num_revoke;\n\tif (!sdp->sd_log_num_revoke) {\n\t\tatomic_dec(&sdp->sd_log_blks_free);\n\t\t/* If no blocks have been reserved, we need to also\n\t\t * reserve a block for the header */\n\t\tif (!sdp->sd_log_blks_reserved)\n\t\t\tatomic_dec(&sdp->sd_log_blks_free);\n\t}\n\tgfs2_log_lock(sdp);\n\tspin_lock(&sdp->sd_ail_lock);\n\tlist_for_each_entry(tr, &sdp->sd_ail1_list, tr_list) {\n\t\tlist_for_each_entry_safe(bd, tmp, &tr->tr_ail2_list, bd_ail_st_list) {\n\t\t\tif (max_revokes == 0)\n\t\t\t\tgoto out_of_blocks;\n\t\t\tif (!list_empty(&bd->bd_list))\n\t\t\t\tcontinue;\n\t\t\tgfs2_add_revoke(sdp, bd);\n\t\t\tmax_revokes--;\n\t\t}\n\t}\nout_of_blocks:\n\tspin_unlock(&sdp->sd_ail_lock);\n\tgfs2_log_unlock(sdp);\n\n\tif (!sdp->sd_log_num_revoke) {\n\t\tatomic_inc(&sdp->sd_log_blks_free);\n\t\tif (!sdp->sd_log_blks_reserved)\n\t\t\tatomic_inc(&sdp->sd_log_blks_free);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void revoke_lo_before_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct gfs2_meta_header *mh;\n\tunsigned int offset;\n\tstruct list_head *head = &sdp->sd_log_le_revoke;\n\tstruct gfs2_bufdata *bd;\n\tstruct page *page;\n\tunsigned int length;\n\n\tgfs2_write_revokes(sdp);\n\tif (!sdp->sd_log_num_revoke)\n\t\treturn;\n\n\tlength = gfs2_struct2blk(sdp, sdp->sd_log_num_revoke, sizeof(u64));\n\tpage = gfs2_get_log_desc(sdp, GFS2_LOG_DESC_REVOKE, length, sdp->sd_log_num_revoke);\n\toffset = sizeof(struct gfs2_log_descriptor);\n\n\tlist_for_each_entry(bd, head, bd_list) {\n\t\tsdp->sd_log_num_revoke--;\n\n\t\tif (offset + sizeof(u64) > sdp->sd_sb.sb_bsize) {\n\n\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\tmh = page_address(page);\n\t\t\tclear_page(mh);\n\t\t\tmh->mh_magic = cpu_to_be32(GFS2_MAGIC);\n\t\t\tmh->mh_type = cpu_to_be32(GFS2_METATYPE_LB);\n\t\t\tmh->mh_format = cpu_to_be32(GFS2_FORMAT_LB);\n\t\t\toffset = sizeof(struct gfs2_meta_header);\n\t\t}\n\n\t\t*(__be64 *)(page_address(page) + offset) = cpu_to_be64(bd->bd_blkno);\n\t\toffset += sizeof(u64);\n\t}\n\tgfs2_assert_withdraw(sdp, !sdp->sd_log_num_revoke);\n\n\tgfs2_log_write_page(sdp, page);\n}"
  },
  {
    "function_name": "buf_lo_after_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "601-617",
    "snippet": "static void buf_lo_after_scan(struct gfs2_jdesc *jd, int error, int pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\n\tif (error) {\n\t\tgfs2_meta_sync(ip->i_gl);\n\t\treturn;\n\t}\n\tif (pass != 1)\n\t\treturn;\n\n\tgfs2_meta_sync(ip->i_gl);\n\n\tfs_info(sdp, \"jid=%u: Replayed %u of %u blocks\\n\",\n\t        jd->jd_jid, jd->jd_replayed_blocks, jd->jd_found_blocks);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs_info",
          "args": [
            "sdp",
            "\"jid=%u: Replayed %u of %u blocks\\n\"",
            "jd->jd_jid",
            "jd->jd_replayed_blocks",
            "jd->jd_found_blocks"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "280-288",
          "snippet": "void reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid reiserfs_info(struct super_block *sb, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_NOTICE \"REISERFS (device %s): %s\",\n\t\t       sb->s_id, error_buf);\n\telse\n\t\tprintk(KERN_NOTICE \"REISERFS %s:\", error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_meta_sync",
          "args": [
            "ip->i_gl"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "585-599",
          "snippet": "static void gfs2_meta_sync(struct gfs2_glock *gl)\n{\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error;\n\n\tif (mapping == NULL)\n\t\tmapping = &sdp->sd_aspace;\n\n\tfilemap_fdatawrite(mapping);\n\terror = filemap_fdatawait(mapping);\n\n\tif (error)\n\t\tgfs2_io_error(gl->gl_sbd);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_meta_sync(struct gfs2_glock *gl)\n{\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error;\n\n\tif (mapping == NULL)\n\t\tmapping = &sdp->sd_aspace;\n\n\tfilemap_fdatawrite(mapping);\n\terror = filemap_fdatawait(mapping);\n\n\tif (error)\n\t\tgfs2_io_error(gl->gl_sbd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "jd->jd_inode"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "jd->jd_inode"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void buf_lo_after_scan(struct gfs2_jdesc *jd, int error, int pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\n\tif (error) {\n\t\tgfs2_meta_sync(ip->i_gl);\n\t\treturn;\n\t}\n\tif (pass != 1)\n\t\treturn;\n\n\tgfs2_meta_sync(ip->i_gl);\n\n\tfs_info(sdp, \"jid=%u: Replayed %u of %u blocks\\n\",\n\t        jd->jd_jid, jd->jd_replayed_blocks, jd->jd_found_blocks);\n}"
  },
  {
    "function_name": "gfs2_meta_sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "585-599",
    "snippet": "static void gfs2_meta_sync(struct gfs2_glock *gl)\n{\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error;\n\n\tif (mapping == NULL)\n\t\tmapping = &sdp->sd_aspace;\n\n\tfilemap_fdatawrite(mapping);\n\terror = filemap_fdatawait(mapping);\n\n\tif (error)\n\t\tgfs2_io_error(gl->gl_sbd);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_io_error",
          "args": [
            "gl->gl_sbd"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filemap_fdatawait",
          "args": [
            "mapping"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filemap_fdatawrite",
          "args": [
            "mapping"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock2aspace",
          "args": [
            "gl"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock2aspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.h",
          "lines": "174-179",
          "snippet": "static inline struct address_space *gfs2_glock2aspace(struct gfs2_glock *gl)\n{\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE)\n\t\treturn (struct address_space *)(gl + 1);\n\treturn NULL;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/parser.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/parser.h>\n#include <linux/sched.h>\n\nstatic inline struct address_space *gfs2_glock2aspace(struct gfs2_glock *gl)\n{\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE)\n\t\treturn (struct address_space *)(gl + 1);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_meta_sync(struct gfs2_glock *gl)\n{\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error;\n\n\tif (mapping == NULL)\n\t\tmapping = &sdp->sd_aspace;\n\n\tfilemap_fdatawrite(mapping);\n\terror = filemap_fdatawait(mapping);\n\n\tif (error)\n\t\tgfs2_io_error(gl->gl_sbd);\n}"
  },
  {
    "function_name": "buf_lo_scan_elements",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "530-577",
    "snippet": "static int buf_lo_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\tstruct gfs2_log_descriptor *ld, __be64 *ptr,\n\t\t\t\tint pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tunsigned int blks = be32_to_cpu(ld->ld_data1);\n\tstruct buffer_head *bh_log, *bh_ip;\n\tu64 blkno;\n\tint error = 0;\n\n\tif (pass != 1 || be32_to_cpu(ld->ld_type) != GFS2_LOG_DESC_METADATA)\n\t\treturn 0;\n\n\tgfs2_replay_incr_blk(sdp, &start);\n\n\tfor (; blks; gfs2_replay_incr_blk(sdp, &start), blks--) {\n\t\tblkno = be64_to_cpu(*ptr++);\n\n\t\tjd->jd_found_blocks++;\n\n\t\tif (gfs2_revoke_check(jd, blkno, start))\n\t\t\tcontinue;\n\n\t\terror = gfs2_replay_read_block(jd, start, &bh_log);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tbh_ip = gfs2_meta_new(gl, blkno);\n\t\tmemcpy(bh_ip->b_data, bh_log->b_data, bh_log->b_size);\n\n\t\tif (gfs2_meta_check(sdp, bh_ip))\n\t\t\terror = -EIO;\n\t\telse\n\t\t\tmark_buffer_dirty(bh_ip);\n\n\t\tbrelse(bh_log);\n\t\tbrelse(bh_ip);\n\n\t\tif (error)\n\t\t\tbreak;\n\n\t\tjd->jd_replayed_blocks++;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh_ip"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh_ip"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_meta_check",
          "args": [
            "sdp",
            "bh_ip"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.h",
          "lines": "83-94",
          "snippet": "static inline int gfs2_meta_check(struct gfs2_sbd *sdp,\n\t\t\t\t    struct buffer_head *bh)\n{\n\tstruct gfs2_meta_header *mh = (struct gfs2_meta_header *)bh->b_data;\n\tu32 magic = be32_to_cpu(mh->mh_magic);\n\tif (unlikely(magic != GFS2_MAGIC)) {\n\t\tpr_err(\"Magic number missing at %llu\\n\",\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/mempool.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/mempool.h>\n\nstatic inline int gfs2_meta_check(struct gfs2_sbd *sdp,\n\t\t\t\t    struct buffer_head *bh)\n{\n\tstruct gfs2_meta_header *mh = (struct gfs2_meta_header *)bh->b_data;\n\tu32 magic = be32_to_cpu(mh->mh_magic);\n\tif (unlikely(magic != GFS2_MAGIC)) {\n\t\tpr_err(\"Magic number missing at %llu\\n\",\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn -EIO;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "bh_ip->b_data",
            "bh_log->b_data",
            "bh_log->b_size"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_meta_new",
          "args": [
            "gl",
            "blkno"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.c",
          "lines": "182-188",
          "snippet": "struct buffer_head *gfs2_meta_new(struct gfs2_glock *gl, u64 blkno)\n{\n\tstruct buffer_head *bh;\n\tbh = gfs2_getbuf(gl, blkno, CREATE);\n\tmeta_prep_new(bh);\n\treturn bh;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/delay.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/delay.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstruct buffer_head *gfs2_meta_new(struct gfs2_glock *gl, u64 blkno)\n{\n\tstruct buffer_head *bh;\n\tbh = gfs2_getbuf(gl, blkno, CREATE);\n\tmeta_prep_new(bh);\n\treturn bh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_replay_read_block",
          "args": [
            "jd",
            "start",
            "&bh_log"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_replay_read_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "32-53",
          "snippet": "int gfs2_replay_read_block(struct gfs2_jdesc *jd, unsigned int blk,\n\t\t\t   struct buffer_head **bh)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint new = 0;\n\tu64 dblock;\n\tu32 extlen;\n\tint error;\n\n\terror = gfs2_extent_map(&ip->i_inode, blk, &new, &dblock, &extlen);\n\tif (error)\n\t\treturn error;\n\tif (!dblock) {\n\t\tgfs2_consist_inode(ip);\n\t\treturn -EIO;\n\t}\n\n\t*bh = gfs2_meta_ra(gl, dblock, extlen);\n\n\treturn error;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nint gfs2_replay_read_block(struct gfs2_jdesc *jd, unsigned int blk,\n\t\t\t   struct buffer_head **bh)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint new = 0;\n\tu64 dblock;\n\tu32 extlen;\n\tint error;\n\n\terror = gfs2_extent_map(&ip->i_inode, blk, &new, &dblock, &extlen);\n\tif (error)\n\t\treturn error;\n\tif (!dblock) {\n\t\tgfs2_consist_inode(ip);\n\t\treturn -EIO;\n\t}\n\n\t*bh = gfs2_meta_ra(gl, dblock, extlen);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_revoke_check",
          "args": [
            "jd",
            "blkno",
            "start"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_revoke_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "84-106",
          "snippet": "int gfs2_revoke_check(struct gfs2_jdesc *jd, u64 blkno, unsigned int where)\n{\n\tstruct gfs2_revoke_replay *rr;\n\tint wrap, a, b, revoke;\n\tint found = 0;\n\n\tlist_for_each_entry(rr, &jd->jd_revoke_list, rr_list) {\n\t\tif (rr->rr_blkno == blkno) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn 0;\n\n\twrap = (rr->rr_where < jd->jd_replay_tail);\n\ta = (jd->jd_replay_tail < where);\n\tb = (where < rr->rr_where);\n\trevoke = (wrap) ? (a || b) : (a && b);\n\n\treturn revoke;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nint gfs2_revoke_check(struct gfs2_jdesc *jd, u64 blkno, unsigned int where)\n{\n\tstruct gfs2_revoke_replay *rr;\n\tint wrap, a, b, revoke;\n\tint found = 0;\n\n\tlist_for_each_entry(rr, &jd->jd_revoke_list, rr_list) {\n\t\tif (rr->rr_blkno == blkno) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!found)\n\t\treturn 0;\n\n\twrap = (rr->rr_where < jd->jd_replay_tail);\n\ta = (jd->jd_replay_tail < where);\n\tb = (where < rr->rr_where);\n\trevoke = (wrap) ? (a || b) : (a && b);\n\n\treturn revoke;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "*ptr++"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_replay_incr_blk",
          "args": [
            "sdp",
            "&start"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_replay_incr_blk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.h",
          "lines": "17-21",
          "snippet": "static inline void gfs2_replay_incr_blk(struct gfs2_sbd *sdp, unsigned int *blk)\n{\n\tif (++*blk == sdp->sd_jdesc->jd_blocks)\n\t        *blk = 0;\n}",
          "includes": [
            "#include \"incore.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n\nstatic inline void gfs2_replay_incr_blk(struct gfs2_sbd *sdp, unsigned int *blk)\n{\n\tif (++*blk == sdp->sd_jdesc->jd_blocks)\n\t        *blk = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_type"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "ld->ld_data1"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "jd->jd_inode"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "jd->jd_inode"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int buf_lo_scan_elements(struct gfs2_jdesc *jd, unsigned int start,\n\t\t\t\tstruct gfs2_log_descriptor *ld, __be64 *ptr,\n\t\t\t\tint pass)\n{\n\tstruct gfs2_inode *ip = GFS2_I(jd->jd_inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(jd->jd_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tunsigned int blks = be32_to_cpu(ld->ld_data1);\n\tstruct buffer_head *bh_log, *bh_ip;\n\tu64 blkno;\n\tint error = 0;\n\n\tif (pass != 1 || be32_to_cpu(ld->ld_type) != GFS2_LOG_DESC_METADATA)\n\t\treturn 0;\n\n\tgfs2_replay_incr_blk(sdp, &start);\n\n\tfor (; blks; gfs2_replay_incr_blk(sdp, &start), blks--) {\n\t\tblkno = be64_to_cpu(*ptr++);\n\n\t\tjd->jd_found_blocks++;\n\n\t\tif (gfs2_revoke_check(jd, blkno, start))\n\t\t\tcontinue;\n\n\t\terror = gfs2_replay_read_block(jd, start, &bh_log);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tbh_ip = gfs2_meta_new(gl, blkno);\n\t\tmemcpy(bh_ip->b_data, bh_log->b_data, bh_log->b_size);\n\n\t\tif (gfs2_meta_check(sdp, bh_ip))\n\t\t\terror = -EIO;\n\t\telse\n\t\t\tmark_buffer_dirty(bh_ip);\n\n\t\tbrelse(bh_log);\n\t\tbrelse(bh_ip);\n\n\t\tif (error)\n\t\t\tbreak;\n\n\t\tjd->jd_replayed_blocks++;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "buf_lo_before_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "520-528",
    "snippet": "static void buf_lo_before_scan(struct gfs2_jdesc *jd,\n\t\t\t       struct gfs2_log_header_host *head, int pass)\n{\n\tif (pass != 0)\n\t\treturn;\n\n\tjd->jd_found_blocks = 0;\n\tjd->jd_replayed_blocks = 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void buf_lo_before_scan(struct gfs2_jdesc *jd,\n\t\t\t       struct gfs2_log_header_host *head, int pass)\n{\n\tif (pass != 0)\n\t\treturn;\n\n\tjd->jd_found_blocks = 0;\n\tjd->jd_replayed_blocks = 0;\n}"
  },
  {
    "function_name": "buf_lo_after_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "504-518",
    "snippet": "static void buf_lo_after_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct list_head *head;\n\tstruct gfs2_bufdata *bd;\n\n\tif (tr == NULL)\n\t\treturn;\n\n\thead = &tr->tr_buf;\n\twhile (!list_empty(head)) {\n\t\tbd = list_entry(head->next, struct gfs2_bufdata, bd_list);\n\t\tlist_del_init(&bd->bd_list);\n\t\tgfs2_unpin(sdp, bd->bd_bh, tr);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_unpin",
          "args": [
            "sdp",
            "bd->bd_bh",
            "tr"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_unpin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "98-130",
          "snippet": "static void gfs2_unpin(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       struct gfs2_trans *tr)\n{\n\tstruct gfs2_bufdata *bd = bh->b_private;\n\n\tBUG_ON(!buffer_uptodate(bh));\n\tBUG_ON(!buffer_pinned(bh));\n\n\tlock_buffer(bh);\n\tmark_buffer_dirty(bh);\n\tclear_buffer_pinned(bh);\n\n\tif (buffer_is_rgrp(bd))\n\t\tmaybe_release_space(bd);\n\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr) {\n\t\tlist_del(&bd->bd_ail_st_list);\n\t\tbrelse(bh);\n\t} else {\n\t\tstruct gfs2_glock *gl = bd->bd_gl;\n\t\tlist_add(&bd->bd_ail_gl_list, &gl->gl_ail_list);\n\t\tatomic_inc(&gl->gl_ail_count);\n\t}\n\tbd->bd_tr = tr;\n\tlist_add(&bd->bd_ail_st_list, &tr->tr_ail1_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\n\tclear_bit(GLF_LFLUSH, &bd->bd_gl->gl_flags);\n\ttrace_gfs2_pin(bd, 0);\n\tunlock_buffer(bh);\n\tatomic_dec(&sdp->sd_log_pinned);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_unpin(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       struct gfs2_trans *tr)\n{\n\tstruct gfs2_bufdata *bd = bh->b_private;\n\n\tBUG_ON(!buffer_uptodate(bh));\n\tBUG_ON(!buffer_pinned(bh));\n\n\tlock_buffer(bh);\n\tmark_buffer_dirty(bh);\n\tclear_buffer_pinned(bh);\n\n\tif (buffer_is_rgrp(bd))\n\t\tmaybe_release_space(bd);\n\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr) {\n\t\tlist_del(&bd->bd_ail_st_list);\n\t\tbrelse(bh);\n\t} else {\n\t\tstruct gfs2_glock *gl = bd->bd_gl;\n\t\tlist_add(&bd->bd_ail_gl_list, &gl->gl_ail_list);\n\t\tatomic_inc(&gl->gl_ail_count);\n\t}\n\tbd->bd_tr = tr;\n\tlist_add(&bd->bd_ail_st_list, &tr->tr_ail1_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\n\tclear_bit(GLF_LFLUSH, &bd->bd_gl->gl_flags);\n\ttrace_gfs2_pin(bd, 0);\n\tunlock_buffer(bh);\n\tatomic_dec(&sdp->sd_log_pinned);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&bd->bd_list"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "head->next",
            "structgfs2_bufdata",
            "bd_list"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "head"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void buf_lo_after_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tstruct list_head *head;\n\tstruct gfs2_bufdata *bd;\n\n\tif (tr == NULL)\n\t\treturn;\n\n\thead = &tr->tr_buf;\n\twhile (!list_empty(head)) {\n\t\tbd = list_entry(head->next, struct gfs2_bufdata, bd_list);\n\t\tlist_del_init(&bd->bd_list);\n\t\tgfs2_unpin(sdp, bd->bd_bh, tr);\n\t}\n}"
  },
  {
    "function_name": "buf_lo_before_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "494-502",
    "snippet": "static void buf_lo_before_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tunsigned int limit = buf_limit(sdp); /* 503 for 4k blocks */\n\tunsigned int nbuf;\n\tif (tr == NULL)\n\t\treturn;\n\tnbuf = tr->tr_num_buf_new - tr->tr_num_buf_rm;\n\tgfs2_before_commit(sdp, limit, nbuf, &tr->tr_buf, 0);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_before_commit",
          "args": [
            "sdp",
            "limit",
            "nbuf",
            "&tr->tr_buf",
            "0"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_before_commit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "420-492",
          "snippet": "static void gfs2_before_commit(struct gfs2_sbd *sdp, unsigned int limit,\n\t\t\t\tunsigned int total, struct list_head *blist,\n\t\t\t\tbool is_databuf)\n{\n\tstruct gfs2_log_descriptor *ld;\n\tstruct gfs2_bufdata *bd1 = NULL, *bd2;\n\tstruct page *page;\n\tunsigned int num;\n\tunsigned n;\n\t__be64 *ptr;\n\n\tgfs2_log_lock(sdp);\n\tlist_sort(NULL, blist, blocknr_cmp);\n\tbd1 = bd2 = list_prepare_entry(bd1, blist, bd_list);\n\twhile(total) {\n\t\tnum = total;\n\t\tif (total > limit)\n\t\t\tnum = limit;\n\t\tgfs2_log_unlock(sdp);\n\t\tpage = gfs2_get_log_desc(sdp,\n\t\t\t\t\t is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA, num + 1, num);\n\t\tld = page_address(page);\n\t\tgfs2_log_lock(sdp);\n\t\tptr = (__be64 *)(ld + 1);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd1, blist, bd_list) {\n\t\t\t*ptr++ = cpu_to_be64(bd1->bd_bh->b_blocknr);\n\t\t\tif (is_databuf) {\n\t\t\t\tgfs2_check_magic(bd1->bd_bh);\n\t\t\t\t*ptr++ = cpu_to_be64(buffer_escaped(bd1->bd_bh) ? 1 : 0);\n\t\t\t}\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tgfs2_log_unlock(sdp);\n\t\tgfs2_log_write_page(sdp, page);\n\t\tgfs2_log_lock(sdp);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd2, blist, bd_list) {\n\t\t\tget_bh(bd2->bd_bh);\n\t\t\tgfs2_log_unlock(sdp);\n\t\t\tlock_buffer(bd2->bd_bh);\n\n\t\t\tif (buffer_escaped(bd2->bd_bh)) {\n\t\t\t\tvoid *kaddr;\n\t\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\t\tptr = page_address(page);\n\t\t\t\tkaddr = kmap_atomic(bd2->bd_bh->b_page);\n\t\t\t\tmemcpy(ptr, kaddr + bh_offset(bd2->bd_bh),\n\t\t\t\t       bd2->bd_bh->b_size);\n\t\t\t\tkunmap_atomic(kaddr);\n\t\t\t\t*(__be32 *)ptr = 0;\n\t\t\t\tclear_buffer_escaped(bd2->bd_bh);\n\t\t\t\tunlock_buffer(bd2->bd_bh);\n\t\t\t\tbrelse(bd2->bd_bh);\n\t\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\t} else {\n\t\t\t\tgfs2_log_write_bh(sdp, bd2->bd_bh);\n\t\t\t}\n\t\t\tgfs2_log_lock(sdp);\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tBUG_ON(total < num);\n\t\ttotal -= num;\n\t}\n\tgfs2_log_unlock(sdp);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_before_commit(struct gfs2_sbd *sdp, unsigned int limit,\n\t\t\t\tunsigned int total, struct list_head *blist,\n\t\t\t\tbool is_databuf)\n{\n\tstruct gfs2_log_descriptor *ld;\n\tstruct gfs2_bufdata *bd1 = NULL, *bd2;\n\tstruct page *page;\n\tunsigned int num;\n\tunsigned n;\n\t__be64 *ptr;\n\n\tgfs2_log_lock(sdp);\n\tlist_sort(NULL, blist, blocknr_cmp);\n\tbd1 = bd2 = list_prepare_entry(bd1, blist, bd_list);\n\twhile(total) {\n\t\tnum = total;\n\t\tif (total > limit)\n\t\t\tnum = limit;\n\t\tgfs2_log_unlock(sdp);\n\t\tpage = gfs2_get_log_desc(sdp,\n\t\t\t\t\t is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA, num + 1, num);\n\t\tld = page_address(page);\n\t\tgfs2_log_lock(sdp);\n\t\tptr = (__be64 *)(ld + 1);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd1, blist, bd_list) {\n\t\t\t*ptr++ = cpu_to_be64(bd1->bd_bh->b_blocknr);\n\t\t\tif (is_databuf) {\n\t\t\t\tgfs2_check_magic(bd1->bd_bh);\n\t\t\t\t*ptr++ = cpu_to_be64(buffer_escaped(bd1->bd_bh) ? 1 : 0);\n\t\t\t}\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tgfs2_log_unlock(sdp);\n\t\tgfs2_log_write_page(sdp, page);\n\t\tgfs2_log_lock(sdp);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd2, blist, bd_list) {\n\t\t\tget_bh(bd2->bd_bh);\n\t\t\tgfs2_log_unlock(sdp);\n\t\t\tlock_buffer(bd2->bd_bh);\n\n\t\t\tif (buffer_escaped(bd2->bd_bh)) {\n\t\t\t\tvoid *kaddr;\n\t\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\t\tptr = page_address(page);\n\t\t\t\tkaddr = kmap_atomic(bd2->bd_bh->b_page);\n\t\t\t\tmemcpy(ptr, kaddr + bh_offset(bd2->bd_bh),\n\t\t\t\t       bd2->bd_bh->b_size);\n\t\t\t\tkunmap_atomic(kaddr);\n\t\t\t\t*(__be32 *)ptr = 0;\n\t\t\t\tclear_buffer_escaped(bd2->bd_bh);\n\t\t\t\tunlock_buffer(bd2->bd_bh);\n\t\t\t\tbrelse(bd2->bd_bh);\n\t\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\t} else {\n\t\t\t\tgfs2_log_write_bh(sdp, bd2->bd_bh);\n\t\t\t}\n\t\t\tgfs2_log_lock(sdp);\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tBUG_ON(total < num);\n\t\ttotal -= num;\n\t}\n\tgfs2_log_unlock(sdp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buf_limit",
          "args": [
            "sdp"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "databuf_limit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.h",
          "lines": "41-47",
          "snippet": "static inline unsigned int databuf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - DATABUF_OFFSET) / (2 * sizeof(__be64));\n\treturn limit;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/list.h>"
          ],
          "macros_used": [
            "#define DATABUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + (2 * sizeof(__be64) - 1)) & \\\n\t ~(2 * sizeof(__be64) - 1))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/list.h>\n\n#define DATABUF_OFFSET \\\n\t((sizeof(struct gfs2_log_descriptor) + (2 * sizeof(__be64) - 1)) & \\\n\t ~(2 * sizeof(__be64) - 1))\n\nstatic inline unsigned int databuf_limit(struct gfs2_sbd *sdp)\n{\n\tunsigned int limit;\n\n\tlimit = (sdp->sd_sb.sb_bsize - DATABUF_OFFSET) / (2 * sizeof(__be64));\n\treturn limit;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void buf_lo_before_commit(struct gfs2_sbd *sdp, struct gfs2_trans *tr)\n{\n\tunsigned int limit = buf_limit(sdp); /* 503 for 4k blocks */\n\tunsigned int nbuf;\n\tif (tr == NULL)\n\t\treturn;\n\tnbuf = tr->tr_num_buf_new - tr->tr_num_buf_rm;\n\tgfs2_before_commit(sdp, limit, nbuf, &tr->tr_buf, 0);\n}"
  },
  {
    "function_name": "gfs2_before_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "420-492",
    "snippet": "static void gfs2_before_commit(struct gfs2_sbd *sdp, unsigned int limit,\n\t\t\t\tunsigned int total, struct list_head *blist,\n\t\t\t\tbool is_databuf)\n{\n\tstruct gfs2_log_descriptor *ld;\n\tstruct gfs2_bufdata *bd1 = NULL, *bd2;\n\tstruct page *page;\n\tunsigned int num;\n\tunsigned n;\n\t__be64 *ptr;\n\n\tgfs2_log_lock(sdp);\n\tlist_sort(NULL, blist, blocknr_cmp);\n\tbd1 = bd2 = list_prepare_entry(bd1, blist, bd_list);\n\twhile(total) {\n\t\tnum = total;\n\t\tif (total > limit)\n\t\t\tnum = limit;\n\t\tgfs2_log_unlock(sdp);\n\t\tpage = gfs2_get_log_desc(sdp,\n\t\t\t\t\t is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA, num + 1, num);\n\t\tld = page_address(page);\n\t\tgfs2_log_lock(sdp);\n\t\tptr = (__be64 *)(ld + 1);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd1, blist, bd_list) {\n\t\t\t*ptr++ = cpu_to_be64(bd1->bd_bh->b_blocknr);\n\t\t\tif (is_databuf) {\n\t\t\t\tgfs2_check_magic(bd1->bd_bh);\n\t\t\t\t*ptr++ = cpu_to_be64(buffer_escaped(bd1->bd_bh) ? 1 : 0);\n\t\t\t}\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tgfs2_log_unlock(sdp);\n\t\tgfs2_log_write_page(sdp, page);\n\t\tgfs2_log_lock(sdp);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd2, blist, bd_list) {\n\t\t\tget_bh(bd2->bd_bh);\n\t\t\tgfs2_log_unlock(sdp);\n\t\t\tlock_buffer(bd2->bd_bh);\n\n\t\t\tif (buffer_escaped(bd2->bd_bh)) {\n\t\t\t\tvoid *kaddr;\n\t\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\t\tptr = page_address(page);\n\t\t\t\tkaddr = kmap_atomic(bd2->bd_bh->b_page);\n\t\t\t\tmemcpy(ptr, kaddr + bh_offset(bd2->bd_bh),\n\t\t\t\t       bd2->bd_bh->b_size);\n\t\t\t\tkunmap_atomic(kaddr);\n\t\t\t\t*(__be32 *)ptr = 0;\n\t\t\t\tclear_buffer_escaped(bd2->bd_bh);\n\t\t\t\tunlock_buffer(bd2->bd_bh);\n\t\t\t\tbrelse(bd2->bd_bh);\n\t\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\t} else {\n\t\t\t\tgfs2_log_write_bh(sdp, bd2->bd_bh);\n\t\t\t}\n\t\t\tgfs2_log_lock(sdp);\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tBUG_ON(total < num);\n\t\ttotal -= num;\n\t}\n\tgfs2_log_unlock(sdp);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_unlock",
          "args": [
            "sdp"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/log.h",
          "lines": "36-40",
          "snippet": "static inline void gfs2_log_unlock(struct gfs2_sbd *sdp)\n__releases(&sdp->sd_log_lock)\n{\n\tspin_unlock(&sdp->sd_log_lock);\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/writeback.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/writeback.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic inline void gfs2_log_unlock(struct gfs2_sbd *sdp)\n__releases(&sdp->sd_log_lock)\n{\n\tspin_unlock(&sdp->sd_log_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "total < num"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_log_lock",
          "args": [
            "sdp"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/log.h",
          "lines": "24-28",
          "snippet": "static inline void gfs2_log_lock(struct gfs2_sbd *sdp)\n__acquires(&sdp->sd_log_lock)\n{\n\tspin_lock(&sdp->sd_log_lock);\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/writeback.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/writeback.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic inline void gfs2_log_lock(struct gfs2_sbd *sdp)\n__acquires(&sdp->sd_log_lock)\n{\n\tspin_lock(&sdp->sd_log_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_log_write_bh",
          "args": [
            "sdp",
            "bd2->bd_bh"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_write_bh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "355-358",
          "snippet": "static void gfs2_log_write_bh(struct gfs2_sbd *sdp, struct buffer_head *bh)\n{\n\tgfs2_log_write(sdp, bh->b_page, bh->b_size, bh_offset(bh));\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_write_bh(struct gfs2_sbd *sdp, struct buffer_head *bh)\n{\n\tgfs2_log_write(sdp, bh->b_page, bh->b_size, bh_offset(bh));\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_log_write_page",
          "args": [
            "sdp",
            "page"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_write_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "371-375",
          "snippet": "void gfs2_log_write_page(struct gfs2_sbd *sdp, struct page *page)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tgfs2_log_write(sdp, page, sb->s_blocksize, 0);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_log_write_page(struct gfs2_sbd *sdp, struct page *page)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tgfs2_log_write(sdp, page, sb->s_blocksize, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bd2->bd_bh"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_buffer",
          "args": [
            "bd2->bd_bh"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "70-75",
          "snippet": "void unlock_buffer(struct buffer_head *bh)\n{\n\tclear_bit_unlock(BH_Lock, &bh->b_state);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&bh->b_state, BH_Lock);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid unlock_buffer(struct buffer_head *bh)\n{\n\tclear_bit_unlock(BH_Lock, &bh->b_state);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&bh->b_state, BH_Lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_buffer_escaped",
          "args": [
            "bd2->bd_bh"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "kaddr + bh_offset(bd2->bd_bh)",
            "bd2->bd_bh->b_size"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bd2->bd_bh"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "bd2->bd_bh->b_page"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mempool_alloc",
          "args": [
            "gfs2_page_pool",
            "GFP_NOIO"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_escaped",
          "args": [
            "bd2->bd_bh"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "bd2->bd_bh"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_continue",
          "args": [
            "bd2",
            "blist",
            "bd_list"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "buffer_escaped(bd1->bd_bh) ? 1 : 0"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_escaped",
          "args": [
            "bd1->bd_bh"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_check_magic",
          "args": [
            "bd1->bd_bh"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_check_magic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "393-404",
          "snippet": "static void gfs2_check_magic(struct buffer_head *bh)\n{\n\tvoid *kaddr;\n\t__be32 *ptr;\n\n\tclear_buffer_escaped(bh);\n\tkaddr = kmap_atomic(bh->b_page);\n\tptr = kaddr + bh_offset(bh);\n\tif (*ptr == cpu_to_be32(GFS2_MAGIC))\n\t\tset_buffer_escaped(bh);\n\tkunmap_atomic(kaddr);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_check_magic(struct buffer_head *bh)\n{\n\tvoid *kaddr;\n\t__be32 *ptr;\n\n\tclear_buffer_escaped(bh);\n\tkaddr = kmap_atomic(bh->b_page);\n\tptr = kaddr + bh_offset(bh);\n\tif (*ptr == cpu_to_be32(GFS2_MAGIC))\n\t\tset_buffer_escaped(bh);\n\tkunmap_atomic(kaddr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "bd1->bd_bh->b_blocknr"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_continue",
          "args": [
            "bd1",
            "blist",
            "bd_list"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_get_log_desc",
          "args": [
            "sdp",
            "is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA",
            "num + 1",
            "num"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_get_log_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "377-391",
          "snippet": "static struct page *gfs2_get_log_desc(struct gfs2_sbd *sdp, u32 ld_type,\n\t\t\t\t      u32 ld_length, u32 ld_data1)\n{\n\tstruct page *page = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\tstruct gfs2_log_descriptor *ld = page_address(page);\n\tclear_page(ld);\n\tld->ld_header.mh_magic = cpu_to_be32(GFS2_MAGIC);\n\tld->ld_header.mh_type = cpu_to_be32(GFS2_METATYPE_LD);\n\tld->ld_header.mh_format = cpu_to_be32(GFS2_FORMAT_LD);\n\tld->ld_type = cpu_to_be32(ld_type);\n\tld->ld_length = cpu_to_be32(ld_length);\n\tld->ld_data1 = cpu_to_be32(ld_data1);\n\tld->ld_data2 = 0;\n\treturn page;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct page *gfs2_get_log_desc(struct gfs2_sbd *sdp, u32 ld_type,\n\t\t\t\t      u32 ld_length, u32 ld_data1)\n{\n\tstruct page *page = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\tstruct gfs2_log_descriptor *ld = page_address(page);\n\tclear_page(ld);\n\tld->ld_header.mh_magic = cpu_to_be32(GFS2_MAGIC);\n\tld->ld_header.mh_type = cpu_to_be32(GFS2_METATYPE_LD);\n\tld->ld_header.mh_format = cpu_to_be32(GFS2_FORMAT_LD);\n\tld->ld_type = cpu_to_be32(ld_type);\n\tld->ld_length = cpu_to_be32(ld_length);\n\tld->ld_data1 = cpu_to_be32(ld_data1);\n\tld->ld_data2 = 0;\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_prepare_entry",
          "args": [
            "bd1",
            "blist",
            "bd_list"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_sort",
          "args": [
            "NULL",
            "blist",
            "blocknr_cmp"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_before_commit(struct gfs2_sbd *sdp, unsigned int limit,\n\t\t\t\tunsigned int total, struct list_head *blist,\n\t\t\t\tbool is_databuf)\n{\n\tstruct gfs2_log_descriptor *ld;\n\tstruct gfs2_bufdata *bd1 = NULL, *bd2;\n\tstruct page *page;\n\tunsigned int num;\n\tunsigned n;\n\t__be64 *ptr;\n\n\tgfs2_log_lock(sdp);\n\tlist_sort(NULL, blist, blocknr_cmp);\n\tbd1 = bd2 = list_prepare_entry(bd1, blist, bd_list);\n\twhile(total) {\n\t\tnum = total;\n\t\tif (total > limit)\n\t\t\tnum = limit;\n\t\tgfs2_log_unlock(sdp);\n\t\tpage = gfs2_get_log_desc(sdp,\n\t\t\t\t\t is_databuf ? GFS2_LOG_DESC_JDATA :\n\t\t\t\t\t GFS2_LOG_DESC_METADATA, num + 1, num);\n\t\tld = page_address(page);\n\t\tgfs2_log_lock(sdp);\n\t\tptr = (__be64 *)(ld + 1);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd1, blist, bd_list) {\n\t\t\t*ptr++ = cpu_to_be64(bd1->bd_bh->b_blocknr);\n\t\t\tif (is_databuf) {\n\t\t\t\tgfs2_check_magic(bd1->bd_bh);\n\t\t\t\t*ptr++ = cpu_to_be64(buffer_escaped(bd1->bd_bh) ? 1 : 0);\n\t\t\t}\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tgfs2_log_unlock(sdp);\n\t\tgfs2_log_write_page(sdp, page);\n\t\tgfs2_log_lock(sdp);\n\n\t\tn = 0;\n\t\tlist_for_each_entry_continue(bd2, blist, bd_list) {\n\t\t\tget_bh(bd2->bd_bh);\n\t\t\tgfs2_log_unlock(sdp);\n\t\t\tlock_buffer(bd2->bd_bh);\n\n\t\t\tif (buffer_escaped(bd2->bd_bh)) {\n\t\t\t\tvoid *kaddr;\n\t\t\t\tpage = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\t\t\t\tptr = page_address(page);\n\t\t\t\tkaddr = kmap_atomic(bd2->bd_bh->b_page);\n\t\t\t\tmemcpy(ptr, kaddr + bh_offset(bd2->bd_bh),\n\t\t\t\t       bd2->bd_bh->b_size);\n\t\t\t\tkunmap_atomic(kaddr);\n\t\t\t\t*(__be32 *)ptr = 0;\n\t\t\t\tclear_buffer_escaped(bd2->bd_bh);\n\t\t\t\tunlock_buffer(bd2->bd_bh);\n\t\t\t\tbrelse(bd2->bd_bh);\n\t\t\t\tgfs2_log_write_page(sdp, page);\n\t\t\t} else {\n\t\t\t\tgfs2_log_write_bh(sdp, bd2->bd_bh);\n\t\t\t}\n\t\t\tgfs2_log_lock(sdp);\n\t\t\tif (++n >= num)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tBUG_ON(total < num);\n\t\ttotal -= num;\n\t}\n\tgfs2_log_unlock(sdp);\n}"
  },
  {
    "function_name": "blocknr_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "406-418",
    "snippet": "static int blocknr_cmp(void *priv, struct list_head *a, struct list_head *b)\n{\n\tstruct gfs2_bufdata *bda, *bdb;\n\n\tbda = list_entry(a, struct gfs2_bufdata, bd_list);\n\tbdb = list_entry(b, struct gfs2_bufdata, bd_list);\n\n\tif (bda->bd_bh->b_blocknr < bdb->bd_bh->b_blocknr)\n\t\treturn -1;\n\tif (bda->bd_bh->b_blocknr > bdb->bd_bh->b_blocknr)\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "b",
            "structgfs2_bufdata",
            "bd_list"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "a",
            "structgfs2_bufdata",
            "bd_list"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int blocknr_cmp(void *priv, struct list_head *a, struct list_head *b)\n{\n\tstruct gfs2_bufdata *bda, *bdb;\n\n\tbda = list_entry(a, struct gfs2_bufdata, bd_list);\n\tbdb = list_entry(b, struct gfs2_bufdata, bd_list);\n\n\tif (bda->bd_bh->b_blocknr < bdb->bd_bh->b_blocknr)\n\t\treturn -1;\n\tif (bda->bd_bh->b_blocknr > bdb->bd_bh->b_blocknr)\n\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_check_magic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "393-404",
    "snippet": "static void gfs2_check_magic(struct buffer_head *bh)\n{\n\tvoid *kaddr;\n\t__be32 *ptr;\n\n\tclear_buffer_escaped(bh);\n\tkaddr = kmap_atomic(bh->b_page);\n\tptr = kaddr + bh_offset(bh);\n\tif (*ptr == cpu_to_be32(GFS2_MAGIC))\n\t\tset_buffer_escaped(bh);\n\tkunmap_atomic(kaddr);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_buffer_escaped",
          "args": [
            "bh"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_MAGIC"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "bh->b_page"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_buffer_escaped",
          "args": [
            "bh"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_check_magic(struct buffer_head *bh)\n{\n\tvoid *kaddr;\n\t__be32 *ptr;\n\n\tclear_buffer_escaped(bh);\n\tkaddr = kmap_atomic(bh->b_page);\n\tptr = kaddr + bh_offset(bh);\n\tif (*ptr == cpu_to_be32(GFS2_MAGIC))\n\t\tset_buffer_escaped(bh);\n\tkunmap_atomic(kaddr);\n}"
  },
  {
    "function_name": "gfs2_get_log_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "377-391",
    "snippet": "static struct page *gfs2_get_log_desc(struct gfs2_sbd *sdp, u32 ld_type,\n\t\t\t\t      u32 ld_length, u32 ld_data1)\n{\n\tstruct page *page = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\tstruct gfs2_log_descriptor *ld = page_address(page);\n\tclear_page(ld);\n\tld->ld_header.mh_magic = cpu_to_be32(GFS2_MAGIC);\n\tld->ld_header.mh_type = cpu_to_be32(GFS2_METATYPE_LD);\n\tld->ld_header.mh_format = cpu_to_be32(GFS2_FORMAT_LD);\n\tld->ld_type = cpu_to_be32(ld_type);\n\tld->ld_length = cpu_to_be32(ld_length);\n\tld->ld_data1 = cpu_to_be32(ld_data1);\n\tld->ld_data2 = 0;\n\treturn page;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ld_data1"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ld_length"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ld_type"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_FORMAT_LD"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_METATYPE_LD"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "GFS2_MAGIC"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_page",
          "args": [
            "ld"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "__clear_page_buffers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "123-129",
          "snippet": "static void\n__clear_page_buffers(struct page *page)\n{\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nstatic void\n__clear_page_buffers(struct page *page)\n{\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_cache_release(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mempool_alloc",
          "args": [
            "gfs2_page_pool",
            "GFP_NOIO"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct page *gfs2_get_log_desc(struct gfs2_sbd *sdp, u32 ld_type,\n\t\t\t\t      u32 ld_length, u32 ld_data1)\n{\n\tstruct page *page = mempool_alloc(gfs2_page_pool, GFP_NOIO);\n\tstruct gfs2_log_descriptor *ld = page_address(page);\n\tclear_page(ld);\n\tld->ld_header.mh_magic = cpu_to_be32(GFS2_MAGIC);\n\tld->ld_header.mh_type = cpu_to_be32(GFS2_METATYPE_LD);\n\tld->ld_header.mh_format = cpu_to_be32(GFS2_FORMAT_LD);\n\tld->ld_type = cpu_to_be32(ld_type);\n\tld->ld_length = cpu_to_be32(ld_length);\n\tld->ld_data1 = cpu_to_be32(ld_data1);\n\tld->ld_data2 = 0;\n\treturn page;\n}"
  },
  {
    "function_name": "gfs2_log_write_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "371-375",
    "snippet": "void gfs2_log_write_page(struct gfs2_sbd *sdp, struct page *page)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tgfs2_log_write(sdp, page, sb->s_blocksize, 0);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_write",
          "args": [
            "sdp",
            "page",
            "sb->s_blocksize",
            "0"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "328-343",
          "snippet": "static void gfs2_log_write(struct gfs2_sbd *sdp, struct page *page,\n\t\t\t   unsigned size, unsigned offset)\n{\n\tu64 blkno = gfs2_log_bmap(sdp);\n\tstruct bio *bio;\n\tint ret;\n\n\tbio = gfs2_log_get_bio(sdp, blkno);\n\tret = bio_add_page(bio, page, size, offset);\n\tif (ret == 0) {\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t\tbio = gfs2_log_alloc_bio(sdp, blkno);\n\t\tret = bio_add_page(bio, page, size, offset);\n\t\tWARN_ON(ret == 0);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_write(struct gfs2_sbd *sdp, struct page *page,\n\t\t\t   unsigned size, unsigned offset)\n{\n\tu64 blkno = gfs2_log_bmap(sdp);\n\tstruct bio *bio;\n\tint ret;\n\n\tbio = gfs2_log_get_bio(sdp, blkno);\n\tret = bio_add_page(bio, page, size, offset);\n\tif (ret == 0) {\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t\tbio = gfs2_log_alloc_bio(sdp, blkno);\n\t\tret = bio_add_page(bio, page, size, offset);\n\t\tWARN_ON(ret == 0);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_log_write_page(struct gfs2_sbd *sdp, struct page *page)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tgfs2_log_write(sdp, page, sb->s_blocksize, 0);\n}"
  },
  {
    "function_name": "gfs2_log_write_bh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "355-358",
    "snippet": "static void gfs2_log_write_bh(struct gfs2_sbd *sdp, struct buffer_head *bh)\n{\n\tgfs2_log_write(sdp, bh->b_page, bh->b_size, bh_offset(bh));\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_write",
          "args": [
            "sdp",
            "bh->b_page",
            "bh->b_size",
            "bh_offset(bh)"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "328-343",
          "snippet": "static void gfs2_log_write(struct gfs2_sbd *sdp, struct page *page,\n\t\t\t   unsigned size, unsigned offset)\n{\n\tu64 blkno = gfs2_log_bmap(sdp);\n\tstruct bio *bio;\n\tint ret;\n\n\tbio = gfs2_log_get_bio(sdp, blkno);\n\tret = bio_add_page(bio, page, size, offset);\n\tif (ret == 0) {\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t\tbio = gfs2_log_alloc_bio(sdp, blkno);\n\t\tret = bio_add_page(bio, page, size, offset);\n\t\tWARN_ON(ret == 0);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_write(struct gfs2_sbd *sdp, struct page *page,\n\t\t\t   unsigned size, unsigned offset)\n{\n\tu64 blkno = gfs2_log_bmap(sdp);\n\tstruct bio *bio;\n\tint ret;\n\n\tbio = gfs2_log_get_bio(sdp, blkno);\n\tret = bio_add_page(bio, page, size, offset);\n\tif (ret == 0) {\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t\tbio = gfs2_log_alloc_bio(sdp, blkno);\n\t\tret = bio_add_page(bio, page, size, offset);\n\t\tWARN_ON(ret == 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_write_bh(struct gfs2_sbd *sdp, struct buffer_head *bh)\n{\n\tgfs2_log_write(sdp, bh->b_page, bh->b_size, bh_offset(bh));\n}"
  },
  {
    "function_name": "gfs2_log_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "328-343",
    "snippet": "static void gfs2_log_write(struct gfs2_sbd *sdp, struct page *page,\n\t\t\t   unsigned size, unsigned offset)\n{\n\tu64 blkno = gfs2_log_bmap(sdp);\n\tstruct bio *bio;\n\tint ret;\n\n\tbio = gfs2_log_get_bio(sdp, blkno);\n\tret = bio_add_page(bio, page, size, offset);\n\tif (ret == 0) {\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t\tbio = gfs2_log_alloc_bio(sdp, blkno);\n\t\tret = bio_add_page(bio, page, size, offset);\n\t\tWARN_ON(ret == 0);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret == 0"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_add_page",
          "args": [
            "bio",
            "page",
            "size",
            "offset"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_log_alloc_bio",
          "args": [
            "sdp",
            "blkno"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_alloc_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "261-284",
          "snippet": "static struct bio *gfs2_log_alloc_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tunsigned nrvecs = bio_get_nr_vecs(sb->s_bdev);\n\tstruct bio *bio;\n\n\tBUG_ON(sdp->sd_log_bio);\n\n\twhile (1) {\n\t\tbio = bio_alloc(GFP_NOIO, nrvecs);\n\t\tif (likely(bio))\n\t\t\tbreak;\n\t\tnrvecs = max(nrvecs/2, 1U);\n\t}\n\n\tbio->bi_iter.bi_sector = blkno * (sb->s_blocksize >> 9);\n\tbio->bi_bdev = sb->s_bdev;\n\tbio->bi_end_io = gfs2_end_log_write;\n\tbio->bi_private = sdp;\n\n\tsdp->sd_log_bio = bio;\n\n\treturn bio;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct bio *gfs2_log_alloc_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tunsigned nrvecs = bio_get_nr_vecs(sb->s_bdev);\n\tstruct bio *bio;\n\n\tBUG_ON(sdp->sd_log_bio);\n\n\twhile (1) {\n\t\tbio = bio_alloc(GFP_NOIO, nrvecs);\n\t\tif (likely(bio))\n\t\t\tbreak;\n\t\tnrvecs = max(nrvecs/2, 1U);\n\t}\n\n\tbio->bi_iter.bi_sector = blkno * (sb->s_blocksize >> 9);\n\tbio->bi_bdev = sb->s_bdev;\n\tbio->bi_end_io = gfs2_end_log_write;\n\tbio->bi_private = sdp;\n\n\tsdp->sd_log_bio = bio;\n\n\treturn bio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_log_flush_bio",
          "args": [
            "sdp",
            "WRITE"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_flush_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "239-246",
          "snippet": "void gfs2_log_flush_bio(struct gfs2_sbd *sdp, int rw)\n{\n\tif (sdp->sd_log_bio) {\n\t\tatomic_inc(&sdp->sd_log_in_flight);\n\t\tsubmit_bio(rw, sdp->sd_log_bio);\n\t\tsdp->sd_log_bio = NULL;\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_log_flush_bio(struct gfs2_sbd *sdp, int rw)\n{\n\tif (sdp->sd_log_bio) {\n\t\tatomic_inc(&sdp->sd_log_in_flight);\n\t\tsubmit_bio(rw, sdp->sd_log_bio);\n\t\tsdp->sd_log_bio = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_add_page",
          "args": [
            "bio",
            "page",
            "size",
            "offset"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_log_get_bio",
          "args": [
            "sdp",
            "blkno"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_get_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "299-313",
          "snippet": "static struct bio *gfs2_log_get_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct bio *bio = sdp->sd_log_bio;\n\tu64 nblk;\n\n\tif (bio) {\n\t\tnblk = bio_end_sector(bio);\n\t\tnblk >>= sdp->sd_fsb2bb_shift;\n\t\tif (blkno == nblk)\n\t\t\treturn bio;\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t}\n\n\treturn gfs2_log_alloc_bio(sdp, blkno);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct bio *gfs2_log_get_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct bio *bio = sdp->sd_log_bio;\n\tu64 nblk;\n\n\tif (bio) {\n\t\tnblk = bio_end_sector(bio);\n\t\tnblk >>= sdp->sd_fsb2bb_shift;\n\t\tif (blkno == nblk)\n\t\t\treturn bio;\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t}\n\n\treturn gfs2_log_alloc_bio(sdp, blkno);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_log_bmap",
          "args": [
            "sdp"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_bmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "143-158",
          "snippet": "static u64 gfs2_log_bmap(struct gfs2_sbd *sdp)\n{\n\tunsigned int lbn = sdp->sd_log_flush_head;\n\tstruct gfs2_journal_extent *je;\n\tu64 block;\n\n\tlist_for_each_entry(je, &sdp->sd_jdesc->extent_list, list) {\n\t\tif ((lbn >= je->lblock) && (lbn < (je->lblock + je->blocks))) {\n\t\t\tblock = je->dblock + lbn - je->lblock;\n\t\t\tgfs2_log_incr_head(sdp);\n\t\t\treturn block;\n\t\t}\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 gfs2_log_bmap(struct gfs2_sbd *sdp)\n{\n\tunsigned int lbn = sdp->sd_log_flush_head;\n\tstruct gfs2_journal_extent *je;\n\tu64 block;\n\n\tlist_for_each_entry(je, &sdp->sd_jdesc->extent_list, list) {\n\t\tif ((lbn >= je->lblock) && (lbn < (je->lblock + je->blocks))) {\n\t\t\tblock = je->dblock + lbn - je->lblock;\n\t\t\tgfs2_log_incr_head(sdp);\n\t\t\treturn block;\n\t\t}\n\t}\n\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_write(struct gfs2_sbd *sdp, struct page *page,\n\t\t\t   unsigned size, unsigned offset)\n{\n\tu64 blkno = gfs2_log_bmap(sdp);\n\tstruct bio *bio;\n\tint ret;\n\n\tbio = gfs2_log_get_bio(sdp, blkno);\n\tret = bio_add_page(bio, page, size, offset);\n\tif (ret == 0) {\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t\tbio = gfs2_log_alloc_bio(sdp, blkno);\n\t\tret = bio_add_page(bio, page, size, offset);\n\t\tWARN_ON(ret == 0);\n\t}\n}"
  },
  {
    "function_name": "gfs2_log_get_bio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "299-313",
    "snippet": "static struct bio *gfs2_log_get_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct bio *bio = sdp->sd_log_bio;\n\tu64 nblk;\n\n\tif (bio) {\n\t\tnblk = bio_end_sector(bio);\n\t\tnblk >>= sdp->sd_fsb2bb_shift;\n\t\tif (blkno == nblk)\n\t\t\treturn bio;\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t}\n\n\treturn gfs2_log_alloc_bio(sdp, blkno);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_alloc_bio",
          "args": [
            "sdp",
            "blkno"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_alloc_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "261-284",
          "snippet": "static struct bio *gfs2_log_alloc_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tunsigned nrvecs = bio_get_nr_vecs(sb->s_bdev);\n\tstruct bio *bio;\n\n\tBUG_ON(sdp->sd_log_bio);\n\n\twhile (1) {\n\t\tbio = bio_alloc(GFP_NOIO, nrvecs);\n\t\tif (likely(bio))\n\t\t\tbreak;\n\t\tnrvecs = max(nrvecs/2, 1U);\n\t}\n\n\tbio->bi_iter.bi_sector = blkno * (sb->s_blocksize >> 9);\n\tbio->bi_bdev = sb->s_bdev;\n\tbio->bi_end_io = gfs2_end_log_write;\n\tbio->bi_private = sdp;\n\n\tsdp->sd_log_bio = bio;\n\n\treturn bio;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct bio *gfs2_log_alloc_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tunsigned nrvecs = bio_get_nr_vecs(sb->s_bdev);\n\tstruct bio *bio;\n\n\tBUG_ON(sdp->sd_log_bio);\n\n\twhile (1) {\n\t\tbio = bio_alloc(GFP_NOIO, nrvecs);\n\t\tif (likely(bio))\n\t\t\tbreak;\n\t\tnrvecs = max(nrvecs/2, 1U);\n\t}\n\n\tbio->bi_iter.bi_sector = blkno * (sb->s_blocksize >> 9);\n\tbio->bi_bdev = sb->s_bdev;\n\tbio->bi_end_io = gfs2_end_log_write;\n\tbio->bi_private = sdp;\n\n\tsdp->sd_log_bio = bio;\n\n\treturn bio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_log_flush_bio",
          "args": [
            "sdp",
            "WRITE"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_flush_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "239-246",
          "snippet": "void gfs2_log_flush_bio(struct gfs2_sbd *sdp, int rw)\n{\n\tif (sdp->sd_log_bio) {\n\t\tatomic_inc(&sdp->sd_log_in_flight);\n\t\tsubmit_bio(rw, sdp->sd_log_bio);\n\t\tsdp->sd_log_bio = NULL;\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_log_flush_bio(struct gfs2_sbd *sdp, int rw)\n{\n\tif (sdp->sd_log_bio) {\n\t\tatomic_inc(&sdp->sd_log_in_flight);\n\t\tsubmit_bio(rw, sdp->sd_log_bio);\n\t\tsdp->sd_log_bio = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_end_sector",
          "args": [
            "bio"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct bio *gfs2_log_get_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct bio *bio = sdp->sd_log_bio;\n\tu64 nblk;\n\n\tif (bio) {\n\t\tnblk = bio_end_sector(bio);\n\t\tnblk >>= sdp->sd_fsb2bb_shift;\n\t\tif (blkno == nblk)\n\t\t\treturn bio;\n\t\tgfs2_log_flush_bio(sdp, WRITE);\n\t}\n\n\treturn gfs2_log_alloc_bio(sdp, blkno);\n}"
  },
  {
    "function_name": "gfs2_log_alloc_bio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "261-284",
    "snippet": "static struct bio *gfs2_log_alloc_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tunsigned nrvecs = bio_get_nr_vecs(sb->s_bdev);\n\tstruct bio *bio;\n\n\tBUG_ON(sdp->sd_log_bio);\n\n\twhile (1) {\n\t\tbio = bio_alloc(GFP_NOIO, nrvecs);\n\t\tif (likely(bio))\n\t\t\tbreak;\n\t\tnrvecs = max(nrvecs/2, 1U);\n\t}\n\n\tbio->bi_iter.bi_sector = blkno * (sb->s_blocksize >> 9);\n\tbio->bi_bdev = sb->s_bdev;\n\tbio->bi_end_io = gfs2_end_log_write;\n\tbio->bi_private = sdp;\n\n\tsdp->sd_log_bio = bio;\n\n\treturn bio;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "max",
          "args": [
            "nrvecs/2",
            "1U"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "max_select_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/select.c",
          "lines": "342-382",
          "snippet": "static int max_select_fd(unsigned long n, fd_set_bits *fds)\n{\n\tunsigned long *open_fds;\n\tunsigned long set;\n\tint max;\n\tstruct fdtable *fdt;\n\n\t/* handle last in-complete long-word first */\n\tset = ~(~0UL << (n & (BITS_PER_LONG-1)));\n\tn /= BITS_PER_LONG;\n\tfdt = files_fdtable(current->files);\n\topen_fds = fdt->open_fds + n;\n\tmax = 0;\n\tif (set) {\n\t\tset &= BITS(fds, n);\n\t\tif (set) {\n\t\t\tif (!(set & ~*open_fds))\n\t\t\t\tgoto get_max;\n\t\t\treturn -EBADF;\n\t\t}\n\t}\n\twhile (n) {\n\t\topen_fds--;\n\t\tn--;\n\t\tset = BITS(fds, n);\n\t\tif (!set)\n\t\t\tcontinue;\n\t\tif (set & ~*open_fds)\n\t\t\treturn -EBADF;\n\t\tif (max)\n\t\t\tcontinue;\nget_max:\n\t\tdo {\n\t\t\tmax++;\n\t\t\tset >>= 1;\n\t\t} while (set);\n\t\tmax += n * BITS_PER_LONG;\n\t}\n\n\treturn max;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <net/busy_poll.h>",
            "#include <linux/freezer.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/personality.h> /* for STICKY_TIMEOUTS */",
            "#include <linux/poll.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <net/busy_poll.h>\n#include <linux/freezer.h>\n#include <linux/sched/rt.h>\n#include <linux/hrtimer.h>\n#include <linux/rcupdate.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/personality.h> /* for STICKY_TIMEOUTS */\n#include <linux/poll.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int max_select_fd(unsigned long n, fd_set_bits *fds)\n{\n\tunsigned long *open_fds;\n\tunsigned long set;\n\tint max;\n\tstruct fdtable *fdt;\n\n\t/* handle last in-complete long-word first */\n\tset = ~(~0UL << (n & (BITS_PER_LONG-1)));\n\tn /= BITS_PER_LONG;\n\tfdt = files_fdtable(current->files);\n\topen_fds = fdt->open_fds + n;\n\tmax = 0;\n\tif (set) {\n\t\tset &= BITS(fds, n);\n\t\tif (set) {\n\t\t\tif (!(set & ~*open_fds))\n\t\t\t\tgoto get_max;\n\t\t\treturn -EBADF;\n\t\t}\n\t}\n\twhile (n) {\n\t\topen_fds--;\n\t\tn--;\n\t\tset = BITS(fds, n);\n\t\tif (!set)\n\t\t\tcontinue;\n\t\tif (set & ~*open_fds)\n\t\t\treturn -EBADF;\n\t\tif (max)\n\t\t\tcontinue;\nget_max:\n\t\tdo {\n\t\t\tmax++;\n\t\t\tset >>= 1;\n\t\t} while (set);\n\t\tmax += n * BITS_PER_LONG;\n\t}\n\n\treturn max;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "bio"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_alloc",
          "args": [
            "GFP_NOIO",
            "nrvecs"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_io_bio_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/extent_io.c",
          "lines": "2733-2746",
          "snippet": "struct bio *btrfs_io_bio_alloc(gfp_t gfp_mask, unsigned int nr_iovecs)\n{\n\tstruct btrfs_io_bio *btrfs_bio;\n\tstruct bio *bio;\n\n\tbio = bio_alloc_bioset(gfp_mask, nr_iovecs, btrfs_bioset);\n\tif (bio) {\n\t\tbtrfs_bio = btrfs_io_bio(bio);\n\t\tbtrfs_bio->csum = NULL;\n\t\tbtrfs_bio->csum_allocated = NULL;\n\t\tbtrfs_bio->end_io = NULL;\n\t}\n\treturn bio;\n}",
          "includes": [
            "#include \"backref.h\"",
            "#include \"rcu-string.h\"",
            "#include \"locking.h\"",
            "#include \"check-integrity.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"ctree.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/cleancache.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/bio.h>",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct bio_set *btrfs_bioset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"backref.h\"\n#include \"rcu-string.h\"\n#include \"locking.h\"\n#include \"check-integrity.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"ctree.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/cleancache.h>\n#include <linux/prefetch.h>\n#include <linux/pagevec.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/page-flags.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/bio.h>\n#include <linux/slab.h>\n#include <linux/bitops.h>\n\nstatic struct bio_set *btrfs_bioset;\n\nstruct bio *btrfs_io_bio_alloc(gfp_t gfp_mask, unsigned int nr_iovecs)\n{\n\tstruct btrfs_io_bio *btrfs_bio;\n\tstruct bio *bio;\n\n\tbio = bio_alloc_bioset(gfp_mask, nr_iovecs, btrfs_bioset);\n\tif (bio) {\n\t\tbtrfs_bio = btrfs_io_bio(bio);\n\t\tbtrfs_bio->csum = NULL;\n\t\tbtrfs_bio->csum_allocated = NULL;\n\t\tbtrfs_bio->end_io = NULL;\n\t}\n\treturn bio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "sdp->sd_log_bio"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_get_nr_vecs",
          "args": [
            "sb->s_bdev"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct bio *gfs2_log_alloc_bio(struct gfs2_sbd *sdp, u64 blkno)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tunsigned nrvecs = bio_get_nr_vecs(sb->s_bdev);\n\tstruct bio *bio;\n\n\tBUG_ON(sdp->sd_log_bio);\n\n\twhile (1) {\n\t\tbio = bio_alloc(GFP_NOIO, nrvecs);\n\t\tif (likely(bio))\n\t\t\tbreak;\n\t\tnrvecs = max(nrvecs/2, 1U);\n\t}\n\n\tbio->bi_iter.bi_sector = blkno * (sb->s_blocksize >> 9);\n\tbio->bi_bdev = sb->s_bdev;\n\tbio->bi_end_io = gfs2_end_log_write;\n\tbio->bi_private = sdp;\n\n\tsdp->sd_log_bio = bio;\n\n\treturn bio;\n}"
  },
  {
    "function_name": "gfs2_log_flush_bio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "239-246",
    "snippet": "void gfs2_log_flush_bio(struct gfs2_sbd *sdp, int rw)\n{\n\tif (sdp->sd_log_bio) {\n\t\tatomic_inc(&sdp->sd_log_in_flight);\n\t\tsubmit_bio(rw, sdp->sd_log_bio);\n\t\tsdp->sd_log_bio = NULL;\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "submit_bio",
          "args": [
            "rw",
            "sdp->sd_log_bio"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "bl_submit_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/blocklayout/blocklayout.c",
          "lines": "104-115",
          "snippet": "static struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"blocklayout.h\"",
            "#include \"../internal.h\"",
            "#include \"../nfs4session.h\"",
            "#include \"../pnfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/bio.h>\t\t/* struct bio */",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blocklayout.h\"\n#include \"../internal.h\"\n#include \"../nfs4session.h\"\n#include \"../pnfs.h\"\n#include <linux/pagevec.h>\n#include <linux/prefetch.h>\n#include <linux/bio.h>\t\t/* struct bio */\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&sdp->sd_log_in_flight"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_log_flush_bio(struct gfs2_sbd *sdp, int rw)\n{\n\tif (sdp->sd_log_bio) {\n\t\tatomic_inc(&sdp->sd_log_in_flight);\n\t\tsubmit_bio(rw, sdp->sd_log_bio);\n\t\tsdp->sd_log_bio = NULL;\n\t}\n}"
  },
  {
    "function_name": "gfs2_end_log_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "205-228",
    "snippet": "static void gfs2_end_log_write(struct bio *bio, int error)\n{\n\tstruct gfs2_sbd *sdp = bio->bi_private;\n\tstruct bio_vec *bvec;\n\tstruct page *page;\n\tint i;\n\n\tif (error) {\n\t\tsdp->sd_log_error = error;\n\t\tfs_err(sdp, \"Error %d writing to log\\n\", error);\n\t}\n\n\tbio_for_each_segment_all(bvec, bio, i) {\n\t\tpage = bvec->bv_page;\n\t\tif (page_has_buffers(page))\n\t\t\tgfs2_end_log_write_bh(sdp, bvec, error);\n\t\telse\n\t\t\tmempool_free(page, gfs2_page_pool);\n\t}\n\n\tbio_put(bio);\n\tif (atomic_dec_and_test(&sdp->sd_log_in_flight))\n\t\twake_up(&sdp->sd_log_flush_wait);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "&sdp->sd_log_flush_wait"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_wake_up_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "1409-1414",
          "snippet": "void gfs2_wake_up_statfs(struct gfs2_sbd *sdp) {\n\tif (!sdp->sd_statfs_force_sync) {\n\t\tsdp->sd_statfs_force_sync = 1;\n\t\twake_up(&sdp->sd_quota_wait);\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_wake_up_statfs(struct gfs2_sbd *sdp) {\n\tif (!sdp->sd_statfs_force_sync) {\n\t\tsdp->sd_statfs_force_sync = 1;\n\t\twake_up(&sdp->sd_quota_wait);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&sdp->sd_log_in_flight"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_put",
          "args": [
            "bio"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mempool_free",
          "args": [
            "page",
            "gfs2_page_pool"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_end_log_write_bh",
          "args": [
            "sdp",
            "bvec",
            "error"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_end_log_write_bh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "172-192",
          "snippet": "static void gfs2_end_log_write_bh(struct gfs2_sbd *sdp, struct bio_vec *bvec,\n\t\t\t\t  int error)\n{\n\tstruct buffer_head *bh, *next;\n\tstruct page *page = bvec->bv_page;\n\tunsigned size;\n\n\tbh = page_buffers(page);\n\tsize = bvec->bv_len;\n\twhile (bh_offset(bh) < bvec->bv_offset)\n\t\tbh = bh->b_this_page;\n\tdo {\n\t\tif (error)\n\t\t\tset_buffer_write_io_error(bh);\n\t\tunlock_buffer(bh);\n\t\tnext = bh->b_this_page;\n\t\tsize -= bh->b_size;\n\t\tbrelse(bh);\n\t\tbh = next;\n\t} while(bh && size);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_end_log_write_bh(struct gfs2_sbd *sdp, struct bio_vec *bvec,\n\t\t\t\t  int error)\n{\n\tstruct buffer_head *bh, *next;\n\tstruct page *page = bvec->bv_page;\n\tunsigned size;\n\n\tbh = page_buffers(page);\n\tsize = bvec->bv_len;\n\twhile (bh_offset(bh) < bvec->bv_offset)\n\t\tbh = bh->b_this_page;\n\tdo {\n\t\tif (error)\n\t\t\tset_buffer_write_io_error(bh);\n\t\tunlock_buffer(bh);\n\t\tnext = bh->b_this_page;\n\t\tsize -= bh->b_size;\n\t\tbrelse(bh);\n\t\tbh = next;\n\t} while(bh && size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_has_buffers",
          "args": [
            "page"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bio_for_each_segment_all",
          "args": [
            "bvec",
            "bio",
            "i"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs_err",
          "args": [
            "sdp",
            "\"Error %d writing to log\\n\"",
            "error"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "cifs_vfs_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
          "lines": "43-56",
          "snippet": "void cifs_vfs_err(const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tpr_err(\"CIFS VFS: %pV\", &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include \"cifsfs.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/ctype.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid cifs_vfs_err(const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tpr_err(\"CIFS VFS: %pV\", &vaf);\n\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_end_log_write(struct bio *bio, int error)\n{\n\tstruct gfs2_sbd *sdp = bio->bi_private;\n\tstruct bio_vec *bvec;\n\tstruct page *page;\n\tint i;\n\n\tif (error) {\n\t\tsdp->sd_log_error = error;\n\t\tfs_err(sdp, \"Error %d writing to log\\n\", error);\n\t}\n\n\tbio_for_each_segment_all(bvec, bio, i) {\n\t\tpage = bvec->bv_page;\n\t\tif (page_has_buffers(page))\n\t\t\tgfs2_end_log_write_bh(sdp, bvec, error);\n\t\telse\n\t\t\tmempool_free(page, gfs2_page_pool);\n\t}\n\n\tbio_put(bio);\n\tif (atomic_dec_and_test(&sdp->sd_log_in_flight))\n\t\twake_up(&sdp->sd_log_flush_wait);\n}"
  },
  {
    "function_name": "gfs2_end_log_write_bh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "172-192",
    "snippet": "static void gfs2_end_log_write_bh(struct gfs2_sbd *sdp, struct bio_vec *bvec,\n\t\t\t\t  int error)\n{\n\tstruct buffer_head *bh, *next;\n\tstruct page *page = bvec->bv_page;\n\tunsigned size;\n\n\tbh = page_buffers(page);\n\tsize = bvec->bv_len;\n\twhile (bh_offset(bh) < bvec->bv_offset)\n\t\tbh = bh->b_this_page;\n\tdo {\n\t\tif (error)\n\t\t\tset_buffer_write_io_error(bh);\n\t\tunlock_buffer(bh);\n\t\tnext = bh->b_this_page;\n\t\tsize -= bh->b_size;\n\t\tbrelse(bh);\n\t\tbh = next;\n\t} while(bh && size);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_buffer",
          "args": [
            "bh"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "70-75",
          "snippet": "void unlock_buffer(struct buffer_head *bh)\n{\n\tclear_bit_unlock(BH_Lock, &bh->b_state);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&bh->b_state, BH_Lock);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid unlock_buffer(struct buffer_head *bh)\n{\n\tclear_bit_unlock(BH_Lock, &bh->b_state);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&bh->b_state, BH_Lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_buffer_write_io_error",
          "args": [
            "bh"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bh_offset",
          "args": [
            "bh"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_buffers",
          "args": [
            "page"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "__clear_page_buffers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "123-129",
          "snippet": "static void\n__clear_page_buffers(struct page *page)\n{\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_cache_release(page);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nstatic void\n__clear_page_buffers(struct page *page)\n{\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_cache_release(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_end_log_write_bh(struct gfs2_sbd *sdp, struct bio_vec *bvec,\n\t\t\t\t  int error)\n{\n\tstruct buffer_head *bh, *next;\n\tstruct page *page = bvec->bv_page;\n\tunsigned size;\n\n\tbh = page_buffers(page);\n\tsize = bvec->bv_len;\n\twhile (bh_offset(bh) < bvec->bv_offset)\n\t\tbh = bh->b_this_page;\n\tdo {\n\t\tif (error)\n\t\t\tset_buffer_write_io_error(bh);\n\t\tunlock_buffer(bh);\n\t\tnext = bh->b_this_page;\n\t\tsize -= bh->b_size;\n\t\tbrelse(bh);\n\t\tbh = next;\n\t} while(bh && size);\n}"
  },
  {
    "function_name": "gfs2_log_bmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "143-158",
    "snippet": "static u64 gfs2_log_bmap(struct gfs2_sbd *sdp)\n{\n\tunsigned int lbn = sdp->sd_log_flush_head;\n\tstruct gfs2_journal_extent *je;\n\tu64 block;\n\n\tlist_for_each_entry(je, &sdp->sd_jdesc->extent_list, list) {\n\t\tif ((lbn >= je->lblock) && (lbn < (je->lblock + je->blocks))) {\n\t\t\tblock = je->dblock + lbn - je->lblock;\n\t\t\tgfs2_log_incr_head(sdp);\n\t\t\treturn block;\n\t\t}\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_log_incr_head",
          "args": [
            "sdp"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_log_incr_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "132-141",
          "snippet": "static void gfs2_log_incr_head(struct gfs2_sbd *sdp)\n{\n\tBUG_ON((sdp->sd_log_flush_head == sdp->sd_log_tail) &&\n\t       (sdp->sd_log_flush_head != sdp->sd_log_head));\n\n\tif (++sdp->sd_log_flush_head == sdp->sd_jdesc->jd_blocks) {\n\t\tsdp->sd_log_flush_head = 0;\n\t\tsdp->sd_log_flush_wrapped = 1;\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_incr_head(struct gfs2_sbd *sdp)\n{\n\tBUG_ON((sdp->sd_log_flush_head == sdp->sd_log_tail) &&\n\t       (sdp->sd_log_flush_head != sdp->sd_log_head));\n\n\tif (++sdp->sd_log_flush_head == sdp->sd_jdesc->jd_blocks) {\n\t\tsdp->sd_log_flush_head = 0;\n\t\tsdp->sd_log_flush_wrapped = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "je",
            "&sdp->sd_jdesc->extent_list",
            "list"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 gfs2_log_bmap(struct gfs2_sbd *sdp)\n{\n\tunsigned int lbn = sdp->sd_log_flush_head;\n\tstruct gfs2_journal_extent *je;\n\tu64 block;\n\n\tlist_for_each_entry(je, &sdp->sd_jdesc->extent_list, list) {\n\t\tif ((lbn >= je->lblock) && (lbn < (je->lblock + je->blocks))) {\n\t\t\tblock = je->dblock + lbn - je->lblock;\n\t\t\tgfs2_log_incr_head(sdp);\n\t\t\treturn block;\n\t\t}\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "gfs2_log_incr_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "132-141",
    "snippet": "static void gfs2_log_incr_head(struct gfs2_sbd *sdp)\n{\n\tBUG_ON((sdp->sd_log_flush_head == sdp->sd_log_tail) &&\n\t       (sdp->sd_log_flush_head != sdp->sd_log_head));\n\n\tif (++sdp->sd_log_flush_head == sdp->sd_jdesc->jd_blocks) {\n\t\tsdp->sd_log_flush_head = 0;\n\t\tsdp->sd_log_flush_wrapped = 1;\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(sdp->sd_log_flush_head == sdp->sd_log_tail) &&\n\t       (sdp->sd_log_flush_head != sdp->sd_log_head)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_log_incr_head(struct gfs2_sbd *sdp)\n{\n\tBUG_ON((sdp->sd_log_flush_head == sdp->sd_log_tail) &&\n\t       (sdp->sd_log_flush_head != sdp->sd_log_head));\n\n\tif (++sdp->sd_log_flush_head == sdp->sd_jdesc->jd_blocks) {\n\t\tsdp->sd_log_flush_head = 0;\n\t\tsdp->sd_log_flush_wrapped = 1;\n\t}\n}"
  },
  {
    "function_name": "gfs2_unpin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "98-130",
    "snippet": "static void gfs2_unpin(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       struct gfs2_trans *tr)\n{\n\tstruct gfs2_bufdata *bd = bh->b_private;\n\n\tBUG_ON(!buffer_uptodate(bh));\n\tBUG_ON(!buffer_pinned(bh));\n\n\tlock_buffer(bh);\n\tmark_buffer_dirty(bh);\n\tclear_buffer_pinned(bh);\n\n\tif (buffer_is_rgrp(bd))\n\t\tmaybe_release_space(bd);\n\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr) {\n\t\tlist_del(&bd->bd_ail_st_list);\n\t\tbrelse(bh);\n\t} else {\n\t\tstruct gfs2_glock *gl = bd->bd_gl;\n\t\tlist_add(&bd->bd_ail_gl_list, &gl->gl_ail_list);\n\t\tatomic_inc(&gl->gl_ail_count);\n\t}\n\tbd->bd_tr = tr;\n\tlist_add(&bd->bd_ail_st_list, &tr->tr_ail1_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\n\tclear_bit(GLF_LFLUSH, &bd->bd_gl->gl_flags);\n\ttrace_gfs2_pin(bd, 0);\n\tunlock_buffer(bh);\n\tatomic_dec(&sdp->sd_log_pinned);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&sdp->sd_log_pinned"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlock_buffer",
          "args": [
            "bh"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "70-75",
          "snippet": "void unlock_buffer(struct buffer_head *bh)\n{\n\tclear_bit_unlock(BH_Lock, &bh->b_state);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&bh->b_state, BH_Lock);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid unlock_buffer(struct buffer_head *bh)\n{\n\tclear_bit_unlock(BH_Lock, &bh->b_state);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&bh->b_state, BH_Lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_pin",
          "args": [
            "bd",
            "0"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LFLUSH",
            "&bd->bd_gl->gl_flags"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sdp->sd_ail_lock"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&bd->bd_ail_st_list",
            "&tr->tr_ail1_list"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&gl->gl_ail_count"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&bd->bd_ail_st_list"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sdp->sd_ail_lock"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "maybe_release_space",
          "args": [
            "bd"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_release_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "70-87",
          "snippet": "static void maybe_release_space(struct gfs2_bufdata *bd)\n{\n\tstruct gfs2_glock *gl = bd->bd_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct gfs2_rgrpd *rgd = gl->gl_object;\n\tunsigned int index = bd->bd_bh->b_blocknr - gl->gl_name.ln_number;\n\tstruct gfs2_bitmap *bi = rgd->rd_bits + index;\n\n\tif (bi->bi_clone == NULL)\n\t\treturn;\n\tif (sdp->sd_args.ar_discard)\n\t\tgfs2_rgrp_send_discards(sdp, rgd->rd_data0, bd->bd_bh, bi, 1, NULL);\n\tmemcpy(bi->bi_clone + bi->bi_offset,\n\t       bd->bd_bh->b_data + bi->bi_offset, bi->bi_len);\n\tclear_bit(GBF_FULL, &bi->bi_flags);\n\trgd->rd_free_clone = rgd->rd_free;\n\trgd->rd_extfail_pt = rgd->rd_free;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void maybe_release_space(struct gfs2_bufdata *bd)\n{\n\tstruct gfs2_glock *gl = bd->bd_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct gfs2_rgrpd *rgd = gl->gl_object;\n\tunsigned int index = bd->bd_bh->b_blocknr - gl->gl_name.ln_number;\n\tstruct gfs2_bitmap *bi = rgd->rd_bits + index;\n\n\tif (bi->bi_clone == NULL)\n\t\treturn;\n\tif (sdp->sd_args.ar_discard)\n\t\tgfs2_rgrp_send_discards(sdp, rgd->rd_data0, bd->bd_bh, bi, 1, NULL);\n\tmemcpy(bi->bi_clone + bi->bi_offset,\n\t       bd->bd_bh->b_data + bi->bi_offset, bi->bi_len);\n\tclear_bit(GBF_FULL, &bi->bi_flags);\n\trgd->rd_free_clone = rgd->rd_free;\n\trgd->rd_extfail_pt = rgd->rd_free;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_is_rgrp",
          "args": [
            "bd"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "buffer_is_rgrp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
          "lines": "65-68",
          "snippet": "static bool buffer_is_rgrp(const struct gfs2_bufdata *bd)\n{\n\treturn bd->bd_gl->gl_name.ln_type == LM_TYPE_RGRP;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"glock.h\"",
            "#include \"inode.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/list_sort.h>",
            "#include <linux/fs.h>",
            "#include <linux/bio.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/mempool.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic bool buffer_is_rgrp(const struct gfs2_bufdata *bd)\n{\n\treturn bd->bd_gl->gl_name.ln_type == LM_TYPE_RGRP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_buffer_pinned",
          "args": [
            "bh"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!buffer_pinned(bh)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_pinned",
          "args": [
            "bh"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!buffer_uptodate(bh)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_unpin(struct gfs2_sbd *sdp, struct buffer_head *bh,\n\t\t       struct gfs2_trans *tr)\n{\n\tstruct gfs2_bufdata *bd = bh->b_private;\n\n\tBUG_ON(!buffer_uptodate(bh));\n\tBUG_ON(!buffer_pinned(bh));\n\n\tlock_buffer(bh);\n\tmark_buffer_dirty(bh);\n\tclear_buffer_pinned(bh);\n\n\tif (buffer_is_rgrp(bd))\n\t\tmaybe_release_space(bd);\n\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr) {\n\t\tlist_del(&bd->bd_ail_st_list);\n\t\tbrelse(bh);\n\t} else {\n\t\tstruct gfs2_glock *gl = bd->bd_gl;\n\t\tlist_add(&bd->bd_ail_gl_list, &gl->gl_ail_list);\n\t\tatomic_inc(&gl->gl_ail_count);\n\t}\n\tbd->bd_tr = tr;\n\tlist_add(&bd->bd_ail_st_list, &tr->tr_ail1_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\n\tclear_bit(GLF_LFLUSH, &bd->bd_gl->gl_flags);\n\ttrace_gfs2_pin(bd, 0);\n\tunlock_buffer(bh);\n\tatomic_dec(&sdp->sd_log_pinned);\n}"
  },
  {
    "function_name": "maybe_release_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "70-87",
    "snippet": "static void maybe_release_space(struct gfs2_bufdata *bd)\n{\n\tstruct gfs2_glock *gl = bd->bd_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct gfs2_rgrpd *rgd = gl->gl_object;\n\tunsigned int index = bd->bd_bh->b_blocknr - gl->gl_name.ln_number;\n\tstruct gfs2_bitmap *bi = rgd->rd_bits + index;\n\n\tif (bi->bi_clone == NULL)\n\t\treturn;\n\tif (sdp->sd_args.ar_discard)\n\t\tgfs2_rgrp_send_discards(sdp, rgd->rd_data0, bd->bd_bh, bi, 1, NULL);\n\tmemcpy(bi->bi_clone + bi->bi_offset,\n\t       bd->bd_bh->b_data + bi->bi_offset, bi->bi_len);\n\tclear_bit(GBF_FULL, &bi->bi_flags);\n\trgd->rd_free_clone = rgd->rd_free;\n\trgd->rd_extfail_pt = rgd->rd_free;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GBF_FULL",
            "&bi->bi_flags"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "bi->bi_clone + bi->bi_offset",
            "bd->bd_bh->b_data + bi->bi_offset",
            "bi->bi_len"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_rgrp_send_discards",
          "args": [
            "sdp",
            "rgd->rd_data0",
            "bd->bd_bh",
            "bi",
            "1",
            "NULL"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_rgrp_send_discards",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/rgrp.c",
          "lines": "1267-1332",
          "snippet": "int gfs2_rgrp_send_discards(struct gfs2_sbd *sdp, u64 offset,\n\t\t\t     struct buffer_head *bh,\n\t\t\t     const struct gfs2_bitmap *bi, unsigned minlen, u64 *ptrimmed)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tu64 blk;\n\tsector_t start = 0;\n\tsector_t nr_blks = 0;\n\tint rv;\n\tunsigned int x;\n\tu32 trimmed = 0;\n\tu8 diff;\n\n\tfor (x = 0; x < bi->bi_len; x++) {\n\t\tconst u8 *clone = bi->bi_clone ? bi->bi_clone : bi->bi_bh->b_data;\n\t\tclone += bi->bi_offset;\n\t\tclone += x;\n\t\tif (bh) {\n\t\t\tconst u8 *orig = bh->b_data + bi->bi_offset + x;\n\t\t\tdiff = ~(*orig | (*orig >> 1)) & (*clone | (*clone >> 1));\n\t\t} else {\n\t\t\tdiff = ~(*clone | (*clone >> 1));\n\t\t}\n\t\tdiff &= 0x55;\n\t\tif (diff == 0)\n\t\t\tcontinue;\n\t\tblk = offset + ((bi->bi_start + x) * GFS2_NBBY);\n\t\twhile(diff) {\n\t\t\tif (diff & 1) {\n\t\t\t\tif (nr_blks == 0)\n\t\t\t\t\tgoto start_new_extent;\n\t\t\t\tif ((start + nr_blks) != blk) {\n\t\t\t\t\tif (nr_blks >= minlen) {\n\t\t\t\t\t\trv = sb_issue_discard(sb,\n\t\t\t\t\t\t\tstart, nr_blks,\n\t\t\t\t\t\t\tGFP_NOFS, 0);\n\t\t\t\t\t\tif (rv)\n\t\t\t\t\t\t\tgoto fail;\n\t\t\t\t\t\ttrimmed += nr_blks;\n\t\t\t\t\t}\n\t\t\t\t\tnr_blks = 0;\nstart_new_extent:\n\t\t\t\t\tstart = blk;\n\t\t\t\t}\n\t\t\t\tnr_blks++;\n\t\t\t}\n\t\t\tdiff >>= 2;\n\t\t\tblk++;\n\t\t}\n\t}\n\tif (nr_blks >= minlen) {\n\t\trv = sb_issue_discard(sb, start, nr_blks, GFP_NOFS, 0);\n\t\tif (rv)\n\t\t\tgoto fail;\n\t\ttrimmed += nr_blks;\n\t}\n\tif (ptrimmed)\n\t\t*ptrimmed = trimmed;\n\treturn 0;\n\nfail:\n\tif (sdp->sd_args.ar_discard)\n\t\tfs_warn(sdp, \"error %d on discard request, turning discards off for this filesystem\", rv);\n\tsdp->sd_args.ar_discard = 0;\n\treturn -EIO;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"inode.h\"",
            "#include \"log.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/random.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"inode.h\"\n#include \"log.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/random.h>\n#include <linux/rbtree.h>\n#include <linux/blkdev.h>\n#include <linux/prefetch.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nint gfs2_rgrp_send_discards(struct gfs2_sbd *sdp, u64 offset,\n\t\t\t     struct buffer_head *bh,\n\t\t\t     const struct gfs2_bitmap *bi, unsigned minlen, u64 *ptrimmed)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tu64 blk;\n\tsector_t start = 0;\n\tsector_t nr_blks = 0;\n\tint rv;\n\tunsigned int x;\n\tu32 trimmed = 0;\n\tu8 diff;\n\n\tfor (x = 0; x < bi->bi_len; x++) {\n\t\tconst u8 *clone = bi->bi_clone ? bi->bi_clone : bi->bi_bh->b_data;\n\t\tclone += bi->bi_offset;\n\t\tclone += x;\n\t\tif (bh) {\n\t\t\tconst u8 *orig = bh->b_data + bi->bi_offset + x;\n\t\t\tdiff = ~(*orig | (*orig >> 1)) & (*clone | (*clone >> 1));\n\t\t} else {\n\t\t\tdiff = ~(*clone | (*clone >> 1));\n\t\t}\n\t\tdiff &= 0x55;\n\t\tif (diff == 0)\n\t\t\tcontinue;\n\t\tblk = offset + ((bi->bi_start + x) * GFS2_NBBY);\n\t\twhile(diff) {\n\t\t\tif (diff & 1) {\n\t\t\t\tif (nr_blks == 0)\n\t\t\t\t\tgoto start_new_extent;\n\t\t\t\tif ((start + nr_blks) != blk) {\n\t\t\t\t\tif (nr_blks >= minlen) {\n\t\t\t\t\t\trv = sb_issue_discard(sb,\n\t\t\t\t\t\t\tstart, nr_blks,\n\t\t\t\t\t\t\tGFP_NOFS, 0);\n\t\t\t\t\t\tif (rv)\n\t\t\t\t\t\t\tgoto fail;\n\t\t\t\t\t\ttrimmed += nr_blks;\n\t\t\t\t\t}\n\t\t\t\t\tnr_blks = 0;\nstart_new_extent:\n\t\t\t\t\tstart = blk;\n\t\t\t\t}\n\t\t\t\tnr_blks++;\n\t\t\t}\n\t\t\tdiff >>= 2;\n\t\t\tblk++;\n\t\t}\n\t}\n\tif (nr_blks >= minlen) {\n\t\trv = sb_issue_discard(sb, start, nr_blks, GFP_NOFS, 0);\n\t\tif (rv)\n\t\t\tgoto fail;\n\t\ttrimmed += nr_blks;\n\t}\n\tif (ptrimmed)\n\t\t*ptrimmed = trimmed;\n\treturn 0;\n\nfail:\n\tif (sdp->sd_args.ar_discard)\n\t\tfs_warn(sdp, \"error %d on discard request, turning discards off for this filesystem\", rv);\n\tsdp->sd_args.ar_discard = 0;\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void maybe_release_space(struct gfs2_bufdata *bd)\n{\n\tstruct gfs2_glock *gl = bd->bd_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct gfs2_rgrpd *rgd = gl->gl_object;\n\tunsigned int index = bd->bd_bh->b_blocknr - gl->gl_name.ln_number;\n\tstruct gfs2_bitmap *bi = rgd->rd_bits + index;\n\n\tif (bi->bi_clone == NULL)\n\t\treturn;\n\tif (sdp->sd_args.ar_discard)\n\t\tgfs2_rgrp_send_discards(sdp, rgd->rd_data0, bd->bd_bh, bi, 1, NULL);\n\tmemcpy(bi->bi_clone + bi->bi_offset,\n\t       bd->bd_bh->b_data + bi->bi_offset, bi->bi_len);\n\tclear_bit(GBF_FULL, &bi->bi_flags);\n\trgd->rd_free_clone = rgd->rd_free;\n\trgd->rd_extfail_pt = rgd->rd_free;\n}"
  },
  {
    "function_name": "buffer_is_rgrp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "65-68",
    "snippet": "static bool buffer_is_rgrp(const struct gfs2_bufdata *bd)\n{\n\treturn bd->bd_gl->gl_name.ln_type == LM_TYPE_RGRP;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic bool buffer_is_rgrp(const struct gfs2_bufdata *bd)\n{\n\treturn bd->bd_gl->gl_name.ln_type == LM_TYPE_RGRP;\n}"
  },
  {
    "function_name": "gfs2_pin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/lops.c",
    "lines": "41-63",
    "snippet": "void gfs2_pin(struct gfs2_sbd *sdp, struct buffer_head *bh)\n{\n\tstruct gfs2_bufdata *bd;\n\n\tBUG_ON(!current->journal_info);\n\n\tclear_buffer_dirty(bh);\n\tif (test_set_buffer_pinned(bh))\n\t\tgfs2_assert_withdraw(sdp, 0);\n\tif (!buffer_uptodate(bh))\n\t\tgfs2_io_error_bh(sdp, bh);\n\tbd = bh->b_private;\n\t/* If this buffer is in the AIL and it has already been written\n\t * to in-place disk block, remove it from the AIL.\n\t */\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr)\n\t\tlist_move(&bd->bd_ail_st_list, &bd->bd_tr->tr_ail2_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\tget_bh(bh);\n\tatomic_inc(&sdp->sd_log_pinned);\n\ttrace_gfs2_pin(bd, 1);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"util.h\"",
      "#include \"trans.h\"",
      "#include \"rgrp.h\"",
      "#include \"recovery.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"log.h\"",
      "#include \"glock.h\"",
      "#include \"inode.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/list_sort.h>",
      "#include <linux/fs.h>",
      "#include <linux/bio.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/mempool.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_gfs2_pin",
          "args": [
            "bd",
            "1"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&sdp->sd_log_pinned"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "bh"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sdp->sd_ail_lock"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_move",
          "args": [
            "&bd->bd_ail_st_list",
            "&bd->bd_tr->tr_ail2_list"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sdp->sd_ail_lock"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_io_error_bh",
          "args": [
            "sdp",
            "bh"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_assert_withdraw",
          "args": [
            "sdp",
            "0"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_set_buffer_pinned",
          "args": [
            "bh"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!current->journal_info"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"glock.h\"\n#include \"inode.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/list_sort.h>\n#include <linux/fs.h>\n#include <linux/bio.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/mempool.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_pin(struct gfs2_sbd *sdp, struct buffer_head *bh)\n{\n\tstruct gfs2_bufdata *bd;\n\n\tBUG_ON(!current->journal_info);\n\n\tclear_buffer_dirty(bh);\n\tif (test_set_buffer_pinned(bh))\n\t\tgfs2_assert_withdraw(sdp, 0);\n\tif (!buffer_uptodate(bh))\n\t\tgfs2_io_error_bh(sdp, bh);\n\tbd = bh->b_private;\n\t/* If this buffer is in the AIL and it has already been written\n\t * to in-place disk block, remove it from the AIL.\n\t */\n\tspin_lock(&sdp->sd_ail_lock);\n\tif (bd->bd_tr)\n\t\tlist_move(&bd->bd_ail_st_list, &bd->bd_tr->tr_ail2_list);\n\tspin_unlock(&sdp->sd_ail_lock);\n\tget_bh(bh);\n\tatomic_inc(&sdp->sd_log_pinned);\n\ttrace_gfs2_pin(bd, 1);\n}"
  }
]