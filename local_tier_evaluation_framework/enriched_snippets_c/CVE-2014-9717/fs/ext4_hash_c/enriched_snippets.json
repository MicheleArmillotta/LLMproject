[
  {
    "function_name": "ext4fs_dirhash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
    "lines": "139-208",
    "snippet": "int ext4fs_dirhash(const char *name, int len, struct dx_hash_info *hinfo)\n{\n\t__u32\thash;\n\t__u32\tminor_hash = 0;\n\tconst char\t*p;\n\tint\t\ti;\n\t__u32\t\tin[8], buf[4];\n\tvoid\t\t(*str2hashbuf)(const char *, int, __u32 *, int) =\n\t\t\t\tstr2hashbuf_signed;\n\n\t/* Initialize the default seed for the hash checksum functions */\n\tbuf[0] = 0x67452301;\n\tbuf[1] = 0xefcdab89;\n\tbuf[2] = 0x98badcfe;\n\tbuf[3] = 0x10325476;\n\n\t/* Check to see if the seed is all zero's */\n\tif (hinfo->seed) {\n\t\tfor (i = 0; i < 4; i++) {\n\t\t\tif (hinfo->seed[i]) {\n\t\t\t\tmemcpy(buf, hinfo->seed, sizeof(buf));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tswitch (hinfo->hash_version) {\n\tcase DX_HASH_LEGACY_UNSIGNED:\n\t\thash = dx_hack_hash_unsigned(name, len);\n\t\tbreak;\n\tcase DX_HASH_LEGACY:\n\t\thash = dx_hack_hash_signed(name, len);\n\t\tbreak;\n\tcase DX_HASH_HALF_MD4_UNSIGNED:\n\t\tstr2hashbuf = str2hashbuf_unsigned;\n\tcase DX_HASH_HALF_MD4:\n\t\tp = name;\n\t\twhile (len > 0) {\n\t\t\t(*str2hashbuf)(p, len, in, 8);\n\t\t\thalf_md4_transform(buf, in);\n\t\t\tlen -= 32;\n\t\t\tp += 32;\n\t\t}\n\t\tminor_hash = buf[2];\n\t\thash = buf[1];\n\t\tbreak;\n\tcase DX_HASH_TEA_UNSIGNED:\n\t\tstr2hashbuf = str2hashbuf_unsigned;\n\tcase DX_HASH_TEA:\n\t\tp = name;\n\t\twhile (len > 0) {\n\t\t\t(*str2hashbuf)(p, len, in, 4);\n\t\t\tTEA_transform(buf, in);\n\t\t\tlen -= 16;\n\t\t\tp += 16;\n\t\t}\n\t\thash = buf[0];\n\t\tminor_hash = buf[1];\n\t\tbreak;\n\tdefault:\n\t\thinfo->hash = 0;\n\t\treturn -1;\n\t}\n\thash = hash & ~1;\n\tif (hash == (EXT4_HTREE_EOF_32BIT << 1))\n\t\thash = (EXT4_HTREE_EOF_32BIT - 1) << 1;\n\thinfo->hash = hash;\n\thinfo->minor_hash = minor_hash;\n\treturn 0;\n}",
    "includes": [
      "#include \"ext4.h\"",
      "#include <linux/cryptohash.h>",
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TEA_transform",
          "args": [
            "buf",
            "in"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "TEA_transform",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
          "lines": "19-34",
          "snippet": "static void TEA_transform(__u32 buf[4], __u32 const in[])\n{\n\t__u32\tsum = 0;\n\t__u32\tb0 = buf[0], b1 = buf[1];\n\t__u32\ta = in[0], b = in[1], c = in[2], d = in[3];\n\tint\tn = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}",
          "includes": [
            "#include \"ext4.h\"",
            "#include <linux/cryptohash.h>",
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define DELTA 0x9E3779B9"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define DELTA 0x9E3779B9\n\nstatic void TEA_transform(__u32 buf[4], __u32 const in[])\n{\n\t__u32\tsum = 0;\n\t__u32\tb0 = buf[0], b1 = buf[1];\n\t__u32\ta = in[0], b = in[1], c = in[2], d = in[3];\n\tint\tn = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "p",
            "len",
            "in",
            "4"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "half_md4_transform",
          "args": [
            "buf",
            "in"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "p",
            "len",
            "in",
            "8"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dx_hack_hash_signed",
          "args": [
            "name",
            "len"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "dx_hack_hash_signed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
          "lines": "54-68",
          "snippet": "static __u32 dx_hack_hash_signed(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst signed char *scp = (const signed char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *scp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}",
          "includes": [
            "#include \"ext4.h\"",
            "#include <linux/cryptohash.h>",
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic __u32 dx_hack_hash_signed(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst signed char *scp = (const signed char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *scp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dx_hack_hash_unsigned",
          "args": [
            "name",
            "len"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "dx_hack_hash_unsigned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
          "lines": "38-52",
          "snippet": "static __u32 dx_hack_hash_unsigned(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst unsigned char *ucp = (const unsigned char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *ucp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}",
          "includes": [
            "#include \"ext4.h\"",
            "#include <linux/cryptohash.h>",
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic __u32 dx_hack_hash_unsigned(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst unsigned char *ucp = (const unsigned char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *ucp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "hinfo->seed",
            "sizeof(buf)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nint ext4fs_dirhash(const char *name, int len, struct dx_hash_info *hinfo)\n{\n\t__u32\thash;\n\t__u32\tminor_hash = 0;\n\tconst char\t*p;\n\tint\t\ti;\n\t__u32\t\tin[8], buf[4];\n\tvoid\t\t(*str2hashbuf)(const char *, int, __u32 *, int) =\n\t\t\t\tstr2hashbuf_signed;\n\n\t/* Initialize the default seed for the hash checksum functions */\n\tbuf[0] = 0x67452301;\n\tbuf[1] = 0xefcdab89;\n\tbuf[2] = 0x98badcfe;\n\tbuf[3] = 0x10325476;\n\n\t/* Check to see if the seed is all zero's */\n\tif (hinfo->seed) {\n\t\tfor (i = 0; i < 4; i++) {\n\t\t\tif (hinfo->seed[i]) {\n\t\t\t\tmemcpy(buf, hinfo->seed, sizeof(buf));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tswitch (hinfo->hash_version) {\n\tcase DX_HASH_LEGACY_UNSIGNED:\n\t\thash = dx_hack_hash_unsigned(name, len);\n\t\tbreak;\n\tcase DX_HASH_LEGACY:\n\t\thash = dx_hack_hash_signed(name, len);\n\t\tbreak;\n\tcase DX_HASH_HALF_MD4_UNSIGNED:\n\t\tstr2hashbuf = str2hashbuf_unsigned;\n\tcase DX_HASH_HALF_MD4:\n\t\tp = name;\n\t\twhile (len > 0) {\n\t\t\t(*str2hashbuf)(p, len, in, 8);\n\t\t\thalf_md4_transform(buf, in);\n\t\t\tlen -= 32;\n\t\t\tp += 32;\n\t\t}\n\t\tminor_hash = buf[2];\n\t\thash = buf[1];\n\t\tbreak;\n\tcase DX_HASH_TEA_UNSIGNED:\n\t\tstr2hashbuf = str2hashbuf_unsigned;\n\tcase DX_HASH_TEA:\n\t\tp = name;\n\t\twhile (len > 0) {\n\t\t\t(*str2hashbuf)(p, len, in, 4);\n\t\t\tTEA_transform(buf, in);\n\t\t\tlen -= 16;\n\t\t\tp += 16;\n\t\t}\n\t\thash = buf[0];\n\t\tminor_hash = buf[1];\n\t\tbreak;\n\tdefault:\n\t\thinfo->hash = 0;\n\t\treturn -1;\n\t}\n\thash = hash & ~1;\n\tif (hash == (EXT4_HTREE_EOF_32BIT << 1))\n\t\thash = (EXT4_HTREE_EOF_32BIT - 1) << 1;\n\thinfo->hash = hash;\n\thinfo->minor_hash = minor_hash;\n\treturn 0;\n}"
  },
  {
    "function_name": "str2hashbuf_unsigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
    "lines": "98-124",
    "snippet": "static void str2hashbuf_unsigned(const char *msg, int len, __u32 *buf, int num)\n{\n\t__u32\tpad, val;\n\tint\ti;\n\tconst unsigned char *ucp = (const unsigned char *) msg;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num*4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = ((int) ucp[i]) + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}",
    "includes": [
      "#include \"ext4.h\"",
      "#include <linux/cryptohash.h>",
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic void str2hashbuf_unsigned(const char *msg, int len, __u32 *buf, int num)\n{\n\t__u32\tpad, val;\n\tint\ti;\n\tconst unsigned char *ucp = (const unsigned char *) msg;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num*4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = ((int) ucp[i]) + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}"
  },
  {
    "function_name": "str2hashbuf_signed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
    "lines": "70-96",
    "snippet": "static void str2hashbuf_signed(const char *msg, int len, __u32 *buf, int num)\n{\n\t__u32\tpad, val;\n\tint\ti;\n\tconst signed char *scp = (const signed char *) msg;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num*4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = ((int) scp[i]) + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}",
    "includes": [
      "#include \"ext4.h\"",
      "#include <linux/cryptohash.h>",
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic void str2hashbuf_signed(const char *msg, int len, __u32 *buf, int num)\n{\n\t__u32\tpad, val;\n\tint\ti;\n\tconst signed char *scp = (const signed char *) msg;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num*4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = ((int) scp[i]) + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}"
  },
  {
    "function_name": "dx_hack_hash_signed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
    "lines": "54-68",
    "snippet": "static __u32 dx_hack_hash_signed(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst signed char *scp = (const signed char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *scp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}",
    "includes": [
      "#include \"ext4.h\"",
      "#include <linux/cryptohash.h>",
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic __u32 dx_hack_hash_signed(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst signed char *scp = (const signed char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *scp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}"
  },
  {
    "function_name": "dx_hack_hash_unsigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
    "lines": "38-52",
    "snippet": "static __u32 dx_hack_hash_unsigned(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst unsigned char *ucp = (const unsigned char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *ucp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}",
    "includes": [
      "#include \"ext4.h\"",
      "#include <linux/cryptohash.h>",
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic __u32 dx_hack_hash_unsigned(const char *name, int len)\n{\n\t__u32 hash, hash0 = 0x12a3fe2d, hash1 = 0x37abe8f9;\n\tconst unsigned char *ucp = (const unsigned char *) name;\n\n\twhile (len--) {\n\t\thash = hash1 + (hash0 ^ (((int) *ucp++) * 7152373));\n\n\t\tif (hash & 0x80000000)\n\t\t\thash -= 0x7fffffff;\n\t\thash1 = hash0;\n\t\thash0 = hash;\n\t}\n\treturn hash0 << 1;\n}"
  },
  {
    "function_name": "TEA_transform",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/hash.c",
    "lines": "19-34",
    "snippet": "static void TEA_transform(__u32 buf[4], __u32 const in[])\n{\n\t__u32\tsum = 0;\n\t__u32\tb0 = buf[0], b1 = buf[1];\n\t__u32\ta = in[0], b = in[1], c = in[2], d = in[3];\n\tint\tn = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}",
    "includes": [
      "#include \"ext4.h\"",
      "#include <linux/cryptohash.h>",
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define DELTA 0x9E3779B9"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ext4.h\"\n#include <linux/cryptohash.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define DELTA 0x9E3779B9\n\nstatic void TEA_transform(__u32 buf[4], __u32 const in[])\n{\n\t__u32\tsum = 0;\n\t__u32\tb0 = buf[0], b1 = buf[1];\n\t__u32\ta = in[0], b = in[1], c = in[2], d = in[3];\n\tint\tn = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}"
  }
]