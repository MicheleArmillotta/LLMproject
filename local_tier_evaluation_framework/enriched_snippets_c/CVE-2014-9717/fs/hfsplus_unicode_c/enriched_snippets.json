[
  {
    "function_name": "hfsplus_compare_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "388-469",
    "snippet": "int hfsplus_compare_dentry(const struct dentry *parent, const struct dentry *dentry,\n\t\tunsigned int len, const char *str, const struct qstr *name)\n{\n\tstruct super_block *sb = parent->d_sb;\n\tint casefold, decompose, size;\n\tint dsize1, dsize2, len1, len2;\n\tconst u16 *dstr1, *dstr2;\n\tconst char *astr1, *astr2;\n\tu16 c1, c2;\n\twchar_t c;\n\n\tcasefold = test_bit(HFSPLUS_SB_CASEFOLD, &HFSPLUS_SB(sb)->flags);\n\tdecompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\tastr1 = str;\n\tlen1 = len;\n\tastr2 = name->name;\n\tlen2 = name->len;\n\tdsize1 = dsize2 = 0;\n\tdstr1 = dstr2 = NULL;\n\n\twhile (len1 > 0 && len2 > 0) {\n\t\tif (!dsize1) {\n\t\t\tsize = asc2unichar(sb, astr1, len1, &c);\n\t\t\tastr1 += size;\n\t\t\tlen1 -= size;\n\n\t\t\tif (decompose)\n\t\t\t\tdstr1 = decompose_unichar(c, &dsize1);\n\t\t\tif (!decompose || !dstr1) {\n\t\t\t\tc1 = c;\n\t\t\t\tdstr1 = &c1;\n\t\t\t\tdsize1 = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (!dsize2) {\n\t\t\tsize = asc2unichar(sb, astr2, len2, &c);\n\t\t\tastr2 += size;\n\t\t\tlen2 -= size;\n\n\t\t\tif (decompose)\n\t\t\t\tdstr2 = decompose_unichar(c, &dsize2);\n\t\t\tif (!decompose || !dstr2) {\n\t\t\t\tc2 = c;\n\t\t\t\tdstr2 = &c2;\n\t\t\t\tdsize2 = 1;\n\t\t\t}\n\t\t}\n\n\t\tc1 = *dstr1;\n\t\tc2 = *dstr2;\n\t\tif (casefold) {\n\t\t\tc1 = case_fold(c1);\n\t\t\tif (!c1) {\n\t\t\t\tdstr1++;\n\t\t\t\tdsize1--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tc2 = case_fold(c2);\n\t\t\tif (!c2) {\n\t\t\t\tdstr2++;\n\t\t\t\tdsize2--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif (c1 < c2)\n\t\t\treturn -1;\n\t\telse if (c1 > c2)\n\t\t\treturn 1;\n\n\t\tdstr1++;\n\t\tdsize1--;\n\t\tdstr2++;\n\t\tdsize2--;\n\t}\n\n\tif (len1 < len2)\n\t\treturn -1;\n\tif (len1 > len2)\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "case_fold",
          "args": [
            "c2"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "case_fold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "18-28",
          "snippet": "static inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decompose_unichar",
          "args": [
            "c",
            "&dsize2"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "decompose_unichar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "275-296",
          "snippet": "static inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "asc2unichar",
          "args": [
            "sb",
            "astr2",
            "len2",
            "&c"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "asc2unichar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "255-272",
          "snippet": "static inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HFSPLUS_SB_NODECOMPOSE",
            "&HFSPLUS_SB(sb)->flags"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "sb"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "HFSPLUS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/hfsplus_fs.h",
          "lines": "202-205",
          "snippet": "static inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/mutex.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/fs.h>\n\nstatic inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nint hfsplus_compare_dentry(const struct dentry *parent, const struct dentry *dentry,\n\t\tunsigned int len, const char *str, const struct qstr *name)\n{\n\tstruct super_block *sb = parent->d_sb;\n\tint casefold, decompose, size;\n\tint dsize1, dsize2, len1, len2;\n\tconst u16 *dstr1, *dstr2;\n\tconst char *astr1, *astr2;\n\tu16 c1, c2;\n\twchar_t c;\n\n\tcasefold = test_bit(HFSPLUS_SB_CASEFOLD, &HFSPLUS_SB(sb)->flags);\n\tdecompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\tastr1 = str;\n\tlen1 = len;\n\tastr2 = name->name;\n\tlen2 = name->len;\n\tdsize1 = dsize2 = 0;\n\tdstr1 = dstr2 = NULL;\n\n\twhile (len1 > 0 && len2 > 0) {\n\t\tif (!dsize1) {\n\t\t\tsize = asc2unichar(sb, astr1, len1, &c);\n\t\t\tastr1 += size;\n\t\t\tlen1 -= size;\n\n\t\t\tif (decompose)\n\t\t\t\tdstr1 = decompose_unichar(c, &dsize1);\n\t\t\tif (!decompose || !dstr1) {\n\t\t\t\tc1 = c;\n\t\t\t\tdstr1 = &c1;\n\t\t\t\tdsize1 = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (!dsize2) {\n\t\t\tsize = asc2unichar(sb, astr2, len2, &c);\n\t\t\tastr2 += size;\n\t\t\tlen2 -= size;\n\n\t\t\tif (decompose)\n\t\t\t\tdstr2 = decompose_unichar(c, &dsize2);\n\t\t\tif (!decompose || !dstr2) {\n\t\t\t\tc2 = c;\n\t\t\t\tdstr2 = &c2;\n\t\t\t\tdsize2 = 1;\n\t\t\t}\n\t\t}\n\n\t\tc1 = *dstr1;\n\t\tc2 = *dstr2;\n\t\tif (casefold) {\n\t\t\tc1 = case_fold(c1);\n\t\t\tif (!c1) {\n\t\t\t\tdstr1++;\n\t\t\t\tdsize1--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tc2 = case_fold(c2);\n\t\t\tif (!c2) {\n\t\t\t\tdstr2++;\n\t\t\t\tdsize2--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif (c1 < c2)\n\t\t\treturn -1;\n\t\telse if (c1 > c2)\n\t\t\treturn 1;\n\n\t\tdstr1++;\n\t\tdsize1--;\n\t\tdstr2++;\n\t\tdsize2--;\n\t}\n\n\tif (len1 < len2)\n\t\treturn -1;\n\tif (len1 > len2)\n\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "hfsplus_hash_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "337-381",
    "snippet": "int hfsplus_hash_dentry(const struct dentry *dentry, struct qstr *str)\n{\n\tstruct super_block *sb = dentry->d_sb;\n\tconst char *astr;\n\tconst u16 *dstr;\n\tint casefold, decompose, size, len;\n\tunsigned long hash;\n\twchar_t c;\n\tu16 c2;\n\n\tcasefold = test_bit(HFSPLUS_SB_CASEFOLD, &HFSPLUS_SB(sb)->flags);\n\tdecompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\thash = init_name_hash();\n\tastr = str->name;\n\tlen = str->len;\n\twhile (len > 0) {\n\t\tint uninitialized_var(dsize);\n\t\tsize = asc2unichar(sb, astr, len, &c);\n\t\tastr += size;\n\t\tlen -= size;\n\n\t\tif (decompose)\n\t\t\tdstr = decompose_unichar(c, &dsize);\n\t\telse\n\t\t\tdstr = NULL;\n\t\tif (dstr) {\n\t\t\tdo {\n\t\t\t\tc2 = *dstr++;\n\t\t\t\tif (casefold)\n\t\t\t\t\tc2 = case_fold(c2);\n\t\t\t\tif (!casefold || c2)\n\t\t\t\t\thash = partial_name_hash(c2, hash);\n\t\t\t} while (--dsize > 0);\n\t\t} else {\n\t\t\tc2 = c;\n\t\t\tif (casefold)\n\t\t\t\tc2 = case_fold(c2);\n\t\t\tif (!casefold || c2)\n\t\t\t\thash = partial_name_hash(c2, hash);\n\t\t}\n\t}\n\tstr->hash = end_name_hash(hash);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "end_name_hash",
          "args": [
            "hash"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "partial_name_hash",
          "args": [
            "c2",
            "hash"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "case_fold",
          "args": [
            "c2"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "case_fold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "18-28",
          "snippet": "static inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "partial_name_hash",
          "args": [
            "c2",
            "hash"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decompose_unichar",
          "args": [
            "c",
            "&dsize"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "decompose_unichar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "275-296",
          "snippet": "static inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "asc2unichar",
          "args": [
            "sb",
            "astr",
            "len",
            "&c"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "asc2unichar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "255-272",
          "snippet": "static inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_name_hash",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HFSPLUS_SB_NODECOMPOSE",
            "&HFSPLUS_SB(sb)->flags"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "sb"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "HFSPLUS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/hfsplus_fs.h",
          "lines": "202-205",
          "snippet": "static inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/mutex.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/fs.h>\n\nstatic inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nint hfsplus_hash_dentry(const struct dentry *dentry, struct qstr *str)\n{\n\tstruct super_block *sb = dentry->d_sb;\n\tconst char *astr;\n\tconst u16 *dstr;\n\tint casefold, decompose, size, len;\n\tunsigned long hash;\n\twchar_t c;\n\tu16 c2;\n\n\tcasefold = test_bit(HFSPLUS_SB_CASEFOLD, &HFSPLUS_SB(sb)->flags);\n\tdecompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\thash = init_name_hash();\n\tastr = str->name;\n\tlen = str->len;\n\twhile (len > 0) {\n\t\tint uninitialized_var(dsize);\n\t\tsize = asc2unichar(sb, astr, len, &c);\n\t\tastr += size;\n\t\tlen -= size;\n\n\t\tif (decompose)\n\t\t\tdstr = decompose_unichar(c, &dsize);\n\t\telse\n\t\t\tdstr = NULL;\n\t\tif (dstr) {\n\t\t\tdo {\n\t\t\t\tc2 = *dstr++;\n\t\t\t\tif (casefold)\n\t\t\t\t\tc2 = case_fold(c2);\n\t\t\t\tif (!casefold || c2)\n\t\t\t\t\thash = partial_name_hash(c2, hash);\n\t\t\t} while (--dsize > 0);\n\t\t} else {\n\t\t\tc2 = c;\n\t\t\tif (casefold)\n\t\t\t\tc2 = case_fold(c2);\n\t\t\tif (!casefold || c2)\n\t\t\t\thash = partial_name_hash(c2, hash);\n\t\t}\n\t}\n\tstr->hash = end_name_hash(hash);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hfsplus_asc2uni",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "298-330",
    "snippet": "int hfsplus_asc2uni(struct super_block *sb,\n\t\t    struct hfsplus_unistr *ustr, int max_unistr_len,\n\t\t    const char *astr, int len)\n{\n\tint size, dsize, decompose;\n\tu16 *dstr, outlen = 0;\n\twchar_t c;\n\n\tdecompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\twhile (outlen < max_unistr_len && len > 0) {\n\t\tsize = asc2unichar(sb, astr, len, &c);\n\n\t\tif (decompose)\n\t\t\tdstr = decompose_unichar(c, &dsize);\n\t\telse\n\t\t\tdstr = NULL;\n\t\tif (dstr) {\n\t\t\tif (outlen + dsize > max_unistr_len)\n\t\t\t\tbreak;\n\t\t\tdo {\n\t\t\t\tustr->unicode[outlen++] = cpu_to_be16(*dstr++);\n\t\t\t} while (--dsize > 0);\n\t\t} else\n\t\t\tustr->unicode[outlen++] = cpu_to_be16(c);\n\n\t\tastr += size;\n\t\tlen -= size;\n\t}\n\tustr->length = cpu_to_be16(outlen);\n\tif (len > 0)\n\t\treturn -ENAMETOOLONG;\n\treturn 0;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be16",
          "args": [
            "outlen"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be16",
          "args": [
            "c"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be16",
          "args": [
            "*dstr++"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decompose_unichar",
          "args": [
            "c",
            "&dsize"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "decompose_unichar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "275-296",
          "snippet": "static inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "asc2unichar",
          "args": [
            "sb",
            "astr",
            "len",
            "&c"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "asc2unichar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "255-272",
          "snippet": "static inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HFSPLUS_SB_NODECOMPOSE",
            "&HFSPLUS_SB(sb)->flags"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "sb"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "HFSPLUS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/hfsplus_fs.h",
          "lines": "202-205",
          "snippet": "static inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/mutex.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/fs.h>\n\nstatic inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nint hfsplus_asc2uni(struct super_block *sb,\n\t\t    struct hfsplus_unistr *ustr, int max_unistr_len,\n\t\t    const char *astr, int len)\n{\n\tint size, dsize, decompose;\n\tu16 *dstr, outlen = 0;\n\twchar_t c;\n\n\tdecompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\twhile (outlen < max_unistr_len && len > 0) {\n\t\tsize = asc2unichar(sb, astr, len, &c);\n\n\t\tif (decompose)\n\t\t\tdstr = decompose_unichar(c, &dsize);\n\t\telse\n\t\t\tdstr = NULL;\n\t\tif (dstr) {\n\t\t\tif (outlen + dsize > max_unistr_len)\n\t\t\t\tbreak;\n\t\t\tdo {\n\t\t\t\tustr->unicode[outlen++] = cpu_to_be16(*dstr++);\n\t\t\t} while (--dsize > 0);\n\t\t} else\n\t\t\tustr->unicode[outlen++] = cpu_to_be16(c);\n\n\t\tastr += size;\n\t\tlen -= size;\n\t}\n\tustr->length = cpu_to_be16(outlen);\n\tif (len > 0)\n\t\treturn -ENAMETOOLONG;\n\treturn 0;\n}"
  },
  {
    "function_name": "decompose_unichar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "275-296",
    "snippet": "static inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 *decompose_unichar(wchar_t uc, int *size)\n{\n\tint off;\n\n\toff = hfsplus_decompose_table[(uc >> 12) & 0xf];\n\tif (off == 0 || off == 0xffff)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 8) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + ((uc >> 4) & 0xf)];\n\tif (!off)\n\t\treturn NULL;\n\n\toff = hfsplus_decompose_table[off + (uc & 0xf)];\n\t*size = off & 3;\n\tif (*size == 0)\n\t\treturn NULL;\n\treturn hfsplus_decompose_table + (off / 4);\n}"
  },
  {
    "function_name": "asc2unichar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "255-272",
    "snippet": "static inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "astr",
            "len",
            "uc"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "sb"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "HFSPLUS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/hfsplus_fs.h",
          "lines": "202-205",
          "snippet": "static inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/mutex.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/fs.h>\n\nstatic inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline int asc2unichar(struct super_block *sb, const char *astr, int len,\n\t\t\t      wchar_t *uc)\n{\n\tint size = HFSPLUS_SB(sb)->nls->char2uni(astr, len, uc);\n\tif (size <= 0) {\n\t\t*uc = '?';\n\t\tsize = 1;\n\t}\n\tswitch (*uc) {\n\tcase 0x2400:\n\t\t*uc = 0;\n\t\tbreak;\n\tcase ':':\n\t\t*uc = '/';\n\t\tbreak;\n\t}\n\treturn size;\n}"
  },
  {
    "function_name": "hfsplus_uni2asc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "121-249",
    "snippet": "int hfsplus_uni2asc(struct super_block *sb,\n\t\tconst struct hfsplus_unistr *ustr,\n\t\tchar *astr, int *len_p)\n{\n\tconst hfsplus_unichr *ip;\n\tstruct nls_table *nls = HFSPLUS_SB(sb)->nls;\n\tu8 *op;\n\tu16 cc, c0, c1;\n\tu16 *ce1, *ce2;\n\tint i, len, ustrlen, res, compose;\n\n\top = astr;\n\tip = ustr->unicode;\n\tustrlen = be16_to_cpu(ustr->length);\n\tlen = *len_p;\n\tce1 = NULL;\n\tcompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\n\twhile (ustrlen > 0) {\n\t\tc0 = be16_to_cpu(*ip++);\n\t\tustrlen--;\n\t\t/* search for single decomposed char */\n\t\tif (likely(compose))\n\t\t\tce1 = hfsplus_compose_lookup(hfsplus_compose_table, c0);\n\t\tif (ce1)\n\t\t\tcc = ce1[0];\n\t\telse\n\t\t\tcc = 0;\n\t\tif (cc) {\n\t\t\t/* start of a possibly decomposed Hangul char */\n\t\t\tif (cc != 0xffff)\n\t\t\t\tgoto done;\n\t\t\tif (!ustrlen)\n\t\t\t\tgoto same;\n\t\t\tc1 = be16_to_cpu(*ip) - Hangul_VBase;\n\t\t\tif (c1 < Hangul_VCount) {\n\t\t\t\t/* compose the Hangul char */\n\t\t\t\tcc = (c0 - Hangul_LBase) * Hangul_VCount;\n\t\t\t\tcc = (cc + c1) * Hangul_TCount;\n\t\t\t\tcc += Hangul_SBase;\n\t\t\t\tip++;\n\t\t\t\tustrlen--;\n\t\t\t\tif (!ustrlen)\n\t\t\t\t\tgoto done;\n\t\t\t\tc1 = be16_to_cpu(*ip) - Hangul_TBase;\n\t\t\t\tif (c1 > 0 && c1 < Hangul_TCount) {\n\t\t\t\t\tcc += c1;\n\t\t\t\t\tip++;\n\t\t\t\t\tustrlen--;\n\t\t\t\t}\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t\twhile (1) {\n\t\t\t/* main loop for common case of not composed chars */\n\t\t\tif (!ustrlen)\n\t\t\t\tgoto same;\n\t\t\tc1 = be16_to_cpu(*ip);\n\t\t\tif (likely(compose))\n\t\t\t\tce1 = hfsplus_compose_lookup(\n\t\t\t\t\thfsplus_compose_table, c1);\n\t\t\tif (ce1)\n\t\t\t\tbreak;\n\t\t\tswitch (c0) {\n\t\t\tcase 0:\n\t\t\t\tc0 = 0x2400;\n\t\t\t\tbreak;\n\t\t\tcase '/':\n\t\t\t\tc0 = ':';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tres = nls->uni2char(c0, op, len);\n\t\t\tif (res < 0) {\n\t\t\t\tif (res == -ENAMETOOLONG)\n\t\t\t\t\tgoto out;\n\t\t\t\t*op = '?';\n\t\t\t\tres = 1;\n\t\t\t}\n\t\t\top += res;\n\t\t\tlen -= res;\n\t\t\tc0 = c1;\n\t\t\tip++;\n\t\t\tustrlen--;\n\t\t}\n\t\tce2 = hfsplus_compose_lookup(ce1, c0);\n\t\tif (ce2) {\n\t\t\ti = 1;\n\t\t\twhile (i < ustrlen) {\n\t\t\t\tce1 = hfsplus_compose_lookup(ce2,\n\t\t\t\t\tbe16_to_cpu(ip[i]));\n\t\t\t\tif (!ce1)\n\t\t\t\t\tbreak;\n\t\t\t\ti++;\n\t\t\t\tce2 = ce1;\n\t\t\t}\n\t\t\tcc = ce2[0];\n\t\t\tif (cc) {\n\t\t\t\tip += i;\n\t\t\t\tustrlen -= i;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\nsame:\n\t\tswitch (c0) {\n\t\tcase 0:\n\t\t\tcc = 0x2400;\n\t\t\tbreak;\n\t\tcase '/':\n\t\t\tcc = ':';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcc = c0;\n\t\t}\ndone:\n\t\tres = nls->uni2char(cc, op, len);\n\t\tif (res < 0) {\n\t\t\tif (res == -ENAMETOOLONG)\n\t\t\t\tgoto out;\n\t\t\t*op = '?';\n\t\t\tres = 1;\n\t\t}\n\t\top += res;\n\t\tlen -= res;\n\t}\n\tres = 0;\nout:\n\t*len_p = (char *)op - astr;\n\treturn res;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define Hangul_TCount\t28",
      "#define Hangul_VCount\t21",
      "#define Hangul_TBase\t0x11a7",
      "#define Hangul_VBase\t0x1161",
      "#define Hangul_LBase\t0x1100",
      "#define Hangul_SBase\t0xac00"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nls->uni2char",
          "args": [
            "cc",
            "op",
            "len"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "uni2char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_cp932.c",
          "lines": "7837-7875",
          "snippet": "static int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};",
            "static const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};\nstatic const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };\n\nstatic int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hfsplus_compose_lookup",
          "args": [
            "ce2",
            "be16_to_cpu(ip[i])"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "hfsplus_compose_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "101-119",
          "snippet": "static u16 *hfsplus_compose_lookup(u16 *p, u16 cc)\n{\n\tint i, s, e;\n\n\ts = 1;\n\te = p[1];\n\tif (!e || cc < p[s * 2] || cc > p[e * 2])\n\t\treturn NULL;\n\tdo {\n\t\ti = (s + e) / 2;\n\t\tif (cc > p[i * 2])\n\t\t\ts = i + 1;\n\t\telse if (cc < p[i * 2])\n\t\t\te = i - 1;\n\t\telse\n\t\t\treturn hfsplus_compose_table + p[i * 2 + 1];\n\t} while (s <= e);\n\treturn NULL;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic u16 *hfsplus_compose_lookup(u16 *p, u16 cc)\n{\n\tint i, s, e;\n\n\ts = 1;\n\te = p[1];\n\tif (!e || cc < p[s * 2] || cc > p[e * 2])\n\t\treturn NULL;\n\tdo {\n\t\ti = (s + e) / 2;\n\t\tif (cc > p[i * 2])\n\t\t\ts = i + 1;\n\t\telse if (cc < p[i * 2])\n\t\t\te = i - 1;\n\t\telse\n\t\t\treturn hfsplus_compose_table + p[i * 2 + 1];\n\t} while (s <= e);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "ip[i]"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "compose"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*ip"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*ip"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*ip"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "compose"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*ip++"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HFSPLUS_SB_NODECOMPOSE",
            "&HFSPLUS_SB(sb)->flags"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "sb"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "HFSPLUS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/hfsplus_fs.h",
          "lines": "202-205",
          "snippet": "static inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/mutex.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/fs.h>\n\nstatic inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "ustr->length"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\n#define Hangul_TCount\t28\n#define Hangul_VCount\t21\n#define Hangul_TBase\t0x11a7\n#define Hangul_VBase\t0x1161\n#define Hangul_LBase\t0x1100\n#define Hangul_SBase\t0xac00\n\nint hfsplus_uni2asc(struct super_block *sb,\n\t\tconst struct hfsplus_unistr *ustr,\n\t\tchar *astr, int *len_p)\n{\n\tconst hfsplus_unichr *ip;\n\tstruct nls_table *nls = HFSPLUS_SB(sb)->nls;\n\tu8 *op;\n\tu16 cc, c0, c1;\n\tu16 *ce1, *ce2;\n\tint i, len, ustrlen, res, compose;\n\n\top = astr;\n\tip = ustr->unicode;\n\tustrlen = be16_to_cpu(ustr->length);\n\tlen = *len_p;\n\tce1 = NULL;\n\tcompose = !test_bit(HFSPLUS_SB_NODECOMPOSE, &HFSPLUS_SB(sb)->flags);\n\n\twhile (ustrlen > 0) {\n\t\tc0 = be16_to_cpu(*ip++);\n\t\tustrlen--;\n\t\t/* search for single decomposed char */\n\t\tif (likely(compose))\n\t\t\tce1 = hfsplus_compose_lookup(hfsplus_compose_table, c0);\n\t\tif (ce1)\n\t\t\tcc = ce1[0];\n\t\telse\n\t\t\tcc = 0;\n\t\tif (cc) {\n\t\t\t/* start of a possibly decomposed Hangul char */\n\t\t\tif (cc != 0xffff)\n\t\t\t\tgoto done;\n\t\t\tif (!ustrlen)\n\t\t\t\tgoto same;\n\t\t\tc1 = be16_to_cpu(*ip) - Hangul_VBase;\n\t\t\tif (c1 < Hangul_VCount) {\n\t\t\t\t/* compose the Hangul char */\n\t\t\t\tcc = (c0 - Hangul_LBase) * Hangul_VCount;\n\t\t\t\tcc = (cc + c1) * Hangul_TCount;\n\t\t\t\tcc += Hangul_SBase;\n\t\t\t\tip++;\n\t\t\t\tustrlen--;\n\t\t\t\tif (!ustrlen)\n\t\t\t\t\tgoto done;\n\t\t\t\tc1 = be16_to_cpu(*ip) - Hangul_TBase;\n\t\t\t\tif (c1 > 0 && c1 < Hangul_TCount) {\n\t\t\t\t\tcc += c1;\n\t\t\t\t\tip++;\n\t\t\t\t\tustrlen--;\n\t\t\t\t}\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t\twhile (1) {\n\t\t\t/* main loop for common case of not composed chars */\n\t\t\tif (!ustrlen)\n\t\t\t\tgoto same;\n\t\t\tc1 = be16_to_cpu(*ip);\n\t\t\tif (likely(compose))\n\t\t\t\tce1 = hfsplus_compose_lookup(\n\t\t\t\t\thfsplus_compose_table, c1);\n\t\t\tif (ce1)\n\t\t\t\tbreak;\n\t\t\tswitch (c0) {\n\t\t\tcase 0:\n\t\t\t\tc0 = 0x2400;\n\t\t\t\tbreak;\n\t\t\tcase '/':\n\t\t\t\tc0 = ':';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tres = nls->uni2char(c0, op, len);\n\t\t\tif (res < 0) {\n\t\t\t\tif (res == -ENAMETOOLONG)\n\t\t\t\t\tgoto out;\n\t\t\t\t*op = '?';\n\t\t\t\tres = 1;\n\t\t\t}\n\t\t\top += res;\n\t\t\tlen -= res;\n\t\t\tc0 = c1;\n\t\t\tip++;\n\t\t\tustrlen--;\n\t\t}\n\t\tce2 = hfsplus_compose_lookup(ce1, c0);\n\t\tif (ce2) {\n\t\t\ti = 1;\n\t\t\twhile (i < ustrlen) {\n\t\t\t\tce1 = hfsplus_compose_lookup(ce2,\n\t\t\t\t\tbe16_to_cpu(ip[i]));\n\t\t\t\tif (!ce1)\n\t\t\t\t\tbreak;\n\t\t\t\ti++;\n\t\t\t\tce2 = ce1;\n\t\t\t}\n\t\t\tcc = ce2[0];\n\t\t\tif (cc) {\n\t\t\t\tip += i;\n\t\t\t\tustrlen -= i;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\nsame:\n\t\tswitch (c0) {\n\t\tcase 0:\n\t\t\tcc = 0x2400;\n\t\t\tbreak;\n\t\tcase '/':\n\t\t\tcc = ':';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcc = c0;\n\t\t}\ndone:\n\t\tres = nls->uni2char(cc, op, len);\n\t\tif (res < 0) {\n\t\t\tif (res == -ENAMETOOLONG)\n\t\t\t\tgoto out;\n\t\t\t*op = '?';\n\t\t\tres = 1;\n\t\t}\n\t\top += res;\n\t\tlen -= res;\n\t}\n\tres = 0;\nout:\n\t*len_p = (char *)op - astr;\n\treturn res;\n}"
  },
  {
    "function_name": "hfsplus_compose_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "101-119",
    "snippet": "static u16 *hfsplus_compose_lookup(u16 *p, u16 cc)\n{\n\tint i, s, e;\n\n\ts = 1;\n\te = p[1];\n\tif (!e || cc < p[s * 2] || cc > p[e * 2])\n\t\treturn NULL;\n\tdo {\n\t\ti = (s + e) / 2;\n\t\tif (cc > p[i * 2])\n\t\t\ts = i + 1;\n\t\telse if (cc < p[i * 2])\n\t\t\te = i - 1;\n\t\telse\n\t\t\treturn hfsplus_compose_table + p[i * 2 + 1];\n\t} while (s <= e);\n\treturn NULL;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic u16 *hfsplus_compose_lookup(u16 *p, u16 cc)\n{\n\tint i, s, e;\n\n\ts = 1;\n\te = p[1];\n\tif (!e || cc < p[s * 2] || cc > p[e * 2])\n\t\treturn NULL;\n\tdo {\n\t\ti = (s + e) / 2;\n\t\tif (cc > p[i * 2])\n\t\t\ts = i + 1;\n\t\telse if (cc < p[i * 2])\n\t\t\te = i - 1;\n\t\telse\n\t\t\treturn hfsplus_compose_table + p[i * 2 + 1];\n\t} while (s <= e);\n\treturn NULL;\n}"
  },
  {
    "function_name": "hfsplus_strcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "64-87",
    "snippet": "int hfsplus_strcmp(const struct hfsplus_unistr *s1,\n\t\t   const struct hfsplus_unistr *s2)\n{\n\tu16 len1, len2, c1, c2;\n\tconst hfsplus_unichr *p1, *p2;\n\tint len;\n\n\tlen1 = be16_to_cpu(s1->length);\n\tlen2 = be16_to_cpu(s2->length);\n\tp1 = s1->unicode;\n\tp2 = s2->unicode;\n\n\tfor (len = min(len1, len2); len > 0; len--) {\n\t\tc1 = be16_to_cpu(*p1);\n\t\tc2 = be16_to_cpu(*p2);\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tp1++;\n\t\tp2++;\n\t}\n\n\treturn len1 < len2 ? -1 :\n\t       len1 > len2 ? 1 : 0;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*p2"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*p1"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "len1",
            "len2"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "s2->length"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "s1->length"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nint hfsplus_strcmp(const struct hfsplus_unistr *s1,\n\t\t   const struct hfsplus_unistr *s2)\n{\n\tu16 len1, len2, c1, c2;\n\tconst hfsplus_unichr *p1, *p2;\n\tint len;\n\n\tlen1 = be16_to_cpu(s1->length);\n\tlen2 = be16_to_cpu(s2->length);\n\tp1 = s1->unicode;\n\tp2 = s2->unicode;\n\n\tfor (len = min(len1, len2); len > 0; len--) {\n\t\tc1 = be16_to_cpu(*p1);\n\t\tc2 = be16_to_cpu(*p2);\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tp1++;\n\t\tp2++;\n\t}\n\n\treturn len1 < len2 ? -1 :\n\t       len1 > len2 ? 1 : 0;\n}"
  },
  {
    "function_name": "hfsplus_strcasecmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "31-61",
    "snippet": "int hfsplus_strcasecmp(const struct hfsplus_unistr *s1,\n\t\t       const struct hfsplus_unistr *s2)\n{\n\tu16 len1, len2, c1, c2;\n\tconst hfsplus_unichr *p1, *p2;\n\n\tlen1 = be16_to_cpu(s1->length);\n\tlen2 = be16_to_cpu(s2->length);\n\tp1 = s1->unicode;\n\tp2 = s2->unicode;\n\n\twhile (1) {\n\t\tc1 = c2 = 0;\n\n\t\twhile (len1 && !c1) {\n\t\t\tc1 = case_fold(be16_to_cpu(*p1));\n\t\t\tp1++;\n\t\t\tlen1--;\n\t\t}\n\t\twhile (len2 && !c2) {\n\t\t\tc2 = case_fold(be16_to_cpu(*p2));\n\t\t\tp2++;\n\t\t\tlen2--;\n\t\t}\n\n\t\tif (c1 != c2)\n\t\t\treturn (c1 < c2) ? -1 : 1;\n\t\tif (!c1 && !c2)\n\t\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "case_fold",
          "args": [
            "be16_to_cpu(*p2)"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "case_fold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
          "lines": "18-28",
          "snippet": "static inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include \"hfsplus_fs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*p2"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "*p1"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "s2->length"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "s1->length"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nint hfsplus_strcasecmp(const struct hfsplus_unistr *s1,\n\t\t       const struct hfsplus_unistr *s2)\n{\n\tu16 len1, len2, c1, c2;\n\tconst hfsplus_unichr *p1, *p2;\n\n\tlen1 = be16_to_cpu(s1->length);\n\tlen2 = be16_to_cpu(s2->length);\n\tp1 = s1->unicode;\n\tp2 = s2->unicode;\n\n\twhile (1) {\n\t\tc1 = c2 = 0;\n\n\t\twhile (len1 && !c1) {\n\t\t\tc1 = case_fold(be16_to_cpu(*p1));\n\t\t\tp1++;\n\t\t\tlen1--;\n\t\t}\n\t\twhile (len2 && !c2) {\n\t\t\tc2 = case_fold(be16_to_cpu(*p2));\n\t\t\tp2++;\n\t\t\tlen2--;\n\t\t}\n\n\t\tif (c1 != c2)\n\t\t\treturn (c1 < c2) ? -1 : 1;\n\t\tif (!c1 && !c2)\n\t\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "case_fold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/unicode.c",
    "lines": "18-28",
    "snippet": "static inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}",
    "includes": [
      "#include \"hfsplus_raw.h\"",
      "#include \"hfsplus_fs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include \"hfsplus_fs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic inline u16 case_fold(u16 c)\n{\n\tu16 tmp;\n\n\ttmp = hfsplus_case_fold_table[c >> 8];\n\tif (tmp)\n\t\ttmp = hfsplus_case_fold_table[tmp + (c & 0xff)];\n\telse\n\t\ttmp = c;\n\treturn tmp;\n}"
  }
]