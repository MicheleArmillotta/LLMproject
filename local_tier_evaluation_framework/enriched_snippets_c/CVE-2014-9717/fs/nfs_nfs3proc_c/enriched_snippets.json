[
  {
    "function_name": "nfs3_return_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "881-885",
    "snippet": "static int nfs3_return_delegation(struct inode *inode)\n{\n\tnfs_wb_all(inode);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_wb_all",
          "args": [
            "inode"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wb_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1841-1857",
          "snippet": "int nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_return_delegation(struct inode *inode)\n{\n\tnfs_wb_all(inode);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs3_have_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "876-879",
    "snippet": "static int nfs3_have_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_have_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs3_proc_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "868-874",
    "snippet": "static int\nnfs3_proc_lock(struct file *filp, int cmd, struct file_lock *fl)\n{\n\tstruct inode *inode = file_inode(filp);\n\n\treturn nlmclnt_proc(NFS_SERVER(inode)->nlm_host, cmd, fl);\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlmclnt_proc",
          "args": [
            "NFS_SERVER(inode)->nlm_host",
            "cmd",
            "fl"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "nlmclnt_proc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clntproc.c",
          "lines": "155-188",
          "snippet": "int nlmclnt_proc(struct nlm_host *host, int cmd, struct file_lock *fl)\n{\n\tstruct nlm_rqst\t\t*call;\n\tint\t\t\tstatus;\n\n\tcall = nlm_alloc_call(host);\n\tif (call == NULL)\n\t\treturn -ENOMEM;\n\n\tnlmclnt_locks_init_private(fl, host);\n\tif (!fl->fl_u.nfs_fl.owner) {\n\t\t/* lockowner allocation has failed */\n\t\tnlmclnt_release_call(call);\n\t\treturn -ENOMEM;\n\t}\n\t/* Set up the argument struct */\n\tnlmclnt_setlockargs(call, fl);\n\n\tif (IS_SETLK(cmd) || IS_SETLKW(cmd)) {\n\t\tif (fl->fl_type != F_UNLCK) {\n\t\t\tcall->a_args.block = IS_SETLKW(cmd) ? 1 : 0;\n\t\t\tstatus = nlmclnt_lock(call, fl);\n\t\t} else\n\t\t\tstatus = nlmclnt_unlock(call, fl);\n\t} else if (IS_GETLK(cmd))\n\t\tstatus = nlmclnt_test(call, fl);\n\telse\n\t\tstatus = -EINVAL;\n\tfl->fl_ops->fl_release_private(fl);\n\tfl->fl_ops = NULL;\n\n\tdprintk(\"lockd: clnt proc returns %d\\n\", status);\n\treturn status;\n}",
          "includes": [
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tnlmclnt_test(struct nlm_rqst *, struct file_lock *);",
            "static int\tnlmclnt_lock(struct nlm_rqst *, struct file_lock *);",
            "static int\tnlmclnt_unlock(struct nlm_rqst *, struct file_lock *);",
            "static void\tnlmclnt_locks_init_private(struct file_lock *fl, struct nlm_host *host);",
            "static int\tnlmclnt_cancel(struct nlm_host *, int , struct file_lock *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstatic int\tnlmclnt_test(struct nlm_rqst *, struct file_lock *);\nstatic int\tnlmclnt_lock(struct nlm_rqst *, struct file_lock *);\nstatic int\tnlmclnt_unlock(struct nlm_rqst *, struct file_lock *);\nstatic void\tnlmclnt_locks_init_private(struct file_lock *fl, struct nlm_host *host);\nstatic int\tnlmclnt_cancel(struct nlm_host *, int , struct file_lock *);\n\nint nlmclnt_proc(struct nlm_host *host, int cmd, struct file_lock *fl)\n{\n\tstruct nlm_rqst\t\t*call;\n\tint\t\t\tstatus;\n\n\tcall = nlm_alloc_call(host);\n\tif (call == NULL)\n\t\treturn -ENOMEM;\n\n\tnlmclnt_locks_init_private(fl, host);\n\tif (!fl->fl_u.nfs_fl.owner) {\n\t\t/* lockowner allocation has failed */\n\t\tnlmclnt_release_call(call);\n\t\treturn -ENOMEM;\n\t}\n\t/* Set up the argument struct */\n\tnlmclnt_setlockargs(call, fl);\n\n\tif (IS_SETLK(cmd) || IS_SETLKW(cmd)) {\n\t\tif (fl->fl_type != F_UNLCK) {\n\t\t\tcall->a_args.block = IS_SETLKW(cmd) ? 1 : 0;\n\t\t\tstatus = nlmclnt_lock(call, fl);\n\t\t} else\n\t\t\tstatus = nlmclnt_unlock(call, fl);\n\t} else if (IS_GETLK(cmd))\n\t\tstatus = nlmclnt_test(call, fl);\n\telse\n\t\tstatus = -EINVAL;\n\tfl->fl_ops->fl_release_private(fl);\n\tfl->fl_ops = NULL;\n\n\tdprintk(\"lockd: clnt proc returns %d\\n\", status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "filp"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_init_file_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/file.c",
          "lines": "3009-3013",
          "snippet": "void fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}",
          "includes": [
            "#include <linux/falloc.h>",
            "#include <linux/aio.h>",
            "#include <linux/swap.h>",
            "#include <linux/compat.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};",
            "static const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/falloc.h>\n#include <linux/aio.h>\n#include <linux/swap.h>\n#include <linux/compat.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};\nstatic const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};\n\nvoid fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_lock(struct file *filp, int cmd, struct file_lock *fl)\n{\n\tstruct inode *inode = file_inode(filp);\n\n\treturn nlmclnt_proc(NFS_SERVER(inode)->nlm_host, cmd, fl);\n}"
  },
  {
    "function_name": "nfs3_proc_commit_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "863-866",
    "snippet": "static void nfs3_proc_commit_setup(struct nfs_commit_data *data, struct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_COMMIT];\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_proc_commit_setup(struct nfs_commit_data *data, struct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_COMMIT];\n}"
  },
  {
    "function_name": "nfs3_commit_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "852-861",
    "snippet": "static int nfs3_commit_done(struct rpc_task *task, struct nfs_commit_data *data)\n{\n\tif (data->commit_done_cb != NULL)\n\t\treturn data->commit_done_cb(task, data);\n\n\tif (nfs3_async_handle_jukebox(task, data->inode))\n\t\treturn -EAGAIN;\n\tnfs_refresh_inode(data->inode, data->res.fattr);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "data->inode",
            "data->res.fattr"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_async_handle_jukebox",
          "args": [
            "task",
            "data->inode"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_async_handle_jukebox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "46-57",
          "snippet": "static int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->commit_done_cb",
          "args": [
            "task",
            "data"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_commit_done(struct rpc_task *task, struct nfs_commit_data *data)\n{\n\tif (data->commit_done_cb != NULL)\n\t\treturn data->commit_done_cb(task, data);\n\n\tif (nfs3_async_handle_jukebox(task, data->inode))\n\t\treturn -EAGAIN;\n\tnfs_refresh_inode(data->inode, data->res.fattr);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs3_proc_commit_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "847-850",
    "snippet": "static void nfs3_proc_commit_rpc_prepare(struct rpc_task *task, struct nfs_commit_data *data)\n{\n\trpc_call_start(task);\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_proc_commit_rpc_prepare(struct rpc_task *task, struct nfs_commit_data *data)\n{\n\trpc_call_start(task);\n}"
  },
  {
    "function_name": "nfs3_proc_write_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "841-845",
    "snippet": "static void nfs3_proc_write_setup(struct nfs_pgio_header *hdr,\n\t\t\t\t  struct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_WRITE];\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_proc_write_setup(struct nfs_pgio_header *hdr,\n\t\t\t\t  struct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_WRITE];\n}"
  },
  {
    "function_name": "nfs3_write_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "827-839",
    "snippet": "static int nfs3_write_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tstruct inode *inode = hdr->inode;\n\n\tif (hdr->pgio_done_cb != NULL)\n\t\treturn hdr->pgio_done_cb(task, hdr);\n\n\tif (nfs3_async_handle_jukebox(task, inode))\n\t\treturn -EAGAIN;\n\tif (task->tk_status >= 0)\n\t\tnfs_writeback_update_inode(hdr);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_writeback_update_inode",
          "args": [
            "hdr"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_writeback_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1396-1407",
          "snippet": "void nfs_writeback_update_inode(struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_fattr *fattr = hdr->res.fattr;\n\tstruct inode *inode = hdr->inode;\n\n\tif (fattr == NULL)\n\t\treturn;\n\tspin_lock(&inode->i_lock);\n\tnfs_writeback_check_extend(hdr, fattr);\n\tnfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nvoid nfs_writeback_update_inode(struct nfs_pgio_header *hdr)\n{\n\tstruct nfs_fattr *fattr = hdr->res.fattr;\n\tstruct inode *inode = hdr->inode;\n\n\tif (fattr == NULL)\n\t\treturn;\n\tspin_lock(&inode->i_lock);\n\tnfs_writeback_check_extend(hdr, fattr);\n\tnfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_async_handle_jukebox",
          "args": [
            "task",
            "inode"
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_async_handle_jukebox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "46-57",
          "snippet": "static int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hdr->pgio_done_cb",
          "args": [
            "task",
            "hdr"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_write_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tstruct inode *inode = hdr->inode;\n\n\tif (hdr->pgio_done_cb != NULL)\n\t\treturn hdr->pgio_done_cb(task, hdr);\n\n\tif (nfs3_async_handle_jukebox(task, inode))\n\t\treturn -EAGAIN;\n\tif (task->tk_status >= 0)\n\t\tnfs_writeback_update_inode(hdr);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs3_proc_pgio_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "820-825",
    "snippet": "static int nfs3_proc_pgio_rpc_prepare(struct rpc_task *task,\n\t\t\t\t      struct nfs_pgio_header *hdr)\n{\n\trpc_call_start(task);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_proc_pgio_rpc_prepare(struct rpc_task *task,\n\t\t\t\t      struct nfs_pgio_header *hdr)\n{\n\trpc_call_start(task);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs3_proc_read_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "814-818",
    "snippet": "static void nfs3_proc_read_setup(struct nfs_pgio_header *hdr,\n\t\t\t\t struct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_READ];\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_proc_read_setup(struct nfs_pgio_header *hdr,\n\t\t\t\t struct rpc_message *msg)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_READ];\n}"
  },
  {
    "function_name": "nfs3_read_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "799-812",
    "snippet": "static int nfs3_read_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tstruct inode *inode = hdr->inode;\n\n\tif (hdr->pgio_done_cb != NULL)\n\t\treturn hdr->pgio_done_cb(task, hdr);\n\n\tif (nfs3_async_handle_jukebox(task, inode))\n\t\treturn -EAGAIN;\n\n\tnfs_invalidate_atime(inode);\n\tnfs_refresh_inode(inode, &hdr->fattr);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "&hdr->fattr"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_invalidate_atime",
          "args": [
            "inode"
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_invalidate_atime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "219-224",
          "snippet": "void nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_async_handle_jukebox",
          "args": [
            "task",
            "inode"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_async_handle_jukebox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "46-57",
          "snippet": "static int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hdr->pgio_done_cb",
          "args": [
            "task",
            "hdr"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_read_done(struct rpc_task *task, struct nfs_pgio_header *hdr)\n{\n\tstruct inode *inode = hdr->inode;\n\n\tif (hdr->pgio_done_cb != NULL)\n\t\treturn hdr->pgio_done_cb(task, hdr);\n\n\tif (nfs3_async_handle_jukebox(task, inode))\n\t\treturn -EAGAIN;\n\n\tnfs_invalidate_atime(inode);\n\tnfs_refresh_inode(inode, &hdr->fattr);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs3_proc_pathconf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "781-797",
    "snippet": "static int\nnfs3_proc_pathconf(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t   struct nfs_pathconf *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_PATHCONF],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  pathconf\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply pathconf: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply pathconf: %d\\n\"",
            "status"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "info->fattr"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  pathconf\\n\""
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_pathconf(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t   struct nfs_pathconf *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_PATHCONF],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  pathconf\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply pathconf: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "769-779",
    "snippet": "static int\nnfs3_proc_fsinfo(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t   struct nfs_fsinfo *info)\n{\n\tint\tstatus;\n\n\tstatus = do_proc_fsinfo(server->client, fhandle, info);\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = do_proc_fsinfo(server->nfs_client->cl_rpcclient, fhandle, info);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_proc_fsinfo",
          "args": [
            "server->nfs_client->cl_rpcclient",
            "fhandle",
            "info"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "do_proc_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "747-763",
          "snippet": "static int\ndo_proc_fsinfo(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsinfo\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"NFS reply fsinfo: %d\\n\", status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\ndo_proc_fsinfo(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsinfo\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"NFS reply fsinfo: %d\\n\", status);\n\treturn status;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_fsinfo(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t   struct nfs_fsinfo *info)\n{\n\tint\tstatus;\n\n\tstatus = do_proc_fsinfo(server->client, fhandle, info);\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = do_proc_fsinfo(server->nfs_client->cl_rpcclient, fhandle, info);\n\treturn status;\n}"
  },
  {
    "function_name": "do_proc_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "747-763",
    "snippet": "static int\ndo_proc_fsinfo(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsinfo\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"NFS reply fsinfo: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply fsinfo: %d\\n\"",
            "status"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "client",
            "&msg",
            "0"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "info->fattr"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  fsinfo\\n\""
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\ndo_proc_fsinfo(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsinfo\\n\");\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"NFS reply fsinfo: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "729-745",
    "snippet": "static int\nnfs3_proc_statfs(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t struct nfs_fsstat *stat)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSSTAT],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= stat,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsstat\\n\");\n\tnfs_fattr_init(stat->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply fsstat: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply fsstat: %d\\n\"",
            "status"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "stat->fattr"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  fsstat\\n\""
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_statfs(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t struct nfs_fsstat *stat)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSSTAT],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= stat,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  fsstat\\n\");\n\tnfs_fattr_init(stat->fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply fsstat: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_mknod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "670-727",
    "snippet": "static int\nnfs3_proc_mknod(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\tdev_t rdev)\n{\n\tstruct posix_acl *default_acl, *acl;\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mknod %pd %u:%u\\n\", dentry,\n\t\t\tMAJOR(rdev), MINOR(rdev));\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\n\tstatus = posix_acl_create(dir, &sattr->ia_mode, &default_acl, &acl);\n\tif (status)\n\t\tgoto out;\n\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_MKNOD];\n\tdata->arg.mknod.fh = NFS_FH(dir);\n\tdata->arg.mknod.name = dentry->d_name.name;\n\tdata->arg.mknod.len = dentry->d_name.len;\n\tdata->arg.mknod.sattr = sattr;\n\tdata->arg.mknod.rdev = rdev;\n\n\tswitch (sattr->ia_mode & S_IFMT) {\n\tcase S_IFBLK:\n\t\tdata->arg.mknod.type = NF3BLK;\n\t\tbreak;\n\tcase S_IFCHR:\n\t\tdata->arg.mknod.type = NF3CHR;\n\t\tbreak;\n\tcase S_IFIFO:\n\t\tdata->arg.mknod.type = NF3FIFO;\n\t\tbreak;\n\tcase S_IFSOCK:\n\t\tdata->arg.mknod.type = NF3SOCK;\n\t\tbreak;\n\tdefault:\n\t\tstatus = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tstatus = nfs3_do_create(dir, dentry, data);\n\tif (status != 0)\n\t\tgoto out_release_acls;\n\n\tstatus = nfs3_proc_setacls(dentry->d_inode, acl, default_acl);\n\nout_release_acls:\n\tposix_acl_release(acl);\n\tposix_acl_release(default_acl);\nout:\n\tnfs3_free_createdata(data);\n\tdprintk(\"NFS reply mknod: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply mknod: %d\\n\"",
            "status"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_free_createdata",
          "args": [
            "data"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "310-313",
          "snippet": "static void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "posix_acl_release",
          "args": [
            "default_acl"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "posix_acl_release",
          "args": [
            "acl"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_proc_setacls",
          "args": [
            "dentry->d_inode",
            "acl",
            "default_acl"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_proc_setacls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3acl.c",
          "lines": "205-212",
          "snippet": "int nfs3_proc_setacls(struct inode *inode, struct posix_acl *acl,\n\t\tstruct posix_acl *dfacl)\n{\n\tint ret;\n\tret = __nfs3_proc_setacls(inode, acl, dfacl);\n\treturn (ret == -EOPNOTSUPP) ? 0 : ret;\n\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include <linux/nfsacl.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/gfp.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include <linux/nfsacl.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/gfp.h>\n#include <linux/fs.h>\n\nint nfs3_proc_setacls(struct inode *inode, struct posix_acl *acl,\n\t\tstruct posix_acl *dfacl)\n{\n\tint ret;\n\tret = __nfs3_proc_setacls(inode, acl, dfacl);\n\treturn (ret == -EOPNOTSUPP) ? 0 : ret;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_do_create",
          "args": [
            "dir",
            "dentry",
            "data"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_do_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "299-308",
          "snippet": "static int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "posix_acl_create",
          "args": [
            "dir",
            "&sattr->ia_mode",
            "&default_acl",
            "&acl"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "posix_acl_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/posix_acl.c",
          "lines": "545-598",
          "snippet": "int\nposix_acl_create(struct inode *dir, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\tstruct posix_acl *p;\n\tint ret;\n\n\tif (S_ISLNK(*mode) || !IS_POSIXACL(dir))\n\t\tgoto no_acl;\n\n\tp = get_acl(dir, ACL_TYPE_DEFAULT);\n\tif (IS_ERR(p)) {\n\t\tif (p == ERR_PTR(-EOPNOTSUPP))\n\t\t\tgoto apply_umask;\n\t\treturn PTR_ERR(p);\n\t}\n\n\tif (!p)\n\t\tgoto apply_umask;\n\n\t*acl = posix_acl_clone(p, GFP_NOFS);\n\tif (!*acl)\n\t\tgoto no_mem;\n\n\tret = posix_acl_create_masq(*acl, mode);\n\tif (ret < 0)\n\t\tgoto no_mem_clone;\n\n\tif (ret == 0) {\n\t\tposix_acl_release(*acl);\n\t\t*acl = NULL;\n\t}\n\n\tif (!S_ISDIR(*mode)) {\n\t\tposix_acl_release(p);\n\t\t*default_acl = NULL;\n\t} else {\n\t\t*default_acl = p;\n\t}\n\treturn 0;\n\napply_umask:\n\t*mode &= ~current_umask();\nno_acl:\n\t*default_acl = NULL;\n\t*acl = NULL;\n\treturn 0;\n\nno_mem_clone:\n\tposix_acl_release(*acl);\nno_mem:\n\tposix_acl_release(p);\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/xattr.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/xattr.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint\nposix_acl_create(struct inode *dir, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\tstruct posix_acl *p;\n\tint ret;\n\n\tif (S_ISLNK(*mode) || !IS_POSIXACL(dir))\n\t\tgoto no_acl;\n\n\tp = get_acl(dir, ACL_TYPE_DEFAULT);\n\tif (IS_ERR(p)) {\n\t\tif (p == ERR_PTR(-EOPNOTSUPP))\n\t\t\tgoto apply_umask;\n\t\treturn PTR_ERR(p);\n\t}\n\n\tif (!p)\n\t\tgoto apply_umask;\n\n\t*acl = posix_acl_clone(p, GFP_NOFS);\n\tif (!*acl)\n\t\tgoto no_mem;\n\n\tret = posix_acl_create_masq(*acl, mode);\n\tif (ret < 0)\n\t\tgoto no_mem_clone;\n\n\tif (ret == 0) {\n\t\tposix_acl_release(*acl);\n\t\t*acl = NULL;\n\t}\n\n\tif (!S_ISDIR(*mode)) {\n\t\tposix_acl_release(p);\n\t\t*default_acl = NULL;\n\t} else {\n\t\t*default_acl = p;\n\t}\n\treturn 0;\n\napply_umask:\n\t*mode &= ~current_umask();\nno_acl:\n\t*default_acl = NULL;\n\t*acl = NULL;\n\treturn 0;\n\nno_mem_clone:\n\tposix_acl_release(*acl);\nno_mem:\n\tposix_acl_release(p);\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_alloc_createdata",
          "args": [],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "282-297",
          "snippet": "static struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  mknod %pd %u:%u\\n\"",
            "dentry",
            "MAJOR(rdev)",
            "MINOR(rdev)"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "rdev"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "rdev"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_mknod(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\tdev_t rdev)\n{\n\tstruct posix_acl *default_acl, *acl;\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mknod %pd %u:%u\\n\", dentry,\n\t\t\tMAJOR(rdev), MINOR(rdev));\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\n\tstatus = posix_acl_create(dir, &sattr->ia_mode, &default_acl, &acl);\n\tif (status)\n\t\tgoto out;\n\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_MKNOD];\n\tdata->arg.mknod.fh = NFS_FH(dir);\n\tdata->arg.mknod.name = dentry->d_name.name;\n\tdata->arg.mknod.len = dentry->d_name.len;\n\tdata->arg.mknod.sattr = sattr;\n\tdata->arg.mknod.rdev = rdev;\n\n\tswitch (sattr->ia_mode & S_IFMT) {\n\tcase S_IFBLK:\n\t\tdata->arg.mknod.type = NF3BLK;\n\t\tbreak;\n\tcase S_IFCHR:\n\t\tdata->arg.mknod.type = NF3CHR;\n\t\tbreak;\n\tcase S_IFIFO:\n\t\tdata->arg.mknod.type = NF3FIFO;\n\t\tbreak;\n\tcase S_IFSOCK:\n\t\tdata->arg.mknod.type = NF3SOCK;\n\t\tbreak;\n\tdefault:\n\t\tstatus = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tstatus = nfs3_do_create(dir, dentry, data);\n\tif (status != 0)\n\t\tgoto out_release_acls;\n\n\tstatus = nfs3_proc_setacls(dentry->d_inode, acl, default_acl);\n\nout_release_acls:\n\tposix_acl_release(acl);\n\tposix_acl_release(default_acl);\nout:\n\tnfs3_free_createdata(data);\n\tdprintk(\"NFS reply mknod: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "622-668",
    "snippet": "static int\nnfs3_proc_readdir(struct dentry *dentry, struct rpc_cred *cred,\n\t\t  u64 cookie, struct page **pages, unsigned int count, int plus)\n{\n\tstruct inode\t\t*dir = dentry->d_inode;\n\t__be32\t\t\t*verf = NFS_I(dir)->cookieverf;\n\tstruct nfs3_readdirargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.cookie\t\t= cookie,\n\t\t.verf\t\t= {verf[0], verf[1]},\n\t\t.plus\t\t= plus,\n\t\t.count\t\t= count,\n\t\t.pages\t\t= pages\n\t};\n\tstruct nfs3_readdirres\tres = {\n\t\t.verf\t\t= verf,\n\t\t.plus\t\t= plus\n\t};\n\tstruct rpc_message\tmsg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_READDIR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t\t.rpc_cred\t= cred\n\t};\n\tint status = -ENOMEM;\n\n\tif (plus)\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_READDIRPLUS];\n\n\tdprintk(\"NFS call  readdir%s %d\\n\",\n\t\t\tplus? \"plus\" : \"\", (unsigned int) cookie);\n\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.dir_attr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\n\tnfs_invalidate_atime(dir);\n\tnfs_refresh_inode(dir, res.dir_attr);\n\n\tnfs_free_fattr(res.dir_attr);\nout:\n\tdprintk(\"NFS reply readdir%s: %d\\n\",\n\t\t\tplus? \"plus\" : \"\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply readdir%s: %d\\n\"",
            "plus? \"plus\" : \"\"",
            "status"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.dir_attr"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "dir",
            "res.dir_attr"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_invalidate_atime",
          "args": [
            "dir"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_invalidate_atime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "219-224",
          "snippet": "void nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_invalidate_atime(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ATIME);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  readdir%s %d\\n\"",
            "plus? \"plus\" : \"\"",
            "(unsigned int) cookie"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "dir"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_readdir(struct dentry *dentry, struct rpc_cred *cred,\n\t\t  u64 cookie, struct page **pages, unsigned int count, int plus)\n{\n\tstruct inode\t\t*dir = dentry->d_inode;\n\t__be32\t\t\t*verf = NFS_I(dir)->cookieverf;\n\tstruct nfs3_readdirargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.cookie\t\t= cookie,\n\t\t.verf\t\t= {verf[0], verf[1]},\n\t\t.plus\t\t= plus,\n\t\t.count\t\t= count,\n\t\t.pages\t\t= pages\n\t};\n\tstruct nfs3_readdirres\tres = {\n\t\t.verf\t\t= verf,\n\t\t.plus\t\t= plus\n\t};\n\tstruct rpc_message\tmsg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_READDIR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t\t.rpc_cred\t= cred\n\t};\n\tint status = -ENOMEM;\n\n\tif (plus)\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_READDIRPLUS];\n\n\tdprintk(\"NFS call  readdir%s %d\\n\",\n\t\t\tplus? \"plus\" : \"\", (unsigned int) cookie);\n\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.dir_attr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\n\tnfs_invalidate_atime(dir);\n\tnfs_refresh_inode(dir, res.dir_attr);\n\n\tnfs_free_fattr(res.dir_attr);\nout:\n\tdprintk(\"NFS reply readdir%s: %d\\n\",\n\t\t\tplus? \"plus\" : \"\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_rmdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "584-611",
    "snippet": "static int\nnfs3_proc_rmdir(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_fattr\t*dir_attr;\n\tstruct nfs3_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_RMDIR],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  rmdir %s\\n\", name->name);\n\tdir_attr = nfs_alloc_fattr();\n\tif (dir_attr == NULL)\n\t\tgoto out;\n\n\tmsg.rpc_resp = dir_attr;\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_post_op_update_inode(dir, dir_attr);\n\tnfs_free_fattr(dir_attr);\nout:\n\tdprintk(\"NFS reply rmdir: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply rmdir: %d\\n\"",
            "status"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "dir_attr"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "dir",
            "dir_attr"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  rmdir %s\\n\"",
            "name->name"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_rmdir(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_fattr\t*dir_attr;\n\tstruct nfs3_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_RMDIR],\n\t\t.rpc_argp\t= &arg,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  rmdir %s\\n\", name->name);\n\tdir_attr = nfs_alloc_fattr();\n\tif (dir_attr == NULL)\n\t\tgoto out;\n\n\tmsg.rpc_resp = dir_attr;\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_post_op_update_inode(dir, dir_attr);\n\tnfs_free_fattr(dir_attr);\nout:\n\tdprintk(\"NFS reply rmdir: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "546-582",
    "snippet": "static int\nnfs3_proc_mkdir(struct inode *dir, struct dentry *dentry, struct iattr *sattr)\n{\n\tstruct posix_acl *default_acl, *acl;\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mkdir %pd\\n\", dentry);\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\n\tstatus = posix_acl_create(dir, &sattr->ia_mode, &default_acl, &acl);\n\tif (status)\n\t\tgoto out;\n\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_MKDIR];\n\tdata->arg.mkdir.fh = NFS_FH(dir);\n\tdata->arg.mkdir.name = dentry->d_name.name;\n\tdata->arg.mkdir.len = dentry->d_name.len;\n\tdata->arg.mkdir.sattr = sattr;\n\n\tstatus = nfs3_do_create(dir, dentry, data);\n\tif (status != 0)\n\t\tgoto out_release_acls;\n\n\tstatus = nfs3_proc_setacls(dentry->d_inode, acl, default_acl);\n\nout_release_acls:\n\tposix_acl_release(acl);\n\tposix_acl_release(default_acl);\nout:\n\tnfs3_free_createdata(data);\n\tdprintk(\"NFS reply mkdir: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply mkdir: %d\\n\"",
            "status"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_free_createdata",
          "args": [
            "data"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "310-313",
          "snippet": "static void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "posix_acl_release",
          "args": [
            "default_acl"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "posix_acl_release",
          "args": [
            "acl"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_proc_setacls",
          "args": [
            "dentry->d_inode",
            "acl",
            "default_acl"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_proc_setacls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3acl.c",
          "lines": "205-212",
          "snippet": "int nfs3_proc_setacls(struct inode *inode, struct posix_acl *acl,\n\t\tstruct posix_acl *dfacl)\n{\n\tint ret;\n\tret = __nfs3_proc_setacls(inode, acl, dfacl);\n\treturn (ret == -EOPNOTSUPP) ? 0 : ret;\n\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include <linux/nfsacl.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/gfp.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include <linux/nfsacl.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/gfp.h>\n#include <linux/fs.h>\n\nint nfs3_proc_setacls(struct inode *inode, struct posix_acl *acl,\n\t\tstruct posix_acl *dfacl)\n{\n\tint ret;\n\tret = __nfs3_proc_setacls(inode, acl, dfacl);\n\treturn (ret == -EOPNOTSUPP) ? 0 : ret;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_do_create",
          "args": [
            "dir",
            "dentry",
            "data"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_do_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "299-308",
          "snippet": "static int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "posix_acl_create",
          "args": [
            "dir",
            "&sattr->ia_mode",
            "&default_acl",
            "&acl"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "posix_acl_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/posix_acl.c",
          "lines": "545-598",
          "snippet": "int\nposix_acl_create(struct inode *dir, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\tstruct posix_acl *p;\n\tint ret;\n\n\tif (S_ISLNK(*mode) || !IS_POSIXACL(dir))\n\t\tgoto no_acl;\n\n\tp = get_acl(dir, ACL_TYPE_DEFAULT);\n\tif (IS_ERR(p)) {\n\t\tif (p == ERR_PTR(-EOPNOTSUPP))\n\t\t\tgoto apply_umask;\n\t\treturn PTR_ERR(p);\n\t}\n\n\tif (!p)\n\t\tgoto apply_umask;\n\n\t*acl = posix_acl_clone(p, GFP_NOFS);\n\tif (!*acl)\n\t\tgoto no_mem;\n\n\tret = posix_acl_create_masq(*acl, mode);\n\tif (ret < 0)\n\t\tgoto no_mem_clone;\n\n\tif (ret == 0) {\n\t\tposix_acl_release(*acl);\n\t\t*acl = NULL;\n\t}\n\n\tif (!S_ISDIR(*mode)) {\n\t\tposix_acl_release(p);\n\t\t*default_acl = NULL;\n\t} else {\n\t\t*default_acl = p;\n\t}\n\treturn 0;\n\napply_umask:\n\t*mode &= ~current_umask();\nno_acl:\n\t*default_acl = NULL;\n\t*acl = NULL;\n\treturn 0;\n\nno_mem_clone:\n\tposix_acl_release(*acl);\nno_mem:\n\tposix_acl_release(p);\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/xattr.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/xattr.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint\nposix_acl_create(struct inode *dir, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\tstruct posix_acl *p;\n\tint ret;\n\n\tif (S_ISLNK(*mode) || !IS_POSIXACL(dir))\n\t\tgoto no_acl;\n\n\tp = get_acl(dir, ACL_TYPE_DEFAULT);\n\tif (IS_ERR(p)) {\n\t\tif (p == ERR_PTR(-EOPNOTSUPP))\n\t\t\tgoto apply_umask;\n\t\treturn PTR_ERR(p);\n\t}\n\n\tif (!p)\n\t\tgoto apply_umask;\n\n\t*acl = posix_acl_clone(p, GFP_NOFS);\n\tif (!*acl)\n\t\tgoto no_mem;\n\n\tret = posix_acl_create_masq(*acl, mode);\n\tif (ret < 0)\n\t\tgoto no_mem_clone;\n\n\tif (ret == 0) {\n\t\tposix_acl_release(*acl);\n\t\t*acl = NULL;\n\t}\n\n\tif (!S_ISDIR(*mode)) {\n\t\tposix_acl_release(p);\n\t\t*default_acl = NULL;\n\t} else {\n\t\t*default_acl = p;\n\t}\n\treturn 0;\n\napply_umask:\n\t*mode &= ~current_umask();\nno_acl:\n\t*default_acl = NULL;\n\t*acl = NULL;\n\treturn 0;\n\nno_mem_clone:\n\tposix_acl_release(*acl);\nno_mem:\n\tposix_acl_release(p);\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_alloc_createdata",
          "args": [],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "282-297",
          "snippet": "static struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  mkdir %pd\\n\"",
            "dentry"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_mkdir(struct inode *dir, struct dentry *dentry, struct iattr *sattr)\n{\n\tstruct posix_acl *default_acl, *acl;\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  mkdir %pd\\n\", dentry);\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\n\tstatus = posix_acl_create(dir, &sattr->ia_mode, &default_acl, &acl);\n\tif (status)\n\t\tgoto out;\n\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_MKDIR];\n\tdata->arg.mkdir.fh = NFS_FH(dir);\n\tdata->arg.mkdir.name = dentry->d_name.name;\n\tdata->arg.mkdir.len = dentry->d_name.len;\n\tdata->arg.mkdir.sattr = sattr;\n\n\tstatus = nfs3_do_create(dir, dentry, data);\n\tif (status != 0)\n\t\tgoto out_release_acls;\n\n\tstatus = nfs3_proc_setacls(dentry->d_inode, acl, default_acl);\n\nout_release_acls:\n\tposix_acl_release(acl);\n\tposix_acl_release(default_acl);\nout:\n\tnfs3_free_createdata(data);\n\tdprintk(\"NFS reply mkdir: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "515-544",
    "snippet": "static int\nnfs3_proc_symlink(struct inode *dir, struct dentry *dentry, struct page *page,\n\t\t  unsigned int len, struct iattr *sattr)\n{\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tif (len > NFS3_MAXPATHLEN)\n\t\treturn -ENAMETOOLONG;\n\n\tdprintk(\"NFS call  symlink %pd\\n\", dentry);\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_SYMLINK];\n\tdata->arg.symlink.fromfh = NFS_FH(dir);\n\tdata->arg.symlink.fromname = dentry->d_name.name;\n\tdata->arg.symlink.fromlen = dentry->d_name.len;\n\tdata->arg.symlink.pages = &page;\n\tdata->arg.symlink.pathlen = len;\n\tdata->arg.symlink.sattr = sattr;\n\n\tstatus = nfs3_do_create(dir, dentry, data);\n\n\tnfs3_free_createdata(data);\nout:\n\tdprintk(\"NFS reply symlink: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply symlink: %d\\n\"",
            "status"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_free_createdata",
          "args": [
            "data"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "310-313",
          "snippet": "static void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_do_create",
          "args": [
            "dir",
            "dentry",
            "data"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_do_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "299-308",
          "snippet": "static int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_alloc_createdata",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "282-297",
          "snippet": "static struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  symlink %pd\\n\"",
            "dentry"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_symlink(struct inode *dir, struct dentry *dentry, struct page *page,\n\t\t  unsigned int len, struct iattr *sattr)\n{\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tif (len > NFS3_MAXPATHLEN)\n\t\treturn -ENAMETOOLONG;\n\n\tdprintk(\"NFS call  symlink %pd\\n\", dentry);\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_SYMLINK];\n\tdata->arg.symlink.fromfh = NFS_FH(dir);\n\tdata->arg.symlink.fromname = dentry->d_name.name;\n\tdata->arg.symlink.fromlen = dentry->d_name.len;\n\tdata->arg.symlink.pages = &page;\n\tdata->arg.symlink.pathlen = len;\n\tdata->arg.symlink.sattr = sattr;\n\n\tstatus = nfs3_do_create(dir, dentry, data);\n\n\tnfs3_free_createdata(data);\nout:\n\tdprintk(\"NFS reply symlink: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "482-513",
    "snippet": "static int\nnfs3_proc_link(struct inode *inode, struct inode *dir, struct qstr *name)\n{\n\tstruct nfs3_linkargs\targ = {\n\t\t.fromfh\t\t= NFS_FH(inode),\n\t\t.tofh\t\t= NFS_FH(dir),\n\t\t.toname\t\t= name->name,\n\t\t.tolen\t\t= name->len\n\t};\n\tstruct nfs3_linkres\tres;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_LINK],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  link %s\\n\", name->name);\n\tres.fattr = nfs_alloc_fattr();\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.fattr == NULL || res.dir_attr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_post_op_update_inode(dir, res.dir_attr);\n\tnfs_post_op_update_inode(inode, res.fattr);\nout:\n\tnfs_free_fattr(res.dir_attr);\n\tnfs_free_fattr(res.fattr);\n\tdprintk(\"NFS reply link: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply link: %d\\n\"",
            "status"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.fattr"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.dir_attr"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "inode",
            "res.fattr"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  link %s\\n\"",
            "name->name"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_link(struct inode *inode, struct inode *dir, struct qstr *name)\n{\n\tstruct nfs3_linkargs\targ = {\n\t\t.fromfh\t\t= NFS_FH(inode),\n\t\t.tofh\t\t= NFS_FH(dir),\n\t\t.toname\t\t= name->name,\n\t\t.tolen\t\t= name->len\n\t};\n\tstruct nfs3_linkres\tres;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_LINK],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  link %s\\n\", name->name);\n\tres.fattr = nfs_alloc_fattr();\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.fattr == NULL || res.dir_attr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_post_op_update_inode(dir, res.dir_attr);\n\tnfs_post_op_update_inode(inode, res.fattr);\nout:\n\tnfs_free_fattr(res.dir_attr);\n\tnfs_free_fattr(res.fattr);\n\tdprintk(\"NFS reply link: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_rename_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "467-480",
    "snippet": "static int\nnfs3_proc_rename_done(struct rpc_task *task, struct inode *old_dir,\n\t\t      struct inode *new_dir)\n{\n\tstruct nfs_renameres *res;\n\n\tif (nfs3_async_handle_jukebox(task, old_dir))\n\t\treturn 0;\n\tres = task->tk_msg.rpc_resp;\n\n\tnfs_post_op_update_inode(old_dir, res->old_fattr);\n\tnfs_post_op_update_inode(new_dir, res->new_fattr);\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "new_dir",
            "res->new_fattr"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_async_handle_jukebox",
          "args": [
            "task",
            "old_dir"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_async_handle_jukebox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "46-57",
          "snippet": "static int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_rename_done(struct rpc_task *task, struct inode *old_dir,\n\t\t      struct inode *new_dir)\n{\n\tstruct nfs_renameres *res;\n\n\tif (nfs3_async_handle_jukebox(task, old_dir))\n\t\treturn 0;\n\tres = task->tk_msg.rpc_resp;\n\n\tnfs_post_op_update_inode(old_dir, res->old_fattr);\n\tnfs_post_op_update_inode(new_dir, res->new_fattr);\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs3_proc_rename_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "462-465",
    "snippet": "static void nfs3_proc_rename_rpc_prepare(struct rpc_task *task, struct nfs_renamedata *data)\n{\n\trpc_call_start(task);\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_proc_rename_rpc_prepare(struct rpc_task *task, struct nfs_renamedata *data)\n{\n\trpc_call_start(task);\n}"
  },
  {
    "function_name": "nfs3_proc_rename_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "456-460",
    "snippet": "static void\nnfs3_proc_rename_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_RENAME];\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void\nnfs3_proc_rename_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_RENAME];\n}"
  },
  {
    "function_name": "nfs3_proc_unlink_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "445-454",
    "snippet": "static int\nnfs3_proc_unlink_done(struct rpc_task *task, struct inode *dir)\n{\n\tstruct nfs_removeres *res;\n\tif (nfs3_async_handle_jukebox(task, dir))\n\t\treturn 0;\n\tres = task->tk_msg.rpc_resp;\n\tnfs_post_op_update_inode(dir, res->dir_attr);\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "dir",
            "res->dir_attr"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_async_handle_jukebox",
          "args": [
            "task",
            "dir"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_async_handle_jukebox",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "46-57",
          "snippet": "static int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_unlink_done(struct rpc_task *task, struct inode *dir)\n{\n\tstruct nfs_removeres *res;\n\tif (nfs3_async_handle_jukebox(task, dir))\n\t\treturn 0;\n\tres = task->tk_msg.rpc_resp;\n\tnfs_post_op_update_inode(dir, res->dir_attr);\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs3_proc_unlink_rpc_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "440-443",
    "snippet": "static void nfs3_proc_unlink_rpc_prepare(struct rpc_task *task, struct nfs_unlinkdata *data)\n{\n\trpc_call_start(task);\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_call_start",
          "args": [
            "task"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_proc_unlink_rpc_prepare(struct rpc_task *task, struct nfs_unlinkdata *data)\n{\n\trpc_call_start(task);\n}"
  },
  {
    "function_name": "nfs3_proc_unlink_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "434-438",
    "snippet": "static void\nnfs3_proc_unlink_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_REMOVE];\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void\nnfs3_proc_unlink_setup(struct rpc_message *msg, struct inode *dir)\n{\n\tmsg->rpc_proc = &nfs3_procedures[NFS3PROC_REMOVE];\n}"
  },
  {
    "function_name": "nfs3_proc_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "406-432",
    "snippet": "static int\nnfs3_proc_remove(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_removeargs arg = {\n\t\t.fh = NFS_FH(dir),\n\t\t.name = *name,\n\t};\n\tstruct nfs_removeres res;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc = &nfs3_procedures[NFS3PROC_REMOVE],\n\t\t.rpc_argp = &arg,\n\t\t.rpc_resp = &res,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  remove %s\\n\", name->name);\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.dir_attr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_post_op_update_inode(dir, res.dir_attr);\n\tnfs_free_fattr(res.dir_attr);\nout:\n\tdprintk(\"NFS reply remove: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply remove: %d\\n\"",
            "status"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.dir_attr"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "dir",
            "res.dir_attr"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  remove %s\\n\"",
            "name->name"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_remove(struct inode *dir, struct qstr *name)\n{\n\tstruct nfs_removeargs arg = {\n\t\t.fh = NFS_FH(dir),\n\t\t.name = *name,\n\t};\n\tstruct nfs_removeres res;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc = &nfs3_procedures[NFS3PROC_REMOVE],\n\t\t.rpc_argp = &arg,\n\t\t.rpc_resp = &res,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  remove %s\\n\", name->name);\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.dir_attr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_post_op_update_inode(dir, res.dir_attr);\n\tnfs_free_fattr(res.dir_attr);\nout:\n\tdprintk(\"NFS reply remove: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "318-404",
    "snippet": "static int\nnfs3_proc_create(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\t int flags)\n{\n\tstruct posix_acl *default_acl, *acl;\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  create %pd\\n\", dentry);\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_CREATE];\n\tdata->arg.create.fh = NFS_FH(dir);\n\tdata->arg.create.name = dentry->d_name.name;\n\tdata->arg.create.len = dentry->d_name.len;\n\tdata->arg.create.sattr = sattr;\n\n\tdata->arg.create.createmode = NFS3_CREATE_UNCHECKED;\n\tif (flags & O_EXCL) {\n\t\tdata->arg.create.createmode  = NFS3_CREATE_EXCLUSIVE;\n\t\tdata->arg.create.verifier[0] = cpu_to_be32(jiffies);\n\t\tdata->arg.create.verifier[1] = cpu_to_be32(current->pid);\n\t}\n\n\tstatus = posix_acl_create(dir, &sattr->ia_mode, &default_acl, &acl);\n\tif (status)\n\t\tgoto out;\n\n\tfor (;;) {\n\t\tstatus = nfs3_do_create(dir, dentry, data);\n\n\t\tif (status != -ENOTSUPP)\n\t\t\tbreak;\n\t\t/* If the server doesn't support the exclusive creation\n\t\t * semantics, try again with simple 'guarded' mode. */\n\t\tswitch (data->arg.create.createmode) {\n\t\t\tcase NFS3_CREATE_EXCLUSIVE:\n\t\t\t\tdata->arg.create.createmode = NFS3_CREATE_GUARDED;\n\t\t\t\tbreak;\n\n\t\t\tcase NFS3_CREATE_GUARDED:\n\t\t\t\tdata->arg.create.createmode = NFS3_CREATE_UNCHECKED;\n\t\t\t\tbreak;\n\n\t\t\tcase NFS3_CREATE_UNCHECKED:\n\t\t\t\tgoto out;\n\t\t}\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t\tnfs_fattr_init(data->res.fattr);\n\t}\n\n\tif (status != 0)\n\t\tgoto out_release_acls;\n\n\t/* When we created the file with exclusive semantics, make\n\t * sure we set the attributes afterwards. */\n\tif (data->arg.create.createmode == NFS3_CREATE_EXCLUSIVE) {\n\t\tdprintk(\"NFS call  setattr (post-create)\\n\");\n\n\t\tif (!(sattr->ia_valid & ATTR_ATIME_SET))\n\t\t\tsattr->ia_valid |= ATTR_ATIME;\n\t\tif (!(sattr->ia_valid & ATTR_MTIME_SET))\n\t\t\tsattr->ia_valid |= ATTR_MTIME;\n\n\t\t/* Note: we could use a guarded setattr here, but I'm\n\t\t * not sure this buys us anything (and I'd have\n\t\t * to revamp the NFSv3 XDR code) */\n\t\tstatus = nfs3_proc_setattr(dentry, data->res.fattr, sattr);\n\t\tnfs_post_op_update_inode(dentry->d_inode, data->res.fattr);\n\t\tdprintk(\"NFS reply setattr (post-create): %d\\n\", status);\n\t\tif (status != 0)\n\t\t\tgoto out_release_acls;\n\t}\n\n\tstatus = nfs3_proc_setacls(dentry->d_inode, acl, default_acl);\n\nout_release_acls:\n\tposix_acl_release(acl);\n\tposix_acl_release(default_acl);\nout:\n\tnfs3_free_createdata(data);\n\tdprintk(\"NFS reply create: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply create: %d\\n\"",
            "status"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_free_createdata",
          "args": [
            "data"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_free_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "310-313",
          "snippet": "static void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "posix_acl_release",
          "args": [
            "default_acl"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "posix_acl_release",
          "args": [
            "acl"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_proc_setacls",
          "args": [
            "dentry->d_inode",
            "acl",
            "default_acl"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_proc_setacls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3acl.c",
          "lines": "205-212",
          "snippet": "int nfs3_proc_setacls(struct inode *inode, struct posix_acl *acl,\n\t\tstruct posix_acl *dfacl)\n{\n\tint ret;\n\tret = __nfs3_proc_setacls(inode, acl, dfacl);\n\treturn (ret == -EOPNOTSUPP) ? 0 : ret;\n\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include <linux/nfsacl.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/gfp.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include <linux/nfsacl.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/gfp.h>\n#include <linux/fs.h>\n\nint nfs3_proc_setacls(struct inode *inode, struct posix_acl *acl,\n\t\tstruct posix_acl *dfacl)\n{\n\tint ret;\n\tret = __nfs3_proc_setacls(inode, acl, dfacl);\n\treturn (ret == -EOPNOTSUPP) ? 0 : ret;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply setattr (post-create): %d\\n\"",
            "status"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "dentry->d_inode",
            "data->res.fattr"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_proc_setattr",
          "args": [
            "dentry",
            "data->res.fattr",
            "sattr"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_proc_setattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "119-144",
          "snippet": "static int\nnfs3_proc_setattr(struct dentry *dentry, struct nfs_fattr *fattr,\n\t\t\tstruct iattr *sattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs3_sattrargs\targ = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.sattr\t\t= sattr,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_SETATTR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  setattr\\n\");\n\tif (sattr->ia_valid & ATTR_FILE)\n\t\tmsg.rpc_cred = nfs_file_cred(sattr->ia_file);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tif (status == 0)\n\t\tnfs_setattr_update_inode(inode, sattr, fattr);\n\tdprintk(\"NFS reply setattr: %d\\n\", status);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_setattr(struct dentry *dentry, struct nfs_fattr *fattr,\n\t\t\tstruct iattr *sattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs3_sattrargs\targ = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.sattr\t\t= sattr,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_SETATTR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  setattr\\n\");\n\tif (sattr->ia_valid & ATTR_FILE)\n\t\tmsg.rpc_cred = nfs_file_cred(sattr->ia_file);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tif (status == 0)\n\t\tnfs_setattr_update_inode(inode, sattr, fattr);\n\tdprintk(\"NFS reply setattr: %d\\n\", status);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  setattr (post-create)\\n\""
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "data->res.fattr"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs3_do_create",
          "args": [
            "dir",
            "dentry",
            "data"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_do_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "299-308",
          "snippet": "static int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "posix_acl_create",
          "args": [
            "dir",
            "&sattr->ia_mode",
            "&default_acl",
            "&acl"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "posix_acl_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/posix_acl.c",
          "lines": "545-598",
          "snippet": "int\nposix_acl_create(struct inode *dir, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\tstruct posix_acl *p;\n\tint ret;\n\n\tif (S_ISLNK(*mode) || !IS_POSIXACL(dir))\n\t\tgoto no_acl;\n\n\tp = get_acl(dir, ACL_TYPE_DEFAULT);\n\tif (IS_ERR(p)) {\n\t\tif (p == ERR_PTR(-EOPNOTSUPP))\n\t\t\tgoto apply_umask;\n\t\treturn PTR_ERR(p);\n\t}\n\n\tif (!p)\n\t\tgoto apply_umask;\n\n\t*acl = posix_acl_clone(p, GFP_NOFS);\n\tif (!*acl)\n\t\tgoto no_mem;\n\n\tret = posix_acl_create_masq(*acl, mode);\n\tif (ret < 0)\n\t\tgoto no_mem_clone;\n\n\tif (ret == 0) {\n\t\tposix_acl_release(*acl);\n\t\t*acl = NULL;\n\t}\n\n\tif (!S_ISDIR(*mode)) {\n\t\tposix_acl_release(p);\n\t\t*default_acl = NULL;\n\t} else {\n\t\t*default_acl = p;\n\t}\n\treturn 0;\n\napply_umask:\n\t*mode &= ~current_umask();\nno_acl:\n\t*default_acl = NULL;\n\t*acl = NULL;\n\treturn 0;\n\nno_mem_clone:\n\tposix_acl_release(*acl);\nno_mem:\n\tposix_acl_release(p);\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/xattr.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/xattr.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint\nposix_acl_create(struct inode *dir, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\tstruct posix_acl *p;\n\tint ret;\n\n\tif (S_ISLNK(*mode) || !IS_POSIXACL(dir))\n\t\tgoto no_acl;\n\n\tp = get_acl(dir, ACL_TYPE_DEFAULT);\n\tif (IS_ERR(p)) {\n\t\tif (p == ERR_PTR(-EOPNOTSUPP))\n\t\t\tgoto apply_umask;\n\t\treturn PTR_ERR(p);\n\t}\n\n\tif (!p)\n\t\tgoto apply_umask;\n\n\t*acl = posix_acl_clone(p, GFP_NOFS);\n\tif (!*acl)\n\t\tgoto no_mem;\n\n\tret = posix_acl_create_masq(*acl, mode);\n\tif (ret < 0)\n\t\tgoto no_mem_clone;\n\n\tif (ret == 0) {\n\t\tposix_acl_release(*acl);\n\t\t*acl = NULL;\n\t}\n\n\tif (!S_ISDIR(*mode)) {\n\t\tposix_acl_release(p);\n\t\t*default_acl = NULL;\n\t} else {\n\t\t*default_acl = p;\n\t}\n\treturn 0;\n\napply_umask:\n\t*mode &= ~current_umask();\nno_acl:\n\t*default_acl = NULL;\n\t*acl = NULL;\n\treturn 0;\n\nno_mem_clone:\n\tposix_acl_release(*acl);\nno_mem:\n\tposix_acl_release(p);\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "current->pid"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "jiffies"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs3_alloc_createdata",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "nfs3_alloc_createdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "282-297",
          "snippet": "static struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  create %pd\\n\"",
            "dentry"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_create(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\t int flags)\n{\n\tstruct posix_acl *default_acl, *acl;\n\tstruct nfs3_createdata *data;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  create %pd\\n\", dentry);\n\n\tdata = nfs3_alloc_createdata();\n\tif (data == NULL)\n\t\tgoto out;\n\n\tdata->msg.rpc_proc = &nfs3_procedures[NFS3PROC_CREATE];\n\tdata->arg.create.fh = NFS_FH(dir);\n\tdata->arg.create.name = dentry->d_name.name;\n\tdata->arg.create.len = dentry->d_name.len;\n\tdata->arg.create.sattr = sattr;\n\n\tdata->arg.create.createmode = NFS3_CREATE_UNCHECKED;\n\tif (flags & O_EXCL) {\n\t\tdata->arg.create.createmode  = NFS3_CREATE_EXCLUSIVE;\n\t\tdata->arg.create.verifier[0] = cpu_to_be32(jiffies);\n\t\tdata->arg.create.verifier[1] = cpu_to_be32(current->pid);\n\t}\n\n\tstatus = posix_acl_create(dir, &sattr->ia_mode, &default_acl, &acl);\n\tif (status)\n\t\tgoto out;\n\n\tfor (;;) {\n\t\tstatus = nfs3_do_create(dir, dentry, data);\n\n\t\tif (status != -ENOTSUPP)\n\t\t\tbreak;\n\t\t/* If the server doesn't support the exclusive creation\n\t\t * semantics, try again with simple 'guarded' mode. */\n\t\tswitch (data->arg.create.createmode) {\n\t\t\tcase NFS3_CREATE_EXCLUSIVE:\n\t\t\t\tdata->arg.create.createmode = NFS3_CREATE_GUARDED;\n\t\t\t\tbreak;\n\n\t\t\tcase NFS3_CREATE_GUARDED:\n\t\t\t\tdata->arg.create.createmode = NFS3_CREATE_UNCHECKED;\n\t\t\t\tbreak;\n\n\t\t\tcase NFS3_CREATE_UNCHECKED:\n\t\t\t\tgoto out;\n\t\t}\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t\tnfs_fattr_init(data->res.fattr);\n\t}\n\n\tif (status != 0)\n\t\tgoto out_release_acls;\n\n\t/* When we created the file with exclusive semantics, make\n\t * sure we set the attributes afterwards. */\n\tif (data->arg.create.createmode == NFS3_CREATE_EXCLUSIVE) {\n\t\tdprintk(\"NFS call  setattr (post-create)\\n\");\n\n\t\tif (!(sattr->ia_valid & ATTR_ATIME_SET))\n\t\t\tsattr->ia_valid |= ATTR_ATIME;\n\t\tif (!(sattr->ia_valid & ATTR_MTIME_SET))\n\t\t\tsattr->ia_valid |= ATTR_MTIME;\n\n\t\t/* Note: we could use a guarded setattr here, but I'm\n\t\t * not sure this buys us anything (and I'd have\n\t\t * to revamp the NFSv3 XDR code) */\n\t\tstatus = nfs3_proc_setattr(dentry, data->res.fattr, sattr);\n\t\tnfs_post_op_update_inode(dentry->d_inode, data->res.fattr);\n\t\tdprintk(\"NFS reply setattr (post-create): %d\\n\", status);\n\t\tif (status != 0)\n\t\t\tgoto out_release_acls;\n\t}\n\n\tstatus = nfs3_proc_setacls(dentry->d_inode, acl, default_acl);\n\nout_release_acls:\n\tposix_acl_release(acl);\n\tposix_acl_release(default_acl);\nout:\n\tnfs3_free_createdata(data);\n\tdprintk(\"NFS reply create: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_free_createdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "310-313",
    "snippet": "static void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic void nfs3_free_createdata(struct nfs3_createdata *data)\n{\n\tkfree(data);\n}"
  },
  {
    "function_name": "nfs3_do_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "299-308",
    "snippet": "static int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_instantiate",
          "args": [
            "dentry",
            "data->res.fh",
            "data->res.fattr",
            "NULL"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dir.c",
          "lines": "1641-1679",
          "snippet": "int nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/sched.h>",
            "#include <linux/swap.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/errno.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include <linux/xattr.h>\n#include <linux/kmemleak.h>\n#include <linux/sched.h>\n#include <linux/swap.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nint nfs_instantiate(struct dentry *dentry, struct nfs_fh *fhandle,\n\t\t\t\tstruct nfs_fattr *fattr,\n\t\t\t\tstruct nfs4_label *label)\n{\n\tstruct dentry *parent = dget_parent(dentry);\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode;\n\tint error = -EACCES;\n\n\td_drop(dentry);\n\n\t/* We may have been initialized further down */\n\tif (dentry->d_inode)\n\t\tgoto out;\n\tif (fhandle->size == 0) {\n\t\terror = NFS_PROTO(dir)->lookup(dir, &dentry->d_name, fhandle, fattr, NULL);\n\t\tif (error)\n\t\t\tgoto out_error;\n\t}\n\tnfs_set_verifier(dentry, nfs_save_change_attribute(dir));\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\t\terror = server->nfs_client->rpc_ops->getattr(server, fhandle, fattr, NULL);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\tinode = nfs_fhget(dentry->d_sb, fhandle, fattr, label);\n\terror = PTR_ERR(inode);\n\tif (IS_ERR(inode))\n\t\tgoto out_error;\n\td_add(dentry, inode);\nout:\n\tdput(parent);\n\treturn 0;\nout_error:\n\tnfs_mark_for_revalidate(dir);\n\tdput(parent);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_post_op_update_inode",
          "args": [
            "dir",
            "data->res.dir_attr"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_post_op_update_inode_force_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1579-1588",
          "snippet": "int nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_post_op_update_inode_force_wcc(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tspin_lock(&inode->i_lock);\n\tnfs_fattr_set_barrier(fattr);\n\tstatus = nfs_post_op_update_inode_force_wcc_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&data->msg",
            "0"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_do_create(struct inode *dir, struct dentry *dentry, struct nfs3_createdata *data)\n{\n\tint status;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &data->msg, 0);\n\tnfs_post_op_update_inode(dir, data->res.dir_attr);\n\tif (status == 0)\n\t\tstatus = nfs_instantiate(dentry, data->res.fh, data->res.fattr, NULL);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_alloc_createdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "282-297",
    "snippet": "static struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "data->res.dir_attr"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*data)",
            "GFP_KERNEL"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic struct nfs3_createdata *nfs3_alloc_createdata(void)\n{\n\tstruct nfs3_createdata *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data != NULL) {\n\t\tdata->msg.rpc_argp = &data->arg;\n\t\tdata->msg.rpc_resp = &data->res;\n\t\tdata->res.fh = &data->fh;\n\t\tdata->res.fattr = &data->fattr;\n\t\tdata->res.dir_attr = &data->dir_attr;\n\t\tnfs_fattr_init(data->res.fattr);\n\t\tnfs_fattr_init(data->res.dir_attr);\n\t}\n\treturn data;\n}"
  },
  {
    "function_name": "nfs3_proc_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "238-266",
    "snippet": "static int nfs3_proc_readlink(struct inode *inode, struct page *page,\n\t\tunsigned int pgbase, unsigned int pglen)\n{\n\tstruct nfs_fattr\t*fattr;\n\tstruct nfs3_readlinkargs args = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.pgbase\t\t= pgbase,\n\t\t.pglen\t\t= pglen,\n\t\t.pages\t\t= &page\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_READLINK],\n\t\t.rpc_argp\t= &args,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  readlink\\n\");\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\tmsg.rpc_resp = fattr;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_refresh_inode(inode, fattr);\n\tnfs_free_fattr(fattr);\nout:\n\tdprintk(\"NFS reply readlink: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply readlink: %d\\n\"",
            "status"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "fattr"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  readlink\\n\""
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_proc_readlink(struct inode *inode, struct page *page,\n\t\tunsigned int pgbase, unsigned int pglen)\n{\n\tstruct nfs_fattr\t*fattr;\n\tstruct nfs3_readlinkargs args = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.pgbase\t\t= pgbase,\n\t\t.pglen\t\t= pglen,\n\t\t.pages\t\t= &page\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_READLINK],\n\t\t.rpc_argp\t= &args,\n\t};\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  readlink\\n\");\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto out;\n\tmsg.rpc_resp = fattr;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_refresh_inode(inode, fattr);\n\tnfs_free_fattr(fattr);\nout:\n\tdprintk(\"NFS reply readlink: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "186-236",
    "snippet": "static int nfs3_proc_access(struct inode *inode, struct nfs_access_entry *entry)\n{\n\tstruct nfs3_accessargs\targ = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t};\n\tstruct nfs3_accessres\tres;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_ACCESS],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t\t.rpc_cred\t= entry->cred,\n\t};\n\tint mode = entry->mask;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  access\\n\");\n\n\tif (mode & MAY_READ)\n\t\targ.access |= NFS3_ACCESS_READ;\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (mode & MAY_WRITE)\n\t\t\targ.access |= NFS3_ACCESS_MODIFY | NFS3_ACCESS_EXTEND | NFS3_ACCESS_DELETE;\n\t\tif (mode & MAY_EXEC)\n\t\t\targ.access |= NFS3_ACCESS_LOOKUP;\n\t} else {\n\t\tif (mode & MAY_WRITE)\n\t\t\targ.access |= NFS3_ACCESS_MODIFY | NFS3_ACCESS_EXTEND;\n\t\tif (mode & MAY_EXEC)\n\t\t\targ.access |= NFS3_ACCESS_EXECUTE;\n\t}\n\n\tres.fattr = nfs_alloc_fattr();\n\tif (res.fattr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_refresh_inode(inode, res.fattr);\n\tif (status == 0) {\n\t\tentry->mask = 0;\n\t\tif (res.access & NFS3_ACCESS_READ)\n\t\t\tentry->mask |= MAY_READ;\n\t\tif (res.access & (NFS3_ACCESS_MODIFY | NFS3_ACCESS_EXTEND | NFS3_ACCESS_DELETE))\n\t\t\tentry->mask |= MAY_WRITE;\n\t\tif (res.access & (NFS3_ACCESS_LOOKUP|NFS3_ACCESS_EXECUTE))\n\t\t\tentry->mask |= MAY_EXEC;\n\t}\n\tnfs_free_fattr(res.fattr);\nout:\n\tdprintk(\"NFS reply access: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply access: %d\\n\"",
            "status"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.fattr"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "inode",
            "res.fattr"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  access\\n\""
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int nfs3_proc_access(struct inode *inode, struct nfs_access_entry *entry)\n{\n\tstruct nfs3_accessargs\targ = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t};\n\tstruct nfs3_accessres\tres;\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_ACCESS],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t\t.rpc_cred\t= entry->cred,\n\t};\n\tint mode = entry->mask;\n\tint status = -ENOMEM;\n\n\tdprintk(\"NFS call  access\\n\");\n\n\tif (mode & MAY_READ)\n\t\targ.access |= NFS3_ACCESS_READ;\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (mode & MAY_WRITE)\n\t\t\targ.access |= NFS3_ACCESS_MODIFY | NFS3_ACCESS_EXTEND | NFS3_ACCESS_DELETE;\n\t\tif (mode & MAY_EXEC)\n\t\t\targ.access |= NFS3_ACCESS_LOOKUP;\n\t} else {\n\t\tif (mode & MAY_WRITE)\n\t\t\targ.access |= NFS3_ACCESS_MODIFY | NFS3_ACCESS_EXTEND;\n\t\tif (mode & MAY_EXEC)\n\t\t\targ.access |= NFS3_ACCESS_EXECUTE;\n\t}\n\n\tres.fattr = nfs_alloc_fattr();\n\tif (res.fattr == NULL)\n\t\tgoto out;\n\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tnfs_refresh_inode(inode, res.fattr);\n\tif (status == 0) {\n\t\tentry->mask = 0;\n\t\tif (res.access & NFS3_ACCESS_READ)\n\t\t\tentry->mask |= MAY_READ;\n\t\tif (res.access & (NFS3_ACCESS_MODIFY | NFS3_ACCESS_EXTEND | NFS3_ACCESS_DELETE))\n\t\t\tentry->mask |= MAY_WRITE;\n\t\tif (res.access & (NFS3_ACCESS_LOOKUP|NFS3_ACCESS_EXECUTE))\n\t\t\tentry->mask |= MAY_EXEC;\n\t}\n\tnfs_free_fattr(res.fattr);\nout:\n\tdprintk(\"NFS reply access: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "146-184",
    "snippet": "static int\nnfs3_proc_lookup(struct inode *dir, struct qstr *name,\n\t\t struct nfs_fh *fhandle, struct nfs_fattr *fattr,\n\t\t struct nfs4_label *label)\n{\n\tstruct nfs3_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct nfs3_diropres\tres = {\n\t\t.fh\t\t= fhandle,\n\t\t.fattr\t\t= fattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_LOOKUP],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  lookup %s\\n\", name->name);\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.dir_attr == NULL)\n\t\treturn -ENOMEM;\n\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_refresh_inode(dir, res.dir_attr);\n\tif (status >= 0 && !(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_GETATTR];\n\t\tmsg.rpc_argp = fhandle;\n\t\tmsg.rpc_resp = fattr;\n\t\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\t}\n\tnfs_free_fattr(res.dir_attr);\n\tdprintk(\"NFS reply lookup: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply lookup: %d\\n\"",
            "status"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.dir_attr"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_refresh_inode",
          "args": [
            "dir",
            "res.dir_attr"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_refresh_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1466-1477",
          "snippet": "int nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nint nfs_refresh_inode(struct inode *inode, struct nfs_fattr *fattr)\n{\n\tint status;\n\n\tif ((fattr->valid & NFS_ATTR_FATTR) == 0)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tstatus = nfs_refresh_inode_locked(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(dir)",
            "&msg",
            "0"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "dir"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  lookup %s\\n\"",
            "name->name"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dir"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_lookup(struct inode *dir, struct qstr *name,\n\t\t struct nfs_fh *fhandle, struct nfs_fattr *fattr,\n\t\t struct nfs4_label *label)\n{\n\tstruct nfs3_diropargs\targ = {\n\t\t.fh\t\t= NFS_FH(dir),\n\t\t.name\t\t= name->name,\n\t\t.len\t\t= name->len\n\t};\n\tstruct nfs3_diropres\tres = {\n\t\t.fh\t\t= fhandle,\n\t\t.fattr\t\t= fattr\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_LOOKUP],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= &res,\n\t};\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS call  lookup %s\\n\", name->name);\n\tres.dir_attr = nfs_alloc_fattr();\n\tif (res.dir_attr == NULL)\n\t\treturn -ENOMEM;\n\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\tnfs_refresh_inode(dir, res.dir_attr);\n\tif (status >= 0 && !(fattr->valid & NFS_ATTR_FATTR)) {\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_GETATTR];\n\t\tmsg.rpc_argp = fhandle;\n\t\tmsg.rpc_resp = fattr;\n\t\tstatus = rpc_call_sync(NFS_CLIENT(dir), &msg, 0);\n\t}\n\tnfs_free_fattr(res.dir_attr);\n\tdprintk(\"NFS reply lookup: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "119-144",
    "snippet": "static int\nnfs3_proc_setattr(struct dentry *dentry, struct nfs_fattr *fattr,\n\t\t\tstruct iattr *sattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs3_sattrargs\targ = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.sattr\t\t= sattr,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_SETATTR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  setattr\\n\");\n\tif (sattr->ia_valid & ATTR_FILE)\n\t\tmsg.rpc_cred = nfs_file_cred(sattr->ia_file);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tif (status == 0)\n\t\tnfs_setattr_update_inode(inode, sattr, fattr);\n\tdprintk(\"NFS reply setattr: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply setattr: %d\\n\"",
            "status"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_setattr_update_inode",
          "args": [
            "inode",
            "sattr",
            "fattr"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_setattr_update_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "589-616",
          "snippet": "void nfs_setattr_update_inode(struct inode *inode, struct iattr *attr,\n\t\tstruct nfs_fattr *fattr)\n{\n\t/* Barrier: bump the attribute generation count. */\n\tnfs_fattr_set_barrier(fattr);\n\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->attr_gencount = fattr->gencount;\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0) {\n\t\tif ((attr->ia_valid & ATTR_MODE) != 0) {\n\t\t\tint mode = attr->ia_mode & S_IALLUGO;\n\t\t\tmode |= inode->i_mode & ~S_IALLUGO;\n\t\t\tinode->i_mode = mode;\n\t\t}\n\t\tif ((attr->ia_valid & ATTR_UID) != 0)\n\t\t\tinode->i_uid = attr->ia_uid;\n\t\tif ((attr->ia_valid & ATTR_GID) != 0)\n\t\t\tinode->i_gid = attr->ia_gid;\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL);\n\t}\n\tif ((attr->ia_valid & ATTR_SIZE) != 0) {\n\t\tnfs_inc_stats(inode, NFSIOS_SETATTRTRUNC);\n\t\tnfs_vmtruncate(inode, attr->ia_size);\n\t}\n\tnfs_update_inode(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);",
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_setattr_update_inode(struct inode *inode, struct iattr *attr,\n\t\tstruct nfs_fattr *fattr)\n{\n\t/* Barrier: bump the attribute generation count. */\n\tnfs_fattr_set_barrier(fattr);\n\n\tspin_lock(&inode->i_lock);\n\tNFS_I(inode)->attr_gencount = fattr->gencount;\n\tif ((attr->ia_valid & (ATTR_MODE|ATTR_UID|ATTR_GID)) != 0) {\n\t\tif ((attr->ia_valid & ATTR_MODE) != 0) {\n\t\t\tint mode = attr->ia_mode & S_IALLUGO;\n\t\t\tmode |= inode->i_mode & ~S_IALLUGO;\n\t\t\tinode->i_mode = mode;\n\t\t}\n\t\tif ((attr->ia_valid & ATTR_UID) != 0)\n\t\t\tinode->i_uid = attr->ia_uid;\n\t\tif ((attr->ia_valid & ATTR_GID) != 0)\n\t\t\tinode->i_gid = attr->ia_gid;\n\t\tnfs_set_cache_invalid(inode, NFS_INO_INVALID_ACCESS\n\t\t\t\t| NFS_INO_INVALID_ACL);\n\t}\n\tif ((attr->ia_valid & ATTR_SIZE) != 0) {\n\t\tnfs_inc_stats(inode, NFSIOS_SETATTRTRUNC);\n\t\tnfs_vmtruncate(inode, attr->ia_size);\n\t}\n\tnfs_update_inode(inode, fattr);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "NFS_CLIENT(inode)",
            "&msg",
            "0"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_CLIENT",
          "args": [
            "inode"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_cred",
          "args": [
            "sattr->ia_file"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  setattr\\n\""
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "inode"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_setattr(struct dentry *dentry, struct nfs_fattr *fattr,\n\t\t\tstruct iattr *sattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct nfs3_sattrargs\targ = {\n\t\t.fh\t\t= NFS_FH(inode),\n\t\t.sattr\t\t= sattr,\n\t};\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_SETATTR],\n\t\t.rpc_argp\t= &arg,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  setattr\\n\");\n\tif (sattr->ia_valid & ATTR_FILE)\n\t\tmsg.rpc_cred = nfs_file_cred(sattr->ia_file);\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(NFS_CLIENT(inode), &msg, 0);\n\tif (status == 0)\n\t\tnfs_setattr_update_inode(inode, sattr, fattr);\n\tdprintk(\"NFS reply setattr: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "101-117",
    "snippet": "static int\nnfs3_proc_getattr(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\tstruct nfs_fattr *fattr, struct nfs4_label *label)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_GETATTR],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  getattr\\n\");\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply getattr: %d\\n\", status);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS reply getattr: %d\\n\"",
            "status"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "server->client",
            "&msg",
            "0"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS call  getattr\\n\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_getattr(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\tstruct nfs_fattr *fattr, struct nfs4_label *label)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_GETATTR],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= fattr,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"NFS call  getattr\\n\");\n\tnfs_fattr_init(fattr);\n\tstatus = rpc_call_sync(server->client, &msg, 0);\n\tdprintk(\"NFS reply getattr: %d\\n\", status);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_proc_get_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "86-96",
    "snippet": "static int\nnfs3_proc_get_root(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t   struct nfs_fsinfo *info)\n{\n\tint\tstatus;\n\n\tstatus = do_proc_get_root(server->client, fhandle, info);\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = do_proc_get_root(server->nfs_client->cl_rpcclient, fhandle, info);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_proc_get_root",
          "args": [
            "server->nfs_client->cl_rpcclient",
            "fhandle",
            "info"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "do_proc_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
          "lines": "59-81",
          "snippet": "static int\ndo_proc_get_root(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"%s: call  fsinfo\\n\", __func__);\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"%s: reply fsinfo: %d\\n\", __func__, status);\n\tif (status == 0 && !(info->fattr->valid & NFS_ATTR_FATTR)) {\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_GETATTR];\n\t\tmsg.rpc_resp = info->fattr;\n\t\tstatus = rpc_call_sync(client, &msg, 0);\n\t\tdprintk(\"%s: reply getattr: %d\\n\", __func__, status);\n\t}\n\treturn status;\n}",
          "includes": [
            "#include \"nfs3_fs.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/freezer.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs3.h>",
            "#include <linux/nfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\ndo_proc_get_root(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"%s: call  fsinfo\\n\", __func__);\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"%s: reply fsinfo: %d\\n\", __func__, status);\n\tif (status == 0 && !(info->fattr->valid & NFS_ATTR_FATTR)) {\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_GETATTR];\n\t\tmsg.rpc_resp = info->fattr;\n\t\tstatus = rpc_call_sync(client, &msg, 0);\n\t\tdprintk(\"%s: reply getattr: %d\\n\", __func__, status);\n\t}\n\treturn status;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_proc_get_root(struct nfs_server *server, struct nfs_fh *fhandle,\n\t\t   struct nfs_fsinfo *info)\n{\n\tint\tstatus;\n\n\tstatus = do_proc_get_root(server->client, fhandle, info);\n\tif (status && server->nfs_client->cl_rpcclient != server->client)\n\t\tstatus = do_proc_get_root(server->nfs_client->cl_rpcclient, fhandle, info);\n\treturn status;\n}"
  },
  {
    "function_name": "do_proc_get_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "59-81",
    "snippet": "static int\ndo_proc_get_root(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"%s: call  fsinfo\\n\", __func__);\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"%s: reply fsinfo: %d\\n\", __func__, status);\n\tif (status == 0 && !(info->fattr->valid & NFS_ATTR_FATTR)) {\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_GETATTR];\n\t\tmsg.rpc_resp = info->fattr;\n\t\tstatus = rpc_call_sync(client, &msg, 0);\n\t\tdprintk(\"%s: reply getattr: %d\\n\", __func__, status);\n\t}\n\treturn status;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: reply getattr: %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "client",
            "&msg",
            "0"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: reply fsinfo: %d\\n\"",
            "__func__",
            "status"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "client",
            "&msg",
            "0"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "info->fattr"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: call  fsinfo\\n\"",
            "__func__"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\ndo_proc_get_root(struct rpc_clnt *client, struct nfs_fh *fhandle,\n\t\t struct nfs_fsinfo *info)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc\t= &nfs3_procedures[NFS3PROC_FSINFO],\n\t\t.rpc_argp\t= fhandle,\n\t\t.rpc_resp\t= info,\n\t};\n\tint\tstatus;\n\n\tdprintk(\"%s: call  fsinfo\\n\", __func__);\n\tnfs_fattr_init(info->fattr);\n\tstatus = rpc_call_sync(client, &msg, 0);\n\tdprintk(\"%s: reply fsinfo: %d\\n\", __func__, status);\n\tif (status == 0 && !(info->fattr->valid & NFS_ATTR_FATTR)) {\n\t\tmsg.rpc_proc = &nfs3_procedures[NFS3PROC_GETATTR];\n\t\tmsg.rpc_resp = info->fattr;\n\t\tstatus = rpc_call_sync(client, &msg, 0);\n\t\tdprintk(\"%s: reply getattr: %d\\n\", __func__, status);\n\t}\n\treturn status;\n}"
  },
  {
    "function_name": "nfs3_async_handle_jukebox",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "46-57",
    "snippet": "static int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_delay",
          "args": [
            "task",
            "NFS_JUKEBOX_RETRY_TIME"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_restart_call",
          "args": [
            "task"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inc_stats",
          "args": [
            "inode",
            "NFSIOS_DELAY"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inc_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "31-35",
          "snippet": "static inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_inc_stats(const struct inode *inode,\n\t\t\t\t enum nfs_stat_eventcounters stat)\n{\n\tnfs_inc_server_stats(NFS_SERVER(inode), stat);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_async_handle_jukebox(struct rpc_task *task, struct inode *inode)\n{\n\tif (task->tk_status != -EJUKEBOX)\n\t\treturn 0;\n\tif (task->tk_status == -EJUKEBOX)\n\t\tnfs_inc_stats(inode, NFSIOS_DELAY);\n\ttask->tk_status = 0;\n\trpc_restart_call(task);\n\trpc_delay(task, NFS_JUKEBOX_RETRY_TIME);\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs3_rpc_wrapper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs3proc.c",
    "lines": "30-42",
    "snippet": "static int\nnfs3_rpc_wrapper(struct rpc_clnt *clnt, struct rpc_message *msg, int flags)\n{\n\tint res;\n\tdo {\n\t\tres = rpc_call_sync(clnt, msg, flags);\n\t\tif (res != -EJUKEBOX)\n\t\t\tbreak;\n\t\tfreezable_schedule_timeout_killable_unsafe(NFS_JUKEBOX_RETRY_TIME);\n\t\tres = -ERESTARTSYS;\n\t} while (!fatal_signal_pending(current));\n\treturn res;\n}",
    "includes": [
      "#include \"nfs3_fs.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include <linux/xattr.h>",
      "#include <linux/freezer.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs_page.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs3.h>",
      "#include <linux/nfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fatal_signal_pending",
          "args": [
            "current"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freezable_schedule_timeout_killable_unsafe",
          "args": [
            "NFS_JUKEBOX_RETRY_TIME"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_call_sync",
          "args": [
            "clnt",
            "msg",
            "flags"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs3_fs.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include <linux/xattr.h>\n#include <linux/freezer.h>\n#include <linux/nfs_mount.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs3.h>\n#include <linux/nfs.h>\n#include <linux/slab.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n\nstatic int\nnfs3_rpc_wrapper(struct rpc_clnt *clnt, struct rpc_message *msg, int flags)\n{\n\tint res;\n\tdo {\n\t\tres = rpc_call_sync(clnt, msg, flags);\n\t\tif (res != -EJUKEBOX)\n\t\t\tbreak;\n\t\tfreezable_schedule_timeout_killable_unsafe(NFS_JUKEBOX_RETRY_TIME);\n\t\tres = -ERESTARTSYS;\n\t} while (!fatal_signal_pending(current));\n\treturn res;\n}"
  }
]