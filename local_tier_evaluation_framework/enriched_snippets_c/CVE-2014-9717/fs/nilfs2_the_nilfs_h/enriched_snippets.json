[
  {
    "function_name": "nilfs_flush_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "376-394",
    "snippet": "static inline int nilfs_flush_device(struct the_nilfs *nilfs)\n{\n\tint err;\n\n\tif (!nilfs_test_opt(nilfs, BARRIER) || nilfs->ns_flushed_device)\n\t\treturn 0;\n\n\tnilfs->ns_flushed_device = 1;\n\t/*\n\t * the store to ns_flushed_device must not be reordered after\n\t * blkdev_issue_flush().\n\t */\n\tsmp_wmb();\n\n\terr = blkdev_issue_flush(nilfs->ns_bdev, GFP_KERNEL, NULL);\n\tif (err != -EIO)\n\t\terr = 0;\n\treturn err;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "blkdev_issue_flush",
          "args": [
            "nilfs->ns_bdev",
            "GFP_KERNEL",
            "NULL"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_test_opt",
          "args": [
            "nilfs",
            "BARRIER"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_flush_device(struct the_nilfs *nilfs)\n{\n\tint err;\n\n\tif (!nilfs_test_opt(nilfs, BARRIER) || nilfs->ns_flushed_device)\n\t\treturn 0;\n\n\tnilfs->ns_flushed_device = 1;\n\t/*\n\t * the store to ns_flushed_device must not be reordered after\n\t * blkdev_issue_flush().\n\t */\n\tsmp_wmb();\n\n\terr = blkdev_issue_flush(nilfs->ns_bdev, GFP_KERNEL, NULL);\n\tif (err != -EIO)\n\t\terr = 0;\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_segment_is_active",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "371-374",
    "snippet": "static inline int nilfs_segment_is_active(struct the_nilfs *nilfs, __u64 n)\n{\n\treturn n == nilfs->ns_segnum || n == nilfs->ns_nextnum;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_segment_is_active(struct the_nilfs *nilfs, __u64 n)\n{\n\treturn n == nilfs->ns_segnum || n == nilfs->ns_nextnum;\n}"
  },
  {
    "function_name": "nilfs_last_cno",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "361-369",
    "snippet": "static inline __u64 nilfs_last_cno(struct the_nilfs *nilfs)\n{\n\t__u64 cno;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tcno = nilfs->ns_last_cno;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\treturn cno;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline __u64 nilfs_last_cno(struct the_nilfs *nilfs)\n{\n\t__u64 cno;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tcno = nilfs->ns_last_cno;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\treturn cno;\n}"
  },
  {
    "function_name": "nilfs_shift_to_next_segment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "353-359",
    "snippet": "static inline void nilfs_shift_to_next_segment(struct the_nilfs *nilfs)\n{\n\t/* move forward with a full segment */\n\tnilfs->ns_segnum = nilfs->ns_nextnum;\n\tnilfs->ns_pseg_offset = 0;\n\tnilfs->ns_seg_seq++;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_shift_to_next_segment(struct the_nilfs *nilfs)\n{\n\t/* move forward with a full segment */\n\tnilfs->ns_segnum = nilfs->ns_nextnum;\n\tnilfs->ns_pseg_offset = 0;\n\tnilfs->ns_seg_seq++;\n}"
  },
  {
    "function_name": "nilfs_terminate_segment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "345-351",
    "snippet": "static inline void\nnilfs_terminate_segment(struct the_nilfs *nilfs, sector_t seg_start,\n\t\t\tsector_t seg_end)\n{\n\t/* terminate the current full segment (used in case of I/O-error) */\n\tnilfs->ns_pseg_offset = seg_end - seg_start + 1;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline void\nnilfs_terminate_segment(struct the_nilfs *nilfs, sector_t seg_start,\n\t\t\tsector_t seg_end)\n{\n\t/* terminate the current full segment (used in case of I/O-error) */\n\tnilfs->ns_pseg_offset = seg_end - seg_start + 1;\n}"
  },
  {
    "function_name": "nilfs_get_segnum_of_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "336-343",
    "snippet": "static inline __u64\nnilfs_get_segnum_of_block(struct the_nilfs *nilfs, sector_t blocknr)\n{\n\tsector_t segnum = blocknr;\n\n\tsector_div(segnum, nilfs->ns_blocks_per_segment);\n\treturn segnum;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sector_div",
          "args": [
            "segnum",
            "nilfs->ns_blocks_per_segment"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline __u64\nnilfs_get_segnum_of_block(struct the_nilfs *nilfs, sector_t blocknr)\n{\n\tsector_t segnum = blocknr;\n\n\tsector_div(segnum, nilfs->ns_blocks_per_segment);\n\treturn segnum;\n}"
  },
  {
    "function_name": "nilfs_get_segment_start_blocknr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "329-334",
    "snippet": "static inline sector_t\nnilfs_get_segment_start_blocknr(struct the_nilfs *nilfs, __u64 segnum)\n{\n\treturn (segnum == 0) ? nilfs->ns_first_data_block :\n\t\t(sector_t)nilfs->ns_blocks_per_segment * segnum;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline sector_t\nnilfs_get_segment_start_blocknr(struct the_nilfs *nilfs, __u64 segnum)\n{\n\treturn (segnum == 0) ? nilfs->ns_first_data_block :\n\t\t(sector_t)nilfs->ns_blocks_per_segment * segnum;\n}"
  },
  {
    "function_name": "nilfs_get_segment_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "319-327",
    "snippet": "static inline void\nnilfs_get_segment_range(struct the_nilfs *nilfs, __u64 segnum,\n\t\t\tsector_t *seg_start, sector_t *seg_end)\n{\n\t*seg_start = (sector_t)nilfs->ns_blocks_per_segment * segnum;\n\t*seg_end = *seg_start + nilfs->ns_blocks_per_segment - 1;\n\tif (segnum == 0)\n\t\t*seg_start = nilfs->ns_first_data_block;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline void\nnilfs_get_segment_range(struct the_nilfs *nilfs, __u64 segnum,\n\t\t\tsector_t *seg_start, sector_t *seg_end)\n{\n\t*seg_start = (sector_t)nilfs->ns_blocks_per_segment * segnum;\n\t*seg_end = *seg_start + nilfs->ns_blocks_per_segment - 1;\n\tif (segnum == 0)\n\t\t*seg_start = nilfs->ns_first_data_block;\n}"
  },
  {
    "function_name": "nilfs_valid_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "309-317",
    "snippet": "static inline int nilfs_valid_fs(struct the_nilfs *nilfs)\n{\n\tunsigned valid_fs;\n\n\tdown_read(&nilfs->ns_sem);\n\tvalid_fs = (nilfs->ns_mount_state & NILFS_VALID_FS);\n\tup_read(&nilfs->ns_sem);\n\treturn valid_fs;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_valid_fs(struct the_nilfs *nilfs)\n{\n\tunsigned valid_fs;\n\n\tdown_read(&nilfs->ns_sem);\n\tvalid_fs = (nilfs->ns_mount_state & NILFS_VALID_FS);\n\tup_read(&nilfs->ns_sem);\n\treturn valid_fs;\n}"
  },
  {
    "function_name": "nilfs_get_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "304-307",
    "snippet": "static inline void nilfs_get_root(struct nilfs_root *root)\n{\n\tatomic_inc(&root->count);\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&root->count"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_get_root(struct nilfs_root *root)\n{\n\tatomic_inc(&root->count);\n}"
  },
  {
    "function_name": "nilfs_sb_will_flip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "280-284",
    "snippet": "static inline int nilfs_sb_will_flip(struct the_nilfs *nilfs)\n{\n\tint flip_bits = nilfs->ns_sbwcount & 0x0FL;\n\treturn (flip_bits != 0x08 && flip_bits != 0x0F);\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_sb_will_flip(struct the_nilfs *nilfs)\n{\n\tint flip_bits = nilfs->ns_sbwcount & 0x0FL;\n\treturn (flip_bits != 0x08 && flip_bits != 0x0F);\n}"
  },
  {
    "function_name": "nilfs_sb_need_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.h",
    "lines": "273-278",
    "snippet": "static inline int nilfs_sb_need_update(struct the_nilfs *nilfs)\n{\n\tu64 t = get_seconds();\n\treturn t < nilfs->ns_sbwtime ||\n\t\tt > nilfs->ns_sbwtime + nilfs->ns_sb_update_freq;\n}",
    "includes": [
      "#include <linux/slab.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/fs.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_sb_need_update(struct the_nilfs *nilfs)\n{\n\tu64 t = get_seconds();\n\treturn t < nilfs->ns_sbwtime ||\n\t\tt > nilfs->ns_sbwtime + nilfs->ns_sb_update_freq;\n}"
  }
]