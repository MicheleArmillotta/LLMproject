[
  {
    "function_name": "aster(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/master.c",
    "lines": "359-395",
    "snippet": "te_master(struct ubifs_info *c)\n{\n\tint err, lnum, offs, len;\n\n\tubifs_assert(!c->ro_media && !c->ro_mount);\n\tif (c->ro_error)\n\t\treturn -EROFS;\n\n\tlnum = UBIFS_MST_LNUM;\n\toffs = c->mst_offs + c->mst_node_alsz;\n\tlen = UBIFS_MST_NODE_SZ;\n\n\tif (offs + UBIFS_MST_NODE_SZ > c->leb_size) {\n\t\terr = ubifs_leb_unmap(c, lnum);\n\t\tif (err)\n\t\t\treturn err;\n\t\toffs = 0;\n\t}\n\n\tc->mst_offs = offs;\n\tc->mst_node->highest_inum = cpu_to_le64(c->highest_inum);\n\n\terr = ubifs_write_node(c, c->mst_node, len, lnum, offs);\n\tif (err)\n\t\treturn err;\n\n\tlnum += 1;\n\n\tif (offs == 0) {\n\t\terr = ubifs_leb_unmap(c, lnum);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\terr = ubifs_write_node(c, c->mst_node, len, lnum, offs);\n\n\treturn err;\n}",
    "includes": [
      "fs.h\"\n\n/**\n * scan_"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ode(c, c->mst_no",
          "args": [
            "e",
            "len, lnum,",
            "fs)",
            "re",
            "rn e"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ap(c, lnum);",
          "args": [
            "f",
            "err)"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ode(c, c->mst_no",
          "args": [
            "e",
            "len, lnum,",
            "fs)",
            "if",
            "rr)"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->highest_i",
          "args": [
            "um);\n\n\terr = ub"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ap(c, lnum);",
          "args": [
            "f",
            "err)"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "!c->ro_media",
          "args": [
            "&& !c->ro_mount);\n\tif (c->ro"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "fs.h\"\n\n/**\n * scan_\n\nte_master(struct ubifs_info *c)\n{\n\tint err, lnum, offs, len;\n\n\tubifs_assert(!c->ro_media && !c->ro_mount);\n\tif (c->ro_error)\n\t\treturn -EROFS;\n\n\tlnum = UBIFS_MST_LNUM;\n\toffs = c->mst_offs + c->mst_node_alsz;\n\tlen = UBIFS_MST_NODE_SZ;\n\n\tif (offs + UBIFS_MST_NODE_SZ > c->leb_size) {\n\t\terr = ubifs_leb_unmap(c, lnum);\n\t\tif (err)\n\t\t\treturn err;\n\t\toffs = 0;\n\t}\n\n\tc->mst_offs = offs;\n\tc->mst_node->highest_inum = cpu_to_le64(c->highest_inum);\n\n\terr = ubifs_write_node(c, c->mst_node, len, lnum, offs);\n\tif (err)\n\t\treturn err;\n\n\tlnum += 1;\n\n\tif (offs == 0) {\n\t\terr = ubifs_leb_unmap(c, lnum);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\terr = ubifs_write_node(c, c->mst_node, len, lnum, offs);\n\n\treturn err;\n}"
  },
  {
    "function_name": "ster(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/master.c",
    "lines": "256-349",
    "snippet": "d_master(struct ubifs_info *c)\n{\n\tint err, old_leb_cnt;\n\n\tc->mst_node = kzalloc(c->mst_node_alsz, GFP_KERNEL);\n\tif (!c->mst_node)\n\t\treturn -ENOMEM;\n\n\terr = scan_for_master(c);\n\tif (err) {\n\t\tif (err == -EUCLEAN)\n\t\t\terr = ubifs_recover_master_node(c);\n\t\tif (err)\n\t\t\t/*\n\t\t\t * Note, we do not free 'c->mst_node' here because the\n\t\t\t * unmount routine will take care of this.\n\t\t\t */\n\t\t\treturn err;\n\t}\n\n\t/* Make sure that the recovery flag is clear */\n\tc->mst_node->flags &= cpu_to_le32(~UBIFS_MST_RCVRY);\n\n\tc->max_sqnum       = le64_to_cpu(c->mst_node->ch.sqnum);\n\tc->highest_inum    = le64_to_cpu(c->mst_node->highest_inum);\n\tc->cmt_no          = le64_to_cpu(c->mst_node->cmt_no);\n\tc->zroot.lnum      = le32_to_cpu(c->mst_node->root_lnum);\n\tc->zroot.offs      = le32_to_cpu(c->mst_node->root_offs);\n\tc->zroot.len       = le32_to_cpu(c->mst_node->root_len);\n\tc->lhead_lnum      = le32_to_cpu(c->mst_node->log_lnum);\n\tc->gc_lnum         = le32_to_cpu(c->mst_node->gc_lnum);\n\tc->ihead_lnum      = le32_to_cpu(c->mst_node->ihead_lnum);\n\tc->ihead_offs      = le32_to_cpu(c->mst_node->ihead_offs);\n\tc->bi.old_idx_sz   = le64_to_cpu(c->mst_node->index_size);\n\tc->lpt_lnum        = le32_to_cpu(c->mst_node->lpt_lnum);\n\tc->lpt_offs        = le32_to_cpu(c->mst_node->lpt_offs);\n\tc->nhead_lnum      = le32_to_cpu(c->mst_node->nhead_lnum);\n\tc->nhead_offs      = le32_to_cpu(c->mst_node->nhead_offs);\n\tc->ltab_lnum       = le32_to_cpu(c->mst_node->ltab_lnum);\n\tc->ltab_offs       = le32_to_cpu(c->mst_node->ltab_offs);\n\tc->lsave_lnum      = le32_to_cpu(c->mst_node->lsave_lnum);\n\tc->lsave_offs      = le32_to_cpu(c->mst_node->lsave_offs);\n\tc->lscan_lnum      = le32_to_cpu(c->mst_node->lscan_lnum);\n\tc->lst.empty_lebs  = le32_to_cpu(c->mst_node->empty_lebs);\n\tc->lst.idx_lebs    = le32_to_cpu(c->mst_node->idx_lebs);\n\told_leb_cnt        = le32_to_cpu(c->mst_node->leb_cnt);\n\tc->lst.total_free  = le64_to_cpu(c->mst_node->total_free);\n\tc->lst.total_dirty = le64_to_cpu(c->mst_node->total_dirty);\n\tc->lst.total_used  = le64_to_cpu(c->mst_node->total_used);\n\tc->lst.total_dead  = le64_to_cpu(c->mst_node->total_dead);\n\tc->lst.total_dark  = le64_to_cpu(c->mst_node->total_dark);\n\n\tc->calc_idx_sz = c->bi.old_idx_sz;\n\n\tif (c->mst_node->flags & cpu_to_le32(UBIFS_MST_NO_ORPHS))\n\t\tc->no_orphs = 1;\n\n\tif (old_leb_cnt != c->leb_cnt) {\n\t\t/* The file system has been resized */\n\t\tint growth = c->leb_cnt - old_leb_cnt;\n\n\t\tif (c->leb_cnt < old_leb_cnt ||\n\t\t    c->leb_cnt < UBIFS_MIN_LEB_CNT) {\n\t\t\tubifs_err(\"bad leb_cnt on master node\");\n\t\t\tubifs_dump_node(c, c->mst_node);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\tdbg_mnt(\"Auto resizing (master) from %d LEBs to %d LEBs\",\n\t\t\told_leb_cnt, c->leb_cnt);\n\t\tc->lst.empty_lebs += growth;\n\t\tc->lst.total_free += growth * (long long)c->leb_size;\n\t\tc->lst.total_dark += growth * (long long)c->dark_wm;\n\n\t\t/*\n\t\t * Reflect changes back onto the master node. N.B. the master\n\t\t * node gets written immediately whenever mounting (or\n\t\t * remounting) in read-write mode, so we do not need to write it\n\t\t * here.\n\t\t */\n\t\tc->mst_node->leb_cnt = cpu_to_le32(c->leb_cnt);\n\t\tc->mst_node->empty_lebs = cpu_to_le32(c->lst.empty_lebs);\n\t\tc->mst_node->total_free = cpu_to_le64(c->lst.total_free);\n\t\tc->mst_node->total_dark = cpu_to_le64(c->lst.total_dark);\n\t}\n\n\terr = validate_master(c);\n\tif (err)\n\t\treturn err;\n\n\terr = dbg_old_index_check_init(c, &c->zroot);\n\n\treturn err;\n}\n\n/**\n * ubif",
    "includes": [
      "fs.h\"\n\n/**\n * scan_"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_check_init(c, &c->zroot",
          "args": [
            ";",
            "return e"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "er(c);\n\tif (err",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->lst.total",
          "args": [
            "dark);\n\t}\n\n\terr ="
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->lst.total",
          "args": [
            "free);\n\t\tc->mst_n"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->lst.empty",
          "args": [
            "lebs);\n\t\tc->mst_n"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->leb_cnt);",
          "args": [
            "c->mst_n"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resizi",
          "args": [
            "g (master) from %d LEBs to %d LEBs\",\n\t\t\told_leb_",
            "c->leb_cnt)",
            "c->lst.e"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "de(c, c->mst_no",
          "args": [
            "e",
            "return"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d leb_cnt",
          "args": [
            "on master node\");\n\t\t\tubifs_d"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BIFS_MST_NO",
          "args": [
            "ORPHS))\n\t\tc->no_or"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "total_dark);\n\n\tc->calc_"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "total_dead);\n\tc->lst.to"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "total_used);\n\tc->lst.to"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "total_dirty);\n\tc->lst.to"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "total_free);\n\tc->lst.to"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "leb_cnt);\n\tc->lst.to"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "idx_lebs);\n\told_leb_c"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "empty_lebs);\n\tc->lst.id"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "lscan_lnum);\n\tc->lst.em"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "lsave_offs);\n\tc->lscan_"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "lsave_lnum);\n\tc->lsave_"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "ltab_offs);\n\tc->lsave_"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "ltab_lnum);\n\tc->ltab_o"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "nhead_offs);\n\tc->ltab_l"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "nhead_lnum);\n\tc->nhead_"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "lpt_offs);\n\tc->nhead_"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "lpt_lnum);\n\tc->lpt_of"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "index_size);\n\tc->lpt_ln"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "ihead_offs);\n\tc->bi.old"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "ihead_lnum);\n\tc->ihead_"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "gc_lnum);\n\tc->ihead_"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "log_lnum);\n\tc->gc_lnu"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "root_len);\n\tc->lhead_"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "root_offs);\n\tc->zroot."
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "root_lnum);\n\tc->zroot."
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "cmt_no);\n\tc->zroot."
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "highest_inum);\n\tc->cmt_no"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mst_node-",
          "args": [
            "ch.sqnum);\n\tc->highes"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UBIFS_MST_R",
          "args": [
            "VRY);\n\n\tc->max_s"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_master_node(c);\n\t\tif (er",
          "args": [
            ")"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "er(c);\n\tif (err",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t_node_",
          "args": [
            "lsz, GFP_KERNEL)",
            "if (!c->m"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "get_node_page_ra",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/node.c",
          "lines": "1066-1114",
          "snippet": "struct page *get_node_page_ra(struct page *parent, int start)\n{\n\tstruct f2fs_sb_info *sbi = F2FS_P_SB(parent);\n\tstruct blk_plug plug;\n\tstruct page *page;\n\tint err, i, end;\n\tnid_t nid;\n\n\t/* First, try getting the desired direct node. */\n\tnid = get_nid(parent, start, false);\n\tif (!nid)\n\t\treturn ERR_PTR(-ENOENT);\nrepeat:\n\tpage = grab_cache_page(NODE_MAPPING(sbi), nid);\n\tif (!page)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terr = read_node_page(page, READ_SYNC);\n\tif (err < 0)\n\t\treturn ERR_PTR(err);\n\telse if (err == LOCKED_PAGE)\n\t\tgoto page_hit;\n\n\tblk_start_plug(&plug);\n\n\t/* Then, try readahead for siblings of the desired node */\n\tend = start + MAX_RA_NODE;\n\tend = min(end, NIDS_PER_BLOCK);\n\tfor (i = start + 1; i < end; i++) {\n\t\tnid = get_nid(parent, i, false);\n\t\tif (!nid)\n\t\t\tcontinue;\n\t\tra_node_page(sbi, nid);\n\t}\n\n\tblk_finish_plug(&plug);\n\n\tlock_page(page);\n\tif (unlikely(page->mapping != NODE_MAPPING(sbi))) {\n\t\tf2fs_put_page(page, 1);\n\t\tgoto repeat;\n\t}\npage_hit:\n\tif (unlikely(!PageUptodate(page))) {\n\t\tf2fs_put_page(page, 1);\n\t\treturn ERR_PTR(-EIO);\n\t}\n\treturn page;\n}",
          "includes": [
            "#include <trace/events/f2fs.h>",
            "#include \"trace.h\"",
            "#include \"segment.h\"",
            "#include \"node.h\"",
            "#include \"f2fs.h\"",
            "#include <linux/swap.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mpage.h>",
            "#include <linux/f2fs_fs.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/f2fs.h>\n#include \"trace.h\"\n#include \"segment.h\"\n#include \"node.h\"\n#include \"f2fs.h\"\n#include <linux/swap.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/mpage.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n\nstruct page *get_node_page_ra(struct page *parent, int start)\n{\n\tstruct f2fs_sb_info *sbi = F2FS_P_SB(parent);\n\tstruct blk_plug plug;\n\tstruct page *page;\n\tint err, i, end;\n\tnid_t nid;\n\n\t/* First, try getting the desired direct node. */\n\tnid = get_nid(parent, start, false);\n\tif (!nid)\n\t\treturn ERR_PTR(-ENOENT);\nrepeat:\n\tpage = grab_cache_page(NODE_MAPPING(sbi), nid);\n\tif (!page)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terr = read_node_page(page, READ_SYNC);\n\tif (err < 0)\n\t\treturn ERR_PTR(err);\n\telse if (err == LOCKED_PAGE)\n\t\tgoto page_hit;\n\n\tblk_start_plug(&plug);\n\n\t/* Then, try readahead for siblings of the desired node */\n\tend = start + MAX_RA_NODE;\n\tend = min(end, NIDS_PER_BLOCK);\n\tfor (i = start + 1; i < end; i++) {\n\t\tnid = get_nid(parent, i, false);\n\t\tif (!nid)\n\t\t\tcontinue;\n\t\tra_node_page(sbi, nid);\n\t}\n\n\tblk_finish_plug(&plug);\n\n\tlock_page(page);\n\tif (unlikely(page->mapping != NODE_MAPPING(sbi))) {\n\t\tf2fs_put_page(page, 1);\n\t\tgoto repeat;\n\t}\npage_hit:\n\tif (unlikely(!PageUptodate(page))) {\n\t\tf2fs_put_page(page, 1);\n\t\treturn ERR_PTR(-EIO);\n\t}\n\treturn page;\n}"
        }
      }
    ],
    "contextual_snippet": "fs.h\"\n\n/**\n * scan_\n\nd_master(struct ubifs_info *c)\n{\n\tint err, old_leb_cnt;\n\n\tc->mst_node = kzalloc(c->mst_node_alsz, GFP_KERNEL);\n\tif (!c->mst_node)\n\t\treturn -ENOMEM;\n\n\terr = scan_for_master(c);\n\tif (err) {\n\t\tif (err == -EUCLEAN)\n\t\t\terr = ubifs_recover_master_node(c);\n\t\tif (err)\n\t\t\t/*\n\t\t\t * Note, we do not free 'c->mst_node' here because the\n\t\t\t * unmount routine will take care of this.\n\t\t\t */\n\t\t\treturn err;\n\t}\n\n\t/* Make sure that the recovery flag is clear */\n\tc->mst_node->flags &= cpu_to_le32(~UBIFS_MST_RCVRY);\n\n\tc->max_sqnum       = le64_to_cpu(c->mst_node->ch.sqnum);\n\tc->highest_inum    = le64_to_cpu(c->mst_node->highest_inum);\n\tc->cmt_no          = le64_to_cpu(c->mst_node->cmt_no);\n\tc->zroot.lnum      = le32_to_cpu(c->mst_node->root_lnum);\n\tc->zroot.offs      = le32_to_cpu(c->mst_node->root_offs);\n\tc->zroot.len       = le32_to_cpu(c->mst_node->root_len);\n\tc->lhead_lnum      = le32_to_cpu(c->mst_node->log_lnum);\n\tc->gc_lnum         = le32_to_cpu(c->mst_node->gc_lnum);\n\tc->ihead_lnum      = le32_to_cpu(c->mst_node->ihead_lnum);\n\tc->ihead_offs      = le32_to_cpu(c->mst_node->ihead_offs);\n\tc->bi.old_idx_sz   = le64_to_cpu(c->mst_node->index_size);\n\tc->lpt_lnum        = le32_to_cpu(c->mst_node->lpt_lnum);\n\tc->lpt_offs        = le32_to_cpu(c->mst_node->lpt_offs);\n\tc->nhead_lnum      = le32_to_cpu(c->mst_node->nhead_lnum);\n\tc->nhead_offs      = le32_to_cpu(c->mst_node->nhead_offs);\n\tc->ltab_lnum       = le32_to_cpu(c->mst_node->ltab_lnum);\n\tc->ltab_offs       = le32_to_cpu(c->mst_node->ltab_offs);\n\tc->lsave_lnum      = le32_to_cpu(c->mst_node->lsave_lnum);\n\tc->lsave_offs      = le32_to_cpu(c->mst_node->lsave_offs);\n\tc->lscan_lnum      = le32_to_cpu(c->mst_node->lscan_lnum);\n\tc->lst.empty_lebs  = le32_to_cpu(c->mst_node->empty_lebs);\n\tc->lst.idx_lebs    = le32_to_cpu(c->mst_node->idx_lebs);\n\told_leb_cnt        = le32_to_cpu(c->mst_node->leb_cnt);\n\tc->lst.total_free  = le64_to_cpu(c->mst_node->total_free);\n\tc->lst.total_dirty = le64_to_cpu(c->mst_node->total_dirty);\n\tc->lst.total_used  = le64_to_cpu(c->mst_node->total_used);\n\tc->lst.total_dead  = le64_to_cpu(c->mst_node->total_dead);\n\tc->lst.total_dark  = le64_to_cpu(c->mst_node->total_dark);\n\n\tc->calc_idx_sz = c->bi.old_idx_sz;\n\n\tif (c->mst_node->flags & cpu_to_le32(UBIFS_MST_NO_ORPHS))\n\t\tc->no_orphs = 1;\n\n\tif (old_leb_cnt != c->leb_cnt) {\n\t\t/* The file system has been resized */\n\t\tint growth = c->leb_cnt - old_leb_cnt;\n\n\t\tif (c->leb_cnt < old_leb_cnt ||\n\t\t    c->leb_cnt < UBIFS_MIN_LEB_CNT) {\n\t\t\tubifs_err(\"bad leb_cnt on master node\");\n\t\t\tubifs_dump_node(c, c->mst_node);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\tdbg_mnt(\"Auto resizing (master) from %d LEBs to %d LEBs\",\n\t\t\told_leb_cnt, c->leb_cnt);\n\t\tc->lst.empty_lebs += growth;\n\t\tc->lst.total_free += growth * (long long)c->leb_size;\n\t\tc->lst.total_dark += growth * (long long)c->dark_wm;\n\n\t\t/*\n\t\t * Reflect changes back onto the master node. N.B. the master\n\t\t * node gets written immediately whenever mounting (or\n\t\t * remounting) in read-write mode, so we do not need to write it\n\t\t * here.\n\t\t */\n\t\tc->mst_node->leb_cnt = cpu_to_le32(c->leb_cnt);\n\t\tc->mst_node->empty_lebs = cpu_to_le32(c->lst.empty_lebs);\n\t\tc->mst_node->total_free = cpu_to_le64(c->lst.total_free);\n\t\tc->mst_node->total_dark = cpu_to_le64(c->lst.total_dark);\n\t}\n\n\terr = validate_master(c);\n\tif (err)\n\t\treturn err;\n\n\terr = dbg_old_index_check_init(c, &c->zroot);\n\n\treturn err;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "er(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/master.c",
    "lines": "98-246",
    "snippet": "lidate_master(const struct ubifs_info *c)\n{\n\tlong long main_sz;\n\tint err;\n\n\tif (c->max_sqnum >= SQNUM_WATERMARK) {\n\t\terr = 1;\n\t\tgoto out;\n\t}\n\n\tif (c->cmt_no >= c->max_sqnum) {\n\t\terr = 2;\n\t\tgoto out;\n\t}\n\n\tif (c->highest_inum >= INUM_WATERMARK) {\n\t\terr = 3;\n\t\tgoto out;\n\t}\n\n\tif (c->lhead_lnum < UBIFS_LOG_LNUM ||\n\t    c->lhead_lnum >= UBIFS_LOG_LNUM + c->log_lebs ||\n\t    c->lhead_offs < 0 || c->lhead_offs >= c->leb_size ||\n\t    c->lhead_offs & (c->min_io_size - 1)) {\n\t\terr = 4;\n\t\tgoto out;\n\t}\n\n\tif (c->zroot.lnum >= c->leb_cnt || c->zroot.lnum < c->main_first ||\n\t    c->zroot.offs >= c->leb_size || c->zroot.offs & 7) {\n\t\terr = 5;\n\t\tgoto out;\n\t}\n\n\tif (c->zroot.len < c->ranges[UBIFS_IDX_NODE].min_len ||\n\t    c->zroot.len > c->ranges[UBIFS_IDX_NODE].max_len) {\n\t\terr = 6;\n\t\tgoto out;\n\t}\n\n\tif (c->gc_lnum >= c->leb_cnt || c->gc_lnum < c->main_first) {\n\t\terr = 7;\n\t\tgoto out;\n\t}\n\n\tif (c->ihead_lnum >= c->leb_cnt || c->ihead_lnum < c->main_first ||\n\t    c->ihead_offs % c->min_io_size || c->ihead_offs < 0 ||\n\t    c->ihead_offs > c->leb_size || c->ihead_offs & 7) {\n\t\terr = 8;\n\t\tgoto out;\n\t}\n\n\tmain_sz = (long long)c->main_lebs * c->leb_size;\n\tif (c->bi.old_idx_sz & 7 || c->bi.old_idx_sz >= main_sz) {\n\t\terr = 9;\n\t\tgoto out;\n\t}\n\n\tif (c->lpt_lnum < c->lpt_first || c->lpt_lnum > c->lpt_last ||\n\t    c->lpt_offs < 0 || c->lpt_offs + c->nnode_sz > c->leb_size) {\n\t\terr = 10;\n\t\tgoto out;\n\t}\n\n\tif (c->nhead_lnum < c->lpt_first || c->nhead_lnum > c->lpt_last ||\n\t    c->nhead_offs < 0 || c->nhead_offs % c->min_io_size ||\n\t    c->nhead_offs > c->leb_size) {\n\t\terr = 11;\n\t\tgoto out;\n\t}\n\n\tif (c->ltab_lnum < c->lpt_first || c->ltab_lnum > c->lpt_last ||\n\t    c->ltab_offs < 0 ||\n\t    c->ltab_offs + c->ltab_sz > c->leb_size) {\n\t\terr = 12;\n\t\tgoto out;\n\t}\n\n\tif (c->big_lpt && (c->lsave_lnum < c->lpt_first ||\n\t    c->lsave_lnum > c->lpt_last || c->lsave_offs < 0 ||\n\t    c->lsave_offs + c->lsave_sz > c->leb_size)) {\n\t\terr = 13;\n\t\tgoto out;\n\t}\n\n\tif (c->lscan_lnum < c->main_first || c->lscan_lnum >= c->leb_cnt) {\n\t\terr = 14;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.empty_lebs < 0 || c->lst.empty_lebs > c->main_lebs - 2) {\n\t\terr = 15;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.idx_lebs < 0 || c->lst.idx_lebs > c->main_lebs - 1) {\n\t\terr = 16;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_free < 0 || c->lst.total_free > main_sz ||\n\t    c->lst.total_free & 7) {\n\t\terr = 17;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dirty < 0 || (c->lst.total_dirty & 7)) {\n\t\terr = 18;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_used < 0 || (c->lst.total_used & 7)) {\n\t\terr = 19;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_free + c->lst.total_dirty +\n\t    c->lst.total_used > main_sz) {\n\t\terr = 20;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dead + c->lst.total_dark +\n\t    c->lst.total_used + c->bi.old_idx_sz > main_sz) {\n\t\terr = 21;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dead < 0 ||\n\t    c->lst.total_dead > c->lst.total_free + c->lst.total_dirty ||\n\t    c->lst.total_dead & 7) {\n\t\terr = 22;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dark < 0 ||\n\t    c->lst.total_dark > c->lst.total_free + c->lst.total_dirty ||\n\t    c->lst.total_dark & 7) {\n\t\terr = 23;\n\t\tgoto out;\n\t}\n\n\treturn 0;\n\nout:\n\tubifs_err(\"bad master node at offset %d error %d\", c->mst_offs, err);\n\tubifs_dump_node(c, c->mst_node);\n\treturn -EINVAL;\n}\n\n/**\n * ubif",
    "includes": [
      "fs.h\"\n\n/**\n * scan_"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "de(c, c->mst_no",
          "args": [
            "e",
            "return -E"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d master",
          "args": [
            "ode at offset %d error %d\", c->mst_offs",
            "err);\n\tubif",
            "dum"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "fs.h\"\n\n/**\n * scan_\n\nlidate_master(const struct ubifs_info *c)\n{\n\tlong long main_sz;\n\tint err;\n\n\tif (c->max_sqnum >= SQNUM_WATERMARK) {\n\t\terr = 1;\n\t\tgoto out;\n\t}\n\n\tif (c->cmt_no >= c->max_sqnum) {\n\t\terr = 2;\n\t\tgoto out;\n\t}\n\n\tif (c->highest_inum >= INUM_WATERMARK) {\n\t\terr = 3;\n\t\tgoto out;\n\t}\n\n\tif (c->lhead_lnum < UBIFS_LOG_LNUM ||\n\t    c->lhead_lnum >= UBIFS_LOG_LNUM + c->log_lebs ||\n\t    c->lhead_offs < 0 || c->lhead_offs >= c->leb_size ||\n\t    c->lhead_offs & (c->min_io_size - 1)) {\n\t\terr = 4;\n\t\tgoto out;\n\t}\n\n\tif (c->zroot.lnum >= c->leb_cnt || c->zroot.lnum < c->main_first ||\n\t    c->zroot.offs >= c->leb_size || c->zroot.offs & 7) {\n\t\terr = 5;\n\t\tgoto out;\n\t}\n\n\tif (c->zroot.len < c->ranges[UBIFS_IDX_NODE].min_len ||\n\t    c->zroot.len > c->ranges[UBIFS_IDX_NODE].max_len) {\n\t\terr = 6;\n\t\tgoto out;\n\t}\n\n\tif (c->gc_lnum >= c->leb_cnt || c->gc_lnum < c->main_first) {\n\t\terr = 7;\n\t\tgoto out;\n\t}\n\n\tif (c->ihead_lnum >= c->leb_cnt || c->ihead_lnum < c->main_first ||\n\t    c->ihead_offs % c->min_io_size || c->ihead_offs < 0 ||\n\t    c->ihead_offs > c->leb_size || c->ihead_offs & 7) {\n\t\terr = 8;\n\t\tgoto out;\n\t}\n\n\tmain_sz = (long long)c->main_lebs * c->leb_size;\n\tif (c->bi.old_idx_sz & 7 || c->bi.old_idx_sz >= main_sz) {\n\t\terr = 9;\n\t\tgoto out;\n\t}\n\n\tif (c->lpt_lnum < c->lpt_first || c->lpt_lnum > c->lpt_last ||\n\t    c->lpt_offs < 0 || c->lpt_offs + c->nnode_sz > c->leb_size) {\n\t\terr = 10;\n\t\tgoto out;\n\t}\n\n\tif (c->nhead_lnum < c->lpt_first || c->nhead_lnum > c->lpt_last ||\n\t    c->nhead_offs < 0 || c->nhead_offs % c->min_io_size ||\n\t    c->nhead_offs > c->leb_size) {\n\t\terr = 11;\n\t\tgoto out;\n\t}\n\n\tif (c->ltab_lnum < c->lpt_first || c->ltab_lnum > c->lpt_last ||\n\t    c->ltab_offs < 0 ||\n\t    c->ltab_offs + c->ltab_sz > c->leb_size) {\n\t\terr = 12;\n\t\tgoto out;\n\t}\n\n\tif (c->big_lpt && (c->lsave_lnum < c->lpt_first ||\n\t    c->lsave_lnum > c->lpt_last || c->lsave_offs < 0 ||\n\t    c->lsave_offs + c->lsave_sz > c->leb_size)) {\n\t\terr = 13;\n\t\tgoto out;\n\t}\n\n\tif (c->lscan_lnum < c->main_first || c->lscan_lnum >= c->leb_cnt) {\n\t\terr = 14;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.empty_lebs < 0 || c->lst.empty_lebs > c->main_lebs - 2) {\n\t\terr = 15;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.idx_lebs < 0 || c->lst.idx_lebs > c->main_lebs - 1) {\n\t\terr = 16;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_free < 0 || c->lst.total_free > main_sz ||\n\t    c->lst.total_free & 7) {\n\t\terr = 17;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dirty < 0 || (c->lst.total_dirty & 7)) {\n\t\terr = 18;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_used < 0 || (c->lst.total_used & 7)) {\n\t\terr = 19;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_free + c->lst.total_dirty +\n\t    c->lst.total_used > main_sz) {\n\t\terr = 20;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dead + c->lst.total_dark +\n\t    c->lst.total_used + c->bi.old_idx_sz > main_sz) {\n\t\terr = 21;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dead < 0 ||\n\t    c->lst.total_dead > c->lst.total_free + c->lst.total_dirty ||\n\t    c->lst.total_dead & 7) {\n\t\terr = 22;\n\t\tgoto out;\n\t}\n\n\tif (c->lst.total_dark < 0 ||\n\t    c->lst.total_dark > c->lst.total_free + c->lst.total_dirty ||\n\t    c->lst.total_dark & 7) {\n\t\terr = 23;\n\t\tgoto out;\n\t}\n\n\treturn 0;\n\nout:\n\tubifs_err(\"bad master node at offset %d error %d\", c->mst_offs, err);\n\tubifs_dump_node(c, c->mst_node);\n\treturn -EINVAL;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "er(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/master.c",
    "lines": "36-89",
    "snippet": "an_for_master(struct ubifs_info *c)\n{\n\tstruct ubifs_scan_leb *sleb;\n\tstruct ubifs_scan_node *snod;\n\tint lnum, offs = 0, nodes_cnt;\n\n\tlnum = UBIFS_MST_LNUM;\n\n\tsleb = ubifs_scan(c, lnum, 0, c->sbuf, 1);\n\tif (IS_ERR(sleb))\n\t\treturn PTR_ERR(sleb);\n\tnodes_cnt = sleb->nodes_cnt;\n\tif (nodes_cnt > 0) {\n\t\tsnod = list_entry(sleb->nodes.prev, struct ubifs_scan_node,\n\t\t\t\t  list);\n\t\tif (snod->type != UBIFS_MST_NODE)\n\t\t\tgoto out_dump;\n\t\tmemcpy(c->mst_node, snod->node, snod->len);\n\t\toffs = snod->offs;\n\t}\n\tubifs_scan_destroy(sleb);\n\n\tlnum += 1;\n\n\tsleb = ubifs_scan(c, lnum, 0, c->sbuf, 1);\n\tif (IS_ERR(sleb))\n\t\treturn PTR_ERR(sleb);\n\tif (sleb->nodes_cnt != nodes_cnt)\n\t\tgoto out;\n\tif (!sleb->nodes_cnt)\n\t\tgoto out;\n\tsnod = list_entry(sleb->nodes.prev, struct ubifs_scan_node, list);\n\tif (snod->type != UBIFS_MST_NODE)\n\t\tgoto out_dump;\n\tif (snod->offs != offs)\n\t\tgoto out;\n\tif (memcmp((void *)c->mst_node + UBIFS_CH_SZ,\n\t\t   (void *)snod->node + UBIFS_CH_SZ,\n\t\t   UBIFS_MST_NODE_SZ - UBIFS_CH_SZ))\n\t\tgoto out;\n\tc->mst_offs = offs;\n\tubifs_scan_destroy(sleb);\n\treturn 0;\n\nout:\n\tubifs_scan_destroy(sleb);\n\treturn -EUCLEAN;\n\nout_dump:\n\tubifs_err(\"unexpected node type %d master LEB %d:%d\",\n\t\t  snod->type, lnum, snod->offs);\n\tubifs_scan_destroy(sleb);\n\treturn -EINVAL;\n}\n\n/**\n * vali",
    "includes": [
      "fs.h\"\n\n/**\n * scan_"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stroy(sleb);\n\tretu",
          "args": [
            "n -E"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "expected",
          "args": [
            "ode type %d master LEB %d:%d\",\n\t\t  snod->t",
            "num, snod-",
            "ffs)",
            "ubifs_sca"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stroy(sleb);\n\tretu",
          "args": [
            "n -E"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stroy(sleb);\n\tretu",
          "args": [
            "n 0;"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "*)c->m",
          "args": [
            "t_node + UBIFS_CH_SZ,\n\t\t   (void",
            ">node + UBIFS_CH_SZ,\n\t\t   UBIFS_",
            "E_SZ - UBIFS_CH_SZ))\n\t\tgoto out"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eb->nodes.",
          "args": [
            "rev, struct ubif",
            "scan_nde, list);\n\tif",
            "nod-"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n\tif (",
          "args": [
            "leb-"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ret",
          "args": [
            "rn P"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "retire_sysctl_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1567-1570",
          "snippet": "void retire_sysctl_set(struct ctl_table_set *set)\n{\n\tWARN_ON(!RB_EMPTY_ROOT(&set->dir.root));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nvoid retire_sysctl_set(struct ctl_table_set *set)\n{\n\tWARN_ON(!RB_EMPTY_ROOT(&set->dir.root));\n}"
        }
      },
      {
        "call_info": {
          "callee": "lnum, 0,",
          "args": [
            "-",
            "buf,",
            ")",
            "if (IS",
            "R"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stroy(sleb);\n\n\tlnu",
          "args": [
            "+="
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_node,",
          "args": [
            "snod->node,",
            "nod->len);",
            "offs = s"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eb->nodes.",
          "args": [
            "rev, struct ubif",
            "scan_nde,\n\t\t\t\t  list)",
            "snod"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n\tnode",
          "args": [
            "_cnt"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lnum, 0,",
          "args": [
            "-",
            "buf,",
            ")",
            "if (IS",
            "R"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "fs.h\"\n\n/**\n * scan_\n\nan_for_master(struct ubifs_info *c)\n{\n\tstruct ubifs_scan_leb *sleb;\n\tstruct ubifs_scan_node *snod;\n\tint lnum, offs = 0, nodes_cnt;\n\n\tlnum = UBIFS_MST_LNUM;\n\n\tsleb = ubifs_scan(c, lnum, 0, c->sbuf, 1);\n\tif (IS_ERR(sleb))\n\t\treturn PTR_ERR(sleb);\n\tnodes_cnt = sleb->nodes_cnt;\n\tif (nodes_cnt > 0) {\n\t\tsnod = list_entry(sleb->nodes.prev, struct ubifs_scan_node,\n\t\t\t\t  list);\n\t\tif (snod->type != UBIFS_MST_NODE)\n\t\t\tgoto out_dump;\n\t\tmemcpy(c->mst_node, snod->node, snod->len);\n\t\toffs = snod->offs;\n\t}\n\tubifs_scan_destroy(sleb);\n\n\tlnum += 1;\n\n\tsleb = ubifs_scan(c, lnum, 0, c->sbuf, 1);\n\tif (IS_ERR(sleb))\n\t\treturn PTR_ERR(sleb);\n\tif (sleb->nodes_cnt != nodes_cnt)\n\t\tgoto out;\n\tif (!sleb->nodes_cnt)\n\t\tgoto out;\n\tsnod = list_entry(sleb->nodes.prev, struct ubifs_scan_node, list);\n\tif (snod->type != UBIFS_MST_NODE)\n\t\tgoto out_dump;\n\tif (snod->offs != offs)\n\t\tgoto out;\n\tif (memcmp((void *)c->mst_node + UBIFS_CH_SZ,\n\t\t   (void *)snod->node + UBIFS_CH_SZ,\n\t\t   UBIFS_MST_NODE_SZ - UBIFS_CH_SZ))\n\t\tgoto out;\n\tc->mst_offs = offs;\n\tubifs_scan_destroy(sleb);\n\treturn 0;\n\nout:\n\tubifs_scan_destroy(sleb);\n\treturn -EUCLEAN;\n\nout_dump:\n\tubifs_err(\"unexpected node type %d master LEB %d:%d\",\n\t\t  snod->type, lnum, snod->offs);\n\tubifs_scan_destroy(sleb);\n\treturn -EINVAL;\n}\n\n/**\n * vali"
  }
]