[
  {
    "function_name": "nfs_server_fscache_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "223-226",
    "snippet": "static inline const char *nfs_server_fscache_state(struct nfs_server *server)\n{\n\treturn \"no \";\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline const char *nfs_server_fscache_state(struct nfs_server *server)\n{\n\treturn \"no \";\n}"
  },
  {
    "function_name": "nfs_fscache_wait_on_invalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "221-221",
    "snippet": "static inline void nfs_fscache_wait_on_invalidate(struct inode *inode) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_wait_on_invalidate(struct inode *inode) {}"
  },
  {
    "function_name": "nfs_fscache_invalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "220-220",
    "snippet": "static inline void nfs_fscache_invalidate(struct inode *inode) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_invalidate(struct inode *inode) {}"
  },
  {
    "function_name": "nfs_readpage_to_fscache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "216-217",
    "snippet": "static inline void nfs_readpage_to_fscache(struct inode *inode,\n\t\t\t\t\t   struct page *page, int sync) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_readpage_to_fscache(struct inode *inode,\n\t\t\t\t\t   struct page *page, int sync) {}"
  },
  {
    "function_name": "nfs_readpages_from_fscache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "208-215",
    "snippet": "static inline int nfs_readpages_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t     struct inode *inode,\n\t\t\t\t\t     struct address_space *mapping,\n\t\t\t\t\t     struct list_head *pages,\n\t\t\t\t\t     unsigned *nr_pages)\n{\n\treturn -ENOBUFS;\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int nfs_readpages_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t     struct inode *inode,\n\t\t\t\t\t     struct address_space *mapping,\n\t\t\t\t\t     struct list_head *pages,\n\t\t\t\t\t     unsigned *nr_pages)\n{\n\treturn -ENOBUFS;\n}"
  },
  {
    "function_name": "nfs_readpage_from_fscache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "202-207",
    "snippet": "static inline int nfs_readpage_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t    struct inode *inode,\n\t\t\t\t\t    struct page *page)\n{\n\treturn -ENOBUFS;\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int nfs_readpage_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t    struct inode *inode,\n\t\t\t\t\t    struct page *page)\n{\n\treturn -ENOBUFS;\n}"
  },
  {
    "function_name": "nfs_fscache_wait_on_page_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "199-200",
    "snippet": "static inline void nfs_fscache_wait_on_page_write(struct nfs_inode *nfsi,\n\t\t\t\t\t\t  struct page *page) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_wait_on_page_write(struct nfs_inode *nfsi,\n\t\t\t\t\t\t  struct page *page) {}"
  },
  {
    "function_name": "nfs_fscache_invalidate_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "197-198",
    "snippet": "static inline void nfs_fscache_invalidate_page(struct page *page,\n\t\t\t\t\t       struct inode *inode) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_invalidate_page(struct page *page,\n\t\t\t\t\t       struct inode *inode) {}"
  },
  {
    "function_name": "nfs_fscache_release_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "193-196",
    "snippet": "static inline int nfs_fscache_release_page(struct page *page, gfp_t gfp)\n{\n\treturn 1; /* True: may release page */\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int nfs_fscache_release_page(struct page *page, gfp_t gfp)\n{\n\treturn 1; /* True: may release page */\n}"
  },
  {
    "function_name": "nfs_fscache_open_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "190-191",
    "snippet": "static inline void nfs_fscache_open_file(struct inode *inode,\n\t\t\t\t\t struct file *filp) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_open_file(struct inode *inode,\n\t\t\t\t\t struct file *filp) {}"
  },
  {
    "function_name": "nfs_fscache_clear_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "189-189",
    "snippet": "static inline void nfs_fscache_clear_inode(struct inode *inode) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_clear_inode(struct inode *inode) {}"
  },
  {
    "function_name": "nfs_fscache_init_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "188-188",
    "snippet": "static inline void nfs_fscache_init_inode(struct inode *inode) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_init_inode(struct inode *inode) {}"
  },
  {
    "function_name": "nfs_fscache_release_super_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "186-186",
    "snippet": "static inline void nfs_fscache_release_super_cookie(struct super_block *sb) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_release_super_cookie(struct super_block *sb) {}"
  },
  {
    "function_name": "nfs_fscache_release_client_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "184-184",
    "snippet": "static inline void nfs_fscache_release_client_cookie(struct nfs_client *clp) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_release_client_cookie(struct nfs_client *clp) {}"
  },
  {
    "function_name": "nfs_fscache_get_client_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "183-183",
    "snippet": "static inline void nfs_fscache_get_client_cookie(struct nfs_client *clp) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_get_client_cookie(struct nfs_client *clp) {}"
  },
  {
    "function_name": "nfs_fscache_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "181-181",
    "snippet": "static inline void nfs_fscache_unregister(void) {}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_unregister(void) {}"
  },
  {
    "function_name": "nfs_fscache_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "180-180",
    "snippet": "static inline int nfs_fscache_register(void) { return 0; }",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int nfs_fscache_register(void) { return 0; }"
  },
  {
    "function_name": "nfs_server_fscache_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "172-177",
    "snippet": "static inline const char *nfs_server_fscache_state(struct nfs_server *server)\n{\n\tif (server->fscache && (server->options & NFS_OPTION_FSCACHE))\n\t\treturn \"yes\";\n\treturn \"no \";\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline const char *nfs_server_fscache_state(struct nfs_server *server)\n{\n\tif (server->fscache && (server->options & NFS_OPTION_FSCACHE))\n\t\treturn \"yes\";\n\treturn \"no \";\n}"
  },
  {
    "function_name": "nfs_fscache_wait_on_invalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "164-167",
    "snippet": "static inline void nfs_fscache_wait_on_invalidate(struct inode *inode)\n{\n\tfscache_wait_on_invalidate(NFS_I(inode)->fscache);\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fscache_wait_on_invalidate",
          "args": [
            "NFS_I(inode)->fscache"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_wait_on_invalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
          "lines": "221-221",
          "snippet": "static inline void nfs_fscache_wait_on_invalidate(struct inode *inode) {}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_wait_on_invalidate(struct inode *inode)\n{\n\tfscache_wait_on_invalidate(NFS_I(inode)->fscache);\n}"
  },
  {
    "function_name": "nfs_fscache_invalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "156-159",
    "snippet": "static inline void nfs_fscache_invalidate(struct inode *inode)\n{\n\tfscache_invalidate(NFS_I(inode)->fscache);\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fscache_invalidate",
          "args": [
            "NFS_I(inode)->fscache"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_invalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
          "lines": "220-220",
          "snippet": "static inline void nfs_fscache_invalidate(struct inode *inode) {}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_invalidate(struct inode *inode)\n{\n\tfscache_invalidate(NFS_I(inode)->fscache);\n}"
  },
  {
    "function_name": "nfs_readpage_to_fscache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "145-151",
    "snippet": "static inline void nfs_readpage_to_fscache(struct inode *inode,\n\t\t\t\t\t   struct page *page,\n\t\t\t\t\t   int sync)\n{\n\tif (PageFsCache(page))\n\t\t__nfs_readpage_to_fscache(inode, page, sync);\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_readpage_to_fscache",
          "args": [
            "inode",
            "page",
            "sync"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_readpage_to_fscache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "417-439",
          "snippet": "void __nfs_readpage_to_fscache(struct inode *inode, struct page *page, int sync)\n{\n\tint ret;\n\n\tdfprintk(FSCACHE,\n\t\t \"NFS: readpage_to_fscache(fsc:%p/p:%p(i:%lx f:%lx)/%d)\\n\",\n\t\t nfs_i_fscache(inode), page, page->index, page->flags, sync);\n\n\tret = fscache_write_page(nfs_i_fscache(inode), page, GFP_KERNEL);\n\tdfprintk(FSCACHE,\n\t\t \"NFS:     readpage_to_fscache: p:%p(i:%lu f:%lx) ret %d\\n\",\n\t\t page, page->index, page->flags, ret);\n\n\tif (ret != 0) {\n\t\tfscache_uncache_page(nfs_i_fscache(inode), page);\n\t\tnfs_inc_fscache_stats(inode,\n\t\t\t\t      NFSIOS_FSCACHE_PAGES_WRITTEN_FAIL);\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_UNCACHED);\n\t} else {\n\t\tnfs_inc_fscache_stats(inode,\n\t\t\t\t      NFSIOS_FSCACHE_PAGES_WRITTEN_OK);\n\t}\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid __nfs_readpage_to_fscache(struct inode *inode, struct page *page, int sync)\n{\n\tint ret;\n\n\tdfprintk(FSCACHE,\n\t\t \"NFS: readpage_to_fscache(fsc:%p/p:%p(i:%lx f:%lx)/%d)\\n\",\n\t\t nfs_i_fscache(inode), page, page->index, page->flags, sync);\n\n\tret = fscache_write_page(nfs_i_fscache(inode), page, GFP_KERNEL);\n\tdfprintk(FSCACHE,\n\t\t \"NFS:     readpage_to_fscache: p:%p(i:%lu f:%lx) ret %d\\n\",\n\t\t page, page->index, page->flags, ret);\n\n\tif (ret != 0) {\n\t\tfscache_uncache_page(nfs_i_fscache(inode), page);\n\t\tnfs_inc_fscache_stats(inode,\n\t\t\t\t      NFSIOS_FSCACHE_PAGES_WRITTEN_FAIL);\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_UNCACHED);\n\t} else {\n\t\tnfs_inc_fscache_stats(inode,\n\t\t\t\t      NFSIOS_FSCACHE_PAGES_WRITTEN_OK);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageFsCache",
          "args": [
            "page"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_readpage_to_fscache(struct inode *inode,\n\t\t\t\t\t   struct page *page,\n\t\t\t\t\t   int sync)\n{\n\tif (PageFsCache(page))\n\t\t__nfs_readpage_to_fscache(inode, page, sync);\n}"
  },
  {
    "function_name": "nfs_readpages_from_fscache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "129-139",
    "snippet": "static inline int nfs_readpages_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t     struct inode *inode,\n\t\t\t\t\t     struct address_space *mapping,\n\t\t\t\t\t     struct list_head *pages,\n\t\t\t\t\t     unsigned *nr_pages)\n{\n\tif (NFS_I(inode)->fscache)\n\t\treturn __nfs_readpages_from_fscache(ctx, inode, mapping, pages,\n\t\t\t\t\t\t    nr_pages);\n\treturn -ENOBUFS;\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_readpages_from_fscache",
          "args": [
            "ctx",
            "inode",
            "mapping",
            "pages",
            "nr_pages"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_readpages_from_fscache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "366-411",
          "snippet": "int __nfs_readpages_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t struct inode *inode,\n\t\t\t\t struct address_space *mapping,\n\t\t\t\t struct list_head *pages,\n\t\t\t\t unsigned *nr_pages)\n{\n\tunsigned npages = *nr_pages;\n\tint ret;\n\n\tdfprintk(FSCACHE, \"NFS: nfs_getpages_from_fscache (0x%p/%u/0x%p)\\n\",\n\t\t nfs_i_fscache(inode), npages, inode);\n\n\tret = fscache_read_or_alloc_pages(nfs_i_fscache(inode),\n\t\t\t\t\t  mapping, pages, nr_pages,\n\t\t\t\t\t  nfs_readpage_from_fscache_complete,\n\t\t\t\t\t  ctx,\n\t\t\t\t\t  mapping_gfp_mask(mapping));\n\tif (*nr_pages < npages)\n\t\tnfs_add_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_OK,\n\t\t\t\t      npages);\n\tif (*nr_pages > 0)\n\t\tnfs_add_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_FAIL,\n\t\t\t\t      *nr_pages);\n\n\tswitch (ret) {\n\tcase 0: /* read submitted to the cache for all pages */\n\t\tBUG_ON(!list_empty(pages));\n\t\tBUG_ON(*nr_pages != 0);\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS: nfs_getpages_from_fscache: submitted\\n\");\n\n\t\treturn ret;\n\n\tcase -ENOBUFS: /* some pages aren't cached and can't be */\n\tcase -ENODATA: /* some pages aren't cached */\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS: nfs_getpages_from_fscache: no page: %d\\n\", ret);\n\t\treturn 1;\n\n\tdefault:\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS: nfs_getpages_from_fscache: ret  %d\\n\", ret);\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nint __nfs_readpages_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t struct inode *inode,\n\t\t\t\t struct address_space *mapping,\n\t\t\t\t struct list_head *pages,\n\t\t\t\t unsigned *nr_pages)\n{\n\tunsigned npages = *nr_pages;\n\tint ret;\n\n\tdfprintk(FSCACHE, \"NFS: nfs_getpages_from_fscache (0x%p/%u/0x%p)\\n\",\n\t\t nfs_i_fscache(inode), npages, inode);\n\n\tret = fscache_read_or_alloc_pages(nfs_i_fscache(inode),\n\t\t\t\t\t  mapping, pages, nr_pages,\n\t\t\t\t\t  nfs_readpage_from_fscache_complete,\n\t\t\t\t\t  ctx,\n\t\t\t\t\t  mapping_gfp_mask(mapping));\n\tif (*nr_pages < npages)\n\t\tnfs_add_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_OK,\n\t\t\t\t      npages);\n\tif (*nr_pages > 0)\n\t\tnfs_add_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_FAIL,\n\t\t\t\t      *nr_pages);\n\n\tswitch (ret) {\n\tcase 0: /* read submitted to the cache for all pages */\n\t\tBUG_ON(!list_empty(pages));\n\t\tBUG_ON(*nr_pages != 0);\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS: nfs_getpages_from_fscache: submitted\\n\");\n\n\t\treturn ret;\n\n\tcase -ENOBUFS: /* some pages aren't cached and can't be */\n\tcase -ENODATA: /* some pages aren't cached */\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS: nfs_getpages_from_fscache: no page: %d\\n\", ret);\n\t\treturn 1;\n\n\tdefault:\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS: nfs_getpages_from_fscache: ret  %d\\n\", ret);\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int nfs_readpages_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t     struct inode *inode,\n\t\t\t\t\t     struct address_space *mapping,\n\t\t\t\t\t     struct list_head *pages,\n\t\t\t\t\t     unsigned *nr_pages)\n{\n\tif (NFS_I(inode)->fscache)\n\t\treturn __nfs_readpages_from_fscache(ctx, inode, mapping, pages,\n\t\t\t\t\t\t    nr_pages);\n\treturn -ENOBUFS;\n}"
  },
  {
    "function_name": "nfs_readpage_from_fscache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "117-124",
    "snippet": "static inline int nfs_readpage_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t    struct inode *inode,\n\t\t\t\t\t    struct page *page)\n{\n\tif (NFS_I(inode)->fscache)\n\t\treturn __nfs_readpage_from_fscache(ctx, inode, page);\n\treturn -ENOBUFS;\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_readpage_from_fscache",
          "args": [
            "ctx",
            "inode",
            "page"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_readpage_from_fscache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "327-361",
          "snippet": "int __nfs_readpage_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\tstruct inode *inode, struct page *page)\n{\n\tint ret;\n\n\tdfprintk(FSCACHE,\n\t\t \"NFS: readpage_from_fscache(fsc:%p/p:%p(i:%lx f:%lx)/0x%p)\\n\",\n\t\t nfs_i_fscache(inode), page, page->index, page->flags, inode);\n\n\tret = fscache_read_or_alloc_page(nfs_i_fscache(inode),\n\t\t\t\t\t page,\n\t\t\t\t\t nfs_readpage_from_fscache_complete,\n\t\t\t\t\t ctx,\n\t\t\t\t\t GFP_KERNEL);\n\n\tswitch (ret) {\n\tcase 0: /* read BIO submitted (page in fscache) */\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS:    readpage_from_fscache: BIO submitted\\n\");\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_OK);\n\t\treturn ret;\n\n\tcase -ENOBUFS: /* inode not in cache */\n\tcase -ENODATA: /* page not in cache */\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_FAIL);\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS:    readpage_from_fscache %d\\n\", ret);\n\t\treturn 1;\n\n\tdefault:\n\t\tdfprintk(FSCACHE, \"NFS:    readpage_from_fscache %d\\n\", ret);\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_FAIL);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nint __nfs_readpage_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\tstruct inode *inode, struct page *page)\n{\n\tint ret;\n\n\tdfprintk(FSCACHE,\n\t\t \"NFS: readpage_from_fscache(fsc:%p/p:%p(i:%lx f:%lx)/0x%p)\\n\",\n\t\t nfs_i_fscache(inode), page, page->index, page->flags, inode);\n\n\tret = fscache_read_or_alloc_page(nfs_i_fscache(inode),\n\t\t\t\t\t page,\n\t\t\t\t\t nfs_readpage_from_fscache_complete,\n\t\t\t\t\t ctx,\n\t\t\t\t\t GFP_KERNEL);\n\n\tswitch (ret) {\n\tcase 0: /* read BIO submitted (page in fscache) */\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS:    readpage_from_fscache: BIO submitted\\n\");\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_OK);\n\t\treturn ret;\n\n\tcase -ENOBUFS: /* inode not in cache */\n\tcase -ENODATA: /* page not in cache */\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_FAIL);\n\t\tdfprintk(FSCACHE,\n\t\t\t \"NFS:    readpage_from_fscache %d\\n\", ret);\n\t\treturn 1;\n\n\tdefault:\n\t\tdfprintk(FSCACHE, \"NFS:    readpage_from_fscache %d\\n\", ret);\n\t\tnfs_inc_fscache_stats(inode, NFSIOS_FSCACHE_PAGES_READ_FAIL);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int nfs_readpage_from_fscache(struct nfs_open_context *ctx,\n\t\t\t\t\t    struct inode *inode,\n\t\t\t\t\t    struct page *page)\n{\n\tif (NFS_I(inode)->fscache)\n\t\treturn __nfs_readpage_from_fscache(ctx, inode, page);\n\treturn -ENOBUFS;\n}"
  },
  {
    "function_name": "nfs_fscache_invalidate_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "107-112",
    "snippet": "static inline void nfs_fscache_invalidate_page(struct page *page,\n\t\t\t\t\t       struct inode *inode)\n{\n\tif (PageFsCache(page))\n\t\t__nfs_fscache_invalidate_page(page, inode);\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs_fscache_invalidate_page",
          "args": [
            "page",
            "inode"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs_fscache_invalidate_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "283-298",
          "snippet": "void __nfs_fscache_invalidate_page(struct page *page, struct inode *inode)\n{\n\tstruct fscache_cookie *cookie = nfs_i_fscache(inode);\n\n\tBUG_ON(!cookie);\n\n\tdfprintk(FSCACHE, \"NFS: fscache invalidatepage (0x%p/0x%p/0x%p)\\n\",\n\t\t cookie, page, NFS_I(inode));\n\n\tfscache_wait_on_page_write(cookie, page);\n\n\tBUG_ON(!PageLocked(page));\n\tfscache_uncache_page(cookie, page);\n\tnfs_inc_fscache_stats(page->mapping->host,\n\t\t\t      NFSIOS_FSCACHE_PAGES_UNCACHED);\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid __nfs_fscache_invalidate_page(struct page *page, struct inode *inode)\n{\n\tstruct fscache_cookie *cookie = nfs_i_fscache(inode);\n\n\tBUG_ON(!cookie);\n\n\tdfprintk(FSCACHE, \"NFS: fscache invalidatepage (0x%p/0x%p/0x%p)\\n\",\n\t\t cookie, page, NFS_I(inode));\n\n\tfscache_wait_on_page_write(cookie, page);\n\n\tBUG_ON(!PageLocked(page));\n\tfscache_uncache_page(cookie, page);\n\tnfs_inc_fscache_stats(page->mapping->host,\n\t\t\t      NFSIOS_FSCACHE_PAGES_UNCACHED);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageFsCache",
          "args": [
            "page"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_invalidate_page(struct page *page,\n\t\t\t\t\t       struct inode *inode)\n{\n\tif (PageFsCache(page))\n\t\t__nfs_fscache_invalidate_page(page, inode);\n}"
  },
  {
    "function_name": "nfs_fscache_wait_on_page_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
    "lines": "96-101",
    "snippet": "static inline void nfs_fscache_wait_on_page_write(struct nfs_inode *nfsi,\n\t\t\t\t\t\t  struct page *page)\n{\n\tif (PageFsCache(page))\n\t\tfscache_wait_on_page_write(nfsi->fscache, page);\n}",
    "includes": [
      "#include <linux/fscache.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fscache_wait_on_page_write",
          "args": [
            "nfsi->fscache",
            "page"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_wait_on_page_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
          "lines": "199-200",
          "snippet": "static inline void nfs_fscache_wait_on_page_write(struct nfs_inode *nfsi,\n\t\t\t\t\t\t  struct page *page) {}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "PageFsCache",
          "args": [
            "page"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs_fscache_wait_on_page_write(struct nfs_inode *nfsi,\n\t\t\t\t\t\t  struct page *page)\n{\n\tif (PageFsCache(page))\n\t\tfscache_wait_on_page_write(nfsi->fscache, page);\n}"
  }
]