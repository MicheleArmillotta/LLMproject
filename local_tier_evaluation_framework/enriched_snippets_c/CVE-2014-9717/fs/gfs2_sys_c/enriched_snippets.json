[
  {
    "function_name": "gfs2_sys_uninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "707-710",
    "snippet": "void gfs2_sys_uninit(void)\n{\n\tkset_unregister(gfs2_kset);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *gfs2_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "gfs2_kset"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct kset *gfs2_kset;\n\nvoid gfs2_sys_uninit(void)\n{\n\tkset_unregister(gfs2_kset);\n}"
  },
  {
    "function_name": "gfs2_sys_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "699-705",
    "snippet": "int gfs2_sys_init(void)\n{\n\tgfs2_kset = kset_create_and_add(\"gfs2\", &gfs2_uevent_ops, fs_kobj);\n\tif (!gfs2_kset)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *gfs2_kset;",
      "static const struct kset_uevent_ops gfs2_uevent_ops = {\n\t.uevent = gfs2_uevent,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_create_and_add",
          "args": [
            "\"gfs2\"",
            "&gfs2_uevent_ops",
            "fs_kobj"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct kset *gfs2_kset;\nstatic const struct kset_uevent_ops gfs2_uevent_ops = {\n\t.uevent = gfs2_uevent,\n};\n\nint gfs2_sys_init(void)\n{\n\tgfs2_kset = kset_create_and_add(\"gfs2\", &gfs2_uevent_ops, fs_kobj);\n\tif (!gfs2_kset)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_uevent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "679-693",
    "snippet": "static int gfs2_uevent(struct kset *kset, struct kobject *kobj,\n\t\t       struct kobj_uevent_env *env)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\tstruct super_block *s = sdp->sd_vfs;\n\tconst u8 *uuid = s->s_uuid;\n\n\tadd_uevent_var(env, \"LOCKTABLE=%s\", sdp->sd_table_name);\n\tadd_uevent_var(env, \"LOCKPROTO=%s\", sdp->sd_proto_name);\n\tif (!test_bit(SDF_NOJOURNALID, &sdp->sd_flags))\n\t\tadd_uevent_var(env, \"JOURNALID=%d\", sdp->sd_lockstruct.ls_jid);\n\tif (gfs2_uuid_valid(uuid))\n\t\tadd_uevent_var(env, \"UUID=%pUB\", uuid);\n\treturn 0;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_uevent_var",
          "args": [
            "env",
            "\"UUID=%pUB\"",
            "uuid"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_uuid_valid",
          "args": [
            "uuid"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_uevent_var",
          "args": [
            "env",
            "\"JOURNALID=%d\"",
            "sdp->sd_lockstruct.ls_jid"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "SDF_NOJOURNALID",
            "&sdp->sd_flags"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_uevent_var",
          "args": [
            "env",
            "\"LOCKPROTO=%s\"",
            "sdp->sd_proto_name"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_uevent_var",
          "args": [
            "env",
            "\"LOCKTABLE=%s\"",
            "sdp->sd_table_name"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structgfs2_sbd",
            "sd_kobj"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uevent(struct kset *kset, struct kobject *kobj,\n\t\t       struct kobj_uevent_env *env)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\tstruct super_block *s = sdp->sd_vfs;\n\tconst u8 *uuid = s->s_uuid;\n\n\tadd_uevent_var(env, \"LOCKTABLE=%s\", sdp->sd_table_name);\n\tadd_uevent_var(env, \"LOCKPROTO=%s\", sdp->sd_proto_name);\n\tif (!test_bit(SDF_NOJOURNALID, &sdp->sd_flags))\n\t\tadd_uevent_var(env, \"JOURNALID=%d\", sdp->sd_lockstruct.ls_jid);\n\tif (gfs2_uuid_valid(uuid))\n\t\tadd_uevent_var(env, \"UUID=%pUB\", uuid);\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_sys_fs_del",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "671-677",
    "snippet": "void gfs2_sys_fs_del(struct gfs2_sbd *sdp)\n{\n\tsysfs_remove_link(&sdp->sd_kobj, \"device\");\n\tsysfs_remove_group(&sdp->sd_kobj, &tune_group);\n\tsysfs_remove_group(&sdp->sd_kobj, &lock_module_group);\n\tkobject_put(&sdp->sd_kobj);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct attribute_group tune_group = {\n\t.name = \"tune\",\n\t.attrs = tune_attrs,\n};",
      "static struct attribute_group lock_module_group = {\n\t.name = \"lock_module\",\n\t.attrs = lock_module_attrs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&sdp->sd_kobj"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&sdp->sd_kobj",
            "&lock_module_group"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "243-252",
          "snippet": "void sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nvoid sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_remove_link",
          "args": [
            "&sdp->sd_kobj",
            "\"device\""
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/symlink.c",
          "lines": "142-152",
          "snippet": "void sysfs_remove_link(struct kobject *kobj, const char *name)\n{\n\tstruct kernfs_node *parent = NULL;\n\n\tif (!kobj)\n\t\tparent = sysfs_root_kn;\n\telse\n\t\tparent = kobj->sd;\n\n\tkernfs_remove_by_name(parent, name);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/security.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/security.h>\n#include <linux/mutex.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nvoid sysfs_remove_link(struct kobject *kobj, const char *name)\n{\n\tstruct kernfs_node *parent = NULL;\n\n\tif (!kobj)\n\t\tparent = sysfs_root_kn;\n\telse\n\t\tparent = kobj->sd;\n\n\tkernfs_remove_by_name(parent, name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct attribute_group tune_group = {\n\t.name = \"tune\",\n\t.attrs = tune_attrs,\n};\nstatic struct attribute_group lock_module_group = {\n\t.name = \"lock_module\",\n\t.attrs = lock_module_attrs,\n};\n\nvoid gfs2_sys_fs_del(struct gfs2_sbd *sdp)\n{\n\tsysfs_remove_link(&sdp->sd_kobj, \"device\");\n\tsysfs_remove_group(&sdp->sd_kobj, &tune_group);\n\tsysfs_remove_group(&sdp->sd_kobj, &lock_module_group);\n\tkobject_put(&sdp->sd_kobj);\n}"
  },
  {
    "function_name": "gfs2_sys_fs_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "619-669",
    "snippet": "int gfs2_sys_fs_add(struct gfs2_sbd *sdp)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tint error;\n\tchar ro[20];\n\tchar spectator[20];\n\tchar *envp[] = { ro, spectator, NULL };\n\tint sysfs_frees_sdp = 0;\n\n\tsprintf(ro, \"RDONLY=%d\", (sb->s_flags & MS_RDONLY) ? 1 : 0);\n\tsprintf(spectator, \"SPECTATOR=%d\", sdp->sd_args.ar_spectator ? 1 : 0);\n\n\tsdp->sd_kobj.kset = gfs2_kset;\n\terror = kobject_init_and_add(&sdp->sd_kobj, &gfs2_ktype, NULL,\n\t\t\t\t     \"%s\", sdp->sd_table_name);\n\tif (error)\n\t\tgoto fail_reg;\n\n\tsysfs_frees_sdp = 1; /* Freeing sdp is now done by sysfs calling\n\t\t\t\tfunction gfs2_sbd_release. */\n\terror = sysfs_create_group(&sdp->sd_kobj, &tune_group);\n\tif (error)\n\t\tgoto fail_reg;\n\n\terror = sysfs_create_group(&sdp->sd_kobj, &lock_module_group);\n\tif (error)\n\t\tgoto fail_tune;\n\n\terror = sysfs_create_link(&sdp->sd_kobj,\n\t\t\t\t  &disk_to_dev(sb->s_bdev->bd_disk)->kobj,\n\t\t\t\t  \"device\");\n\tif (error)\n\t\tgoto fail_lock_module;\n\n\tkobject_uevent_env(&sdp->sd_kobj, KOBJ_ADD, envp);\n\treturn 0;\n\nfail_lock_module:\n\tsysfs_remove_group(&sdp->sd_kobj, &lock_module_group);\nfail_tune:\n\tsysfs_remove_group(&sdp->sd_kobj, &tune_group);\nfail_reg:\n\tfree_percpu(sdp->sd_lkstats);\n\tfs_err(sdp, \"error %d adding sysfs files\", error);\n\tif (sysfs_frees_sdp)\n\t\tkobject_put(&sdp->sd_kobj);\n\telse\n\t\tkfree(sdp);\n\tsb->s_fs_info = NULL;\n\treturn error;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *gfs2_kset;",
      "static struct kobj_type gfs2_ktype = {\n\t.release = gfs2_sbd_release,\n\t.default_attrs = gfs2_attrs,\n\t.sysfs_ops     = &gfs2_attr_ops,\n};",
      "static struct attribute_group tune_group = {\n\t.name = \"tune\",\n\t.attrs = tune_attrs,\n};",
      "static struct attribute_group lock_module_group = {\n\t.name = \"lock_module\",\n\t.attrs = lock_module_attrs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sdp"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&sdp->sd_kobj"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fs_err",
          "args": [
            "sdp",
            "\"error %d adding sysfs files\"",
            "error"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "cifs_vfs_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/cifs_debug.c",
          "lines": "43-56",
          "snippet": "void cifs_vfs_err(const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tpr_err(\"CIFS VFS: %pV\", &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include \"cifsfs.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsglob.h\"",
            "#include \"cifspdu.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/ctype.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifsfs.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifsglob.h\"\n#include \"cifspdu.h\"\n#include <asm/uaccess.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nvoid cifs_vfs_err(const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tpr_err(\"CIFS VFS: %pV\", &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_percpu",
          "args": [
            "sdp->sd_lkstats"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&sdp->sd_kobj",
            "&tune_group"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "243-252",
          "snippet": "void sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nvoid sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_uevent_env",
          "args": [
            "&sdp->sd_kobj",
            "KOBJ_ADD",
            "envp"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_link",
          "args": [
            "&sdp->sd_kobj",
            "&disk_to_dev(sb->s_bdev->bd_disk)->kobj",
            "\"device\""
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_link_nowarn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/symlink.c",
          "lines": "105-109",
          "snippet": "int sysfs_create_link_nowarn(struct kobject *kobj, struct kobject *target,\n\t\t\t     const char *name)\n{\n\treturn sysfs_do_create_link(kobj, target, name, 0);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/security.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/security.h>\n#include <linux/mutex.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nint sysfs_create_link_nowarn(struct kobject *kobj, struct kobject *target,\n\t\t\t     const char *name)\n{\n\treturn sysfs_do_create_link(kobj, target, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "disk_to_dev",
          "args": [
            "sb->s_bdev->bd_disk"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&sdp->sd_kobj",
            "&lock_module_group"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "155-173",
          "snippet": "int sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nint sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&sdp->sd_kobj",
            "&gfs2_ktype",
            "NULL",
            "\"%s\"",
            "sdp->sd_table_name"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "spectator",
            "\"SPECTATOR=%d\"",
            "sdp->sd_args.ar_spectator ? 1 : 0"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "ro",
            "\"RDONLY=%d\"",
            "(sb->s_flags & MS_RDONLY) ? 1 : 0"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct kset *gfs2_kset;\nstatic struct kobj_type gfs2_ktype = {\n\t.release = gfs2_sbd_release,\n\t.default_attrs = gfs2_attrs,\n\t.sysfs_ops     = &gfs2_attr_ops,\n};\nstatic struct attribute_group tune_group = {\n\t.name = \"tune\",\n\t.attrs = tune_attrs,\n};\nstatic struct attribute_group lock_module_group = {\n\t.name = \"lock_module\",\n\t.attrs = lock_module_attrs,\n};\n\nint gfs2_sys_fs_add(struct gfs2_sbd *sdp)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tint error;\n\tchar ro[20];\n\tchar spectator[20];\n\tchar *envp[] = { ro, spectator, NULL };\n\tint sysfs_frees_sdp = 0;\n\n\tsprintf(ro, \"RDONLY=%d\", (sb->s_flags & MS_RDONLY) ? 1 : 0);\n\tsprintf(spectator, \"SPECTATOR=%d\", sdp->sd_args.ar_spectator ? 1 : 0);\n\n\tsdp->sd_kobj.kset = gfs2_kset;\n\terror = kobject_init_and_add(&sdp->sd_kobj, &gfs2_ktype, NULL,\n\t\t\t\t     \"%s\", sdp->sd_table_name);\n\tif (error)\n\t\tgoto fail_reg;\n\n\tsysfs_frees_sdp = 1; /* Freeing sdp is now done by sysfs calling\n\t\t\t\tfunction gfs2_sbd_release. */\n\terror = sysfs_create_group(&sdp->sd_kobj, &tune_group);\n\tif (error)\n\t\tgoto fail_reg;\n\n\terror = sysfs_create_group(&sdp->sd_kobj, &lock_module_group);\n\tif (error)\n\t\tgoto fail_tune;\n\n\terror = sysfs_create_link(&sdp->sd_kobj,\n\t\t\t\t  &disk_to_dev(sb->s_bdev->bd_disk)->kobj,\n\t\t\t\t  \"device\");\n\tif (error)\n\t\tgoto fail_lock_module;\n\n\tkobject_uevent_env(&sdp->sd_kobj, KOBJ_ADD, envp);\n\treturn 0;\n\nfail_lock_module:\n\tsysfs_remove_group(&sdp->sd_kobj, &lock_module_group);\nfail_tune:\n\tsysfs_remove_group(&sdp->sd_kobj, &tune_group);\nfail_reg:\n\tfree_percpu(sdp->sd_lkstats);\n\tfs_err(sdp, \"error %d adding sysfs files\", error);\n\tif (sysfs_frees_sdp)\n\t\tkobject_put(&sdp->sd_kobj);\n\telse\n\t\tkfree(sdp);\n\tsb->s_fs_info = NULL;\n\treturn error;\n}"
  },
  {
    "function_name": "tune_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "551-569",
    "snippet": "static ssize_t tune_set(struct gfs2_sbd *sdp, unsigned int *field,\n\t\t\tint check_zero, const char *buf, size_t len)\n{\n\tstruct gfs2_tune *gt = &sdp->sd_tune;\n\tunsigned int x;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tx = simple_strtoul(buf, NULL, 0);\n\n\tif (check_zero && !x)\n\t\treturn -EINVAL;\n\n\tspin_lock(&gt->gt_spin);\n\t*field = x;\n\tspin_unlock(&gt->gt_spin);\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gt->gt_spin"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gt->gt_spin"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t tune_set(struct gfs2_sbd *sdp, unsigned int *field,\n\t\t\tint check_zero, const char *buf, size_t len)\n{\n\tstruct gfs2_tune *gt = &sdp->sd_tune;\n\tunsigned int x;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tx = simple_strtoul(buf, NULL, 0);\n\n\tif (check_zero && !x)\n\t\treturn -EINVAL;\n\n\tspin_lock(&gt->gt_spin);\n\t*field = x;\n\tspin_unlock(&gt->gt_spin);\n\treturn len;\n}"
  },
  {
    "function_name": "quota_scale_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "532-549",
    "snippet": "static ssize_t quota_scale_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t size_t len)\n{\n\tstruct gfs2_tune *gt = &sdp->sd_tune;\n\tunsigned int x, y;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (sscanf(buf, \"%u %u\", &x, &y) != 2 || !y)\n\t\treturn -EINVAL;\n\n\tspin_lock(&gt->gt_spin);\n\tgt->gt_quota_scale_num = x;\n\tgt->gt_quota_scale_den = y;\n\tspin_unlock(&gt->gt_spin);\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gt->gt_spin"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gt->gt_spin"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%u %u\"",
            "&x",
            "&y"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t quota_scale_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t size_t len)\n{\n\tstruct gfs2_tune *gt = &sdp->sd_tune;\n\tunsigned int x, y;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (sscanf(buf, \"%u %u\", &x, &y) != 2 || !y)\n\t\treturn -EINVAL;\n\n\tspin_lock(&gt->gt_spin);\n\tgt->gt_quota_scale_num = x;\n\tgt->gt_quota_scale_den = y;\n\tspin_unlock(&gt->gt_spin);\n\treturn len;\n}"
  },
  {
    "function_name": "quota_scale_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "525-530",
    "snippet": "static ssize_t quota_scale_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%u %u\\n\",\n\t\t\tsdp->sd_tune.gt_quota_scale_num,\n\t\t\tsdp->sd_tune.gt_quota_scale_den);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u %u\\n\"",
            "sdp->sd_tune.gt_quota_scale_num",
            "sdp->sd_tune.gt_quota_scale_den"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t quota_scale_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%u %u\\n\",\n\t\t\tsdp->sd_tune.gt_quota_scale_num,\n\t\t\tsdp->sd_tune.gt_quota_scale_den);\n}"
  },
  {
    "function_name": "jid_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "465-493",
    "snippet": "static ssize_t jid_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n        int jid;\n\tint rv;\n\n\trv = sscanf(buf, \"%d\", &jid);\n\tif (rv != 1)\n\t\treturn -EINVAL;\n\trv = wait_for_completion_killable(&sdp->sd_locking_init);\n\tif (rv)\n\t\treturn rv;\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EINVAL;\n\tif (sdp->sd_lockstruct.ls_ops->lm_mount == NULL)\n\t\tgoto out;\n\trv = -EBUSY;\n\tif (test_bit(SDF_NOJOURNALID, &sdp->sd_flags) == 0)\n\t\tgoto out;\n\trv = 0;\n\tif (sdp->sd_args.ar_spectator && jid > 0)\n\t\trv = jid = -EINVAL;\n\tsdp->sd_lockstruct.ls_jid = jid;\n\tclear_bit(SDF_NOJOURNALID, &sdp->sd_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&sdp->sd_flags, SDF_NOJOURNALID);\nout:\n\tspin_unlock(&sdp->sd_jindex_spin);\n\treturn rv ? rv : len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sdp->sd_jindex_spin"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "&sdp->sd_flags",
            "SDF_NOJOURNALID"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "SDF_NOJOURNALID",
            "&sdp->sd_flags"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "SDF_NOJOURNALID",
            "&sdp->sd_flags"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sdp->sd_jindex_spin"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_for_completion_killable",
          "args": [
            "&sdp->sd_locking_init"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%d\"",
            "&jid"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t jid_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n        int jid;\n\tint rv;\n\n\trv = sscanf(buf, \"%d\", &jid);\n\tif (rv != 1)\n\t\treturn -EINVAL;\n\trv = wait_for_completion_killable(&sdp->sd_locking_init);\n\tif (rv)\n\t\treturn rv;\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EINVAL;\n\tif (sdp->sd_lockstruct.ls_ops->lm_mount == NULL)\n\t\tgoto out;\n\trv = -EBUSY;\n\tif (test_bit(SDF_NOJOURNALID, &sdp->sd_flags) == 0)\n\t\tgoto out;\n\trv = 0;\n\tif (sdp->sd_args.ar_spectator && jid > 0)\n\t\trv = jid = -EINVAL;\n\tsdp->sd_lockstruct.ls_jid = jid;\n\tclear_bit(SDF_NOJOURNALID, &sdp->sd_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&sdp->sd_flags, SDF_NOJOURNALID);\nout:\n\tspin_unlock(&sdp->sd_jindex_spin);\n\treturn rv ? rv : len;\n}"
  },
  {
    "function_name": "jid_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "460-463",
    "snippet": "static ssize_t jid_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", sdp->sd_lockstruct.ls_jid);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "sdp->sd_lockstruct.ls_jid"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t jid_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn sprintf(buf, \"%d\\n\", sdp->sd_lockstruct.ls_jid);\n}"
  },
  {
    "function_name": "recover_status_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "454-458",
    "snippet": "static ssize_t recover_status_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", ls->ls_recover_jid_status);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "ls->ls_recover_jid_status"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t recover_status_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", ls->ls_recover_jid_status);\n}"
  },
  {
    "function_name": "recover_done_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "448-452",
    "snippet": "static ssize_t recover_done_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", ls->ls_recover_jid_done);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "ls->ls_recover_jid_done"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t recover_done_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", ls->ls_recover_jid_done);\n}"
  },
  {
    "function_name": "recover_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "429-446",
    "snippet": "static ssize_t recover_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tunsigned jid;\n\tint rv;\n\n\trv = sscanf(buf, \"%u\", &jid);\n\tif (rv != 1)\n\t\treturn -EINVAL;\n\n\tif (test_bit(SDF_NORECOVERY, &sdp->sd_flags)) {\n\t\trv = -ESHUTDOWN;\n\t\tgoto out;\n\t}\n\n\trv = gfs2_recover_set(sdp, jid);\nout:\n\treturn rv ? rv : len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_recover_set",
          "args": [
            "sdp",
            "jid"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_recover_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "405-427",
          "snippet": "int gfs2_recover_set(struct gfs2_sbd *sdp, unsigned jid)\n{\n\tstruct gfs2_jdesc *jd;\n\tint rv;\n\n\t/* Wait for our primary journal to be initialized */\n\twait_for_completion(&sdp->sd_journal_ready);\n\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EBUSY;\n\tif (sdp->sd_jdesc->jd_jid == jid)\n\t\tgoto out;\n\trv = -ENOENT;\n\tlist_for_each_entry(jd, &sdp->sd_jindex_list, jd_list) {\n\t\tif (jd->jd_jid != jid)\n\t\t\tcontinue;\n\t\trv = gfs2_recover_journal(jd, false);\n\t\tbreak;\n\t}\nout:\n\tspin_unlock(&sdp->sd_jindex_spin);\n\treturn rv;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nint gfs2_recover_set(struct gfs2_sbd *sdp, unsigned jid)\n{\n\tstruct gfs2_jdesc *jd;\n\tint rv;\n\n\t/* Wait for our primary journal to be initialized */\n\twait_for_completion(&sdp->sd_journal_ready);\n\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EBUSY;\n\tif (sdp->sd_jdesc->jd_jid == jid)\n\t\tgoto out;\n\trv = -ENOENT;\n\tlist_for_each_entry(jd, &sdp->sd_jindex_list, jd_list) {\n\t\tif (jd->jd_jid != jid)\n\t\t\tcontinue;\n\t\trv = gfs2_recover_journal(jd, false);\n\t\tbreak;\n\t}\nout:\n\tspin_unlock(&sdp->sd_jindex_spin);\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "SDF_NORECOVERY",
            "&sdp->sd_flags"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%u\"",
            "&jid"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t recover_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tunsigned jid;\n\tint rv;\n\n\trv = sscanf(buf, \"%u\", &jid);\n\tif (rv != 1)\n\t\treturn -EINVAL;\n\n\tif (test_bit(SDF_NORECOVERY, &sdp->sd_flags)) {\n\t\trv = -ESHUTDOWN;\n\t\tgoto out;\n\t}\n\n\trv = gfs2_recover_set(sdp, jid);\nout:\n\treturn rv ? rv : len;\n}"
  },
  {
    "function_name": "gfs2_recover_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "405-427",
    "snippet": "int gfs2_recover_set(struct gfs2_sbd *sdp, unsigned jid)\n{\n\tstruct gfs2_jdesc *jd;\n\tint rv;\n\n\t/* Wait for our primary journal to be initialized */\n\twait_for_completion(&sdp->sd_journal_ready);\n\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EBUSY;\n\tif (sdp->sd_jdesc->jd_jid == jid)\n\t\tgoto out;\n\trv = -ENOENT;\n\tlist_for_each_entry(jd, &sdp->sd_jindex_list, jd_list) {\n\t\tif (jd->jd_jid != jid)\n\t\t\tcontinue;\n\t\trv = gfs2_recover_journal(jd, false);\n\t\tbreak;\n\t}\nout:\n\tspin_unlock(&sdp->sd_jindex_spin);\n\treturn rv;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sdp->sd_jindex_spin"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_recover_journal",
          "args": [
            "jd",
            "false"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_recover_journal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/recovery.c",
          "lines": "594-610",
          "snippet": "int gfs2_recover_journal(struct gfs2_jdesc *jd, bool wait)\n{\n\tint rv;\n\n\tif (test_and_set_bit(JDF_RECOVERY, &jd->jd_flags))\n\t\treturn -EBUSY;\n\n\t/* we have JDF_RECOVERY, queue should always succeed */\n\trv = queue_work(gfs_recovery_wq, &jd->jd_work);\n\tBUG_ON(!rv);\n\n\tif (wait)\n\t\twait_on_bit(&jd->jd_flags, JDF_RECOVERY,\n\t\t\t    TASK_UNINTERRUPTIBLE);\n\n\treturn wait ? jd->jd_recover_error : 0;\n}",
          "includes": [
            "#include \"dir.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"recovery.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *gfs_recovery_wq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dir.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"recovery.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstruct workqueue_struct *gfs_recovery_wq;\n\nint gfs2_recover_journal(struct gfs2_jdesc *jd, bool wait)\n{\n\tint rv;\n\n\tif (test_and_set_bit(JDF_RECOVERY, &jd->jd_flags))\n\t\treturn -EBUSY;\n\n\t/* we have JDF_RECOVERY, queue should always succeed */\n\trv = queue_work(gfs_recovery_wq, &jd->jd_work);\n\tBUG_ON(!rv);\n\n\tif (wait)\n\t\twait_on_bit(&jd->jd_flags, JDF_RECOVERY,\n\t\t\t    TASK_UNINTERRUPTIBLE);\n\n\treturn wait ? jd->jd_recover_error : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "jd",
            "&sdp->sd_jindex_list",
            "jd_list"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sdp->sd_jindex_spin"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&sdp->sd_journal_ready"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_for_completion_rpc_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1116-1122",
          "snippet": "static int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nint gfs2_recover_set(struct gfs2_sbd *sdp, unsigned jid)\n{\n\tstruct gfs2_jdesc *jd;\n\tint rv;\n\n\t/* Wait for our primary journal to be initialized */\n\twait_for_completion(&sdp->sd_journal_ready);\n\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EBUSY;\n\tif (sdp->sd_jdesc->jd_jid == jid)\n\t\tgoto out;\n\trv = -ENOENT;\n\tlist_for_each_entry(jd, &sdp->sd_jindex_list, jd_list) {\n\t\tif (jd->jd_jid != jid)\n\t\t\tcontinue;\n\t\trv = gfs2_recover_journal(jd, false);\n\t\tbreak;\n\t}\nout:\n\tspin_unlock(&sdp->sd_jindex_spin);\n\treturn rv;\n}"
  },
  {
    "function_name": "first_done_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "399-403",
    "snippet": "static ssize_t first_done_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", !!test_bit(DFL_FIRST_MOUNT_DONE, &ls->ls_recover_flags));\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "!!test_bit(DFL_FIRST_MOUNT_DONE, &ls->ls_recover_flags)"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DFL_FIRST_MOUNT_DONE",
            "&ls->ls_recover_flags"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t first_done_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", !!test_bit(DFL_FIRST_MOUNT_DONE, &ls->ls_recover_flags));\n}"
  },
  {
    "function_name": "lkfirst_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "372-397",
    "snippet": "static ssize_t lkfirst_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tunsigned first;\n\tint rv;\n\n\trv = sscanf(buf, \"%u\", &first);\n\tif (rv != 1 || first > 1)\n\t\treturn -EINVAL;\n\trv = wait_for_completion_killable(&sdp->sd_locking_init);\n\tif (rv)\n\t\treturn rv;\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EBUSY;\n\tif (test_bit(SDF_NOJOURNALID, &sdp->sd_flags) == 0)\n\t\tgoto out;\n\trv = -EINVAL;\n\tif (sdp->sd_args.ar_spectator)\n\t\tgoto out;\n\tif (sdp->sd_lockstruct.ls_ops->lm_mount == NULL)\n\t\tgoto out;\n\tsdp->sd_lockstruct.ls_first = first;\n\trv = 0;\nout:\n        spin_unlock(&sdp->sd_jindex_spin);\n        return rv ? rv : len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sdp->sd_jindex_spin"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "SDF_NOJOURNALID",
            "&sdp->sd_flags"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sdp->sd_jindex_spin"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_for_completion_killable",
          "args": [
            "&sdp->sd_locking_init"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%u\"",
            "&first"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t lkfirst_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tunsigned first;\n\tint rv;\n\n\trv = sscanf(buf, \"%u\", &first);\n\tif (rv != 1 || first > 1)\n\t\treturn -EINVAL;\n\trv = wait_for_completion_killable(&sdp->sd_locking_init);\n\tif (rv)\n\t\treturn rv;\n\tspin_lock(&sdp->sd_jindex_spin);\n\trv = -EBUSY;\n\tif (test_bit(SDF_NOJOURNALID, &sdp->sd_flags) == 0)\n\t\tgoto out;\n\trv = -EINVAL;\n\tif (sdp->sd_args.ar_spectator)\n\t\tgoto out;\n\tif (sdp->sd_lockstruct.ls_ops->lm_mount == NULL)\n\t\tgoto out;\n\tsdp->sd_lockstruct.ls_first = first;\n\trv = 0;\nout:\n        spin_unlock(&sdp->sd_jindex_spin);\n        return rv ? rv : len;\n}"
  },
  {
    "function_name": "lkfirst_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "366-370",
    "snippet": "static ssize_t lkfirst_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", ls->ls_first);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "ls->ls_first"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t lkfirst_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\treturn sprintf(buf, \"%d\\n\", ls->ls_first);\n}"
  },
  {
    "function_name": "wdack_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "351-364",
    "snippet": "static ssize_t wdack_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tssize_t ret = len;\n\tint val;\n\n\tval = simple_strtol(buf, NULL, 0);\n\n\tif ((val == 1) &&\n\t    !strcmp(sdp->sd_lockstruct.ls_ops->lm_proto_name, \"lock_dlm\"))\n\t\tcomplete(&sdp->sd_wdack);\n\telse\n\t\tret = -EINVAL;\n\treturn ret;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&sdp->sd_wdack"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "dio_aio_complete_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/direct-io.c",
          "lines": "275-280",
          "snippet": "static void dio_aio_complete_work(struct work_struct *work)\n{\n\tstruct dio *dio = container_of(work, struct dio, complete_work);\n\n\tdio_complete(dio, dio->iocb->ki_pos, 0, true);\n}",
          "includes": [
            "#include <linux/aio.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/atomic.h>",
            "#include <linux/uio.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/err.h>",
            "#include <linux/wait.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/aio.h>\n#include <linux/prefetch.h>\n#include <linux/atomic.h>\n#include <linux/uio.h>\n#include <linux/rwsem.h>\n#include <linux/buffer_head.h>\n#include <linux/blkdev.h>\n#include <linux/err.h>\n#include <linux/wait.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void dio_aio_complete_work(struct work_struct *work)\n{\n\tstruct dio *dio = container_of(work, struct dio, complete_work);\n\n\tdio_complete(dio, dio->iocb->ki_pos, 0, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "sdp->sd_lockstruct.ls_ops->lm_proto_name",
            "\"lock_dlm\""
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t wdack_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tssize_t ret = len;\n\tint val;\n\n\tval = simple_strtol(buf, NULL, 0);\n\n\tif ((val == 1) &&\n\t    !strcmp(sdp->sd_lockstruct.ls_ops->lm_proto_name, \"lock_dlm\"))\n\t\tcomplete(&sdp->sd_wdack);\n\telse\n\t\tret = -EINVAL;\n\treturn ret;\n}"
  },
  {
    "function_name": "wdack_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "344-349",
    "snippet": "static ssize_t wdack_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tint val = completion_done(&sdp->sd_wdack) ? 1 : 0;\n\n\treturn sprintf(buf, \"%d\\n\", val);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "val"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "completion_done",
          "args": [
            "&sdp->sd_wdack"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t wdack_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tint val = completion_done(&sdp->sd_wdack) ? 1 : 0;\n\n\treturn sprintf(buf, \"%d\\n\", val);\n}"
  },
  {
    "function_name": "block_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "324-342",
    "snippet": "static ssize_t block_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\tssize_t ret = len;\n\tint val;\n\n\tval = simple_strtol(buf, NULL, 0);\n\n\tif (val == 1)\n\t\tset_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags);\n\telse if (val == 0) {\n\t\tclear_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags);\n\t\tsmp_mb__after_atomic();\n\t\tgfs2_glock_thaw(sdp);\n\t} else {\n\t\tret = -EINVAL;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_thaw",
          "args": [
            "sdp"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_thaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1530-1533",
          "snippet": "void gfs2_glock_thaw(struct gfs2_sbd *sdp)\n{\n\tglock_hash_walk(thaw_glock, sdp);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_thaw(struct gfs2_sbd *sdp)\n{\n\tglock_hash_walk(thaw_glock, sdp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "DFL_BLOCK_LOCKS",
            "&ls->ls_recover_flags"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "DFL_BLOCK_LOCKS",
            "&ls->ls_recover_flags"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t block_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\tssize_t ret = len;\n\tint val;\n\n\tval = simple_strtol(buf, NULL, 0);\n\n\tif (val == 1)\n\t\tset_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags);\n\telse if (val == 0) {\n\t\tclear_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags);\n\t\tsmp_mb__after_atomic();\n\t\tgfs2_glock_thaw(sdp);\n\t} else {\n\t\tret = -EINVAL;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "block_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "312-322",
    "snippet": "static ssize_t block_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\tssize_t ret;\n\tint val = 0;\n\n\tif (test_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags))\n\t\tval = 1;\n\tret = sprintf(buf, \"%d\\n\", val);\n\treturn ret;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "val"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DFL_BLOCK_LOCKS",
            "&ls->ls_recover_flags"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t block_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\tssize_t ret;\n\tint val = 0;\n\n\tif (test_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags))\n\t\tval = 1;\n\tret = sprintf(buf, \"%d\\n\", val);\n\treturn ret;\n}"
  },
  {
    "function_name": "proto_name_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "306-310",
    "snippet": "static ssize_t proto_name_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tconst struct lm_lockops *ops = sdp->sd_lockstruct.ls_ops;\n\treturn sprintf(buf, \"%s\\n\", ops->lm_proto_name);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "ops->lm_proto_name"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t proto_name_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tconst struct lm_lockops *ops = sdp->sd_lockstruct.ls_ops;\n\treturn sprintf(buf, \"%s\\n\", ops->lm_proto_name);\n}"
  },
  {
    "function_name": "gfs2_sbd_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "288-293",
    "snippet": "static void gfs2_sbd_release(struct kobject *kobj)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\n\tkfree(sdp);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sdp"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structgfs2_sbd",
            "sd_kobj"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic void gfs2_sbd_release(struct kobject *kobj)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\n\tkfree(sdp);\n}"
  },
  {
    "function_name": "demote_rq_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "214-257",
    "snippet": "static ssize_t demote_rq_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tstruct gfs2_glock *gl;\n\tconst struct gfs2_glock_operations *glops;\n\tunsigned int glmode;\n\tunsigned int gltype;\n\tunsigned long long glnum;\n\tchar mode[16];\n\tint rv;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\trv = sscanf(buf, \"%u:%llu %15s\", &gltype, &glnum,\n\t\t    mode);\n\tif (rv != 3)\n\t\treturn -EINVAL;\n\n\tif (strcmp(mode, \"EX\") == 0)\n\t\tglmode = LM_ST_UNLOCKED;\n\telse if ((strcmp(mode, \"CW\") == 0) || (strcmp(mode, \"DF\") == 0))\n\t\tglmode = LM_ST_DEFERRED;\n\telse if ((strcmp(mode, \"PR\") == 0) || (strcmp(mode, \"SH\") == 0))\n\t\tglmode = LM_ST_SHARED;\n\telse\n\t\treturn -EINVAL;\n\n\tif (gltype > LM_TYPE_JOURNAL)\n\t\treturn -EINVAL;\n\tif (gltype == LM_TYPE_NONDISK && glnum == GFS2_FREEZE_LOCK)\n\t\tglops = &gfs2_freeze_glops;\n\telse\n\t\tglops = gfs2_glops_list[gltype];\n\tif (glops == NULL)\n\t\treturn -EINVAL;\n\tif (!test_and_set_bit(SDF_DEMOTE, &sdp->sd_flags))\n\t\tfs_info(sdp, \"demote interface used\\n\");\n\trv = gfs2_glock_get(sdp, glnum, glops, 0, &gl);\n\tif (rv)\n\t\treturn rv;\n\tgfs2_glock_cb(gl, glmode);\n\tgfs2_glock_put(gl);\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_cb",
          "args": [
            "gl",
            "glmode"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_cb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1251-1272",
          "snippet": "void gfs2_glock_cb(struct gfs2_glock *gl, unsigned int state)\n{\n\tunsigned long delay = 0;\n\tunsigned long holdtime;\n\tunsigned long now = jiffies;\n\n\tgfs2_glock_hold(gl);\n\tholdtime = gl->gl_tchange + gl->gl_hold_time;\n\tif (test_bit(GLF_QUEUED, &gl->gl_flags) &&\n\t    gl->gl_name.ln_type == LM_TYPE_INODE) {\n\t\tif (time_before(now, holdtime))\n\t\t\tdelay = holdtime - now;\n\t\tif (test_bit(GLF_REPLY_PENDING, &gl->gl_flags))\n\t\t\tdelay = gl->gl_hold_time;\n\t}\n\n\tspin_lock(&gl->gl_spin);\n\thandle_callback(gl, state, delay, true);\n\tspin_unlock(&gl->gl_spin);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\tgfs2_glock_put(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nvoid gfs2_glock_cb(struct gfs2_glock *gl, unsigned int state)\n{\n\tunsigned long delay = 0;\n\tunsigned long holdtime;\n\tunsigned long now = jiffies;\n\n\tgfs2_glock_hold(gl);\n\tholdtime = gl->gl_tchange + gl->gl_hold_time;\n\tif (test_bit(GLF_QUEUED, &gl->gl_flags) &&\n\t    gl->gl_name.ln_type == LM_TYPE_INODE) {\n\t\tif (time_before(now, holdtime))\n\t\t\tdelay = holdtime - now;\n\t\tif (test_bit(GLF_REPLY_PENDING, &gl->gl_flags))\n\t\t\tdelay = gl->gl_hold_time;\n\t}\n\n\tspin_lock(&gl->gl_spin);\n\thandle_callback(gl, state, delay, true);\n\tspin_unlock(&gl->gl_spin);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\tgfs2_glock_put(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_get",
          "args": [
            "sdp",
            "glnum",
            "glops",
            "0",
            "&gl"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "702-790",
          "snippet": "int gfs2_glock_get(struct gfs2_sbd *sdp, u64 number,\n\t\t   const struct gfs2_glock_operations *glops, int create,\n\t\t   struct gfs2_glock **glp)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tstruct lm_lockname name = { .ln_number = number, .ln_type = glops->go_type };\n\tstruct gfs2_glock *gl, *tmp;\n\tunsigned int hash = gl_hash(sdp, &name);\n\tstruct address_space *mapping;\n\tstruct kmem_cache *cachep;\n\n\trcu_read_lock();\n\tgl = search_bucket(hash, sdp, &name);\n\trcu_read_unlock();\n\n\t*glp = gl;\n\tif (gl)\n\t\treturn 0;\n\tif (!create)\n\t\treturn -ENOENT;\n\n\tif (glops->go_flags & GLOF_ASPACE)\n\t\tcachep = gfs2_glock_aspace_cachep;\n\telse\n\t\tcachep = gfs2_glock_cachep;\n\tgl = kmem_cache_alloc(cachep, GFP_NOFS);\n\tif (!gl)\n\t\treturn -ENOMEM;\n\n\tmemset(&gl->gl_lksb, 0, sizeof(struct dlm_lksb));\n\n\tif (glops->go_flags & GLOF_LVB) {\n\t\tgl->gl_lksb.sb_lvbptr = kzalloc(GFS2_MIN_LVB_SIZE, GFP_NOFS);\n\t\tif (!gl->gl_lksb.sb_lvbptr) {\n\t\t\tkmem_cache_free(cachep, gl);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t}\n\n\tatomic_inc(&sdp->sd_glock_disposal);\n\tgl->gl_sbd = sdp;\n\tgl->gl_flags = 0;\n\tgl->gl_name = name;\n\tgl->gl_lockref.count = 1;\n\tgl->gl_state = LM_ST_UNLOCKED;\n\tgl->gl_target = LM_ST_UNLOCKED;\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tgl->gl_hash = hash;\n\tgl->gl_ops = glops;\n\tgl->gl_dstamp = ktime_set(0, 0);\n\tpreempt_disable();\n\t/* We use the global stats to estimate the initial per-glock stats */\n\tgl->gl_stats = this_cpu_ptr(sdp->sd_lkstats)->lkstats[glops->go_type];\n\tpreempt_enable();\n\tgl->gl_stats.stats[GFS2_LKS_DCOUNT] = 0;\n\tgl->gl_stats.stats[GFS2_LKS_QCOUNT] = 0;\n\tgl->gl_tchange = jiffies;\n\tgl->gl_object = NULL;\n\tgl->gl_hold_time = GL_GLOCK_DFT_HOLD;\n\tINIT_DELAYED_WORK(&gl->gl_work, glock_work_func);\n\tINIT_WORK(&gl->gl_delete, delete_work_func);\n\n\tmapping = gfs2_glock2aspace(gl);\n\tif (mapping) {\n                mapping->a_ops = &gfs2_meta_aops;\n\t\tmapping->host = s->s_bdev->bd_inode;\n\t\tmapping->flags = 0;\n\t\tmapping_set_gfp_mask(mapping, GFP_NOFS);\n\t\tmapping->private_data = NULL;\n\t\tmapping->writeback_index = 0;\n\t}\n\n\tspin_lock_bucket(hash);\n\ttmp = search_bucket(hash, sdp, &name);\n\tif (tmp) {\n\t\tspin_unlock_bucket(hash);\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(cachep, gl);\n\t\tatomic_dec(&sdp->sd_glock_disposal);\n\t\tgl = tmp;\n\t} else {\n\t\thlist_bl_add_head_rcu(&gl->gl_list, &gl_hash_table[hash]);\n\t\tspin_unlock_bucket(hash);\n\t}\n\n\t*glp = gl;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nint gfs2_glock_get(struct gfs2_sbd *sdp, u64 number,\n\t\t   const struct gfs2_glock_operations *glops, int create,\n\t\t   struct gfs2_glock **glp)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tstruct lm_lockname name = { .ln_number = number, .ln_type = glops->go_type };\n\tstruct gfs2_glock *gl, *tmp;\n\tunsigned int hash = gl_hash(sdp, &name);\n\tstruct address_space *mapping;\n\tstruct kmem_cache *cachep;\n\n\trcu_read_lock();\n\tgl = search_bucket(hash, sdp, &name);\n\trcu_read_unlock();\n\n\t*glp = gl;\n\tif (gl)\n\t\treturn 0;\n\tif (!create)\n\t\treturn -ENOENT;\n\n\tif (glops->go_flags & GLOF_ASPACE)\n\t\tcachep = gfs2_glock_aspace_cachep;\n\telse\n\t\tcachep = gfs2_glock_cachep;\n\tgl = kmem_cache_alloc(cachep, GFP_NOFS);\n\tif (!gl)\n\t\treturn -ENOMEM;\n\n\tmemset(&gl->gl_lksb, 0, sizeof(struct dlm_lksb));\n\n\tif (glops->go_flags & GLOF_LVB) {\n\t\tgl->gl_lksb.sb_lvbptr = kzalloc(GFS2_MIN_LVB_SIZE, GFP_NOFS);\n\t\tif (!gl->gl_lksb.sb_lvbptr) {\n\t\t\tkmem_cache_free(cachep, gl);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t}\n\n\tatomic_inc(&sdp->sd_glock_disposal);\n\tgl->gl_sbd = sdp;\n\tgl->gl_flags = 0;\n\tgl->gl_name = name;\n\tgl->gl_lockref.count = 1;\n\tgl->gl_state = LM_ST_UNLOCKED;\n\tgl->gl_target = LM_ST_UNLOCKED;\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tgl->gl_hash = hash;\n\tgl->gl_ops = glops;\n\tgl->gl_dstamp = ktime_set(0, 0);\n\tpreempt_disable();\n\t/* We use the global stats to estimate the initial per-glock stats */\n\tgl->gl_stats = this_cpu_ptr(sdp->sd_lkstats)->lkstats[glops->go_type];\n\tpreempt_enable();\n\tgl->gl_stats.stats[GFS2_LKS_DCOUNT] = 0;\n\tgl->gl_stats.stats[GFS2_LKS_QCOUNT] = 0;\n\tgl->gl_tchange = jiffies;\n\tgl->gl_object = NULL;\n\tgl->gl_hold_time = GL_GLOCK_DFT_HOLD;\n\tINIT_DELAYED_WORK(&gl->gl_work, glock_work_func);\n\tINIT_WORK(&gl->gl_delete, delete_work_func);\n\n\tmapping = gfs2_glock2aspace(gl);\n\tif (mapping) {\n                mapping->a_ops = &gfs2_meta_aops;\n\t\tmapping->host = s->s_bdev->bd_inode;\n\t\tmapping->flags = 0;\n\t\tmapping_set_gfp_mask(mapping, GFP_NOFS);\n\t\tmapping->private_data = NULL;\n\t\tmapping->writeback_index = 0;\n\t}\n\n\tspin_lock_bucket(hash);\n\ttmp = search_bucket(hash, sdp, &name);\n\tif (tmp) {\n\t\tspin_unlock_bucket(hash);\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(cachep, gl);\n\t\tatomic_dec(&sdp->sd_glock_disposal);\n\t\tgl = tmp;\n\t} else {\n\t\thlist_bl_add_head_rcu(&gl->gl_list, &gl_hash_table[hash]);\n\t\tspin_unlock_bucket(hash);\n\t}\n\n\t*glp = gl;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs_info",
          "args": [
            "sdp",
            "\"demote interface used\\n\""
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "copy_fs_info_to_kstatfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/smb2pdu.c",
          "lines": "2426-2436",
          "snippet": "static void\ncopy_fs_info_to_kstatfs(struct smb2_fs_full_size_info *pfs_inf,\n\t\t\tstruct kstatfs *kst)\n{\n\tkst->f_bsize = le32_to_cpu(pfs_inf->BytesPerSector) *\n\t\t\t  le32_to_cpu(pfs_inf->SectorsPerAllocationUnit);\n\tkst->f_blocks = le64_to_cpu(pfs_inf->TotalAllocationUnits);\n\tkst->f_bfree  = le64_to_cpu(pfs_inf->ActualAvailableAllocationUnits);\n\tkst->f_bavail = le64_to_cpu(pfs_inf->CallerAvailableAllocationUnits);\n\treturn;\n}",
          "includes": [
            "#include \"cifspdu.h\"",
            "#include \"smb2glob.h\"",
            "#include \"smb2status.h\"",
            "#include \"ntlmssp.h\"",
            "#include \"cifs_debug.h\"",
            "#include \"cifs_unicode.h\"",
            "#include \"smb2proto.h\"",
            "#include \"cifsproto.h\"",
            "#include \"cifsacl.h\"",
            "#include \"cifsglob.h\"",
            "#include \"smb2pdu.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cifspdu.h\"\n#include \"smb2glob.h\"\n#include \"smb2status.h\"\n#include \"ntlmssp.h\"\n#include \"cifs_debug.h\"\n#include \"cifs_unicode.h\"\n#include \"smb2proto.h\"\n#include \"cifsproto.h\"\n#include \"cifsacl.h\"\n#include \"cifsglob.h\"\n#include \"smb2pdu.h\"\n#include <linux/xattr.h>\n#include <linux/pagemap.h>\n#include <linux/uaccess.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/vfs.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n\nstatic void\ncopy_fs_info_to_kstatfs(struct smb2_fs_full_size_info *pfs_inf,\n\t\t\tstruct kstatfs *kst)\n{\n\tkst->f_bsize = le32_to_cpu(pfs_inf->BytesPerSector) *\n\t\t\t  le32_to_cpu(pfs_inf->SectorsPerAllocationUnit);\n\tkst->f_blocks = le64_to_cpu(pfs_inf->TotalAllocationUnits);\n\tkst->f_bfree  = le64_to_cpu(pfs_inf->ActualAvailableAllocationUnits);\n\tkst->f_bavail = le64_to_cpu(pfs_inf->CallerAvailableAllocationUnits);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "SDF_DEMOTE",
            "&sdp->sd_flags"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "mode",
            "\"SH\""
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%u:%llu %15s\"",
            "&gltype",
            "&glnum",
            "mode"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t demote_rq_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tstruct gfs2_glock *gl;\n\tconst struct gfs2_glock_operations *glops;\n\tunsigned int glmode;\n\tunsigned int gltype;\n\tunsigned long long glnum;\n\tchar mode[16];\n\tint rv;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\trv = sscanf(buf, \"%u:%llu %15s\", &gltype, &glnum,\n\t\t    mode);\n\tif (rv != 3)\n\t\treturn -EINVAL;\n\n\tif (strcmp(mode, \"EX\") == 0)\n\t\tglmode = LM_ST_UNLOCKED;\n\telse if ((strcmp(mode, \"CW\") == 0) || (strcmp(mode, \"DF\") == 0))\n\t\tglmode = LM_ST_DEFERRED;\n\telse if ((strcmp(mode, \"PR\") == 0) || (strcmp(mode, \"SH\") == 0))\n\t\tglmode = LM_ST_SHARED;\n\telse\n\t\treturn -EINVAL;\n\n\tif (gltype > LM_TYPE_JOURNAL)\n\t\treturn -EINVAL;\n\tif (gltype == LM_TYPE_NONDISK && glnum == GFS2_FREEZE_LOCK)\n\t\tglops = &gfs2_freeze_glops;\n\telse\n\t\tglops = gfs2_glops_list[gltype];\n\tif (glops == NULL)\n\t\treturn -EINVAL;\n\tif (!test_and_set_bit(SDF_DEMOTE, &sdp->sd_flags))\n\t\tfs_info(sdp, \"demote interface used\\n\");\n\trv = gfs2_glock_get(sdp, glnum, glops, 0, &gl);\n\tif (rv)\n\t\treturn rv;\n\tgfs2_glock_cb(gl, glmode);\n\tgfs2_glock_put(gl);\n\treturn len;\n}"
  },
  {
    "function_name": "quota_refresh_group_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "194-212",
    "snippet": "static ssize_t quota_refresh_group_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t\t size_t len)\n{\n\tstruct kqid qid;\n\tint error;\n\tu32 id;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tid = simple_strtoul(buf, NULL, 0);\n\n\tqid = make_kqid(current_user_ns(), GRPQUOTA, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\n\terror = gfs2_quota_refresh(sdp, qid);\n\treturn error ? error : len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_quota_refresh",
          "args": [
            "sdp",
            "qid"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_quota_refresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "1212-1228",
          "snippet": "int gfs2_quota_refresh(struct gfs2_sbd *sdp, struct kqid qid)\n{\n\tstruct gfs2_quota_data *qd;\n\tstruct gfs2_holder q_gh;\n\tint error;\n\n\terror = qd_get(sdp, qid, &qd);\n\tif (error)\n\t\treturn error;\n\n\terror = do_glock(qd, FORCE, &q_gh);\n\tif (!error)\n\t\tgfs2_glock_dq_uninit(&q_gh);\n\n\tqd_put(qd);\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_quota_refresh(struct gfs2_sbd *sdp, struct kqid qid)\n{\n\tstruct gfs2_quota_data *qd;\n\tstruct gfs2_holder q_gh;\n\tint error;\n\n\terror = qd_get(sdp, qid, &qd);\n\tif (error)\n\t\treturn error;\n\n\terror = do_glock(qd, FORCE, &q_gh);\n\tif (!error)\n\t\tgfs2_glock_dq_uninit(&q_gh);\n\n\tqd_put(qd);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qid_valid",
          "args": [
            "qid"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "qid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "119-131",
          "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "current_user_ns()",
            "GRPQUOTA",
            "id"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t quota_refresh_group_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t\t size_t len)\n{\n\tstruct kqid qid;\n\tint error;\n\tu32 id;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tid = simple_strtoul(buf, NULL, 0);\n\n\tqid = make_kqid(current_user_ns(), GRPQUOTA, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\n\terror = gfs2_quota_refresh(sdp, qid);\n\treturn error ? error : len;\n}"
  },
  {
    "function_name": "quota_refresh_user_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "174-192",
    "snippet": "static ssize_t quota_refresh_user_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t\tsize_t len)\n{\n\tstruct kqid qid;\n\tint error;\n\tu32 id;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tid = simple_strtoul(buf, NULL, 0);\n\n\tqid = make_kqid(current_user_ns(), USRQUOTA, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\n\terror = gfs2_quota_refresh(sdp, qid);\n\treturn error ? error : len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_quota_refresh",
          "args": [
            "sdp",
            "qid"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_quota_refresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "1212-1228",
          "snippet": "int gfs2_quota_refresh(struct gfs2_sbd *sdp, struct kqid qid)\n{\n\tstruct gfs2_quota_data *qd;\n\tstruct gfs2_holder q_gh;\n\tint error;\n\n\terror = qd_get(sdp, qid, &qd);\n\tif (error)\n\t\treturn error;\n\n\terror = do_glock(qd, FORCE, &q_gh);\n\tif (!error)\n\t\tgfs2_glock_dq_uninit(&q_gh);\n\n\tqd_put(qd);\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_quota_refresh(struct gfs2_sbd *sdp, struct kqid qid)\n{\n\tstruct gfs2_quota_data *qd;\n\tstruct gfs2_holder q_gh;\n\tint error;\n\n\terror = qd_get(sdp, qid, &qd);\n\tif (error)\n\t\treturn error;\n\n\terror = do_glock(qd, FORCE, &q_gh);\n\tif (!error)\n\t\tgfs2_glock_dq_uninit(&q_gh);\n\n\tqd_put(qd);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qid_valid",
          "args": [
            "qid"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "qid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "119-131",
          "snippet": "bool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_valid(struct kqid qid)\n{\n\tswitch (qid.type) {\n\tcase USRQUOTA:\n\t\treturn uid_valid(qid.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_valid(qid.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_valid(qid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid",
          "args": [
            "current_user_ns()",
            "USRQUOTA",
            "id"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t quota_refresh_user_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t\tsize_t len)\n{\n\tstruct kqid qid;\n\tint error;\n\tu32 id;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tid = simple_strtoul(buf, NULL, 0);\n\n\tqid = make_kqid(current_user_ns(), USRQUOTA, id);\n\tif (!qid_valid(qid))\n\t\treturn -EINVAL;\n\n\terror = gfs2_quota_refresh(sdp, qid);\n\treturn error ? error : len;\n}"
  },
  {
    "function_name": "quota_sync_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "161-172",
    "snippet": "static ssize_t quota_sync_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\tsize_t len)\n{\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (simple_strtol(buf, NULL, 0) != 1)\n\t\treturn -EINVAL;\n\n\tgfs2_quota_sync(sdp->sd_vfs, 0);\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_quota_sync",
          "args": [
            "sdp->sd_vfs",
            "0"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_quota_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "1166-1210",
          "snippet": "int gfs2_quota_sync(struct super_block *sb, int type)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct gfs2_quota_data **qda;\n\tunsigned int max_qd = PAGE_SIZE/sizeof(struct gfs2_holder);\n\tunsigned int num_qd;\n\tunsigned int x;\n\tint error = 0;\n\n\tqda = kcalloc(max_qd, sizeof(struct gfs2_quota_data *), GFP_KERNEL);\n\tif (!qda)\n\t\treturn -ENOMEM;\n\n\tmutex_lock(&sdp->sd_quota_sync_mutex);\n\tsdp->sd_quota_sync_gen++;\n\n\tdo {\n\t\tnum_qd = 0;\n\n\t\tfor (;;) {\n\t\t\terror = qd_fish(sdp, qda + num_qd);\n\t\t\tif (error || !qda[num_qd])\n\t\t\t\tbreak;\n\t\t\tif (++num_qd == max_qd)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (num_qd) {\n\t\t\tif (!error)\n\t\t\t\terror = do_sync(num_qd, qda);\n\t\t\tif (!error)\n\t\t\t\tfor (x = 0; x < num_qd; x++)\n\t\t\t\t\tqda[x]->qd_sync_gen =\n\t\t\t\t\t\tsdp->sd_quota_sync_gen;\n\n\t\t\tfor (x = 0; x < num_qd; x++)\n\t\t\t\tqd_unlock(qda[x]);\n\t\t}\n\t} while (!error && num_qd == max_qd);\n\n\tmutex_unlock(&sdp->sd_quota_sync_mutex);\n\tkfree(qda);\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_quota_sync(struct super_block *sb, int type)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct gfs2_quota_data **qda;\n\tunsigned int max_qd = PAGE_SIZE/sizeof(struct gfs2_holder);\n\tunsigned int num_qd;\n\tunsigned int x;\n\tint error = 0;\n\n\tqda = kcalloc(max_qd, sizeof(struct gfs2_quota_data *), GFP_KERNEL);\n\tif (!qda)\n\t\treturn -ENOMEM;\n\n\tmutex_lock(&sdp->sd_quota_sync_mutex);\n\tsdp->sd_quota_sync_gen++;\n\n\tdo {\n\t\tnum_qd = 0;\n\n\t\tfor (;;) {\n\t\t\terror = qd_fish(sdp, qda + num_qd);\n\t\t\tif (error || !qda[num_qd])\n\t\t\t\tbreak;\n\t\t\tif (++num_qd == max_qd)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (num_qd) {\n\t\t\tif (!error)\n\t\t\t\terror = do_sync(num_qd, qda);\n\t\t\tif (!error)\n\t\t\t\tfor (x = 0; x < num_qd; x++)\n\t\t\t\t\tqda[x]->qd_sync_gen =\n\t\t\t\t\t\tsdp->sd_quota_sync_gen;\n\n\t\t\tfor (x = 0; x < num_qd; x++)\n\t\t\t\tqd_unlock(qda[x]);\n\t\t}\n\t} while (!error && num_qd == max_qd);\n\n\tmutex_unlock(&sdp->sd_quota_sync_mutex);\n\tkfree(qda);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t quota_sync_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\tsize_t len)\n{\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (simple_strtol(buf, NULL, 0) != 1)\n\t\treturn -EINVAL;\n\n\tgfs2_quota_sync(sdp->sd_vfs, 0);\n\treturn len;\n}"
  },
  {
    "function_name": "statfs_sync_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "148-159",
    "snippet": "static ssize_t statfs_sync_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t size_t len)\n{\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (simple_strtol(buf, NULL, 0) != 1)\n\t\treturn -EINVAL;\n\n\tgfs2_statfs_sync(sdp->sd_vfs, 0);\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_statfs_sync",
          "args": [
            "sdp->sd_vfs",
            "0"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_statfs_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/super.c",
          "lines": "573-625",
          "snippet": "int gfs2_statfs_sync(struct super_block *sb, int type)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);\n\tstruct gfs2_inode *l_ip = GFS2_I(sdp->sd_sc_inode);\n\tstruct gfs2_statfs_change_host *m_sc = &sdp->sd_statfs_master;\n\tstruct gfs2_statfs_change_host *l_sc = &sdp->sd_statfs_local;\n\tstruct gfs2_holder gh;\n\tstruct buffer_head *m_bh, *l_bh;\n\tint error;\n\n\tsb_start_write(sb);\n\terror = gfs2_glock_nq_init(m_ip->i_gl, LM_ST_EXCLUSIVE, GL_NOCACHE,\n\t\t\t\t   &gh);\n\tif (error)\n\t\tgoto out;\n\n\terror = gfs2_meta_inode_buffer(m_ip, &m_bh);\n\tif (error)\n\t\tgoto out_unlock;\n\n\tspin_lock(&sdp->sd_statfs_spin);\n\tgfs2_statfs_change_in(m_sc, m_bh->b_data +\n\t\t\t      sizeof(struct gfs2_dinode));\n\tif (!l_sc->sc_total && !l_sc->sc_free && !l_sc->sc_dinodes) {\n\t\tspin_unlock(&sdp->sd_statfs_spin);\n\t\tgoto out_bh;\n\t}\n\tspin_unlock(&sdp->sd_statfs_spin);\n\n\terror = gfs2_meta_inode_buffer(l_ip, &l_bh);\n\tif (error)\n\t\tgoto out_bh;\n\n\terror = gfs2_trans_begin(sdp, 2 * RES_DINODE, 0);\n\tif (error)\n\t\tgoto out_bh2;\n\n\tupdate_statfs(sdp, m_bh, l_bh);\n\tsdp->sd_statfs_force_sync = 0;\n\n\tgfs2_trans_end(sdp);\n\nout_bh2:\n\tbrelse(l_bh);\nout_bh:\n\tbrelse(m_bh);\nout_unlock:\n\tgfs2_glock_dq_uninit(&gh);\nout:\n\tsb_end_write(sb);\n\treturn error;\n}",
          "includes": [
            "#include \"xattr.h\"",
            "#include \"sys.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"recovery.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"dir.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/wait.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/statfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/bio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xattr.h\"\n#include \"sys.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/kernel.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/wait.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/statfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/bio.h>\n\nint gfs2_statfs_sync(struct super_block *sb, int type)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct gfs2_inode *m_ip = GFS2_I(sdp->sd_statfs_inode);\n\tstruct gfs2_inode *l_ip = GFS2_I(sdp->sd_sc_inode);\n\tstruct gfs2_statfs_change_host *m_sc = &sdp->sd_statfs_master;\n\tstruct gfs2_statfs_change_host *l_sc = &sdp->sd_statfs_local;\n\tstruct gfs2_holder gh;\n\tstruct buffer_head *m_bh, *l_bh;\n\tint error;\n\n\tsb_start_write(sb);\n\terror = gfs2_glock_nq_init(m_ip->i_gl, LM_ST_EXCLUSIVE, GL_NOCACHE,\n\t\t\t\t   &gh);\n\tif (error)\n\t\tgoto out;\n\n\terror = gfs2_meta_inode_buffer(m_ip, &m_bh);\n\tif (error)\n\t\tgoto out_unlock;\n\n\tspin_lock(&sdp->sd_statfs_spin);\n\tgfs2_statfs_change_in(m_sc, m_bh->b_data +\n\t\t\t      sizeof(struct gfs2_dinode));\n\tif (!l_sc->sc_total && !l_sc->sc_free && !l_sc->sc_dinodes) {\n\t\tspin_unlock(&sdp->sd_statfs_spin);\n\t\tgoto out_bh;\n\t}\n\tspin_unlock(&sdp->sd_statfs_spin);\n\n\terror = gfs2_meta_inode_buffer(l_ip, &l_bh);\n\tif (error)\n\t\tgoto out_bh;\n\n\terror = gfs2_trans_begin(sdp, 2 * RES_DINODE, 0);\n\tif (error)\n\t\tgoto out_bh2;\n\n\tupdate_statfs(sdp, m_bh, l_bh);\n\tsdp->sd_statfs_force_sync = 0;\n\n\tgfs2_trans_end(sdp);\n\nout_bh2:\n\tbrelse(l_bh);\nout_bh:\n\tbrelse(m_bh);\nout_unlock:\n\tgfs2_glock_dq_uninit(&gh);\nout:\n\tsb_end_write(sb);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t statfs_sync_store(struct gfs2_sbd *sdp, const char *buf,\n\t\t\t\t size_t len)\n{\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (simple_strtol(buf, NULL, 0) != 1)\n\t\treturn -EINVAL;\n\n\tgfs2_statfs_sync(sdp->sd_vfs, 0);\n\treturn len;\n}"
  },
  {
    "function_name": "withdraw_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "135-146",
    "snippet": "static ssize_t withdraw_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (simple_strtol(buf, NULL, 0) != 1)\n\t\treturn -EINVAL;\n\n\tgfs2_lm_withdraw(sdp, \"withdrawing from cluster at user's request\\n\");\n\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_lm_withdraw",
          "args": [
            "sdp",
            "\"withdrawing from cluster at user's request\\n\""
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_lm_withdraw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/util.c",
          "lines": "38-79",
          "snippet": "int gfs2_lm_withdraw(struct gfs2_sbd *sdp, const char *fmt, ...)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\tconst struct lm_lockops *lm = ls->ls_ops;\n\tva_list args;\n\tstruct va_format vaf;\n\n\tif (sdp->sd_args.ar_errors == GFS2_ERRORS_WITHDRAW &&\n\t    test_and_set_bit(SDF_SHUTDOWN, &sdp->sd_flags))\n\t\treturn 0;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tfs_err(sdp, \"%pV\", &vaf);\n\n\tva_end(args);\n\n\tif (sdp->sd_args.ar_errors == GFS2_ERRORS_WITHDRAW) {\n\t\tfs_err(sdp, \"about to withdraw this file system\\n\");\n\t\tBUG_ON(sdp->sd_args.ar_debug);\n\n\t\tkobject_uevent(&sdp->sd_kobj, KOBJ_OFFLINE);\n\n\t\tif (!strcmp(sdp->sd_lockstruct.ls_ops->lm_proto_name, \"lock_dlm\"))\n\t\t\twait_for_completion(&sdp->sd_wdack);\n\n\t\tif (lm->lm_unmount) {\n\t\t\tfs_err(sdp, \"telling LM to unmount\\n\");\n\t\t\tlm->lm_unmount(sdp);\n\t\t}\n\t\tfs_err(sdp, \"withdrawn\\n\");\n\t\tdump_stack();\n\t}\n\n\tif (sdp->sd_args.ar_errors == GFS2_ERRORS_PANIC)\n\t\tpanic(\"GFS2: fsid=%s: panic requested\\n\", sdp->sd_fsname);\n\n\treturn -1;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/crc32.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/crc32.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nint gfs2_lm_withdraw(struct gfs2_sbd *sdp, const char *fmt, ...)\n{\n\tstruct lm_lockstruct *ls = &sdp->sd_lockstruct;\n\tconst struct lm_lockops *lm = ls->ls_ops;\n\tva_list args;\n\tstruct va_format vaf;\n\n\tif (sdp->sd_args.ar_errors == GFS2_ERRORS_WITHDRAW &&\n\t    test_and_set_bit(SDF_SHUTDOWN, &sdp->sd_flags))\n\t\treturn 0;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tfs_err(sdp, \"%pV\", &vaf);\n\n\tva_end(args);\n\n\tif (sdp->sd_args.ar_errors == GFS2_ERRORS_WITHDRAW) {\n\t\tfs_err(sdp, \"about to withdraw this file system\\n\");\n\t\tBUG_ON(sdp->sd_args.ar_debug);\n\n\t\tkobject_uevent(&sdp->sd_kobj, KOBJ_OFFLINE);\n\n\t\tif (!strcmp(sdp->sd_lockstruct.ls_ops->lm_proto_name, \"lock_dlm\"))\n\t\t\twait_for_completion(&sdp->sd_wdack);\n\n\t\tif (lm->lm_unmount) {\n\t\t\tfs_err(sdp, \"telling LM to unmount\\n\");\n\t\t\tlm->lm_unmount(sdp);\n\t\t}\n\t\tfs_err(sdp, \"withdrawn\\n\");\n\t\tdump_stack();\n\t}\n\n\tif (sdp->sd_args.ar_errors == GFS2_ERRORS_PANIC)\n\t\tpanic(\"GFS2: fsid=%s: panic requested\\n\", sdp->sd_fsname);\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t withdraw_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (simple_strtol(buf, NULL, 0) != 1)\n\t\treturn -EINVAL;\n\n\tgfs2_lm_withdraw(sdp, \"withdrawing from cluster at user's request\\n\");\n\n\treturn len;\n}"
  },
  {
    "function_name": "withdraw_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "129-133",
    "snippet": "static ssize_t withdraw_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tunsigned int b = test_bit(SDF_SHUTDOWN, &sdp->sd_flags);\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", b);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "b"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "SDF_SHUTDOWN",
            "&sdp->sd_flags"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t withdraw_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tunsigned int b = test_bit(SDF_SHUTDOWN, &sdp->sd_flags);\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", b);\n}"
  },
  {
    "function_name": "freeze_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "102-127",
    "snippet": "static ssize_t freeze_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tint error;\n\tint n = simple_strtol(buf, NULL, 0);\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tswitch (n) {\n\tcase 0:\n\t\terror = thaw_super(sdp->sd_vfs);\n\t\tbreak;\n\tcase 1:\n\t\terror = freeze_super(sdp->sd_vfs);\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tif (error) {\n\t\tfs_warn(sdp, \"freeze %d error %d\", n, error);\n\t\treturn error;\n\t}\n\n\treturn len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs_warn",
          "args": [
            "sdp",
            "\"freeze %d error %d\"",
            "n",
            "error"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "befs_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "40-51",
          "snippet": "void\nbefs_warning(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_warn(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_warning(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_warn(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "freeze_super",
          "args": [
            "sdp->sd_vfs"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "thaw_super",
          "args": [
            "sdp->sd_vfs"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "buf",
            "NULL",
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t freeze_store(struct gfs2_sbd *sdp, const char *buf, size_t len)\n{\n\tint error;\n\tint n = simple_strtol(buf, NULL, 0);\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tswitch (n) {\n\tcase 0:\n\t\terror = thaw_super(sdp->sd_vfs);\n\t\tbreak;\n\tcase 1:\n\t\terror = freeze_super(sdp->sd_vfs);\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tif (error) {\n\t\tfs_warn(sdp, \"freeze %d error %d\", n, error);\n\t\treturn error;\n\t}\n\n\treturn len;\n}"
  },
  {
    "function_name": "freeze_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "94-100",
    "snippet": "static ssize_t freeze_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tint frozen = (sb->s_writers.frozen == SB_UNFROZEN) ? 0 : 1;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d\\n\", frozen);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d\\n\"",
            "frozen"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t freeze_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tint frozen = (sb->s_writers.frozen == SB_UNFROZEN) ? 0 : 1;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d\\n\", frozen);\n}"
  },
  {
    "function_name": "uuid_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "84-92",
    "snippet": "static ssize_t uuid_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tconst u8 *uuid = s->s_uuid;\n\tbuf[0] = '\\0';\n\tif (!gfs2_uuid_valid(uuid))\n\t\treturn 0;\n\treturn snprintf(buf, PAGE_SIZE, \"%pUB\\n\", uuid);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%pUB\\n\"",
            "uuid"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_uuid_valid",
          "args": [
            "uuid"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t uuid_show(struct gfs2_sbd *sdp, char *buf)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tconst u8 *uuid = s->s_uuid;\n\tbuf[0] = '\\0';\n\tif (!gfs2_uuid_valid(uuid))\n\t\treturn 0;\n\treturn snprintf(buf, PAGE_SIZE, \"%pUB\\n\", uuid);\n}"
  },
  {
    "function_name": "gfs2_uuid_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "73-82",
    "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "fsname_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "68-71",
    "snippet": "static ssize_t fsname_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", sdp->sd_fsname);\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%s\\n\"",
            "sdp->sd_fsname"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t fsname_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", sdp->sd_fsname);\n}"
  },
  {
    "function_name": "id_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "62-66",
    "snippet": "static ssize_t id_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%u:%u\\n\",\n\t\t\tMAJOR(sdp->sd_vfs->s_dev), MINOR(sdp->sd_vfs->s_dev));\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u:%u\\n\"",
            "MAJOR(sdp->sd_vfs->s_dev)",
            "MINOR(sdp->sd_vfs->s_dev)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "sdp->sd_vfs->s_dev"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "sdp->sd_vfs->s_dev"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t id_show(struct gfs2_sbd *sdp, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%u:%u\\n\",\n\t\t\tMAJOR(sdp->sd_vfs->s_dev), MINOR(sdp->sd_vfs->s_dev));\n}"
  },
  {
    "function_name": "gfs2_attr_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "46-52",
    "snippet": "static ssize_t gfs2_attr_store(struct kobject *kobj, struct attribute *attr,\n\t\t\t       const char *buf, size_t len)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\tstruct gfs2_attr *a = container_of(attr, struct gfs2_attr, attr);\n\treturn a->store ? a->store(sdp, buf, len) : len;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->store",
          "args": [
            "sdp",
            "buf",
            "len"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structgfs2_attr",
            "attr"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structgfs2_sbd",
            "sd_kobj"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t gfs2_attr_store(struct kobject *kobj, struct attribute *attr,\n\t\t\t       const char *buf, size_t len)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\tstruct gfs2_attr *a = container_of(attr, struct gfs2_attr, attr);\n\treturn a->store ? a->store(sdp, buf, len) : len;\n}"
  },
  {
    "function_name": "gfs2_attr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
    "lines": "38-44",
    "snippet": "static ssize_t gfs2_attr_show(struct kobject *kobj, struct attribute *attr,\n\t\t\t      char *buf)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\tstruct gfs2_attr *a = container_of(attr, struct gfs2_attr, attr);\n\treturn a->show ? a->show(sdp, buf) : 0;\n}",
    "includes": [
      "#include \"recovery.h\"",
      "#include \"glops.h\"",
      "#include \"util.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"super.h\"",
      "#include \"sys.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/genhd.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/kobject.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->show",
          "args": [
            "sdp",
            "buf"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structgfs2_attr",
            "attr"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structgfs2_sbd",
            "sd_kobj"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic ssize_t gfs2_attr_show(struct kobject *kobj, struct attribute *attr,\n\t\t\t      char *buf)\n{\n\tstruct gfs2_sbd *sdp = container_of(kobj, struct gfs2_sbd, sd_kobj);\n\tstruct gfs2_attr *a = container_of(attr, struct gfs2_attr, attr);\n\treturn a->show ? a->show(sdp, buf) : 0;\n}"
  }
]