[
  {
    "function_name": "exit_nfs_v4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "346-355",
    "snippet": "static void __exit exit_nfs_v4(void)\n{\n\t/* Not called in the _init(), conditionally loaded */\n\tnfs4_pnfs_v3_ds_connect_unload();\n\n\tunregister_nfs_version(&nfs_v4);\n\tnfs4_unregister_sysctl();\n\tnfs_idmap_quit();\n\tnfs_dns_resolver_destroy();\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_dns_resolver_destroy",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_resolver_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "465-469",
          "snippet": "void nfs_dns_resolver_destroy(void)\n{\n\trpc_pipefs_notifier_unregister(&nfs_dns_resolver_block);\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nvoid nfs_dns_resolver_destroy(void)\n{\n\trpc_pipefs_notifier_unregister(&nfs_dns_resolver_block);\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_idmap_quit",
          "args": [],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_quit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "505-508",
          "snippet": "void nfs_idmap_quit(void)\n{\n\tnfs_idmap_quit_keyring();\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid nfs_idmap_quit(void)\n{\n\tnfs_idmap_quit_keyring();\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_unregister_sysctl",
          "args": [],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_unregister_sysctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4sysctl.c",
          "lines": "65-69",
          "snippet": "void nfs4_unregister_sysctl(void)\n{\n\tunregister_sysctl_table(nfs4_callback_sysctl_table);\n\tnfs4_callback_sysctl_table = NULL;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/sysctl.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ctl_table_header *nfs4_callback_sysctl_table;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/sysctl.h>\n\nstatic struct ctl_table_header *nfs4_callback_sysctl_table;\n\nvoid nfs4_unregister_sysctl(void)\n{\n\tunregister_sysctl_table(nfs4_callback_sysctl_table);\n\tnfs4_callback_sysctl_table = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_nfs_version",
          "args": [
            "&nfs_v4"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "134-142",
          "snippet": "void unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_version_lock);",
            "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nvoid unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_pnfs_v3_ds_connect_unload",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_pnfs_v3_ds_connect_unload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs.h",
          "lines": "666-668",
          "snippet": "static inline void nfs4_pnfs_v3_ds_connect_unload(void)\n{\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void nfs4_pnfs_v3_ds_connect_unload(void)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstruct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};\n\nstatic void __exit exit_nfs_v4(void)\n{\n\t/* Not called in the _init(), conditionally loaded */\n\tnfs4_pnfs_v3_ds_connect_unload();\n\n\tunregister_nfs_version(&nfs_v4);\n\tnfs4_unregister_sysctl();\n\tnfs_idmap_quit();\n\tnfs_dns_resolver_destroy();\n}"
  },
  {
    "function_name": "init_nfs_v4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "320-344",
    "snippet": "static int __init init_nfs_v4(void)\n{\n\tint err;\n\n\terr = nfs_dns_resolver_init();\n\tif (err)\n\t\tgoto out;\n\n\terr = nfs_idmap_init();\n\tif (err)\n\t\tgoto out1;\n\n\terr = nfs4_register_sysctl();\n\tif (err)\n\t\tgoto out2;\n\n\tregister_nfs_version(&nfs_v4);\n\treturn 0;\nout2:\n\tnfs_idmap_quit();\nout1:\n\tnfs_dns_resolver_destroy();\nout:\n\treturn err;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_dns_resolver_destroy",
          "args": [],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_resolver_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "465-469",
          "snippet": "void nfs_dns_resolver_destroy(void)\n{\n\trpc_pipefs_notifier_unregister(&nfs_dns_resolver_block);\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nvoid nfs_dns_resolver_destroy(void)\n{\n\trpc_pipefs_notifier_unregister(&nfs_dns_resolver_block);\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_idmap_quit",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_quit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "505-508",
          "snippet": "void nfs_idmap_quit(void)\n{\n\tnfs_idmap_quit_keyring();\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid nfs_idmap_quit(void)\n{\n\tnfs_idmap_quit_keyring();\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_nfs_version",
          "args": [
            "&nfs_v4"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "134-142",
          "snippet": "void unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_version_lock);",
            "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nvoid unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_register_sysctl",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_register_sysctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4sysctl.c",
          "lines": "57-63",
          "snippet": "int nfs4_register_sysctl(void)\n{\n\tnfs4_callback_sysctl_table = register_sysctl_table(nfs4_cb_sysctl_root);\n\tif (nfs4_callback_sysctl_table == NULL)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/sysctl.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ctl_table_header *nfs4_callback_sysctl_table;",
            "static struct ctl_table nfs4_cb_sysctl_root[] = {\n\t{\n\t\t.procname = \"fs\",\n\t\t.mode = 0555,\n\t\t.child = nfs4_cb_sysctl_dir,\n\t},\n\t{ }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/sysctl.h>\n\nstatic struct ctl_table_header *nfs4_callback_sysctl_table;\nstatic struct ctl_table nfs4_cb_sysctl_root[] = {\n\t{\n\t\t.procname = \"fs\",\n\t\t.mode = 0555,\n\t\t.child = nfs4_cb_sysctl_dir,\n\t},\n\t{ }\n};\n\nint nfs4_register_sysctl(void)\n{\n\tnfs4_callback_sysctl_table = register_sysctl_table(nfs4_cb_sysctl_root);\n\tif (nfs4_callback_sysctl_table == NULL)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_idmap_init",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "495-503",
          "snippet": "int nfs_idmap_init(void)\n{\n\tint ret;\n\tret = nfs_idmap_init_keyring();\n\tif (ret != 0)\n\t\tgoto out;\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nint nfs_idmap_init(void)\n{\n\tint ret;\n\tret = nfs_idmap_init_keyring();\n\tif (ret != 0)\n\t\tgoto out;\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_dns_resolver_init",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_resolver_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "448-463",
          "snippet": "int nfs_dns_resolver_init(void)\n{\n\tint err;\n\n\terr = register_pernet_subsys(&nfs4_dns_resolver_ops);\n\tif (err < 0)\n\t\tgoto out;\n\terr = rpc_pipefs_notifier_register(&nfs_dns_resolver_block);\n\tif (err < 0)\n\t\tgoto out1;\n\treturn 0;\nout1:\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\nout:\n\treturn err;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nint nfs_dns_resolver_init(void)\n{\n\tint err;\n\n\terr = register_pernet_subsys(&nfs4_dns_resolver_ops);\n\tif (err < 0)\n\t\tgoto out;\n\terr = rpc_pipefs_notifier_register(&nfs_dns_resolver_block);\n\tif (err < 0)\n\t\tgoto out1;\n\treturn 0;\nout1:\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\nout:\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstruct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};\n\nstatic int __init init_nfs_v4(void)\n{\n\tint err;\n\n\terr = nfs_dns_resolver_init();\n\tif (err)\n\t\tgoto out;\n\n\terr = nfs_idmap_init();\n\tif (err)\n\t\tgoto out1;\n\n\terr = nfs4_register_sysctl();\n\tif (err)\n\t\tgoto out2;\n\n\tregister_nfs_version(&nfs_v4);\n\treturn 0;\nout2:\n\tnfs_idmap_quit();\nout1:\n\tnfs_dns_resolver_destroy();\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "nfs4_referral_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "295-317",
    "snippet": "static struct dentry *nfs4_referral_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data)\n{\n\tstruct nfs_clone_mount *data = raw_data;\n\tchar *export_path;\n\tstruct vfsmount *root_mnt;\n\tstruct dentry *res;\n\n\tdprintk(\"--> nfs4_referral_mount()\\n\");\n\n\texport_path = data->mnt_path;\n\tdata->mnt_path = \"/\";\n\n\troot_mnt = nfs_do_root_mount(&nfs4_remote_referral_fs_type,\n\t\t\tflags, data, data->hostname);\n\tdata->mnt_path = export_path;\n\n\tres = nfs_follow_remote_path(root_mnt, export_path);\n\tdprintk(\"<-- nfs4_referral_mount() = %d%s\\n\",\n\t\tPTR_ERR_OR_ZERO(res),\n\t\tIS_ERR(res) ? \" [error]\" : \"\");\n\treturn res;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *nfs4_remote_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);",
      "static struct dentry *nfs4_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);",
      "static struct dentry *nfs4_remote_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);",
      "static struct file_system_type nfs4_remote_referral_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs4\",\n\t.mount\t\t= nfs4_remote_referral_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs4_referral_mount() = %d%s\\n\"",
            "PTR_ERR_OR_ZERO(res)",
            "IS_ERR(res) ? \" [error]\" : \"\""
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "res"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR_OR_ZERO",
          "args": [
            "res"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_follow_remote_path",
          "args": [
            "root_mnt",
            "export_path"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_follow_remote_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "215-234",
          "snippet": "static struct dentry *nfs_follow_remote_path(struct vfsmount *root_mnt,\n\t\tconst char *export_path)\n{\n\tstruct dentry *dentry;\n\tint err;\n\n\tif (IS_ERR(root_mnt))\n\t\treturn ERR_CAST(root_mnt);\n\n\terr = nfs_referral_loop_protect();\n\tif (err) {\n\t\tmntput(root_mnt);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tdentry = mount_subtree(root_mnt, export_path);\n\tnfs_referral_loop_unprotect();\n\n\treturn dentry;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct dentry *nfs_follow_remote_path(struct vfsmount *root_mnt,\n\t\tconst char *export_path)\n{\n\tstruct dentry *dentry;\n\tint err;\n\n\tif (IS_ERR(root_mnt))\n\t\treturn ERR_CAST(root_mnt);\n\n\terr = nfs_referral_loop_protect();\n\tif (err) {\n\t\tmntput(root_mnt);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tdentry = mount_subtree(root_mnt, export_path);\n\tnfs_referral_loop_unprotect();\n\n\treturn dentry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_do_root_mount",
          "args": [
            "&nfs4_remote_referral_fs_type",
            "flags",
            "data",
            "data->hostname"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_root_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "128-147",
          "snippet": "static struct vfsmount *nfs_do_root_mount(struct file_system_type *fs_type,\n\t\tint flags, void *data, const char *hostname)\n{\n\tstruct vfsmount *root_mnt;\n\tchar *root_devname;\n\tsize_t len;\n\n\tlen = strlen(hostname) + 5;\n\troot_devname = kmalloc(len, GFP_KERNEL);\n\tif (root_devname == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\t/* Does hostname needs to be enclosed in brackets? */\n\tif (strchr(hostname, ':'))\n\t\tsnprintf(root_devname, len, \"[%s]:/\", hostname);\n\telse\n\t\tsnprintf(root_devname, len, \"%s:/\", hostname);\n\troot_mnt = vfs_kern_mount(fs_type, flags, root_devname, data);\n\tkfree(root_devname);\n\treturn root_mnt;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct vfsmount *nfs_do_root_mount(struct file_system_type *fs_type,\n\t\tint flags, void *data, const char *hostname)\n{\n\tstruct vfsmount *root_mnt;\n\tchar *root_devname;\n\tsize_t len;\n\n\tlen = strlen(hostname) + 5;\n\troot_devname = kmalloc(len, GFP_KERNEL);\n\tif (root_devname == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\t/* Does hostname needs to be enclosed in brackets? */\n\tif (strchr(hostname, ':'))\n\t\tsnprintf(root_devname, len, \"[%s]:/\", hostname);\n\telse\n\t\tsnprintf(root_devname, len, \"%s:/\", hostname);\n\troot_mnt = vfs_kern_mount(fs_type, flags, root_devname, data);\n\tkfree(root_devname);\n\treturn root_mnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs4_referral_mount()\\n\""
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct dentry *nfs4_remote_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);\nstatic struct dentry *nfs4_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);\nstatic struct dentry *nfs4_remote_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);\nstatic struct file_system_type nfs4_remote_referral_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs4\",\n\t.mount\t\t= nfs4_remote_referral_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\n\nstatic struct dentry *nfs4_referral_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data)\n{\n\tstruct nfs_clone_mount *data = raw_data;\n\tchar *export_path;\n\tstruct vfsmount *root_mnt;\n\tstruct dentry *res;\n\n\tdprintk(\"--> nfs4_referral_mount()\\n\");\n\n\texport_path = data->mnt_path;\n\tdata->mnt_path = \"/\";\n\n\troot_mnt = nfs_do_root_mount(&nfs4_remote_referral_fs_type,\n\t\t\tflags, data, data->hostname);\n\tdata->mnt_path = export_path;\n\n\tres = nfs_follow_remote_path(root_mnt, export_path);\n\tdprintk(\"<-- nfs4_referral_mount() = %d%s\\n\",\n\t\tPTR_ERR_OR_ZERO(res),\n\t\tIS_ERR(res) ? \" [error]\" : \"\");\n\treturn res;\n}"
  },
  {
    "function_name": "nfs4_remote_referral_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "261-290",
    "snippet": "static struct dentry *\nnfs4_remote_referral_mount(struct file_system_type *fs_type, int flags,\n\t\t\t   const char *dev_name, void *raw_data)\n{\n\tstruct nfs_mount_info mount_info = {\n\t\t.fill_super = nfs_fill_super,\n\t\t.set_security = nfs_clone_sb_security,\n\t\t.cloned = raw_data,\n\t};\n\tstruct nfs_server *server;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\n\tdprintk(\"--> nfs4_referral_get_sb()\\n\");\n\n\tmount_info.mntfh = nfs_alloc_fhandle();\n\tif (mount_info.cloned == NULL || mount_info.mntfh == NULL)\n\t\tgoto out;\n\n\t/* create a new volume representation */\n\tserver = nfs4_create_referral_server(mount_info.cloned, mount_info.mntfh);\n\tif (IS_ERR(server)) {\n\t\tmntroot = ERR_CAST(server);\n\t\tgoto out;\n\t}\n\n\tmntroot = nfs_fs_mount_common(server, flags, dev_name, &mount_info, &nfs_v4);\nout:\n\tnfs_free_fhandle(mount_info.mntfh);\n\treturn mntroot;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *nfs4_remote_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);",
      "static struct dentry *nfs4_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);",
      "static struct dentry *nfs4_remote_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);",
      "struct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_fhandle",
          "args": [
            "mount_info.mntfh"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fs_mount_common",
          "args": [
            "server",
            "flags",
            "dev_name",
            "&mount_info",
            "&nfs_v4"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_mount_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2535-2608",
          "snippet": "struct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "server"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_create_referral_server",
          "args": [
            "mount_info.cloned",
            "mount_info.mntfh"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_create_referral_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "1072-1123",
          "snippet": "struct nfs_server *nfs4_create_referral_server(struct nfs_clone_mount *data,\n\t\t\t\t\t       struct nfs_fh *mntfh)\n{\n\tstruct nfs_client *parent_client;\n\tstruct nfs_server *server, *parent_server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_referral_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tparent_server = NFS_SB(data->sb);\n\tparent_client = parent_server->nfs_client;\n\n\t/* Initialise the client representation from the parent server */\n\tnfs_server_copy_userdata(server, parent_server);\n\n\t/* Get a client representation.\n\t * Note: NFSv4 always uses TCP, */\n\terror = nfs4_set_client(server, data->hostname,\n\t\t\t\tdata->addr,\n\t\t\t\tdata->addrlen,\n\t\t\t\tparent_client->cl_ipaddr,\n\t\t\t\tdata->authflavor,\n\t\t\t\trpc_protocol(parent_server->client),\n\t\t\t\tparent_server->client->cl_timeout,\n\t\t\t\tparent_client->cl_mvops->minor_version,\n\t\t\t\tparent_client->cl_net);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs_init_server_rpcclient(server, parent_server->client->cl_timeout, data->authflavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\tauth_probe = parent_server->auth_info.flavor_len < 1;\n\n\terror = nfs4_server_common_setup(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs_create_referral_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_referral_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs4_create_referral_server(struct nfs_clone_mount *data,\n\t\t\t\t\t       struct nfs_fh *mntfh)\n{\n\tstruct nfs_client *parent_client;\n\tstruct nfs_server *server, *parent_server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_referral_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tparent_server = NFS_SB(data->sb);\n\tparent_client = parent_server->nfs_client;\n\n\t/* Initialise the client representation from the parent server */\n\tnfs_server_copy_userdata(server, parent_server);\n\n\t/* Get a client representation.\n\t * Note: NFSv4 always uses TCP, */\n\terror = nfs4_set_client(server, data->hostname,\n\t\t\t\tdata->addr,\n\t\t\t\tdata->addrlen,\n\t\t\t\tparent_client->cl_ipaddr,\n\t\t\t\tdata->authflavor,\n\t\t\t\trpc_protocol(parent_server->client),\n\t\t\t\tparent_server->client->cl_timeout,\n\t\t\t\tparent_client->cl_mvops->minor_version,\n\t\t\t\tparent_client->cl_net);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs_init_server_rpcclient(server, parent_server->client->cl_timeout, data->authflavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\tauth_probe = parent_server->auth_info.flavor_len < 1;\n\n\terror = nfs4_server_common_setup(server, mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs_create_referral_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_referral_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fhandle",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1323-1331",
          "snippet": "struct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs4_referral_get_sb()\\n\""
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct dentry *nfs4_remote_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);\nstatic struct dentry *nfs4_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);\nstatic struct dentry *nfs4_remote_referral_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data);\nstruct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};\n\nstatic struct dentry *\nnfs4_remote_referral_mount(struct file_system_type *fs_type, int flags,\n\t\t\t   const char *dev_name, void *raw_data)\n{\n\tstruct nfs_mount_info mount_info = {\n\t\t.fill_super = nfs_fill_super,\n\t\t.set_security = nfs_clone_sb_security,\n\t\t.cloned = raw_data,\n\t};\n\tstruct nfs_server *server;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\n\tdprintk(\"--> nfs4_referral_get_sb()\\n\");\n\n\tmount_info.mntfh = nfs_alloc_fhandle();\n\tif (mount_info.cloned == NULL || mount_info.mntfh == NULL)\n\t\tgoto out;\n\n\t/* create a new volume representation */\n\tserver = nfs4_create_referral_server(mount_info.cloned, mount_info.mntfh);\n\tif (IS_ERR(server)) {\n\t\tmntroot = ERR_CAST(server);\n\t\tgoto out;\n\t}\n\n\tmntroot = nfs_fs_mount_common(server, flags, dev_name, &mount_info, &nfs_v4);\nout:\n\tnfs_free_fhandle(mount_info.mntfh);\n\treturn mntroot;\n}"
  },
  {
    "function_name": "nfs4_try_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "236-259",
    "snippet": "struct dentry *nfs4_try_mount(int flags, const char *dev_name,\n\t\t\t      struct nfs_mount_info *mount_info,\n\t\t\t      struct nfs_subversion *nfs_mod)\n{\n\tchar *export_path;\n\tstruct vfsmount *root_mnt;\n\tstruct dentry *res;\n\tstruct nfs_parsed_mount_data *data = mount_info->parsed;\n\n\tdfprintk(MOUNT, \"--> nfs4_try_mount()\\n\");\n\n\texport_path = data->nfs_server.export_path;\n\tdata->nfs_server.export_path = \"/\";\n\troot_mnt = nfs_do_root_mount(&nfs4_remote_fs_type, flags, mount_info,\n\t\t\tdata->nfs_server.hostname);\n\tdata->nfs_server.export_path = export_path;\n\n\tres = nfs_follow_remote_path(root_mnt, export_path);\n\n\tdfprintk(MOUNT, \"<-- nfs4_try_mount() = %d%s\\n\",\n\t\t PTR_ERR_OR_ZERO(res),\n\t\t IS_ERR(res) ? \" [error]\" : \"\");\n\treturn res;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct file_system_type nfs4_remote_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs4\",\n\t.mount\t\t= nfs4_remote_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"<-- nfs4_try_mount() = %d%s\\n\"",
            "PTR_ERR_OR_ZERO(res)",
            "IS_ERR(res) ? \" [error]\" : \"\""
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "res"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR_OR_ZERO",
          "args": [
            "res"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_follow_remote_path",
          "args": [
            "root_mnt",
            "export_path"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_follow_remote_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "215-234",
          "snippet": "static struct dentry *nfs_follow_remote_path(struct vfsmount *root_mnt,\n\t\tconst char *export_path)\n{\n\tstruct dentry *dentry;\n\tint err;\n\n\tif (IS_ERR(root_mnt))\n\t\treturn ERR_CAST(root_mnt);\n\n\terr = nfs_referral_loop_protect();\n\tif (err) {\n\t\tmntput(root_mnt);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tdentry = mount_subtree(root_mnt, export_path);\n\tnfs_referral_loop_unprotect();\n\n\treturn dentry;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct dentry *nfs_follow_remote_path(struct vfsmount *root_mnt,\n\t\tconst char *export_path)\n{\n\tstruct dentry *dentry;\n\tint err;\n\n\tif (IS_ERR(root_mnt))\n\t\treturn ERR_CAST(root_mnt);\n\n\terr = nfs_referral_loop_protect();\n\tif (err) {\n\t\tmntput(root_mnt);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tdentry = mount_subtree(root_mnt, export_path);\n\tnfs_referral_loop_unprotect();\n\n\treturn dentry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_do_root_mount",
          "args": [
            "&nfs4_remote_fs_type",
            "flags",
            "mount_info",
            "data->nfs_server.hostname"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_root_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "128-147",
          "snippet": "static struct vfsmount *nfs_do_root_mount(struct file_system_type *fs_type,\n\t\tint flags, void *data, const char *hostname)\n{\n\tstruct vfsmount *root_mnt;\n\tchar *root_devname;\n\tsize_t len;\n\n\tlen = strlen(hostname) + 5;\n\troot_devname = kmalloc(len, GFP_KERNEL);\n\tif (root_devname == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\t/* Does hostname needs to be enclosed in brackets? */\n\tif (strchr(hostname, ':'))\n\t\tsnprintf(root_devname, len, \"[%s]:/\", hostname);\n\telse\n\t\tsnprintf(root_devname, len, \"%s:/\", hostname);\n\troot_mnt = vfs_kern_mount(fs_type, flags, root_devname, data);\n\tkfree(root_devname);\n\treturn root_mnt;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct vfsmount *nfs_do_root_mount(struct file_system_type *fs_type,\n\t\tint flags, void *data, const char *hostname)\n{\n\tstruct vfsmount *root_mnt;\n\tchar *root_devname;\n\tsize_t len;\n\n\tlen = strlen(hostname) + 5;\n\troot_devname = kmalloc(len, GFP_KERNEL);\n\tif (root_devname == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\t/* Does hostname needs to be enclosed in brackets? */\n\tif (strchr(hostname, ':'))\n\t\tsnprintf(root_devname, len, \"[%s]:/\", hostname);\n\telse\n\t\tsnprintf(root_devname, len, \"%s:/\", hostname);\n\troot_mnt = vfs_kern_mount(fs_type, flags, root_devname, data);\n\tkfree(root_devname);\n\treturn root_mnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"--> nfs4_try_mount()\\n\""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct file_system_type nfs4_remote_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs4\",\n\t.mount\t\t= nfs4_remote_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\n\nstruct dentry *nfs4_try_mount(int flags, const char *dev_name,\n\t\t\t      struct nfs_mount_info *mount_info,\n\t\t\t      struct nfs_subversion *nfs_mod)\n{\n\tchar *export_path;\n\tstruct vfsmount *root_mnt;\n\tstruct dentry *res;\n\tstruct nfs_parsed_mount_data *data = mount_info->parsed;\n\n\tdfprintk(MOUNT, \"--> nfs4_try_mount()\\n\");\n\n\texport_path = data->nfs_server.export_path;\n\tdata->nfs_server.export_path = \"/\";\n\troot_mnt = nfs_do_root_mount(&nfs4_remote_fs_type, flags, mount_info,\n\t\t\tdata->nfs_server.hostname);\n\tdata->nfs_server.export_path = export_path;\n\n\tres = nfs_follow_remote_path(root_mnt, export_path);\n\n\tdfprintk(MOUNT, \"<-- nfs4_try_mount() = %d%s\\n\",\n\t\t PTR_ERR_OR_ZERO(res),\n\t\t IS_ERR(res) ? \" [error]\" : \"\");\n\treturn res;\n}"
  },
  {
    "function_name": "nfs_follow_remote_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "215-234",
    "snippet": "static struct dentry *nfs_follow_remote_path(struct vfsmount *root_mnt,\n\t\tconst char *export_path)\n{\n\tstruct dentry *dentry;\n\tint err;\n\n\tif (IS_ERR(root_mnt))\n\t\treturn ERR_CAST(root_mnt);\n\n\terr = nfs_referral_loop_protect();\n\tif (err) {\n\t\tmntput(root_mnt);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tdentry = mount_subtree(root_mnt, export_path);\n\tnfs_referral_loop_unprotect();\n\n\treturn dentry;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_referral_loop_unprotect",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_referral_loop_unprotect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "200-213",
          "snippet": "static void nfs_referral_loop_unprotect(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tp->referral_count--;\n\tif (p->referral_count == 0)\n\t\tlist_del(&p->list);\n\telse\n\t\tp = NULL;\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(p);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_referral_count_list_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(nfs_referral_count_list_lock);\n\nstatic void nfs_referral_loop_unprotect(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tp->referral_count--;\n\tif (p->referral_count == 0)\n\t\tlist_del(&p->list);\n\telse\n\t\tp = NULL;\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount_subtree",
          "args": [
            "root_mnt",
            "export_path"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "mount_subtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2795-2822",
          "snippet": "struct dentry *mount_subtree(struct vfsmount *mnt, const char *name)\n{\n\tstruct mnt_namespace *ns;\n\tstruct super_block *s;\n\tstruct path path;\n\tint err;\n\n\tns = create_mnt_ns(mnt);\n\tif (IS_ERR(ns))\n\t\treturn ERR_CAST(ns);\n\n\terr = vfs_path_lookup(mnt->mnt_root, mnt,\n\t\t\tname, LOOKUP_FOLLOW|LOOKUP_AUTOMOUNT, &path);\n\n\tput_mnt_ns(ns);\n\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* trade a vfsmount reference for active sb one */\n\ts = path.mnt->mnt_sb;\n\tatomic_inc(&s->s_active);\n\tmntput(path.mnt);\n\t/* lock the sucker */\n\tdown_write(&s->s_umount);\n\t/* ... and return the root of (sub)tree on it */\n\treturn path.dentry;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void shrink_submounts(struct mount *mnt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic void shrink_submounts(struct mount *mnt);\n\nstruct dentry *mount_subtree(struct vfsmount *mnt, const char *name)\n{\n\tstruct mnt_namespace *ns;\n\tstruct super_block *s;\n\tstruct path path;\n\tint err;\n\n\tns = create_mnt_ns(mnt);\n\tif (IS_ERR(ns))\n\t\treturn ERR_CAST(ns);\n\n\terr = vfs_path_lookup(mnt->mnt_root, mnt,\n\t\t\tname, LOOKUP_FOLLOW|LOOKUP_AUTOMOUNT, &path);\n\n\tput_mnt_ns(ns);\n\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* trade a vfsmount reference for active sb one */\n\ts = path.mnt->mnt_sb;\n\tatomic_inc(&s->s_active);\n\tmntput(path.mnt);\n\t/* lock the sucker */\n\tdown_write(&s->s_umount);\n\t/* ... and return the root of (sub)tree on it */\n\treturn path.dentry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mntput",
          "args": [
            "root_mnt"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "mntput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "1118-1127",
          "snippet": "void mntput(struct vfsmount *mnt)\n{\n\tif (mnt) {\n\t\tstruct mount *m = real_mount(mnt);\n\t\t/* avoid cacheline pingpong, hope gcc doesn't get \"smart\" */\n\t\tif (unlikely(m->mnt_expiry_mark))\n\t\t\tm->mnt_expiry_mark = 0;\n\t\tmntput_no_expire(m);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void shrink_submounts(struct mount *mnt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic void shrink_submounts(struct mount *mnt);\n\nvoid mntput(struct vfsmount *mnt)\n{\n\tif (mnt) {\n\t\tstruct mount *m = real_mount(mnt);\n\t\t/* avoid cacheline pingpong, hope gcc doesn't get \"smart\" */\n\t\tif (unlikely(m->mnt_expiry_mark))\n\t\t\tm->mnt_expiry_mark = 0;\n\t\tmntput_no_expire(m);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_referral_loop_protect",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_referral_loop_protect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "171-198",
          "snippet": "static int nfs_referral_loop_protect(void)\n{\n\tstruct nfs_referral_count *p, *new;\n\tint ret = -ENOMEM;\n\n\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\tif (!new)\n\t\tgoto out;\n\tnew->task = current;\n\tnew->referral_count = 1;\n\n\tret = 0;\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tif (p != NULL) {\n\t\tif (p->referral_count >= NFS_MAX_NESTED_REFERRALS)\n\t\t\tret = -ELOOP;\n\t\telse\n\t\t\tp->referral_count++;\n\t} else {\n\t\tlist_add(&new->list, &nfs_referral_count_list);\n\t\tnew = NULL;\n\t}\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(new);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define NFS_MAX_NESTED_REFERRALS 2"
          ],
          "globals_used": [
            "static LIST_HEAD(nfs_referral_count_list);",
            "static DEFINE_SPINLOCK(nfs_referral_count_list_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\n#define NFS_MAX_NESTED_REFERRALS 2\n\nstatic LIST_HEAD(nfs_referral_count_list);\nstatic DEFINE_SPINLOCK(nfs_referral_count_list_lock);\n\nstatic int nfs_referral_loop_protect(void)\n{\n\tstruct nfs_referral_count *p, *new;\n\tint ret = -ENOMEM;\n\n\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\tif (!new)\n\t\tgoto out;\n\tnew->task = current;\n\tnew->referral_count = 1;\n\n\tret = 0;\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tif (p != NULL) {\n\t\tif (p->referral_count >= NFS_MAX_NESTED_REFERRALS)\n\t\t\tret = -ELOOP;\n\t\telse\n\t\t\tp->referral_count++;\n\t} else {\n\t\tlist_add(&new->list, &nfs_referral_count_list);\n\t\tnew = NULL;\n\t}\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(new);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "root_mnt"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "root_mnt"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct dentry *nfs_follow_remote_path(struct vfsmount *root_mnt,\n\t\tconst char *export_path)\n{\n\tstruct dentry *dentry;\n\tint err;\n\n\tif (IS_ERR(root_mnt))\n\t\treturn ERR_CAST(root_mnt);\n\n\terr = nfs_referral_loop_protect();\n\tif (err) {\n\t\tmntput(root_mnt);\n\t\treturn ERR_PTR(err);\n\t}\n\n\tdentry = mount_subtree(root_mnt, export_path);\n\tnfs_referral_loop_unprotect();\n\n\treturn dentry;\n}"
  },
  {
    "function_name": "nfs_referral_loop_unprotect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "200-213",
    "snippet": "static void nfs_referral_loop_unprotect(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tp->referral_count--;\n\tif (p->referral_count == 0)\n\t\tlist_del(&p->list);\n\telse\n\t\tp = NULL;\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(p);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(nfs_referral_count_list_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "p"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nfs_referral_count_list_lock"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&p->list"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_find_referral_count",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_find_referral_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "158-167",
          "snippet": "static struct nfs_referral_count *nfs_find_referral_count(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tlist_for_each_entry(p, &nfs_referral_count_list, list) {\n\t\tif (p->task == current)\n\t\t\treturn p;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(nfs_referral_count_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic LIST_HEAD(nfs_referral_count_list);\n\nstatic struct nfs_referral_count *nfs_find_referral_count(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tlist_for_each_entry(p, &nfs_referral_count_list, list) {\n\t\tif (p->task == current)\n\t\t\treturn p;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nfs_referral_count_list_lock"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(nfs_referral_count_list_lock);\n\nstatic void nfs_referral_loop_unprotect(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tp->referral_count--;\n\tif (p->referral_count == 0)\n\t\tlist_del(&p->list);\n\telse\n\t\tp = NULL;\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(p);\n}"
  },
  {
    "function_name": "nfs_referral_loop_protect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "171-198",
    "snippet": "static int nfs_referral_loop_protect(void)\n{\n\tstruct nfs_referral_count *p, *new;\n\tint ret = -ENOMEM;\n\n\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\tif (!new)\n\t\tgoto out;\n\tnew->task = current;\n\tnew->referral_count = 1;\n\n\tret = 0;\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tif (p != NULL) {\n\t\tif (p->referral_count >= NFS_MAX_NESTED_REFERRALS)\n\t\t\tret = -ELOOP;\n\t\telse\n\t\t\tp->referral_count++;\n\t} else {\n\t\tlist_add(&new->list, &nfs_referral_count_list);\n\t\tnew = NULL;\n\t}\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(new);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define NFS_MAX_NESTED_REFERRALS 2"
    ],
    "globals_used": [
      "static LIST_HEAD(nfs_referral_count_list);",
      "static DEFINE_SPINLOCK(nfs_referral_count_list_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nfs_referral_count_list_lock"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&new->list",
            "&nfs_referral_count_list"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_find_referral_count",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_find_referral_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
          "lines": "158-167",
          "snippet": "static struct nfs_referral_count *nfs_find_referral_count(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tlist_for_each_entry(p, &nfs_referral_count_list, list) {\n\t\tif (p->task == current)\n\t\t\treturn p;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(nfs_referral_count_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic LIST_HEAD(nfs_referral_count_list);\n\nstatic struct nfs_referral_count *nfs_find_referral_count(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tlist_for_each_entry(p, &nfs_referral_count_list, list) {\n\t\tif (p->task == current)\n\t\t\treturn p;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nfs_referral_count_list_lock"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*new)",
            "GFP_KERNEL"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\n#define NFS_MAX_NESTED_REFERRALS 2\n\nstatic LIST_HEAD(nfs_referral_count_list);\nstatic DEFINE_SPINLOCK(nfs_referral_count_list_lock);\n\nstatic int nfs_referral_loop_protect(void)\n{\n\tstruct nfs_referral_count *p, *new;\n\tint ret = -ENOMEM;\n\n\tnew = kmalloc(sizeof(*new), GFP_KERNEL);\n\tif (!new)\n\t\tgoto out;\n\tnew->task = current;\n\tnew->referral_count = 1;\n\n\tret = 0;\n\tspin_lock(&nfs_referral_count_list_lock);\n\tp = nfs_find_referral_count();\n\tif (p != NULL) {\n\t\tif (p->referral_count >= NFS_MAX_NESTED_REFERRALS)\n\t\t\tret = -ELOOP;\n\t\telse\n\t\t\tp->referral_count++;\n\t} else {\n\t\tlist_add(&new->list, &nfs_referral_count_list);\n\t\tnew = NULL;\n\t}\n\tspin_unlock(&nfs_referral_count_list_lock);\n\tkfree(new);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_find_referral_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "158-167",
    "snippet": "static struct nfs_referral_count *nfs_find_referral_count(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tlist_for_each_entry(p, &nfs_referral_count_list, list) {\n\t\tif (p->task == current)\n\t\t\treturn p;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(nfs_referral_count_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "p",
            "&nfs_referral_count_list",
            "list"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic LIST_HEAD(nfs_referral_count_list);\n\nstatic struct nfs_referral_count *nfs_find_referral_count(void)\n{\n\tstruct nfs_referral_count *p;\n\n\tlist_for_each_entry(p, &nfs_referral_count_list, list) {\n\t\tif (p->task == current)\n\t\t\treturn p;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs_do_root_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "128-147",
    "snippet": "static struct vfsmount *nfs_do_root_mount(struct file_system_type *fs_type,\n\t\tint flags, void *data, const char *hostname)\n{\n\tstruct vfsmount *root_mnt;\n\tchar *root_devname;\n\tsize_t len;\n\n\tlen = strlen(hostname) + 5;\n\troot_devname = kmalloc(len, GFP_KERNEL);\n\tif (root_devname == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\t/* Does hostname needs to be enclosed in brackets? */\n\tif (strchr(hostname, ':'))\n\t\tsnprintf(root_devname, len, \"[%s]:/\", hostname);\n\telse\n\t\tsnprintf(root_devname, len, \"%s:/\", hostname);\n\troot_mnt = vfs_kern_mount(fs_type, flags, root_devname, data);\n\tkfree(root_devname);\n\treturn root_mnt;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "root_devname"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfs_kern_mount",
          "args": [
            "fs_type",
            "flags",
            "root_devname",
            "data"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_kern_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "921-952",
          "snippet": "struct vfsmount *\nvfs_kern_mount(struct file_system_type *type, int flags, const char *name, void *data)\n{\n\tstruct mount *mnt;\n\tstruct dentry *root;\n\n\tif (!type)\n\t\treturn ERR_PTR(-ENODEV);\n\n\tmnt = alloc_vfsmnt(name);\n\tif (!mnt)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (flags & MS_KERNMOUNT)\n\t\tmnt->mnt.mnt_flags = MNT_INTERNAL;\n\n\troot = mount_fs(type, flags, name, data);\n\tif (IS_ERR(root)) {\n\t\tmnt_free_id(mnt);\n\t\tfree_vfsmnt(mnt);\n\t\treturn ERR_CAST(root);\n\t}\n\n\tmnt->mnt.mnt_root = root;\n\tmnt->mnt.mnt_sb = root->d_sb;\n\tmnt->mnt_mountpoint = mnt->mnt.mnt_root;\n\tmnt->mnt_parent = mnt;\n\tlock_mount_hash();\n\tlist_add_tail(&mnt->mnt_instance, &root->d_sb->s_mounts);\n\tunlock_mount_hash();\n\treturn &mnt->mnt;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void shrink_submounts(struct mount *mnt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic void shrink_submounts(struct mount *mnt);\n\nstruct vfsmount *\nvfs_kern_mount(struct file_system_type *type, int flags, const char *name, void *data)\n{\n\tstruct mount *mnt;\n\tstruct dentry *root;\n\n\tif (!type)\n\t\treturn ERR_PTR(-ENODEV);\n\n\tmnt = alloc_vfsmnt(name);\n\tif (!mnt)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (flags & MS_KERNMOUNT)\n\t\tmnt->mnt.mnt_flags = MNT_INTERNAL;\n\n\troot = mount_fs(type, flags, name, data);\n\tif (IS_ERR(root)) {\n\t\tmnt_free_id(mnt);\n\t\tfree_vfsmnt(mnt);\n\t\treturn ERR_CAST(root);\n\t}\n\n\tmnt->mnt.mnt_root = root;\n\tmnt->mnt.mnt_sb = root->d_sb;\n\tmnt->mnt_mountpoint = mnt->mnt.mnt_root;\n\tmnt->mnt_parent = mnt;\n\tlock_mount_hash();\n\tlist_add_tail(&mnt->mnt_instance, &root->d_sb->s_mounts);\n\tunlock_mount_hash();\n\treturn &mnt->mnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "root_devname",
            "len",
            "\"%s:/\"",
            "hostname"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "root_devname",
            "len",
            "\"[%s]:/\"",
            "hostname"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "hostname",
            "':'"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "len",
            "GFP_KERNEL"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "hostname"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic struct vfsmount *nfs_do_root_mount(struct file_system_type *fs_type,\n\t\tint flags, void *data, const char *hostname)\n{\n\tstruct vfsmount *root_mnt;\n\tchar *root_devname;\n\tsize_t len;\n\n\tlen = strlen(hostname) + 5;\n\troot_devname = kmalloc(len, GFP_KERNEL);\n\tif (root_devname == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\t/* Does hostname needs to be enclosed in brackets? */\n\tif (strchr(hostname, ':'))\n\t\tsnprintf(root_devname, len, \"[%s]:/\", hostname);\n\telse\n\t\tsnprintf(root_devname, len, \"%s:/\", hostname);\n\troot_mnt = vfs_kern_mount(fs_type, flags, root_devname, data);\n\tkfree(root_devname);\n\treturn root_mnt;\n}"
  },
  {
    "function_name": "nfs4_remote_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "105-126",
    "snippet": "static struct dentry *\nnfs4_remote_mount(struct file_system_type *fs_type, int flags,\n\t\t  const char *dev_name, void *info)\n{\n\tstruct nfs_mount_info *mount_info = info;\n\tstruct nfs_server *server;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\n\tmount_info->set_security = nfs_set_sb_security;\n\n\t/* Get a volume representation */\n\tserver = nfs4_create_server(mount_info, &nfs_v4);\n\tif (IS_ERR(server)) {\n\t\tmntroot = ERR_CAST(server);\n\t\tgoto out;\n\t}\n\n\tmntroot = nfs_fs_mount_common(server, flags, dev_name, mount_info, &nfs_v4);\n\nout:\n\treturn mntroot;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fs_mount_common",
          "args": [
            "server",
            "flags",
            "dev_name",
            "mount_info",
            "&nfs_v4"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_mount_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2535-2608",
          "snippet": "struct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "server"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_create_server",
          "args": [
            "mount_info",
            "&nfs_v4"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_create_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4client.c",
          "lines": "1036-1067",
          "snippet": "struct nfs_server *nfs4_create_server(struct nfs_mount_info *mount_info,\n\t\t\t\t      struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tauth_probe = mount_info->parsed->auth_info.flavor_len < 1;\n\n\t/* set up the general RPC client */\n\terror = nfs4_init_server(server, mount_info->parsed);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs4_server_common_setup(server, mount_info->mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs4_create_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"internal.h\"",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/xprt.h>",
            "#include <linux/sunrpc/auth.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"internal.h\"\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/xprt.h>\n#include <linux/sunrpc/auth.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs4_create_server(struct nfs_mount_info *mount_info,\n\t\t\t\t      struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\tbool auth_probe;\n\tint error;\n\n\tdprintk(\"--> nfs4_create_server()\\n\");\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tauth_probe = mount_info->parsed->auth_info.flavor_len < 1;\n\n\t/* set up the general RPC client */\n\terror = nfs4_init_server(server, mount_info->parsed);\n\tif (error < 0)\n\t\tgoto error;\n\n\terror = nfs4_server_common_setup(server, mount_info->mntfh, auth_probe);\n\tif (error < 0)\n\t\tgoto error;\n\n\tdprintk(\"<-- nfs4_create_server() = %p\\n\", server);\n\treturn server;\n\nerror:\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs4_create_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstruct nfs_subversion nfs_v4 = {\n\t.owner = THIS_MODULE,\n\t.nfs_fs   = &nfs4_fs_type,\n\t.rpc_vers = &nfs_version4,\n\t.rpc_ops  = &nfs_v4_clientops,\n\t.sops     = &nfs4_sops,\n\t.xattr    = nfs4_xattr_handlers,\n};\n\nstatic struct dentry *\nnfs4_remote_mount(struct file_system_type *fs_type, int flags,\n\t\t  const char *dev_name, void *info)\n{\n\tstruct nfs_mount_info *mount_info = info;\n\tstruct nfs_server *server;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\n\tmount_info->set_security = nfs_set_sb_security;\n\n\t/* Get a volume representation */\n\tserver = nfs4_create_server(mount_info, &nfs_v4);\n\tif (IS_ERR(server)) {\n\t\tmntroot = ERR_CAST(server);\n\t\tgoto out;\n\t}\n\n\tmntroot = nfs_fs_mount_common(server, flags, dev_name, mount_info, &nfs_v4);\n\nout:\n\treturn mntroot;\n}"
  },
  {
    "function_name": "nfs4_evict_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "90-100",
    "snippet": "static void nfs4_evict_inode(struct inode *inode)\n{\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\tpnfs_return_layout(inode);\n\tpnfs_destroy_layout(NFS_I(inode));\n\t/* If we are holding a delegation, return it! */\n\tnfs_inode_return_delegation_noreclaim(inode);\n\t/* First call standard NFS clear_inode() code */\n\tnfs_clear_inode(inode);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void nfs4_evict_inode(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_clear_inode",
          "args": [
            "inode"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_clear_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "116-126",
          "snippet": "void nfs_clear_inode(struct inode *inode)\n{\n\t/*\n\t * The following should never happen...\n\t */\n\tWARN_ON_ONCE(nfs_have_writebacks(inode));\n\tWARN_ON_ONCE(!list_empty(&NFS_I(inode)->open_files));\n\tnfs_zap_acl_cache(inode);\n\tnfs_access_zap_cache(inode);\n\tnfs_fscache_clear_inode(inode);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_clear_inode(struct inode *inode)\n{\n\t/*\n\t * The following should never happen...\n\t */\n\tWARN_ON_ONCE(nfs_have_writebacks(inode));\n\tWARN_ON_ONCE(!list_empty(&NFS_I(inode)->open_files));\n\tnfs_zap_acl_cache(inode);\n\tnfs_access_zap_cache(inode);\n\tnfs_fscache_clear_inode(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_return_delegation_noreclaim",
          "args": [
            "inode"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_return_delegation_noreclaim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "511-518",
          "snippet": "void nfs_inode_return_delegation_noreclaim(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_inode_detach_delegation(inode);\n\tif (delegation != NULL)\n\t\tnfs_do_return_delegation(inode, delegation, 0);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_inode_return_delegation_noreclaim(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_inode_detach_delegation(inode);\n\tif (delegation != NULL)\n\t\tnfs_do_return_delegation(inode, delegation, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pnfs_destroy_layout",
          "args": [
            "NFS_I(inode)"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "pnfs_destroy_layout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs.h",
          "lines": "535-537",
          "snippet": "static inline void pnfs_destroy_layout(struct nfs_inode *nfsi)\n{\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n\nstatic inline void pnfs_destroy_layout(struct nfs_inode *nfsi)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pnfs_return_layout",
          "args": [
            "inode"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "pnfs_return_layout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs.h",
          "lines": "549-552",
          "snippet": "static inline int pnfs_return_layout(struct inode *ino)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int pnfs_return_layout(struct inode *ino)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages_final",
          "args": [
            "&inode->i_data"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic void nfs4_evict_inode(struct inode *inode);\n\nstatic void nfs4_evict_inode(struct inode *inode)\n{\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\tpnfs_return_layout(inode);\n\tpnfs_destroy_layout(NFS_I(inode));\n\t/* If we are holding a delegation, return it! */\n\tnfs_inode_return_delegation_noreclaim(inode);\n\t/* First call standard NFS clear_inode() code */\n\tnfs_clear_inode(inode);\n}"
  },
  {
    "function_name": "nfs4_write_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4super.c",
    "lines": "75-83",
    "snippet": "static int nfs4_write_inode(struct inode *inode, struct writeback_control *wbc)\n{\n\tint ret = nfs_write_inode(inode, wbc);\n\n\tif (ret == 0)\n\t\tret = pnfs_layoutcommit_inode(inode,\n\t\t\t\twbc->sync_mode == WB_SYNC_ALL);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs4_write_inode(struct inode *inode, struct writeback_control *wbc);",
      "static void nfs4_evict_inode(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pnfs_layoutcommit_inode",
          "args": [
            "inode",
            "wbc->sync_mode == WB_SYNC_ALL"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "pnfs_layoutcommit_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs.h",
          "lines": "642-645",
          "snippet": "static inline int pnfs_layoutcommit_inode(struct inode *inode, bool sync)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n\nstatic inline int pnfs_layoutcommit_inode(struct inode *inode, bool sync)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_write_inode",
          "args": [
            "inode",
            "wbc"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_write_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1832-1835",
          "snippet": "int nfs_write_inode(struct inode *inode, struct writeback_control *wbc)\n{\n\treturn nfs_commit_unstable_pages(inode, wbc);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_write_inode(struct inode *inode, struct writeback_control *wbc)\n{\n\treturn nfs_commit_unstable_pages(inode, wbc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic int nfs4_write_inode(struct inode *inode, struct writeback_control *wbc);\nstatic void nfs4_evict_inode(struct inode *inode);\n\nstatic int nfs4_write_inode(struct inode *inode, struct writeback_control *wbc)\n{\n\tint ret = nfs_write_inode(inode, wbc);\n\n\tif (ret == 0)\n\t\tret = pnfs_layoutcommit_inode(inode,\n\t\t\t\twbc->sync_mode == WB_SYNC_ALL);\n\treturn ret;\n}"
  }
]