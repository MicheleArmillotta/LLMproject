[
  {
    "function_name": "befs_bread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/io.c",
    "lines": "63-85",
    "snippet": "struct buffer_head *\nbefs_bread(struct super_block *sb, befs_blocknr_t block)\n{\n\tstruct buffer_head *bh = NULL;\n\n\tbefs_debug(sb, \"---> Enter %s %lu\", __func__, (unsigned long)block);\n\n\tbh = sb_bread(sb, block);\n\n\tif (bh == NULL) {\n\t\tbefs_error(sb, \"Failed to read block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\n\treturn bh;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn NULL;\n}",
    "includes": [
      "#include \"io.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s ERROR\"",
            "__func__"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"Failed to read block %lu\"",
            "(unsigned long)block"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "sb",
            "block"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"io.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n\nstruct buffer_head *\nbefs_bread(struct super_block *sb, befs_blocknr_t block)\n{\n\tstruct buffer_head *bh = NULL;\n\n\tbefs_debug(sb, \"---> Enter %s %lu\", __func__, (unsigned long)block);\n\n\tbh = sb_bread(sb, block);\n\n\tif (bh == NULL) {\n\t\tbefs_error(sb, \"Failed to read block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\n\treturn bh;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn NULL;\n}"
  },
  {
    "function_name": "befs_bread_iaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/io.c",
    "lines": "26-61",
    "snippet": "struct buffer_head *\nbefs_bread_iaddr(struct super_block *sb, befs_inode_addr iaddr)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_blocknr_t block = 0;\n\tbefs_sb_info *befs_sb = BEFS_SB(sb);\n\n\tbefs_debug(sb, \"---> Enter %s \"\n\t\t   \"[%u, %hu, %hu]\", __func__, iaddr.allocation_group,\n\t\t   iaddr.start, iaddr.len);\n\n\tif (iaddr.allocation_group > befs_sb->num_ags) {\n\t\tbefs_error(sb, \"BEFS: Invalid allocation group %u, max is %u\",\n\t\t\t   iaddr.allocation_group, befs_sb->num_ags);\n\t\tgoto error;\n\t}\n\n\tblock = iaddr2blockno(sb, &iaddr);\n\n\tbefs_debug(sb, \"%s: offset = %lu\", __func__, (unsigned long)block);\n\n\tbh = sb_bread(sb, block);\n\n\tif (bh == NULL) {\n\t\tbefs_error(sb, \"Failed to read block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn bh;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn NULL;\n}",
    "includes": [
      "#include \"io.h\"",
      "#include \"befs.h\"",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "befs_debug",
          "args": [
            "sb",
            "\"<--- %s ERROR\"",
            "__func__"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "befs_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "53-67",
          "snippet": "void\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_debug(const struct super_block *sb, const char *fmt, ...)\n{\n#ifdef CONFIG_BEFS_DEBUG\n\n\tstruct va_format vaf;\n\tva_list args;\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_debug(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n\n#endif\t\t\t\t//CONFIG_BEFS_DEBUG\n}"
        }
      },
      {
        "call_info": {
          "callee": "befs_error",
          "args": [
            "sb",
            "\"Failed to read block %lu\"",
            "(unsigned long)block"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "befs_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/debug.c",
          "lines": "27-38",
          "snippet": "void\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}",
          "includes": [
            "#include \"befs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/string.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"befs.h\"\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/string.h>\n#include <stdarg.h>\n\nvoid\nbefs_error(const struct super_block *sb, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\tpr_err(\"(%s): %pV\\n\", sb->s_id, &vaf);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "sb",
            "block"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iaddr2blockno",
          "args": [
            "sb",
            "&iaddr"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "iaddr2blockno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/befs.h",
          "lines": "120-125",
          "snippet": "static inline befs_blocknr_t\niaddr2blockno(struct super_block *sb, befs_inode_addr * iaddr)\n{\n\treturn ((iaddr->allocation_group << BEFS_SB(sb)->ag_shift) +\n\t\tiaddr->start);\n}",
          "includes": [
            "#include \"endian.h\"",
            "#include \"befs_fs_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"befs_fs_types.h\"\n\nstatic inline befs_blocknr_t\niaddr2blockno(struct super_block *sb, befs_inode_addr * iaddr)\n{\n\treturn ((iaddr->allocation_group << BEFS_SB(sb)->ag_shift) +\n\t\tiaddr->start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BEFS_SB",
          "args": [
            "sb"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "BEFS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/befs/befs.h",
          "lines": "108-112",
          "snippet": "static inline befs_sb_info *\nBEFS_SB(const struct super_block *super)\n{\n\treturn (befs_sb_info *) super->s_fs_info;\n}",
          "includes": [
            "#include \"endian.h\"",
            "#include \"befs_fs_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"befs_fs_types.h\"\n\nstatic inline befs_sb_info *\nBEFS_SB(const struct super_block *super)\n{\n\treturn (befs_sb_info *) super->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"io.h\"\n#include \"befs.h\"\n#include <linux/buffer_head.h>\n\nstruct buffer_head *\nbefs_bread_iaddr(struct super_block *sb, befs_inode_addr iaddr)\n{\n\tstruct buffer_head *bh = NULL;\n\tbefs_blocknr_t block = 0;\n\tbefs_sb_info *befs_sb = BEFS_SB(sb);\n\n\tbefs_debug(sb, \"---> Enter %s \"\n\t\t   \"[%u, %hu, %hu]\", __func__, iaddr.allocation_group,\n\t\t   iaddr.start, iaddr.len);\n\n\tif (iaddr.allocation_group > befs_sb->num_ags) {\n\t\tbefs_error(sb, \"BEFS: Invalid allocation group %u, max is %u\",\n\t\t\t   iaddr.allocation_group, befs_sb->num_ags);\n\t\tgoto error;\n\t}\n\n\tblock = iaddr2blockno(sb, &iaddr);\n\n\tbefs_debug(sb, \"%s: offset = %lu\", __func__, (unsigned long)block);\n\n\tbh = sb_bread(sb, block);\n\n\tif (bh == NULL) {\n\t\tbefs_error(sb, \"Failed to read block %lu\",\n\t\t\t   (unsigned long)block);\n\t\tgoto error;\n\t}\n\n\tbefs_debug(sb, \"<--- %s\", __func__);\n\treturn bh;\n\n      error:\n\tbefs_debug(sb, \"<--- %s ERROR\", __func__);\n\treturn NULL;\n}"
  }
]