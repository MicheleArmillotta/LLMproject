[
  {
    "function_name": "ecryptfs_d_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/dentry.c",
    "lines": "80-87",
    "snippet": "static void ecryptfs_d_release(struct dentry *dentry)\n{\n\tstruct ecryptfs_dentry_info *p = dentry->d_fsdata;\n\tif (p) {\n\t\tpath_put(&p->lower_path);\n\t\tcall_rcu(&p->rcu, ecryptfs_dentry_free_rcu);\n\t}\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/slab.h>",
      "#include <linux/fs_stack.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/dcache.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_rcu",
          "args": [
            "&p->rcu",
            "ecryptfs_dentry_free_rcu"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&p->lower_path"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "path_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "489-493",
          "snippet": "void path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/slab.h>\n#include <linux/fs_stack.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n\nstatic void ecryptfs_d_release(struct dentry *dentry)\n{\n\tstruct ecryptfs_dentry_info *p = dentry->d_fsdata;\n\tif (p) {\n\t\tpath_put(&p->lower_path);\n\t\tcall_rcu(&p->rcu, ecryptfs_dentry_free_rcu);\n\t}\n}"
  },
  {
    "function_name": "ecryptfs_dentry_free_rcu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/dentry.c",
    "lines": "68-72",
    "snippet": "static void ecryptfs_dentry_free_rcu(struct rcu_head *head)\n{\n\tkmem_cache_free(ecryptfs_dentry_info_cache,\n\t\tcontainer_of(head, struct ecryptfs_dentry_info, rcu));\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/slab.h>",
      "#include <linux/fs_stack.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/dcache.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct kmem_cache *ecryptfs_dentry_info_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "ecryptfs_dentry_info_cache",
            "container_of(head, struct ecryptfs_dentry_info, rcu)"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "head",
            "structecryptfs_dentry_info",
            "rcu"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/slab.h>\n#include <linux/fs_stack.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n\nstruct kmem_cache *ecryptfs_dentry_info_cache;\n\nstatic void ecryptfs_dentry_free_rcu(struct rcu_head *head)\n{\n\tkmem_cache_free(ecryptfs_dentry_info_cache,\n\t\tcontainer_of(head, struct ecryptfs_dentry_info, rcu));\n}"
  },
  {
    "function_name": "ecryptfs_d_revalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/dentry.c",
    "lines": "45-64",
    "snippet": "static int ecryptfs_d_revalidate(struct dentry *dentry, unsigned int flags)\n{\n\tstruct dentry *lower_dentry = ecryptfs_dentry_to_lower(dentry);\n\tint rc;\n\n\tif (!(lower_dentry->d_flags & DCACHE_OP_REVALIDATE))\n\t\treturn 1;\n\n\tif (flags & LOOKUP_RCU)\n\t\treturn -ECHILD;\n\n\trc = lower_dentry->d_op->d_revalidate(lower_dentry, flags);\n\tif (dentry->d_inode) {\n\t\tstruct inode *lower_inode =\n\t\t\tecryptfs_inode_to_lower(dentry->d_inode);\n\n\t\tfsstack_copy_attr_all(dentry->d_inode, lower_inode);\n\t}\n\treturn rc;\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/slab.h>",
      "#include <linux/fs_stack.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/dcache.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fsstack_copy_attr_all",
          "args": [
            "dentry->d_inode",
            "lower_inode"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "fsstack_copy_attr_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stack.c",
          "lines": "63-75",
          "snippet": "void fsstack_copy_attr_all(struct inode *dest, const struct inode *src)\n{\n\tdest->i_mode = src->i_mode;\n\tdest->i_uid = src->i_uid;\n\tdest->i_gid = src->i_gid;\n\tdest->i_rdev = src->i_rdev;\n\tdest->i_atime = src->i_atime;\n\tdest->i_mtime = src->i_mtime;\n\tdest->i_ctime = src->i_ctime;\n\tdest->i_blkbits = src->i_blkbits;\n\tdest->i_flags = src->i_flags;\n\tset_nlink(dest, src->i_nlink);\n}",
          "includes": [
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nvoid fsstack_copy_attr_all(struct inode *dest, const struct inode *src)\n{\n\tdest->i_mode = src->i_mode;\n\tdest->i_uid = src->i_uid;\n\tdest->i_gid = src->i_gid;\n\tdest->i_rdev = src->i_rdev;\n\tdest->i_atime = src->i_atime;\n\tdest->i_mtime = src->i_mtime;\n\tdest->i_ctime = src->i_ctime;\n\tdest->i_blkbits = src->i_blkbits;\n\tdest->i_flags = src->i_flags;\n\tset_nlink(dest, src->i_nlink);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecryptfs_inode_to_lower",
          "args": [
            "dentry->d_inode"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_inode_to_lower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "462-465",
          "snippet": "static inline struct inode *ecryptfs_inode_to_lower(struct inode *inode)\n{\n\treturn ecryptfs_inode_to_private(inode)->wii_inode;\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct inode *ecryptfs_inode_to_lower(struct inode *inode)\n{\n\treturn ecryptfs_inode_to_private(inode)->wii_inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lower_dentry->d_op->d_revalidate",
          "args": [
            "lower_dentry",
            "flags"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "d_revalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "605-608",
          "snippet": "static inline int d_revalidate(struct dentry *dentry, unsigned int flags)\n{\n\treturn dentry->d_op->d_revalidate(dentry, flags);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic inline int d_revalidate(struct dentry *dentry, unsigned int flags)\n{\n\treturn dentry->d_op->d_revalidate(dentry, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecryptfs_dentry_to_lower",
          "args": [
            "dentry"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_dentry_to_lower_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "524-528",
          "snippet": "static inline struct path *\necryptfs_dentry_to_lower_path(struct dentry *dentry)\n{\n\treturn &((struct ecryptfs_dentry_info *)dentry->d_fsdata)->lower_path;\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct path *\necryptfs_dentry_to_lower_path(struct dentry *dentry)\n{\n\treturn &((struct ecryptfs_dentry_info *)dentry->d_fsdata)->lower_path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/slab.h>\n#include <linux/fs_stack.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n\nstatic int ecryptfs_d_revalidate(struct dentry *dentry, unsigned int flags)\n{\n\tstruct dentry *lower_dentry = ecryptfs_dentry_to_lower(dentry);\n\tint rc;\n\n\tif (!(lower_dentry->d_flags & DCACHE_OP_REVALIDATE))\n\t\treturn 1;\n\n\tif (flags & LOOKUP_RCU)\n\t\treturn -ECHILD;\n\n\trc = lower_dentry->d_op->d_revalidate(lower_dentry, flags);\n\tif (dentry->d_inode) {\n\t\tstruct inode *lower_inode =\n\t\t\tecryptfs_inode_to_lower(dentry->d_inode);\n\n\t\tfsstack_copy_attr_all(dentry->d_inode, lower_inode);\n\t}\n\treturn rc;\n}"
  }
]