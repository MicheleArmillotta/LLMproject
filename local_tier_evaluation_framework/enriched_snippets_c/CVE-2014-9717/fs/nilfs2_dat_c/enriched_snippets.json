[
  {
    "function_name": "nilfs_dat_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "479-529",
    "snippet": "int nilfs_dat_read(struct super_block *sb, size_t entry_size,\n\t\t   struct nilfs_inode *raw_inode, struct inode **inodep)\n{\n\tstatic struct lock_class_key dat_lock_key;\n\tstruct inode *dat;\n\tstruct nilfs_dat_info *di;\n\tint err;\n\n\tif (entry_size > sb->s_blocksize) {\n\t\tprintk(KERN_ERR\n\t\t       \"NILFS: too large DAT entry size: %zu bytes.\\n\",\n\t\t       entry_size);\n\t\treturn -EINVAL;\n\t} else if (entry_size < NILFS_MIN_DAT_ENTRY_SIZE) {\n\t\tprintk(KERN_ERR\n\t\t       \"NILFS: too small DAT entry size: %zu bytes.\\n\",\n\t\t       entry_size);\n\t\treturn -EINVAL;\n\t}\n\n\tdat = nilfs_iget_locked(sb, NULL, NILFS_DAT_INO);\n\tif (unlikely(!dat))\n\t\treturn -ENOMEM;\n\tif (!(dat->i_state & I_NEW))\n\t\tgoto out;\n\n\terr = nilfs_mdt_init(dat, NILFS_MDT_GFP, sizeof(*di));\n\tif (err)\n\t\tgoto failed;\n\n\terr = nilfs_palloc_init_blockgroup(dat, entry_size);\n\tif (err)\n\t\tgoto failed;\n\n\tdi = NILFS_DAT_I(dat);\n\tlockdep_set_class(&di->mi.mi_sem, &dat_lock_key);\n\tnilfs_palloc_setup_cache(dat, &di->palloc_cache);\n\tnilfs_mdt_setup_shadow_map(dat, &di->shadow);\n\n\terr = nilfs_read_inode_common(dat, raw_inode);\n\tif (err)\n\t\tgoto failed;\n\n\tunlock_new_inode(dat);\n out:\n\t*inodep = dat;\n\treturn 0;\n failed:\n\tiget_failed(dat);\n\treturn err;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iget_failed",
          "args": [
            "dat"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "iget_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/bad_inode.c",
          "lines": "208-213",
          "snippet": "void iget_failed(struct inode *inode)\n{\n\tmake_bad_inode(inode);\n\tunlock_new_inode(inode);\n\tiput(inode);\n}",
          "includes": [
            "#include <linux/poll.h>",
            "#include <linux/namei.h>",
            "#include <linux/time.h>",
            "#include <linux/stat.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/poll.h>\n#include <linux/namei.h>\n#include <linux/time.h>\n#include <linux/stat.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nvoid iget_failed(struct inode *inode)\n{\n\tmake_bad_inode(inode);\n\tunlock_new_inode(inode);\n\tiput(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_new_inode",
          "args": [
            "dat"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_new_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "924-933",
          "snippet": "void unlock_new_inode(struct inode *inode)\n{\n\tlockdep_annotate_inode_mutex_key(inode);\n\tspin_lock(&inode->i_lock);\n\tWARN_ON(!(inode->i_state & I_NEW));\n\tinode->i_state &= ~I_NEW;\n\tsmp_mb();\n\twake_up_bit(&inode->i_state, __I_NEW);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid unlock_new_inode(struct inode *inode)\n{\n\tlockdep_annotate_inode_mutex_key(inode);\n\tspin_lock(&inode->i_lock);\n\tWARN_ON(!(inode->i_state & I_NEW));\n\tinode->i_state &= ~I_NEW;\n\tsmp_mb();\n\twake_up_bit(&inode->i_state, __I_NEW);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_read_inode_common",
          "args": [
            "dat",
            "raw_inode"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_read_inode_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "463-502",
          "snippet": "int nilfs_read_inode_common(struct inode *inode,\n\t\t\t    struct nilfs_inode *raw_inode)\n{\n\tstruct nilfs_inode_info *ii = NILFS_I(inode);\n\tint err;\n\n\tinode->i_mode = le16_to_cpu(raw_inode->i_mode);\n\ti_uid_write(inode, le32_to_cpu(raw_inode->i_uid));\n\ti_gid_write(inode, le32_to_cpu(raw_inode->i_gid));\n\tset_nlink(inode, le16_to_cpu(raw_inode->i_links_count));\n\tinode->i_size = le64_to_cpu(raw_inode->i_size);\n\tinode->i_atime.tv_sec = le64_to_cpu(raw_inode->i_mtime);\n\tinode->i_ctime.tv_sec = le64_to_cpu(raw_inode->i_ctime);\n\tinode->i_mtime.tv_sec = le64_to_cpu(raw_inode->i_mtime);\n\tinode->i_atime.tv_nsec = le32_to_cpu(raw_inode->i_mtime_nsec);\n\tinode->i_ctime.tv_nsec = le32_to_cpu(raw_inode->i_ctime_nsec);\n\tinode->i_mtime.tv_nsec = le32_to_cpu(raw_inode->i_mtime_nsec);\n\tif (inode->i_nlink == 0)\n\t\treturn -ESTALE; /* this inode is deleted */\n\n\tinode->i_blocks = le64_to_cpu(raw_inode->i_blocks);\n\tii->i_flags = le32_to_cpu(raw_inode->i_flags);\n#if 0\n\tii->i_file_acl = le32_to_cpu(raw_inode->i_file_acl);\n\tii->i_dir_acl = S_ISREG(inode->i_mode) ?\n\t\t0 : le32_to_cpu(raw_inode->i_dir_acl);\n#endif\n\tii->i_dir_start_lookup = 0;\n\tinode->i_generation = le32_to_cpu(raw_inode->i_generation);\n\n\tif (S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode) ||\n\t    S_ISLNK(inode->i_mode)) {\n\t\terr = nilfs_bmap_read(ii->i_bmap, raw_inode);\n\t\tif (err < 0)\n\t\t\treturn err;\n\t\tset_bit(NILFS_I_BMAP, &ii->i_state);\n\t\t/* No lock is needed; iget() ensures it. */\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nint nilfs_read_inode_common(struct inode *inode,\n\t\t\t    struct nilfs_inode *raw_inode)\n{\n\tstruct nilfs_inode_info *ii = NILFS_I(inode);\n\tint err;\n\n\tinode->i_mode = le16_to_cpu(raw_inode->i_mode);\n\ti_uid_write(inode, le32_to_cpu(raw_inode->i_uid));\n\ti_gid_write(inode, le32_to_cpu(raw_inode->i_gid));\n\tset_nlink(inode, le16_to_cpu(raw_inode->i_links_count));\n\tinode->i_size = le64_to_cpu(raw_inode->i_size);\n\tinode->i_atime.tv_sec = le64_to_cpu(raw_inode->i_mtime);\n\tinode->i_ctime.tv_sec = le64_to_cpu(raw_inode->i_ctime);\n\tinode->i_mtime.tv_sec = le64_to_cpu(raw_inode->i_mtime);\n\tinode->i_atime.tv_nsec = le32_to_cpu(raw_inode->i_mtime_nsec);\n\tinode->i_ctime.tv_nsec = le32_to_cpu(raw_inode->i_ctime_nsec);\n\tinode->i_mtime.tv_nsec = le32_to_cpu(raw_inode->i_mtime_nsec);\n\tif (inode->i_nlink == 0)\n\t\treturn -ESTALE; /* this inode is deleted */\n\n\tinode->i_blocks = le64_to_cpu(raw_inode->i_blocks);\n\tii->i_flags = le32_to_cpu(raw_inode->i_flags);\n#if 0\n\tii->i_file_acl = le32_to_cpu(raw_inode->i_file_acl);\n\tii->i_dir_acl = S_ISREG(inode->i_mode) ?\n\t\t0 : le32_to_cpu(raw_inode->i_dir_acl);\n#endif\n\tii->i_dir_start_lookup = 0;\n\tinode->i_generation = le32_to_cpu(raw_inode->i_generation);\n\n\tif (S_ISREG(inode->i_mode) || S_ISDIR(inode->i_mode) ||\n\t    S_ISLNK(inode->i_mode)) {\n\t\terr = nilfs_bmap_read(ii->i_bmap, raw_inode);\n\t\tif (err < 0)\n\t\t\treturn err;\n\t\tset_bit(NILFS_I_BMAP, &ii->i_state);\n\t\t/* No lock is needed; iget() ensures it. */\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_setup_shadow_map",
          "args": [
            "dat",
            "&di->shadow"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_setup_shadow_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.c",
          "lines": "455-467",
          "snippet": "int nilfs_mdt_setup_shadow_map(struct inode *inode,\n\t\t\t       struct nilfs_shadow_map *shadow)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tINIT_LIST_HEAD(&shadow->frozen_buffers);\n\taddress_space_init_once(&shadow->frozen_data);\n\tnilfs_mapping_init(&shadow->frozen_data, inode);\n\taddress_space_init_once(&shadow->frozen_btnodes);\n\tnilfs_mapping_init(&shadow->frozen_btnodes, inode);\n\tmi->mi_shadow = shadow;\n\treturn 0;\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mm.h>",
            "#include <linux/mpage.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/mm.h>\n#include <linux/mpage.h>\n#include <linux/buffer_head.h>\n\nint nilfs_mdt_setup_shadow_map(struct inode *inode,\n\t\t\t       struct nilfs_shadow_map *shadow)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tINIT_LIST_HEAD(&shadow->frozen_buffers);\n\taddress_space_init_once(&shadow->frozen_data);\n\tnilfs_mapping_init(&shadow->frozen_data, inode);\n\taddress_space_init_once(&shadow->frozen_btnodes);\n\tnilfs_mapping_init(&shadow->frozen_btnodes, inode);\n\tmi->mi_shadow = shadow;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_setup_cache",
          "args": [
            "dat",
            "&di->palloc_cache"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_setup_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "759-764",
          "snippet": "void nilfs_palloc_setup_cache(struct inode *inode,\n\t\t\t      struct nilfs_palloc_cache *cache)\n{\n\tNILFS_MDT(inode)->mi_palloc_cache = cache;\n\tspin_lock_init(&cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_setup_cache(struct inode *inode,\n\t\t\t      struct nilfs_palloc_cache *cache)\n{\n\tNILFS_MDT(inode)->mi_palloc_cache = cache;\n\tspin_lock_init(&cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_set_class",
          "args": [
            "&di->mi.mi_sem",
            "&dat_lock_key"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_DAT_I",
          "args": [
            "dat"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_DAT_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "48-51",
          "snippet": "static inline struct nilfs_dat_info *NILFS_DAT_I(struct inode *dat)\n{\n\treturn (struct nilfs_dat_info *)NILFS_MDT(dat);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline struct nilfs_dat_info *NILFS_DAT_I(struct inode *dat)\n{\n\treturn (struct nilfs_dat_info *)NILFS_MDT(dat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_init_blockgroup",
          "args": [
            "dat",
            "entry_size"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_init_blockgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "61-84",
          "snippet": "int nilfs_palloc_init_blockgroup(struct inode *inode, unsigned entry_size)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tmi->mi_bgl = kmalloc(sizeof(*mi->mi_bgl), GFP_NOFS);\n\tif (!mi->mi_bgl)\n\t\treturn -ENOMEM;\n\n\tbgl_lock_init(mi->mi_bgl);\n\n\tnilfs_mdt_set_entry_size(inode, entry_size, 0);\n\n\tmi->mi_blocks_per_group =\n\t\tDIV_ROUND_UP(nilfs_palloc_entries_per_group(inode),\n\t\t\t     mi->mi_entries_per_block) + 1;\n\t\t/* Number of blocks in a group including entry blocks and\n\t\t   a bitmap block */\n\tmi->mi_blocks_per_desc_block =\n\t\tnilfs_palloc_groups_per_desc_block(inode) *\n\t\tmi->mi_blocks_per_group + 1;\n\t\t/* Number of blocks per descriptor including the\n\t\t   descriptor block */\n\treturn 0;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_init_blockgroup(struct inode *inode, unsigned entry_size)\n{\n\tstruct nilfs_mdt_info *mi = NILFS_MDT(inode);\n\n\tmi->mi_bgl = kmalloc(sizeof(*mi->mi_bgl), GFP_NOFS);\n\tif (!mi->mi_bgl)\n\t\treturn -ENOMEM;\n\n\tbgl_lock_init(mi->mi_bgl);\n\n\tnilfs_mdt_set_entry_size(inode, entry_size, 0);\n\n\tmi->mi_blocks_per_group =\n\t\tDIV_ROUND_UP(nilfs_palloc_entries_per_group(inode),\n\t\t\t     mi->mi_entries_per_block) + 1;\n\t\t/* Number of blocks in a group including entry blocks and\n\t\t   a bitmap block */\n\tmi->mi_blocks_per_desc_block =\n\t\tnilfs_palloc_groups_per_desc_block(inode) *\n\t\tmi->mi_blocks_per_group + 1;\n\t\t/* Number of blocks per descriptor including the\n\t\t   descriptor block */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_init",
          "args": [
            "dat",
            "NILFS_MDT_GFP",
            "sizeof(*di)"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.c",
          "lines": "419-438",
          "snippet": "int nilfs_mdt_init(struct inode *inode, gfp_t gfp_mask, size_t objsz)\n{\n\tstruct nilfs_mdt_info *mi;\n\n\tmi = kzalloc(max(sizeof(*mi), objsz), GFP_NOFS);\n\tif (!mi)\n\t\treturn -ENOMEM;\n\n\tinit_rwsem(&mi->mi_sem);\n\tinode->i_private = mi;\n\n\tinode->i_mode = S_IFREG;\n\tmapping_set_gfp_mask(inode->i_mapping, gfp_mask);\n\n\tinode->i_op = &def_mdt_iops;\n\tinode->i_fop = &def_mdt_fops;\n\tinode->i_mapping->a_ops = &def_mdt_aops;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mm.h>",
            "#include <linux/mpage.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct address_space_operations def_mdt_aops = {\n\t.writepage\t\t= nilfs_mdt_write_page,\n};",
            "static const struct inode_operations def_mdt_iops;",
            "static const struct file_operations def_mdt_fops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/mm.h>\n#include <linux/mpage.h>\n#include <linux/buffer_head.h>\n\nstatic const struct address_space_operations def_mdt_aops = {\n\t.writepage\t\t= nilfs_mdt_write_page,\n};\nstatic const struct inode_operations def_mdt_iops;\nstatic const struct file_operations def_mdt_fops;\n\nint nilfs_mdt_init(struct inode *inode, gfp_t gfp_mask, size_t objsz)\n{\n\tstruct nilfs_mdt_info *mi;\n\n\tmi = kzalloc(max(sizeof(*mi), objsz), GFP_NOFS);\n\tif (!mi)\n\t\treturn -ENOMEM;\n\n\tinit_rwsem(&mi->mi_sem);\n\tinode->i_private = mi;\n\n\tinode->i_mode = S_IFREG;\n\tmapping_set_gfp_mask(inode->i_mapping, gfp_mask);\n\n\tinode->i_op = &def_mdt_iops;\n\tinode->i_fop = &def_mdt_fops;\n\tinode->i_mapping->a_ops = &def_mdt_aops;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!dat"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_iget_locked",
          "args": [
            "sb",
            "NULL",
            "NILFS_DAT_INO"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_iget_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "598-606",
          "snippet": "struct inode *nilfs_iget_locked(struct super_block *sb, struct nilfs_root *root,\n\t\t\t\tunsigned long ino)\n{\n\tstruct nilfs_iget_args args = {\n\t\t.ino = ino, .root = root, .cno = 0, .for_gc = 0\n\t};\n\n\treturn iget5_locked(sb, ino, nilfs_iget_test, nilfs_iget_set, &args);\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nstruct inode *nilfs_iget_locked(struct super_block *sb, struct nilfs_root *root,\n\t\t\t\tunsigned long ino)\n{\n\tstruct nilfs_iget_args args = {\n\t\t.ino = ino, .root = root, .cno = 0, .for_gc = 0\n\t};\n\n\treturn iget5_locked(sb, ino, nilfs_iget_test, nilfs_iget_set, &args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t       \"NILFS: too small DAT entry size: %zu bytes.\\n\"",
            "entry_size"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_read(struct super_block *sb, size_t entry_size,\n\t\t   struct nilfs_inode *raw_inode, struct inode **inodep)\n{\n\tstatic struct lock_class_key dat_lock_key;\n\tstruct inode *dat;\n\tstruct nilfs_dat_info *di;\n\tint err;\n\n\tif (entry_size > sb->s_blocksize) {\n\t\tprintk(KERN_ERR\n\t\t       \"NILFS: too large DAT entry size: %zu bytes.\\n\",\n\t\t       entry_size);\n\t\treturn -EINVAL;\n\t} else if (entry_size < NILFS_MIN_DAT_ENTRY_SIZE) {\n\t\tprintk(KERN_ERR\n\t\t       \"NILFS: too small DAT entry size: %zu bytes.\\n\",\n\t\t       entry_size);\n\t\treturn -EINVAL;\n\t}\n\n\tdat = nilfs_iget_locked(sb, NULL, NILFS_DAT_INO);\n\tif (unlikely(!dat))\n\t\treturn -ENOMEM;\n\tif (!(dat->i_state & I_NEW))\n\t\tgoto out;\n\n\terr = nilfs_mdt_init(dat, NILFS_MDT_GFP, sizeof(*di));\n\tif (err)\n\t\tgoto failed;\n\n\terr = nilfs_palloc_init_blockgroup(dat, entry_size);\n\tif (err)\n\t\tgoto failed;\n\n\tdi = NILFS_DAT_I(dat);\n\tlockdep_set_class(&di->mi.mi_sem, &dat_lock_key);\n\tnilfs_palloc_setup_cache(dat, &di->palloc_cache);\n\tnilfs_mdt_setup_shadow_map(dat, &di->shadow);\n\n\terr = nilfs_read_inode_common(dat, raw_inode);\n\tif (err)\n\t\tgoto failed;\n\n\tunlock_new_inode(dat);\n out:\n\t*inodep = dat;\n\treturn 0;\n failed:\n\tiget_failed(dat);\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_dat_get_vinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "433-470",
    "snippet": "ssize_t nilfs_dat_get_vinfo(struct inode *dat, void *buf, unsigned visz,\n\t\t\t    size_t nvi)\n{\n\tstruct buffer_head *entry_bh;\n\tstruct nilfs_dat_entry *entry;\n\tstruct nilfs_vinfo *vinfo = buf;\n\t__u64 first, last;\n\tvoid *kaddr;\n\tunsigned long entries_per_block = NILFS_MDT(dat)->mi_entries_per_block;\n\tint i, j, n, ret;\n\n\tfor (i = 0; i < nvi; i += n) {\n\t\tret = nilfs_palloc_get_entry_block(dat, vinfo->vi_vblocknr,\n\t\t\t\t\t\t   0, &entry_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tkaddr = kmap_atomic(entry_bh->b_page);\n\t\t/* last virtual block number in this block */\n\t\tfirst = vinfo->vi_vblocknr;\n\t\tdo_div(first, entries_per_block);\n\t\tfirst *= entries_per_block;\n\t\tlast = first + entries_per_block - 1;\n\t\tfor (j = i, n = 0;\n\t\t     j < nvi && vinfo->vi_vblocknr >= first &&\n\t\t\t     vinfo->vi_vblocknr <= last;\n\t\t     j++, n++, vinfo = (void *)vinfo + visz) {\n\t\t\tentry = nilfs_palloc_block_get_entry(\n\t\t\t\tdat, vinfo->vi_vblocknr, entry_bh, kaddr);\n\t\t\tvinfo->vi_start = le64_to_cpu(entry->de_start);\n\t\t\tvinfo->vi_end = le64_to_cpu(entry->de_end);\n\t\t\tvinfo->vi_blocknr = le64_to_cpu(entry->de_blocknr);\n\t\t}\n\t\tkunmap_atomic(kaddr);\n\t\tbrelse(entry_bh);\n\t}\n\n\treturn nvi;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "entry_bh"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "entry->de_blocknr"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "vinfo->vi_vblocknr",
            "entry_bh",
            "kaddr"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "first",
            "entries_per_block"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "entry_bh->b_page"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_entry_block",
          "args": [
            "dat",
            "vinfo->vi_vblocknr",
            "0",
            "&entry_bh"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_entry_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "287-296",
          "snippet": "int nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "dat"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nssize_t nilfs_dat_get_vinfo(struct inode *dat, void *buf, unsigned visz,\n\t\t\t    size_t nvi)\n{\n\tstruct buffer_head *entry_bh;\n\tstruct nilfs_dat_entry *entry;\n\tstruct nilfs_vinfo *vinfo = buf;\n\t__u64 first, last;\n\tvoid *kaddr;\n\tunsigned long entries_per_block = NILFS_MDT(dat)->mi_entries_per_block;\n\tint i, j, n, ret;\n\n\tfor (i = 0; i < nvi; i += n) {\n\t\tret = nilfs_palloc_get_entry_block(dat, vinfo->vi_vblocknr,\n\t\t\t\t\t\t   0, &entry_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tkaddr = kmap_atomic(entry_bh->b_page);\n\t\t/* last virtual block number in this block */\n\t\tfirst = vinfo->vi_vblocknr;\n\t\tdo_div(first, entries_per_block);\n\t\tfirst *= entries_per_block;\n\t\tlast = first + entries_per_block - 1;\n\t\tfor (j = i, n = 0;\n\t\t     j < nvi && vinfo->vi_vblocknr >= first &&\n\t\t\t     vinfo->vi_vblocknr <= last;\n\t\t     j++, n++, vinfo = (void *)vinfo + visz) {\n\t\t\tentry = nilfs_palloc_block_get_entry(\n\t\t\t\tdat, vinfo->vi_vblocknr, entry_bh, kaddr);\n\t\t\tvinfo->vi_start = le64_to_cpu(entry->de_start);\n\t\t\tvinfo->vi_end = le64_to_cpu(entry->de_end);\n\t\t\tvinfo->vi_blocknr = le64_to_cpu(entry->de_blocknr);\n\t\t}\n\t\tkunmap_atomic(kaddr);\n\t\tbrelse(entry_bh);\n\t}\n\n\treturn nvi;\n}"
  },
  {
    "function_name": "nilfs_dat_translate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "397-431",
    "snippet": "int nilfs_dat_translate(struct inode *dat, __u64 vblocknr, sector_t *blocknrp)\n{\n\tstruct buffer_head *entry_bh, *bh;\n\tstruct nilfs_dat_entry *entry;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!nilfs_doing_gc() && buffer_nilfs_redirected(entry_bh)) {\n\t\tbh = nilfs_mdt_get_frozen_buffer(dat, entry_bh);\n\t\tif (bh) {\n\t\t\tWARN_ON(!buffer_uptodate(bh));\n\t\t\tbrelse(entry_bh);\n\t\t\tentry_bh = bh;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tif (blocknr == 0) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\t*blocknrp = blocknr;\n\n out:\n\tkunmap_atomic(kaddr);\n\tbrelse(entry_bh);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "entry_bh"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "entry->de_blocknr"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "vblocknr",
            "entry_bh",
            "kaddr"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "entry_bh->b_page"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!buffer_uptodate(bh)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_get_frozen_buffer",
          "args": [
            "dat",
            "entry_bh"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_get_frozen_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.c",
          "lines": "525-543",
          "snippet": "struct buffer_head *\nnilfs_mdt_get_frozen_buffer(struct inode *inode, struct buffer_head *bh)\n{\n\tstruct nilfs_shadow_map *shadow = NILFS_MDT(inode)->mi_shadow;\n\tstruct buffer_head *bh_frozen = NULL;\n\tstruct page *page;\n\tint n;\n\n\tpage = find_lock_page(&shadow->frozen_data, bh->b_page->index);\n\tif (page) {\n\t\tif (page_has_buffers(page)) {\n\t\t\tn = bh_offset(bh) >> inode->i_blkbits;\n\t\t\tbh_frozen = nilfs_page_get_nth_block(page, n);\n\t\t}\n\t\tunlock_page(page);\n\t\tpage_cache_release(page);\n\t}\n\treturn bh_frozen;\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mm.h>",
            "#include <linux/mpage.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/mm.h>\n#include <linux/mpage.h>\n#include <linux/buffer_head.h>\n\nstruct buffer_head *\nnilfs_mdt_get_frozen_buffer(struct inode *inode, struct buffer_head *bh)\n{\n\tstruct nilfs_shadow_map *shadow = NILFS_MDT(inode)->mi_shadow;\n\tstruct buffer_head *bh_frozen = NULL;\n\tstruct page *page;\n\tint n;\n\n\tpage = find_lock_page(&shadow->frozen_data, bh->b_page->index);\n\tif (page) {\n\t\tif (page_has_buffers(page)) {\n\t\t\tn = bh_offset(bh) >> inode->i_blkbits;\n\t\t\tbh_frozen = nilfs_page_get_nth_block(page, n);\n\t\t}\n\t\tunlock_page(page);\n\t\tpage_cache_release(page);\n\t}\n\treturn bh_frozen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_redirected",
          "args": [
            "entry_bh"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_doing_gc",
          "args": [],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_doing_gc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "187-190",
          "snippet": "static inline int nilfs_doing_gc(void)\n{\n\treturn nilfs_test_transaction_flag(NILFS_TI_GC);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define NILFS_TI_GC\t\t0x0004\t/* GC context */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\n#define NILFS_TI_GC\t\t0x0004\t/* GC context */\n\nstatic inline int nilfs_doing_gc(void)\n{\n\treturn nilfs_test_transaction_flag(NILFS_TI_GC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_entry_block",
          "args": [
            "dat",
            "vblocknr",
            "0",
            "&entry_bh"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_entry_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "287-296",
          "snippet": "int nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_translate(struct inode *dat, __u64 vblocknr, sector_t *blocknrp)\n{\n\tstruct buffer_head *entry_bh, *bh;\n\tstruct nilfs_dat_entry *entry;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!nilfs_doing_gc() && buffer_nilfs_redirected(entry_bh)) {\n\t\tbh = nilfs_mdt_get_frozen_buffer(dat, entry_bh);\n\t\tif (bh) {\n\t\t\tWARN_ON(!buffer_uptodate(bh));\n\t\t\tbrelse(entry_bh);\n\t\t\tentry_bh = bh;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tif (blocknr == 0) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\t*blocknrp = blocknr;\n\n out:\n\tkunmap_atomic(kaddr);\n\tbrelse(entry_bh);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_dat_move",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "328-376",
    "snippet": "int nilfs_dat_move(struct inode *dat, __u64 vblocknr, sector_t blocknr)\n{\n\tstruct buffer_head *entry_bh;\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t/*\n\t * The given disk block number (blocknr) is not yet written to\n\t * the device at this point.\n\t *\n\t * To prevent nilfs_dat_translate() from returning the\n\t * uncommitted block number, this makes a copy of the entry\n\t * buffer and redirects nilfs_dat_translate() to the copy.\n\t */\n\tif (!buffer_nilfs_redirected(entry_bh)) {\n\t\tret = nilfs_mdt_freeze_buffer(dat, entry_bh);\n\t\tif (ret) {\n\t\t\tbrelse(entry_bh);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tif (unlikely(entry->de_blocknr == cpu_to_le64(0))) {\n\t\tprintk(KERN_CRIT \"%s: vbn = %llu, [%llu, %llu)\\n\", __func__,\n\t\t       (unsigned long long)vblocknr,\n\t\t       (unsigned long long)le64_to_cpu(entry->de_start),\n\t\t       (unsigned long long)le64_to_cpu(entry->de_end));\n\t\tkunmap_atomic(kaddr);\n\t\tbrelse(entry_bh);\n\t\treturn -EINVAL;\n\t}\n\tWARN_ON(blocknr == 0);\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tmark_buffer_dirty(entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\n\tbrelse(entry_bh);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "entry_bh"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_mark_dirty",
          "args": [
            "dat"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "98-102",
          "snippet": "static inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "entry_bh"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "blocknr"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "blocknr == 0"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"%s: vbn = %llu, [%llu, %llu)\\n\"",
            "__func__",
            "(unsigned long long)vblocknr",
            "(unsigned long long)le64_to_cpu(entry->de_start)",
            "(unsigned long long)le64_to_cpu(entry->de_end)"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "entry->de_end"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "entry->de_blocknr == cpu_to_le64(0)"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "0"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "vblocknr",
            "entry_bh",
            "kaddr"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "entry_bh->b_page"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_freeze_buffer",
          "args": [
            "dat",
            "entry_bh"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_freeze_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.c",
          "lines": "494-523",
          "snippet": "int nilfs_mdt_freeze_buffer(struct inode *inode, struct buffer_head *bh)\n{\n\tstruct nilfs_shadow_map *shadow = NILFS_MDT(inode)->mi_shadow;\n\tstruct buffer_head *bh_frozen;\n\tstruct page *page;\n\tint blkbits = inode->i_blkbits;\n\n\tpage = grab_cache_page(&shadow->frozen_data, bh->b_page->index);\n\tif (!page)\n\t\treturn -ENOMEM;\n\n\tif (!page_has_buffers(page))\n\t\tcreate_empty_buffers(page, 1 << blkbits, 0);\n\n\tbh_frozen = nilfs_page_get_nth_block(page, bh_offset(bh) >> blkbits);\n\n\tif (!buffer_uptodate(bh_frozen))\n\t\tnilfs_copy_buffer(bh_frozen, bh);\n\tif (list_empty(&bh_frozen->b_assoc_buffers)) {\n\t\tlist_add_tail(&bh_frozen->b_assoc_buffers,\n\t\t\t      &shadow->frozen_buffers);\n\t\tset_buffer_nilfs_redirected(bh);\n\t} else {\n\t\tbrelse(bh_frozen); /* already frozen */\n\t}\n\n\tunlock_page(page);\n\tpage_cache_release(page);\n\treturn 0;\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/mm.h>",
            "#include <linux/mpage.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/mm.h>\n#include <linux/mpage.h>\n#include <linux/buffer_head.h>\n\nint nilfs_mdt_freeze_buffer(struct inode *inode, struct buffer_head *bh)\n{\n\tstruct nilfs_shadow_map *shadow = NILFS_MDT(inode)->mi_shadow;\n\tstruct buffer_head *bh_frozen;\n\tstruct page *page;\n\tint blkbits = inode->i_blkbits;\n\n\tpage = grab_cache_page(&shadow->frozen_data, bh->b_page->index);\n\tif (!page)\n\t\treturn -ENOMEM;\n\n\tif (!page_has_buffers(page))\n\t\tcreate_empty_buffers(page, 1 << blkbits, 0);\n\n\tbh_frozen = nilfs_page_get_nth_block(page, bh_offset(bh) >> blkbits);\n\n\tif (!buffer_uptodate(bh_frozen))\n\t\tnilfs_copy_buffer(bh_frozen, bh);\n\tif (list_empty(&bh_frozen->b_assoc_buffers)) {\n\t\tlist_add_tail(&bh_frozen->b_assoc_buffers,\n\t\t\t      &shadow->frozen_buffers);\n\t\tset_buffer_nilfs_redirected(bh);\n\t} else {\n\t\tbrelse(bh_frozen); /* already frozen */\n\t}\n\n\tunlock_page(page);\n\tpage_cache_release(page);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_redirected",
          "args": [
            "entry_bh"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_get_entry_block",
          "args": [
            "dat",
            "vblocknr",
            "0",
            "&entry_bh"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_entry_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "287-296",
          "snippet": "int nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_move(struct inode *dat, __u64 vblocknr, sector_t blocknr)\n{\n\tstruct buffer_head *entry_bh;\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t/*\n\t * The given disk block number (blocknr) is not yet written to\n\t * the device at this point.\n\t *\n\t * To prevent nilfs_dat_translate() from returning the\n\t * uncommitted block number, this makes a copy of the entry\n\t * buffer and redirects nilfs_dat_translate() to the copy.\n\t */\n\tif (!buffer_nilfs_redirected(entry_bh)) {\n\t\tret = nilfs_mdt_freeze_buffer(dat, entry_bh);\n\t\tif (ret) {\n\t\t\tbrelse(entry_bh);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tif (unlikely(entry->de_blocknr == cpu_to_le64(0))) {\n\t\tprintk(KERN_CRIT \"%s: vbn = %llu, [%llu, %llu)\\n\", __func__,\n\t\t       (unsigned long long)vblocknr,\n\t\t       (unsigned long long)le64_to_cpu(entry->de_start),\n\t\t       (unsigned long long)le64_to_cpu(entry->de_end));\n\t\tkunmap_atomic(kaddr);\n\t\tbrelse(entry_bh);\n\t\treturn -EINVAL;\n\t}\n\tWARN_ON(blocknr == 0);\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tmark_buffer_dirty(entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\n\tbrelse(entry_bh);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_dat_freev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "307-310",
    "snippet": "int nilfs_dat_freev(struct inode *dat, __u64 *vblocknrs, size_t nitems)\n{\n\treturn nilfs_palloc_freev(dat, vblocknrs, nitems);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_freev",
          "args": [
            "dat",
            "vblocknrs",
            "nitems"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_freev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "703-757",
          "snippet": "int nilfs_palloc_freev(struct inode *inode, __u64 *entry_nrs, size_t nitems)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, group_offset;\n\tint i, j, n, ret;\n\n\tfor (i = 0; i < nitems; i = j) {\n\t\tgroup = nilfs_palloc_group(inode, entry_nrs[i], &group_offset);\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 0, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tret = nilfs_palloc_get_bitmap_block(inode, group, 0,\n\t\t\t\t\t\t    &bitmap_bh);\n\t\tif (ret < 0) {\n\t\t\tbrelse(desc_bh);\n\t\t\treturn ret;\n\t\t}\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\tfor (j = i, n = 0;\n\t\t     (j < nitems) && nilfs_palloc_group_is_in(inode, group,\n\t\t\t\t\t\t\t      entry_nrs[j]);\n\t\t     j++) {\n\t\t\tnilfs_palloc_group(inode, entry_nrs[j], &group_offset);\n\t\t\tif (!nilfs_clear_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap)) {\n\t\t\t\tprintk(KERN_WARNING\n\t\t\t\t       \"%s: entry number %llu already freed\\n\",\n\t\t\t\t       __func__,\n\t\t\t\t       (unsigned long long)entry_nrs[j]);\n\t\t\t} else {\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, n);\n\n\t\tkunmap(bitmap_bh->b_page);\n\t\tkunmap(desc_bh->b_page);\n\n\t\tmark_buffer_dirty(desc_bh);\n\t\tmark_buffer_dirty(bitmap_bh);\n\t\tnilfs_mdt_mark_dirty(inode);\n\n\t\tbrelse(bitmap_bh);\n\t\tbrelse(desc_bh);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_freev(struct inode *inode, __u64 *entry_nrs, size_t nitems)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, group_offset;\n\tint i, j, n, ret;\n\n\tfor (i = 0; i < nitems; i = j) {\n\t\tgroup = nilfs_palloc_group(inode, entry_nrs[i], &group_offset);\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 0, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tret = nilfs_palloc_get_bitmap_block(inode, group, 0,\n\t\t\t\t\t\t    &bitmap_bh);\n\t\tif (ret < 0) {\n\t\t\tbrelse(desc_bh);\n\t\t\treturn ret;\n\t\t}\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\tfor (j = i, n = 0;\n\t\t     (j < nitems) && nilfs_palloc_group_is_in(inode, group,\n\t\t\t\t\t\t\t      entry_nrs[j]);\n\t\t     j++) {\n\t\t\tnilfs_palloc_group(inode, entry_nrs[j], &group_offset);\n\t\t\tif (!nilfs_clear_bit_atomic(\n\t\t\t\t    nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap)) {\n\t\t\t\tprintk(KERN_WARNING\n\t\t\t\t       \"%s: entry number %llu already freed\\n\",\n\t\t\t\t       __func__,\n\t\t\t\t       (unsigned long long)entry_nrs[j]);\n\t\t\t} else {\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, n);\n\n\t\tkunmap(bitmap_bh->b_page);\n\t\tkunmap(desc_bh->b_page);\n\n\t\tmark_buffer_dirty(desc_bh);\n\t\tmark_buffer_dirty(bitmap_bh);\n\t\tnilfs_mdt_mark_dirty(inode);\n\n\t\tbrelse(bitmap_bh);\n\t\tbrelse(desc_bh);\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_freev(struct inode *dat, __u64 *vblocknrs, size_t nitems)\n{\n\treturn nilfs_palloc_freev(dat, vblocknrs, nitems);\n}"
  },
  {
    "function_name": "nilfs_dat_mark_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "277-287",
    "snippet": "int nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_entry",
          "args": [
            "dat",
            "&req"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "60-66",
          "snippet": "static void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_entry",
          "args": [
            "dat",
            "&req",
            "0"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "53-58",
          "snippet": "static int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_dat_abort_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "255-261",
    "snippet": "void nilfs_dat_abort_update(struct inode *dat,\n\t\t\t    struct nilfs_palloc_req *oldreq,\n\t\t\t    struct nilfs_palloc_req *newreq)\n{\n\tnilfs_dat_abort_end(dat, oldreq);\n\tnilfs_dat_abort_alloc(dat, newreq);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_alloc",
          "args": [
            "dat",
            "newreq"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "106-110",
          "snippet": "void nilfs_dat_abort_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tnilfs_dat_abort_entry(dat, req);\n\tnilfs_palloc_abort_alloc_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tnilfs_dat_abort_entry(dat, req);\n\tnilfs_palloc_abort_alloc_entry(dat, req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_abort_end",
          "args": [
            "dat",
            "oldreq"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "213-230",
          "snippet": "void nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_update(struct inode *dat,\n\t\t\t    struct nilfs_palloc_req *oldreq,\n\t\t\t    struct nilfs_palloc_req *newreq)\n{\n\tnilfs_dat_abort_end(dat, oldreq);\n\tnilfs_dat_abort_alloc(dat, newreq);\n}"
  },
  {
    "function_name": "nilfs_dat_commit_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "247-253",
    "snippet": "void nilfs_dat_commit_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq, int dead)\n{\n\tnilfs_dat_commit_end(dat, oldreq, dead);\n\tnilfs_dat_commit_alloc(dat, newreq);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_alloc",
          "args": [
            "dat",
            "newreq"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "89-104",
          "snippet": "void nilfs_dat_commit_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MAX);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_palloc_commit_alloc_entry(dat, req);\n\tnilfs_dat_commit_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_CNO_MAX\t(~(__u64)0)",
            "#define NILFS_CNO_MIN\t((__u64)1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\n#define NILFS_CNO_MAX\t(~(__u64)0)\n#define NILFS_CNO_MIN\t((__u64)1)\n\nvoid nilfs_dat_commit_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MAX);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_palloc_commit_alloc_entry(dat, req);\n\tnilfs_dat_commit_entry(dat, req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_end",
          "args": [
            "dat",
            "oldreq",
            "dead"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "187-211",
          "snippet": "void nilfs_dat_commit_end(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t  int dead)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start, end;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tend = start = le64_to_cpu(entry->de_start);\n\tif (!dead) {\n\t\tend = nilfs_mdt_cno(dat);\n\t\tWARN_ON(start > end);\n\t}\n\tentry->de_end = cpu_to_le64(end);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0)\n\t\tnilfs_dat_commit_free(dat, req);\n\telse\n\t\tnilfs_dat_commit_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_end(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t  int dead)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start, end;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tend = start = le64_to_cpu(entry->de_start);\n\tif (!dead) {\n\t\tend = nilfs_mdt_cno(dat);\n\t\tWARN_ON(start > end);\n\t}\n\tentry->de_end = cpu_to_le64(end);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0)\n\t\tnilfs_dat_commit_free(dat, req);\n\telse\n\t\tnilfs_dat_commit_entry(dat, req);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq, int dead)\n{\n\tnilfs_dat_commit_end(dat, oldreq, dead);\n\tnilfs_dat_commit_alloc(dat, newreq);\n}"
  },
  {
    "function_name": "nilfs_dat_prepare_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "232-245",
    "snippet": "int nilfs_dat_prepare_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_end(dat, oldreq);\n\tif (!ret) {\n\t\tret = nilfs_dat_prepare_alloc(dat, newreq);\n\t\tif (ret < 0)\n\t\t\tnilfs_dat_abort_end(dat, oldreq);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_end",
          "args": [
            "dat",
            "oldreq"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "213-230",
          "snippet": "void nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_alloc",
          "args": [
            "dat",
            "newreq"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "74-87",
          "snippet": "int nilfs_dat_prepare_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_palloc_prepare_alloc_entry(dat, req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 1);\n\tif (ret < 0)\n\t\tnilfs_palloc_abort_alloc_entry(dat, req);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_palloc_prepare_alloc_entry(dat, req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 1);\n\tif (ret < 0)\n\t\tnilfs_palloc_abort_alloc_entry(dat, req);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_end",
          "args": [
            "dat",
            "oldreq"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "155-185",
          "snippet": "int nilfs_dat_prepare_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\treturn ret;\n\t}\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0) {\n\t\tret = nilfs_palloc_prepare_free_entry(dat, req);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_entry(dat, req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\treturn ret;\n\t}\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0) {\n\t\tret = nilfs_palloc_prepare_free_entry(dat, req);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_entry(dat, req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_end(dat, oldreq);\n\tif (!ret) {\n\t\tret = nilfs_dat_prepare_alloc(dat, newreq);\n\t\tif (ret < 0)\n\t\t\tnilfs_dat_abort_end(dat, oldreq);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_dat_abort_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "213-230",
    "snippet": "void nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "68-72",
          "snippet": "static void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_abort_free_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_abort_free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "670-679",
          "snippet": "void nilfs_palloc_abort_free_entry(struct inode *inode,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_abort_free_entry(struct inode *inode,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_cno",
          "args": [
            "dat"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_cno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "109-112",
          "snippet": "static inline __u64 nilfs_mdt_cno(struct inode *inode)\n{\n\treturn ((struct the_nilfs *)inode->i_sb->s_fs_info)->ns_cno;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline __u64 nilfs_mdt_cno(struct inode *inode)\n{\n\treturn ((struct the_nilfs *)inode->i_sb->s_fs_info)->ns_cno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "entry->de_blocknr"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "req->pr_entry_bh",
            "kaddr"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "req->pr_entry_bh->b_page"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}"
  },
  {
    "function_name": "nilfs_dat_commit_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "187-211",
    "snippet": "void nilfs_dat_commit_end(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t  int dead)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start, end;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tend = start = le64_to_cpu(entry->de_start);\n\tif (!dead) {\n\t\tend = nilfs_mdt_cno(dat);\n\t\tWARN_ON(start > end);\n\t}\n\tentry->de_end = cpu_to_le64(end);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0)\n\t\tnilfs_dat_commit_free(dat, req);\n\telse\n\t\tnilfs_dat_commit_entry(dat, req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "60-66",
          "snippet": "static void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_free",
          "args": [
            "dat",
            "req"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "112-128",
          "snippet": "static void nilfs_dat_commit_free(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n\tnilfs_palloc_commit_free_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_CNO_MIN\t((__u64)1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\n#define NILFS_CNO_MIN\t((__u64)1)\n\nstatic void nilfs_dat_commit_free(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n\tnilfs_palloc_commit_free_entry(dat, req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "entry->de_blocknr"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "end"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "start > end"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_cno",
          "args": [
            "dat"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_cno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "109-112",
          "snippet": "static inline __u64 nilfs_mdt_cno(struct inode *inode)\n{\n\treturn ((struct the_nilfs *)inode->i_sb->s_fs_info)->ns_cno;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline __u64 nilfs_mdt_cno(struct inode *inode)\n{\n\treturn ((struct the_nilfs *)inode->i_sb->s_fs_info)->ns_cno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "req->pr_entry_bh",
            "kaddr"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "req->pr_entry_bh->b_page"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_end(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t  int dead)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start, end;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tend = start = le64_to_cpu(entry->de_start);\n\tif (!dead) {\n\t\tend = nilfs_mdt_cno(dat);\n\t\tWARN_ON(start > end);\n\t}\n\tentry->de_end = cpu_to_le64(end);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0)\n\t\tnilfs_dat_commit_free(dat, req);\n\telse\n\t\tnilfs_dat_commit_entry(dat, req);\n}"
  },
  {
    "function_name": "nilfs_dat_prepare_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "155-185",
    "snippet": "int nilfs_dat_prepare_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\treturn ret;\n\t}\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0) {\n\t\tret = nilfs_palloc_prepare_free_entry(dat, req);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_entry(dat, req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "68-72",
          "snippet": "static void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_prepare_free_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_prepare_free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "643-663",
          "snippet": "int nilfs_palloc_prepare_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tunsigned long group, group_offset;\n\tint ret;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\tret = nilfs_palloc_get_bitmap_block(inode, group, 1, &bitmap_bh);\n\tif (ret < 0) {\n\t\tbrelse(desc_bh);\n\t\treturn ret;\n\t}\n\n\treq->pr_desc_bh = desc_bh;\n\treq->pr_bitmap_bh = bitmap_bh;\n\treturn 0;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_prepare_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tunsigned long group, group_offset;\n\tint ret;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\tret = nilfs_palloc_get_bitmap_block(inode, group, 1, &bitmap_bh);\n\tif (ret < 0) {\n\t\tbrelse(desc_bh);\n\t\treturn ret;\n\t}\n\n\treq->pr_desc_bh = desc_bh;\n\treq->pr_bitmap_bh = bitmap_bh;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "entry->de_blocknr"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "req->pr_entry_bh",
            "kaddr"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "req->pr_entry_bh->b_page"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret == -ENOENT"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_entry",
          "args": [
            "dat",
            "req",
            "0"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "53-58",
          "snippet": "static int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\treturn ret;\n\t}\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0) {\n\t\tret = nilfs_palloc_prepare_free_entry(dat, req);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_entry(dat, req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_dat_commit_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "139-153",
    "snippet": "void nilfs_dat_commit_start(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t    sector_t blocknr)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(nilfs_mdt_cno(dat));\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "60-66",
          "snippet": "static void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "blocknr"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "nilfs_mdt_cno(dat)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_cno",
          "args": [
            "dat"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_cno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "109-112",
          "snippet": "static inline __u64 nilfs_mdt_cno(struct inode *inode)\n{\n\treturn ((struct the_nilfs *)inode->i_sb->s_fs_info)->ns_cno;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline __u64 nilfs_mdt_cno(struct inode *inode)\n{\n\treturn ((struct the_nilfs *)inode->i_sb->s_fs_info)->ns_cno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "req->pr_entry_bh",
            "kaddr"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "req->pr_entry_bh->b_page"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_start(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t    sector_t blocknr)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(nilfs_mdt_cno(dat));\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n}"
  },
  {
    "function_name": "nilfs_dat_prepare_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "130-137",
    "snippet": "int nilfs_dat_prepare_start(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tWARN_ON(ret == -ENOENT);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret == -ENOENT"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_entry",
          "args": [
            "dat",
            "req",
            "0"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "53-58",
          "snippet": "static int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_start(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tWARN_ON(ret == -ENOENT);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_dat_commit_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "112-128",
    "snippet": "static void nilfs_dat_commit_free(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n\tnilfs_palloc_commit_free_entry(dat, req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NILFS_CNO_MIN\t((__u64)1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_commit_free_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_commit_free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "568-599",
          "snippet": "void nilfs_palloc_commit_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned long group, group_offset;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_commit_free_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned long group, group_offset;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "60-66",
          "snippet": "static void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "0"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "NILFS_CNO_MIN"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "NILFS_CNO_MIN"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "req->pr_entry_bh",
            "kaddr"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "req->pr_entry_bh->b_page"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\n#define NILFS_CNO_MIN\t((__u64)1)\n\nstatic void nilfs_dat_commit_free(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n\tnilfs_palloc_commit_free_entry(dat, req);\n}"
  },
  {
    "function_name": "nilfs_dat_abort_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "106-110",
    "snippet": "void nilfs_dat_abort_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tnilfs_dat_abort_entry(dat, req);\n\tnilfs_palloc_abort_alloc_entry(dat, req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_abort_alloc_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_abort_alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "606-636",
          "snippet": "void nilfs_palloc_abort_alloc_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned char *bitmap;\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_abort_alloc_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned char *bitmap;\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_abort_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "68-72",
          "snippet": "static void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tnilfs_dat_abort_entry(dat, req);\n\tnilfs_palloc_abort_alloc_entry(dat, req);\n}"
  },
  {
    "function_name": "nilfs_dat_commit_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "89-104",
    "snippet": "void nilfs_dat_commit_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MAX);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_palloc_commit_alloc_entry(dat, req);\n\tnilfs_dat_commit_entry(dat, req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NILFS_CNO_MAX\t(~(__u64)0)",
      "#define NILFS_CNO_MIN\t((__u64)1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "60-66",
          "snippet": "static void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_commit_alloc_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_commit_alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "552-561",
          "snippet": "void nilfs_palloc_commit_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_commit_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_bitmap_bh);\n\tmark_buffer_dirty(req->pr_desc_bh);\n\tnilfs_mdt_mark_dirty(inode);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "0"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "NILFS_CNO_MAX"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "NILFS_CNO_MIN"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_block_get_entry",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "req->pr_entry_bh",
            "kaddr"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_block_get_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "321-331",
          "snippet": "void *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid *nilfs_palloc_block_get_entry(const struct inode *inode, __u64 nr,\n\t\t\t\t   const struct buffer_head *bh, void *kaddr)\n{\n\tunsigned long entry_offset, group_offset;\n\n\tnilfs_palloc_group(inode, nr, &group_offset);\n\tentry_offset = group_offset % NILFS_MDT(inode)->mi_entries_per_block;\n\n\treturn kaddr + bh_offset(bh) +\n\t\tentry_offset * NILFS_MDT(inode)->mi_entry_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "req->pr_entry_bh->b_page"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\n#define NILFS_CNO_MAX\t(~(__u64)0)\n#define NILFS_CNO_MIN\t((__u64)1)\n\nvoid nilfs_dat_commit_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MAX);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_palloc_commit_alloc_entry(dat, req);\n\tnilfs_dat_commit_entry(dat, req);\n}"
  },
  {
    "function_name": "nilfs_dat_prepare_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "74-87",
    "snippet": "int nilfs_dat_prepare_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_palloc_prepare_alloc_entry(dat, req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 1);\n\tif (ret < 0)\n\t\tnilfs_palloc_abort_alloc_entry(dat, req);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_abort_alloc_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_abort_alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "606-636",
          "snippet": "void nilfs_palloc_abort_alloc_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned char *bitmap;\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_palloc_abort_alloc_entry(struct inode *inode,\n\t\t\t\t    struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_palloc_group_desc *desc;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned char *bitmap;\n\tunsigned long group, group_offset;\n\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tdesc_kaddr = kmap(req->pr_desc_bh->b_page);\n\tdesc = nilfs_palloc_block_get_group_desc(inode, group,\n\t\t\t\t\t\t req->pr_desc_bh, desc_kaddr);\n\tbitmap_kaddr = kmap(req->pr_bitmap_bh->b_page);\n\tbitmap = bitmap_kaddr + bh_offset(req->pr_bitmap_bh);\n\tif (!nilfs_clear_bit_atomic(nilfs_mdt_bgl_lock(inode, group),\n\t\t\t\t    group_offset, bitmap))\n\t\tprintk(KERN_WARNING \"%s: entry number %llu already freed\\n\",\n\t\t       __func__, (unsigned long long)req->pr_entry_nr);\n\telse\n\t\tnilfs_palloc_group_desc_add_entries(inode, group, desc, 1);\n\n\tkunmap(req->pr_bitmap_bh->b_page);\n\tkunmap(req->pr_desc_bh->b_page);\n\n\tbrelse(req->pr_bitmap_bh);\n\tbrelse(req->pr_desc_bh);\n\n\treq->pr_entry_nr = 0;\n\treq->pr_bitmap_bh = NULL;\n\treq->pr_desc_bh = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_entry",
          "args": [
            "dat",
            "req",
            "1"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "53-58",
          "snippet": "static int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_palloc_prepare_alloc_entry",
          "args": [
            "dat",
            "req"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_prepare_alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "468-545",
          "snippet": "int nilfs_palloc_prepare_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, maxgroup, ngroups;\n\tunsigned long group_offset, maxgroup_offset;\n\tunsigned long n, entries_per_group, groups_per_desc_block;\n\tunsigned long i, j;\n\tint pos, ret;\n\n\tngroups = nilfs_palloc_groups_count(inode);\n\tmaxgroup = ngroups - 1;\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tentries_per_group = nilfs_palloc_entries_per_group(inode);\n\tgroups_per_desc_block = nilfs_palloc_groups_per_desc_block(inode);\n\n\tfor (i = 0; i < ngroups; i += n) {\n\t\tif (group >= ngroups) {\n\t\t\t/* wrap around */\n\t\t\tgroup = 0;\n\t\t\tmaxgroup = nilfs_palloc_group(inode, req->pr_entry_nr,\n\t\t\t\t\t\t      &maxgroup_offset) - 1;\n\t\t}\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tn = nilfs_palloc_rest_groups_in_desc_block(inode, group,\n\t\t\t\t\t\t\t   maxgroup);\n\t\tfor (j = 0; j < n; j++, desc++, group++) {\n\t\t\tif (nilfs_palloc_group_desc_nfrees(inode, group, desc)\n\t\t\t    > 0) {\n\t\t\t\tret = nilfs_palloc_get_bitmap_block(\n\t\t\t\t\tinode, group, 1, &bitmap_bh);\n\t\t\t\tif (ret < 0)\n\t\t\t\t\tgoto out_desc;\n\t\t\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\t\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\t\t\tpos = nilfs_palloc_find_available_slot(\n\t\t\t\t\tinode, group, group_offset, bitmap,\n\t\t\t\t\tentries_per_group);\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\t/* found a free entry */\n\t\t\t\t\tnilfs_palloc_group_desc_add_entries(\n\t\t\t\t\t\tinode, group, desc, -1);\n\t\t\t\t\treq->pr_entry_nr =\n\t\t\t\t\t\tentries_per_group * group + pos;\n\t\t\t\t\tkunmap(desc_bh->b_page);\n\t\t\t\t\tkunmap(bitmap_bh->b_page);\n\n\t\t\t\t\treq->pr_desc_bh = desc_bh;\n\t\t\t\t\treq->pr_bitmap_bh = bitmap_bh;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tkunmap(bitmap_bh->b_page);\n\t\t\t\tbrelse(bitmap_bh);\n\t\t\t}\n\n\t\t\tgroup_offset = 0;\n\t\t}\n\n\t\tkunmap(desc_bh->b_page);\n\t\tbrelse(desc_bh);\n\t}\n\n\t/* no entries left */\n\treturn -ENOSPC;\n\n out_desc:\n\tkunmap(desc_bh->b_page);\n\tbrelse(desc_bh);\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_prepare_alloc_entry(struct inode *inode,\n\t\t\t\t     struct nilfs_palloc_req *req)\n{\n\tstruct buffer_head *desc_bh, *bitmap_bh;\n\tstruct nilfs_palloc_group_desc *desc;\n\tunsigned char *bitmap;\n\tvoid *desc_kaddr, *bitmap_kaddr;\n\tunsigned long group, maxgroup, ngroups;\n\tunsigned long group_offset, maxgroup_offset;\n\tunsigned long n, entries_per_group, groups_per_desc_block;\n\tunsigned long i, j;\n\tint pos, ret;\n\n\tngroups = nilfs_palloc_groups_count(inode);\n\tmaxgroup = ngroups - 1;\n\tgroup = nilfs_palloc_group(inode, req->pr_entry_nr, &group_offset);\n\tentries_per_group = nilfs_palloc_entries_per_group(inode);\n\tgroups_per_desc_block = nilfs_palloc_groups_per_desc_block(inode);\n\n\tfor (i = 0; i < ngroups; i += n) {\n\t\tif (group >= ngroups) {\n\t\t\t/* wrap around */\n\t\t\tgroup = 0;\n\t\t\tmaxgroup = nilfs_palloc_group(inode, req->pr_entry_nr,\n\t\t\t\t\t\t      &maxgroup_offset) - 1;\n\t\t}\n\t\tret = nilfs_palloc_get_desc_block(inode, group, 1, &desc_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tdesc_kaddr = kmap(desc_bh->b_page);\n\t\tdesc = nilfs_palloc_block_get_group_desc(\n\t\t\tinode, group, desc_bh, desc_kaddr);\n\t\tn = nilfs_palloc_rest_groups_in_desc_block(inode, group,\n\t\t\t\t\t\t\t   maxgroup);\n\t\tfor (j = 0; j < n; j++, desc++, group++) {\n\t\t\tif (nilfs_palloc_group_desc_nfrees(inode, group, desc)\n\t\t\t    > 0) {\n\t\t\t\tret = nilfs_palloc_get_bitmap_block(\n\t\t\t\t\tinode, group, 1, &bitmap_bh);\n\t\t\t\tif (ret < 0)\n\t\t\t\t\tgoto out_desc;\n\t\t\t\tbitmap_kaddr = kmap(bitmap_bh->b_page);\n\t\t\t\tbitmap = bitmap_kaddr + bh_offset(bitmap_bh);\n\t\t\t\tpos = nilfs_palloc_find_available_slot(\n\t\t\t\t\tinode, group, group_offset, bitmap,\n\t\t\t\t\tentries_per_group);\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\t/* found a free entry */\n\t\t\t\t\tnilfs_palloc_group_desc_add_entries(\n\t\t\t\t\t\tinode, group, desc, -1);\n\t\t\t\t\treq->pr_entry_nr =\n\t\t\t\t\t\tentries_per_group * group + pos;\n\t\t\t\t\tkunmap(desc_bh->b_page);\n\t\t\t\t\tkunmap(bitmap_bh->b_page);\n\n\t\t\t\t\treq->pr_desc_bh = desc_bh;\n\t\t\t\t\treq->pr_bitmap_bh = bitmap_bh;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tkunmap(bitmap_bh->b_page);\n\t\t\t\tbrelse(bitmap_bh);\n\t\t\t}\n\n\t\t\tgroup_offset = 0;\n\t\t}\n\n\t\tkunmap(desc_bh->b_page);\n\t\tbrelse(desc_bh);\n\t}\n\n\t/* no entries left */\n\treturn -ENOSPC;\n\n out_desc:\n\tkunmap(desc_bh->b_page);\n\tbrelse(desc_bh);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_palloc_prepare_alloc_entry(dat, req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 1);\n\tif (ret < 0)\n\t\tnilfs_palloc_abort_alloc_entry(dat, req);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_dat_abort_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "68-72",
    "snippet": "static void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "req->pr_entry_bh"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_abort_entry(struct inode *dat,\n\t\t\t\t  struct nilfs_palloc_req *req)\n{\n\tbrelse(req->pr_entry_bh);\n}"
  },
  {
    "function_name": "nilfs_dat_commit_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "60-66",
    "snippet": "static void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "req->pr_entry_bh"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_mdt_mark_dirty",
          "args": [
            "dat"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mdt_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "98-102",
          "snippet": "static inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline void nilfs_mdt_mark_dirty(struct inode *inode)\n{\n\tif (!test_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state))\n\t\tset_bit(NILFS_I_DIRTY, &NILFS_I(inode)->i_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "req->pr_entry_bh"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic void nilfs_dat_commit_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req)\n{\n\tmark_buffer_dirty(req->pr_entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\tbrelse(req->pr_entry_bh);\n}"
  },
  {
    "function_name": "nilfs_dat_prepare_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "53-58",
    "snippet": "static int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_palloc_get_entry_block",
          "args": [
            "dat",
            "req->pr_entry_nr",
            "create",
            "&req->pr_entry_bh"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_palloc_get_entry_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/alloc.c",
          "lines": "287-296",
          "snippet": "int nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"mdt.h\"\n#include <linux/slab.h>\n#include <linux/bitops.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_palloc_get_entry_block(struct inode *inode, __u64 nr,\n\t\t\t\t int create, struct buffer_head **bhp)\n{\n\tstruct nilfs_palloc_cache *cache = NILFS_MDT(inode)->mi_palloc_cache;\n\n\treturn nilfs_palloc_get_block(inode,\n\t\t\t\t      nilfs_palloc_entry_blkoff(inode, nr),\n\t\t\t\t      create, NULL, bhp,\n\t\t\t\t      &cache->prev_entry, &cache->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic int nilfs_dat_prepare_entry(struct inode *dat,\n\t\t\t\t   struct nilfs_palloc_req *req, int create)\n{\n\treturn nilfs_palloc_get_entry_block(dat, req->pr_entry_nr,\n\t\t\t\t\t    create, &req->pr_entry_bh);\n}"
  },
  {
    "function_name": "NILFS_DAT_I",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
    "lines": "48-51",
    "snippet": "static inline struct nilfs_dat_info *NILFS_DAT_I(struct inode *dat)\n{\n\treturn (struct nilfs_dat_info *)NILFS_MDT(dat);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "dat"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstatic inline struct nilfs_dat_info *NILFS_DAT_I(struct inode *dat)\n{\n\treturn (struct nilfs_dat_info *)NILFS_MDT(dat);\n}"
  }
]