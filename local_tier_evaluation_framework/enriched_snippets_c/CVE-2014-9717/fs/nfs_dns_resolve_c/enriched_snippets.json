[
  {
    "function_name": "nfs_dns_resolver_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "465-469",
    "snippet": "void nfs_dns_resolver_destroy(void)\n{\n\trpc_pipefs_notifier_unregister(&nfs_dns_resolver_block);\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_pernet_subsys",
          "args": [
            "&nfs4_dns_resolver_ops"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_pipefs_notifier_unregister",
          "args": [
            "&nfs_dns_resolver_block"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nvoid nfs_dns_resolver_destroy(void)\n{\n\trpc_pipefs_notifier_unregister(&nfs_dns_resolver_block);\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\n}"
  },
  {
    "function_name": "nfs_dns_resolver_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "448-463",
    "snippet": "int nfs_dns_resolver_init(void)\n{\n\tint err;\n\n\terr = register_pernet_subsys(&nfs4_dns_resolver_ops);\n\tif (err < 0)\n\t\tgoto out;\n\terr = rpc_pipefs_notifier_register(&nfs_dns_resolver_block);\n\tif (err < 0)\n\t\tgoto out1;\n\treturn 0;\nout1:\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\nout:\n\treturn err;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_pernet_subsys",
          "args": [
            "&nfs4_dns_resolver_ops"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_pipefs_notifier_register",
          "args": [
            "&nfs_dns_resolver_block"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_pernet_subsys",
          "args": [
            "&nfs4_dns_resolver_ops"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nint nfs_dns_resolver_init(void)\n{\n\tint err;\n\n\terr = register_pernet_subsys(&nfs4_dns_resolver_ops);\n\tif (err < 0)\n\t\tgoto out;\n\terr = rpc_pipefs_notifier_register(&nfs_dns_resolver_block);\n\tif (err < 0)\n\t\tgoto out1;\n\treturn 0;\nout1:\n\tunregister_pernet_subsys(&nfs4_dns_resolver_ops);\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "rpc_pipefs_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "414-442",
    "snippet": "static int rpc_pipefs_event(struct notifier_block *nb, unsigned long event,\n\t\t\t   void *ptr)\n{\n\tstruct super_block *sb = ptr;\n\tstruct net *net = sb->s_fs_info;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\tstruct cache_detail *cd = nn->nfs_dns_resolve;\n\tint ret = 0;\n\n\tif (cd == NULL)\n\t\treturn 0;\n\n\tif (!try_module_get(THIS_MODULE))\n\t\treturn 0;\n\n\tswitch (event) {\n\tcase RPC_PIPEFS_MOUNT:\n\t\tret = nfs_cache_register_sb(sb, cd);\n\t\tbreak;\n\tcase RPC_PIPEFS_UMOUNT:\n\t\tnfs_cache_unregister_sb(sb, cd);\n\t\tbreak;\n\tdefault:\n\t\tret = -ENOTSUPP;\n\t\tbreak;\n\t}\n\tmodule_put(THIS_MODULE);\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "THIS_MODULE"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_cache_unregister_sb",
          "args": [
            "sb",
            "cd"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_unregister_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "142-146",
          "snippet": "void nfs_cache_unregister_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tif (cd->u.pipefs.dir)\n\t\tsunrpc_cache_unregister_pipefs(cd);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tif (cd->u.pipefs.dir)\n\t\tsunrpc_cache_unregister_pipefs(cd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_cache_register_sb",
          "args": [
            "sb",
            "cd"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_register_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "115-124",
          "snippet": "int nfs_cache_register_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tint ret;\n\tstruct dentry *dir;\n\n\tdir = rpc_d_lookup_sb(sb, \"cache\");\n\tret = sunrpc_cache_register_pipefs(dir, cd->name, 0600, cd);\n\tdput(dir);\n\treturn ret;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nint nfs_cache_register_sb(struct super_block *sb, struct cache_detail *cd)\n{\n\tint ret;\n\tstruct dentry *dir;\n\n\tdir = rpc_d_lookup_sb(sb, \"cache\");\n\tret = sunrpc_cache_register_pipefs(dir, cd->name, 0600, cd);\n\tdput(dir);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "THIS_MODULE"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int rpc_pipefs_event(struct notifier_block *nb, unsigned long event,\n\t\t\t   void *ptr)\n{\n\tstruct super_block *sb = ptr;\n\tstruct net *net = sb->s_fs_info;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\tstruct cache_detail *cd = nn->nfs_dns_resolve;\n\tint ret = 0;\n\n\tif (cd == NULL)\n\t\treturn 0;\n\n\tif (!try_module_get(THIS_MODULE))\n\t\treturn 0;\n\n\tswitch (event) {\n\tcase RPC_PIPEFS_MOUNT:\n\t\tret = nfs_cache_register_sb(sb, cd);\n\t\tbreak;\n\tcase RPC_PIPEFS_UMOUNT:\n\t\tnfs_cache_unregister_sb(sb, cd);\n\t\tbreak;\n\tdefault:\n\t\tret = -ENOTSUPP;\n\t\tbreak;\n\t}\n\tmodule_put(THIS_MODULE);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs4_dns_net_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "404-407",
    "snippet": "static void nfs4_dns_net_exit(struct net *net)\n{\n\tnfs_dns_resolver_cache_destroy(net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_dns_resolver_cache_destroy",
          "args": [
            "net"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_resolver_cache_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "391-397",
          "snippet": "void nfs_dns_resolver_cache_destroy(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnfs_cache_unregister_net(net, nn->nfs_dns_resolve);\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nvoid nfs_dns_resolver_cache_destroy(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnfs_cache_unregister_net(net, nn->nfs_dns_resolve);\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic void nfs4_dns_net_exit(struct net *net)\n{\n\tnfs_dns_resolver_cache_destroy(net);\n}"
  },
  {
    "function_name": "nfs4_dns_net_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "399-402",
    "snippet": "static int nfs4_dns_net_init(struct net *net)\n{\n\treturn nfs_dns_resolver_cache_init(net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_dns_resolver_cache_init",
          "args": [
            "net"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_resolver_cache_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "372-389",
          "snippet": "int nfs_dns_resolver_cache_init(struct net *net)\n{\n\tint err;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnn->nfs_dns_resolve = cache_create_net(&nfs_dns_resolve_template, net);\n\tif (IS_ERR(nn->nfs_dns_resolve))\n\t\treturn PTR_ERR(nn->nfs_dns_resolve);\n\n\terr = nfs_cache_register_net(net, nn->nfs_dns_resolve);\n\tif (err)\n\t\tgoto err_reg;\n\treturn 0;\n\nerr_reg:\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n\treturn err;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nint nfs_dns_resolver_cache_init(struct net *net)\n{\n\tint err;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnn->nfs_dns_resolve = cache_create_net(&nfs_dns_resolve_template, net);\n\tif (IS_ERR(nn->nfs_dns_resolve))\n\t\treturn PTR_ERR(nn->nfs_dns_resolve);\n\n\terr = nfs_cache_register_net(net, nn->nfs_dns_resolve);\n\tif (err)\n\t\tgoto err_reg;\n\treturn 0;\n\nerr_reg:\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int nfs4_dns_net_init(struct net *net)\n{\n\treturn nfs_dns_resolver_cache_init(net);\n}"
  },
  {
    "function_name": "nfs_dns_resolver_cache_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "391-397",
    "snippet": "void nfs_dns_resolver_cache_destroy(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnfs_cache_unregister_net(net, nn->nfs_dns_resolve);\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->nfs_dns_resolve",
            "net"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_cache_unregister_net",
          "args": [
            "net",
            "nn->nfs_dns_resolve"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_unregister_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "148-158",
          "snippet": "void nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_unregister_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tnfs_cache_unregister_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t}\n\tsunrpc_destroy_cache_detail(cd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nvoid nfs_dns_resolver_cache_destroy(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnfs_cache_unregister_net(net, nn->nfs_dns_resolve);\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n}"
  },
  {
    "function_name": "nfs_dns_resolver_cache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "372-389",
    "snippet": "int nfs_dns_resolver_cache_init(struct net *net)\n{\n\tint err;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnn->nfs_dns_resolve = cache_create_net(&nfs_dns_resolve_template, net);\n\tif (IS_ERR(nn->nfs_dns_resolve))\n\t\treturn PTR_ERR(nn->nfs_dns_resolve);\n\n\terr = nfs_cache_register_net(net, nn->nfs_dns_resolve);\n\tif (err)\n\t\tgoto err_reg;\n\treturn 0;\n\nerr_reg:\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n\treturn err;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->nfs_dns_resolve",
            "net"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_cache_register_net",
          "args": [
            "net",
            "nn->nfs_dns_resolve"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_register_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "126-140",
          "snippet": "int nfs_cache_register_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\tint ret = 0;\n\n\tsunrpc_init_cache_detail(cd);\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tret = nfs_cache_register_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t\tif (ret)\n\t\t\tsunrpc_destroy_cache_detail(cd);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nint nfs_cache_register_net(struct net *net, struct cache_detail *cd)\n{\n\tstruct super_block *pipefs_sb;\n\tint ret = 0;\n\n\tsunrpc_init_cache_detail(cd);\n\tpipefs_sb = rpc_get_sb_net(net);\n\tif (pipefs_sb) {\n\t\tret = nfs_cache_register_sb(pipefs_sb, cd);\n\t\trpc_put_sb_net(net);\n\t\tif (ret)\n\t\t\tsunrpc_destroy_cache_detail(cd);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nn->nfs_dns_resolve"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nn->nfs_dns_resolve"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_create_net",
          "args": [
            "&nfs_dns_resolve_template",
            "net"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nint nfs_dns_resolver_cache_init(struct net *net)\n{\n\tint err;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tnn->nfs_dns_resolve = cache_create_net(&nfs_dns_resolve_template, net);\n\tif (IS_ERR(nn->nfs_dns_resolve))\n\t\treturn PTR_ERR(nn->nfs_dns_resolve);\n\n\terr = nfs_cache_register_net(net, nn->nfs_dns_resolve);\n\tif (err)\n\t\tgoto err_reg;\n\treturn 0;\n\nerr_reg:\n\tcache_destroy_net(nn->nfs_dns_resolve, net);\n\treturn err;\n}"
  },
  {
    "function_name": "nfs_dns_resolve_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "332-354",
    "snippet": "ssize_t nfs_dns_resolve_name(struct net *net, char *name,\n\t\tsize_t namelen, struct sockaddr *sa, size_t salen)\n{\n\tstruct nfs_dns_ent key = {\n\t\t.hostname = name,\n\t\t.namelen = namelen,\n\t};\n\tstruct nfs_dns_ent *item = NULL;\n\tssize_t ret;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tret = do_cache_lookup_wait(nn->nfs_dns_resolve, &key, &item);\n\tif (ret == 0) {\n\t\tif (salen >= item->addrlen) {\n\t\t\tmemcpy(sa, &item->addr, item->addrlen);\n\t\t\tret = item->addrlen;\n\t\t} else\n\t\t\tret = -EOVERFLOW;\n\t\tcache_put(&item->h, nn->nfs_dns_resolve);\n\t} else if (ret == -ENOENT)\n\t\tret = -ESRCH;\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&item->h",
            "nn->nfs_dns_resolve"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "sa",
            "&item->addr",
            "item->addrlen"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_cache_lookup_wait",
          "args": [
            "nn->nfs_dns_resolve",
            "&key",
            "&item"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "do_cache_lookup_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "311-330",
          "snippet": "static int do_cache_lookup_wait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\tint ret = -ENOMEM;\n\n\tdreq = nfs_cache_defer_req_alloc();\n\tif (!dreq)\n\t\tgoto out;\n\tret = do_cache_lookup(cd, key, item, dreq);\n\tif (ret == -EAGAIN) {\n\t\tret = nfs_cache_wait_for_upcall(dreq);\n\t\tif (!ret)\n\t\t\tret = do_cache_lookup_nowait(cd, key, item);\n\t}\n\tnfs_cache_defer_req_put(dreq);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int do_cache_lookup_wait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\tint ret = -ENOMEM;\n\n\tdreq = nfs_cache_defer_req_alloc();\n\tif (!dreq)\n\t\tgoto out;\n\tret = do_cache_lookup(cd, key, item, dreq);\n\tif (ret == -EAGAIN) {\n\t\tret = nfs_cache_wait_for_upcall(dreq);\n\t\tif (!ret)\n\t\t\tret = do_cache_lookup_nowait(cd, key, item);\n\t}\n\tnfs_cache_defer_req_put(dreq);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nssize_t nfs_dns_resolve_name(struct net *net, char *name,\n\t\tsize_t namelen, struct sockaddr *sa, size_t salen)\n{\n\tstruct nfs_dns_ent key = {\n\t\t.hostname = name,\n\t\t.namelen = namelen,\n\t};\n\tstruct nfs_dns_ent *item = NULL;\n\tssize_t ret;\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tret = do_cache_lookup_wait(nn->nfs_dns_resolve, &key, &item);\n\tif (ret == 0) {\n\t\tif (salen >= item->addrlen) {\n\t\t\tmemcpy(sa, &item->addr, item->addrlen);\n\t\t\tret = item->addrlen;\n\t\t} else\n\t\t\tret = -EOVERFLOW;\n\t\tcache_put(&item->h, nn->nfs_dns_resolve);\n\t} else if (ret == -ENOENT)\n\t\tret = -ESRCH;\n\treturn ret;\n}"
  },
  {
    "function_name": "do_cache_lookup_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "311-330",
    "snippet": "static int do_cache_lookup_wait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\tint ret = -ENOMEM;\n\n\tdreq = nfs_cache_defer_req_alloc();\n\tif (!dreq)\n\t\tgoto out;\n\tret = do_cache_lookup(cd, key, item, dreq);\n\tif (ret == -EAGAIN) {\n\t\tret = nfs_cache_wait_for_upcall(dreq);\n\t\tif (!ret)\n\t\t\tret = do_cache_lookup_nowait(cd, key, item);\n\t}\n\tnfs_cache_defer_req_put(dreq);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_cache_defer_req_put",
          "args": [
            "dreq"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_defer_req_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "67-71",
          "snippet": "void nfs_cache_defer_req_put(struct nfs_cache_defer_req *dreq)\n{\n\tif (atomic_dec_and_test(&dreq->count))\n\t\tkfree(dreq);\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nvoid nfs_cache_defer_req_put(struct nfs_cache_defer_req *dreq)\n{\n\tif (atomic_dec_and_test(&dreq->count))\n\t\tkfree(dreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_cache_lookup_nowait",
          "args": [
            "cd",
            "key",
            "item"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "do_cache_lookup_nowait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "286-309",
          "snippet": "static int do_cache_lookup_nowait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (!*item)\n\t\tgoto out_err;\n\tret = -ETIMEDOUT;\n\tif (!test_bit(CACHE_VALID, &(*item)->h.flags)\n\t\t\t|| (*item)->h.expiry_time < seconds_since_boot()\n\t\t\t|| cd->flush_time > (*item)->h.last_refresh)\n\t\tgoto out_put;\n\tret = -ENOENT;\n\tif (test_bit(CACHE_NEGATIVE, &(*item)->h.flags))\n\t\tgoto out_put;\n\treturn 0;\nout_put:\n\tcache_put(&(*item)->h, cd);\nout_err:\n\t*item = NULL;\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int do_cache_lookup_nowait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (!*item)\n\t\tgoto out_err;\n\tret = -ETIMEDOUT;\n\tif (!test_bit(CACHE_VALID, &(*item)->h.flags)\n\t\t\t|| (*item)->h.expiry_time < seconds_since_boot()\n\t\t\t|| cd->flush_time > (*item)->h.last_refresh)\n\t\tgoto out_put;\n\tret = -ENOENT;\n\tif (test_bit(CACHE_NEGATIVE, &(*item)->h.flags))\n\t\tgoto out_put;\n\treturn 0;\nout_put:\n\tcache_put(&(*item)->h, cd);\nout_err:\n\t*item = NULL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_cache_wait_for_upcall",
          "args": [
            "dreq"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_wait_for_upcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "107-113",
          "snippet": "int nfs_cache_wait_for_upcall(struct nfs_cache_defer_req *dreq)\n{\n\tif (wait_for_completion_timeout(&dreq->completion,\n\t\t\tnfs_cache_getent_timeout * HZ) == 0)\n\t\treturn -ETIMEDOUT;\n\treturn 0;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long nfs_cache_getent_timeout = NFS_CACHE_UPCALL_TIMEOUT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstatic unsigned long nfs_cache_getent_timeout = NFS_CACHE_UPCALL_TIMEOUT;\n\nint nfs_cache_wait_for_upcall(struct nfs_cache_defer_req *dreq)\n{\n\tif (wait_for_completion_timeout(&dreq->completion,\n\t\t\tnfs_cache_getent_timeout * HZ) == 0)\n\t\treturn -ETIMEDOUT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_cache_lookup",
          "args": [
            "cd",
            "key",
            "item",
            "dreq"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "do_cache_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "270-284",
          "snippet": "static int do_cache_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item,\n\t\tstruct nfs_cache_defer_req *dreq)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (*item) {\n\t\tret = cache_check(cd, &(*item)->h, &dreq->req);\n\t\tif (ret)\n\t\t\t*item = NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int do_cache_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item,\n\t\tstruct nfs_cache_defer_req *dreq)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (*item) {\n\t\tret = cache_check(cd, &(*item)->h, &dreq->req);\n\t\tif (ret)\n\t\t\t*item = NULL;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_cache_defer_req_alloc",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_defer_req_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "94-105",
          "snippet": "struct nfs_cache_defer_req *nfs_cache_defer_req_alloc(void)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = kzalloc(sizeof(*dreq), GFP_KERNEL);\n\tif (dreq) {\n\t\tinit_completion(&dreq->completion);\n\t\tatomic_set(&dreq->count, 1);\n\t\tdreq->req.defer = nfs_dns_cache_defer;\n\t}\n\treturn dreq;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstruct nfs_cache_defer_req *nfs_cache_defer_req_alloc(void)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\n\tdreq = kzalloc(sizeof(*dreq), GFP_KERNEL);\n\tif (dreq) {\n\t\tinit_completion(&dreq->completion);\n\t\tatomic_set(&dreq->count, 1);\n\t\tdreq->req.defer = nfs_dns_cache_defer;\n\t}\n\treturn dreq;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int do_cache_lookup_wait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tstruct nfs_cache_defer_req *dreq;\n\tint ret = -ENOMEM;\n\n\tdreq = nfs_cache_defer_req_alloc();\n\tif (!dreq)\n\t\tgoto out;\n\tret = do_cache_lookup(cd, key, item, dreq);\n\tif (ret == -EAGAIN) {\n\t\tret = nfs_cache_wait_for_upcall(dreq);\n\t\tif (!ret)\n\t\t\tret = do_cache_lookup_nowait(cd, key, item);\n\t}\n\tnfs_cache_defer_req_put(dreq);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "do_cache_lookup_nowait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "286-309",
    "snippet": "static int do_cache_lookup_nowait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (!*item)\n\t\tgoto out_err;\n\tret = -ETIMEDOUT;\n\tif (!test_bit(CACHE_VALID, &(*item)->h.flags)\n\t\t\t|| (*item)->h.expiry_time < seconds_since_boot()\n\t\t\t|| cd->flush_time > (*item)->h.last_refresh)\n\t\tgoto out_put;\n\tret = -ENOENT;\n\tif (test_bit(CACHE_NEGATIVE, &(*item)->h.flags))\n\t\tgoto out_put;\n\treturn 0;\nout_put:\n\tcache_put(&(*item)->h, cd);\nout_err:\n\t*item = NULL;\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&(*item)->h",
            "cd"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&(*item)->h.flags"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seconds_since_boot",
          "args": [],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_dns_lookup",
          "args": [
            "cd",
            "key"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "192-203",
          "snippet": "static struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int do_cache_lookup_nowait(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (!*item)\n\t\tgoto out_err;\n\tret = -ETIMEDOUT;\n\tif (!test_bit(CACHE_VALID, &(*item)->h.flags)\n\t\t\t|| (*item)->h.expiry_time < seconds_since_boot()\n\t\t\t|| cd->flush_time > (*item)->h.last_refresh)\n\t\tgoto out_put;\n\tret = -ENOENT;\n\tif (test_bit(CACHE_NEGATIVE, &(*item)->h.flags))\n\t\tgoto out_put;\n\treturn 0;\nout_put:\n\tcache_put(&(*item)->h, cd);\nout_err:\n\t*item = NULL;\n\treturn ret;\n}"
  },
  {
    "function_name": "do_cache_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "270-284",
    "snippet": "static int do_cache_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item,\n\t\tstruct nfs_cache_defer_req *dreq)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (*item) {\n\t\tret = cache_check(cd, &(*item)->h, &dreq->req);\n\t\tif (ret)\n\t\t\t*item = NULL;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_check",
          "args": [
            "cd",
            "&(*item)->h",
            "&dreq->req"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "afs_vnode_cache_check_aux",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/afs/cache.c",
          "lines": "314-361",
          "snippet": "static enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen)\n{\n\tstruct afs_vnode *vnode = cookie_netfs_data;\n\tuint16_t dlen;\n\n\t_enter(\"{%x,%x,%llx},%p,%u\",\n\t       vnode->fid.vnode, vnode->fid.unique, vnode->status.data_version,\n\t       buffer, buflen);\n\n\t/* check the size of the data is what we're expecting */\n\tdlen = sizeof(vnode->fid.unique) + sizeof(vnode->status.data_version);\n\tif (dlen != buflen) {\n\t\t_leave(\" = OBSOLETE [len %hx != %hx]\", dlen, buflen);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer,\n\t\t   &vnode->fid.unique,\n\t\t   sizeof(vnode->fid.unique)\n\t\t   ) != 0) {\n\t\tunsigned unique;\n\n\t\tmemcpy(&unique, buffer, sizeof(unique));\n\n\t\t_leave(\" = OBSOLETE [uniq %x != %x]\",\n\t\t       unique, vnode->fid.unique);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer + sizeof(vnode->fid.unique),\n\t\t   &vnode->status.data_version,\n\t\t   sizeof(vnode->status.data_version)\n\t\t   ) != 0) {\n\t\tafs_dataversion_t version;\n\n\t\tmemcpy(&version, buffer + sizeof(vnode->fid.unique),\n\t\t       sizeof(version));\n\n\t\t_leave(\" = OBSOLETE [vers %llx != %llx]\",\n\t\t       version, vnode->status.data_version);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\t_leave(\" = SUCCESS\");\n\treturn FSCACHE_CHECKAUX_OKAY;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static uint16_t afs_cell_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);",
            "static uint16_t afs_cell_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);",
            "static enum fscache_checkaux afs_cell_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t      const void *buffer,\n\t\t\t\t\t\t      uint16_t buflen);",
            "static uint16_t afs_vlocation_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);",
            "static uint16_t afs_vlocation_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);",
            "static enum fscache_checkaux afs_vlocation_cache_check_aux(\n\tvoid *cookie_netfs_data, const void *buffer, uint16_t buflen);",
            "static uint16_t afs_volume_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t void *buffer, uint16_t buflen);",
            "static uint16_t afs_vnode_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);",
            "static void afs_vnode_cache_get_attr(const void *cookie_netfs_data,\n\t\t\t\t     uint64_t *size);",
            "static uint16_t afs_vnode_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);",
            "static enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen);",
            "static void afs_vnode_cache_now_uncached(void *cookie_netfs_data);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/sched.h>\n\nstatic uint16_t afs_cell_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);\nstatic uint16_t afs_cell_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t       void *buffer, uint16_t buflen);\nstatic enum fscache_checkaux afs_cell_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t      const void *buffer,\n\t\t\t\t\t\t      uint16_t buflen);\nstatic uint16_t afs_vlocation_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);\nstatic uint16_t afs_vlocation_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\t    void *buffer, uint16_t buflen);\nstatic enum fscache_checkaux afs_vlocation_cache_check_aux(\n\tvoid *cookie_netfs_data, const void *buffer, uint16_t buflen);\nstatic uint16_t afs_volume_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\t void *buffer, uint16_t buflen);\nstatic uint16_t afs_vnode_cache_get_key(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);\nstatic void afs_vnode_cache_get_attr(const void *cookie_netfs_data,\n\t\t\t\t     uint64_t *size);\nstatic uint16_t afs_vnode_cache_get_aux(const void *cookie_netfs_data,\n\t\t\t\t\tvoid *buffer, uint16_t buflen);\nstatic enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen);\nstatic void afs_vnode_cache_now_uncached(void *cookie_netfs_data);\n\nstatic enum fscache_checkaux afs_vnode_cache_check_aux(void *cookie_netfs_data,\n\t\t\t\t\t\t       const void *buffer,\n\t\t\t\t\t\t       uint16_t buflen)\n{\n\tstruct afs_vnode *vnode = cookie_netfs_data;\n\tuint16_t dlen;\n\n\t_enter(\"{%x,%x,%llx},%p,%u\",\n\t       vnode->fid.vnode, vnode->fid.unique, vnode->status.data_version,\n\t       buffer, buflen);\n\n\t/* check the size of the data is what we're expecting */\n\tdlen = sizeof(vnode->fid.unique) + sizeof(vnode->status.data_version);\n\tif (dlen != buflen) {\n\t\t_leave(\" = OBSOLETE [len %hx != %hx]\", dlen, buflen);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer,\n\t\t   &vnode->fid.unique,\n\t\t   sizeof(vnode->fid.unique)\n\t\t   ) != 0) {\n\t\tunsigned unique;\n\n\t\tmemcpy(&unique, buffer, sizeof(unique));\n\n\t\t_leave(\" = OBSOLETE [uniq %x != %x]\",\n\t\t       unique, vnode->fid.unique);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\tif (memcmp(buffer + sizeof(vnode->fid.unique),\n\t\t   &vnode->status.data_version,\n\t\t   sizeof(vnode->status.data_version)\n\t\t   ) != 0) {\n\t\tafs_dataversion_t version;\n\n\t\tmemcpy(&version, buffer + sizeof(vnode->fid.unique),\n\t\t       sizeof(version));\n\n\t\t_leave(\" = OBSOLETE [vers %llx != %llx]\",\n\t\t       version, vnode->status.data_version);\n\t\treturn FSCACHE_CHECKAUX_OBSOLETE;\n\t}\n\n\t_leave(\" = SUCCESS\");\n\treturn FSCACHE_CHECKAUX_OKAY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_dns_lookup",
          "args": [
            "cd",
            "key"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "192-203",
          "snippet": "static struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int do_cache_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key,\n\t\tstruct nfs_dns_ent **item,\n\t\tstruct nfs_cache_defer_req *dreq)\n{\n\tint ret = -ENOMEM;\n\n\t*item = nfs_dns_lookup(cd, key);\n\tif (*item) {\n\t\tret = cache_check(cd, &(*item)->h, &dreq->req);\n\t\tif (ret)\n\t\t\t*item = NULL;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_dns_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "219-268",
    "snippet": "static int nfs_dns_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tchar buf1[NFS_DNS_HOSTNAME_MAXLEN+1];\n\tstruct nfs_dns_ent key, *item;\n\tunsigned int ttl;\n\tssize_t len;\n\tint ret = -EINVAL;\n\n\tif (buf[buflen-1] != '\\n')\n\t\tgoto out;\n\tbuf[buflen-1] = '\\0';\n\n\tlen = qword_get(&buf, buf1, sizeof(buf1));\n\tif (len <= 0)\n\t\tgoto out;\n\tkey.addrlen = rpc_pton(cd->net, buf1, len,\n\t\t\t(struct sockaddr *)&key.addr,\n\t\t\tsizeof(key.addr));\n\n\tlen = qword_get(&buf, buf1, sizeof(buf1));\n\tif (len <= 0)\n\t\tgoto out;\n\n\tkey.hostname = buf1;\n\tkey.namelen = len;\n\tmemset(&key.h, 0, sizeof(key.h));\n\n\tif (get_uint(&buf, &ttl) < 0)\n\t\tgoto out;\n\tif (ttl == 0)\n\t\tgoto out;\n\tkey.h.expiry_time = ttl + seconds_since_boot();\n\n\tret = -ENOMEM;\n\titem = nfs_dns_lookup(cd, &key);\n\tif (item == NULL)\n\t\tgoto out;\n\n\tif (key.addrlen == 0)\n\t\tset_bit(CACHE_NEGATIVE, &key.h.flags);\n\n\titem = nfs_dns_update(cd, &key, item);\n\tif (item == NULL)\n\t\tgoto out;\n\n\tret = 0;\n\tcache_put(&item->h, cd);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&item->h",
            "cd"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "ovl_cache_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/overlayfs/readdir.c",
          "lines": "193-206",
          "snippet": "static void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}",
          "includes": [
            "#include \"overlayfs.h\"",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"overlayfs.h\"\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/rbtree.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ovl_cache_put(struct ovl_dir_file *od, struct dentry *dentry)\n{\n\tstruct ovl_dir_cache *cache = od->cache;\n\n\tWARN_ON(cache->refcount <= 0);\n\tcache->refcount--;\n\tif (!cache->refcount) {\n\t\tif (ovl_dir_cache(dentry) == cache)\n\t\t\tovl_set_dir_cache(dentry, NULL);\n\n\t\tovl_cache_free(&cache->entries);\n\t\tkfree(cache);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_dns_update",
          "args": [
            "cd",
            "&key",
            "item"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "205-217",
          "snippet": "static struct nfs_dns_ent *nfs_dns_update(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *new,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_update(cd,\n\t\t\t&new->h, &key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct nfs_dns_ent *nfs_dns_update(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *new,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_update(cd,\n\t\t\t&new->h, &key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&key.h.flags"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_dns_lookup",
          "args": [
            "cd",
            "&key"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "192-203",
          "snippet": "static struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seconds_since_boot",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_uint",
          "args": [
            "&buf",
            "&ttl"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&key.h",
            "0",
            "sizeof(key.h)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "sizeof(buf1)"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_pton",
          "args": [
            "cd->net",
            "buf1",
            "len",
            "(struct sockaddr *)&key.addr",
            "sizeof(key.addr)"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "sizeof(buf1)"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int nfs_dns_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tchar buf1[NFS_DNS_HOSTNAME_MAXLEN+1];\n\tstruct nfs_dns_ent key, *item;\n\tunsigned int ttl;\n\tssize_t len;\n\tint ret = -EINVAL;\n\n\tif (buf[buflen-1] != '\\n')\n\t\tgoto out;\n\tbuf[buflen-1] = '\\0';\n\n\tlen = qword_get(&buf, buf1, sizeof(buf1));\n\tif (len <= 0)\n\t\tgoto out;\n\tkey.addrlen = rpc_pton(cd->net, buf1, len,\n\t\t\t(struct sockaddr *)&key.addr,\n\t\t\tsizeof(key.addr));\n\n\tlen = qword_get(&buf, buf1, sizeof(buf1));\n\tif (len <= 0)\n\t\tgoto out;\n\n\tkey.hostname = buf1;\n\tkey.namelen = len;\n\tmemset(&key.h, 0, sizeof(key.h));\n\n\tif (get_uint(&buf, &ttl) < 0)\n\t\tgoto out;\n\tif (ttl == 0)\n\t\tgoto out;\n\tkey.h.expiry_time = ttl + seconds_since_boot();\n\n\tret = -ENOMEM;\n\titem = nfs_dns_lookup(cd, &key);\n\tif (item == NULL)\n\t\tgoto out;\n\n\tif (key.addrlen == 0)\n\t\tset_bit(CACHE_NEGATIVE, &key.h.flags);\n\n\titem = nfs_dns_update(cd, &key, item);\n\tif (item == NULL)\n\t\tgoto out;\n\n\tret = 0;\n\tcache_put(&item->h, cd);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_dns_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "205-217",
    "snippet": "static struct nfs_dns_ent *nfs_dns_update(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *new,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_update(cd,\n\t\t\t&new->h, &key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_update",
          "args": [
            "cd",
            "&new->h",
            "&key->h",
            "nfs_dns_hash(key)"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_dns_hash",
          "args": [
            "key"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "125-128",
          "snippet": "static unsigned int nfs_dns_hash(const struct nfs_dns_ent *key)\n{\n\treturn hash_str(key->hostname, NFS_DNS_HASHBITS);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_DNS_HASHBITS 4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\n#define NFS_DNS_HASHBITS 4\n\nstatic unsigned int nfs_dns_hash(const struct nfs_dns_ent *key)\n{\n\treturn hash_str(key->hostname, NFS_DNS_HASHBITS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct nfs_dns_ent *nfs_dns_update(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *new,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_update(cd,\n\t\t\t&new->h, &key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}"
  },
  {
    "function_name": "nfs_dns_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "192-203",
    "snippet": "static struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_lookup",
          "args": [
            "cd",
            "&key->h",
            "nfs_dns_hash(key)"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_dns_hash",
          "args": [
            "key"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "125-128",
          "snippet": "static unsigned int nfs_dns_hash(const struct nfs_dns_ent *key)\n{\n\treturn hash_str(key->hostname, NFS_DNS_HASHBITS);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_DNS_HASHBITS 4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\n#define NFS_DNS_HASHBITS 4\n\nstatic unsigned int nfs_dns_hash(const struct nfs_dns_ent *key)\n{\n\treturn hash_str(key->hostname, NFS_DNS_HASHBITS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct nfs_dns_ent *nfs_dns_lookup(struct cache_detail *cd,\n\t\tstruct nfs_dns_ent *key)\n{\n\tstruct cache_head *ch;\n\n\tch = sunrpc_cache_lookup(cd,\n\t\t\t&key->h,\n\t\t\tnfs_dns_hash(key));\n\tif (!ch)\n\t\treturn NULL;\n\treturn container_of(ch, struct nfs_dns_ent, h);\n}"
  },
  {
    "function_name": "nfs_dns_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "166-190",
    "snippet": "static int nfs_dns_show(struct seq_file *m, struct cache_detail *cd,\n\t\tstruct cache_head *h)\n{\n\tstruct nfs_dns_ent *item;\n\tlong ttl;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"# ip address      hostname        ttl\\n\");\n\t\treturn 0;\n\t}\n\titem = container_of(h, struct nfs_dns_ent, h);\n\tttl = item->h.expiry_time - seconds_since_boot();\n\tif (ttl < 0)\n\t\tttl = 0;\n\n\tif (!test_bit(CACHE_NEGATIVE, &h->flags)) {\n\t\tchar buf[INET6_ADDRSTRLEN+IPV6_SCOPE_ID_LEN+1];\n\n\t\trpc_ntop((struct sockaddr *)&item->addr, buf, sizeof(buf));\n\t\tseq_printf(m, \"%15s \", buf);\n\t} else\n\t\tseq_puts(m, \"<none>          \");\n\tseq_printf(m, \"%15s %ld\\n\", item->hostname, ttl);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%15s %ld\\n\"",
            "item->hostname",
            "ttl"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"<none>          \""
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_ntop",
          "args": [
            "(struct sockaddr *)&item->addr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&h->flags"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seconds_since_boot",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "h",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int nfs_dns_show(struct seq_file *m, struct cache_detail *cd,\n\t\tstruct cache_head *h)\n{\n\tstruct nfs_dns_ent *item;\n\tlong ttl;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"# ip address      hostname        ttl\\n\");\n\t\treturn 0;\n\t}\n\titem = container_of(h, struct nfs_dns_ent, h);\n\tttl = item->h.expiry_time - seconds_since_boot();\n\tif (ttl < 0)\n\t\tttl = 0;\n\n\tif (!test_bit(CACHE_NEGATIVE, &h->flags)) {\n\t\tchar buf[INET6_ADDRSTRLEN+IPV6_SCOPE_ID_LEN+1];\n\n\t\trpc_ntop((struct sockaddr *)&item->addr, buf, sizeof(buf));\n\t\tseq_printf(m, \"%15s \", buf);\n\t} else\n\t\tseq_puts(m, \"<none>          \");\n\tseq_printf(m, \"%15s %ld\\n\", item->hostname, ttl);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_dns_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "152-164",
    "snippet": "static int nfs_dns_match(struct cache_head *ca,\n\t\tstruct cache_head *cb)\n{\n\tstruct nfs_dns_ent *a;\n\tstruct nfs_dns_ent *b;\n\n\ta = container_of(ca, struct nfs_dns_ent, h);\n\tb = container_of(cb, struct nfs_dns_ent, h);\n\n\tif (a->namelen == 0 || a->namelen != b->namelen)\n\t\treturn 0;\n\treturn memcmp(a->hostname, b->hostname, a->namelen) == 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "a->hostname",
            "b->hostname",
            "a->namelen"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cb",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ca",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int nfs_dns_match(struct cache_head *ca,\n\t\tstruct cache_head *cb)\n{\n\tstruct nfs_dns_ent *a;\n\tstruct nfs_dns_ent *b;\n\n\ta = container_of(ca, struct nfs_dns_ent, h);\n\tb = container_of(cb, struct nfs_dns_ent, h);\n\n\tif (a->namelen == 0 || a->namelen != b->namelen)\n\t\treturn 0;\n\treturn memcmp(a->hostname, b->hostname, a->namelen) == 0;\n}"
  },
  {
    "function_name": "nfs_dns_upcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "140-150",
    "snippet": "static int nfs_dns_upcall(struct cache_detail *cd,\n\t\tstruct cache_head *ch)\n{\n\tstruct nfs_dns_ent *key = container_of(ch, struct nfs_dns_ent, h);\n\tint ret;\n\n\tret = nfs_cache_upcall(cd, key->hostname);\n\tif (ret)\n\t\tret = sunrpc_cache_pipe_upcall(cd, ch);\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sunrpc_cache_pipe_upcall",
          "args": [
            "cd",
            "ch"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_cache_upcall",
          "args": [
            "cd",
            "key->hostname"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cache_upcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/cache_lib.c",
          "lines": "34-62",
          "snippet": "int nfs_cache_upcall(struct cache_detail *cd, char *entry_name)\n{\n\tstatic char *envp[] = { \"HOME=/\",\n\t\t\"TERM=linux\",\n\t\t\"PATH=/sbin:/usr/sbin:/bin:/usr/bin\",\n\t\tNULL\n\t};\n\tchar *argv[] = {\n\t\tnfs_cache_getent_prog,\n\t\tcd->name,\n\t\tentry_name,\n\t\tNULL\n\t};\n\tint ret = -EACCES;\n\n\tif (nfs_cache_getent_prog[0] == '\\0')\n\t\tgoto out;\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_EXEC);\n\t/*\n\t * Disable the upcall mechanism if we're getting an ENOENT or\n\t * EACCES error. The admin can re-enable it on the fly by using\n\t * sysfs to set the 'cache_getent' parameter once the problem\n\t * has been fixed.\n\t */\n\tif (ret == -ENOENT || ret == -EACCES)\n\t\tnfs_cache_getent_prog[0] = '\\0';\nout:\n\treturn ret > 0 ? 0 : ret;\n}",
          "includes": [
            "#include \"cache_lib.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/kmod.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char nfs_cache_getent_prog[NFS_CACHE_UPCALL_PATHLEN] =\n\t\t\t\t\"/sbin/nfs_cache_getent\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cache_lib.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/kmod.h>\n\nstatic char nfs_cache_getent_prog[NFS_CACHE_UPCALL_PATHLEN] =\n\t\t\t\t\"/sbin/nfs_cache_getent\";\n\nint nfs_cache_upcall(struct cache_detail *cd, char *entry_name)\n{\n\tstatic char *envp[] = { \"HOME=/\",\n\t\t\"TERM=linux\",\n\t\t\"PATH=/sbin:/usr/sbin:/bin:/usr/bin\",\n\t\tNULL\n\t};\n\tchar *argv[] = {\n\t\tnfs_cache_getent_prog,\n\t\tcd->name,\n\t\tentry_name,\n\t\tNULL\n\t};\n\tint ret = -EACCES;\n\n\tif (nfs_cache_getent_prog[0] == '\\0')\n\t\tgoto out;\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_EXEC);\n\t/*\n\t * Disable the upcall mechanism if we're getting an ENOENT or\n\t * EACCES error. The admin can re-enable it on the fly by using\n\t * sysfs to set the 'cache_getent' parameter once the problem\n\t * has been fixed.\n\t */\n\tif (ret == -ENOENT || ret == -EACCES)\n\t\tnfs_cache_getent_prog[0] = '\\0';\nout:\n\treturn ret > 0 ? 0 : ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic int nfs_dns_upcall(struct cache_detail *cd,\n\t\tstruct cache_head *ch)\n{\n\tstruct nfs_dns_ent *key = container_of(ch, struct nfs_dns_ent, h);\n\tint ret;\n\n\tret = nfs_cache_upcall(cd, key->hostname);\n\tif (ret)\n\t\tret = sunrpc_cache_pipe_upcall(cd, ch);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_dns_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "130-138",
    "snippet": "static void nfs_dns_request(struct cache_detail *cd,\n\t\tstruct cache_head *ch,\n\t\tchar **bpp, int *blen)\n{\n\tstruct nfs_dns_ent *key = container_of(ch, struct nfs_dns_ent, h);\n\n\tqword_add(bpp, blen, key->hostname);\n\t(*bpp)[-1] = '\\n';\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "key->hostname"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic void nfs_dns_request(struct cache_detail *cd,\n\t\tstruct cache_head *ch,\n\t\tchar **bpp, int *blen)\n{\n\tstruct nfs_dns_ent *key = container_of(ch, struct nfs_dns_ent, h);\n\n\tqword_add(bpp, blen, key->hostname);\n\t(*bpp)[-1] = '\\n';\n}"
  },
  {
    "function_name": "nfs_dns_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "125-128",
    "snippet": "static unsigned int nfs_dns_hash(const struct nfs_dns_ent *key)\n{\n\treturn hash_str(key->hostname, NFS_DNS_HASHBITS);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_DNS_HASHBITS 4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_str",
          "args": [
            "key->hostname",
            "NFS_DNS_HASHBITS"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\n#define NFS_DNS_HASHBITS 4\n\nstatic unsigned int nfs_dns_hash(const struct nfs_dns_ent *key)\n{\n\treturn hash_str(key->hostname, NFS_DNS_HASHBITS);\n}"
  },
  {
    "function_name": "nfs_dns_ent_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "112-123",
    "snippet": "static struct cache_head *nfs_dns_ent_alloc(void)\n{\n\tstruct nfs_dns_ent *item = kmalloc(sizeof(*item), GFP_KERNEL);\n\n\tif (item != NULL) {\n\t\titem->hostname = NULL;\n\t\titem->namelen = 0;\n\t\titem->addrlen = 0;\n\t\treturn &item->h;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*item)",
            "GFP_KERNEL"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic struct cache_head *nfs_dns_ent_alloc(void)\n{\n\tstruct nfs_dns_ent *item = kmalloc(sizeof(*item), GFP_KERNEL);\n\n\tif (item != NULL) {\n\t\titem->hostname = NULL;\n\t\titem->namelen = 0;\n\t\titem->addrlen = 0;\n\t\treturn &item->h;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs_dns_ent_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "103-110",
    "snippet": "static void nfs_dns_ent_put(struct kref *ref)\n{\n\tstruct nfs_dns_ent *item;\n\n\titem = container_of(ref, struct nfs_dns_ent, h.ref);\n\tkfree(item->hostname);\n\tkfree(item);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "item"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "item->hostname"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ref",
            "structnfs_dns_ent",
            "h.ref"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic void nfs_dns_ent_put(struct kref *ref)\n{\n\tstruct nfs_dns_ent *item;\n\n\titem = container_of(ref, struct nfs_dns_ent, h.ref);\n\tkfree(item->hostname);\n\tkfree(item);\n}"
  },
  {
    "function_name": "nfs_dns_ent_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "83-101",
    "snippet": "static void nfs_dns_ent_init(struct cache_head *cnew,\n\t\tstruct cache_head *ckey)\n{\n\tstruct nfs_dns_ent *new;\n\tstruct nfs_dns_ent *key;\n\n\tnew = container_of(cnew, struct nfs_dns_ent, h);\n\tkey = container_of(ckey, struct nfs_dns_ent, h);\n\n\tkfree(new->hostname);\n\tnew->hostname = kstrndup(key->hostname, key->namelen, GFP_KERNEL);\n\tif (new->hostname) {\n\t\tnew->namelen = key->namelen;\n\t\tnfs_dns_ent_update(cnew, ckey);\n\t} else {\n\t\tnew->namelen = 0;\n\t\tnew->addrlen = 0;\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_dns_ent_update",
          "args": [
            "cnew",
            "ckey"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_dns_ent_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
          "lines": "70-81",
          "snippet": "static void nfs_dns_ent_update(struct cache_head *cnew,\n\t\tstruct cache_head *ckey)\n{\n\tstruct nfs_dns_ent *new;\n\tstruct nfs_dns_ent *key;\n\n\tnew = container_of(cnew, struct nfs_dns_ent, h);\n\tkey = container_of(ckey, struct nfs_dns_ent, h);\n\n\tmemcpy(&new->addr, &key->addr, key->addrlen);\n\tnew->addrlen = key->addrlen;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"cache_lib.h\"",
            "#include \"dns_resolve.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <linux/sunrpc/svcauth.h>",
            "#include <linux/sunrpc/cache.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/inet.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/socket.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/string.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include \"dns_resolve.h\"",
            "#include <linux/dns_resolver.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic void nfs_dns_ent_update(struct cache_head *cnew,\n\t\tstruct cache_head *ckey)\n{\n\tstruct nfs_dns_ent *new;\n\tstruct nfs_dns_ent *key;\n\n\tnew = container_of(cnew, struct nfs_dns_ent, h);\n\tkey = container_of(ckey, struct nfs_dns_ent, h);\n\n\tmemcpy(&new->addr, &key->addr, key->addrlen);\n\tnew->addrlen = key->addrlen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrndup",
          "args": [
            "key->hostname",
            "key->namelen",
            "GFP_KERNEL"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new->hostname"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ckey",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cnew",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic void nfs_dns_ent_init(struct cache_head *cnew,\n\t\tstruct cache_head *ckey)\n{\n\tstruct nfs_dns_ent *new;\n\tstruct nfs_dns_ent *key;\n\n\tnew = container_of(cnew, struct nfs_dns_ent, h);\n\tkey = container_of(ckey, struct nfs_dns_ent, h);\n\n\tkfree(new->hostname);\n\tnew->hostname = kstrndup(key->hostname, key->namelen, GFP_KERNEL);\n\tif (new->hostname) {\n\t\tnew->namelen = key->namelen;\n\t\tnfs_dns_ent_update(cnew, ckey);\n\t} else {\n\t\tnew->namelen = 0;\n\t\tnew->addrlen = 0;\n\t}\n}"
  },
  {
    "function_name": "nfs_dns_ent_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "70-81",
    "snippet": "static void nfs_dns_ent_update(struct cache_head *cnew,\n\t\tstruct cache_head *ckey)\n{\n\tstruct nfs_dns_ent *new;\n\tstruct nfs_dns_ent *key;\n\n\tnew = container_of(cnew, struct nfs_dns_ent, h);\n\tkey = container_of(ckey, struct nfs_dns_ent, h);\n\n\tmemcpy(&new->addr, &key->addr, key->addrlen);\n\tnew->addrlen = key->addrlen;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&new->addr",
            "&key->addr",
            "key->addrlen"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ckey",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cnew",
            "structnfs_dns_ent",
            "h"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nstatic void nfs_dns_ent_update(struct cache_head *cnew,\n\t\tstruct cache_head *ckey)\n{\n\tstruct nfs_dns_ent *new;\n\tstruct nfs_dns_ent *key;\n\n\tnew = container_of(cnew, struct nfs_dns_ent, h);\n\tkey = container_of(ckey, struct nfs_dns_ent, h);\n\n\tmemcpy(&new->addr, &key->addr, key->addrlen);\n\tnew->addrlen = key->addrlen;\n}"
  },
  {
    "function_name": "nfs_dns_resolve_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/dns_resolve.c",
    "lines": "17-31",
    "snippet": "ssize_t nfs_dns_resolve_name(struct net *net, char *name, size_t namelen,\n\t\tstruct sockaddr *sa, size_t salen)\n{\n\tssize_t ret;\n\tchar *ip_addr = NULL;\n\tint ip_len;\n\n\tip_len = dns_query(NULL, name, namelen, NULL, &ip_addr, NULL);\n\tif (ip_len > 0)\n\t\tret = rpc_pton(net, ip_addr, ip_len, sa, salen);\n\telse\n\t\tret = -ESRCH;\n\tkfree(ip_addr);\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"cache_lib.h\"",
      "#include \"dns_resolve.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <linux/sunrpc/svcauth.h>",
      "#include <linux/sunrpc/cache.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/inet.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/socket.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>",
      "#include <linux/kmod.h>",
      "#include <linux/string.h>",
      "#include <linux/hash.h>",
      "#include <linux/module.h>",
      "#include \"dns_resolve.h\"",
      "#include <linux/dns_resolver.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ip_addr"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_pton",
          "args": [
            "net",
            "ip_addr",
            "ip_len",
            "sa",
            "salen"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dns_query",
          "args": [
            "NULL",
            "name",
            "namelen",
            "NULL",
            "&ip_addr",
            "NULL"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"cache_lib.h\"\n#include \"dns_resolve.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <linux/sunrpc/svcauth.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/inet.h>\n#include <linux/seq_file.h>\n#include <linux/socket.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/string.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include \"dns_resolve.h\"\n#include <linux/dns_resolver.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/module.h>\n\nssize_t nfs_dns_resolve_name(struct net *net, char *name, size_t namelen,\n\t\tstruct sockaddr *sa, size_t salen)\n{\n\tssize_t ret;\n\tchar *ip_addr = NULL;\n\tint ip_len;\n\n\tip_len = dns_query(NULL, name, namelen, NULL, &ip_addr, NULL);\n\tif (ip_len > 0)\n\t\tret = rpc_pton(net, ip_addr, ip_len, sa, salen);\n\telse\n\t\tret = -ESRCH;\n\tkfree(ip_addr);\n\treturn ret;\n}"
  }
]