[
  {
    "function_name": "nilfs_sysfs_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "1133-1137",
    "snippet": "void nilfs_sysfs_exit(void)\n{\n\tsysfs_remove_group(&nilfs_kset->kobj, &nilfs_feature_attr_group);\n\tkset_unregister(nilfs_kset);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *nilfs_kset;",
      "static const struct attribute_group nilfs_feature_attr_group = {\n\t.name = \"features\",\n\t.attrs = nilfs_feature_attrs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "nilfs_kset"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&nilfs_kset->kobj",
            "&nilfs_feature_attr_group"
          ],
          "line": 1135
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "243-252",
          "snippet": "void sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nvoid sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic struct kset *nilfs_kset;\nstatic const struct attribute_group nilfs_feature_attr_group = {\n\t.name = \"features\",\n\t.attrs = nilfs_feature_attrs,\n};\n\nvoid nilfs_sysfs_exit(void)\n{\n\tsysfs_remove_group(&nilfs_kset->kobj, &nilfs_feature_attr_group);\n\tkset_unregister(nilfs_kset);\n}"
  },
  {
    "function_name": "nilfs_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "1105-1131",
    "snippet": "int __init nilfs_sysfs_init(void)\n{\n\tint err;\n\n\tnilfs_kset = kset_create_and_add(NILFS_ROOT_GROUP_NAME, NULL, fs_kobj);\n\tif (!nilfs_kset) {\n\t\terr = -ENOMEM;\n\t\tprintk(KERN_ERR \"NILFS: unable to create sysfs entry: err %d\\n\",\n\t\t\terr);\n\t\tgoto failed_sysfs_init;\n\t}\n\n\terr = sysfs_create_group(&nilfs_kset->kobj, &nilfs_feature_attr_group);\n\tif (unlikely(err)) {\n\t\tprintk(KERN_ERR \"NILFS: unable to create feature group: err %d\\n\",\n\t\t\terr);\n\t\tgoto cleanup_sysfs_init;\n\t}\n\n\treturn 0;\n\ncleanup_sysfs_init:\n\tkset_unregister(nilfs_kset);\n\nfailed_sysfs_init:\n\treturn err;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *nilfs_kset;",
      "static const struct attribute_group nilfs_feature_attr_group = {\n\t.name = \"features\",\n\t.attrs = nilfs_feature_attrs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "nilfs_kset"
          ],
          "line": 1127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NILFS: unable to create feature group: err %d\\n\"",
            "err"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "err"
          ],
          "line": 1118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&nilfs_kset->kobj",
            "&nilfs_feature_attr_group"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "155-173",
          "snippet": "int sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nint sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kset_create_and_add",
          "args": [
            "NILFS_ROOT_GROUP_NAME",
            "NULL",
            "fs_kobj"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic struct kset *nilfs_kset;\nstatic const struct attribute_group nilfs_feature_attr_group = {\n\t.name = \"features\",\n\t.attrs = nilfs_feature_attrs,\n};\n\nint __init nilfs_sysfs_init(void)\n{\n\tint err;\n\n\tnilfs_kset = kset_create_and_add(NILFS_ROOT_GROUP_NAME, NULL, fs_kobj);\n\tif (!nilfs_kset) {\n\t\terr = -ENOMEM;\n\t\tprintk(KERN_ERR \"NILFS: unable to create sysfs entry: err %d\\n\",\n\t\t\terr);\n\t\tgoto failed_sysfs_init;\n\t}\n\n\terr = sysfs_create_group(&nilfs_kset->kobj, &nilfs_feature_attr_group);\n\tif (unlikely(err)) {\n\t\tprintk(KERN_ERR \"NILFS: unable to create feature group: err %d\\n\",\n\t\t\terr);\n\t\tgoto cleanup_sysfs_init;\n\t}\n\n\treturn 0;\n\ncleanup_sysfs_init:\n\tkset_unregister(nilfs_kset);\n\nfailed_sysfs_init:\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_feature_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "1084-1089",
    "snippet": "static ssize_t nilfs_feature_README_show(struct kobject *kobj,\n\t\t\t\t\t struct attribute *attr,\n\t\t\t\t\t char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, features_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char features_readme_str[] =\n\t\"The features group contains attributes that describe NILFS file\\n\"\n\t\"system driver features.\\n\\n\"\n\t\"(1) revision\\n\\tshow current revision of NILFS file system driver.\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "features_readme_str"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char features_readme_str[] =\n\t\"The features group contains attributes that describe NILFS file\\n\"\n\t\"system driver features.\\n\\n\"\n\t\"(1) revision\\n\\tshow current revision of NILFS file system driver.\\n\";\n\nstatic ssize_t nilfs_feature_README_show(struct kobject *kobj,\n\t\t\t\t\t struct attribute *attr,\n\t\t\t\t\t char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, features_readme_str);\n}"
  },
  {
    "function_name": "nilfs_feature_revision_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "1072-1077",
    "snippet": "static ssize_t nilfs_feature_revision_show(struct kobject *kobj,\n\t\t\t\t\t    struct attribute *attr, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%d.%d\\n\",\n\t\t\tNILFS_CURRENT_REV, NILFS_MINOR_REV);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d.%d\\n\"",
            "NILFS_CURRENT_REV",
            "NILFS_MINOR_REV"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t nilfs_feature_revision_show(struct kobject *kobj,\n\t\t\t\t\t    struct attribute *attr, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%d.%d\\n\",\n\t\t\tNILFS_CURRENT_REV, NILFS_MINOR_REV);\n}"
  },
  {
    "function_name": "nilfs_sysfs_delete_device_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "1057-1066",
    "snippet": "void nilfs_sysfs_delete_device_group(struct the_nilfs *nilfs)\n{\n\tnilfs_sysfs_delete_mounted_snapshots_group(nilfs);\n\tnilfs_sysfs_delete_checkpoints_group(nilfs);\n\tnilfs_sysfs_delete_segments_group(nilfs);\n\tnilfs_sysfs_delete_superblock_group(nilfs);\n\tnilfs_sysfs_delete_segctor_group(nilfs);\n\tkobject_del(&nilfs->ns_dev_kobj);\n\tkfree(nilfs->ns_dev_subgroups);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "nilfs->ns_dev_subgroups"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "&nilfs->ns_dev_kobj"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_segctor_group",
          "args": [
            "nilfs"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_superblock_group",
          "args": [
            "nilfs"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_segments_group",
          "args": [
            "nilfs"
          ],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_checkpoints_group",
          "args": [
            "nilfs"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_mounted_snapshots_group",
          "args": [
            "nilfs"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nvoid nilfs_sysfs_delete_device_group(struct the_nilfs *nilfs)\n{\n\tnilfs_sysfs_delete_mounted_snapshots_group(nilfs);\n\tnilfs_sysfs_delete_checkpoints_group(nilfs);\n\tnilfs_sysfs_delete_segments_group(nilfs);\n\tnilfs_sysfs_delete_superblock_group(nilfs);\n\tnilfs_sysfs_delete_segctor_group(nilfs);\n\tkobject_del(&nilfs->ns_dev_kobj);\n\tkfree(nilfs->ns_dev_subgroups);\n}"
  },
  {
    "function_name": "nilfs_sysfs_create_device_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "993-1055",
    "snippet": "int nilfs_sysfs_create_device_group(struct super_block *sb)\n{\n\tstruct the_nilfs *nilfs = sb->s_fs_info;\n\tsize_t devgrp_size = sizeof(struct nilfs_sysfs_dev_subgroups);\n\tint err;\n\n\tnilfs->ns_dev_subgroups = kzalloc(devgrp_size, GFP_KERNEL);\n\tif (unlikely(!nilfs->ns_dev_subgroups)) {\n\t\terr = -ENOMEM;\n\t\tprintk(KERN_ERR \"NILFS: unable to allocate memory for device group\\n\");\n\t\tgoto failed_create_device_group;\n\t}\n\n\tnilfs->ns_dev_kobj.kset = nilfs_kset;\n\tinit_completion(&nilfs->ns_dev_kobj_unregister);\n\terr = kobject_init_and_add(&nilfs->ns_dev_kobj, &nilfs_dev_ktype, NULL,\n\t\t\t\t    \"%s\", sb->s_id);\n\tif (err)\n\t\tgoto free_dev_subgroups;\n\n\terr = nilfs_sysfs_create_mounted_snapshots_group(nilfs);\n\tif (err)\n\t\tgoto cleanup_dev_kobject;\n\n\terr = nilfs_sysfs_create_checkpoints_group(nilfs);\n\tif (err)\n\t\tgoto delete_mounted_snapshots_group;\n\n\terr = nilfs_sysfs_create_segments_group(nilfs);\n\tif (err)\n\t\tgoto delete_checkpoints_group;\n\n\terr = nilfs_sysfs_create_superblock_group(nilfs);\n\tif (err)\n\t\tgoto delete_segments_group;\n\n\terr = nilfs_sysfs_create_segctor_group(nilfs);\n\tif (err)\n\t\tgoto delete_superblock_group;\n\n\treturn 0;\n\ndelete_superblock_group:\n\tnilfs_sysfs_delete_superblock_group(nilfs);\n\ndelete_segments_group:\n\tnilfs_sysfs_delete_segments_group(nilfs);\n\ndelete_checkpoints_group:\n\tnilfs_sysfs_delete_checkpoints_group(nilfs);\n\ndelete_mounted_snapshots_group:\n\tnilfs_sysfs_delete_mounted_snapshots_group(nilfs);\n\ncleanup_dev_kobject:\n\tkobject_del(&nilfs->ns_dev_kobj);\n\nfree_dev_subgroups:\n\tkfree(nilfs->ns_dev_subgroups);\n\nfailed_create_device_group:\n\treturn err;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *nilfs_kset;",
      "static struct kobj_type nilfs_dev_ktype = {\n\t.default_attrs\t= nilfs_dev_attrs,\n\t.sysfs_ops\t= &nilfs_dev_attr_ops,\n\t.release\t= nilfs_dev_attr_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "nilfs->ns_dev_subgroups"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "&nilfs->ns_dev_kobj"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_mounted_snapshots_group",
          "args": [
            "nilfs"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_checkpoints_group",
          "args": [
            "nilfs"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_segments_group",
          "args": [
            "nilfs"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_delete_superblock_group",
          "args": [
            "nilfs"
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_create_segctor_group",
          "args": [
            "nilfs"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_create_superblock_group",
          "args": [
            "nilfs"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_create_segments_group",
          "args": [
            "nilfs"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_create_checkpoints_group",
          "args": [
            "nilfs"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sysfs_create_mounted_snapshots_group",
          "args": [
            "nilfs"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&nilfs->ns_dev_kobj",
            "&nilfs_dev_ktype",
            "NULL",
            "\"%s\"",
            "sb->s_id"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&nilfs->ns_dev_kobj_unregister"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NILFS: unable to allocate memory for device group\\n\""
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!nilfs->ns_dev_subgroups"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "devgrp_size",
            "GFP_KERNEL"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic struct kset *nilfs_kset;\nstatic struct kobj_type nilfs_dev_ktype = {\n\t.default_attrs\t= nilfs_dev_attrs,\n\t.sysfs_ops\t= &nilfs_dev_attr_ops,\n\t.release\t= nilfs_dev_attr_release,\n};\n\nint nilfs_sysfs_create_device_group(struct super_block *sb)\n{\n\tstruct the_nilfs *nilfs = sb->s_fs_info;\n\tsize_t devgrp_size = sizeof(struct nilfs_sysfs_dev_subgroups);\n\tint err;\n\n\tnilfs->ns_dev_subgroups = kzalloc(devgrp_size, GFP_KERNEL);\n\tif (unlikely(!nilfs->ns_dev_subgroups)) {\n\t\terr = -ENOMEM;\n\t\tprintk(KERN_ERR \"NILFS: unable to allocate memory for device group\\n\");\n\t\tgoto failed_create_device_group;\n\t}\n\n\tnilfs->ns_dev_kobj.kset = nilfs_kset;\n\tinit_completion(&nilfs->ns_dev_kobj_unregister);\n\terr = kobject_init_and_add(&nilfs->ns_dev_kobj, &nilfs_dev_ktype, NULL,\n\t\t\t\t    \"%s\", sb->s_id);\n\tif (err)\n\t\tgoto free_dev_subgroups;\n\n\terr = nilfs_sysfs_create_mounted_snapshots_group(nilfs);\n\tif (err)\n\t\tgoto cleanup_dev_kobject;\n\n\terr = nilfs_sysfs_create_checkpoints_group(nilfs);\n\tif (err)\n\t\tgoto delete_mounted_snapshots_group;\n\n\terr = nilfs_sysfs_create_segments_group(nilfs);\n\tif (err)\n\t\tgoto delete_checkpoints_group;\n\n\terr = nilfs_sysfs_create_superblock_group(nilfs);\n\tif (err)\n\t\tgoto delete_segments_group;\n\n\terr = nilfs_sysfs_create_segctor_group(nilfs);\n\tif (err)\n\t\tgoto delete_superblock_group;\n\n\treturn 0;\n\ndelete_superblock_group:\n\tnilfs_sysfs_delete_superblock_group(nilfs);\n\ndelete_segments_group:\n\tnilfs_sysfs_delete_segments_group(nilfs);\n\ndelete_checkpoints_group:\n\tnilfs_sysfs_delete_checkpoints_group(nilfs);\n\ndelete_mounted_snapshots_group:\n\tnilfs_sysfs_delete_mounted_snapshots_group(nilfs);\n\ncleanup_dev_kobject:\n\tkobject_del(&nilfs->ns_dev_kobj);\n\nfree_dev_subgroups:\n\tkfree(nilfs->ns_dev_subgroups);\n\nfailed_create_device_group:\n\treturn err;\n}"
  },
  {
    "function_name": "nilfs_dev_attr_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "975-980",
    "snippet": "static void nilfs_dev_attr_release(struct kobject *kobj)\n{\n\tstruct the_nilfs *nilfs = container_of(kobj, struct the_nilfs,\n\t\t\t\t\t\tns_dev_kobj);\n\tcomplete(&nilfs->ns_dev_kobj_unregister);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&nilfs->ns_dev_kobj_unregister"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segctor_complete_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segment.c",
          "lines": "1757-1852",
          "snippet": "static void nilfs_segctor_complete_write(struct nilfs_sc_info *sci)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tstruct page *bd_page = NULL, *fs_page = NULL;\n\tstruct the_nilfs *nilfs = sci->sc_super->s_fs_info;\n\tint update_sr = false;\n\n\tlist_for_each_entry(segbuf, &sci->sc_write_logs, sb_list) {\n\t\tstruct buffer_head *bh;\n\n\t\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\tif (bd_page)\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\tbd_page = bh->b_page;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t * We assume that the buffers which belong to the same page\n\t\t * continue over the buffer list.\n\t\t * Under this assumption, the last BHs of pages is\n\t\t * identifiable by the discontinuity of bh->b_page\n\t\t * (page != fs_page).\n\t\t *\n\t\t * For B-tree node blocks, however, this assumption is not\n\t\t * guaranteed.  The cleanup code of B-tree node pages needs\n\t\t * special care.\n\t\t */\n\t\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tclear_buffer_delay(bh);\n\t\t\tclear_buffer_nilfs_volatile(bh);\n\t\t\tclear_buffer_nilfs_redirected(bh);\n\t\t\tif (bh == segbuf->sb_super_root) {\n\t\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\t\tbd_page = bh->b_page;\n\t\t\t\t}\n\t\t\t\tupdate_sr = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (bh->b_page != fs_page) {\n\t\t\t\tnilfs_end_page_io(fs_page, 0);\n\t\t\t\tfs_page = bh->b_page;\n\t\t\t}\n\t\t}\n\n\t\tif (!nilfs_segbuf_simplex(segbuf)) {\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGBGN) {\n\t\t\t\tset_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t\t\tsci->sc_lseg_stime = jiffies;\n\t\t\t}\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGEND)\n\t\t\t\tclear_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t}\n\t}\n\t/*\n\t * Since pages may continue over multiple segment buffers,\n\t * end of the last page must be checked outside of the loop.\n\t */\n\tif (bd_page)\n\t\tend_page_writeback(bd_page);\n\n\tnilfs_end_page_io(fs_page, 0);\n\n\tnilfs_drop_collected_inodes(&sci->sc_dirty_files);\n\n\tif (nilfs_doing_gc())\n\t\tnilfs_drop_collected_inodes(&sci->sc_gc_inodes);\n\telse\n\t\tnilfs->ns_nongc_ctime = sci->sc_seg_ctime;\n\n\tsci->sc_nblk_inc += sci->sc_nblk_this_inc;\n\n\tsegbuf = NILFS_LAST_SEGBUF(&sci->sc_write_logs);\n\tnilfs_set_next_segment(nilfs, segbuf);\n\n\tif (update_sr) {\n\t\tnilfs->ns_flushed_device = 0;\n\t\tnilfs_set_last_segment(nilfs, segbuf->sb_pseg_start,\n\t\t\t\t       segbuf->sb_sum.seg_seq, nilfs->ns_cno++);\n\n\t\tclear_bit(NILFS_SC_HAVE_DELTA, &sci->sc_flags);\n\t\tclear_bit(NILFS_SC_DIRTY, &sci->sc_flags);\n\t\tset_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n\t\tnilfs_segctor_clear_metadata_dirty(sci);\n\t} else\n\t\tclear_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"sufile.h\"",
            "#include \"segment.h\"",
            "#include \"page.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/crc32.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/completion.h>",
            "#include <linux/bio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nilfs_segctor_start_timer(struct nilfs_sc_info *);",
            "static void nilfs_segctor_do_flush(struct nilfs_sc_info *, int);",
            "static void nilfs_segctor_do_immediate_flush(struct nilfs_sc_info *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"segment.h\"\n#include \"page.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/pagevec.h>\n#include <linux/crc32.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n#include <linux/pagemap.h>\n\nstatic void nilfs_segctor_start_timer(struct nilfs_sc_info *);\nstatic void nilfs_segctor_do_flush(struct nilfs_sc_info *, int);\nstatic void nilfs_segctor_do_immediate_flush(struct nilfs_sc_info *);\n\nstatic void nilfs_segctor_complete_write(struct nilfs_sc_info *sci)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tstruct page *bd_page = NULL, *fs_page = NULL;\n\tstruct the_nilfs *nilfs = sci->sc_super->s_fs_info;\n\tint update_sr = false;\n\n\tlist_for_each_entry(segbuf, &sci->sc_write_logs, sb_list) {\n\t\tstruct buffer_head *bh;\n\n\t\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\tif (bd_page)\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\tbd_page = bh->b_page;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t * We assume that the buffers which belong to the same page\n\t\t * continue over the buffer list.\n\t\t * Under this assumption, the last BHs of pages is\n\t\t * identifiable by the discontinuity of bh->b_page\n\t\t * (page != fs_page).\n\t\t *\n\t\t * For B-tree node blocks, however, this assumption is not\n\t\t * guaranteed.  The cleanup code of B-tree node pages needs\n\t\t * special care.\n\t\t */\n\t\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tclear_buffer_delay(bh);\n\t\t\tclear_buffer_nilfs_volatile(bh);\n\t\t\tclear_buffer_nilfs_redirected(bh);\n\t\t\tif (bh == segbuf->sb_super_root) {\n\t\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\t\tbd_page = bh->b_page;\n\t\t\t\t}\n\t\t\t\tupdate_sr = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (bh->b_page != fs_page) {\n\t\t\t\tnilfs_end_page_io(fs_page, 0);\n\t\t\t\tfs_page = bh->b_page;\n\t\t\t}\n\t\t}\n\n\t\tif (!nilfs_segbuf_simplex(segbuf)) {\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGBGN) {\n\t\t\t\tset_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t\t\tsci->sc_lseg_stime = jiffies;\n\t\t\t}\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGEND)\n\t\t\t\tclear_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t}\n\t}\n\t/*\n\t * Since pages may continue over multiple segment buffers,\n\t * end of the last page must be checked outside of the loop.\n\t */\n\tif (bd_page)\n\t\tend_page_writeback(bd_page);\n\n\tnilfs_end_page_io(fs_page, 0);\n\n\tnilfs_drop_collected_inodes(&sci->sc_dirty_files);\n\n\tif (nilfs_doing_gc())\n\t\tnilfs_drop_collected_inodes(&sci->sc_gc_inodes);\n\telse\n\t\tnilfs->ns_nongc_ctime = sci->sc_seg_ctime;\n\n\tsci->sc_nblk_inc += sci->sc_nblk_this_inc;\n\n\tsegbuf = NILFS_LAST_SEGBUF(&sci->sc_write_logs);\n\tnilfs_set_next_segment(nilfs, segbuf);\n\n\tif (update_sr) {\n\t\tnilfs->ns_flushed_device = 0;\n\t\tnilfs_set_last_segment(nilfs, segbuf->sb_pseg_start,\n\t\t\t\t       segbuf->sb_sum.seg_seq, nilfs->ns_cno++);\n\n\t\tclear_bit(NILFS_SC_HAVE_DELTA, &sci->sc_flags);\n\t\tclear_bit(NILFS_SC_DIRTY, &sci->sc_flags);\n\t\tset_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n\t\tnilfs_segctor_clear_metadata_dirty(sci);\n\t} else\n\t\tclear_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structthe_nilfs",
            "ns_dev_kobj"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic void nilfs_dev_attr_release(struct kobject *kobj)\n{\n\tstruct the_nilfs *nilfs = container_of(kobj, struct the_nilfs,\n\t\t\t\t\t\tns_dev_kobj);\n\tcomplete(&nilfs->ns_dev_kobj_unregister);\n}"
  },
  {
    "function_name": "nilfs_dev_attr_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "963-973",
    "snippet": "static ssize_t nilfs_dev_attr_store(struct kobject *kobj,\n\t\t\t\t    struct attribute *attr,\n\t\t\t\t    const char *buf, size_t len)\n{\n\tstruct the_nilfs *nilfs = container_of(kobj, struct the_nilfs,\n\t\t\t\t\t\tns_dev_kobj);\n\tstruct nilfs_dev_attr *a = container_of(attr, struct nilfs_dev_attr,\n\t\t\t\t\t\tattr);\n\n\treturn a->store ? a->store(a, nilfs, buf, len) : 0;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->store",
          "args": [
            "a",
            "nilfs",
            "buf",
            "len"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structnilfs_dev_attr",
            "attr"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structthe_nilfs",
            "ns_dev_kobj"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t nilfs_dev_attr_store(struct kobject *kobj,\n\t\t\t\t    struct attribute *attr,\n\t\t\t\t    const char *buf, size_t len)\n{\n\tstruct the_nilfs *nilfs = container_of(kobj, struct the_nilfs,\n\t\t\t\t\t\tns_dev_kobj);\n\tstruct nilfs_dev_attr *a = container_of(attr, struct nilfs_dev_attr,\n\t\t\t\t\t\tattr);\n\n\treturn a->store ? a->store(a, nilfs, buf, len) : 0;\n}"
  },
  {
    "function_name": "nilfs_dev_attr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "952-961",
    "snippet": "static ssize_t nilfs_dev_attr_show(struct kobject *kobj,\n\t\t\t\t    struct attribute *attr, char *buf)\n{\n\tstruct the_nilfs *nilfs = container_of(kobj, struct the_nilfs,\n\t\t\t\t\t\tns_dev_kobj);\n\tstruct nilfs_dev_attr *a = container_of(attr, struct nilfs_dev_attr,\n\t\t\t\t\t\tattr);\n\n\treturn a->show ? a->show(a, nilfs, buf) : 0;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->show",
          "args": [
            "a",
            "nilfs",
            "buf"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structnilfs_dev_attr",
            "attr"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structthe_nilfs",
            "ns_dev_kobj"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t nilfs_dev_attr_show(struct kobject *kobj,\n\t\t\t\t    struct attribute *attr, char *buf)\n{\n\tstruct the_nilfs *nilfs = container_of(kobj, struct the_nilfs,\n\t\t\t\t\t\tns_dev_kobj);\n\tstruct nilfs_dev_attr *a = container_of(attr, struct nilfs_dev_attr,\n\t\t\t\t\t\tattr);\n\n\treturn a->show ? a->show(a, nilfs, buf) : 0;\n}"
  },
  {
    "function_name": "nilfs_dev_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "926-931",
    "snippet": "static ssize_t nilfs_dev_README_show(struct nilfs_dev_attr *attr,\n\t\t\t\t     struct the_nilfs *nilfs,\n\t\t\t\t     char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, dev_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char dev_readme_str[] =\n\t\"The <device> group contains attributes that describe file system\\n\"\n\t\"partition's details.\\n\\n\"\n\t\"(1) revision\\n\\tshow NILFS file system revision.\\n\\n\"\n\t\"(2) blocksize\\n\\tshow volume block size in bytes.\\n\\n\"\n\t\"(3) device_size\\n\\tshow volume size in bytes.\\n\\n\"\n\t\"(4) free_blocks\\n\\tshow count of free blocks on volume.\\n\\n\"\n\t\"(5) uuid\\n\\tshow volume's UUID.\\n\\n\"\n\t\"(6) volume_name\\n\\tshow volume's name.\\n\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "dev_readme_str"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char dev_readme_str[] =\n\t\"The <device> group contains attributes that describe file system\\n\"\n\t\"partition's details.\\n\\n\"\n\t\"(1) revision\\n\\tshow NILFS file system revision.\\n\\n\"\n\t\"(2) blocksize\\n\\tshow volume block size in bytes.\\n\\n\"\n\t\"(3) device_size\\n\\tshow volume size in bytes.\\n\\n\"\n\t\"(4) free_blocks\\n\\tshow count of free blocks on volume.\\n\\n\"\n\t\"(5) uuid\\n\\tshow volume's UUID.\\n\\n\"\n\t\"(6) volume_name\\n\\tshow volume's name.\\n\\n\";\n\nstatic ssize_t nilfs_dev_README_show(struct nilfs_dev_attr *attr,\n\t\t\t\t     struct the_nilfs *nilfs,\n\t\t\t\t     char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, dev_readme_str);\n}"
  },
  {
    "function_name": "nilfs_dev_volume_name_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "905-914",
    "snippet": "static\nssize_t nilfs_dev_volume_name_show(struct nilfs_dev_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\n\treturn scnprintf(buf, sizeof(sbp[0]->s_volume_name), \"%s\\n\",\n\t\t\t sbp[0]->s_volume_name);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf",
            "sizeof(sbp[0]->s_volume_name)",
            "\"%s\\n\"",
            "sbp[0]->s_volume_name"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic\nssize_t nilfs_dev_volume_name_show(struct nilfs_dev_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\n\treturn scnprintf(buf, sizeof(sbp[0]->s_volume_name), \"%s\\n\",\n\t\t\t sbp[0]->s_volume_name);\n}"
  },
  {
    "function_name": "nilfs_dev_uuid_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "895-903",
    "snippet": "static\nssize_t nilfs_dev_uuid_show(struct nilfs_dev_attr *attr,\n\t\t\t    struct the_nilfs *nilfs,\n\t\t\t    char *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%pUb\\n\", sbp[0]->s_uuid);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%pUb\\n\"",
            "sbp[0]->s_uuid"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic\nssize_t nilfs_dev_uuid_show(struct nilfs_dev_attr *attr,\n\t\t\t    struct the_nilfs *nilfs,\n\t\t\t    char *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%pUb\\n\", sbp[0]->s_uuid);\n}"
  },
  {
    "function_name": "nilfs_dev_free_blocks_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "883-893",
    "snippet": "static\nssize_t nilfs_dev_free_blocks_show(struct nilfs_dev_attr *attr,\n\t\t\t\t   struct the_nilfs *nilfs,\n\t\t\t\t   char *buf)\n{\n\tsector_t free_blocks = 0;\n\n\tnilfs_count_free_blocks(nilfs, &free_blocks);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)free_blocks);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)free_blocks"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_count_free_blocks",
          "args": [
            "nilfs",
            "&free_blocks"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_count_free_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/the_nilfs.c",
          "lines": "697-706",
          "snippet": "int nilfs_count_free_blocks(struct the_nilfs *nilfs, sector_t *nblocks)\n{\n\tunsigned long ncleansegs;\n\n\tdown_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\tncleansegs = nilfs_sufile_get_ncleansegs(nilfs->ns_sufile);\n\tup_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\t*nblocks = (sector_t)ncleansegs * nilfs->ns_blocks_per_segment;\n\treturn 0;\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"dat.h\"",
            "#include \"sufile.h\"",
            "#include \"cpfile.h\"",
            "#include \"alloc.h\"",
            "#include \"segment.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"dat.h\"\n#include \"sufile.h\"\n#include \"cpfile.h\"\n#include \"alloc.h\"\n#include \"segment.h\"\n#include \"nilfs.h\"\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n\nint nilfs_count_free_blocks(struct the_nilfs *nilfs, sector_t *nblocks)\n{\n\tunsigned long ncleansegs;\n\n\tdown_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\tncleansegs = nilfs_sufile_get_ncleansegs(nilfs->ns_sufile);\n\tup_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\t*nblocks = (sector_t)ncleansegs * nilfs->ns_blocks_per_segment;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic\nssize_t nilfs_dev_free_blocks_show(struct nilfs_dev_attr *attr,\n\t\t\t\t   struct the_nilfs *nilfs,\n\t\t\t\t   char *buf)\n{\n\tsector_t free_blocks = 0;\n\n\tnilfs_count_free_blocks(nilfs, &free_blocks);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)free_blocks);\n}"
  },
  {
    "function_name": "nilfs_dev_device_size_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "872-881",
    "snippet": "static\nssize_t nilfs_dev_device_size_show(struct nilfs_dev_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\tu64 dev_size = le64_to_cpu(sbp[0]->s_dev_size);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", dev_size);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "dev_size"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "sbp[0]->s_dev_size"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic\nssize_t nilfs_dev_device_size_show(struct nilfs_dev_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\tu64 dev_size = le64_to_cpu(sbp[0]->s_dev_size);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", dev_size);\n}"
  },
  {
    "function_name": "nilfs_dev_blocksize_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "864-870",
    "snippet": "static\nssize_t nilfs_dev_blocksize_show(struct nilfs_dev_attr *attr,\n\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", nilfs->ns_blocksize);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "nilfs->ns_blocksize"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic\nssize_t nilfs_dev_blocksize_show(struct nilfs_dev_attr *attr,\n\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", nilfs->ns_blocksize);\n}"
  },
  {
    "function_name": "nilfs_dev_revision_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "852-862",
    "snippet": "static\nssize_t nilfs_dev_revision_show(struct nilfs_dev_attr *attr,\n\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\tchar *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\tu32 major = le32_to_cpu(sbp[0]->s_rev_level);\n\tu16 minor = le16_to_cpu(sbp[0]->s_minor_rev_level);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d.%d\\n\", major, minor);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d.%d\\n\"",
            "major",
            "minor"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "sbp[0]->s_minor_rev_level"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "sbp[0]->s_rev_level"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic\nssize_t nilfs_dev_revision_show(struct nilfs_dev_attr *attr,\n\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\tchar *buf)\n{\n\tstruct nilfs_super_block **sbp = nilfs->ns_sbp;\n\tu32 major = le32_to_cpu(sbp[0]->s_rev_level);\n\tu16 minor = le16_to_cpu(sbp[0]->s_minor_rev_level);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d.%d\\n\", major, minor);\n}"
  },
  {
    "function_name": "nilfs_superblock_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "822-827",
    "snippet": "static ssize_t\nnilfs_superblock_README_show(struct nilfs_superblock_attr *attr,\n\t\t\t\tstruct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, sb_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char sb_readme_str[] =\n\t\"The superblock group contains attributes that describe\\n\"\n\t\"superblock's details.\\n\\n\"\n\t\"(1) sb_write_time\\n\\tshow previous write time of super block \"\n\t\"in human-readable format.\\n\\n\"\n\t\"(2) sb_write_time_secs\\n\\tshow previous write time of super block \"\n\t\"in seconds.\\n\\n\"\n\t\"(3) sb_write_count\\n\\tshow write count of super block.\\n\\n\"\n\t\"(4) sb_update_frequency\\n\"\n\t\"\\tshow/set interval of periodical update of superblock (in seconds).\\n\\n\"\n\t\"\\tYou can set preferable frequency of superblock update by command:\\n\\n\"\n\t\"\\t'echo <val> > /sys/fs/<nilfs>/<dev>/superblock/sb_update_frequency'\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "sb_readme_str"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char sb_readme_str[] =\n\t\"The superblock group contains attributes that describe\\n\"\n\t\"superblock's details.\\n\\n\"\n\t\"(1) sb_write_time\\n\\tshow previous write time of super block \"\n\t\"in human-readable format.\\n\\n\"\n\t\"(2) sb_write_time_secs\\n\\tshow previous write time of super block \"\n\t\"in seconds.\\n\\n\"\n\t\"(3) sb_write_count\\n\\tshow write count of super block.\\n\\n\"\n\t\"(4) sb_update_frequency\\n\"\n\t\"\\tshow/set interval of periodical update of superblock (in seconds).\\n\\n\"\n\t\"\\tYou can set preferable frequency of superblock update by command:\\n\\n\"\n\t\"\\t'echo <val> > /sys/fs/<nilfs>/<dev>/superblock/sb_update_frequency'\\n\";\n\nstatic ssize_t\nnilfs_superblock_README_show(struct nilfs_superblock_attr *attr,\n\t\t\t\tstruct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, sb_readme_str);\n}"
  },
  {
    "function_name": "nilfs_superblock_sb_update_frequency_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "782-807",
    "snippet": "static ssize_t\nnilfs_superblock_sb_update_frequency_store(struct nilfs_superblock_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    const char *buf, size_t count)\n{\n\tunsigned val;\n\tint err;\n\n\terr = kstrtouint(skip_spaces(buf), 0, &val);\n\tif (err) {\n\t\tprintk(KERN_ERR \"NILFS: unable to convert string: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\tif (val < NILFS_SB_FREQ) {\n\t\tval = NILFS_SB_FREQ;\n\t\tprintk(KERN_WARNING \"NILFS: superblock update frequency cannot be lesser than 10 seconds\\n\");\n\t}\n\n\tdown_write(&nilfs->ns_sem);\n\tnilfs->ns_sb_update_freq = val;\n\tup_write(&nilfs->ns_sem);\n\n\treturn count;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_write",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_write",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"NILFS: superblock update frequency cannot be lesser than 10 seconds\\n\""
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "skip_spaces(buf)",
            "0",
            "&val"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "skip_spaces",
          "args": [
            "buf"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_superblock_sb_update_frequency_store(struct nilfs_superblock_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    const char *buf, size_t count)\n{\n\tunsigned val;\n\tint err;\n\n\terr = kstrtouint(skip_spaces(buf), 0, &val);\n\tif (err) {\n\t\tprintk(KERN_ERR \"NILFS: unable to convert string: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\tif (val < NILFS_SB_FREQ) {\n\t\tval = NILFS_SB_FREQ;\n\t\tprintk(KERN_WARNING \"NILFS: superblock update frequency cannot be lesser than 10 seconds\\n\");\n\t}\n\n\tdown_write(&nilfs->ns_sem);\n\tnilfs->ns_sb_update_freq = val;\n\tup_write(&nilfs->ns_sem);\n\n\treturn count;\n}"
  },
  {
    "function_name": "nilfs_superblock_sb_update_frequency_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "768-780",
    "snippet": "static ssize_t\nnilfs_superblock_sb_update_frequency_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\tunsigned sb_update_freq;\n\n\tdown_read(&nilfs->ns_sem);\n\tsb_update_freq = nilfs->ns_sb_update_freq;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", sb_update_freq);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "sb_update_freq"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_superblock_sb_update_frequency_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\tunsigned sb_update_freq;\n\n\tdown_read(&nilfs->ns_sem);\n\tsb_update_freq = nilfs->ns_sb_update_freq;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", sb_update_freq);\n}"
  },
  {
    "function_name": "nilfs_superblock_sb_write_count_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "754-766",
    "snippet": "static ssize_t\nnilfs_superblock_sb_write_count_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t      struct the_nilfs *nilfs,\n\t\t\t\t      char *buf)\n{\n\tunsigned sbwcount;\n\n\tdown_read(&nilfs->ns_sem);\n\tsbwcount = nilfs->ns_sbwcount;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", sbwcount);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "sbwcount"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_superblock_sb_write_count_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t      struct the_nilfs *nilfs,\n\t\t\t\t      char *buf)\n{\n\tunsigned sbwcount;\n\n\tdown_read(&nilfs->ns_sem);\n\tsbwcount = nilfs->ns_sbwcount;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", sbwcount);\n}"
  },
  {
    "function_name": "nilfs_superblock_sb_write_time_secs_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "740-752",
    "snippet": "static ssize_t\nnilfs_superblock_sb_write_time_secs_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t\t char *buf)\n{\n\ttime_t sbwtime;\n\n\tdown_read(&nilfs->ns_sem);\n\tsbwtime = nilfs->ns_sbwtime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", (unsigned long long)sbwtime);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)sbwtime"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_superblock_sb_write_time_secs_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t\t char *buf)\n{\n\ttime_t sbwtime;\n\n\tdown_read(&nilfs->ns_sem);\n\tsbwtime = nilfs->ns_sbwtime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", (unsigned long long)sbwtime);\n}"
  },
  {
    "function_name": "nilfs_superblock_sb_write_time_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "726-738",
    "snippet": "static ssize_t\nnilfs_superblock_sb_write_time_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t     struct the_nilfs *nilfs,\n\t\t\t\t     char *buf)\n{\n\ttime_t sbwtime;\n\n\tdown_read(&nilfs->ns_sem);\n\tsbwtime = nilfs->ns_sbwtime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn NILFS_SHOW_TIME(sbwtime, buf);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_SHOW_TIME",
          "args": [
            "sbwtime",
            "buf"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_superblock_sb_write_time_show(struct nilfs_superblock_attr *attr,\n\t\t\t\t     struct the_nilfs *nilfs,\n\t\t\t\t     char *buf)\n{\n\ttime_t sbwtime;\n\n\tdown_read(&nilfs->ns_sem);\n\tsbwtime = nilfs->ns_sbwtime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn NILFS_SHOW_TIME(sbwtime, buf);\n}"
  },
  {
    "function_name": "nilfs_segctor_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "678-683",
    "snippet": "static ssize_t\nnilfs_segctor_README_show(struct nilfs_segctor_attr *attr,\n\t\t\t  struct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, segctor_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char segctor_readme_str[] =\n\t\"The segctor group contains attributes that describe\\n\"\n\t\"segctor thread activity details.\\n\\n\"\n\t\"(1) last_pseg_block\\n\"\n\t\"\\tshow start block number of the latest segment.\\n\\n\"\n\t\"(2) last_seg_sequence\\n\"\n\t\"\\tshow sequence value of the latest segment.\\n\\n\"\n\t\"(3) last_seg_checkpoint\\n\"\n\t\"\\tshow checkpoint number of the latest segment.\\n\\n\"\n\t\"(4) current_seg_sequence\\n\\tshow segment sequence counter.\\n\\n\"\n\t\"(5) current_last_full_seg\\n\"\n\t\"\\tshow index number of the latest full segment.\\n\\n\"\n\t\"(6) next_full_seg\\n\"\n\t\"\\tshow index number of the full segment index to be used next.\\n\\n\"\n\t\"(7) next_pseg_offset\\n\"\n\t\"\\tshow offset of next partial segment in the current full segment.\\n\\n\"\n\t\"(8) next_checkpoint\\n\\tshow next checkpoint number.\\n\\n\"\n\t\"(9) last_seg_write_time\\n\"\n\t\"\\tshow write time of the last segment in human-readable format.\\n\\n\"\n\t\"(10) last_seg_write_time_secs\\n\"\n\t\"\\tshow write time of the last segment in seconds.\\n\\n\"\n\t\"(11) last_nongc_write_time\\n\"\n\t\"\\tshow write time of the last segment not for cleaner operation \"\n\t\"in human-readable format.\\n\\n\"\n\t\"(12) last_nongc_write_time_secs\\n\"\n\t\"\\tshow write time of the last segment not for cleaner operation \"\n\t\"in seconds.\\n\\n\"\n\t\"(13) dirty_data_blocks_count\\n\"\n\t\"\\tshow number of dirty data blocks.\\n\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "segctor_readme_str"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char segctor_readme_str[] =\n\t\"The segctor group contains attributes that describe\\n\"\n\t\"segctor thread activity details.\\n\\n\"\n\t\"(1) last_pseg_block\\n\"\n\t\"\\tshow start block number of the latest segment.\\n\\n\"\n\t\"(2) last_seg_sequence\\n\"\n\t\"\\tshow sequence value of the latest segment.\\n\\n\"\n\t\"(3) last_seg_checkpoint\\n\"\n\t\"\\tshow checkpoint number of the latest segment.\\n\\n\"\n\t\"(4) current_seg_sequence\\n\\tshow segment sequence counter.\\n\\n\"\n\t\"(5) current_last_full_seg\\n\"\n\t\"\\tshow index number of the latest full segment.\\n\\n\"\n\t\"(6) next_full_seg\\n\"\n\t\"\\tshow index number of the full segment index to be used next.\\n\\n\"\n\t\"(7) next_pseg_offset\\n\"\n\t\"\\tshow offset of next partial segment in the current full segment.\\n\\n\"\n\t\"(8) next_checkpoint\\n\\tshow next checkpoint number.\\n\\n\"\n\t\"(9) last_seg_write_time\\n\"\n\t\"\\tshow write time of the last segment in human-readable format.\\n\\n\"\n\t\"(10) last_seg_write_time_secs\\n\"\n\t\"\\tshow write time of the last segment in seconds.\\n\\n\"\n\t\"(11) last_nongc_write_time\\n\"\n\t\"\\tshow write time of the last segment not for cleaner operation \"\n\t\"in human-readable format.\\n\\n\"\n\t\"(12) last_nongc_write_time_secs\\n\"\n\t\"\\tshow write time of the last segment not for cleaner operation \"\n\t\"in seconds.\\n\\n\"\n\t\"(13) dirty_data_blocks_count\\n\"\n\t\"\\tshow number of dirty data blocks.\\n\\n\";\n\nstatic ssize_t\nnilfs_segctor_README_show(struct nilfs_segctor_attr *attr,\n\t\t\t  struct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, segctor_readme_str);\n}"
  },
  {
    "function_name": "nilfs_segctor_dirty_data_blocks_count_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "634-646",
    "snippet": "static ssize_t\nnilfs_segctor_dirty_data_blocks_count_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\tu32 ndirtyblks;\n\n\tdown_read(&nilfs->ns_sem);\n\tndirtyblks = atomic_read(&nilfs->ns_ndirtyblks);\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", ndirtyblks);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "ndirtyblks"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&nilfs->ns_ndirtyblks"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_dirty_data_blocks_count_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\tu32 ndirtyblks;\n\n\tdown_read(&nilfs->ns_sem);\n\tndirtyblks = atomic_read(&nilfs->ns_ndirtyblks);\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", ndirtyblks);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_nongc_write_time_secs_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "619-632",
    "snippet": "static ssize_t\nnilfs_segctor_last_nongc_write_time_secs_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\t\tchar *buf)\n{\n\ttime_t nongc_ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tnongc_ctime = nilfs->ns_nongc_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)nongc_ctime);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)nongc_ctime"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_nongc_write_time_secs_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\t\tchar *buf)\n{\n\ttime_t nongc_ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tnongc_ctime = nilfs->ns_nongc_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)nongc_ctime);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_nongc_write_time_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "605-617",
    "snippet": "static ssize_t\nnilfs_segctor_last_nongc_write_time_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t\t char *buf)\n{\n\ttime_t nongc_ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tnongc_ctime = nilfs->ns_nongc_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn NILFS_SHOW_TIME(nongc_ctime, buf);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_SHOW_TIME",
          "args": [
            "nongc_ctime",
            "buf"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_nongc_write_time_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t\t char *buf)\n{\n\ttime_t nongc_ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tnongc_ctime = nilfs->ns_nongc_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn NILFS_SHOW_TIME(nongc_ctime, buf);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_seg_write_time_secs_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "591-603",
    "snippet": "static ssize_t\nnilfs_segctor_last_seg_write_time_secs_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\ttime_t ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tctime = nilfs->ns_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", (unsigned long long)ctime);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)ctime"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_seg_write_time_secs_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\ttime_t ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tctime = nilfs->ns_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", (unsigned long long)ctime);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_seg_write_time_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "577-589",
    "snippet": "static ssize_t\nnilfs_segctor_last_seg_write_time_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\ttime_t ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tctime = nilfs->ns_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn NILFS_SHOW_TIME(ctime, buf);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_SHOW_TIME",
          "args": [
            "ctime",
            "buf"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_seg_write_time_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\ttime_t ctime;\n\n\tdown_read(&nilfs->ns_sem);\n\tctime = nilfs->ns_ctime;\n\tup_read(&nilfs->ns_sem);\n\n\treturn NILFS_SHOW_TIME(ctime, buf);\n}"
  },
  {
    "function_name": "nilfs_segctor_next_checkpoint_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "563-575",
    "snippet": "static ssize_t\nnilfs_segctor_next_checkpoint_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 cno;\n\n\tdown_read(&nilfs->ns_sem);\n\tcno = nilfs->ns_cno;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", cno);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "cno"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_next_checkpoint_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 cno;\n\n\tdown_read(&nilfs->ns_sem);\n\tcno = nilfs->ns_cno;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", cno);\n}"
  },
  {
    "function_name": "nilfs_segctor_next_pseg_offset_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "549-561",
    "snippet": "static ssize_t\nnilfs_segctor_next_pseg_offset_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\tunsigned long pseg_offset;\n\n\tdown_read(&nilfs->ns_sem);\n\tpseg_offset = nilfs->ns_pseg_offset;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", pseg_offset);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%lu\\n\"",
            "pseg_offset"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_next_pseg_offset_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\tunsigned long pseg_offset;\n\n\tdown_read(&nilfs->ns_sem);\n\tpseg_offset = nilfs->ns_pseg_offset;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", pseg_offset);\n}"
  },
  {
    "function_name": "nilfs_segctor_next_full_seg_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "535-547",
    "snippet": "static ssize_t\nnilfs_segctor_next_full_seg_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t char *buf)\n{\n\t__u64 nextnum;\n\n\tdown_read(&nilfs->ns_sem);\n\tnextnum = nilfs->ns_nextnum;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", nextnum);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "nextnum"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_next_full_seg_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t char *buf)\n{\n\t__u64 nextnum;\n\n\tdown_read(&nilfs->ns_sem);\n\tnextnum = nilfs->ns_nextnum;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", nextnum);\n}"
  },
  {
    "function_name": "nilfs_segctor_current_last_full_seg_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "521-533",
    "snippet": "static ssize_t\nnilfs_segctor_current_last_full_seg_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t\t char *buf)\n{\n\t__u64 segnum;\n\n\tdown_read(&nilfs->ns_sem);\n\tsegnum = nilfs->ns_segnum;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", segnum);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "segnum"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_current_last_full_seg_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\t struct the_nilfs *nilfs,\n\t\t\t\t\t char *buf)\n{\n\t__u64 segnum;\n\n\tdown_read(&nilfs->ns_sem);\n\tsegnum = nilfs->ns_segnum;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", segnum);\n}"
  },
  {
    "function_name": "nilfs_segctor_current_seg_sequence_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "507-519",
    "snippet": "static ssize_t\nnilfs_segctor_current_seg_sequence_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\tu64 seg_seq;\n\n\tdown_read(&nilfs->ns_sem);\n\tseg_seq = nilfs->ns_seg_seq;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", seg_seq);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "seg_seq"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_current_seg_sequence_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\tu64 seg_seq;\n\n\tdown_read(&nilfs->ns_sem);\n\tseg_seq = nilfs->ns_seg_seq;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", seg_seq);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_seg_checkpoint_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "493-505",
    "snippet": "static ssize_t\nnilfs_segctor_last_seg_checkpoint_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 last_cno;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_cno = nilfs->ns_last_cno;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", last_cno);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "last_cno"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_seg_checkpoint_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 last_cno;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_cno = nilfs->ns_last_cno;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", last_cno);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_seg_sequence_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "479-491",
    "snippet": "static ssize_t\nnilfs_segctor_last_seg_sequence_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\tu64 last_seq;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_seq = nilfs->ns_last_seq;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", last_seq);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "last_seq"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_seg_sequence_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\tu64 last_seq;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_seq = nilfs->ns_last_seq;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", last_seq);\n}"
  },
  {
    "function_name": "nilfs_segctor_last_pseg_block_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "464-477",
    "snippet": "static ssize_t\nnilfs_segctor_last_pseg_block_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tsector_t last_pseg;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_pseg = nilfs->ns_last_pseg;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)last_pseg);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)last_pseg"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segctor_last_pseg_block_show(struct nilfs_segctor_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tsector_t last_pseg;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_pseg = nilfs->ns_last_pseg;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)last_pseg);\n}"
  },
  {
    "function_name": "nilfs_segments_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "433-439",
    "snippet": "static ssize_t\nnilfs_segments_README_show(struct nilfs_segments_attr *attr,\n\t\t\t    struct the_nilfs *nilfs,\n\t\t\t    char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, segments_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char segments_readme_str[] =\n\t\"The segments group contains attributes that describe\\n\"\n\t\"details about volume's segments.\\n\\n\"\n\t\"(1) segments_number\\n\\tshow number of segments on volume.\\n\\n\"\n\t\"(2) blocks_per_segment\\n\\tshow number of blocks in segment.\\n\\n\"\n\t\"(3) clean_segments\\n\\tshow count of clean segments.\\n\\n\"\n\t\"(4) dirty_segments\\n\\tshow count of dirty segments.\\n\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "segments_readme_str"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char segments_readme_str[] =\n\t\"The segments group contains attributes that describe\\n\"\n\t\"details about volume's segments.\\n\\n\"\n\t\"(1) segments_number\\n\\tshow number of segments on volume.\\n\\n\"\n\t\"(2) blocks_per_segment\\n\\tshow number of blocks in segment.\\n\\n\"\n\t\"(3) clean_segments\\n\\tshow count of clean segments.\\n\\n\"\n\t\"(4) dirty_segments\\n\\tshow count of dirty segments.\\n\\n\";\n\nstatic ssize_t\nnilfs_segments_README_show(struct nilfs_segments_attr *attr,\n\t\t\t    struct the_nilfs *nilfs,\n\t\t\t    char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, segments_readme_str);\n}"
  },
  {
    "function_name": "nilfs_segments_dirty_segments_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "405-423",
    "snippet": "static ssize_t\nnilfs_segments_dirty_segments_show(struct nilfs_segments_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tstruct nilfs_sustat sustat;\n\tint err;\n\n\tdown_read(&nilfs->ns_segctor_sem);\n\terr = nilfs_sufile_get_stat(nilfs->ns_sufile, &sustat);\n\tup_read(&nilfs->ns_segctor_sem);\n\tif (err < 0) {\n\t\tprintk(KERN_ERR \"NILFS: unable to get segment stat: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", sustat.ss_ndirtysegs);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "sustat.ss_ndirtysegs"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NILFS: unable to get segment stat: err=%d\\n\"",
            "err"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_segctor_sem"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_sufile_get_stat",
          "args": [
            "nilfs->ns_sufile",
            "&sustat"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_get_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "567-597",
          "snippet": "int nilfs_sufile_get_stat(struct inode *sufile, struct nilfs_sustat *sustat)\n{\n\tstruct buffer_head *header_bh;\n\tstruct nilfs_sufile_header *header;\n\tstruct the_nilfs *nilfs = sufile->i_sb->s_fs_info;\n\tvoid *kaddr;\n\tint ret;\n\n\tdown_read(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tkaddr = kmap_atomic(header_bh->b_page);\n\theader = kaddr + bh_offset(header_bh);\n\tsustat->ss_nsegs = nilfs_sufile_get_nsegments(sufile);\n\tsustat->ss_ncleansegs = le64_to_cpu(header->sh_ncleansegs);\n\tsustat->ss_ndirtysegs = le64_to_cpu(header->sh_ndirtysegs);\n\tsustat->ss_ctime = nilfs->ns_ctime;\n\tsustat->ss_nongc_ctime = nilfs->ns_nongc_ctime;\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tsustat->ss_prot_seq = nilfs->ns_prot_seq;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\tkunmap_atomic(kaddr);\n\tbrelse(header_bh);\n\n out_sem:\n\tup_read(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_sufile_get_stat(struct inode *sufile, struct nilfs_sustat *sustat)\n{\n\tstruct buffer_head *header_bh;\n\tstruct nilfs_sufile_header *header;\n\tstruct the_nilfs *nilfs = sufile->i_sb->s_fs_info;\n\tvoid *kaddr;\n\tint ret;\n\n\tdown_read(&NILFS_MDT(sufile)->mi_sem);\n\n\tret = nilfs_sufile_get_header_block(sufile, &header_bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\n\tkaddr = kmap_atomic(header_bh->b_page);\n\theader = kaddr + bh_offset(header_bh);\n\tsustat->ss_nsegs = nilfs_sufile_get_nsegments(sufile);\n\tsustat->ss_ncleansegs = le64_to_cpu(header->sh_ncleansegs);\n\tsustat->ss_ndirtysegs = le64_to_cpu(header->sh_ndirtysegs);\n\tsustat->ss_ctime = nilfs->ns_ctime;\n\tsustat->ss_nongc_ctime = nilfs->ns_nongc_ctime;\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tsustat->ss_prot_seq = nilfs->ns_prot_seq;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\tkunmap_atomic(kaddr);\n\tbrelse(header_bh);\n\n out_sem:\n\tup_read(&NILFS_MDT(sufile)->mi_sem);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_segctor_sem"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segments_dirty_segments_show(struct nilfs_segments_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tstruct nilfs_sustat sustat;\n\tint err;\n\n\tdown_read(&nilfs->ns_segctor_sem);\n\terr = nilfs_sufile_get_stat(nilfs->ns_sufile, &sustat);\n\tup_read(&nilfs->ns_segctor_sem);\n\tif (err < 0) {\n\t\tprintk(KERN_ERR \"NILFS: unable to get segment stat: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", sustat.ss_ndirtysegs);\n}"
  },
  {
    "function_name": "nilfs_segments_clean_segments_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "391-403",
    "snippet": "static ssize_t\nnilfs_segments_clean_segments_show(struct nilfs_segments_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tunsigned long ncleansegs;\n\n\tdown_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\tncleansegs = nilfs_sufile_get_ncleansegs(nilfs->ns_sufile);\n\tup_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", ncleansegs);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%lu\\n\"",
            "ncleansegs"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&NILFS_MDT(nilfs->ns_dat)->mi_sem"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_MDT",
          "args": [
            "nilfs->ns_dat"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_MDT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/mdt.h",
          "lines": "69-72",
          "snippet": "static inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}",
          "includes": [
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/blockgroup_lock.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct nilfs_mdt_info *NILFS_MDT(const struct inode *inode)\n{\n\treturn inode->i_private;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_sufile_get_ncleansegs",
          "args": [
            "nilfs->ns_sufile"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_sufile_get_ncleansegs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sufile.c",
          "lines": "133-136",
          "snippet": "unsigned long nilfs_sufile_get_ncleansegs(struct inode *sufile)\n{\n\treturn NILFS_SUI(sufile)->ncleansegs;\n}",
          "includes": [
            "#include \"sufile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sufile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nunsigned long nilfs_sufile_get_ncleansegs(struct inode *sufile)\n{\n\treturn NILFS_SUI(sufile)->ncleansegs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&NILFS_MDT(nilfs->ns_dat)->mi_sem"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segments_clean_segments_show(struct nilfs_segments_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t    char *buf)\n{\n\tunsigned long ncleansegs;\n\n\tdown_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\tncleansegs = nilfs_sufile_get_ncleansegs(nilfs->ns_sufile);\n\tup_read(&NILFS_MDT(nilfs->ns_dat)->mi_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", ncleansegs);\n}"
  },
  {
    "function_name": "nilfs_segments_blocks_per_segment_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "383-389",
    "snippet": "static ssize_t\nnilfs_segments_blocks_per_segment_show(struct nilfs_segments_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", nilfs->ns_blocks_per_segment);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%lu\\n\"",
            "nilfs->ns_blocks_per_segment"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segments_blocks_per_segment_show(struct nilfs_segments_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", nilfs->ns_blocks_per_segment);\n}"
  },
  {
    "function_name": "nilfs_segments_segments_number_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "375-381",
    "snippet": "static ssize_t\nnilfs_segments_segments_number_show(struct nilfs_segments_attr *attr,\n\t\t\t\t     struct the_nilfs *nilfs,\n\t\t\t\t     char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", nilfs->ns_nsegments);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%lu\\n\"",
            "nilfs->ns_nsegments"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_segments_segments_number_show(struct nilfs_segments_attr *attr,\n\t\t\t\t     struct the_nilfs *nilfs,\n\t\t\t\t     char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%lu\\n\", nilfs->ns_nsegments);\n}"
  },
  {
    "function_name": "nilfs_checkpoints_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "345-350",
    "snippet": "static ssize_t\nnilfs_checkpoints_README_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\tstruct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, checkpoints_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char checkpoints_readme_str[] =\n\t\"The checkpoints group contains attributes that describe\\n\"\n\t\"details about volume's checkpoints.\\n\\n\"\n\t\"(1) checkpoints_number\\n\\tshow number of checkpoints on volume.\\n\\n\"\n\t\"(2) snapshots_number\\n\\tshow number of snapshots on volume.\\n\\n\"\n\t\"(3) last_seg_checkpoint\\n\"\n\t\"\\tshow checkpoint number of the latest segment.\\n\\n\"\n\t\"(4) next_checkpoint\\n\\tshow next checkpoint number.\\n\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "checkpoints_readme_str"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char checkpoints_readme_str[] =\n\t\"The checkpoints group contains attributes that describe\\n\"\n\t\"details about volume's checkpoints.\\n\\n\"\n\t\"(1) checkpoints_number\\n\\tshow number of checkpoints on volume.\\n\\n\"\n\t\"(2) snapshots_number\\n\\tshow number of snapshots on volume.\\n\\n\"\n\t\"(3) last_seg_checkpoint\\n\"\n\t\"\\tshow checkpoint number of the latest segment.\\n\\n\"\n\t\"(4) next_checkpoint\\n\\tshow next checkpoint number.\\n\\n\";\n\nstatic ssize_t\nnilfs_checkpoints_README_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\tstruct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, checkpoints_readme_str);\n}"
  },
  {
    "function_name": "nilfs_checkpoints_next_checkpoint_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "322-334",
    "snippet": "static ssize_t\nnilfs_checkpoints_next_checkpoint_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 cno;\n\n\tdown_read(&nilfs->ns_sem);\n\tcno = nilfs->ns_cno;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", cno);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "cno"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_sem"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_checkpoints_next_checkpoint_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 cno;\n\n\tdown_read(&nilfs->ns_sem);\n\tcno = nilfs->ns_cno;\n\tup_read(&nilfs->ns_sem);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", cno);\n}"
  },
  {
    "function_name": "nilfs_checkpoints_last_seg_checkpoint_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "308-320",
    "snippet": "static ssize_t\nnilfs_checkpoints_last_seg_checkpoint_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\t__u64 last_cno;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_cno = nilfs->ns_last_cno;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", last_cno);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "last_cno"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nilfs->ns_last_segment_lock"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_checkpoints_last_seg_checkpoint_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\t__u64 last_cno;\n\n\tspin_lock(&nilfs->ns_last_segment_lock);\n\tlast_cno = nilfs->ns_last_cno;\n\tspin_unlock(&nilfs->ns_last_segment_lock);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", last_cno);\n}"
  },
  {
    "function_name": "nilfs_checkpoints_snapshots_number_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "285-306",
    "snippet": "static ssize_t\nnilfs_checkpoints_snapshots_number_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 nsnapshots;\n\tstruct nilfs_cpstat cpstat;\n\tint err;\n\n\tdown_read(&nilfs->ns_segctor_sem);\n\terr = nilfs_cpfile_get_stat(nilfs->ns_cpfile, &cpstat);\n\tup_read(&nilfs->ns_segctor_sem);\n\tif (err < 0) {\n\t\tprintk(KERN_ERR \"NILFS: unable to get checkpoint stat: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\tnsnapshots = cpstat.cs_nsss;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", nsnapshots);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "nsnapshots"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NILFS: unable to get checkpoint stat: err=%d\\n\"",
            "err"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_segctor_sem"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_cpfile_get_stat",
          "args": [
            "nilfs->ns_cpfile",
            "&cpstat"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_cpfile_get_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/cpfile.c",
          "lines": "907-930",
          "snippet": "int nilfs_cpfile_get_stat(struct inode *cpfile, struct nilfs_cpstat *cpstat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_cpfile_header *header;\n\tvoid *kaddr;\n\tint ret;\n\n\tdown_read(&NILFS_MDT(cpfile)->mi_sem);\n\n\tret = nilfs_cpfile_get_header_block(cpfile, &bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\tkaddr = kmap_atomic(bh->b_page);\n\theader = nilfs_cpfile_block_get_header(cpfile, bh, kaddr);\n\tcpstat->cs_cno = nilfs_mdt_cno(cpfile);\n\tcpstat->cs_ncps = le64_to_cpu(header->ch_ncheckpoints);\n\tcpstat->cs_nsss = le64_to_cpu(header->ch_nsnapshots);\n\tkunmap_atomic(kaddr);\n\tbrelse(bh);\n\n out_sem:\n\tup_read(&NILFS_MDT(cpfile)->mi_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cpfile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_cpfile_get_stat(struct inode *cpfile, struct nilfs_cpstat *cpstat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_cpfile_header *header;\n\tvoid *kaddr;\n\tint ret;\n\n\tdown_read(&NILFS_MDT(cpfile)->mi_sem);\n\n\tret = nilfs_cpfile_get_header_block(cpfile, &bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\tkaddr = kmap_atomic(bh->b_page);\n\theader = nilfs_cpfile_block_get_header(cpfile, bh, kaddr);\n\tcpstat->cs_cno = nilfs_mdt_cno(cpfile);\n\tcpstat->cs_ncps = le64_to_cpu(header->ch_ncheckpoints);\n\tcpstat->cs_nsss = le64_to_cpu(header->ch_nsnapshots);\n\tkunmap_atomic(kaddr);\n\tbrelse(bh);\n\n out_sem:\n\tup_read(&NILFS_MDT(cpfile)->mi_sem);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_segctor_sem"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_checkpoints_snapshots_number_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\tstruct the_nilfs *nilfs,\n\t\t\t\t\tchar *buf)\n{\n\t__u64 nsnapshots;\n\tstruct nilfs_cpstat cpstat;\n\tint err;\n\n\tdown_read(&nilfs->ns_segctor_sem);\n\terr = nilfs_cpfile_get_stat(nilfs->ns_cpfile, &cpstat);\n\tup_read(&nilfs->ns_segctor_sem);\n\tif (err < 0) {\n\t\tprintk(KERN_ERR \"NILFS: unable to get checkpoint stat: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\tnsnapshots = cpstat.cs_nsss;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", nsnapshots);\n}"
  },
  {
    "function_name": "nilfs_checkpoints_checkpoints_number_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "262-283",
    "snippet": "static ssize_t\nnilfs_checkpoints_checkpoints_number_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\t__u64 ncheckpoints;\n\tstruct nilfs_cpstat cpstat;\n\tint err;\n\n\tdown_read(&nilfs->ns_segctor_sem);\n\terr = nilfs_cpfile_get_stat(nilfs->ns_cpfile, &cpstat);\n\tup_read(&nilfs->ns_segctor_sem);\n\tif (err < 0) {\n\t\tprintk(KERN_ERR \"NILFS: unable to get checkpoint stat: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\tncheckpoints = cpstat.cs_ncps;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", ncheckpoints);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "ncheckpoints"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"NILFS: unable to get checkpoint stat: err=%d\\n\"",
            "err"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&nilfs->ns_segctor_sem"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_cpfile_get_stat",
          "args": [
            "nilfs->ns_cpfile",
            "&cpstat"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_cpfile_get_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/cpfile.c",
          "lines": "907-930",
          "snippet": "int nilfs_cpfile_get_stat(struct inode *cpfile, struct nilfs_cpstat *cpstat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_cpfile_header *header;\n\tvoid *kaddr;\n\tint ret;\n\n\tdown_read(&NILFS_MDT(cpfile)->mi_sem);\n\n\tret = nilfs_cpfile_get_header_block(cpfile, &bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\tkaddr = kmap_atomic(bh->b_page);\n\theader = nilfs_cpfile_block_get_header(cpfile, bh, kaddr);\n\tcpstat->cs_cno = nilfs_mdt_cno(cpfile);\n\tcpstat->cs_ncps = le64_to_cpu(header->ch_ncheckpoints);\n\tcpstat->cs_nsss = le64_to_cpu(header->ch_nsnapshots);\n\tkunmap_atomic(kaddr);\n\tbrelse(bh);\n\n out_sem:\n\tup_read(&NILFS_MDT(cpfile)->mi_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cpfile.h\"\n#include \"mdt.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/errno.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n\nint nilfs_cpfile_get_stat(struct inode *cpfile, struct nilfs_cpstat *cpstat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_cpfile_header *header;\n\tvoid *kaddr;\n\tint ret;\n\n\tdown_read(&NILFS_MDT(cpfile)->mi_sem);\n\n\tret = nilfs_cpfile_get_header_block(cpfile, &bh);\n\tif (ret < 0)\n\t\tgoto out_sem;\n\tkaddr = kmap_atomic(bh->b_page);\n\theader = nilfs_cpfile_block_get_header(cpfile, bh, kaddr);\n\tcpstat->cs_cno = nilfs_mdt_cno(cpfile);\n\tcpstat->cs_ncps = le64_to_cpu(header->ch_ncheckpoints);\n\tcpstat->cs_nsss = le64_to_cpu(header->ch_nsnapshots);\n\tkunmap_atomic(kaddr);\n\tbrelse(bh);\n\n out_sem:\n\tup_read(&NILFS_MDT(cpfile)->mi_sem);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&nilfs->ns_segctor_sem"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_checkpoints_checkpoints_number_show(struct nilfs_checkpoints_attr *attr,\n\t\t\t\t\t    struct the_nilfs *nilfs,\n\t\t\t\t\t    char *buf)\n{\n\t__u64 ncheckpoints;\n\tstruct nilfs_cpstat cpstat;\n\tint err;\n\n\tdown_read(&nilfs->ns_segctor_sem);\n\terr = nilfs_cpfile_get_stat(nilfs->ns_cpfile, &cpstat);\n\tup_read(&nilfs->ns_segctor_sem);\n\tif (err < 0) {\n\t\tprintk(KERN_ERR \"NILFS: unable to get checkpoint stat: err=%d\\n\",\n\t\t\terr);\n\t\treturn err;\n\t}\n\n\tncheckpoints = cpstat.cs_ncps;\n\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", ncheckpoints);\n}"
  },
  {
    "function_name": "nilfs_mounted_snapshots_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "240-245",
    "snippet": "static ssize_t\nnilfs_mounted_snapshots_README_show(struct nilfs_mounted_snapshots_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, mounted_snapshots_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char mounted_snapshots_readme_str[] =\n\t\"The mounted_snapshots group contains group for\\n\"\n\t\"every mounted snapshot.\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "mounted_snapshots_readme_str"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char mounted_snapshots_readme_str[] =\n\t\"The mounted_snapshots group contains group for\\n\"\n\t\"every mounted snapshot.\\n\";\n\nstatic ssize_t\nnilfs_mounted_snapshots_README_show(struct nilfs_mounted_snapshots_attr *attr,\n\t\t\t\t    struct the_nilfs *nilfs, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, mounted_snapshots_readme_str);\n}"
  },
  {
    "function_name": "nilfs_sysfs_delete_snapshot_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "227-230",
    "snippet": "void nilfs_sysfs_delete_snapshot_group(struct nilfs_root *root)\n{\n\tkobject_del(&root->snapshot_kobj);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "&root->snapshot_kobj"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nvoid nilfs_sysfs_delete_snapshot_group(struct nilfs_root *root)\n{\n\tkobject_del(&root->snapshot_kobj);\n}"
  },
  {
    "function_name": "nilfs_sysfs_create_snapshot_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "198-225",
    "snippet": "int nilfs_sysfs_create_snapshot_group(struct nilfs_root *root)\n{\n\tstruct the_nilfs *nilfs;\n\tstruct kobject *parent;\n\tint err;\n\n\tnilfs = root->nilfs;\n\tparent = &nilfs->ns_dev_subgroups->sg_mounted_snapshots_kobj;\n\troot->snapshot_kobj.kset = nilfs_kset;\n\tinit_completion(&root->snapshot_kobj_unregister);\n\n\tif (root->cno == NILFS_CPTREE_CURRENT_CNO) {\n\t\terr = kobject_init_and_add(&root->snapshot_kobj,\n\t\t\t\t\t    &nilfs_snapshot_ktype,\n\t\t\t\t\t    &nilfs->ns_dev_kobj,\n\t\t\t\t\t    \"current_checkpoint\");\n\t} else {\n\t\terr = kobject_init_and_add(&root->snapshot_kobj,\n\t\t\t\t\t    &nilfs_snapshot_ktype,\n\t\t\t\t\t    parent,\n\t\t\t\t\t    \"%llu\", root->cno);\n\t}\n\n\tif (err)\n\t\treturn err;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kset *nilfs_kset;",
      "static struct kobj_type nilfs_snapshot_ktype = {\n\t.default_attrs\t= nilfs_snapshot_attrs,\n\t.sysfs_ops\t= &nilfs_snapshot_attr_ops,\n\t.release\t= nilfs_snapshot_attr_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&root->snapshot_kobj",
            "&nilfs_snapshot_ktype",
            "parent",
            "\"%llu\"",
            "root->cno"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&root->snapshot_kobj",
            "&nilfs_snapshot_ktype",
            "&nilfs->ns_dev_kobj",
            "\"current_checkpoint\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&root->snapshot_kobj_unregister"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic struct kset *nilfs_kset;\nstatic struct kobj_type nilfs_snapshot_ktype = {\n\t.default_attrs\t= nilfs_snapshot_attrs,\n\t.sysfs_ops\t= &nilfs_snapshot_attr_ops,\n\t.release\t= nilfs_snapshot_attr_release,\n};\n\nint nilfs_sysfs_create_snapshot_group(struct nilfs_root *root)\n{\n\tstruct the_nilfs *nilfs;\n\tstruct kobject *parent;\n\tint err;\n\n\tnilfs = root->nilfs;\n\tparent = &nilfs->ns_dev_subgroups->sg_mounted_snapshots_kobj;\n\troot->snapshot_kobj.kset = nilfs_kset;\n\tinit_completion(&root->snapshot_kobj_unregister);\n\n\tif (root->cno == NILFS_CPTREE_CURRENT_CNO) {\n\t\terr = kobject_init_and_add(&root->snapshot_kobj,\n\t\t\t\t\t    &nilfs_snapshot_ktype,\n\t\t\t\t\t    &nilfs->ns_dev_kobj,\n\t\t\t\t\t    \"current_checkpoint\");\n\t} else {\n\t\terr = kobject_init_and_add(&root->snapshot_kobj,\n\t\t\t\t\t    &nilfs_snapshot_ktype,\n\t\t\t\t\t    parent,\n\t\t\t\t\t    \"%llu\", root->cno);\n\t}\n\n\tif (err)\n\t\treturn err;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_snapshot_attr_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "180-185",
    "snippet": "static void nilfs_snapshot_attr_release(struct kobject *kobj)\n{\n\tstruct nilfs_root *root = container_of(kobj, struct nilfs_root,\n\t\t\t\t\t\tsnapshot_kobj);\n\tcomplete(&root->snapshot_kobj_unregister);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&root->snapshot_kobj_unregister"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segctor_complete_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segment.c",
          "lines": "1757-1852",
          "snippet": "static void nilfs_segctor_complete_write(struct nilfs_sc_info *sci)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tstruct page *bd_page = NULL, *fs_page = NULL;\n\tstruct the_nilfs *nilfs = sci->sc_super->s_fs_info;\n\tint update_sr = false;\n\n\tlist_for_each_entry(segbuf, &sci->sc_write_logs, sb_list) {\n\t\tstruct buffer_head *bh;\n\n\t\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\tif (bd_page)\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\tbd_page = bh->b_page;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t * We assume that the buffers which belong to the same page\n\t\t * continue over the buffer list.\n\t\t * Under this assumption, the last BHs of pages is\n\t\t * identifiable by the discontinuity of bh->b_page\n\t\t * (page != fs_page).\n\t\t *\n\t\t * For B-tree node blocks, however, this assumption is not\n\t\t * guaranteed.  The cleanup code of B-tree node pages needs\n\t\t * special care.\n\t\t */\n\t\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tclear_buffer_delay(bh);\n\t\t\tclear_buffer_nilfs_volatile(bh);\n\t\t\tclear_buffer_nilfs_redirected(bh);\n\t\t\tif (bh == segbuf->sb_super_root) {\n\t\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\t\tbd_page = bh->b_page;\n\t\t\t\t}\n\t\t\t\tupdate_sr = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (bh->b_page != fs_page) {\n\t\t\t\tnilfs_end_page_io(fs_page, 0);\n\t\t\t\tfs_page = bh->b_page;\n\t\t\t}\n\t\t}\n\n\t\tif (!nilfs_segbuf_simplex(segbuf)) {\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGBGN) {\n\t\t\t\tset_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t\t\tsci->sc_lseg_stime = jiffies;\n\t\t\t}\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGEND)\n\t\t\t\tclear_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t}\n\t}\n\t/*\n\t * Since pages may continue over multiple segment buffers,\n\t * end of the last page must be checked outside of the loop.\n\t */\n\tif (bd_page)\n\t\tend_page_writeback(bd_page);\n\n\tnilfs_end_page_io(fs_page, 0);\n\n\tnilfs_drop_collected_inodes(&sci->sc_dirty_files);\n\n\tif (nilfs_doing_gc())\n\t\tnilfs_drop_collected_inodes(&sci->sc_gc_inodes);\n\telse\n\t\tnilfs->ns_nongc_ctime = sci->sc_seg_ctime;\n\n\tsci->sc_nblk_inc += sci->sc_nblk_this_inc;\n\n\tsegbuf = NILFS_LAST_SEGBUF(&sci->sc_write_logs);\n\tnilfs_set_next_segment(nilfs, segbuf);\n\n\tif (update_sr) {\n\t\tnilfs->ns_flushed_device = 0;\n\t\tnilfs_set_last_segment(nilfs, segbuf->sb_pseg_start,\n\t\t\t\t       segbuf->sb_sum.seg_seq, nilfs->ns_cno++);\n\n\t\tclear_bit(NILFS_SC_HAVE_DELTA, &sci->sc_flags);\n\t\tclear_bit(NILFS_SC_DIRTY, &sci->sc_flags);\n\t\tset_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n\t\tnilfs_segctor_clear_metadata_dirty(sci);\n\t} else\n\t\tclear_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"sufile.h\"",
            "#include \"segment.h\"",
            "#include \"page.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/crc32.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/completion.h>",
            "#include <linux/bio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nilfs_segctor_start_timer(struct nilfs_sc_info *);",
            "static void nilfs_segctor_do_flush(struct nilfs_sc_info *, int);",
            "static void nilfs_segctor_do_immediate_flush(struct nilfs_sc_info *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"segment.h\"\n#include \"page.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/slab.h>\n#include <linux/pagevec.h>\n#include <linux/crc32.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n#include <linux/pagemap.h>\n\nstatic void nilfs_segctor_start_timer(struct nilfs_sc_info *);\nstatic void nilfs_segctor_do_flush(struct nilfs_sc_info *, int);\nstatic void nilfs_segctor_do_immediate_flush(struct nilfs_sc_info *);\n\nstatic void nilfs_segctor_complete_write(struct nilfs_sc_info *sci)\n{\n\tstruct nilfs_segment_buffer *segbuf;\n\tstruct page *bd_page = NULL, *fs_page = NULL;\n\tstruct the_nilfs *nilfs = sci->sc_super->s_fs_info;\n\tint update_sr = false;\n\n\tlist_for_each_entry(segbuf, &sci->sc_write_logs, sb_list) {\n\t\tstruct buffer_head *bh;\n\n\t\tlist_for_each_entry(bh, &segbuf->sb_segsum_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\tif (bd_page)\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\tbd_page = bh->b_page;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t * We assume that the buffers which belong to the same page\n\t\t * continue over the buffer list.\n\t\t * Under this assumption, the last BHs of pages is\n\t\t * identifiable by the discontinuity of bh->b_page\n\t\t * (page != fs_page).\n\t\t *\n\t\t * For B-tree node blocks, however, this assumption is not\n\t\t * guaranteed.  The cleanup code of B-tree node pages needs\n\t\t * special care.\n\t\t */\n\t\tlist_for_each_entry(bh, &segbuf->sb_payload_buffers,\n\t\t\t\t    b_assoc_buffers) {\n\t\t\tset_buffer_uptodate(bh);\n\t\t\tclear_buffer_dirty(bh);\n\t\t\tclear_buffer_async_write(bh);\n\t\t\tclear_buffer_delay(bh);\n\t\t\tclear_buffer_nilfs_volatile(bh);\n\t\t\tclear_buffer_nilfs_redirected(bh);\n\t\t\tif (bh == segbuf->sb_super_root) {\n\t\t\t\tif (bh->b_page != bd_page) {\n\t\t\t\t\tend_page_writeback(bd_page);\n\t\t\t\t\tbd_page = bh->b_page;\n\t\t\t\t}\n\t\t\t\tupdate_sr = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (bh->b_page != fs_page) {\n\t\t\t\tnilfs_end_page_io(fs_page, 0);\n\t\t\t\tfs_page = bh->b_page;\n\t\t\t}\n\t\t}\n\n\t\tif (!nilfs_segbuf_simplex(segbuf)) {\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGBGN) {\n\t\t\t\tset_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t\t\tsci->sc_lseg_stime = jiffies;\n\t\t\t}\n\t\t\tif (segbuf->sb_sum.flags & NILFS_SS_LOGEND)\n\t\t\t\tclear_bit(NILFS_SC_UNCLOSED, &sci->sc_flags);\n\t\t}\n\t}\n\t/*\n\t * Since pages may continue over multiple segment buffers,\n\t * end of the last page must be checked outside of the loop.\n\t */\n\tif (bd_page)\n\t\tend_page_writeback(bd_page);\n\n\tnilfs_end_page_io(fs_page, 0);\n\n\tnilfs_drop_collected_inodes(&sci->sc_dirty_files);\n\n\tif (nilfs_doing_gc())\n\t\tnilfs_drop_collected_inodes(&sci->sc_gc_inodes);\n\telse\n\t\tnilfs->ns_nongc_ctime = sci->sc_seg_ctime;\n\n\tsci->sc_nblk_inc += sci->sc_nblk_this_inc;\n\n\tsegbuf = NILFS_LAST_SEGBUF(&sci->sc_write_logs);\n\tnilfs_set_next_segment(nilfs, segbuf);\n\n\tif (update_sr) {\n\t\tnilfs->ns_flushed_device = 0;\n\t\tnilfs_set_last_segment(nilfs, segbuf->sb_pseg_start,\n\t\t\t\t       segbuf->sb_sum.seg_seq, nilfs->ns_cno++);\n\n\t\tclear_bit(NILFS_SC_HAVE_DELTA, &sci->sc_flags);\n\t\tclear_bit(NILFS_SC_DIRTY, &sci->sc_flags);\n\t\tset_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n\t\tnilfs_segctor_clear_metadata_dirty(sci);\n\t} else\n\t\tclear_bit(NILFS_SC_SUPER_ROOT, &sci->sc_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structnilfs_root",
            "snapshot_kobj"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic void nilfs_snapshot_attr_release(struct kobject *kobj)\n{\n\tstruct nilfs_root *root = container_of(kobj, struct nilfs_root,\n\t\t\t\t\t\tsnapshot_kobj);\n\tcomplete(&root->snapshot_kobj_unregister);\n}"
  },
  {
    "function_name": "nilfs_snapshot_attr_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "168-178",
    "snippet": "static ssize_t nilfs_snapshot_attr_store(struct kobject *kobj,\n\t\t\t\t\t struct attribute *attr,\n\t\t\t\t\t const char *buf, size_t len)\n{\n\tstruct nilfs_root *root =\n\t\t\tcontainer_of(kobj, struct nilfs_root, snapshot_kobj);\n\tstruct nilfs_snapshot_attr *a =\n\t\t\tcontainer_of(attr, struct nilfs_snapshot_attr, attr);\n\n\treturn a->store ? a->store(a, root, buf, len) : 0;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->store",
          "args": [
            "a",
            "root",
            "buf",
            "len"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structnilfs_snapshot_attr",
            "attr"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structnilfs_root",
            "snapshot_kobj"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t nilfs_snapshot_attr_store(struct kobject *kobj,\n\t\t\t\t\t struct attribute *attr,\n\t\t\t\t\t const char *buf, size_t len)\n{\n\tstruct nilfs_root *root =\n\t\t\tcontainer_of(kobj, struct nilfs_root, snapshot_kobj);\n\tstruct nilfs_snapshot_attr *a =\n\t\t\tcontainer_of(attr, struct nilfs_snapshot_attr, attr);\n\n\treturn a->store ? a->store(a, root, buf, len) : 0;\n}"
  },
  {
    "function_name": "nilfs_snapshot_attr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "157-166",
    "snippet": "static ssize_t nilfs_snapshot_attr_show(struct kobject *kobj,\n\t\t\t\t\tstruct attribute *attr, char *buf)\n{\n\tstruct nilfs_root *root =\n\t\t\tcontainer_of(kobj, struct nilfs_root, snapshot_kobj);\n\tstruct nilfs_snapshot_attr *a =\n\t\t\tcontainer_of(attr, struct nilfs_snapshot_attr, attr);\n\n\treturn a->show ? a->show(a, root, buf) : 0;\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->show",
          "args": [
            "a",
            "root",
            "buf"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structnilfs_snapshot_attr",
            "attr"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structnilfs_root",
            "snapshot_kobj"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t nilfs_snapshot_attr_show(struct kobject *kobj,\n\t\t\t\t\tstruct attribute *attr, char *buf)\n{\n\tstruct nilfs_root *root =\n\t\t\tcontainer_of(kobj, struct nilfs_root, snapshot_kobj);\n\tstruct nilfs_snapshot_attr *a =\n\t\t\tcontainer_of(attr, struct nilfs_snapshot_attr, attr);\n\n\treturn a->show ? a->show(a, root, buf) : 0;\n}"
  },
  {
    "function_name": "nilfs_snapshot_README_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "139-144",
    "snippet": "static ssize_t\nnilfs_snapshot_README_show(struct nilfs_snapshot_attr *attr,\n\t\t\t    struct nilfs_root *root, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, snapshot_readme_str);\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char snapshot_readme_str[] =\n\t\"The group contains details about mounted snapshot.\\n\\n\"\n\t\"(1) inodes_count\\n\\tshow number of inodes for snapshot.\\n\\n\"\n\t\"(2) blocks_count\\n\\tshow number of blocks for snapshot.\\n\\n\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "snapshot_readme_str"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic const char snapshot_readme_str[] =\n\t\"The group contains details about mounted snapshot.\\n\\n\"\n\t\"(1) inodes_count\\n\\tshow number of inodes for snapshot.\\n\\n\"\n\t\"(2) blocks_count\\n\\tshow number of blocks for snapshot.\\n\\n\";\n\nstatic ssize_t\nnilfs_snapshot_README_show(struct nilfs_snapshot_attr *attr,\n\t\t\t    struct nilfs_root *root, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, snapshot_readme_str);\n}"
  },
  {
    "function_name": "nilfs_snapshot_blocks_count_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "126-132",
    "snippet": "static ssize_t\nnilfs_snapshot_blocks_count_show(struct nilfs_snapshot_attr *attr,\n\t\t\t\t struct nilfs_root *root, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)atomic64_read(&root->blocks_count));\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)atomic64_read(&root->blocks_count)"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&root->blocks_count"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_snapshot_blocks_count_show(struct nilfs_snapshot_attr *attr,\n\t\t\t\t struct nilfs_root *root, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)atomic64_read(&root->blocks_count));\n}"
  },
  {
    "function_name": "nilfs_snapshot_inodes_count_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/sysfs.c",
    "lines": "118-124",
    "snippet": "static ssize_t\nnilfs_snapshot_inodes_count_show(struct nilfs_snapshot_attr *attr,\n\t\t\t\t struct nilfs_root *root, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)atomic64_read(&root->inodes_count));\n}",
    "includes": [
      "#include \"sysfs.h\"",
      "#include \"cpfile.h\"",
      "#include \"sufile.h\"",
      "#include \"mdt.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/kobject.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "(unsigned long long)atomic64_read(&root->inodes_count)"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&root->inodes_count"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sysfs.h\"\n#include \"cpfile.h\"\n#include \"sufile.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/kobject.h>\n\nstatic ssize_t\nnilfs_snapshot_inodes_count_show(struct nilfs_snapshot_attr *attr,\n\t\t\t\t struct nilfs_root *root, char *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\",\n\t\t\t(unsigned long long)atomic64_read(&root->inodes_count));\n}"
  }
]