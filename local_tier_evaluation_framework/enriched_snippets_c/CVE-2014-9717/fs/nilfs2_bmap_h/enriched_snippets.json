[
  {
    "function_name": "nilfs_bmap_clear_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "264-267",
    "snippet": "static inline void nilfs_bmap_clear_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state &= ~NILFS_BMAP_DIRTY;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NILFS_BMAP_DIRTY\t0x00000001"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_clear_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state &= ~NILFS_BMAP_DIRTY;\n}"
  },
  {
    "function_name": "nilfs_bmap_set_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "258-261",
    "snippet": "static inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NILFS_BMAP_DIRTY\t0x00000001"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}"
  },
  {
    "function_name": "nilfs_bmap_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "252-255",
    "snippet": "static inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NILFS_BMAP_DIRTY\t0x00000001"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}"
  },
  {
    "function_name": "nilfs_bmap_set_target_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "237-242",
    "snippet": "static inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}"
  },
  {
    "function_name": "nilfs_bmap_abort_end_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "229-235",
    "snippet": "static inline void nilfs_bmap_abort_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t    union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t    struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_end(dat, &req->bpr_req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_end",
          "args": [
            "dat",
            "&req->bpr_req"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "213-230",
          "snippet": "void nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (start == nilfs_mdt_cno(dat) && blocknr == 0)\n\t\tnilfs_palloc_abort_free_entry(dat, req);\n\tnilfs_dat_abort_entry(dat, req);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_abort_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t    union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t    struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_end(dat, &req->bpr_req);\n}"
  },
  {
    "function_name": "nilfs_bmap_commit_end_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "220-227",
    "snippet": "static inline void nilfs_bmap_commit_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_end(dat, &req->bpr_req,\n\t\t\t\t     bmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NILFS_BMAP_PTR_VS\t1\t/* virtual block number (single\n\t\t\t\t\t   version) */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_end",
          "args": [
            "dat",
            "&req->bpr_req",
            "bmap->b_ptr_type == NILFS_BMAP_PTR_VS"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "187-211",
          "snippet": "void nilfs_dat_commit_end(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t  int dead)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start, end;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tend = start = le64_to_cpu(entry->de_start);\n\tif (!dead) {\n\t\tend = nilfs_mdt_cno(dat);\n\t\tWARN_ON(start > end);\n\t}\n\tentry->de_end = cpu_to_le64(end);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0)\n\t\tnilfs_dat_commit_free(dat, req);\n\telse\n\t\tnilfs_dat_commit_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_end(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t  int dead)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start, end;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tend = start = le64_to_cpu(entry->de_start);\n\tif (!dead) {\n\t\tend = nilfs_mdt_cno(dat);\n\t\tWARN_ON(start > end);\n\t}\n\tentry->de_end = cpu_to_le64(end);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0)\n\t\tnilfs_dat_commit_free(dat, req);\n\telse\n\t\tnilfs_dat_commit_entry(dat, req);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_PTR_VS\t1\t/* virtual block number (single\n\t\t\t\t\t   version) */\n\nstatic inline void nilfs_bmap_commit_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_end(dat, &req->bpr_req,\n\t\t\t\t     bmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n}"
  },
  {
    "function_name": "nilfs_bmap_prepare_end_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "213-218",
    "snippet": "static inline int nilfs_bmap_prepare_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\treturn dat ? nilfs_dat_prepare_end(dat, &req->bpr_req) : 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_end",
          "args": [
            "dat",
            "&req->bpr_req"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "155-185",
          "snippet": "int nilfs_dat_prepare_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\treturn ret;\n\t}\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0) {\n\t\tret = nilfs_palloc_prepare_free_entry(dat, req);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_entry(dat, req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_end(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\t__u64 start;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\treturn ret;\n\t}\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tstart = le64_to_cpu(entry->de_start);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tkunmap_atomic(kaddr);\n\n\tif (blocknr == 0) {\n\t\tret = nilfs_palloc_prepare_free_entry(dat, req);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_entry(dat, req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\treturn dat ? nilfs_dat_prepare_end(dat, &req->bpr_req) : 0;\n}"
  },
  {
    "function_name": "nilfs_bmap_abort_alloc_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "203-211",
    "snippet": "static inline void nilfs_bmap_abort_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t      union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t      struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_alloc(dat, &req->bpr_req);\n\telse\n\t\tbmap->b_last_allocated_ptr--;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_alloc",
          "args": [
            "dat",
            "&req->bpr_req"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "106-110",
          "snippet": "void nilfs_dat_abort_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tnilfs_dat_abort_entry(dat, req);\n\tnilfs_palloc_abort_alloc_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tnilfs_dat_abort_entry(dat, req);\n\tnilfs_palloc_abort_alloc_entry(dat, req);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_abort_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t      union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t      struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_alloc(dat, &req->bpr_req);\n\telse\n\t\tbmap->b_last_allocated_ptr--;\n}"
  },
  {
    "function_name": "nilfs_bmap_commit_alloc_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "195-201",
    "snippet": "static inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_commit_alloc",
          "args": [
            "dat",
            "&req->bpr_req"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "89-104",
          "snippet": "void nilfs_dat_commit_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MAX);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_palloc_commit_alloc_entry(dat, req);\n\tnilfs_dat_commit_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_CNO_MAX\t(~(__u64)0)",
            "#define NILFS_CNO_MIN\t((__u64)1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\n#define NILFS_CNO_MAX\t(~(__u64)0)\n#define NILFS_CNO_MIN\t((__u64)1)\n\nvoid nilfs_dat_commit_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(NILFS_CNO_MIN);\n\tentry->de_end = cpu_to_le64(NILFS_CNO_MAX);\n\tentry->de_blocknr = cpu_to_le64(0);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_palloc_commit_alloc_entry(dat, req);\n\tnilfs_dat_commit_entry(dat, req);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}"
  },
  {
    "function_name": "nilfs_bmap_prepare_alloc_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "184-193",
    "snippet": "static inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_alloc",
          "args": [
            "dat",
            "&req->bpr_req"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "74-87",
          "snippet": "int nilfs_dat_prepare_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_palloc_prepare_alloc_entry(dat, req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 1);\n\tif (ret < 0)\n\t\tnilfs_palloc_abort_alloc_entry(dat, req);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_alloc(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_palloc_prepare_alloc_entry(dat, req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 1);\n\tif (ret < 0)\n\t\tnilfs_palloc_abort_alloc_entry(dat, req);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_bmap_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "173-177",
    "snippet": "static inline int nilfs_bmap_lookup(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t    __u64 *ptr)\n{\n\treturn nilfs_bmap_lookup_at_level(bmap, key, 1, ptr);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_lookup_at_level",
          "args": [
            "bmap",
            "key",
            "1",
            "ptr"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_lookup_at_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "75-97",
          "snippet": "int nilfs_bmap_lookup_at_level(struct nilfs_bmap *bmap, __u64 key, int level,\n\t\t\t       __u64 *ptrp)\n{\n\tsector_t blocknr;\n\tint ret;\n\n\tdown_read(&bmap->b_sem);\n\tret = bmap->b_ops->bop_lookup(bmap, key, level, ptrp);\n\tif (ret < 0) {\n\t\tret = nilfs_bmap_convert_error(bmap, __func__, ret);\n\t\tgoto out;\n\t}\n\tif (NILFS_BMAP_USE_VBN(bmap)) {\n\t\tret = nilfs_dat_translate(nilfs_bmap_get_dat(bmap), *ptrp,\n\t\t\t\t\t  &blocknr);\n\t\tif (!ret)\n\t\t\t*ptrp = blocknr;\n\t}\n\n out:\n\tup_read(&bmap->b_sem);\n\treturn ret;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nint nilfs_bmap_lookup_at_level(struct nilfs_bmap *bmap, __u64 key, int level,\n\t\t\t       __u64 *ptrp)\n{\n\tsector_t blocknr;\n\tint ret;\n\n\tdown_read(&bmap->b_sem);\n\tret = bmap->b_ops->bop_lookup(bmap, key, level, ptrp);\n\tif (ret < 0) {\n\t\tret = nilfs_bmap_convert_error(bmap, __func__, ret);\n\t\tgoto out;\n\t}\n\tif (NILFS_BMAP_USE_VBN(bmap)) {\n\t\tret = nilfs_dat_translate(nilfs_bmap_get_dat(bmap), *ptrp,\n\t\t\t\t\t  &blocknr);\n\t\tif (!ret)\n\t\t\t*ptrp = blocknr;\n\t}\n\n out:\n\tup_read(&bmap->b_sem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_lookup(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t    __u64 *ptr)\n{\n\treturn nilfs_bmap_lookup_at_level(bmap, key, 1, ptr);\n}"
  },
  {
    "function_name": "nilfs_bmap_is_new_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
    "lines": "92-95",
    "snippet": "static inline int nilfs_bmap_is_new_ptr(unsigned long ptr)\n{\n\treturn !!(ptr & NILFS_BMAP_NEW_PTR_INIT);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include <linux/nilfs2_fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_is_new_ptr(unsigned long ptr)\n{\n\treturn !!(ptr & NILFS_BMAP_NEW_PTR_INIT);\n}"
  }
]