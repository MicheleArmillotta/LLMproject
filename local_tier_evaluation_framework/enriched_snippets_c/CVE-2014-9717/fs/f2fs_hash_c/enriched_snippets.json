[
  {
    "function_name": "f2fs_dentry_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/hash.c",
    "lines": "73-104",
    "snippet": "f2fs_hash_t f2fs_dentry_hash(const struct qstr *name_info)\n{\n\t__u32 hash;\n\tf2fs_hash_t f2fs_hash;\n\tconst unsigned char *p;\n\t__u32 in[8], buf[4];\n\tconst unsigned char *name = name_info->name;\n\tsize_t len = name_info->len;\n\n\tif ((len <= 2) && (name[0] == '.') &&\n\t\t(name[1] == '.' || name[1] == '\\0'))\n\t\treturn 0;\n\n\t/* Initialize the default seed for the hash checksum functions */\n\tbuf[0] = 0x67452301;\n\tbuf[1] = 0xefcdab89;\n\tbuf[2] = 0x98badcfe;\n\tbuf[3] = 0x10325476;\n\n\tp = name;\n\twhile (1) {\n\t\tstr2hashbuf(p, len, in, 4);\n\t\tTEA_transform(buf, in);\n\t\tp += 16;\n\t\tif (len <= 16)\n\t\t\tbreak;\n\t\tlen -= 16;\n\t}\n\thash = buf[0];\n\tf2fs_hash = cpu_to_le32(hash & ~F2FS_HASH_COL_BIT);\n\treturn f2fs_hash;\n}",
    "includes": [
      "#include \"f2fs.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/cryptohash.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "hash & ~F2FS_HASH_COL_BIT"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEA_transform",
          "args": [
            "buf",
            "in"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "TEA_transform",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/hash.c",
          "lines": "28-43",
          "snippet": "static void TEA_transform(unsigned int buf[4], unsigned int const in[])\n{\n\t__u32 sum = 0;\n\t__u32 b0 = buf[0], b1 = buf[1];\n\t__u32 a = in[0], b = in[1], c = in[2], d = in[3];\n\tint n = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}",
          "includes": [
            "#include \"f2fs.h\"",
            "#include <linux/pagemap.h>",
            "#include <linux/cryptohash.h>",
            "#include <linux/f2fs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define DELTA 0x9E3779B9"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"f2fs.h\"\n#include <linux/pagemap.h>\n#include <linux/cryptohash.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define DELTA 0x9E3779B9\n\nstatic void TEA_transform(unsigned int buf[4], unsigned int const in[])\n{\n\t__u32 sum = 0;\n\t__u32 b0 = buf[0], b1 = buf[1];\n\t__u32 a = in[0], b = in[1], c = in[2], d = in[3];\n\tint n = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "str2hashbuf",
          "args": [
            "p",
            "len",
            "in",
            "4"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "str2hashbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/hash.c",
          "lines": "45-71",
          "snippet": "static void str2hashbuf(const unsigned char *msg, size_t len,\n\t\t\t\tunsigned int *buf, int num)\n{\n\tunsigned pad, val;\n\tint i;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num * 4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = msg[i] + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}",
          "includes": [
            "#include \"f2fs.h\"",
            "#include <linux/pagemap.h>",
            "#include <linux/cryptohash.h>",
            "#include <linux/f2fs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"f2fs.h\"\n#include <linux/pagemap.h>\n#include <linux/cryptohash.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic void str2hashbuf(const unsigned char *msg, size_t len,\n\t\t\t\tunsigned int *buf, int num)\n{\n\tunsigned pad, val;\n\tint i;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num * 4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = msg[i] + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"f2fs.h\"\n#include <linux/pagemap.h>\n#include <linux/cryptohash.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nf2fs_hash_t f2fs_dentry_hash(const struct qstr *name_info)\n{\n\t__u32 hash;\n\tf2fs_hash_t f2fs_hash;\n\tconst unsigned char *p;\n\t__u32 in[8], buf[4];\n\tconst unsigned char *name = name_info->name;\n\tsize_t len = name_info->len;\n\n\tif ((len <= 2) && (name[0] == '.') &&\n\t\t(name[1] == '.' || name[1] == '\\0'))\n\t\treturn 0;\n\n\t/* Initialize the default seed for the hash checksum functions */\n\tbuf[0] = 0x67452301;\n\tbuf[1] = 0xefcdab89;\n\tbuf[2] = 0x98badcfe;\n\tbuf[3] = 0x10325476;\n\n\tp = name;\n\twhile (1) {\n\t\tstr2hashbuf(p, len, in, 4);\n\t\tTEA_transform(buf, in);\n\t\tp += 16;\n\t\tif (len <= 16)\n\t\t\tbreak;\n\t\tlen -= 16;\n\t}\n\thash = buf[0];\n\tf2fs_hash = cpu_to_le32(hash & ~F2FS_HASH_COL_BIT);\n\treturn f2fs_hash;\n}"
  },
  {
    "function_name": "str2hashbuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/hash.c",
    "lines": "45-71",
    "snippet": "static void str2hashbuf(const unsigned char *msg, size_t len,\n\t\t\t\tunsigned int *buf, int num)\n{\n\tunsigned pad, val;\n\tint i;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num * 4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = msg[i] + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}",
    "includes": [
      "#include \"f2fs.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/cryptohash.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"f2fs.h\"\n#include <linux/pagemap.h>\n#include <linux/cryptohash.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic void str2hashbuf(const unsigned char *msg, size_t len,\n\t\t\t\tunsigned int *buf, int num)\n{\n\tunsigned pad, val;\n\tint i;\n\n\tpad = (__u32)len | ((__u32)len << 8);\n\tpad |= pad << 16;\n\n\tval = pad;\n\tif (len > num * 4)\n\t\tlen = num * 4;\n\tfor (i = 0; i < len; i++) {\n\t\tif ((i % 4) == 0)\n\t\t\tval = pad;\n\t\tval = msg[i] + (val << 8);\n\t\tif ((i % 4) == 3) {\n\t\t\t*buf++ = val;\n\t\t\tval = pad;\n\t\t\tnum--;\n\t\t}\n\t}\n\tif (--num >= 0)\n\t\t*buf++ = val;\n\twhile (--num >= 0)\n\t\t*buf++ = pad;\n}"
  },
  {
    "function_name": "TEA_transform",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/hash.c",
    "lines": "28-43",
    "snippet": "static void TEA_transform(unsigned int buf[4], unsigned int const in[])\n{\n\t__u32 sum = 0;\n\t__u32 b0 = buf[0], b1 = buf[1];\n\t__u32 a = in[0], b = in[1], c = in[2], d = in[3];\n\tint n = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}",
    "includes": [
      "#include \"f2fs.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/cryptohash.h>",
      "#include <linux/f2fs_fs.h>",
      "#include <linux/fs.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define DELTA 0x9E3779B9"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"f2fs.h\"\n#include <linux/pagemap.h>\n#include <linux/cryptohash.h>\n#include <linux/f2fs_fs.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define DELTA 0x9E3779B9\n\nstatic void TEA_transform(unsigned int buf[4], unsigned int const in[])\n{\n\t__u32 sum = 0;\n\t__u32 b0 = buf[0], b1 = buf[1];\n\t__u32 a = in[0], b = in[1], c = in[2], d = in[3];\n\tint n = 16;\n\n\tdo {\n\t\tsum += DELTA;\n\t\tb0 += ((b1 << 4)+a) ^ (b1+sum) ^ ((b1 >> 5)+b);\n\t\tb1 += ((b0 << 4)+c) ^ (b0+sum) ^ ((b0 >> 5)+d);\n\t} while (--n);\n\n\tbuf[0] += b0;\n\tbuf[1] += b1;\n}"
  }
]