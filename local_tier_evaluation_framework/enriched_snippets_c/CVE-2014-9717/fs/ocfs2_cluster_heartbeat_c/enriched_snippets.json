[
  {
    "function_name": "o2hb_global_heartbeat_active",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2674-2677",
    "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
  },
  {
    "function_name": "o2hb_get_all_regions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2646-2671",
    "snippet": "int o2hb_get_all_regions(char *region_uuids, u8 max_regions)\n{\n\tstruct o2hb_region *reg;\n\tint numregs = 0;\n\tchar *p;\n\n\tspin_lock(&o2hb_live_lock);\n\n\tp = region_uuids;\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tmlog(0, \"Region: %s\\n\", config_item_name(&reg->hr_item));\n\t\tif (numregs < max_regions) {\n\t\t\tmemcpy(p, config_item_name(&reg->hr_item),\n\t\t\t       O2HB_MAX_REGION_NAME_LEN);\n\t\t\tp += O2HB_MAX_REGION_NAME_LEN;\n\t\t}\n\t\tnumregs++;\n\t}\n\n\tspin_unlock(&o2hb_live_lock);\n\n\treturn numregs;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_all_regions);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2668
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "p",
            "config_item_name(&reg->hr_item)",
            "O2HB_MAX_REGION_NAME_LEN"
          ],
          "line": 2661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "0",
            "\"Region: %s\\n\"",
            "config_item_name(&reg->hr_item)"
          ],
          "line": 2659
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "reg",
            "&o2hb_all_regions",
            "hr_all_item"
          ],
          "line": 2655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2652
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\n\nint o2hb_get_all_regions(char *region_uuids, u8 max_regions)\n{\n\tstruct o2hb_region *reg;\n\tint numregs = 0;\n\tchar *p;\n\n\tspin_lock(&o2hb_live_lock);\n\n\tp = region_uuids;\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tmlog(0, \"Region: %s\\n\", config_item_name(&reg->hr_item));\n\t\tif (numregs < max_regions) {\n\t\t\tmemcpy(p, config_item_name(&reg->hr_item),\n\t\t\t       O2HB_MAX_REGION_NAME_LEN);\n\t\t\tp += O2HB_MAX_REGION_NAME_LEN;\n\t\t}\n\t\tnumregs++;\n\t}\n\n\tspin_unlock(&o2hb_live_lock);\n\n\treturn numregs;\n}"
  },
  {
    "function_name": "o2hb_stop_all_regions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2631-2643",
    "snippet": "void o2hb_stop_all_regions(void)\n{\n\tstruct o2hb_region *reg;\n\n\tmlog(ML_ERROR, \"stopping heartbeat on all active regions.\\n\");\n\n\tspin_lock(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item)\n\t\treg->hr_unclean_stop = 1;\n\n\tspin_unlock(&o2hb_live_lock);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_all_regions);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2642
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "reg",
            "&o2hb_all_regions",
            "hr_all_item"
          ],
          "line": 2639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2637
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"stopping heartbeat on all active regions.\\n\""
          ],
          "line": 2635
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "36-48",
          "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\n\nvoid o2hb_stop_all_regions(void)\n{\n\tstruct o2hb_region *reg;\n\n\tmlog(ML_ERROR, \"stopping heartbeat on all active regions.\\n\");\n\n\tspin_lock(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item)\n\t\treg->hr_unclean_stop = 1;\n\n\tspin_unlock(&o2hb_live_lock);\n}"
  },
  {
    "function_name": "o2hb_check_local_node_heartbeating",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2612-2624",
    "snippet": "int o2hb_check_local_node_heartbeating(void)\n{\n\tu8 node_num;\n\n\t/* if this node was set then we have networking */\n\tnode_num = o2nm_this_node();\n\tif (node_num == O2NM_MAX_NODES) {\n\t\tmlog(ML_HEARTBEAT, \"this node has not been configured.\\n\");\n\t\treturn 0;\n\t}\n\n\treturn o2hb_check_node_heartbeating(node_num);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_check_node_heartbeating",
          "args": [
            "node_num"
          ],
          "line": 2623
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_check_node_heartbeating_from_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2594-2607",
          "snippet": "int o2hb_check_node_heartbeating_from_callback(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\n\to2hb_fill_node_map_from_callback(testing_map, sizeof(testing_map));\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nint o2hb_check_node_heartbeating_from_callback(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\n\to2hb_fill_node_map_from_callback(testing_map, sizeof(testing_map));\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"this node has not been configured.\\n\""
          ],
          "line": 2619
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "36-48",
          "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_this_node",
          "args": [],
          "line": 2617
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "143-151",
          "snippet": "u8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nu8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nint o2hb_check_local_node_heartbeating(void)\n{\n\tu8 node_num;\n\n\t/* if this node was set then we have networking */\n\tnode_num = o2nm_this_node();\n\tif (node_num == O2NM_MAX_NODES) {\n\t\tmlog(ML_HEARTBEAT, \"this node has not been configured.\\n\");\n\t\treturn 0;\n\t}\n\n\treturn o2hb_check_node_heartbeating(node_num);\n}"
  },
  {
    "function_name": "o2hb_check_node_heartbeating_from_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2594-2607",
    "snippet": "int o2hb_check_node_heartbeating_from_callback(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\n\to2hb_fill_node_map_from_callback(testing_map, sizeof(testing_map));\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"node (%u) does not have heartbeating enabled.\\n\"",
            "node_num"
          ],
          "line": 2600
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node_num",
            "testing_map"
          ],
          "line": 2599
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_fill_node_map_from_callback",
          "args": [
            "testing_map",
            "sizeof(testing_map)"
          ],
          "line": 2598
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_fill_node_map_from_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1406-1412",
          "snippet": "static void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\nstatic void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nint o2hb_check_node_heartbeating_from_callback(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\n\to2hb_fill_node_map_from_callback(testing_map, sizeof(testing_map));\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "o2hb_check_node_heartbeating_no_sem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2575-2591",
    "snippet": "int o2hb_check_node_heartbeating_no_sem(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&o2hb_live_lock, flags);\n\to2hb_fill_node_map_from_callback(testing_map, sizeof(testing_map));\n\tspin_unlock_irqrestore(&o2hb_live_lock, flags);\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"node (%u) does not have heartbeating enabled.\\n\"",
            "node_num"
          ],
          "line": 2584
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node_num",
            "testing_map"
          ],
          "line": 2583
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&o2hb_live_lock",
            "flags"
          ],
          "line": 2582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_fill_node_map_from_callback",
          "args": [
            "testing_map",
            "sizeof(testing_map)"
          ],
          "line": 2581
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_fill_node_map_from_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1406-1412",
          "snippet": "static void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\nstatic void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&o2hb_live_lock",
            "flags"
          ],
          "line": 2580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 2577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nint o2hb_check_node_heartbeating_no_sem(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&o2hb_live_lock, flags);\n\to2hb_fill_node_map_from_callback(testing_map, sizeof(testing_map));\n\tspin_unlock_irqrestore(&o2hb_live_lock, flags);\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "o2hb_check_node_heartbeating",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2559-2572",
    "snippet": "int o2hb_check_node_heartbeating(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\n\to2hb_fill_node_map(testing_map, sizeof(testing_map));\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"node (%u) does not have heartbeating enabled.\\n\"",
            "node_num"
          ],
          "line": 2565
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "node_num",
            "testing_map"
          ],
          "line": 2564
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_fill_node_map",
          "args": [
            "testing_map",
            "sizeof(testing_map)"
          ],
          "line": 2563
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_fill_node_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1417-1426",
          "snippet": "void o2hb_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\t/* callers want to serialize this map and callbacks so that they\n\t * can trust that they don't miss nodes coming to the party */\n\tdown_read(&o2hb_callback_sem);\n\tspin_lock(&o2hb_live_lock);\n\to2hb_fill_node_map_from_callback(map, bytes);\n\tspin_unlock(&o2hb_live_lock);\n\tup_read(&o2hb_callback_sem);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_RWSEM(o2hb_callback_sem);",
            "static DEFINE_SPINLOCK(o2hb_live_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nvoid o2hb_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\t/* callers want to serialize this map and callbacks so that they\n\t * can trust that they don't miss nodes coming to the party */\n\tdown_read(&o2hb_callback_sem);\n\tspin_lock(&o2hb_live_lock);\n\to2hb_fill_node_map_from_callback(map, bytes);\n\tspin_unlock(&o2hb_live_lock);\n\tup_read(&o2hb_callback_sem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 2561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nint o2hb_check_node_heartbeating(u8 node_num)\n{\n\tunsigned long testing_map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\n\to2hb_fill_node_map(testing_map, sizeof(testing_map));\n\tif (!test_bit(node_num, testing_map)) {\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"node (%u) does not have heartbeating enabled.\\n\",\n\t\t     node_num);\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "o2hb_unregister_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2536-2556",
    "snippet": "void o2hb_unregister_callback(const char *region_uuid,\n\t\t\t      struct o2hb_callback_func *hc)\n{\n\tBUG_ON(hc->hc_magic != O2HB_CB_MAGIC);\n\n\tmlog(ML_CLUSTER, \"on behalf of %p for funcs %p\\n\",\n\t     __builtin_return_address(0), hc);\n\n\t/* XXX Can this happen _with_ a region reference? */\n\tif (list_empty(&hc->hc_item))\n\t\treturn;\n\n\tif (region_uuid)\n\t\to2hb_region_dec_user(region_uuid);\n\n\tdown_write(&o2hb_callback_sem);\n\n\tlist_del_init(&hc->hc_item);\n\n\tup_write(&o2hb_callback_sem);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_RWSEM(o2hb_callback_sem);",
      "static int o2hb_region_pin(const char *region_uuid);",
      "static void o2hb_region_unpin(const char *region_uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_write",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 2555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&hc->hc_item"
          ],
          "line": 2553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_write",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 2551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_region_dec_user",
          "args": [
            "region_uuid"
          ],
          "line": 2549
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_region_dec_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2470-2490",
          "snippet": "void o2hb_region_dec_user(const char *region_uuid)\n{\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    o2hb_region_unpin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and there are no dependent users,\n\t * unpin all quorum regions\n\t */\n\to2hb_dependent_users--;\n\tif (!o2hb_dependent_users)\n\t\to2hb_region_unpin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "unsigned int o2hb_dependent_users;",
            "static int o2hb_region_pin(const char *region_uuid);",
            "static void o2hb_region_unpin(const char *region_uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nunsigned int o2hb_dependent_users;\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nvoid o2hb_region_dec_user(const char *region_uuid)\n{\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    o2hb_region_unpin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and there are no dependent users,\n\t * unpin all quorum regions\n\t */\n\to2hb_dependent_users--;\n\tif (!o2hb_dependent_users)\n\t\to2hb_region_unpin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&hc->hc_item"
          ],
          "line": 2545
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_CLUSTER",
            "\"on behalf of %p for funcs %p\\n\"",
            "__builtin_return_address(0)",
            "hc"
          ],
          "line": 2541
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__builtin_return_address",
          "args": [
            "0"
          ],
          "line": 2542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "hc->hc_magic != O2HB_CB_MAGIC"
          ],
          "line": 2539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nvoid o2hb_unregister_callback(const char *region_uuid,\n\t\t\t      struct o2hb_callback_func *hc)\n{\n\tBUG_ON(hc->hc_magic != O2HB_CB_MAGIC);\n\n\tmlog(ML_CLUSTER, \"on behalf of %p for funcs %p\\n\",\n\t     __builtin_return_address(0), hc);\n\n\t/* XXX Can this happen _with_ a region reference? */\n\tif (list_empty(&hc->hc_item))\n\t\treturn;\n\n\tif (region_uuid)\n\t\to2hb_region_dec_user(region_uuid);\n\n\tdown_write(&o2hb_callback_sem);\n\n\tlist_del_init(&hc->hc_item);\n\n\tup_write(&o2hb_callback_sem);\n}"
  },
  {
    "function_name": "o2hb_register_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2492-2533",
    "snippet": "int o2hb_register_callback(const char *region_uuid,\n\t\t\t   struct o2hb_callback_func *hc)\n{\n\tstruct o2hb_callback_func *f;\n\tstruct o2hb_callback *hbcall;\n\tint ret;\n\n\tBUG_ON(hc->hc_magic != O2HB_CB_MAGIC);\n\tBUG_ON(!list_empty(&hc->hc_item));\n\n\thbcall = hbcall_from_type(hc->hc_type);\n\tif (IS_ERR(hbcall)) {\n\t\tret = PTR_ERR(hbcall);\n\t\tgoto out;\n\t}\n\n\tif (region_uuid) {\n\t\tret = o2hb_region_inc_user(region_uuid);\n\t\tif (ret) {\n\t\t\tmlog_errno(ret);\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tdown_write(&o2hb_callback_sem);\n\n\tlist_for_each_entry(f, &hbcall->list, hc_item) {\n\t\tif (hc->hc_priority < f->hc_priority) {\n\t\t\tlist_add_tail(&hc->hc_item, &f->hc_item);\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (list_empty(&hc->hc_item))\n\t\tlist_add_tail(&hc->hc_item, &hbcall->list);\n\n\tup_write(&o2hb_callback_sem);\n\tret = 0;\nout:\n\tmlog(ML_CLUSTER, \"returning %d on behalf of %p for funcs %p\\n\",\n\t     ret, __builtin_return_address(0), hc);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_RWSEM(o2hb_callback_sem);",
      "static int o2hb_region_pin(const char *region_uuid);",
      "static void o2hb_region_unpin(const char *region_uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_CLUSTER",
            "\"returning %d on behalf of %p for funcs %p\\n\"",
            "ret",
            "__builtin_return_address(0)",
            "hc"
          ],
          "line": 2530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__builtin_return_address",
          "args": [
            "0"
          ],
          "line": 2531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_write",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 2527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&hc->hc_item",
            "&hbcall->list"
          ],
          "line": 2525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&hc->hc_item"
          ],
          "line": 2524
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&hc->hc_item",
            "&f->hc_item"
          ],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "f",
            "&hbcall->list",
            "hc_item"
          ],
          "line": 2518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_write",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 2516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 2511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_region_inc_user",
          "args": [
            "region_uuid"
          ],
          "line": 2509
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_region_inc_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2441-2468",
          "snippet": "static int o2hb_region_inc_user(const char *region_uuid)\n{\n\tint ret = 0;\n\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    ret = o2hb_region_pin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and this is the first dependent user,\n\t * pin all regions if quorum region count <= CUT_OFF\n\t */\n\to2hb_dependent_users++;\n\tif (o2hb_dependent_users > 1)\n\t\tgoto unlock;\n\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) <= O2HB_PIN_CUT_OFF)\n\t\tret = o2hb_region_pin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define O2HB_PIN_CUT_OFF\t\t3"
          ],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
            "unsigned int o2hb_dependent_users;",
            "static int o2hb_region_pin(const char *region_uuid);",
            "static void o2hb_region_unpin(const char *region_uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_PIN_CUT_OFF\t\t3\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nunsigned int o2hb_dependent_users;\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic int o2hb_region_inc_user(const char *region_uuid)\n{\n\tint ret = 0;\n\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    ret = o2hb_region_pin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and this is the first dependent user,\n\t * pin all regions if quorum region count <= CUT_OFF\n\t */\n\to2hb_dependent_users++;\n\tif (o2hb_dependent_users > 1)\n\t\tgoto unlock;\n\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) <= O2HB_PIN_CUT_OFF)\n\t\tret = o2hb_region_pin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "hbcall"
          ],
          "line": 2504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "hbcall"
          ],
          "line": 2503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hbcall_from_type",
          "args": [
            "hc->hc_type"
          ],
          "line": 2502
        },
        "resolved": true,
        "details": {
          "function_name": "hbcall_from_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2329-2335",
          "snippet": "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type)\n{\n\tif (type == O2HB_NUM_CB)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn &o2hb_callbacks[type];\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];",
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type)\n{\n\tif (type == O2HB_NUM_CB)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn &o2hb_callbacks[type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!list_empty(&hc->hc_item)"
          ],
          "line": 2500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "hc->hc_magic != O2HB_CB_MAGIC"
          ],
          "line": 2499
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nint o2hb_register_callback(const char *region_uuid,\n\t\t\t   struct o2hb_callback_func *hc)\n{\n\tstruct o2hb_callback_func *f;\n\tstruct o2hb_callback *hbcall;\n\tint ret;\n\n\tBUG_ON(hc->hc_magic != O2HB_CB_MAGIC);\n\tBUG_ON(!list_empty(&hc->hc_item));\n\n\thbcall = hbcall_from_type(hc->hc_type);\n\tif (IS_ERR(hbcall)) {\n\t\tret = PTR_ERR(hbcall);\n\t\tgoto out;\n\t}\n\n\tif (region_uuid) {\n\t\tret = o2hb_region_inc_user(region_uuid);\n\t\tif (ret) {\n\t\t\tmlog_errno(ret);\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tdown_write(&o2hb_callback_sem);\n\n\tlist_for_each_entry(f, &hbcall->list, hc_item) {\n\t\tif (hc->hc_priority < f->hc_priority) {\n\t\t\tlist_add_tail(&hc->hc_item, &f->hc_item);\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (list_empty(&hc->hc_item))\n\t\tlist_add_tail(&hc->hc_item, &hbcall->list);\n\n\tup_write(&o2hb_callback_sem);\n\tret = 0;\nout:\n\tmlog(ML_CLUSTER, \"returning %d on behalf of %p for funcs %p\\n\",\n\t     ret, __builtin_return_address(0), hc);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_region_dec_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2470-2490",
    "snippet": "void o2hb_region_dec_user(const char *region_uuid)\n{\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    o2hb_region_unpin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and there are no dependent users,\n\t * unpin all quorum regions\n\t */\n\to2hb_dependent_users--;\n\tif (!o2hb_dependent_users)\n\t\to2hb_region_unpin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "unsigned int o2hb_dependent_users;",
      "static int o2hb_region_pin(const char *region_uuid);",
      "static void o2hb_region_unpin(const char *region_uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2489
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_region_unpin",
          "args": [
            "NULL"
          ],
          "line": 2486
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_region_unpin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2412-2439",
          "snippet": "static void o2hb_region_unpin(const char *region_uuid)\n{\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\tint found = 0;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned) {\n\t\t\tmlog(ML_CLUSTER, \"Unpin region %s\\n\", uuid);\n\t\t\to2nm_undepend_item(&reg->hr_item);\n\t\t\treg->hr_item_pinned = 0;\n\t\t}\n\t\tif (found)\n\t\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);",
            "static int o2hb_region_pin(const char *region_uuid);",
            "static void o2hb_region_unpin(const char *region_uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic void o2hb_region_unpin(const char *region_uuid)\n{\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\tint found = 0;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned) {\n\t\t\tmlog(ML_CLUSTER, \"Unpin region %s\\n\", uuid);\n\t\t\to2nm_undepend_item(&reg->hr_item);\n\t\t\treg->hr_item_pinned = 0;\n\t\t}\n\t\tif (found)\n\t\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 2475
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2472
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nunsigned int o2hb_dependent_users;\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nvoid o2hb_region_dec_user(const char *region_uuid)\n{\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    o2hb_region_unpin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and there are no dependent users,\n\t * unpin all quorum regions\n\t */\n\to2hb_dependent_users--;\n\tif (!o2hb_dependent_users)\n\t\to2hb_region_unpin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}"
  },
  {
    "function_name": "o2hb_region_inc_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2441-2468",
    "snippet": "static int o2hb_region_inc_user(const char *region_uuid)\n{\n\tint ret = 0;\n\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    ret = o2hb_region_pin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and this is the first dependent user,\n\t * pin all regions if quorum region count <= CUT_OFF\n\t */\n\to2hb_dependent_users++;\n\tif (o2hb_dependent_users > 1)\n\t\tgoto unlock;\n\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) <= O2HB_PIN_CUT_OFF)\n\t\tret = o2hb_region_pin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define O2HB_PIN_CUT_OFF\t\t3"
    ],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "unsigned int o2hb_dependent_users;",
      "static int o2hb_region_pin(const char *region_uuid);",
      "static void o2hb_region_unpin(const char *region_uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2466
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_region_pin",
          "args": [
            "NULL"
          ],
          "line": 2463
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_region_pin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2359-2403",
          "snippet": "static int o2hb_region_pin(const char *region_uuid)\n{\n\tint ret = 0, found = 0;\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\n\t\t/* local heartbeat */\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned || reg->hr_item_dropped)\n\t\t\tgoto skip_pin;\n\n\t\t/* Ignore ENOENT only for local hb (userdlm domain) */\n\t\tret = o2nm_depend_item(&reg->hr_item);\n\t\tif (!ret) {\n\t\t\tmlog(ML_CLUSTER, \"Pin region %s\\n\", uuid);\n\t\t\treg->hr_item_pinned = 1;\n\t\t} else {\n\t\t\tif (ret == -ENOENT && found)\n\t\t\t\tret = 0;\n\t\t\telse {\n\t\t\t\tmlog(ML_ERROR, \"Pin region %s fails with %d\\n\",\n\t\t\t\t     uuid, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\nskip_pin:\n\t\tif (found)\n\t\t\tbreak;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);",
            "static int o2hb_region_pin(const char *region_uuid);",
            "static void o2hb_region_unpin(const char *region_uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic int o2hb_region_pin(const char *region_uuid)\n{\n\tint ret = 0, found = 0;\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\n\t\t/* local heartbeat */\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned || reg->hr_item_dropped)\n\t\t\tgoto skip_pin;\n\n\t\t/* Ignore ENOENT only for local hb (userdlm domain) */\n\t\tret = o2nm_depend_item(&reg->hr_item);\n\t\tif (!ret) {\n\t\t\tmlog(ML_CLUSTER, \"Pin region %s\\n\", uuid);\n\t\t\treg->hr_item_pinned = 1;\n\t\t} else {\n\t\t\tif (ret == -ENOENT && found)\n\t\t\t\tret = 0;\n\t\t\telse {\n\t\t\t\tmlog(ML_ERROR, \"Pin region %s fails with %d\\n\",\n\t\t\t\t     uuid, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\nskip_pin:\n\t\tif (found)\n\t\t\tbreak;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_weight",
          "args": [
            "o2hb_quorum_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 2461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 2448
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2445
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_PIN_CUT_OFF\t\t3\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nunsigned int o2hb_dependent_users;\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic int o2hb_region_inc_user(const char *region_uuid)\n{\n\tint ret = 0;\n\n\tspin_lock(&o2hb_live_lock);\n\n\t/* local heartbeat */\n\tif (!o2hb_global_heartbeat_active()) {\n\t    ret = o2hb_region_pin(region_uuid);\n\t    goto unlock;\n\t}\n\n\t/*\n\t * if global heartbeat active and this is the first dependent user,\n\t * pin all regions if quorum region count <= CUT_OFF\n\t */\n\to2hb_dependent_users++;\n\tif (o2hb_dependent_users > 1)\n\t\tgoto unlock;\n\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) <= O2HB_PIN_CUT_OFF)\n\t\tret = o2hb_region_pin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_region_unpin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2412-2439",
    "snippet": "static void o2hb_region_unpin(const char *region_uuid)\n{\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\tint found = 0;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned) {\n\t\t\tmlog(ML_CLUSTER, \"Unpin region %s\\n\", uuid);\n\t\t\to2nm_undepend_item(&reg->hr_item);\n\t\t\treg->hr_item_pinned = 0;\n\t\t}\n\t\tif (found)\n\t\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_all_regions);",
      "static int o2hb_region_pin(const char *region_uuid);",
      "static void o2hb_region_unpin(const char *region_uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2nm_undepend_item",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2433
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_undepend_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "897-900",
          "snippet": "void o2nm_undepend_item(struct config_item *item)\n{\n\tconfigfs_undepend_item(&o2nm_cluster_group.cs_subsys, item);\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2nm_cluster_group o2nm_cluster_group = {\n\t.cs_subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"cluster\",\n\t\t\t\t.ci_type = &o2nm_cluster_group_type,\n\t\t\t},\n\t\t},\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstatic struct o2nm_cluster_group o2nm_cluster_group = {\n\t.cs_subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"cluster\",\n\t\t\t\t.ci_type = &o2nm_cluster_group_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nvoid o2nm_undepend_item(struct config_item *item)\n{\n\tconfigfs_undepend_item(&o2nm_cluster_group.cs_subsys, item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_CLUSTER",
            "\"Unpin region %s\\n\"",
            "uuid"
          ],
          "line": 2432
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "region_uuid",
            "uuid"
          ],
          "line": 2426
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "reg",
            "&o2hb_all_regions",
            "hr_all_item"
          ],
          "line": 2420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic void o2hb_region_unpin(const char *region_uuid)\n{\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\tint found = 0;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned) {\n\t\t\tmlog(ML_CLUSTER, \"Unpin region %s\\n\", uuid);\n\t\t\to2nm_undepend_item(&reg->hr_item);\n\t\t\treg->hr_item_pinned = 0;\n\t\t}\n\t\tif (found)\n\t\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "o2hb_region_pin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2359-2403",
    "snippet": "static int o2hb_region_pin(const char *region_uuid)\n{\n\tint ret = 0, found = 0;\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\n\t\t/* local heartbeat */\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned || reg->hr_item_dropped)\n\t\t\tgoto skip_pin;\n\n\t\t/* Ignore ENOENT only for local hb (userdlm domain) */\n\t\tret = o2nm_depend_item(&reg->hr_item);\n\t\tif (!ret) {\n\t\t\tmlog(ML_CLUSTER, \"Pin region %s\\n\", uuid);\n\t\t\treg->hr_item_pinned = 1;\n\t\t} else {\n\t\t\tif (ret == -ENOENT && found)\n\t\t\t\tret = 0;\n\t\t\telse {\n\t\t\t\tmlog(ML_ERROR, \"Pin region %s fails with %d\\n\",\n\t\t\t\t     uuid, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\nskip_pin:\n\t\tif (found)\n\t\t\tbreak;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_all_regions);",
      "static int o2hb_region_pin(const char *region_uuid);",
      "static void o2hb_region_unpin(const char *region_uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Pin region %s fails with %d\\n\"",
            "uuid",
            "ret"
          ],
          "line": 2392
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_CLUSTER",
            "\"Pin region %s\\n\"",
            "uuid"
          ],
          "line": 2386
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_depend_item",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2384
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_depend_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "892-895",
          "snippet": "int o2nm_depend_item(struct config_item *item)\n{\n\treturn configfs_depend_item(&o2nm_cluster_group.cs_subsys, item);\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2nm_cluster_group o2nm_cluster_group = {\n\t.cs_subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"cluster\",\n\t\t\t\t.ci_type = &o2nm_cluster_group_type,\n\t\t\t},\n\t\t},\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstatic struct o2nm_cluster_group o2nm_cluster_group = {\n\t.cs_subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"cluster\",\n\t\t\t\t.ci_type = &o2nm_cluster_group_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nint o2nm_depend_item(struct config_item *item)\n{\n\treturn configfs_depend_item(&o2nm_cluster_group.cs_subsys, item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "region_uuid",
            "uuid"
          ],
          "line": 2375
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "reg",
            "&o2hb_all_regions",
            "hr_all_item"
          ],
          "line": 2367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic int o2hb_region_pin(const char *region_uuid)\n{\n\tint ret = 0, found = 0;\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\n\t\t/* local heartbeat */\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned || reg->hr_item_dropped)\n\t\t\tgoto skip_pin;\n\n\t\t/* Ignore ENOENT only for local hb (userdlm domain) */\n\t\tret = o2nm_depend_item(&reg->hr_item);\n\t\tif (!ret) {\n\t\t\tmlog(ML_CLUSTER, \"Pin region %s\\n\", uuid);\n\t\t\treg->hr_item_pinned = 1;\n\t\t} else {\n\t\t\tif (ret == -ENOENT && found)\n\t\t\t\tret = 0;\n\t\t\telse {\n\t\t\t\tmlog(ML_ERROR, \"Pin region %s fails with %d\\n\",\n\t\t\t\t     uuid, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\nskip_pin:\n\t\tif (found)\n\t\t\tbreak;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_setup_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2337-2349",
    "snippet": "void o2hb_setup_callback(struct o2hb_callback_func *hc,\n\t\t\t enum o2hb_callback_type type,\n\t\t\t o2hb_cb_func *func,\n\t\t\t void *data,\n\t\t\t int priority)\n{\n\tINIT_LIST_HEAD(&hc->hc_item);\n\thc->hc_func = func;\n\thc->hc_data = data;\n\thc->hc_priority = priority;\n\thc->hc_type = type;\n\thc->hc_magic = O2HB_CB_MAGIC;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&hc->hc_item"
          ],
          "line": 2343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nvoid o2hb_setup_callback(struct o2hb_callback_func *hc,\n\t\t\t enum o2hb_callback_type type,\n\t\t\t o2hb_cb_func *func,\n\t\t\t void *data,\n\t\t\t int priority)\n{\n\tINIT_LIST_HEAD(&hc->hc_item);\n\thc->hc_func = func;\n\thc->hc_data = data;\n\thc->hc_priority = priority;\n\thc->hc_type = type;\n\thc->hc_magic = O2HB_CB_MAGIC;\n}"
  },
  {
    "function_name": "hbcall_from_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2329-2335",
    "snippet": "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type)\n{\n\tif (type == O2HB_NUM_CB)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn &o2hb_callbacks[type];\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];",
      "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 2332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type)\n{\n\tif (type == O2HB_NUM_CB)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn &o2hb_callbacks[type];\n}"
  },
  {
    "function_name": "o2hb_free_hb_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2321-2325",
    "snippet": "void o2hb_free_hb_set(struct config_group *group)\n{\n\tstruct o2hb_heartbeat_group *hs = to_o2hb_heartbeat_group(group);\n\tkfree(hs);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "hs"
          ],
          "line": 2324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_o2hb_heartbeat_group",
          "args": [
            "group"
          ],
          "line": 2323
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_heartbeat_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1990-1995",
          "snippet": "static struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nvoid o2hb_free_hb_set(struct config_group *group)\n{\n\tstruct o2hb_heartbeat_group *hs = to_o2hb_heartbeat_group(group);\n\tkfree(hs);\n}"
  },
  {
    "function_name": "o2hb_alloc_hb_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2302-2319",
    "snippet": "struct config_group *o2hb_alloc_hb_set(void)\n{\n\tstruct o2hb_heartbeat_group *hs = NULL;\n\tstruct config_group *ret = NULL;\n\n\ths = kzalloc(sizeof(struct o2hb_heartbeat_group), GFP_KERNEL);\n\tif (hs == NULL)\n\t\tgoto out;\n\n\tconfig_group_init_type_name(&hs->hs_group, \"heartbeat\",\n\t\t\t\t    &o2hb_heartbeat_group_type);\n\n\tret = &hs->hs_group;\nout:\n\tif (ret == NULL)\n\t\tkfree(hs);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct config_item_type o2hb_heartbeat_group_type = {\n\t.ct_group_ops\t= &o2hb_heartbeat_group_group_ops,\n\t.ct_item_ops\t= &o2hb_heartbeat_group_item_ops,\n\t.ct_attrs\t= o2hb_heartbeat_group_attrs,\n\t.ct_owner\t= THIS_MODULE,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "hs"
          ],
          "line": 2317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_group_init_type_name",
          "args": [
            "&hs->hs_group",
            "\"heartbeat\"",
            "&o2hb_heartbeat_group_type"
          ],
          "line": 2311
        },
        "resolved": true,
        "details": {
          "function_name": "config_group_init_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "125-131",
          "snippet": "void config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct o2hb_heartbeat_group)",
            "GFP_KERNEL"
          ],
          "line": 2307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct config_item_type o2hb_heartbeat_group_type = {\n\t.ct_group_ops\t= &o2hb_heartbeat_group_group_ops,\n\t.ct_item_ops\t= &o2hb_heartbeat_group_item_ops,\n\t.ct_attrs\t= o2hb_heartbeat_group_attrs,\n\t.ct_owner\t= THIS_MODULE,\n};\n\nstruct config_group *o2hb_alloc_hb_set(void)\n{\n\tstruct o2hb_heartbeat_group *hs = NULL;\n\tstruct config_group *ret = NULL;\n\n\ths = kzalloc(sizeof(struct o2hb_heartbeat_group), GFP_KERNEL);\n\tif (hs == NULL)\n\t\tgoto out;\n\n\tconfig_group_init_type_name(&hs->hs_group, \"heartbeat\",\n\t\t\t\t    &o2hb_heartbeat_group_type);\n\n\tret = &hs->hs_group;\nout:\n\tif (ret == NULL)\n\t\tkfree(hs);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_mode_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2234-2259",
    "snippet": "static\nssize_t o2hb_heartbeat_group_mode_store(struct o2hb_heartbeat_group *group,\n\t\t\t\t\tconst char *page, size_t count)\n{\n\tunsigned int i;\n\tint ret;\n\tsize_t len;\n\n\tlen = (page[count - 1] == '\\n') ? count - 1 : count;\n\tif (!len)\n\t\treturn -EINVAL;\n\n\tfor (i = 0; i < O2HB_HEARTBEAT_NUM_MODES; ++i) {\n\t\tif (strncasecmp(page, o2hb_heartbeat_mode_desc[i], len))\n\t\t\tcontinue;\n\n\t\tret = o2hb_global_heartbeat_mode_set(i);\n\t\tif (!ret)\n\t\t\tprintk(KERN_NOTICE \"o2hb: Heartbeat mode set to %s\\n\",\n\t\t\t       o2hb_heartbeat_mode_desc[i]);\n\t\treturn count;\n\t}\n\n\treturn -EINVAL;\n\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char *o2hb_heartbeat_mode_desc[O2HB_HEARTBEAT_NUM_MODES] = {\n\t\t\"local\",\t/* O2HB_HEARTBEAT_LOCAL */\n\t\t\"global\",\t/* O2HB_HEARTBEAT_GLOBAL */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"o2hb: Heartbeat mode set to %s\\n\"",
            "o2hb_heartbeat_mode_desc[i]"
          ],
          "line": 2252
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_mode_set",
          "args": [
            "i"
          ],
          "line": 2250
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_mode_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "180-194",
          "snippet": "static int o2hb_global_heartbeat_mode_set(unsigned int hb_mode)\n{\n\tint ret = -1;\n\n\tif (hb_mode < O2HB_HEARTBEAT_NUM_MODES) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions)) {\n\t\t\to2hb_heartbeat_mode = hb_mode;\n\t\t\tret = 0;\n\t\t}\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);",
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nstatic int o2hb_global_heartbeat_mode_set(unsigned int hb_mode)\n{\n\tint ret = -1;\n\n\tif (hb_mode < O2HB_HEARTBEAT_NUM_MODES) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions)) {\n\t\t\to2hb_heartbeat_mode = hb_mode;\n\t\t\tret = 0;\n\t\t}\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "page",
            "o2hb_heartbeat_mode_desc[i]",
            "len"
          ],
          "line": 2247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nchar *o2hb_heartbeat_mode_desc[O2HB_HEARTBEAT_NUM_MODES] = {\n\t\t\"local\",\t/* O2HB_HEARTBEAT_LOCAL */\n\t\t\"global\",\t/* O2HB_HEARTBEAT_GLOBAL */\n};\n\nstatic\nssize_t o2hb_heartbeat_group_mode_store(struct o2hb_heartbeat_group *group,\n\t\t\t\t\tconst char *page, size_t count)\n{\n\tunsigned int i;\n\tint ret;\n\tsize_t len;\n\n\tlen = (page[count - 1] == '\\n') ? count - 1 : count;\n\tif (!len)\n\t\treturn -EINVAL;\n\n\tfor (i = 0; i < O2HB_HEARTBEAT_NUM_MODES; ++i) {\n\t\tif (strncasecmp(page, o2hb_heartbeat_mode_desc[i], len))\n\t\t\tcontinue;\n\n\t\tret = o2hb_global_heartbeat_mode_set(i);\n\t\tif (!ret)\n\t\t\tprintk(KERN_NOTICE \"o2hb: Heartbeat mode set to %s\\n\",\n\t\t\t       o2hb_heartbeat_mode_desc[i]);\n\t\treturn count;\n\t}\n\n\treturn -EINVAL;\n\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_mode_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2226-2232",
    "snippet": "static\nssize_t o2hb_heartbeat_group_mode_show(struct o2hb_heartbeat_group *group,\n\t\t\t\t       char *page)\n{\n\treturn sprintf(page, \"%s\\n\",\n\t\t       o2hb_heartbeat_mode_desc[o2hb_heartbeat_mode]);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char *o2hb_heartbeat_mode_desc[O2HB_HEARTBEAT_NUM_MODES] = {\n\t\t\"local\",\t/* O2HB_HEARTBEAT_LOCAL */\n\t\t\"global\",\t/* O2HB_HEARTBEAT_GLOBAL */\n};",
      "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%s\\n\"",
            "o2hb_heartbeat_mode_desc[o2hb_heartbeat_mode]"
          ],
          "line": 2230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nchar *o2hb_heartbeat_mode_desc[O2HB_HEARTBEAT_NUM_MODES] = {\n\t\t\"local\",\t/* O2HB_HEARTBEAT_LOCAL */\n\t\t\"global\",\t/* O2HB_HEARTBEAT_GLOBAL */\n};\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nstatic\nssize_t o2hb_heartbeat_group_mode_show(struct o2hb_heartbeat_group *group,\n\t\t\t\t       char *page)\n{\n\treturn sprintf(page, \"%s\\n\",\n\t\t       o2hb_heartbeat_mode_desc[o2hb_heartbeat_mode]);\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_threshold_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2209-2224",
    "snippet": "static ssize_t o2hb_heartbeat_group_threshold_store(struct o2hb_heartbeat_group *group,\n\t\t\t\t\t\t    const char *page,\n\t\t\t\t\t\t    size_t count)\n{\n\tunsigned long tmp;\n\tchar *p = (char *)page;\n\n\ttmp = simple_strtoul(p, &p, 10);\n\tif (!p || (*p && (*p != '\\n')))\n                return -EINVAL;\n\n\t/* this will validate ranges for us. */\n\to2hb_dead_threshold_set((unsigned int) tmp);\n\n\treturn count;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_dead_threshold_set",
          "args": [
            "(unsigned int) tmp"
          ],
          "line": 2221
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_dead_threshold_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "170-178",
          "snippet": "static void o2hb_dead_threshold_set(unsigned int threshold)\n{\n\tif (threshold > O2HB_MIN_DEAD_THRESHOLD) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions))\n\t\t\to2hb_dead_threshold = threshold;\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);",
            "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic void o2hb_dead_threshold_set(unsigned int threshold)\n{\n\tif (threshold > O2HB_MIN_DEAD_THRESHOLD) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions))\n\t\t\to2hb_dead_threshold = threshold;\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "p",
            "&p",
            "10"
          ],
          "line": 2216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_heartbeat_group_threshold_store(struct o2hb_heartbeat_group *group,\n\t\t\t\t\t\t    const char *page,\n\t\t\t\t\t\t    size_t count)\n{\n\tunsigned long tmp;\n\tchar *p = (char *)page;\n\n\ttmp = simple_strtoul(p, &p, 10);\n\tif (!p || (*p && (*p != '\\n')))\n                return -EINVAL;\n\n\t/* this will validate ranges for us. */\n\to2hb_dead_threshold_set((unsigned int) tmp);\n\n\treturn count;\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_threshold_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2203-2207",
    "snippet": "static ssize_t o2hb_heartbeat_group_threshold_show(struct o2hb_heartbeat_group *group,\n\t\t\t\t\t\t     char *page)\n{\n\treturn sprintf(page, \"%u\\n\", o2hb_dead_threshold);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%u\\n\"",
            "o2hb_dead_threshold"
          ],
          "line": 2206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic ssize_t o2hb_heartbeat_group_threshold_show(struct o2hb_heartbeat_group *group,\n\t\t\t\t\t\t     char *page)\n{\n\treturn sprintf(page, \"%u\\n\", o2hb_dead_threshold);\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2189-2201",
    "snippet": "static ssize_t o2hb_heartbeat_group_store(struct config_item *item,\n\t\t\t\t\t  struct configfs_attribute *attr,\n\t\t\t\t\t  const char *page, size_t count)\n{\n\tstruct o2hb_heartbeat_group *reg = to_o2hb_heartbeat_group(to_config_group(item));\n\tstruct o2hb_heartbeat_group_attribute *o2hb_heartbeat_group_attr =\n\t\tcontainer_of(attr, struct o2hb_heartbeat_group_attribute, attr);\n\tssize_t ret = -EINVAL;\n\n\tif (o2hb_heartbeat_group_attr->store)\n\t\tret = o2hb_heartbeat_group_attr->store(reg, page, count);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_heartbeat_group_attr->store",
          "args": [
            "reg",
            "page",
            "count"
          ],
          "line": 2199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structo2hb_heartbeat_group_attribute",
            "attr"
          ],
          "line": 2195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_o2hb_heartbeat_group",
          "args": [
            "to_config_group(item)"
          ],
          "line": 2193
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_heartbeat_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1990-1995",
          "snippet": "static struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_config_group",
          "args": [
            "item"
          ],
          "line": 2193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_heartbeat_group_store(struct config_item *item,\n\t\t\t\t\t  struct configfs_attribute *attr,\n\t\t\t\t\t  const char *page, size_t count)\n{\n\tstruct o2hb_heartbeat_group *reg = to_o2hb_heartbeat_group(to_config_group(item));\n\tstruct o2hb_heartbeat_group_attribute *o2hb_heartbeat_group_attr =\n\t\tcontainer_of(attr, struct o2hb_heartbeat_group_attribute, attr);\n\tssize_t ret = -EINVAL;\n\n\tif (o2hb_heartbeat_group_attr->store)\n\t\tret = o2hb_heartbeat_group_attr->store(reg, page, count);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2175-2187",
    "snippet": "static ssize_t o2hb_heartbeat_group_show(struct config_item *item,\n\t\t\t\t\t struct configfs_attribute *attr,\n\t\t\t\t\t char *page)\n{\n\tstruct o2hb_heartbeat_group *reg = to_o2hb_heartbeat_group(to_config_group(item));\n\tstruct o2hb_heartbeat_group_attribute *o2hb_heartbeat_group_attr =\n\t\tcontainer_of(attr, struct o2hb_heartbeat_group_attribute, attr);\n\tssize_t ret = 0;\n\n\tif (o2hb_heartbeat_group_attr->show)\n\t\tret = o2hb_heartbeat_group_attr->show(reg, page);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_heartbeat_group_attr->show",
          "args": [
            "reg",
            "page"
          ],
          "line": 2185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structo2hb_heartbeat_group_attribute",
            "attr"
          ],
          "line": 2181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_o2hb_heartbeat_group",
          "args": [
            "to_config_group(item)"
          ],
          "line": 2179
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_heartbeat_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1990-1995",
          "snippet": "static struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_config_group",
          "args": [
            "item"
          ],
          "line": 2179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_heartbeat_group_show(struct config_item *item,\n\t\t\t\t\t struct configfs_attribute *attr,\n\t\t\t\t\t char *page)\n{\n\tstruct o2hb_heartbeat_group *reg = to_o2hb_heartbeat_group(to_config_group(item));\n\tstruct o2hb_heartbeat_group_attribute *o2hb_heartbeat_group_attr =\n\t\tcontainer_of(attr, struct o2hb_heartbeat_group_attribute, attr);\n\tssize_t ret = 0;\n\n\tif (o2hb_heartbeat_group_attr->show)\n\t\tret = o2hb_heartbeat_group_attr->show(reg, page);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_drop_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2106-2167",
    "snippet": "static void o2hb_heartbeat_group_drop_item(struct config_group *group,\n\t\t\t\t\t   struct config_item *item)\n{\n\tstruct task_struct *hb_task;\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\tint quorum_region = 0;\n\n\t/* stop the thread when the user removes the region dir */\n\tspin_lock(&o2hb_live_lock);\n\thb_task = reg->hr_task;\n\treg->hr_task = NULL;\n\treg->hr_item_dropped = 1;\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (hb_task)\n\t\tkthread_stop(hb_task);\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tclear_bit(reg->hr_region_num, o2hb_region_bitmap);\n\t\tclear_bit(reg->hr_region_num, o2hb_live_region_bitmap);\n\t\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\t\tquorum_region = 1;\n\t\tclear_bit(reg->hr_region_num, o2hb_quorum_region_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tprintk(KERN_NOTICE \"o2hb: Heartbeat %s on region %s (%s)\\n\",\n\t\t       ((atomic_read(&reg->hr_steady_iterations) == 0) ?\n\t\t\t\"stopped\" : \"start aborted\"), config_item_name(item),\n\t\t       reg->hr_dev_name);\n\t}\n\n\t/*\n\t * If we're racing a dev_write(), we need to wake them.  They will\n\t * check reg->hr_task\n\t */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\treg->hr_aborted_start = 1;\n\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\twake_up(&o2hb_steady_queue);\n\t}\n\n\tconfig_item_put(item);\n\n\tif (!o2hb_global_heartbeat_active() || !quorum_region)\n\t\treturn;\n\n\t/*\n\t * If global heartbeat active and there are dependent users,\n\t * pin all regions if quorum region count <= CUT_OFF\n\t */\n\tspin_lock(&o2hb_live_lock);\n\n\tif (!o2hb_dependent_users)\n\t\tgoto unlock;\n\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) <= O2HB_PIN_CUT_OFF)\n\t\to2hb_region_pin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define O2HB_PIN_CUT_OFF\t\t3"
    ],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);",
      "static unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "unsigned int o2hb_dependent_users;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2166
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_region_pin",
          "args": [
            "NULL"
          ],
          "line": 2163
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_region_pin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2359-2403",
          "snippet": "static int o2hb_region_pin(const char *region_uuid)\n{\n\tint ret = 0, found = 0;\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\n\t\t/* local heartbeat */\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned || reg->hr_item_dropped)\n\t\t\tgoto skip_pin;\n\n\t\t/* Ignore ENOENT only for local hb (userdlm domain) */\n\t\tret = o2nm_depend_item(&reg->hr_item);\n\t\tif (!ret) {\n\t\t\tmlog(ML_CLUSTER, \"Pin region %s\\n\", uuid);\n\t\t\treg->hr_item_pinned = 1;\n\t\t} else {\n\t\t\tif (ret == -ENOENT && found)\n\t\t\t\tret = 0;\n\t\t\telse {\n\t\t\t\tmlog(ML_ERROR, \"Pin region %s fails with %d\\n\",\n\t\t\t\t     uuid, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\nskip_pin:\n\t\tif (found)\n\t\t\tbreak;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);",
            "static int o2hb_region_pin(const char *region_uuid);",
            "static void o2hb_region_unpin(const char *region_uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic int o2hb_region_pin(const char *region_uuid)\n{\n\tint ret = 0, found = 0;\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\n\t\t/* local heartbeat */\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned || reg->hr_item_dropped)\n\t\t\tgoto skip_pin;\n\n\t\t/* Ignore ENOENT only for local hb (userdlm domain) */\n\t\tret = o2nm_depend_item(&reg->hr_item);\n\t\tif (!ret) {\n\t\t\tmlog(ML_CLUSTER, \"Pin region %s\\n\", uuid);\n\t\t\treg->hr_item_pinned = 1;\n\t\t} else {\n\t\t\tif (ret == -ENOENT && found)\n\t\t\t\tret = 0;\n\t\t\telse {\n\t\t\t\tmlog(ML_ERROR, \"Pin region %s fails with %d\\n\",\n\t\t\t\t     uuid, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\nskip_pin:\n\t\tif (found)\n\t\t\tbreak;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_weight",
          "args": [
            "o2hb_quorum_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 2161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2156
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "item"
          ],
          "line": 2147
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "&o2hb_steady_queue"
          ],
          "line": 2144
        },
        "resolved": true,
        "details": {
          "function_name": "locks_wake_up_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/locks.c",
          "lines": "656-681",
          "snippet": "static void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <asm/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/lglock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(blocked_lock_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <asm/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/lglock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nstatic DEFINE_SPINLOCK(blocked_lock_lock);\n\nstatic void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&reg->hr_steady_iterations",
            "0"
          ],
          "line": 2143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 2141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"o2hb: Heartbeat %s on region %s (%s)\\n\"",
            "((atomic_read(&reg->hr_steady_iterations) == 0) ?\n\t\t\t\"stopped\" : \"start aborted\")",
            "config_item_name(item)",
            "reg->hr_dev_name"
          ],
          "line": 2131
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "item"
          ],
          "line": 2133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 2132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_quorum_region_bitmap"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "102-106",
          "snippet": "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_quorum_region_bitmap"
          ],
          "line": 2127
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kthread_stop",
          "args": [
            "hb_task"
          ],
          "line": 2121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_o2hb_region",
          "args": [
            "item"
          ],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1434-1437",
          "snippet": "static struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_PIN_CUT_OFF\t\t3\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);\nstatic unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nunsigned int o2hb_dependent_users;\n\nstatic void o2hb_heartbeat_group_drop_item(struct config_group *group,\n\t\t\t\t\t   struct config_item *item)\n{\n\tstruct task_struct *hb_task;\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\tint quorum_region = 0;\n\n\t/* stop the thread when the user removes the region dir */\n\tspin_lock(&o2hb_live_lock);\n\thb_task = reg->hr_task;\n\treg->hr_task = NULL;\n\treg->hr_item_dropped = 1;\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (hb_task)\n\t\tkthread_stop(hb_task);\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tclear_bit(reg->hr_region_num, o2hb_region_bitmap);\n\t\tclear_bit(reg->hr_region_num, o2hb_live_region_bitmap);\n\t\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\t\tquorum_region = 1;\n\t\tclear_bit(reg->hr_region_num, o2hb_quorum_region_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tprintk(KERN_NOTICE \"o2hb: Heartbeat %s on region %s (%s)\\n\",\n\t\t       ((atomic_read(&reg->hr_steady_iterations) == 0) ?\n\t\t\t\"stopped\" : \"start aborted\"), config_item_name(item),\n\t\t       reg->hr_dev_name);\n\t}\n\n\t/*\n\t * If we're racing a dev_write(), we need to wake them.  They will\n\t * check reg->hr_task\n\t */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\treg->hr_aborted_start = 1;\n\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\twake_up(&o2hb_steady_queue);\n\t}\n\n\tconfig_item_put(item);\n\n\tif (!o2hb_global_heartbeat_active() || !quorum_region)\n\t\treturn;\n\n\t/*\n\t * If global heartbeat active and there are dependent users,\n\t * pin all regions if quorum region count <= CUT_OFF\n\t */\n\tspin_lock(&o2hb_live_lock);\n\n\tif (!o2hb_dependent_users)\n\t\tgoto unlock;\n\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) <= O2HB_PIN_CUT_OFF)\n\t\to2hb_region_pin(NULL);\n\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}"
  },
  {
    "function_name": "o2hb_heartbeat_group_make_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "2062-2104",
    "snippet": "static struct config_item *o2hb_heartbeat_group_make_item(struct config_group *group,\n\t\t\t\t\t\t\t  const char *name)\n{\n\tstruct o2hb_region *reg = NULL;\n\tint ret;\n\n\treg = kzalloc(sizeof(struct o2hb_region), GFP_KERNEL);\n\tif (reg == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (strlen(name) > O2HB_MAX_REGION_NAME_LEN) {\n\t\tret = -ENAMETOOLONG;\n\t\tgoto free;\n\t}\n\n\tspin_lock(&o2hb_live_lock);\n\treg->hr_region_num = 0;\n\tif (o2hb_global_heartbeat_active()) {\n\t\treg->hr_region_num = find_first_zero_bit(o2hb_region_bitmap,\n\t\t\t\t\t\t\t O2NM_MAX_REGIONS);\n\t\tif (reg->hr_region_num >= O2NM_MAX_REGIONS) {\n\t\t\tspin_unlock(&o2hb_live_lock);\n\t\t\tret = -EFBIG;\n\t\t\tgoto free;\n\t\t}\n\t\tset_bit(reg->hr_region_num, o2hb_region_bitmap);\n\t}\n\tlist_add_tail(&reg->hr_all_item, &o2hb_all_regions);\n\tspin_unlock(&o2hb_live_lock);\n\n\tconfig_item_init_type_name(&reg->hr_item, name, &o2hb_region_type);\n\n\tret = o2hb_debug_region_init(reg, o2hb_debug_dir);\n\tif (ret) {\n\t\tconfig_item_put(&reg->hr_item);\n\t\tgoto free;\n\t}\n\n\treturn &reg->hr_item;\nfree:\n\tkfree(reg);\n\treturn ERR_PTR(ret);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static struct dentry *o2hb_debug_dir;",
      "static LIST_HEAD(o2hb_all_regions);",
      "static struct config_item_type o2hb_region_type = {\n\t.ct_item_ops\t= &o2hb_region_item_ops,\n\t.ct_attrs\t= o2hb_region_attrs,\n\t.ct_owner\t= THIS_MODULE,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 2103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg"
          ],
          "line": 2102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2096
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_debug_region_init",
          "args": [
            "reg",
            "o2hb_debug_dir"
          ],
          "line": 2094
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_debug_region_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1997-2060",
          "snippet": "static int o2hb_debug_region_init(struct o2hb_region *reg, struct dentry *dir)\n{\n\tint ret = -ENOMEM;\n\n\treg->hr_debug_dir =\n\t\tdebugfs_create_dir(config_item_name(&reg->hr_item), dir);\n\tif (!reg->hr_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_livenodes =\n\t\t\to2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_livenodes),\n\t\t\t\t\t  sizeof(*(reg->hr_db_livenodes)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_LIVENODES,\n\t\t\t\t\t  sizeof(reg->hr_live_node_bitmap),\n\t\t\t\t\t  O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_regnum =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_NUMBER,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_regnum),\n\t\t\t\t\t  sizeof(*(reg->hr_db_regnum)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_NUMBER,\n\t\t\t\t\t  0, O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_regnum) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_elapsed_time =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_ELAPSED_TIME,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_elapsed_time),\n\t\t\t\t\t  sizeof(*(reg->hr_db_elapsed_time)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_ELAPSED_TIME,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_elapsed_time) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_pinned =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_PINNED,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_pinned),\n\t\t\t\t\t  sizeof(*(reg->hr_db_pinned)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_PINNED,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_pinned) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define O2HB_DEBUG_REGION_PINNED\t\"pinned\"",
            "#define O2HB_DEBUG_REGION_ELAPSED_TIME\t\"elapsed_time_in_ms\"",
            "#define O2HB_DEBUG_REGION_NUMBER\t\"num\"",
            "#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"",
            "#define O2HB_DB_TYPE_REGION_PINNED\t7",
            "#define O2HB_DB_TYPE_REGION_ELAPSED_TIME\t6",
            "#define O2HB_DB_TYPE_REGION_NUMBER\t5",
            "#define O2HB_DB_TYPE_REGION_LIVENODES\t4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_DEBUG_REGION_PINNED\t\"pinned\"\n#define O2HB_DEBUG_REGION_ELAPSED_TIME\t\"elapsed_time_in_ms\"\n#define O2HB_DEBUG_REGION_NUMBER\t\"num\"\n#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"\n#define O2HB_DB_TYPE_REGION_PINNED\t7\n#define O2HB_DB_TYPE_REGION_ELAPSED_TIME\t6\n#define O2HB_DB_TYPE_REGION_NUMBER\t5\n#define O2HB_DB_TYPE_REGION_LIVENODES\t4\n\nstatic int o2hb_debug_region_init(struct o2hb_region *reg, struct dentry *dir)\n{\n\tint ret = -ENOMEM;\n\n\treg->hr_debug_dir =\n\t\tdebugfs_create_dir(config_item_name(&reg->hr_item), dir);\n\tif (!reg->hr_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_livenodes =\n\t\t\to2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_livenodes),\n\t\t\t\t\t  sizeof(*(reg->hr_db_livenodes)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_LIVENODES,\n\t\t\t\t\t  sizeof(reg->hr_live_node_bitmap),\n\t\t\t\t\t  O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_regnum =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_NUMBER,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_regnum),\n\t\t\t\t\t  sizeof(*(reg->hr_db_regnum)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_NUMBER,\n\t\t\t\t\t  0, O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_regnum) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_elapsed_time =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_ELAPSED_TIME,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_elapsed_time),\n\t\t\t\t\t  sizeof(*(reg->hr_db_elapsed_time)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_ELAPSED_TIME,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_elapsed_time) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_pinned =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_PINNED,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_pinned),\n\t\t\t\t\t  sizeof(*(reg->hr_db_pinned)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_PINNED,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_pinned) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_init_type_name",
          "args": [
            "&reg->hr_item",
            "name",
            "&o2hb_region_type"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_init_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "115-122",
          "snippet": "void config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2090
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&reg->hr_all_item",
            "&o2hb_all_regions"
          ],
          "line": 2089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_region_bitmap"
          ],
          "line": 2087
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "84-88",
          "snippet": "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_zero_bit",
          "args": [
            "o2hb_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 2080
        },
        "resolved": true,
        "details": {
          "function_name": "minix_find_first_zero_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "124-140",
          "snippet": "static inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define minix_find_first_zero_bit\tfind_first_zero_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\n#define minix_find_first_zero_bit\tfind_first_zero_bit_le\n\nstatic inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 2079
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 2077
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 2072
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 2070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct o2hb_region)",
            "GFP_KERNEL"
          ],
          "line": 2068
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic struct dentry *o2hb_debug_dir;\nstatic LIST_HEAD(o2hb_all_regions);\nstatic struct config_item_type o2hb_region_type = {\n\t.ct_item_ops\t= &o2hb_region_item_ops,\n\t.ct_attrs\t= o2hb_region_attrs,\n\t.ct_owner\t= THIS_MODULE,\n};\n\nstatic struct config_item *o2hb_heartbeat_group_make_item(struct config_group *group,\n\t\t\t\t\t\t\t  const char *name)\n{\n\tstruct o2hb_region *reg = NULL;\n\tint ret;\n\n\treg = kzalloc(sizeof(struct o2hb_region), GFP_KERNEL);\n\tif (reg == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (strlen(name) > O2HB_MAX_REGION_NAME_LEN) {\n\t\tret = -ENAMETOOLONG;\n\t\tgoto free;\n\t}\n\n\tspin_lock(&o2hb_live_lock);\n\treg->hr_region_num = 0;\n\tif (o2hb_global_heartbeat_active()) {\n\t\treg->hr_region_num = find_first_zero_bit(o2hb_region_bitmap,\n\t\t\t\t\t\t\t O2NM_MAX_REGIONS);\n\t\tif (reg->hr_region_num >= O2NM_MAX_REGIONS) {\n\t\t\tspin_unlock(&o2hb_live_lock);\n\t\t\tret = -EFBIG;\n\t\t\tgoto free;\n\t\t}\n\t\tset_bit(reg->hr_region_num, o2hb_region_bitmap);\n\t}\n\tlist_add_tail(&reg->hr_all_item, &o2hb_all_regions);\n\tspin_unlock(&o2hb_live_lock);\n\n\tconfig_item_init_type_name(&reg->hr_item, name, &o2hb_region_type);\n\n\tret = o2hb_debug_region_init(reg, o2hb_debug_dir);\n\tif (ret) {\n\t\tconfig_item_put(&reg->hr_item);\n\t\tgoto free;\n\t}\n\n\treturn &reg->hr_item;\nfree:\n\tkfree(reg);\n\treturn ERR_PTR(ret);\n}"
  },
  {
    "function_name": "o2hb_debug_region_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1997-2060",
    "snippet": "static int o2hb_debug_region_init(struct o2hb_region *reg, struct dentry *dir)\n{\n\tint ret = -ENOMEM;\n\n\treg->hr_debug_dir =\n\t\tdebugfs_create_dir(config_item_name(&reg->hr_item), dir);\n\tif (!reg->hr_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_livenodes =\n\t\t\to2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_livenodes),\n\t\t\t\t\t  sizeof(*(reg->hr_db_livenodes)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_LIVENODES,\n\t\t\t\t\t  sizeof(reg->hr_live_node_bitmap),\n\t\t\t\t\t  O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_regnum =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_NUMBER,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_regnum),\n\t\t\t\t\t  sizeof(*(reg->hr_db_regnum)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_NUMBER,\n\t\t\t\t\t  0, O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_regnum) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_elapsed_time =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_ELAPSED_TIME,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_elapsed_time),\n\t\t\t\t\t  sizeof(*(reg->hr_db_elapsed_time)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_ELAPSED_TIME,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_elapsed_time) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_pinned =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_PINNED,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_pinned),\n\t\t\t\t\t  sizeof(*(reg->hr_db_pinned)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_PINNED,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_pinned) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define O2HB_DEBUG_REGION_PINNED\t\"pinned\"",
      "#define O2HB_DEBUG_REGION_ELAPSED_TIME\t\"elapsed_time_in_ms\"",
      "#define O2HB_DEBUG_REGION_NUMBER\t\"num\"",
      "#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"",
      "#define O2HB_DB_TYPE_REGION_PINNED\t7",
      "#define O2HB_DB_TYPE_REGION_ELAPSED_TIME\t6",
      "#define O2HB_DB_TYPE_REGION_NUMBER\t5",
      "#define O2HB_DB_TYPE_REGION_LIVENODES\t4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_debug_create",
          "args": [
            "O2HB_DEBUG_REGION_PINNED",
            "reg->hr_debug_dir",
            "&(reg->hr_db_pinned)",
            "sizeof(*(reg->hr_db_pinned))",
            "O2HB_DB_TYPE_REGION_PINNED",
            "0",
            "0",
            "reg"
          ],
          "line": 2046
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_debug_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1293-1308",
          "snippet": "static struct dentry *o2hb_debug_create(const char *name, struct dentry *dir,\n\t\t\t\t\tstruct o2hb_debug_buf **db, int db_len,\n\t\t\t\t\tint type, int size, int len, void *data)\n{\n\t*db = kmalloc(db_len, GFP_KERNEL);\n\tif (!*db)\n\t\treturn NULL;\n\n\t(*db)->db_type = type;\n\t(*db)->db_size = size;\n\t(*db)->db_len = len;\n\t(*db)->db_data = data;\n\n\treturn debugfs_create_file(name, S_IFREG|S_IRUSR, dir, *db,\n\t\t\t\t   &o2hb_debug_fops);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);",
            "static const struct file_operations o2hb_debug_fops = {\n\t.open =\t\to2hb_debug_open,\n\t.release =\to2hb_debug_release,\n\t.read =\t\to2hb_debug_read,\n\t.llseek =\tgeneric_file_llseek,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\nstatic const struct file_operations o2hb_debug_fops = {\n\t.open =\t\to2hb_debug_open,\n\t.release =\to2hb_debug_release,\n\t.read =\t\to2hb_debug_read,\n\t.llseek =\tgeneric_file_llseek,\n};\n\nstatic struct dentry *o2hb_debug_create(const char *name, struct dentry *dir,\n\t\t\t\t\tstruct o2hb_debug_buf **db, int db_len,\n\t\t\t\t\tint type, int size, int len, void *data)\n{\n\t*db = kmalloc(db_len, GFP_KERNEL);\n\tif (!*db)\n\t\treturn NULL;\n\n\t(*db)->db_type = type;\n\t(*db)->db_size = size;\n\t(*db)->db_len = len;\n\t(*db)->db_data = data;\n\n\treturn debugfs_create_file(name, S_IFREG|S_IRUSR, dir, *db,\n\t\t\t\t   &o2hb_debug_fops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 2041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 2029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 2017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 2004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "config_item_name(&reg->hr_item)",
            "dir"
          ],
          "line": 2002
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 2002
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_DEBUG_REGION_PINNED\t\"pinned\"\n#define O2HB_DEBUG_REGION_ELAPSED_TIME\t\"elapsed_time_in_ms\"\n#define O2HB_DEBUG_REGION_NUMBER\t\"num\"\n#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"\n#define O2HB_DB_TYPE_REGION_PINNED\t7\n#define O2HB_DB_TYPE_REGION_ELAPSED_TIME\t6\n#define O2HB_DB_TYPE_REGION_NUMBER\t5\n#define O2HB_DB_TYPE_REGION_LIVENODES\t4\n\nstatic int o2hb_debug_region_init(struct o2hb_region *reg, struct dentry *dir)\n{\n\tint ret = -ENOMEM;\n\n\treg->hr_debug_dir =\n\t\tdebugfs_create_dir(config_item_name(&reg->hr_item), dir);\n\tif (!reg->hr_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_livenodes =\n\t\t\to2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_livenodes),\n\t\t\t\t\t  sizeof(*(reg->hr_db_livenodes)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_LIVENODES,\n\t\t\t\t\t  sizeof(reg->hr_live_node_bitmap),\n\t\t\t\t\t  O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_regnum =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_NUMBER,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_regnum),\n\t\t\t\t\t  sizeof(*(reg->hr_db_regnum)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_NUMBER,\n\t\t\t\t\t  0, O2NM_MAX_NODES, reg);\n\tif (!reg->hr_debug_regnum) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_elapsed_time =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_ELAPSED_TIME,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_elapsed_time),\n\t\t\t\t\t  sizeof(*(reg->hr_db_elapsed_time)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_ELAPSED_TIME,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_elapsed_time) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\treg->hr_debug_pinned =\n\t\t\to2hb_debug_create(O2HB_DEBUG_REGION_PINNED,\n\t\t\t\t\t  reg->hr_debug_dir,\n\t\t\t\t\t  &(reg->hr_db_pinned),\n\t\t\t\t\t  sizeof(*(reg->hr_db_pinned)),\n\t\t\t\t\t  O2HB_DB_TYPE_REGION_PINNED,\n\t\t\t\t\t  0, 0, reg);\n\tif (!reg->hr_debug_pinned) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\treturn ret;\n}"
  },
  {
    "function_name": "to_o2hb_heartbeat_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1990-1995",
    "snippet": "static struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "group",
            "structo2hb_heartbeat_group",
            "hs_group"
          ],
          "line": 1993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_heartbeat_group *to_o2hb_heartbeat_group(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct o2hb_heartbeat_group, hs_group)\n\t\t: NULL;\n}"
  },
  {
    "function_name": "o2hb_region_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1957-1969",
    "snippet": "static ssize_t o2hb_region_store(struct config_item *item,\n\t\t\t\t struct configfs_attribute *attr,\n\t\t\t\t const char *page, size_t count)\n{\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\tstruct o2hb_region_attribute *o2hb_region_attr =\n\t\tcontainer_of(attr, struct o2hb_region_attribute, attr);\n\tssize_t ret = -EINVAL;\n\n\tif (o2hb_region_attr->store)\n\t\tret = o2hb_region_attr->store(reg, page, count);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_region_attr->store",
          "args": [
            "reg",
            "page",
            "count"
          ],
          "line": 1967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structo2hb_region_attribute",
            "attr"
          ],
          "line": 1963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_o2hb_region",
          "args": [
            "item"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1434-1437",
          "snippet": "static struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_store(struct config_item *item,\n\t\t\t\t struct configfs_attribute *attr,\n\t\t\t\t const char *page, size_t count)\n{\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\tstruct o2hb_region_attribute *o2hb_region_attr =\n\t\tcontainer_of(attr, struct o2hb_region_attribute, attr);\n\tssize_t ret = -EINVAL;\n\n\tif (o2hb_region_attr->store)\n\t\tret = o2hb_region_attr->store(reg, page, count);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_region_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1943-1955",
    "snippet": "static ssize_t o2hb_region_show(struct config_item *item,\n\t\t\t\tstruct configfs_attribute *attr,\n\t\t\t\tchar *page)\n{\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\tstruct o2hb_region_attribute *o2hb_region_attr =\n\t\tcontainer_of(attr, struct o2hb_region_attribute, attr);\n\tssize_t ret = 0;\n\n\tif (o2hb_region_attr->show)\n\t\tret = o2hb_region_attr->show(reg, page);\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_region_attr->show",
          "args": [
            "reg",
            "page"
          ],
          "line": 1953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structo2hb_region_attribute",
            "attr"
          ],
          "line": 1949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_o2hb_region",
          "args": [
            "item"
          ],
          "line": 1947
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1434-1437",
          "snippet": "static struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_show(struct config_item *item,\n\t\t\t\tstruct configfs_attribute *attr,\n\t\t\t\tchar *page)\n{\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\tstruct o2hb_region_attribute *o2hb_region_attr =\n\t\tcontainer_of(attr, struct o2hb_region_attribute, attr);\n\tssize_t ret = 0;\n\n\tif (o2hb_region_attr->show)\n\t\tret = o2hb_region_attr->show(reg, page);\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_region_pid_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1873-1887",
    "snippet": "static ssize_t o2hb_region_pid_read(struct o2hb_region *reg,\n                                      char *page)\n{\n\tpid_t pid = 0;\n\n\tspin_lock(&o2hb_live_lock);\n\tif (reg->hr_task)\n\t\tpid = task_pid_nr(reg->hr_task);\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (!pid)\n\t\treturn 0;\n\n\treturn sprintf(page, \"%u\\n\", pid);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%u\\n\"",
            "pid"
          ],
          "line": 1886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1881
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "reg->hr_task"
          ],
          "line": 1880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1878
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nstatic ssize_t o2hb_region_pid_read(struct o2hb_region *reg,\n                                      char *page)\n{\n\tpid_t pid = 0;\n\n\tspin_lock(&o2hb_live_lock);\n\tif (reg->hr_task)\n\t\tpid = task_pid_nr(reg->hr_task);\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (!pid)\n\t\treturn 0;\n\n\treturn sprintf(page, \"%u\\n\", pid);\n}"
  },
  {
    "function_name": "o2hb_region_dev_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1715-1871",
    "snippet": "static ssize_t o2hb_region_dev_write(struct o2hb_region *reg,\n\t\t\t\t     const char *page,\n\t\t\t\t     size_t count)\n{\n\tstruct task_struct *hb_task;\n\tlong fd;\n\tint sectsize;\n\tchar *p = (char *)page;\n\tstruct fd f;\n\tstruct inode *inode;\n\tssize_t ret = -EINVAL;\n\tint live_threshold;\n\n\tif (reg->hr_bdev)\n\t\tgoto out;\n\n\t/* We can't heartbeat without having had our node number\n\t * configured yet. */\n\tif (o2nm_this_node() == O2NM_MAX_NODES)\n\t\tgoto out;\n\n\tfd = simple_strtol(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\tgoto out;\n\n\tif (fd < 0 || fd >= INT_MAX)\n\t\tgoto out;\n\n\tf = fdget(fd);\n\tif (f.file == NULL)\n\t\tgoto out;\n\n\tif (reg->hr_blocks == 0 || reg->hr_start_block == 0 ||\n\t    reg->hr_block_bytes == 0)\n\t\tgoto out2;\n\n\tinode = igrab(f.file->f_mapping->host);\n\tif (inode == NULL)\n\t\tgoto out2;\n\n\tif (!S_ISBLK(inode->i_mode))\n\t\tgoto out3;\n\n\treg->hr_bdev = I_BDEV(f.file->f_mapping->host);\n\tret = blkdev_get(reg->hr_bdev, FMODE_WRITE | FMODE_READ, NULL);\n\tif (ret) {\n\t\treg->hr_bdev = NULL;\n\t\tgoto out3;\n\t}\n\tinode = NULL;\n\n\tbdevname(reg->hr_bdev, reg->hr_dev_name);\n\n\tsectsize = bdev_logical_block_size(reg->hr_bdev);\n\tif (sectsize != reg->hr_block_bytes) {\n\t\tmlog(ML_ERROR,\n\t\t     \"blocksize %u incorrect for device, expected %d\",\n\t\t     reg->hr_block_bytes, sectsize);\n\t\tret = -EINVAL;\n\t\tgoto out3;\n\t}\n\n\to2hb_init_region_params(reg);\n\n\t/* Generation of zero is invalid */\n\tdo {\n\t\tget_random_bytes(&reg->hr_generation,\n\t\t\t\t sizeof(reg->hr_generation));\n\t} while (reg->hr_generation == 0);\n\n\tret = o2hb_map_slot_data(reg);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out3;\n\t}\n\n\tret = o2hb_populate_slot_data(reg);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out3;\n\t}\n\n\tINIT_DELAYED_WORK(&reg->hr_write_timeout_work, o2hb_write_timeout);\n\n\t/*\n\t * A node is considered live after it has beat LIVE_THRESHOLD\n\t * times.  We're not steady until we've given them a chance\n\t * _after_ our first read.\n\t * The default threshold is bare minimum so as to limit the delay\n\t * during mounts. For global heartbeat, the threshold doubled for the\n\t * first region.\n\t */\n\tlive_threshold = O2HB_LIVE_THRESHOLD;\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (bitmap_weight(o2hb_region_bitmap, O2NM_MAX_REGIONS) == 1)\n\t\t\tlive_threshold <<= 1;\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\t++live_threshold;\n\tatomic_set(&reg->hr_steady_iterations, live_threshold);\n\t/* unsteady_iterations is double the steady_iterations */\n\tatomic_set(&reg->hr_unsteady_iterations, (live_threshold << 1));\n\n\thb_task = kthread_run(o2hb_thread, reg, \"o2hb-%s\",\n\t\t\t      reg->hr_item.ci_name);\n\tif (IS_ERR(hb_task)) {\n\t\tret = PTR_ERR(hb_task);\n\t\tmlog_errno(ret);\n\t\tgoto out3;\n\t}\n\n\tspin_lock(&o2hb_live_lock);\n\treg->hr_task = hb_task;\n\tspin_unlock(&o2hb_live_lock);\n\n\tret = wait_event_interruptible(o2hb_steady_queue,\n\t\t\t\tatomic_read(&reg->hr_steady_iterations) == 0);\n\tif (ret) {\n\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\treg->hr_aborted_start = 1;\n\t}\n\n\tif (reg->hr_aborted_start) {\n\t\tret = -EIO;\n\t\tgoto out3;\n\t}\n\n\t/* Ok, we were woken.  Make sure it wasn't by drop_item() */\n\tspin_lock(&o2hb_live_lock);\n\thb_task = reg->hr_task;\n\tif (o2hb_global_heartbeat_active())\n\t\tset_bit(reg->hr_region_num, o2hb_live_region_bitmap);\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (hb_task)\n\t\tret = count;\n\telse\n\t\tret = -EIO;\n\n\tif (hb_task && o2hb_global_heartbeat_active())\n\t\tprintk(KERN_NOTICE \"o2hb: Heartbeat started on region %s (%s)\\n\",\n\t\t       config_item_name(&reg->hr_item), reg->hr_dev_name);\n\nout3:\n\tiput(inode);\nout2:\n\tfdput(f);\nout:\n\tif (ret < 0) {\n\t\tif (reg->hr_bdev) {\n\t\t\tblkdev_put(reg->hr_bdev, FMODE_READ|FMODE_WRITE);\n\t\t\treg->hr_bdev = NULL;\n\t\t}\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);",
      "static unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blkdev_put",
          "args": [
            "reg->hr_bdev",
            "FMODE_READ|FMODE_WRITE"
          ],
          "line": 1866
        },
        "resolved": true,
        "details": {
          "function_name": "blkdev_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "1519-1564",
          "snippet": "void blkdev_put(struct block_device *bdev, fmode_t mode)\n{\n\tmutex_lock(&bdev->bd_mutex);\n\n\tif (mode & FMODE_EXCL) {\n\t\tbool bdev_free;\n\n\t\t/*\n\t\t * Release a claim on the device.  The holder fields\n\t\t * are protected with bdev_lock.  bd_mutex is to\n\t\t * synchronize disk_holder unlinking.\n\t\t */\n\t\tspin_lock(&bdev_lock);\n\n\t\tWARN_ON_ONCE(--bdev->bd_holders < 0);\n\t\tWARN_ON_ONCE(--bdev->bd_contains->bd_holders < 0);\n\n\t\t/* bd_contains might point to self, check in a separate step */\n\t\tif ((bdev_free = !bdev->bd_holders))\n\t\t\tbdev->bd_holder = NULL;\n\t\tif (!bdev->bd_contains->bd_holders)\n\t\t\tbdev->bd_contains->bd_holder = NULL;\n\n\t\tspin_unlock(&bdev_lock);\n\n\t\t/*\n\t\t * If this was the last claim, remove holder link and\n\t\t * unblock evpoll if it was a write holder.\n\t\t */\n\t\tif (bdev_free && bdev->bd_write_holder) {\n\t\t\tdisk_unblock_events(bdev->bd_disk);\n\t\t\tbdev->bd_write_holder = false;\n\t\t}\n\t}\n\n\t/*\n\t * Trigger event checking and tell drivers to flush MEDIA_CHANGE\n\t * event.  This is to ensure detection of media removal commanded\n\t * from userland - e.g. eject(1).\n\t */\n\tdisk_flush_events(bdev->bd_disk, DISK_EVENT_MEDIA_CHANGE);\n\n\tmutex_unlock(&bdev->bd_mutex);\n\n\t__blkdev_put(bdev, mode, 0);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static  __cacheline_aligned_in_smp DEFINE_SPINLOCK(bdev_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic  __cacheline_aligned_in_smp DEFINE_SPINLOCK(bdev_lock);\n\nvoid blkdev_put(struct block_device *bdev, fmode_t mode)\n{\n\tmutex_lock(&bdev->bd_mutex);\n\n\tif (mode & FMODE_EXCL) {\n\t\tbool bdev_free;\n\n\t\t/*\n\t\t * Release a claim on the device.  The holder fields\n\t\t * are protected with bdev_lock.  bd_mutex is to\n\t\t * synchronize disk_holder unlinking.\n\t\t */\n\t\tspin_lock(&bdev_lock);\n\n\t\tWARN_ON_ONCE(--bdev->bd_holders < 0);\n\t\tWARN_ON_ONCE(--bdev->bd_contains->bd_holders < 0);\n\n\t\t/* bd_contains might point to self, check in a separate step */\n\t\tif ((bdev_free = !bdev->bd_holders))\n\t\t\tbdev->bd_holder = NULL;\n\t\tif (!bdev->bd_contains->bd_holders)\n\t\t\tbdev->bd_contains->bd_holder = NULL;\n\n\t\tspin_unlock(&bdev_lock);\n\n\t\t/*\n\t\t * If this was the last claim, remove holder link and\n\t\t * unblock evpoll if it was a write holder.\n\t\t */\n\t\tif (bdev_free && bdev->bd_write_holder) {\n\t\t\tdisk_unblock_events(bdev->bd_disk);\n\t\t\tbdev->bd_write_holder = false;\n\t\t}\n\t}\n\n\t/*\n\t * Trigger event checking and tell drivers to flush MEDIA_CHANGE\n\t * event.  This is to ensure detection of media removal commanded\n\t * from userland - e.g. eject(1).\n\t */\n\tdisk_flush_events(bdev->bd_disk, DISK_EVENT_MEDIA_CHANGE);\n\n\tmutex_unlock(&bdev->bd_mutex);\n\n\t__blkdev_put(bdev, mode, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "fdput_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "273-278",
          "snippet": "static inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 1860
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"o2hb: Heartbeat started on region %s (%s)\\n\"",
            "config_item_name(&reg->hr_item)",
            "reg->hr_dev_name"
          ],
          "line": 1856
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 1857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1848
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_live_region_bitmap"
          ],
          "line": 1847
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "84-88",
          "snippet": "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1844
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&reg->hr_steady_iterations",
            "0"
          ],
          "line": 1834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible",
          "args": [
            "o2hb_steady_queue",
            "atomic_read(&reg->hr_steady_iterations) == 0"
          ],
          "line": 1831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 1832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "hb_task"
          ],
          "line": 1822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "hb_task"
          ],
          "line": 1821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_run",
          "args": [
            "o2hb_thread",
            "reg",
            "\"o2hb-%s\"",
            "reg->hr_item.ci_name"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&reg->hr_unsteady_iterations",
            "(live_threshold << 1)"
          ],
          "line": 1817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&reg->hr_steady_iterations",
            "live_threshold"
          ],
          "line": 1815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_weight",
          "args": [
            "o2hb_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 1810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_DELAYED_WORK",
          "args": [
            "&reg->hr_write_timeout_work",
            "o2hb_write_timeout"
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_populate_slot_data",
          "args": [
            "reg"
          ],
          "line": 1791
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_populate_slot_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1684-1712",
          "snippet": "static int o2hb_populate_slot_data(struct o2hb_region *reg)\n{\n\tint ret, i;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tret = o2hb_read_slots(reg, reg->hr_blocks);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out;\n\t}\n\n\t/* We only want to get an idea of the values initially in each\n\t * slot, so we do no verification - o2hb_check_slot will\n\t * actually determine if each configured slot is valid and\n\t * whether any values have changed. */\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\thb_block = (struct o2hb_disk_heartbeat_block *) slot->ds_raw_block;\n\n\t\t/* Only fill the values that o2hb_check_slot uses to\n\t\t * determine changing slots */\n\t\tslot->ds_last_time = le64_to_cpu(hb_block->hb_seq);\n\t\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\t}\n\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_populate_slot_data(struct o2hb_region *reg)\n{\n\tint ret, i;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tret = o2hb_read_slots(reg, reg->hr_blocks);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out;\n\t}\n\n\t/* We only want to get an idea of the values initially in each\n\t * slot, so we do no verification - o2hb_check_slot will\n\t * actually determine if each configured slot is valid and\n\t * whether any values have changed. */\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\thb_block = (struct o2hb_disk_heartbeat_block *) slot->ds_raw_block;\n\n\t\t/* Only fill the values that o2hb_check_slot uses to\n\t\t * determine changing slots */\n\t\tslot->ds_last_time = le64_to_cpu(hb_block->hb_seq);\n\t\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\t}\n\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_map_slot_data",
          "args": [
            "reg"
          ],
          "line": 1785
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_map_slot_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1613-1679",
          "snippet": "static int o2hb_map_slot_data(struct o2hb_region *reg)\n{\n\tint i, j;\n\tunsigned int last_slot;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tstruct page *page;\n\tchar *raw;\n\tstruct o2hb_disk_slot *slot;\n\n\treg->hr_tmp_block = kmalloc(reg->hr_block_bytes, GFP_KERNEL);\n\tif (reg->hr_tmp_block == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\treg->hr_slots = kcalloc(reg->hr_blocks,\n\t\t\t\tsizeof(struct o2hb_disk_slot), GFP_KERNEL);\n\tif (reg->hr_slots == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\tslot->ds_node_num = i;\n\t\tINIT_LIST_HEAD(&slot->ds_live_item);\n\t\tslot->ds_raw_block = NULL;\n\t}\n\n\treg->hr_num_pages = (reg->hr_blocks + spp - 1) / spp;\n\tmlog(ML_HEARTBEAT, \"Going to require %u pages to cover %u blocks \"\n\t\t\t   \"at %u blocks per page\\n\",\n\t     reg->hr_num_pages, reg->hr_blocks, spp);\n\n\treg->hr_slot_data = kcalloc(reg->hr_num_pages, sizeof(struct page *),\n\t\t\t\t    GFP_KERNEL);\n\tif (!reg->hr_slot_data) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_num_pages; i++) {\n\t\tpage = alloc_page(GFP_KERNEL);\n\t\tif (!page) {\n\t\t\tmlog_errno(-ENOMEM);\n\t\t\treturn -ENOMEM;\n\t\t}\n\n\t\treg->hr_slot_data[i] = page;\n\n\t\tlast_slot = i * spp;\n\t\traw = page_address(page);\n\t\tfor (j = 0;\n\t\t     (j < spp) && ((j + last_slot) < reg->hr_blocks);\n\t\t     j++) {\n\t\t\tBUG_ON((j + last_slot) >= reg->hr_blocks);\n\n\t\t\tslot = &reg->hr_slots[j + last_slot];\n\t\t\tslot->ds_raw_block =\n\t\t\t\t(struct o2hb_disk_heartbeat_block *) raw;\n\n\t\t\traw += reg->hr_block_bytes;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_map_slot_data(struct o2hb_region *reg)\n{\n\tint i, j;\n\tunsigned int last_slot;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tstruct page *page;\n\tchar *raw;\n\tstruct o2hb_disk_slot *slot;\n\n\treg->hr_tmp_block = kmalloc(reg->hr_block_bytes, GFP_KERNEL);\n\tif (reg->hr_tmp_block == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\treg->hr_slots = kcalloc(reg->hr_blocks,\n\t\t\t\tsizeof(struct o2hb_disk_slot), GFP_KERNEL);\n\tif (reg->hr_slots == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\tslot->ds_node_num = i;\n\t\tINIT_LIST_HEAD(&slot->ds_live_item);\n\t\tslot->ds_raw_block = NULL;\n\t}\n\n\treg->hr_num_pages = (reg->hr_blocks + spp - 1) / spp;\n\tmlog(ML_HEARTBEAT, \"Going to require %u pages to cover %u blocks \"\n\t\t\t   \"at %u blocks per page\\n\",\n\t     reg->hr_num_pages, reg->hr_blocks, spp);\n\n\treg->hr_slot_data = kcalloc(reg->hr_num_pages, sizeof(struct page *),\n\t\t\t\t    GFP_KERNEL);\n\tif (!reg->hr_slot_data) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_num_pages; i++) {\n\t\tpage = alloc_page(GFP_KERNEL);\n\t\tif (!page) {\n\t\t\tmlog_errno(-ENOMEM);\n\t\t\treturn -ENOMEM;\n\t\t}\n\n\t\treg->hr_slot_data[i] = page;\n\n\t\tlast_slot = i * spp;\n\t\traw = page_address(page);\n\t\tfor (j = 0;\n\t\t     (j < spp) && ((j + last_slot) < reg->hr_blocks);\n\t\t     j++) {\n\t\t\tBUG_ON((j + last_slot) >= reg->hr_blocks);\n\n\t\t\tslot = &reg->hr_slots[j + last_slot];\n\t\t\tslot->ds_raw_block =\n\t\t\t\t(struct o2hb_disk_heartbeat_block *) raw;\n\n\t\t\traw += reg->hr_block_bytes;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_random_bytes",
          "args": [
            "&reg->hr_generation",
            "sizeof(reg->hr_generation)"
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_init_region_params",
          "args": [
            "reg"
          ],
          "line": 1777
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_init_region_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1600-1611",
          "snippet": "static void o2hb_init_region_params(struct o2hb_region *reg)\n{\n\treg->hr_slots_per_page = PAGE_CACHE_SIZE >> reg->hr_block_bits;\n\treg->hr_timeout_ms = O2HB_REGION_TIMEOUT_MS;\n\n\tmlog(ML_HEARTBEAT, \"hr_start_block = %llu, hr_blocks = %u\\n\",\n\t     reg->hr_start_block, reg->hr_blocks);\n\tmlog(ML_HEARTBEAT, \"hr_block_bytes = %u, hr_block_bits = %u\\n\",\n\t     reg->hr_block_bytes, reg->hr_block_bits);\n\tmlog(ML_HEARTBEAT, \"hr_timeout_ms = %u\\n\", reg->hr_timeout_ms);\n\tmlog(ML_HEARTBEAT, \"dead threshold = %u\\n\", o2hb_dead_threshold);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic void o2hb_init_region_params(struct o2hb_region *reg)\n{\n\treg->hr_slots_per_page = PAGE_CACHE_SIZE >> reg->hr_block_bits;\n\treg->hr_timeout_ms = O2HB_REGION_TIMEOUT_MS;\n\n\tmlog(ML_HEARTBEAT, \"hr_start_block = %llu, hr_blocks = %u\\n\",\n\t     reg->hr_start_block, reg->hr_blocks);\n\tmlog(ML_HEARTBEAT, \"hr_block_bytes = %u, hr_block_bits = %u\\n\",\n\t     reg->hr_block_bytes, reg->hr_block_bits);\n\tmlog(ML_HEARTBEAT, \"hr_timeout_ms = %u\\n\", reg->hr_timeout_ms);\n\tmlog(ML_HEARTBEAT, \"dead threshold = %u\\n\", o2hb_dead_threshold);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"blocksize %u incorrect for device, expected %d\"",
            "reg->hr_block_bytes",
            "sectsize"
          ],
          "line": 1770
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bdev_logical_block_size",
          "args": [
            "reg->hr_bdev"
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdevname",
          "args": [
            "reg->hr_bdev",
            "reg->hr_dev_name"
          ],
          "line": 1766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blkdev_get",
          "args": [
            "reg->hr_bdev",
            "FMODE_WRITE | FMODE_READ",
            "NULL"
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "blkdev_get_by_dev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "1432-1446",
          "snippet": "struct block_device *blkdev_get_by_dev(dev_t dev, fmode_t mode, void *holder)\n{\n\tstruct block_device *bdev;\n\tint err;\n\n\tbdev = bdget(dev);\n\tif (!bdev)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terr = blkdev_get(bdev, mode, holder);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\treturn bdev;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstruct block_device *blkdev_get_by_dev(dev_t dev, fmode_t mode, void *holder)\n{\n\tstruct block_device *bdev;\n\tint err;\n\n\tbdev = bdget(dev);\n\tif (!bdev)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terr = blkdev_get(bdev, mode, holder);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\treturn bdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "I_BDEV",
          "args": [
            "f.file->f_mapping->host"
          ],
          "line": 1758
        },
        "resolved": true,
        "details": {
          "function_name": "I_BDEV",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "46-49",
          "snippet": "inline struct block_device *I_BDEV(struct inode *inode)\n{\n\treturn &BDEV_I(inode)->bdev;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\ninline struct block_device *I_BDEV(struct inode *inode)\n{\n\treturn &BDEV_I(inode)->bdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "inode->i_mode"
          ],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "igrab",
          "args": [
            "f.file->f_mapping->host"
          ],
          "line": 1751
        },
        "resolved": true,
        "details": {
          "function_name": "igrab",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1173-1189",
          "snippet": "struct inode *igrab(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tif (!(inode->i_state & (I_FREEING|I_WILL_FREE))) {\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t} else {\n\t\tspin_unlock(&inode->i_lock);\n\t\t/*\n\t\t * Handle the case where s_op->clear_inode is not been\n\t\t * called yet, and somebody is calling igrab\n\t\t * while the inode is getting freed.\n\t\t */\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstruct inode *igrab(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tif (!(inode->i_state & (I_FREEING|I_WILL_FREE))) {\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t} else {\n\t\tspin_unlock(&inode->i_lock);\n\t\t/*\n\t\t * Handle the case where s_op->clear_inode is not been\n\t\t * called yet, and somebody is calling igrab\n\t\t * while the inode is getting freed.\n\t\t */\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdget",
          "args": [
            "fd"
          ],
          "line": 1743
        },
        "resolved": true,
        "details": {
          "function_name": "__fdget_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/file.c",
          "lines": "706-718",
          "snippet": "unsigned long __fdget_pos(unsigned int fd)\n{\n\tunsigned long v = __fdget(fd);\n\tstruct file *file = (struct file *)(v & ~3);\n\n\tif (file && (file->f_mode & FMODE_ATOMIC_POS)) {\n\t\tif (file_count(file) > 1) {\n\t\t\tv |= FDPUT_POS_UNLOCK;\n\t\t\tmutex_lock(&file->f_pos_lock);\n\t\t}\n\t}\n\treturn v;\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/time.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/rcupdate.h>\n#include <linux/spinlock.h>\n#include <linux/interrupt.h>\n#include <linux/bitops.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/time.h>\n#include <linux/mmzone.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nunsigned long __fdget_pos(unsigned int fd)\n{\n\tunsigned long v = __fdget(fd);\n\tstruct file *file = (struct file *)(v & ~3);\n\n\tif (file && (file->f_mode & FMODE_ATOMIC_POS)) {\n\t\tif (file_count(file) > 1) {\n\t\t\tv |= FDPUT_POS_UNLOCK;\n\t\t\tmutex_lock(&file->f_pos_lock);\n\t\t}\n\t}\n\treturn v;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "p",
            "&p",
            "0"
          ],
          "line": 1736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2nm_this_node",
          "args": [],
          "line": 1733
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "143-151",
          "snippet": "u8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nu8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);\nstatic unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\n\nstatic ssize_t o2hb_region_dev_write(struct o2hb_region *reg,\n\t\t\t\t     const char *page,\n\t\t\t\t     size_t count)\n{\n\tstruct task_struct *hb_task;\n\tlong fd;\n\tint sectsize;\n\tchar *p = (char *)page;\n\tstruct fd f;\n\tstruct inode *inode;\n\tssize_t ret = -EINVAL;\n\tint live_threshold;\n\n\tif (reg->hr_bdev)\n\t\tgoto out;\n\n\t/* We can't heartbeat without having had our node number\n\t * configured yet. */\n\tif (o2nm_this_node() == O2NM_MAX_NODES)\n\t\tgoto out;\n\n\tfd = simple_strtol(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\tgoto out;\n\n\tif (fd < 0 || fd >= INT_MAX)\n\t\tgoto out;\n\n\tf = fdget(fd);\n\tif (f.file == NULL)\n\t\tgoto out;\n\n\tif (reg->hr_blocks == 0 || reg->hr_start_block == 0 ||\n\t    reg->hr_block_bytes == 0)\n\t\tgoto out2;\n\n\tinode = igrab(f.file->f_mapping->host);\n\tif (inode == NULL)\n\t\tgoto out2;\n\n\tif (!S_ISBLK(inode->i_mode))\n\t\tgoto out3;\n\n\treg->hr_bdev = I_BDEV(f.file->f_mapping->host);\n\tret = blkdev_get(reg->hr_bdev, FMODE_WRITE | FMODE_READ, NULL);\n\tif (ret) {\n\t\treg->hr_bdev = NULL;\n\t\tgoto out3;\n\t}\n\tinode = NULL;\n\n\tbdevname(reg->hr_bdev, reg->hr_dev_name);\n\n\tsectsize = bdev_logical_block_size(reg->hr_bdev);\n\tif (sectsize != reg->hr_block_bytes) {\n\t\tmlog(ML_ERROR,\n\t\t     \"blocksize %u incorrect for device, expected %d\",\n\t\t     reg->hr_block_bytes, sectsize);\n\t\tret = -EINVAL;\n\t\tgoto out3;\n\t}\n\n\to2hb_init_region_params(reg);\n\n\t/* Generation of zero is invalid */\n\tdo {\n\t\tget_random_bytes(&reg->hr_generation,\n\t\t\t\t sizeof(reg->hr_generation));\n\t} while (reg->hr_generation == 0);\n\n\tret = o2hb_map_slot_data(reg);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out3;\n\t}\n\n\tret = o2hb_populate_slot_data(reg);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out3;\n\t}\n\n\tINIT_DELAYED_WORK(&reg->hr_write_timeout_work, o2hb_write_timeout);\n\n\t/*\n\t * A node is considered live after it has beat LIVE_THRESHOLD\n\t * times.  We're not steady until we've given them a chance\n\t * _after_ our first read.\n\t * The default threshold is bare minimum so as to limit the delay\n\t * during mounts. For global heartbeat, the threshold doubled for the\n\t * first region.\n\t */\n\tlive_threshold = O2HB_LIVE_THRESHOLD;\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (bitmap_weight(o2hb_region_bitmap, O2NM_MAX_REGIONS) == 1)\n\t\t\tlive_threshold <<= 1;\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\t++live_threshold;\n\tatomic_set(&reg->hr_steady_iterations, live_threshold);\n\t/* unsteady_iterations is double the steady_iterations */\n\tatomic_set(&reg->hr_unsteady_iterations, (live_threshold << 1));\n\n\thb_task = kthread_run(o2hb_thread, reg, \"o2hb-%s\",\n\t\t\t      reg->hr_item.ci_name);\n\tif (IS_ERR(hb_task)) {\n\t\tret = PTR_ERR(hb_task);\n\t\tmlog_errno(ret);\n\t\tgoto out3;\n\t}\n\n\tspin_lock(&o2hb_live_lock);\n\treg->hr_task = hb_task;\n\tspin_unlock(&o2hb_live_lock);\n\n\tret = wait_event_interruptible(o2hb_steady_queue,\n\t\t\t\tatomic_read(&reg->hr_steady_iterations) == 0);\n\tif (ret) {\n\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\treg->hr_aborted_start = 1;\n\t}\n\n\tif (reg->hr_aborted_start) {\n\t\tret = -EIO;\n\t\tgoto out3;\n\t}\n\n\t/* Ok, we were woken.  Make sure it wasn't by drop_item() */\n\tspin_lock(&o2hb_live_lock);\n\thb_task = reg->hr_task;\n\tif (o2hb_global_heartbeat_active())\n\t\tset_bit(reg->hr_region_num, o2hb_live_region_bitmap);\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (hb_task)\n\t\tret = count;\n\telse\n\t\tret = -EIO;\n\n\tif (hb_task && o2hb_global_heartbeat_active())\n\t\tprintk(KERN_NOTICE \"o2hb: Heartbeat started on region %s (%s)\\n\",\n\t\t       config_item_name(&reg->hr_item), reg->hr_dev_name);\n\nout3:\n\tiput(inode);\nout2:\n\tfdput(f);\nout:\n\tif (ret < 0) {\n\t\tif (reg->hr_bdev) {\n\t\t\tblkdev_put(reg->hr_bdev, FMODE_READ|FMODE_WRITE);\n\t\t\treg->hr_bdev = NULL;\n\t\t}\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_populate_slot_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1684-1712",
    "snippet": "static int o2hb_populate_slot_data(struct o2hb_region *reg)\n{\n\tint ret, i;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tret = o2hb_read_slots(reg, reg->hr_blocks);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out;\n\t}\n\n\t/* We only want to get an idea of the values initially in each\n\t * slot, so we do no verification - o2hb_check_slot will\n\t * actually determine if each configured slot is valid and\n\t * whether any values have changed. */\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\thb_block = (struct o2hb_disk_heartbeat_block *) slot->ds_raw_block;\n\n\t\t/* Only fill the values that o2hb_check_slot uses to\n\t\t * determine changing slots */\n\t\tslot->ds_last_time = le64_to_cpu(hb_block->hb_seq);\n\t\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\t}\n\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "hb_block->hb_generation"
          ],
          "line": 1707
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_read_slots",
          "args": [
            "reg",
            "reg->hr_blocks"
          ],
          "line": 1690
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_read_slots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "444-474",
          "snippet": "static int o2hb_read_slots(struct o2hb_region *reg,\n\t\t\t   unsigned int max_slots)\n{\n\tunsigned int current_slot=0;\n\tint status;\n\tstruct o2hb_bio_wait_ctxt wc;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(&wc);\n\n\twhile(current_slot < max_slots) {\n\t\tbio = o2hb_setup_one_bio(reg, &wc, &current_slot, max_slots);\n\t\tif (IS_ERR(bio)) {\n\t\t\tstatus = PTR_ERR(bio);\n\t\t\tmlog_errno(status);\n\t\t\tgoto bail_and_wait;\n\t\t}\n\n\t\tatomic_inc(&wc.wc_num_reqs);\n\t\tsubmit_bio(READ, bio);\n\t}\n\n\tstatus = 0;\n\nbail_and_wait:\n\to2hb_wait_on_io(reg, &wc);\n\tif (wc.wc_error && !status)\n\t\tstatus = wc.wc_error;\n\n\treturn status;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_read_slots(struct o2hb_region *reg,\n\t\t\t   unsigned int max_slots)\n{\n\tunsigned int current_slot=0;\n\tint status;\n\tstruct o2hb_bio_wait_ctxt wc;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(&wc);\n\n\twhile(current_slot < max_slots) {\n\t\tbio = o2hb_setup_one_bio(reg, &wc, &current_slot, max_slots);\n\t\tif (IS_ERR(bio)) {\n\t\t\tstatus = PTR_ERR(bio);\n\t\t\tmlog_errno(status);\n\t\t\tgoto bail_and_wait;\n\t\t}\n\n\t\tatomic_inc(&wc.wc_num_reqs);\n\t\tsubmit_bio(READ, bio);\n\t}\n\n\tstatus = 0;\n\nbail_and_wait:\n\to2hb_wait_on_io(reg, &wc);\n\tif (wc.wc_error && !status)\n\t\tstatus = wc.wc_error;\n\n\treturn status;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_populate_slot_data(struct o2hb_region *reg)\n{\n\tint ret, i;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tret = o2hb_read_slots(reg, reg->hr_blocks);\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto out;\n\t}\n\n\t/* We only want to get an idea of the values initially in each\n\t * slot, so we do no verification - o2hb_check_slot will\n\t * actually determine if each configured slot is valid and\n\t * whether any values have changed. */\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\thb_block = (struct o2hb_disk_heartbeat_block *) slot->ds_raw_block;\n\n\t\t/* Only fill the values that o2hb_check_slot uses to\n\t\t * determine changing slots */\n\t\tslot->ds_last_time = le64_to_cpu(hb_block->hb_seq);\n\t\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\t}\n\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_map_slot_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1613-1679",
    "snippet": "static int o2hb_map_slot_data(struct o2hb_region *reg)\n{\n\tint i, j;\n\tunsigned int last_slot;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tstruct page *page;\n\tchar *raw;\n\tstruct o2hb_disk_slot *slot;\n\n\treg->hr_tmp_block = kmalloc(reg->hr_block_bytes, GFP_KERNEL);\n\tif (reg->hr_tmp_block == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\treg->hr_slots = kcalloc(reg->hr_blocks,\n\t\t\t\tsizeof(struct o2hb_disk_slot), GFP_KERNEL);\n\tif (reg->hr_slots == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\tslot->ds_node_num = i;\n\t\tINIT_LIST_HEAD(&slot->ds_live_item);\n\t\tslot->ds_raw_block = NULL;\n\t}\n\n\treg->hr_num_pages = (reg->hr_blocks + spp - 1) / spp;\n\tmlog(ML_HEARTBEAT, \"Going to require %u pages to cover %u blocks \"\n\t\t\t   \"at %u blocks per page\\n\",\n\t     reg->hr_num_pages, reg->hr_blocks, spp);\n\n\treg->hr_slot_data = kcalloc(reg->hr_num_pages, sizeof(struct page *),\n\t\t\t\t    GFP_KERNEL);\n\tif (!reg->hr_slot_data) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_num_pages; i++) {\n\t\tpage = alloc_page(GFP_KERNEL);\n\t\tif (!page) {\n\t\t\tmlog_errno(-ENOMEM);\n\t\t\treturn -ENOMEM;\n\t\t}\n\n\t\treg->hr_slot_data[i] = page;\n\n\t\tlast_slot = i * spp;\n\t\traw = page_address(page);\n\t\tfor (j = 0;\n\t\t     (j < spp) && ((j + last_slot) < reg->hr_blocks);\n\t\t     j++) {\n\t\t\tBUG_ON((j + last_slot) >= reg->hr_blocks);\n\n\t\t\tslot = &reg->hr_slots[j + last_slot];\n\t\t\tslot->ds_raw_block =\n\t\t\t\t(struct o2hb_disk_heartbeat_block *) raw;\n\n\t\t\traw += reg->hr_block_bytes;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(j + last_slot) >= reg->hr_blocks"
          ],
          "line": 1668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 1664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 1657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_page",
          "args": [
            "GFP_KERNEL"
          ],
          "line": 1655
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_alloc_pagevec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdomain.c",
          "lines": "86-105",
          "snippet": "static void **dlm_alloc_pagevec(int pages)\n{\n\tvoid **vec = kmalloc(pages * sizeof(void *), GFP_KERNEL);\n\tint i;\n\n\tif (!vec)\n\t\treturn NULL;\n\n\tfor (i = 0; i < pages; i++)\n\t\tif (!(vec[i] = (void *)__get_free_page(GFP_KERNEL)))\n\t\t\tgoto out_free;\n\n\tmlog(0, \"Allocated DLM hash pagevec; %d pages (%lu expected), %lu buckets per page\\n\",\n\t     pages, (unsigned long)DLM_HASH_PAGES,\n\t     (unsigned long)DLM_BUCKETS_PER_PAGE);\n\treturn vec;\nout_free:\n\tdlm_free_pagevec(vec, i);\n\treturn NULL;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/err.h>",
            "#include <linux/delay.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/debugfs.h>\n#include <linux/err.h>\n#include <linux/delay.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void **dlm_alloc_pagevec(int pages)\n{\n\tvoid **vec = kmalloc(pages * sizeof(void *), GFP_KERNEL);\n\tint i;\n\n\tif (!vec)\n\t\treturn NULL;\n\n\tfor (i = 0; i < pages; i++)\n\t\tif (!(vec[i] = (void *)__get_free_page(GFP_KERNEL)))\n\t\t\tgoto out_free;\n\n\tmlog(0, \"Allocated DLM hash pagevec; %d pages (%lu expected), %lu buckets per page\\n\",\n\t     pages, (unsigned long)DLM_HASH_PAGES,\n\t     (unsigned long)DLM_BUCKETS_PER_PAGE);\n\treturn vec;\nout_free:\n\tdlm_free_pagevec(vec, i);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "reg->hr_num_pages",
            "sizeof(struct page *)",
            "GFP_KERNEL"
          ],
          "line": 1647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Going to require %u pages to cover %u blocks \"\n\t\t\t   \"at %u blocks per page\\n\"",
            "reg->hr_num_pages",
            "reg->hr_blocks",
            "spp"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&slot->ds_live_item"
          ],
          "line": 1638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 1631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "reg->hr_blocks",
            "sizeof(struct o2hb_disk_slot)",
            "GFP_KERNEL"
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "reg->hr_block_bytes",
            "GFP_KERNEL"
          ],
          "line": 1622
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_map_slot_data(struct o2hb_region *reg)\n{\n\tint i, j;\n\tunsigned int last_slot;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tstruct page *page;\n\tchar *raw;\n\tstruct o2hb_disk_slot *slot;\n\n\treg->hr_tmp_block = kmalloc(reg->hr_block_bytes, GFP_KERNEL);\n\tif (reg->hr_tmp_block == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\treg->hr_slots = kcalloc(reg->hr_blocks,\n\t\t\t\tsizeof(struct o2hb_disk_slot), GFP_KERNEL);\n\tif (reg->hr_slots == NULL) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_blocks; i++) {\n\t\tslot = &reg->hr_slots[i];\n\t\tslot->ds_node_num = i;\n\t\tINIT_LIST_HEAD(&slot->ds_live_item);\n\t\tslot->ds_raw_block = NULL;\n\t}\n\n\treg->hr_num_pages = (reg->hr_blocks + spp - 1) / spp;\n\tmlog(ML_HEARTBEAT, \"Going to require %u pages to cover %u blocks \"\n\t\t\t   \"at %u blocks per page\\n\",\n\t     reg->hr_num_pages, reg->hr_blocks, spp);\n\n\treg->hr_slot_data = kcalloc(reg->hr_num_pages, sizeof(struct page *),\n\t\t\t\t    GFP_KERNEL);\n\tif (!reg->hr_slot_data) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor(i = 0; i < reg->hr_num_pages; i++) {\n\t\tpage = alloc_page(GFP_KERNEL);\n\t\tif (!page) {\n\t\t\tmlog_errno(-ENOMEM);\n\t\t\treturn -ENOMEM;\n\t\t}\n\n\t\treg->hr_slot_data[i] = page;\n\n\t\tlast_slot = i * spp;\n\t\traw = page_address(page);\n\t\tfor (j = 0;\n\t\t     (j < spp) && ((j + last_slot) < reg->hr_blocks);\n\t\t     j++) {\n\t\t\tBUG_ON((j + last_slot) >= reg->hr_blocks);\n\n\t\t\tslot = &reg->hr_slots[j + last_slot];\n\t\t\tslot->ds_raw_block =\n\t\t\t\t(struct o2hb_disk_heartbeat_block *) raw;\n\n\t\t\traw += reg->hr_block_bytes;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_init_region_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1600-1611",
    "snippet": "static void o2hb_init_region_params(struct o2hb_region *reg)\n{\n\treg->hr_slots_per_page = PAGE_CACHE_SIZE >> reg->hr_block_bits;\n\treg->hr_timeout_ms = O2HB_REGION_TIMEOUT_MS;\n\n\tmlog(ML_HEARTBEAT, \"hr_start_block = %llu, hr_blocks = %u\\n\",\n\t     reg->hr_start_block, reg->hr_blocks);\n\tmlog(ML_HEARTBEAT, \"hr_block_bytes = %u, hr_block_bits = %u\\n\",\n\t     reg->hr_block_bytes, reg->hr_block_bits);\n\tmlog(ML_HEARTBEAT, \"hr_timeout_ms = %u\\n\", reg->hr_timeout_ms);\n\tmlog(ML_HEARTBEAT, \"dead threshold = %u\\n\", o2hb_dead_threshold);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"dead threshold = %u\\n\"",
            "o2hb_dead_threshold"
          ],
          "line": 1610
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"hr_block_bytes = %u, hr_block_bits = %u\\n\"",
            "reg->hr_block_bytes",
            "reg->hr_block_bits"
          ],
          "line": 1607
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic void o2hb_init_region_params(struct o2hb_region *reg)\n{\n\treg->hr_slots_per_page = PAGE_CACHE_SIZE >> reg->hr_block_bits;\n\treg->hr_timeout_ms = O2HB_REGION_TIMEOUT_MS;\n\n\tmlog(ML_HEARTBEAT, \"hr_start_block = %llu, hr_blocks = %u\\n\",\n\t     reg->hr_start_block, reg->hr_blocks);\n\tmlog(ML_HEARTBEAT, \"hr_block_bytes = %u, hr_block_bits = %u\\n\",\n\t     reg->hr_block_bytes, reg->hr_block_bits);\n\tmlog(ML_HEARTBEAT, \"hr_timeout_ms = %u\\n\", reg->hr_timeout_ms);\n\tmlog(ML_HEARTBEAT, \"dead threshold = %u\\n\", o2hb_dead_threshold);\n}"
  },
  {
    "function_name": "o2hb_region_dev_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1589-1598",
    "snippet": "static ssize_t o2hb_region_dev_read(struct o2hb_region *reg,\n\t\t\t\t    char *page)\n{\n\tunsigned int ret = 0;\n\n\tif (reg->hr_bdev)\n\t\tret = sprintf(page, \"%s\\n\", reg->hr_dev_name);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%s\\n\"",
            "reg->hr_dev_name"
          ],
          "line": 1595
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_dev_read(struct o2hb_region *reg,\n\t\t\t\t    char *page)\n{\n\tunsigned int ret = 0;\n\n\tif (reg->hr_bdev)\n\t\tret = sprintf(page, \"%s\\n\", reg->hr_dev_name);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_region_blocks_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1567-1587",
    "snippet": "static ssize_t o2hb_region_blocks_write(struct o2hb_region *reg,\n\t\t\t\t\tconst char *page,\n\t\t\t\t\tsize_t count)\n{\n\tunsigned long tmp;\n\tchar *p = (char *)page;\n\n\tif (reg->hr_bdev)\n\t\treturn -EINVAL;\n\n\ttmp = simple_strtoul(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\tif (tmp > O2NM_MAX_NODES || tmp == 0)\n\t\treturn -ERANGE;\n\n\treg->hr_blocks = (unsigned int)tmp;\n\n\treturn count;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "p",
            "&p",
            "0"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_blocks_write(struct o2hb_region *reg,\n\t\t\t\t\tconst char *page,\n\t\t\t\t\tsize_t count)\n{\n\tunsigned long tmp;\n\tchar *p = (char *)page;\n\n\tif (reg->hr_bdev)\n\t\treturn -EINVAL;\n\n\ttmp = simple_strtoul(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\tif (tmp > O2NM_MAX_NODES || tmp == 0)\n\t\treturn -ERANGE;\n\n\treg->hr_blocks = (unsigned int)tmp;\n\n\treturn count;\n}"
  },
  {
    "function_name": "o2hb_region_blocks_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1561-1565",
    "snippet": "static ssize_t o2hb_region_blocks_read(struct o2hb_region *reg,\n\t\t\t\t       char *page)\n{\n\treturn sprintf(page, \"%d\\n\", reg->hr_blocks);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%d\\n\"",
            "reg->hr_blocks"
          ],
          "line": 1564
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_blocks_read(struct o2hb_region *reg,\n\t\t\t\t       char *page)\n{\n\treturn sprintf(page, \"%d\\n\", reg->hr_blocks);\n}"
  },
  {
    "function_name": "o2hb_region_start_block_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1542-1559",
    "snippet": "static ssize_t o2hb_region_start_block_write(struct o2hb_region *reg,\n\t\t\t\t\t     const char *page,\n\t\t\t\t\t     size_t count)\n{\n\tunsigned long long tmp;\n\tchar *p = (char *)page;\n\n\tif (reg->hr_bdev)\n\t\treturn -EINVAL;\n\n\ttmp = simple_strtoull(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\treg->hr_start_block = tmp;\n\n\treturn count;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_strtoull",
          "args": [
            "p",
            "&p",
            "0"
          ],
          "line": 1552
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_start_block_write(struct o2hb_region *reg,\n\t\t\t\t\t     const char *page,\n\t\t\t\t\t     size_t count)\n{\n\tunsigned long long tmp;\n\tchar *p = (char *)page;\n\n\tif (reg->hr_bdev)\n\t\treturn -EINVAL;\n\n\ttmp = simple_strtoull(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\treg->hr_start_block = tmp;\n\n\treturn count;\n}"
  },
  {
    "function_name": "o2hb_region_start_block_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1536-1540",
    "snippet": "static ssize_t o2hb_region_start_block_read(struct o2hb_region *reg,\n\t\t\t\t\t    char *page)\n{\n\treturn sprintf(page, \"%llu\\n\", reg->hr_start_block);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%llu\\n\"",
            "reg->hr_start_block"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_start_block_read(struct o2hb_region *reg,\n\t\t\t\t\t    char *page)\n{\n\treturn sprintf(page, \"%llu\\n\", reg->hr_start_block);\n}"
  },
  {
    "function_name": "o2hb_region_block_bytes_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1514-1534",
    "snippet": "static ssize_t o2hb_region_block_bytes_write(struct o2hb_region *reg,\n\t\t\t\t\t     const char *page,\n\t\t\t\t\t     size_t count)\n{\n\tint status;\n\tunsigned long block_bytes;\n\tunsigned int block_bits;\n\n\tif (reg->hr_bdev)\n\t\treturn -EINVAL;\n\n\tstatus = o2hb_read_block_input(reg, page, count,\n\t\t\t\t       &block_bytes, &block_bits);\n\tif (status)\n\t\treturn status;\n\n\treg->hr_block_bytes = (unsigned int)block_bytes;\n\treg->hr_block_bits = block_bits;\n\n\treturn count;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_read_block_input",
          "args": [
            "reg",
            "page",
            "count",
            "&block_bytes",
            "&block_bits"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_read_block_input",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1481-1506",
          "snippet": "static int o2hb_read_block_input(struct o2hb_region *reg,\n\t\t\t\t const char *page,\n\t\t\t\t size_t count,\n\t\t\t\t unsigned long *ret_bytes,\n\t\t\t\t unsigned int *ret_bits)\n{\n\tunsigned long bytes;\n\tchar *p = (char *)page;\n\n\tbytes = simple_strtoul(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\t/* Heartbeat and fs min / max block sizes are the same. */\n\tif (bytes > 4096 || bytes < 512)\n\t\treturn -ERANGE;\n\tif (hweight16(bytes) != 1)\n\t\treturn -EINVAL;\n\n\tif (ret_bytes)\n\t\t*ret_bytes = bytes;\n\tif (ret_bits)\n\t\t*ret_bits = ffs(bytes) - 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_read_block_input(struct o2hb_region *reg,\n\t\t\t\t const char *page,\n\t\t\t\t size_t count,\n\t\t\t\t unsigned long *ret_bytes,\n\t\t\t\t unsigned int *ret_bits)\n{\n\tunsigned long bytes;\n\tchar *p = (char *)page;\n\n\tbytes = simple_strtoul(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\t/* Heartbeat and fs min / max block sizes are the same. */\n\tif (bytes > 4096 || bytes < 512)\n\t\treturn -ERANGE;\n\tif (hweight16(bytes) != 1)\n\t\treturn -EINVAL;\n\n\tif (ret_bytes)\n\t\t*ret_bytes = bytes;\n\tif (ret_bits)\n\t\t*ret_bits = ffs(bytes) - 1;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_block_bytes_write(struct o2hb_region *reg,\n\t\t\t\t\t     const char *page,\n\t\t\t\t\t     size_t count)\n{\n\tint status;\n\tunsigned long block_bytes;\n\tunsigned int block_bits;\n\n\tif (reg->hr_bdev)\n\t\treturn -EINVAL;\n\n\tstatus = o2hb_read_block_input(reg, page, count,\n\t\t\t\t       &block_bytes, &block_bits);\n\tif (status)\n\t\treturn status;\n\n\treg->hr_block_bytes = (unsigned int)block_bytes;\n\treg->hr_block_bits = block_bits;\n\n\treturn count;\n}"
  },
  {
    "function_name": "o2hb_region_block_bytes_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1508-1512",
    "snippet": "static ssize_t o2hb_region_block_bytes_read(struct o2hb_region *reg,\n\t\t\t\t\t    char *page)\n{\n\treturn sprintf(page, \"%u\\n\", reg->hr_block_bytes);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "page",
            "\"%u\\n\"",
            "reg->hr_block_bytes"
          ],
          "line": 1511
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_region_block_bytes_read(struct o2hb_region *reg,\n\t\t\t\t\t    char *page)\n{\n\treturn sprintf(page, \"%u\\n\", reg->hr_block_bytes);\n}"
  },
  {
    "function_name": "o2hb_read_block_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1481-1506",
    "snippet": "static int o2hb_read_block_input(struct o2hb_region *reg,\n\t\t\t\t const char *page,\n\t\t\t\t size_t count,\n\t\t\t\t unsigned long *ret_bytes,\n\t\t\t\t unsigned int *ret_bits)\n{\n\tunsigned long bytes;\n\tchar *p = (char *)page;\n\n\tbytes = simple_strtoul(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\t/* Heartbeat and fs min / max block sizes are the same. */\n\tif (bytes > 4096 || bytes < 512)\n\t\treturn -ERANGE;\n\tif (hweight16(bytes) != 1)\n\t\treturn -EINVAL;\n\n\tif (ret_bytes)\n\t\t*ret_bytes = bytes;\n\tif (ret_bits)\n\t\t*ret_bits = ffs(bytes) - 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ffs",
          "args": [
            "bytes"
          ],
          "line": 1503
        },
        "resolved": true,
        "details": {
          "function_name": "unsigned_offsets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "40-43",
          "snippet": "static inline int unsigned_offsets(struct file *file)\n{\n\treturn file->f_mode & FMODE_UNSIGNED_OFFSET;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline int unsigned_offsets(struct file *file)\n{\n\treturn file->f_mode & FMODE_UNSIGNED_OFFSET;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hweight16",
          "args": [
            "bytes"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "p",
            "&p",
            "0"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_read_block_input(struct o2hb_region *reg,\n\t\t\t\t const char *page,\n\t\t\t\t size_t count,\n\t\t\t\t unsigned long *ret_bytes,\n\t\t\t\t unsigned int *ret_bits)\n{\n\tunsigned long bytes;\n\tchar *p = (char *)page;\n\n\tbytes = simple_strtoul(p, &p, 0);\n\tif (!p || (*p && (*p != '\\n')))\n\t\treturn -EINVAL;\n\n\t/* Heartbeat and fs min / max block sizes are the same. */\n\tif (bytes > 4096 || bytes < 512)\n\t\treturn -ERANGE;\n\tif (hweight16(bytes) != 1)\n\t\treturn -EINVAL;\n\n\tif (ret_bytes)\n\t\t*ret_bytes = bytes;\n\tif (ret_bits)\n\t\t*ret_bits = ffs(bytes) - 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_region_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1442-1479",
    "snippet": "static void o2hb_region_release(struct config_item *item)\n{\n\tint i;\n\tstruct page *page;\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\n\tmlog(ML_HEARTBEAT, \"hb region release (%s)\\n\", reg->hr_dev_name);\n\n\tkfree(reg->hr_tmp_block);\n\n\tif (reg->hr_slot_data) {\n\t\tfor (i = 0; i < reg->hr_num_pages; i++) {\n\t\t\tpage = reg->hr_slot_data[i];\n\t\t\tif (page)\n\t\t\t\t__free_page(page);\n\t\t}\n\t\tkfree(reg->hr_slot_data);\n\t}\n\n\tif (reg->hr_bdev)\n\t\tblkdev_put(reg->hr_bdev, FMODE_READ|FMODE_WRITE);\n\n\tkfree(reg->hr_slots);\n\n\tkfree(reg->hr_db_regnum);\n\tkfree(reg->hr_db_livenodes);\n\tdebugfs_remove(reg->hr_debug_livenodes);\n\tdebugfs_remove(reg->hr_debug_regnum);\n\tdebugfs_remove(reg->hr_debug_elapsed_time);\n\tdebugfs_remove(reg->hr_debug_pinned);\n\tdebugfs_remove(reg->hr_debug_dir);\n\n\tspin_lock(&o2hb_live_lock);\n\tlist_del(&reg->hr_all_item);\n\tspin_unlock(&o2hb_live_lock);\n\n\tkfree(reg);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1476
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&reg->hr_all_item"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1474
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "reg->hr_debug_dir"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg->hr_db_livenodes"
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg->hr_db_regnum"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg->hr_slots"
          ],
          "line": 1464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blkdev_put",
          "args": [
            "reg->hr_bdev",
            "FMODE_READ|FMODE_WRITE"
          ],
          "line": 1462
        },
        "resolved": true,
        "details": {
          "function_name": "blkdev_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "1519-1564",
          "snippet": "void blkdev_put(struct block_device *bdev, fmode_t mode)\n{\n\tmutex_lock(&bdev->bd_mutex);\n\n\tif (mode & FMODE_EXCL) {\n\t\tbool bdev_free;\n\n\t\t/*\n\t\t * Release a claim on the device.  The holder fields\n\t\t * are protected with bdev_lock.  bd_mutex is to\n\t\t * synchronize disk_holder unlinking.\n\t\t */\n\t\tspin_lock(&bdev_lock);\n\n\t\tWARN_ON_ONCE(--bdev->bd_holders < 0);\n\t\tWARN_ON_ONCE(--bdev->bd_contains->bd_holders < 0);\n\n\t\t/* bd_contains might point to self, check in a separate step */\n\t\tif ((bdev_free = !bdev->bd_holders))\n\t\t\tbdev->bd_holder = NULL;\n\t\tif (!bdev->bd_contains->bd_holders)\n\t\t\tbdev->bd_contains->bd_holder = NULL;\n\n\t\tspin_unlock(&bdev_lock);\n\n\t\t/*\n\t\t * If this was the last claim, remove holder link and\n\t\t * unblock evpoll if it was a write holder.\n\t\t */\n\t\tif (bdev_free && bdev->bd_write_holder) {\n\t\t\tdisk_unblock_events(bdev->bd_disk);\n\t\t\tbdev->bd_write_holder = false;\n\t\t}\n\t}\n\n\t/*\n\t * Trigger event checking and tell drivers to flush MEDIA_CHANGE\n\t * event.  This is to ensure detection of media removal commanded\n\t * from userland - e.g. eject(1).\n\t */\n\tdisk_flush_events(bdev->bd_disk, DISK_EVENT_MEDIA_CHANGE);\n\n\tmutex_unlock(&bdev->bd_mutex);\n\n\t__blkdev_put(bdev, mode, 0);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static  __cacheline_aligned_in_smp DEFINE_SPINLOCK(bdev_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic  __cacheline_aligned_in_smp DEFINE_SPINLOCK(bdev_lock);\n\nvoid blkdev_put(struct block_device *bdev, fmode_t mode)\n{\n\tmutex_lock(&bdev->bd_mutex);\n\n\tif (mode & FMODE_EXCL) {\n\t\tbool bdev_free;\n\n\t\t/*\n\t\t * Release a claim on the device.  The holder fields\n\t\t * are protected with bdev_lock.  bd_mutex is to\n\t\t * synchronize disk_holder unlinking.\n\t\t */\n\t\tspin_lock(&bdev_lock);\n\n\t\tWARN_ON_ONCE(--bdev->bd_holders < 0);\n\t\tWARN_ON_ONCE(--bdev->bd_contains->bd_holders < 0);\n\n\t\t/* bd_contains might point to self, check in a separate step */\n\t\tif ((bdev_free = !bdev->bd_holders))\n\t\t\tbdev->bd_holder = NULL;\n\t\tif (!bdev->bd_contains->bd_holders)\n\t\t\tbdev->bd_contains->bd_holder = NULL;\n\n\t\tspin_unlock(&bdev_lock);\n\n\t\t/*\n\t\t * If this was the last claim, remove holder link and\n\t\t * unblock evpoll if it was a write holder.\n\t\t */\n\t\tif (bdev_free && bdev->bd_write_holder) {\n\t\t\tdisk_unblock_events(bdev->bd_disk);\n\t\t\tbdev->bd_write_holder = false;\n\t\t}\n\t}\n\n\t/*\n\t * Trigger event checking and tell drivers to flush MEDIA_CHANGE\n\t * event.  This is to ensure detection of media removal commanded\n\t * from userland - e.g. eject(1).\n\t */\n\tdisk_flush_events(bdev->bd_disk, DISK_EVENT_MEDIA_CHANGE);\n\n\tmutex_unlock(&bdev->bd_mutex);\n\n\t__blkdev_put(bdev, mode, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg->hr_slot_data"
          ],
          "line": 1458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "page"
          ],
          "line": 1456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "reg->hr_tmp_block"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"hb region release (%s)\\n\"",
            "reg->hr_dev_name"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_o2hb_region",
          "args": [
            "item"
          ],
          "line": 1446
        },
        "resolved": true,
        "details": {
          "function_name": "to_o2hb_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1434-1437",
          "snippet": "static struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nstatic void o2hb_region_release(struct config_item *item)\n{\n\tint i;\n\tstruct page *page;\n\tstruct o2hb_region *reg = to_o2hb_region(item);\n\n\tmlog(ML_HEARTBEAT, \"hb region release (%s)\\n\", reg->hr_dev_name);\n\n\tkfree(reg->hr_tmp_block);\n\n\tif (reg->hr_slot_data) {\n\t\tfor (i = 0; i < reg->hr_num_pages; i++) {\n\t\t\tpage = reg->hr_slot_data[i];\n\t\t\tif (page)\n\t\t\t\t__free_page(page);\n\t\t}\n\t\tkfree(reg->hr_slot_data);\n\t}\n\n\tif (reg->hr_bdev)\n\t\tblkdev_put(reg->hr_bdev, FMODE_READ|FMODE_WRITE);\n\n\tkfree(reg->hr_slots);\n\n\tkfree(reg->hr_db_regnum);\n\tkfree(reg->hr_db_livenodes);\n\tdebugfs_remove(reg->hr_debug_livenodes);\n\tdebugfs_remove(reg->hr_debug_regnum);\n\tdebugfs_remove(reg->hr_debug_elapsed_time);\n\tdebugfs_remove(reg->hr_debug_pinned);\n\tdebugfs_remove(reg->hr_debug_dir);\n\n\tspin_lock(&o2hb_live_lock);\n\tlist_del(&reg->hr_all_item);\n\tspin_unlock(&o2hb_live_lock);\n\n\tkfree(reg);\n}"
  },
  {
    "function_name": "to_o2hb_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1434-1437",
    "snippet": "static struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "item",
            "structo2hb_region",
            "hr_item"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_region *to_o2hb_region(struct config_item *item)\n{\n\treturn item ? container_of(item, struct o2hb_region, hr_item) : NULL;\n}"
  },
  {
    "function_name": "o2hb_fill_node_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1417-1426",
    "snippet": "void o2hb_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\t/* callers want to serialize this map and callbacks so that they\n\t * can trust that they don't miss nodes coming to the party */\n\tdown_read(&o2hb_callback_sem);\n\tspin_lock(&o2hb_live_lock);\n\to2hb_fill_node_map_from_callback(map, bytes);\n\tspin_unlock(&o2hb_live_lock);\n\tup_read(&o2hb_callback_sem);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_RWSEM(o2hb_callback_sem);",
      "static DEFINE_SPINLOCK(o2hb_live_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_fill_node_map_from_callback",
          "args": [
            "map",
            "bytes"
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_fill_node_map_from_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1406-1412",
          "snippet": "static void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\nstatic void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1422
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nvoid o2hb_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\t/* callers want to serialize this map and callbacks so that they\n\t * can trust that they don't miss nodes coming to the party */\n\tdown_read(&o2hb_callback_sem);\n\tspin_lock(&o2hb_live_lock);\n\to2hb_fill_node_map_from_callback(map, bytes);\n\tspin_unlock(&o2hb_live_lock);\n\tup_read(&o2hb_callback_sem);\n}"
  },
  {
    "function_name": "o2hb_fill_node_map_from_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1406-1412",
    "snippet": "static void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "map",
            "&o2hb_live_node_bitmap",
            "bytes"
          ],
          "line": 1411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long))"
          ],
          "line": 1409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 1409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\nstatic void o2hb_fill_node_map_from_callback(unsigned long *map,\n\t\t\t\t\t     unsigned bytes)\n{\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemcpy(map, &o2hb_live_node_bitmap, bytes);\n}"
  },
  {
    "function_name": "o2hb_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1382-1403",
    "snippet": "int o2hb_init(void)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(o2hb_callbacks); i++)\n\t\tINIT_LIST_HEAD(&o2hb_callbacks[i].list);\n\n\tfor (i = 0; i < ARRAY_SIZE(o2hb_live_slots); i++)\n\t\tINIT_LIST_HEAD(&o2hb_live_slots[i]);\n\n\tINIT_LIST_HEAD(&o2hb_node_events);\n\n\tmemset(o2hb_live_node_bitmap, 0, sizeof(o2hb_live_node_bitmap));\n\tmemset(o2hb_region_bitmap, 0, sizeof(o2hb_region_bitmap));\n\tmemset(o2hb_live_region_bitmap, 0, sizeof(o2hb_live_region_bitmap));\n\tmemset(o2hb_quorum_region_bitmap, 0, sizeof(o2hb_quorum_region_bitmap));\n\tmemset(o2hb_failed_region_bitmap, 0, sizeof(o2hb_failed_region_bitmap));\n\n\to2hb_dependent_users = 0;\n\n\treturn o2hb_debug_init();\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct list_head o2hb_live_slots[O2NM_MAX_NODES];",
      "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
      "static LIST_HEAD(o2hb_node_events);",
      "static unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];",
      "unsigned int o2hb_dependent_users;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_debug_init",
          "args": [],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_debug_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1310-1380",
          "snippet": "static int o2hb_debug_init(void)\n{\n\tint ret = -ENOMEM;\n\n\to2hb_debug_dir = debugfs_create_dir(O2HB_DEBUG_DIR, NULL);\n\tif (!o2hb_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_livenodes = o2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t\t o2hb_debug_dir,\n\t\t\t\t\t\t &o2hb_db_livenodes,\n\t\t\t\t\t\t sizeof(*o2hb_db_livenodes),\n\t\t\t\t\t\t O2HB_DB_TYPE_LIVENODES,\n\t\t\t\t\t\t sizeof(o2hb_live_node_bitmap),\n\t\t\t\t\t\t O2NM_MAX_NODES,\n\t\t\t\t\t\t o2hb_live_node_bitmap);\n\tif (!o2hb_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_liveregions = o2hb_debug_create(O2HB_DEBUG_LIVEREGIONS,\n\t\t\t\t\t\t   o2hb_debug_dir,\n\t\t\t\t\t\t   &o2hb_db_liveregions,\n\t\t\t\t\t\t   sizeof(*o2hb_db_liveregions),\n\t\t\t\t\t\t   O2HB_DB_TYPE_LIVEREGIONS,\n\t\t\t\t\t\t   sizeof(o2hb_live_region_bitmap),\n\t\t\t\t\t\t   O2NM_MAX_REGIONS,\n\t\t\t\t\t\t   o2hb_live_region_bitmap);\n\tif (!o2hb_debug_liveregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_quorumregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_QUORUMREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_quorumregions,\n\t\t\t\t\t  sizeof(*o2hb_db_quorumregions),\n\t\t\t\t\t  O2HB_DB_TYPE_QUORUMREGIONS,\n\t\t\t\t\t  sizeof(o2hb_quorum_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_quorum_region_bitmap);\n\tif (!o2hb_debug_quorumregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_failedregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_FAILEDREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_failedregions,\n\t\t\t\t\t  sizeof(*o2hb_db_failedregions),\n\t\t\t\t\t  O2HB_DB_TYPE_FAILEDREGIONS,\n\t\t\t\t\t  sizeof(o2hb_failed_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_failed_region_bitmap);\n\tif (!o2hb_debug_failedregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\tif (ret)\n\t\to2hb_exit();\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define O2HB_DEBUG_FAILEDREGIONS\t\"failed_regions\"",
            "#define O2HB_DEBUG_QUORUMREGIONS\t\"quorum_regions\"",
            "#define O2HB_DEBUG_LIVEREGIONS\t\t\"live_regions\"",
            "#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"",
            "#define O2HB_DEBUG_DIR\t\t\t\"o2hb\"",
            "#define O2HB_DB_TYPE_FAILEDREGIONS\t3",
            "#define O2HB_DB_TYPE_QUORUMREGIONS\t2",
            "#define O2HB_DB_TYPE_LIVEREGIONS\t1",
            "#define O2HB_DB_TYPE_LIVENODES\t\t0"
          ],
          "globals_used": [
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
            "static unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
            "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
            "static unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
            "static struct o2hb_debug_buf *o2hb_db_livenodes;",
            "static struct o2hb_debug_buf *o2hb_db_liveregions;",
            "static struct o2hb_debug_buf *o2hb_db_quorumregions;",
            "static struct o2hb_debug_buf *o2hb_db_failedregions;",
            "static struct dentry *o2hb_debug_dir;",
            "static struct dentry *o2hb_debug_livenodes;",
            "static struct dentry *o2hb_debug_liveregions;",
            "static struct dentry *o2hb_debug_quorumregions;",
            "static struct dentry *o2hb_debug_failedregions;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_DEBUG_FAILEDREGIONS\t\"failed_regions\"\n#define O2HB_DEBUG_QUORUMREGIONS\t\"quorum_regions\"\n#define O2HB_DEBUG_LIVEREGIONS\t\t\"live_regions\"\n#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"\n#define O2HB_DEBUG_DIR\t\t\t\"o2hb\"\n#define O2HB_DB_TYPE_FAILEDREGIONS\t3\n#define O2HB_DB_TYPE_QUORUMREGIONS\t2\n#define O2HB_DB_TYPE_LIVEREGIONS\t1\n#define O2HB_DB_TYPE_LIVENODES\t\t0\n\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nstatic unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic struct o2hb_debug_buf *o2hb_db_livenodes;\nstatic struct o2hb_debug_buf *o2hb_db_liveregions;\nstatic struct o2hb_debug_buf *o2hb_db_quorumregions;\nstatic struct o2hb_debug_buf *o2hb_db_failedregions;\nstatic struct dentry *o2hb_debug_dir;\nstatic struct dentry *o2hb_debug_livenodes;\nstatic struct dentry *o2hb_debug_liveregions;\nstatic struct dentry *o2hb_debug_quorumregions;\nstatic struct dentry *o2hb_debug_failedregions;\n\nstatic int o2hb_debug_init(void)\n{\n\tint ret = -ENOMEM;\n\n\to2hb_debug_dir = debugfs_create_dir(O2HB_DEBUG_DIR, NULL);\n\tif (!o2hb_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_livenodes = o2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t\t o2hb_debug_dir,\n\t\t\t\t\t\t &o2hb_db_livenodes,\n\t\t\t\t\t\t sizeof(*o2hb_db_livenodes),\n\t\t\t\t\t\t O2HB_DB_TYPE_LIVENODES,\n\t\t\t\t\t\t sizeof(o2hb_live_node_bitmap),\n\t\t\t\t\t\t O2NM_MAX_NODES,\n\t\t\t\t\t\t o2hb_live_node_bitmap);\n\tif (!o2hb_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_liveregions = o2hb_debug_create(O2HB_DEBUG_LIVEREGIONS,\n\t\t\t\t\t\t   o2hb_debug_dir,\n\t\t\t\t\t\t   &o2hb_db_liveregions,\n\t\t\t\t\t\t   sizeof(*o2hb_db_liveregions),\n\t\t\t\t\t\t   O2HB_DB_TYPE_LIVEREGIONS,\n\t\t\t\t\t\t   sizeof(o2hb_live_region_bitmap),\n\t\t\t\t\t\t   O2NM_MAX_REGIONS,\n\t\t\t\t\t\t   o2hb_live_region_bitmap);\n\tif (!o2hb_debug_liveregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_quorumregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_QUORUMREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_quorumregions,\n\t\t\t\t\t  sizeof(*o2hb_db_quorumregions),\n\t\t\t\t\t  O2HB_DB_TYPE_QUORUMREGIONS,\n\t\t\t\t\t  sizeof(o2hb_quorum_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_quorum_region_bitmap);\n\tif (!o2hb_debug_quorumregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_failedregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_FAILEDREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_failedregions,\n\t\t\t\t\t  sizeof(*o2hb_db_failedregions),\n\t\t\t\t\t  O2HB_DB_TYPE_FAILEDREGIONS,\n\t\t\t\t\t  sizeof(o2hb_failed_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_failed_region_bitmap);\n\tif (!o2hb_debug_failedregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\tif (ret)\n\t\to2hb_exit();\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "o2hb_failed_region_bitmap",
            "0",
            "sizeof(o2hb_failed_region_bitmap)"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "o2hb_quorum_region_bitmap",
            "0",
            "sizeof(o2hb_quorum_region_bitmap)"
          ],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "o2hb_live_region_bitmap",
            "0",
            "sizeof(o2hb_live_region_bitmap)"
          ],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "o2hb_region_bitmap",
            "0",
            "sizeof(o2hb_region_bitmap)"
          ],
          "line": 1395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "o2hb_live_node_bitmap",
            "0",
            "sizeof(o2hb_live_node_bitmap)"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&o2hb_node_events"
          ],
          "line": 1392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&o2hb_live_slots[i]"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "o2hb_live_slots"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&o2hb_callbacks[i].list"
          ],
          "line": 1387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "o2hb_callbacks"
          ],
          "line": 1386
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct list_head o2hb_live_slots[O2NM_MAX_NODES];\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nstatic LIST_HEAD(o2hb_node_events);\nstatic unsigned long o2hb_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];\nunsigned int o2hb_dependent_users;\n\nint o2hb_init(void)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(o2hb_callbacks); i++)\n\t\tINIT_LIST_HEAD(&o2hb_callbacks[i].list);\n\n\tfor (i = 0; i < ARRAY_SIZE(o2hb_live_slots); i++)\n\t\tINIT_LIST_HEAD(&o2hb_live_slots[i]);\n\n\tINIT_LIST_HEAD(&o2hb_node_events);\n\n\tmemset(o2hb_live_node_bitmap, 0, sizeof(o2hb_live_node_bitmap));\n\tmemset(o2hb_region_bitmap, 0, sizeof(o2hb_region_bitmap));\n\tmemset(o2hb_live_region_bitmap, 0, sizeof(o2hb_live_region_bitmap));\n\tmemset(o2hb_quorum_region_bitmap, 0, sizeof(o2hb_quorum_region_bitmap));\n\tmemset(o2hb_failed_region_bitmap, 0, sizeof(o2hb_failed_region_bitmap));\n\n\to2hb_dependent_users = 0;\n\n\treturn o2hb_debug_init();\n}"
  },
  {
    "function_name": "o2hb_debug_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1310-1380",
    "snippet": "static int o2hb_debug_init(void)\n{\n\tint ret = -ENOMEM;\n\n\to2hb_debug_dir = debugfs_create_dir(O2HB_DEBUG_DIR, NULL);\n\tif (!o2hb_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_livenodes = o2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t\t o2hb_debug_dir,\n\t\t\t\t\t\t &o2hb_db_livenodes,\n\t\t\t\t\t\t sizeof(*o2hb_db_livenodes),\n\t\t\t\t\t\t O2HB_DB_TYPE_LIVENODES,\n\t\t\t\t\t\t sizeof(o2hb_live_node_bitmap),\n\t\t\t\t\t\t O2NM_MAX_NODES,\n\t\t\t\t\t\t o2hb_live_node_bitmap);\n\tif (!o2hb_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_liveregions = o2hb_debug_create(O2HB_DEBUG_LIVEREGIONS,\n\t\t\t\t\t\t   o2hb_debug_dir,\n\t\t\t\t\t\t   &o2hb_db_liveregions,\n\t\t\t\t\t\t   sizeof(*o2hb_db_liveregions),\n\t\t\t\t\t\t   O2HB_DB_TYPE_LIVEREGIONS,\n\t\t\t\t\t\t   sizeof(o2hb_live_region_bitmap),\n\t\t\t\t\t\t   O2NM_MAX_REGIONS,\n\t\t\t\t\t\t   o2hb_live_region_bitmap);\n\tif (!o2hb_debug_liveregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_quorumregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_QUORUMREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_quorumregions,\n\t\t\t\t\t  sizeof(*o2hb_db_quorumregions),\n\t\t\t\t\t  O2HB_DB_TYPE_QUORUMREGIONS,\n\t\t\t\t\t  sizeof(o2hb_quorum_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_quorum_region_bitmap);\n\tif (!o2hb_debug_quorumregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_failedregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_FAILEDREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_failedregions,\n\t\t\t\t\t  sizeof(*o2hb_db_failedregions),\n\t\t\t\t\t  O2HB_DB_TYPE_FAILEDREGIONS,\n\t\t\t\t\t  sizeof(o2hb_failed_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_failed_region_bitmap);\n\tif (!o2hb_debug_failedregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\tif (ret)\n\t\to2hb_exit();\n\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define O2HB_DEBUG_FAILEDREGIONS\t\"failed_regions\"",
      "#define O2HB_DEBUG_QUORUMREGIONS\t\"quorum_regions\"",
      "#define O2HB_DEBUG_LIVEREGIONS\t\t\"live_regions\"",
      "#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"",
      "#define O2HB_DEBUG_DIR\t\t\t\"o2hb\"",
      "#define O2HB_DB_TYPE_FAILEDREGIONS\t3",
      "#define O2HB_DB_TYPE_QUORUMREGIONS\t2",
      "#define O2HB_DB_TYPE_LIVEREGIONS\t1",
      "#define O2HB_DB_TYPE_LIVENODES\t\t0"
    ],
    "globals_used": [
      "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
      "static unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static struct o2hb_debug_buf *o2hb_db_livenodes;",
      "static struct o2hb_debug_buf *o2hb_db_liveregions;",
      "static struct o2hb_debug_buf *o2hb_db_quorumregions;",
      "static struct o2hb_debug_buf *o2hb_db_failedregions;",
      "static struct dentry *o2hb_debug_dir;",
      "static struct dentry *o2hb_debug_livenodes;",
      "static struct dentry *o2hb_debug_liveregions;",
      "static struct dentry *o2hb_debug_quorumregions;",
      "static struct dentry *o2hb_debug_failedregions;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_exit",
          "args": [],
          "line": 1377
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1280-1291",
          "snippet": "void o2hb_exit(void)\n{\n\tkfree(o2hb_db_livenodes);\n\tkfree(o2hb_db_liveregions);\n\tkfree(o2hb_db_quorumregions);\n\tkfree(o2hb_db_failedregions);\n\tdebugfs_remove(o2hb_debug_failedregions);\n\tdebugfs_remove(o2hb_debug_quorumregions);\n\tdebugfs_remove(o2hb_debug_liveregions);\n\tdebugfs_remove(o2hb_debug_livenodes);\n\tdebugfs_remove(o2hb_debug_dir);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2hb_debug_buf *o2hb_db_livenodes;",
            "static struct o2hb_debug_buf *o2hb_db_liveregions;",
            "static struct o2hb_debug_buf *o2hb_db_quorumregions;",
            "static struct o2hb_debug_buf *o2hb_db_failedregions;",
            "static struct dentry *o2hb_debug_dir;",
            "static struct dentry *o2hb_debug_livenodes;",
            "static struct dentry *o2hb_debug_liveregions;",
            "static struct dentry *o2hb_debug_quorumregions;",
            "static struct dentry *o2hb_debug_failedregions;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_debug_buf *o2hb_db_livenodes;\nstatic struct o2hb_debug_buf *o2hb_db_liveregions;\nstatic struct o2hb_debug_buf *o2hb_db_quorumregions;\nstatic struct o2hb_debug_buf *o2hb_db_failedregions;\nstatic struct dentry *o2hb_debug_dir;\nstatic struct dentry *o2hb_debug_livenodes;\nstatic struct dentry *o2hb_debug_liveregions;\nstatic struct dentry *o2hb_debug_quorumregions;\nstatic struct dentry *o2hb_debug_failedregions;\n\nvoid o2hb_exit(void)\n{\n\tkfree(o2hb_db_livenodes);\n\tkfree(o2hb_db_liveregions);\n\tkfree(o2hb_db_quorumregions);\n\tkfree(o2hb_db_failedregions);\n\tdebugfs_remove(o2hb_debug_failedregions);\n\tdebugfs_remove(o2hb_debug_quorumregions);\n\tdebugfs_remove(o2hb_debug_liveregions);\n\tdebugfs_remove(o2hb_debug_livenodes);\n\tdebugfs_remove(o2hb_debug_dir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_debug_create",
          "args": [
            "O2HB_DEBUG_FAILEDREGIONS",
            "o2hb_debug_dir",
            "&o2hb_db_failedregions",
            "sizeof(*o2hb_db_failedregions)",
            "O2HB_DB_TYPE_FAILEDREGIONS",
            "sizeof(o2hb_failed_region_bitmap)",
            "O2NM_MAX_REGIONS",
            "o2hb_failed_region_bitmap"
          ],
          "line": 1361
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_debug_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1293-1308",
          "snippet": "static struct dentry *o2hb_debug_create(const char *name, struct dentry *dir,\n\t\t\t\t\tstruct o2hb_debug_buf **db, int db_len,\n\t\t\t\t\tint type, int size, int len, void *data)\n{\n\t*db = kmalloc(db_len, GFP_KERNEL);\n\tif (!*db)\n\t\treturn NULL;\n\n\t(*db)->db_type = type;\n\t(*db)->db_size = size;\n\t(*db)->db_len = len;\n\t(*db)->db_data = data;\n\n\treturn debugfs_create_file(name, S_IFREG|S_IRUSR, dir, *db,\n\t\t\t\t   &o2hb_debug_fops);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);",
            "static const struct file_operations o2hb_debug_fops = {\n\t.open =\t\to2hb_debug_open,\n\t.release =\to2hb_debug_release,\n\t.read =\t\to2hb_debug_read,\n\t.llseek =\tgeneric_file_llseek,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\nstatic const struct file_operations o2hb_debug_fops = {\n\t.open =\t\to2hb_debug_open,\n\t.release =\to2hb_debug_release,\n\t.read =\t\to2hb_debug_read,\n\t.llseek =\tgeneric_file_llseek,\n};\n\nstatic struct dentry *o2hb_debug_create(const char *name, struct dentry *dir,\n\t\t\t\t\tstruct o2hb_debug_buf **db, int db_len,\n\t\t\t\t\tint type, int size, int len, void *data)\n{\n\t*db = kmalloc(db_len, GFP_KERNEL);\n\tif (!*db)\n\t\treturn NULL;\n\n\t(*db)->db_type = type;\n\t(*db)->db_size = size;\n\t(*db)->db_len = len;\n\t(*db)->db_data = data;\n\n\treturn debugfs_create_file(name, S_IFREG|S_IRUSR, dir, *db,\n\t\t\t\t   &o2hb_debug_fops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "O2HB_DEBUG_DIR",
            "NULL"
          ],
          "line": 1314
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_DEBUG_FAILEDREGIONS\t\"failed_regions\"\n#define O2HB_DEBUG_QUORUMREGIONS\t\"quorum_regions\"\n#define O2HB_DEBUG_LIVEREGIONS\t\t\"live_regions\"\n#define O2HB_DEBUG_LIVENODES\t\t\"livenodes\"\n#define O2HB_DEBUG_DIR\t\t\t\"o2hb\"\n#define O2HB_DB_TYPE_FAILEDREGIONS\t3\n#define O2HB_DB_TYPE_QUORUMREGIONS\t2\n#define O2HB_DB_TYPE_LIVEREGIONS\t1\n#define O2HB_DB_TYPE_LIVENODES\t\t0\n\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nstatic unsigned long o2hb_live_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic struct o2hb_debug_buf *o2hb_db_livenodes;\nstatic struct o2hb_debug_buf *o2hb_db_liveregions;\nstatic struct o2hb_debug_buf *o2hb_db_quorumregions;\nstatic struct o2hb_debug_buf *o2hb_db_failedregions;\nstatic struct dentry *o2hb_debug_dir;\nstatic struct dentry *o2hb_debug_livenodes;\nstatic struct dentry *o2hb_debug_liveregions;\nstatic struct dentry *o2hb_debug_quorumregions;\nstatic struct dentry *o2hb_debug_failedregions;\n\nstatic int o2hb_debug_init(void)\n{\n\tint ret = -ENOMEM;\n\n\to2hb_debug_dir = debugfs_create_dir(O2HB_DEBUG_DIR, NULL);\n\tif (!o2hb_debug_dir) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_livenodes = o2hb_debug_create(O2HB_DEBUG_LIVENODES,\n\t\t\t\t\t\t o2hb_debug_dir,\n\t\t\t\t\t\t &o2hb_db_livenodes,\n\t\t\t\t\t\t sizeof(*o2hb_db_livenodes),\n\t\t\t\t\t\t O2HB_DB_TYPE_LIVENODES,\n\t\t\t\t\t\t sizeof(o2hb_live_node_bitmap),\n\t\t\t\t\t\t O2NM_MAX_NODES,\n\t\t\t\t\t\t o2hb_live_node_bitmap);\n\tif (!o2hb_debug_livenodes) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_liveregions = o2hb_debug_create(O2HB_DEBUG_LIVEREGIONS,\n\t\t\t\t\t\t   o2hb_debug_dir,\n\t\t\t\t\t\t   &o2hb_db_liveregions,\n\t\t\t\t\t\t   sizeof(*o2hb_db_liveregions),\n\t\t\t\t\t\t   O2HB_DB_TYPE_LIVEREGIONS,\n\t\t\t\t\t\t   sizeof(o2hb_live_region_bitmap),\n\t\t\t\t\t\t   O2NM_MAX_REGIONS,\n\t\t\t\t\t\t   o2hb_live_region_bitmap);\n\tif (!o2hb_debug_liveregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_quorumregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_QUORUMREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_quorumregions,\n\t\t\t\t\t  sizeof(*o2hb_db_quorumregions),\n\t\t\t\t\t  O2HB_DB_TYPE_QUORUMREGIONS,\n\t\t\t\t\t  sizeof(o2hb_quorum_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_quorum_region_bitmap);\n\tif (!o2hb_debug_quorumregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\to2hb_debug_failedregions =\n\t\t\to2hb_debug_create(O2HB_DEBUG_FAILEDREGIONS,\n\t\t\t\t\t  o2hb_debug_dir,\n\t\t\t\t\t  &o2hb_db_failedregions,\n\t\t\t\t\t  sizeof(*o2hb_db_failedregions),\n\t\t\t\t\t  O2HB_DB_TYPE_FAILEDREGIONS,\n\t\t\t\t\t  sizeof(o2hb_failed_region_bitmap),\n\t\t\t\t\t  O2NM_MAX_REGIONS,\n\t\t\t\t\t  o2hb_failed_region_bitmap);\n\tif (!o2hb_debug_failedregions) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\tret = 0;\nbail:\n\tif (ret)\n\t\to2hb_exit();\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_debug_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1293-1308",
    "snippet": "static struct dentry *o2hb_debug_create(const char *name, struct dentry *dir,\n\t\t\t\t\tstruct o2hb_debug_buf **db, int db_len,\n\t\t\t\t\tint type, int size, int len, void *data)\n{\n\t*db = kmalloc(db_len, GFP_KERNEL);\n\tif (!*db)\n\t\treturn NULL;\n\n\t(*db)->db_type = type;\n\t(*db)->db_size = size;\n\t(*db)->db_len = len;\n\t(*db)->db_data = data;\n\n\treturn debugfs_create_file(name, S_IFREG|S_IRUSR, dir, *db,\n\t\t\t\t   &o2hb_debug_fops);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);",
      "static const struct file_operations o2hb_debug_fops = {\n\t.open =\t\to2hb_debug_open,\n\t.release =\to2hb_debug_release,\n\t.read =\t\to2hb_debug_read,\n\t.llseek =\tgeneric_file_llseek,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "name",
            "S_IFREG|S_IRUSR",
            "dir",
            "*db",
            "&o2hb_debug_fops"
          ],
          "line": 1306
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "db_len",
            "GFP_KERNEL"
          ],
          "line": 1297
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\nstatic const struct file_operations o2hb_debug_fops = {\n\t.open =\t\to2hb_debug_open,\n\t.release =\to2hb_debug_release,\n\t.read =\t\to2hb_debug_read,\n\t.llseek =\tgeneric_file_llseek,\n};\n\nstatic struct dentry *o2hb_debug_create(const char *name, struct dentry *dir,\n\t\t\t\t\tstruct o2hb_debug_buf **db, int db_len,\n\t\t\t\t\tint type, int size, int len, void *data)\n{\n\t*db = kmalloc(db_len, GFP_KERNEL);\n\tif (!*db)\n\t\treturn NULL;\n\n\t(*db)->db_type = type;\n\t(*db)->db_size = size;\n\t(*db)->db_len = len;\n\t(*db)->db_data = data;\n\n\treturn debugfs_create_file(name, S_IFREG|S_IRUSR, dir, *db,\n\t\t\t\t   &o2hb_debug_fops);\n}"
  },
  {
    "function_name": "o2hb_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1280-1291",
    "snippet": "void o2hb_exit(void)\n{\n\tkfree(o2hb_db_livenodes);\n\tkfree(o2hb_db_liveregions);\n\tkfree(o2hb_db_quorumregions);\n\tkfree(o2hb_db_failedregions);\n\tdebugfs_remove(o2hb_debug_failedregions);\n\tdebugfs_remove(o2hb_debug_quorumregions);\n\tdebugfs_remove(o2hb_debug_liveregions);\n\tdebugfs_remove(o2hb_debug_livenodes);\n\tdebugfs_remove(o2hb_debug_dir);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct o2hb_debug_buf *o2hb_db_livenodes;",
      "static struct o2hb_debug_buf *o2hb_db_liveregions;",
      "static struct o2hb_debug_buf *o2hb_db_quorumregions;",
      "static struct o2hb_debug_buf *o2hb_db_failedregions;",
      "static struct dentry *o2hb_debug_dir;",
      "static struct dentry *o2hb_debug_livenodes;",
      "static struct dentry *o2hb_debug_liveregions;",
      "static struct dentry *o2hb_debug_quorumregions;",
      "static struct dentry *o2hb_debug_failedregions;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "o2hb_debug_dir"
          ],
          "line": 1290
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "o2hb_db_failedregions"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "o2hb_db_quorumregions"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "o2hb_db_liveregions"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "o2hb_db_livenodes"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_debug_buf *o2hb_db_livenodes;\nstatic struct o2hb_debug_buf *o2hb_db_liveregions;\nstatic struct o2hb_debug_buf *o2hb_db_quorumregions;\nstatic struct o2hb_debug_buf *o2hb_db_failedregions;\nstatic struct dentry *o2hb_debug_dir;\nstatic struct dentry *o2hb_debug_livenodes;\nstatic struct dentry *o2hb_debug_liveregions;\nstatic struct dentry *o2hb_debug_quorumregions;\nstatic struct dentry *o2hb_debug_failedregions;\n\nvoid o2hb_exit(void)\n{\n\tkfree(o2hb_db_livenodes);\n\tkfree(o2hb_db_liveregions);\n\tkfree(o2hb_db_quorumregions);\n\tkfree(o2hb_db_failedregions);\n\tdebugfs_remove(o2hb_debug_failedregions);\n\tdebugfs_remove(o2hb_debug_quorumregions);\n\tdebugfs_remove(o2hb_debug_liveregions);\n\tdebugfs_remove(o2hb_debug_livenodes);\n\tdebugfs_remove(o2hb_debug_dir);\n}"
  },
  {
    "function_name": "o2hb_debug_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1266-1270",
    "snippet": "static ssize_t o2hb_debug_read(struct file *file, char __user *buf,\n\t\t\t       size_t nbytes, loff_t *ppos)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_debug_read(struct file *file, char __user *buf,\n\t\t\t       size_t nbytes, loff_t *ppos)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_debug_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1262-1265",
    "snippet": "static int o2hb_debug_release(struct inode *inode, struct file *file)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_debug_release(struct inode *inode, struct file *file)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_debug_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1258-1261",
    "snippet": "static int o2hb_debug_open(struct inode *inode, struct file *file)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_debug_open(struct inode *inode, struct file *file)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_debug_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1251-1256",
    "snippet": "static ssize_t o2hb_debug_read(struct file *file, char __user *buf,\n\t\t\t\t size_t nbytes, loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos, file->private_data,\n\t\t\t\t       i_size_read(file->f_mapping->host));\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "nbytes",
            "ppos",
            "file->private_data",
            "i_size_read(file->f_mapping->host)"
          ],
          "line": 1254
        },
        "resolved": true,
        "details": {
          "function_name": "simple_read_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "590-608",
          "snippet": "ssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "file->f_mapping->host"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic ssize_t o2hb_debug_read(struct file *file, char __user *buf,\n\t\t\t\t size_t nbytes, loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos, file->private_data,\n\t\t\t\t       i_size_read(file->f_mapping->host));\n}"
  },
  {
    "function_name": "o2hb_debug_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1245-1249",
    "snippet": "static int o2hb_debug_release(struct inode *inode, struct file *file)\n{\n\tkfree(file->private_data);\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "file->private_data"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_debug_release(struct inode *inode, struct file *file)\n{\n\tkfree(file->private_data);\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_debug_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1172-1243",
    "snippet": "static int o2hb_debug_open(struct inode *inode, struct file *file)\n{\n\tstruct o2hb_debug_buf *db = inode->i_private;\n\tstruct o2hb_region *reg;\n\tunsigned long map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long lts;\n\tchar *buf = NULL;\n\tint i = -1;\n\tint out = 0;\n\n\t/* max_nodes should be the largest bitmap we pass here */\n\tBUG_ON(sizeof(map) < db->db_size);\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\tgoto bail;\n\n\tswitch (db->db_type) {\n\tcase O2HB_DB_TYPE_LIVENODES:\n\tcase O2HB_DB_TYPE_LIVEREGIONS:\n\tcase O2HB_DB_TYPE_QUORUMREGIONS:\n\tcase O2HB_DB_TYPE_FAILEDREGIONS:\n\t\tspin_lock(&o2hb_live_lock);\n\t\tmemcpy(map, db->db_data, db->db_size);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tbreak;\n\n\tcase O2HB_DB_TYPE_REGION_LIVENODES:\n\t\tspin_lock(&o2hb_live_lock);\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tmemcpy(map, reg->hr_live_node_bitmap, db->db_size);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tbreak;\n\n\tcase O2HB_DB_TYPE_REGION_NUMBER:\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d\\n\",\n\t\t\t\treg->hr_region_num);\n\t\tgoto done;\n\n\tcase O2HB_DB_TYPE_REGION_ELAPSED_TIME:\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tlts = reg->hr_last_timeout_start;\n\t\t/* If 0, it has never been set before */\n\t\tif (lts)\n\t\t\tlts = jiffies_to_msecs(jiffies - lts);\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%lu\\n\", lts);\n\t\tgoto done;\n\n\tcase O2HB_DB_TYPE_REGION_PINNED:\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%u\\n\",\n\t\t\t\t!!reg->hr_item_pinned);\n\t\tgoto done;\n\n\tdefault:\n\t\tgoto done;\n\t}\n\n\twhile ((i = find_next_bit(map, db->db_len, i + 1)) < db->db_len)\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d \", i);\n\tout += snprintf(buf + out, PAGE_SIZE - out, \"\\n\");\n\ndone:\n\ti_size_write(inode, out);\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define O2HB_DB_TYPE_REGION_PINNED\t7",
      "#define O2HB_DB_TYPE_REGION_ELAPSED_TIME\t6",
      "#define O2HB_DB_TYPE_REGION_NUMBER\t5",
      "#define O2HB_DB_TYPE_REGION_LIVENODES\t4",
      "#define O2HB_DB_TYPE_FAILEDREGIONS\t3",
      "#define O2HB_DB_TYPE_QUORUMREGIONS\t2",
      "#define O2HB_DB_TYPE_LIVEREGIONS\t1",
      "#define O2HB_DB_TYPE_LIVENODES\t\t0"
    ],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "out"
          ],
          "line": 1236
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"\\n\""
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"%d \"",
            "i"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "map",
            "db->db_len",
            "i + 1"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"%u\\n\"",
            "!!reg->hr_item_pinned"
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"%lu\\n\"",
            "lts"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jiffies_to_msecs",
          "args": [
            "jiffies - lts"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"%d\\n\"",
            "reg->hr_region_num"
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "map",
            "reg->hr_live_node_bitmap",
            "db->db_size"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 1200
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "map",
            "db->db_data",
            "db->db_size"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 1185
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "sizeof(map) < db->db_size"
          ],
          "line": 1183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_DB_TYPE_REGION_PINNED\t7\n#define O2HB_DB_TYPE_REGION_ELAPSED_TIME\t6\n#define O2HB_DB_TYPE_REGION_NUMBER\t5\n#define O2HB_DB_TYPE_REGION_LIVENODES\t4\n#define O2HB_DB_TYPE_FAILEDREGIONS\t3\n#define O2HB_DB_TYPE_QUORUMREGIONS\t2\n#define O2HB_DB_TYPE_LIVEREGIONS\t1\n#define O2HB_DB_TYPE_LIVENODES\t\t0\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nstatic int o2hb_debug_open(struct inode *inode, struct file *file)\n{\n\tstruct o2hb_debug_buf *db = inode->i_private;\n\tstruct o2hb_region *reg;\n\tunsigned long map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long lts;\n\tchar *buf = NULL;\n\tint i = -1;\n\tint out = 0;\n\n\t/* max_nodes should be the largest bitmap we pass here */\n\tBUG_ON(sizeof(map) < db->db_size);\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\tgoto bail;\n\n\tswitch (db->db_type) {\n\tcase O2HB_DB_TYPE_LIVENODES:\n\tcase O2HB_DB_TYPE_LIVEREGIONS:\n\tcase O2HB_DB_TYPE_QUORUMREGIONS:\n\tcase O2HB_DB_TYPE_FAILEDREGIONS:\n\t\tspin_lock(&o2hb_live_lock);\n\t\tmemcpy(map, db->db_data, db->db_size);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tbreak;\n\n\tcase O2HB_DB_TYPE_REGION_LIVENODES:\n\t\tspin_lock(&o2hb_live_lock);\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tmemcpy(map, reg->hr_live_node_bitmap, db->db_size);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tbreak;\n\n\tcase O2HB_DB_TYPE_REGION_NUMBER:\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d\\n\",\n\t\t\t\treg->hr_region_num);\n\t\tgoto done;\n\n\tcase O2HB_DB_TYPE_REGION_ELAPSED_TIME:\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tlts = reg->hr_last_timeout_start;\n\t\t/* If 0, it has never been set before */\n\t\tif (lts)\n\t\t\tlts = jiffies_to_msecs(jiffies - lts);\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%lu\\n\", lts);\n\t\tgoto done;\n\n\tcase O2HB_DB_TYPE_REGION_PINNED:\n\t\treg = (struct o2hb_region *)db->db_data;\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%u\\n\",\n\t\t\t\t!!reg->hr_item_pinned);\n\t\tgoto done;\n\n\tdefault:\n\t\tgoto done;\n\t}\n\n\twhile ((i = find_next_bit(map, db->db_len, i + 1)) < db->db_len)\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d \", i);\n\tout += snprintf(buf + out, PAGE_SIZE - out, \"\\n\");\n\ndone:\n\ti_size_write(inode, out);\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "o2hb_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1100-1169",
    "snippet": "static int o2hb_thread(void *data)\n{\n\tint i, ret;\n\tstruct o2hb_region *reg = data;\n\tstruct o2hb_bio_wait_ctxt write_wc;\n\tstruct timeval before_hb, after_hb;\n\tunsigned int elapsed_msec;\n\n\tmlog(ML_HEARTBEAT|ML_KTHREAD, \"hb thread running\\n\");\n\n\tset_user_nice(current, MIN_NICE);\n\n\t/* Pin node */\n\to2nm_depend_this_node();\n\n\twhile (!kthread_should_stop() &&\n\t       !reg->hr_unclean_stop && !reg->hr_aborted_start) {\n\t\t/* We track the time spent inside\n\t\t * o2hb_do_disk_heartbeat so that we avoid more than\n\t\t * hr_timeout_ms between disk writes. On busy systems\n\t\t * this should result in a heartbeat which is less\n\t\t * likely to time itself out. */\n\t\tdo_gettimeofday(&before_hb);\n\n\t\tret = o2hb_do_disk_heartbeat(reg);\n\n\t\tdo_gettimeofday(&after_hb);\n\t\telapsed_msec = o2hb_elapsed_msecs(&before_hb, &after_hb);\n\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"start = %lu.%lu, end = %lu.%lu, msec = %u, ret = %d\\n\",\n\t\t     before_hb.tv_sec, (unsigned long) before_hb.tv_usec,\n\t\t     after_hb.tv_sec, (unsigned long) after_hb.tv_usec,\n\t\t     elapsed_msec, ret);\n\n\t\tif (!kthread_should_stop() &&\n\t\t    elapsed_msec < reg->hr_timeout_ms) {\n\t\t\t/* the kthread api has blocked signals for us so no\n\t\t\t * need to record the return value. */\n\t\t\tmsleep_interruptible(reg->hr_timeout_ms - elapsed_msec);\n\t\t}\n\t}\n\n\to2hb_disarm_write_timeout(reg);\n\n\t/* unclean stop is only used in very bad situation */\n\tfor(i = 0; !reg->hr_unclean_stop && i < reg->hr_blocks; i++)\n\t\to2hb_shutdown_slot(&reg->hr_slots[i]);\n\n\t/* Explicit down notification - avoid forcing the other nodes\n\t * to timeout on this region when we could just as easily\n\t * write a clear generation - thus indicating to them that\n\t * this node has left this region.\n\t */\n\tif (!reg->hr_unclean_stop && !reg->hr_aborted_start) {\n\t\to2hb_prepare_block(reg, 0);\n\t\tret = o2hb_issue_node_write(reg, &write_wc);\n\t\tif (ret == 0)\n\t\t\to2hb_wait_on_io(reg, &write_wc);\n\t\telse\n\t\t\tmlog_errno(ret);\n\t}\n\n\t/* Unpin node */\n\to2nm_undepend_this_node();\n\n\tmlog(ML_HEARTBEAT|ML_KTHREAD, \"o2hb thread exiting\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT|ML_KTHREAD",
            "\"o2hb thread exiting\\n\""
          ],
          "line": 1166
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "36-48",
          "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_undepend_this_node",
          "args": [],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_undepend_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "920-929",
          "snippet": "void o2nm_undepend_this_node(void)\n{\n\tstruct o2nm_node *local_node;\n\n\tlocal_node = o2nm_get_node_by_num(o2nm_this_node());\n\tBUG_ON(!local_node);\n\n\to2nm_undepend_item(&local_node->nd_item);\n\to2nm_node_put(local_node);\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nvoid o2nm_undepend_this_node(void)\n{\n\tstruct o2nm_node *local_node;\n\n\tlocal_node = o2nm_get_node_by_num(o2nm_this_node());\n\tBUG_ON(!local_node);\n\n\to2nm_undepend_item(&local_node->nd_item);\n\to2nm_node_put(local_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_wait_on_io",
          "args": [
            "reg",
            "&write_wc"
          ],
          "line": 1158
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_wait_on_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "368-373",
          "snippet": "static void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_issue_node_write",
          "args": [
            "reg",
            "&write_wc"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_issue_node_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "476-500",
          "snippet": "static int o2hb_issue_node_write(struct o2hb_region *reg,\n\t\t\t\t struct o2hb_bio_wait_ctxt *write_wc)\n{\n\tint status;\n\tunsigned int slot;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(write_wc);\n\n\tslot = o2nm_this_node();\n\n\tbio = o2hb_setup_one_bio(reg, write_wc, &slot, slot+1);\n\tif (IS_ERR(bio)) {\n\t\tstatus = PTR_ERR(bio);\n\t\tmlog_errno(status);\n\t\tgoto bail;\n\t}\n\n\tatomic_inc(&write_wc->wc_num_reqs);\n\tsubmit_bio(WRITE_SYNC, bio);\n\n\tstatus = 0;\nbail:\n\treturn status;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_issue_node_write(struct o2hb_region *reg,\n\t\t\t\t struct o2hb_bio_wait_ctxt *write_wc)\n{\n\tint status;\n\tunsigned int slot;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(write_wc);\n\n\tslot = o2nm_this_node();\n\n\tbio = o2hb_setup_one_bio(reg, write_wc, &slot, slot+1);\n\tif (IS_ERR(bio)) {\n\t\tstatus = PTR_ERR(bio);\n\t\tmlog_errno(status);\n\t\tgoto bail;\n\t}\n\n\tatomic_inc(&write_wc->wc_num_reqs);\n\tsubmit_bio(WRITE_SYNC, bio);\n\n\tstatus = 0;\nbail:\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_prepare_block",
          "args": [
            "reg",
            "0"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_prepare_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "587-617",
          "snippet": "static inline void o2hb_prepare_block(struct o2hb_region *reg,\n\t\t\t\t      u64 generation)\n{\n\tint node_num;\n\tu64 cputime;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tnode_num = o2nm_this_node();\n\tslot = &reg->hr_slots[node_num];\n\n\thb_block = (struct o2hb_disk_heartbeat_block *)slot->ds_raw_block;\n\tmemset(hb_block, 0, reg->hr_block_bytes);\n\t/* TODO: time stuff */\n\tcputime = CURRENT_TIME.tv_sec;\n\tif (!cputime)\n\t\tcputime = 1;\n\n\thb_block->hb_seq = cpu_to_le64(cputime);\n\thb_block->hb_node = node_num;\n\thb_block->hb_generation = cpu_to_le64(generation);\n\thb_block->hb_dead_ms = cpu_to_le32(o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS);\n\n\t/* This step must always happen last! */\n\thb_block->hb_cksum = cpu_to_le32(o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block));\n\n\tmlog(ML_HB_BIO, \"our node generation = 0x%llx, cksum = 0x%x\\n\",\n\t     (long long)generation,\n\t     le32_to_cpu(hb_block->hb_cksum));\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic inline void o2hb_prepare_block(struct o2hb_region *reg,\n\t\t\t\t      u64 generation)\n{\n\tint node_num;\n\tu64 cputime;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tnode_num = o2nm_this_node();\n\tslot = &reg->hr_slots[node_num];\n\n\thb_block = (struct o2hb_disk_heartbeat_block *)slot->ds_raw_block;\n\tmemset(hb_block, 0, reg->hr_block_bytes);\n\t/* TODO: time stuff */\n\tcputime = CURRENT_TIME.tv_sec;\n\tif (!cputime)\n\t\tcputime = 1;\n\n\thb_block->hb_seq = cpu_to_le64(cputime);\n\thb_block->hb_node = node_num;\n\thb_block->hb_generation = cpu_to_le64(generation);\n\thb_block->hb_dead_ms = cpu_to_le32(o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS);\n\n\t/* This step must always happen last! */\n\thb_block->hb_cksum = cpu_to_le32(o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block));\n\n\tmlog(ML_HB_BIO, \"our node generation = 0x%llx, cksum = 0x%x\\n\",\n\t     (long long)generation,\n\t     le32_to_cpu(hb_block->hb_cksum));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_shutdown_slot",
          "args": [
            "&reg->hr_slots[i]"
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_shutdown_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "690-722",
          "snippet": "static void o2hb_shutdown_slot(struct o2hb_disk_slot *slot)\n{\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tint queued = 0;\n\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\tif (!list_empty(&slot->ds_live_item)) {\n\t\tmlog(ML_HEARTBEAT, \"Shutdown, node %d leaves region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tlist_del_init(&slot->ds_live_item);\n\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\t\t\tqueued = 1;\n\t\t}\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\to2nm_node_put(node);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static struct list_head o2hb_live_slots[O2NM_MAX_NODES];",
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic struct list_head o2hb_live_slots[O2NM_MAX_NODES];\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\nstatic void o2hb_shutdown_slot(struct o2hb_disk_slot *slot)\n{\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tint queued = 0;\n\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\tif (!list_empty(&slot->ds_live_item)) {\n\t\tmlog(ML_HEARTBEAT, \"Shutdown, node %d leaves region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tlist_del_init(&slot->ds_live_item);\n\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\t\t\tqueued = 1;\n\t\t}\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\to2nm_node_put(node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_disarm_write_timeout",
          "args": [
            "reg"
          ],
          "line": 1143
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_disarm_write_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "342-345",
          "snippet": "static void o2hb_disarm_write_timeout(struct o2hb_region *reg)\n{\n\tcancel_delayed_work_sync(&reg->hr_write_timeout_work);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_disarm_write_timeout(struct o2hb_region *reg)\n{\n\tcancel_delayed_work_sync(&reg->hr_write_timeout_work);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msleep_interruptible",
          "args": [
            "reg->hr_timeout_ms - elapsed_msec"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_should_stop",
          "args": [],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"start = %lu.%lu, end = %lu.%lu, msec = %u, ret = %d\\n\"",
            "before_hb.tv_sec",
            "(unsigned long) before_hb.tv_usec",
            "after_hb.tv_sec",
            "(unsigned long) after_hb.tv_usec",
            "elapsed_msec",
            "ret"
          ],
          "line": 1129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_elapsed_msecs",
          "args": [
            "&before_hb",
            "&after_hb"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_elapsed_msecs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1085-1093",
          "snippet": "static unsigned int o2hb_elapsed_msecs(struct timeval *start,\n\t\t\t\t       struct timeval *end)\n{\n\tstruct timeval res = *end;\n\n\to2hb_tv_subtract(&res, start);\n\n\treturn res.tv_sec * 1000 + res.tv_usec / 1000;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic unsigned int o2hb_elapsed_msecs(struct timeval *start,\n\t\t\t\t       struct timeval *end)\n{\n\tstruct timeval res = *end;\n\n\to2hb_tv_subtract(&res, start);\n\n\treturn res.tv_sec * 1000 + res.tv_usec / 1000;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_gettimeofday",
          "args": [
            "&after_hb"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_do_disk_heartbeat",
          "args": [
            "reg"
          ],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_do_disk_heartbeat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "954-1062",
          "snippet": "static int o2hb_do_disk_heartbeat(struct o2hb_region *reg)\n{\n\tint i, ret, highest_node;\n\tint membership_change = 0, own_slot_ok = 0;\n\tunsigned long configured_nodes[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tstruct o2hb_bio_wait_ctxt write_wc;\n\n\tret = o2nm_configured_node_map(configured_nodes,\n\t\t\t\t       sizeof(configured_nodes));\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/*\n\t * If a node is not configured but is in the livemap, we still need\n\t * to read the slot so as to be able to remove it from the livemap.\n\t */\n\to2hb_fill_node_map(live_node_bitmap, sizeof(live_node_bitmap));\n\ti = -1;\n\twhile ((i = find_next_bit(live_node_bitmap,\n\t\t\t\t  O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tset_bit(i, configured_nodes);\n\t}\n\n\thighest_node = o2hb_highest_node(configured_nodes, O2NM_MAX_NODES);\n\tif (highest_node >= O2NM_MAX_NODES) {\n\t\tmlog(ML_NOTICE, \"o2hb: No configured nodes found!\\n\");\n\t\tret = -EINVAL;\n\t\tgoto bail;\n\t}\n\n\t/* No sense in reading the slots of nodes that don't exist\n\t * yet. Of course, if the node definitions have holes in them\n\t * then we're reading an empty slot anyway... Consider this\n\t * best-effort. */\n\tret = o2hb_read_slots(reg, highest_node + 1);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/* With an up to date view of the slots, we can check that no\n\t * other node has been improperly configured to heartbeat in\n\t * our slot. */\n\town_slot_ok = o2hb_check_own_slot(reg);\n\n\t/* fill in the proper info for our next heartbeat */\n\to2hb_prepare_block(reg, reg->hr_generation);\n\n\tret = o2hb_issue_node_write(reg, &write_wc);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\ti = -1;\n\twhile((i = find_next_bit(configured_nodes,\n\t\t\t\t O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tmembership_change |= o2hb_check_slot(reg, &reg->hr_slots[i]);\n\t}\n\n\t/*\n\t * We have to be sure we've advertised ourselves on disk\n\t * before we can go to steady state.  This ensures that\n\t * people we find in our steady state have seen us.\n\t */\n\to2hb_wait_on_io(reg, &write_wc);\n\tif (write_wc.wc_error) {\n\t\t/* Do not re-arm the write timeout on I/O error - we\n\t\t * can't be sure that the new block ever made it to\n\t\t * disk */\n\t\tmlog(ML_ERROR, \"Write error %d on device \\\"%s\\\"\\n\",\n\t\t     write_wc.wc_error, reg->hr_dev_name);\n\t\tret = write_wc.wc_error;\n\t\tgoto bail;\n\t}\n\n\t/* Skip disarming the timeout if own slot has stale/bad data */\n\tif (own_slot_ok) {\n\t\to2hb_set_quorum_device(reg);\n\t\to2hb_arm_write_timeout(reg);\n\t}\n\nbail:\n\t/* let the person who launched us know when things are steady */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (!ret && own_slot_ok && !membership_change) {\n\t\t\tif (atomic_dec_and_test(&reg->hr_steady_iterations))\n\t\t\t\twake_up(&o2hb_steady_queue);\n\t\t}\n\t}\n\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (atomic_dec_and_test(&reg->hr_unsteady_iterations)) {\n\t\t\tprintk(KERN_NOTICE \"o2hb: Unable to stabilize \"\n\t\t\t       \"heartbeart on region %s (%s)\\n\",\n\t\t\t       config_item_name(&reg->hr_item),\n\t\t\t       reg->hr_dev_name);\n\t\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\t\treg->hr_aborted_start = 1;\n\t\t\twake_up(&o2hb_steady_queue);\n\t\t\tret = -EIO;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);\n\nstatic int o2hb_do_disk_heartbeat(struct o2hb_region *reg)\n{\n\tint i, ret, highest_node;\n\tint membership_change = 0, own_slot_ok = 0;\n\tunsigned long configured_nodes[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tstruct o2hb_bio_wait_ctxt write_wc;\n\n\tret = o2nm_configured_node_map(configured_nodes,\n\t\t\t\t       sizeof(configured_nodes));\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/*\n\t * If a node is not configured but is in the livemap, we still need\n\t * to read the slot so as to be able to remove it from the livemap.\n\t */\n\to2hb_fill_node_map(live_node_bitmap, sizeof(live_node_bitmap));\n\ti = -1;\n\twhile ((i = find_next_bit(live_node_bitmap,\n\t\t\t\t  O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tset_bit(i, configured_nodes);\n\t}\n\n\thighest_node = o2hb_highest_node(configured_nodes, O2NM_MAX_NODES);\n\tif (highest_node >= O2NM_MAX_NODES) {\n\t\tmlog(ML_NOTICE, \"o2hb: No configured nodes found!\\n\");\n\t\tret = -EINVAL;\n\t\tgoto bail;\n\t}\n\n\t/* No sense in reading the slots of nodes that don't exist\n\t * yet. Of course, if the node definitions have holes in them\n\t * then we're reading an empty slot anyway... Consider this\n\t * best-effort. */\n\tret = o2hb_read_slots(reg, highest_node + 1);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/* With an up to date view of the slots, we can check that no\n\t * other node has been improperly configured to heartbeat in\n\t * our slot. */\n\town_slot_ok = o2hb_check_own_slot(reg);\n\n\t/* fill in the proper info for our next heartbeat */\n\to2hb_prepare_block(reg, reg->hr_generation);\n\n\tret = o2hb_issue_node_write(reg, &write_wc);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\ti = -1;\n\twhile((i = find_next_bit(configured_nodes,\n\t\t\t\t O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tmembership_change |= o2hb_check_slot(reg, &reg->hr_slots[i]);\n\t}\n\n\t/*\n\t * We have to be sure we've advertised ourselves on disk\n\t * before we can go to steady state.  This ensures that\n\t * people we find in our steady state have seen us.\n\t */\n\to2hb_wait_on_io(reg, &write_wc);\n\tif (write_wc.wc_error) {\n\t\t/* Do not re-arm the write timeout on I/O error - we\n\t\t * can't be sure that the new block ever made it to\n\t\t * disk */\n\t\tmlog(ML_ERROR, \"Write error %d on device \\\"%s\\\"\\n\",\n\t\t     write_wc.wc_error, reg->hr_dev_name);\n\t\tret = write_wc.wc_error;\n\t\tgoto bail;\n\t}\n\n\t/* Skip disarming the timeout if own slot has stale/bad data */\n\tif (own_slot_ok) {\n\t\to2hb_set_quorum_device(reg);\n\t\to2hb_arm_write_timeout(reg);\n\t}\n\nbail:\n\t/* let the person who launched us know when things are steady */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (!ret && own_slot_ok && !membership_change) {\n\t\t\tif (atomic_dec_and_test(&reg->hr_steady_iterations))\n\t\t\t\twake_up(&o2hb_steady_queue);\n\t\t}\n\t}\n\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (atomic_dec_and_test(&reg->hr_unsteady_iterations)) {\n\t\t\tprintk(KERN_NOTICE \"o2hb: Unable to stabilize \"\n\t\t\t       \"heartbeart on region %s (%s)\\n\",\n\t\t\t       config_item_name(&reg->hr_item),\n\t\t\t       reg->hr_dev_name);\n\t\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\t\treg->hr_aborted_start = 1;\n\t\t\twake_up(&o2hb_steady_queue);\n\t\t\tret = -EIO;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_gettimeofday",
          "args": [
            "&before_hb"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_should_stop",
          "args": [],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2nm_depend_this_node",
          "args": [],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_depend_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "902-918",
          "snippet": "int o2nm_depend_this_node(void)\n{\n\tint ret = 0;\n\tstruct o2nm_node *local_node;\n\n\tlocal_node = o2nm_get_node_by_num(o2nm_this_node());\n\tif (!local_node) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tret = o2nm_depend_item(&local_node->nd_item);\n\to2nm_node_put(local_node);\n\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nint o2nm_depend_this_node(void)\n{\n\tint ret = 0;\n\tstruct o2nm_node *local_node;\n\n\tlocal_node = o2nm_get_node_by_num(o2nm_this_node());\n\tif (!local_node) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tret = o2nm_depend_item(&local_node->nd_item);\n\to2nm_node_put(local_node);\n\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_user_nice",
          "args": [
            "current",
            "MIN_NICE"
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_thread(void *data)\n{\n\tint i, ret;\n\tstruct o2hb_region *reg = data;\n\tstruct o2hb_bio_wait_ctxt write_wc;\n\tstruct timeval before_hb, after_hb;\n\tunsigned int elapsed_msec;\n\n\tmlog(ML_HEARTBEAT|ML_KTHREAD, \"hb thread running\\n\");\n\n\tset_user_nice(current, MIN_NICE);\n\n\t/* Pin node */\n\to2nm_depend_this_node();\n\n\twhile (!kthread_should_stop() &&\n\t       !reg->hr_unclean_stop && !reg->hr_aborted_start) {\n\t\t/* We track the time spent inside\n\t\t * o2hb_do_disk_heartbeat so that we avoid more than\n\t\t * hr_timeout_ms between disk writes. On busy systems\n\t\t * this should result in a heartbeat which is less\n\t\t * likely to time itself out. */\n\t\tdo_gettimeofday(&before_hb);\n\n\t\tret = o2hb_do_disk_heartbeat(reg);\n\n\t\tdo_gettimeofday(&after_hb);\n\t\telapsed_msec = o2hb_elapsed_msecs(&before_hb, &after_hb);\n\n\t\tmlog(ML_HEARTBEAT,\n\t\t     \"start = %lu.%lu, end = %lu.%lu, msec = %u, ret = %d\\n\",\n\t\t     before_hb.tv_sec, (unsigned long) before_hb.tv_usec,\n\t\t     after_hb.tv_sec, (unsigned long) after_hb.tv_usec,\n\t\t     elapsed_msec, ret);\n\n\t\tif (!kthread_should_stop() &&\n\t\t    elapsed_msec < reg->hr_timeout_ms) {\n\t\t\t/* the kthread api has blocked signals for us so no\n\t\t\t * need to record the return value. */\n\t\t\tmsleep_interruptible(reg->hr_timeout_ms - elapsed_msec);\n\t\t}\n\t}\n\n\to2hb_disarm_write_timeout(reg);\n\n\t/* unclean stop is only used in very bad situation */\n\tfor(i = 0; !reg->hr_unclean_stop && i < reg->hr_blocks; i++)\n\t\to2hb_shutdown_slot(&reg->hr_slots[i]);\n\n\t/* Explicit down notification - avoid forcing the other nodes\n\t * to timeout on this region when we could just as easily\n\t * write a clear generation - thus indicating to them that\n\t * this node has left this region.\n\t */\n\tif (!reg->hr_unclean_stop && !reg->hr_aborted_start) {\n\t\to2hb_prepare_block(reg, 0);\n\t\tret = o2hb_issue_node_write(reg, &write_wc);\n\t\tif (ret == 0)\n\t\t\to2hb_wait_on_io(reg, &write_wc);\n\t\telse\n\t\t\tmlog_errno(ret);\n\t}\n\n\t/* Unpin node */\n\to2nm_undepend_this_node();\n\n\tmlog(ML_HEARTBEAT|ML_KTHREAD, \"o2hb thread exiting\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_elapsed_msecs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1085-1093",
    "snippet": "static unsigned int o2hb_elapsed_msecs(struct timeval *start,\n\t\t\t\t       struct timeval *end)\n{\n\tstruct timeval res = *end;\n\n\to2hb_tv_subtract(&res, start);\n\n\treturn res.tv_sec * 1000 + res.tv_usec / 1000;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_tv_subtract",
          "args": [
            "&res",
            "start"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_tv_subtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1066-1083",
          "snippet": "static void o2hb_tv_subtract(struct timeval *a,\n\t\t\t     struct timeval *b)\n{\n\t/* just return 0 when a is after b */\n\tif (a->tv_sec < b->tv_sec ||\n\t    (a->tv_sec == b->tv_sec && a->tv_usec < b->tv_usec)) {\n\t\ta->tv_sec = 0;\n\t\ta->tv_usec = 0;\n\t\treturn;\n\t}\n\n\ta->tv_sec -= b->tv_sec;\n\ta->tv_usec -= b->tv_usec;\n\twhile ( a->tv_usec < 0 ) {\n\t\ta->tv_sec--;\n\t\ta->tv_usec += 1000000;\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_tv_subtract(struct timeval *a,\n\t\t\t     struct timeval *b)\n{\n\t/* just return 0 when a is after b */\n\tif (a->tv_sec < b->tv_sec ||\n\t    (a->tv_sec == b->tv_sec && a->tv_usec < b->tv_usec)) {\n\t\ta->tv_sec = 0;\n\t\ta->tv_usec = 0;\n\t\treturn;\n\t}\n\n\ta->tv_sec -= b->tv_sec;\n\ta->tv_usec -= b->tv_usec;\n\twhile ( a->tv_usec < 0 ) {\n\t\ta->tv_sec--;\n\t\ta->tv_usec += 1000000;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic unsigned int o2hb_elapsed_msecs(struct timeval *start,\n\t\t\t\t       struct timeval *end)\n{\n\tstruct timeval res = *end;\n\n\to2hb_tv_subtract(&res, start);\n\n\treturn res.tv_sec * 1000 + res.tv_usec / 1000;\n}"
  },
  {
    "function_name": "o2hb_tv_subtract",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "1066-1083",
    "snippet": "static void o2hb_tv_subtract(struct timeval *a,\n\t\t\t     struct timeval *b)\n{\n\t/* just return 0 when a is after b */\n\tif (a->tv_sec < b->tv_sec ||\n\t    (a->tv_sec == b->tv_sec && a->tv_usec < b->tv_usec)) {\n\t\ta->tv_sec = 0;\n\t\ta->tv_usec = 0;\n\t\treturn;\n\t}\n\n\ta->tv_sec -= b->tv_sec;\n\ta->tv_usec -= b->tv_usec;\n\twhile ( a->tv_usec < 0 ) {\n\t\ta->tv_sec--;\n\t\ta->tv_usec += 1000000;\n\t}\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_tv_subtract(struct timeval *a,\n\t\t\t     struct timeval *b)\n{\n\t/* just return 0 when a is after b */\n\tif (a->tv_sec < b->tv_sec ||\n\t    (a->tv_sec == b->tv_sec && a->tv_usec < b->tv_usec)) {\n\t\ta->tv_sec = 0;\n\t\ta->tv_usec = 0;\n\t\treturn;\n\t}\n\n\ta->tv_sec -= b->tv_sec;\n\ta->tv_usec -= b->tv_usec;\n\twhile ( a->tv_usec < 0 ) {\n\t\ta->tv_sec--;\n\t\ta->tv_usec += 1000000;\n\t}\n}"
  },
  {
    "function_name": "o2hb_do_disk_heartbeat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "954-1062",
    "snippet": "static int o2hb_do_disk_heartbeat(struct o2hb_region *reg)\n{\n\tint i, ret, highest_node;\n\tint membership_change = 0, own_slot_ok = 0;\n\tunsigned long configured_nodes[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tstruct o2hb_bio_wait_ctxt write_wc;\n\n\tret = o2nm_configured_node_map(configured_nodes,\n\t\t\t\t       sizeof(configured_nodes));\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/*\n\t * If a node is not configured but is in the livemap, we still need\n\t * to read the slot so as to be able to remove it from the livemap.\n\t */\n\to2hb_fill_node_map(live_node_bitmap, sizeof(live_node_bitmap));\n\ti = -1;\n\twhile ((i = find_next_bit(live_node_bitmap,\n\t\t\t\t  O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tset_bit(i, configured_nodes);\n\t}\n\n\thighest_node = o2hb_highest_node(configured_nodes, O2NM_MAX_NODES);\n\tif (highest_node >= O2NM_MAX_NODES) {\n\t\tmlog(ML_NOTICE, \"o2hb: No configured nodes found!\\n\");\n\t\tret = -EINVAL;\n\t\tgoto bail;\n\t}\n\n\t/* No sense in reading the slots of nodes that don't exist\n\t * yet. Of course, if the node definitions have holes in them\n\t * then we're reading an empty slot anyway... Consider this\n\t * best-effort. */\n\tret = o2hb_read_slots(reg, highest_node + 1);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/* With an up to date view of the slots, we can check that no\n\t * other node has been improperly configured to heartbeat in\n\t * our slot. */\n\town_slot_ok = o2hb_check_own_slot(reg);\n\n\t/* fill in the proper info for our next heartbeat */\n\to2hb_prepare_block(reg, reg->hr_generation);\n\n\tret = o2hb_issue_node_write(reg, &write_wc);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\ti = -1;\n\twhile((i = find_next_bit(configured_nodes,\n\t\t\t\t O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tmembership_change |= o2hb_check_slot(reg, &reg->hr_slots[i]);\n\t}\n\n\t/*\n\t * We have to be sure we've advertised ourselves on disk\n\t * before we can go to steady state.  This ensures that\n\t * people we find in our steady state have seen us.\n\t */\n\to2hb_wait_on_io(reg, &write_wc);\n\tif (write_wc.wc_error) {\n\t\t/* Do not re-arm the write timeout on I/O error - we\n\t\t * can't be sure that the new block ever made it to\n\t\t * disk */\n\t\tmlog(ML_ERROR, \"Write error %d on device \\\"%s\\\"\\n\",\n\t\t     write_wc.wc_error, reg->hr_dev_name);\n\t\tret = write_wc.wc_error;\n\t\tgoto bail;\n\t}\n\n\t/* Skip disarming the timeout if own slot has stale/bad data */\n\tif (own_slot_ok) {\n\t\to2hb_set_quorum_device(reg);\n\t\to2hb_arm_write_timeout(reg);\n\t}\n\nbail:\n\t/* let the person who launched us know when things are steady */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (!ret && own_slot_ok && !membership_change) {\n\t\t\tif (atomic_dec_and_test(&reg->hr_steady_iterations))\n\t\t\t\twake_up(&o2hb_steady_queue);\n\t\t}\n\t}\n\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (atomic_dec_and_test(&reg->hr_unsteady_iterations)) {\n\t\t\tprintk(KERN_NOTICE \"o2hb: Unable to stabilize \"\n\t\t\t       \"heartbeart on region %s (%s)\\n\",\n\t\t\t       config_item_name(&reg->hr_item),\n\t\t\t       reg->hr_dev_name);\n\t\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\t\treg->hr_aborted_start = 1;\n\t\t\twake_up(&o2hb_steady_queue);\n\t\t\tret = -EIO;\n\t\t}\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "&o2hb_steady_queue"
          ],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "locks_wake_up_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/locks.c",
          "lines": "656-681",
          "snippet": "static void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <asm/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/lglock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(blocked_lock_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <asm/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/lglock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nstatic DEFINE_SPINLOCK(blocked_lock_lock);\n\nstatic void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&reg->hr_steady_iterations",
            "0"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"o2hb: Unable to stabilize \"\n\t\t\t       \"heartbeart on region %s (%s)\\n\"",
            "config_item_name(&reg->hr_item)",
            "reg->hr_dev_name"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&reg->hr_unsteady_iterations"
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_arm_write_timeout",
          "args": [
            "reg"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_arm_write_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "322-340",
          "snippet": "static void o2hb_arm_write_timeout(struct o2hb_region *reg)\n{\n\t/* Arm writeout only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tmlog(ML_HEARTBEAT, \"Queue write timeout for %u ms\\n\",\n\t     O2HB_MAX_WRITE_TIMEOUT_MS);\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tclear_bit(reg->hr_region_num, o2hb_failed_region_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\tcancel_delayed_work(&reg->hr_write_timeout_work);\n\treg->hr_last_timeout_start = jiffies;\n\tschedule_delayed_work(&reg->hr_write_timeout_work,\n\t\t\t      msecs_to_jiffies(O2HB_MAX_WRITE_TIMEOUT_MS));\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\n\nstatic void o2hb_arm_write_timeout(struct o2hb_region *reg)\n{\n\t/* Arm writeout only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tmlog(ML_HEARTBEAT, \"Queue write timeout for %u ms\\n\",\n\t     O2HB_MAX_WRITE_TIMEOUT_MS);\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tclear_bit(reg->hr_region_num, o2hb_failed_region_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\tcancel_delayed_work(&reg->hr_write_timeout_work);\n\treg->hr_last_timeout_start = jiffies;\n\tschedule_delayed_work(&reg->hr_write_timeout_work,\n\t\t\t      msecs_to_jiffies(O2HB_MAX_WRITE_TIMEOUT_MS));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_set_quorum_device",
          "args": [
            "reg"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_set_quorum_device",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "724-765",
          "snippet": "static void o2hb_set_quorum_device(struct o2hb_region *reg)\n{\n\tif (!o2hb_global_heartbeat_active())\n\t\treturn;\n\n\t/* Prevent race with o2hb_heartbeat_group_drop_item() */\n\tif (kthread_should_stop())\n\t\treturn;\n\n\t/* Tag region as quorum only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\n\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\tgoto unlock;\n\n\t/*\n\t * A region can be added to the quorum only when it sees all\n\t * live nodes heartbeat on it. In other words, the region has been\n\t * added to all nodes.\n\t */\n\tif (memcmp(reg->hr_live_node_bitmap, o2hb_live_node_bitmap,\n\t\t   sizeof(o2hb_live_node_bitmap)))\n\t\tgoto unlock;\n\n\tprintk(KERN_NOTICE \"o2hb: Region %s (%s) is now a quorum device\\n\",\n\t       config_item_name(&reg->hr_item), reg->hr_dev_name);\n\n\tset_bit(reg->hr_region_num, o2hb_quorum_region_bitmap);\n\n\t/*\n\t * If global heartbeat active, unpin all regions if the\n\t * region count > CUT_OFF\n\t */\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) > O2HB_PIN_CUT_OFF)\n\t\to2hb_region_unpin(NULL);\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define O2HB_PIN_CUT_OFF\t\t3"
          ],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
            "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_PIN_CUT_OFF\t\t3\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\n\nstatic void o2hb_set_quorum_device(struct o2hb_region *reg)\n{\n\tif (!o2hb_global_heartbeat_active())\n\t\treturn;\n\n\t/* Prevent race with o2hb_heartbeat_group_drop_item() */\n\tif (kthread_should_stop())\n\t\treturn;\n\n\t/* Tag region as quorum only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\n\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\tgoto unlock;\n\n\t/*\n\t * A region can be added to the quorum only when it sees all\n\t * live nodes heartbeat on it. In other words, the region has been\n\t * added to all nodes.\n\t */\n\tif (memcmp(reg->hr_live_node_bitmap, o2hb_live_node_bitmap,\n\t\t   sizeof(o2hb_live_node_bitmap)))\n\t\tgoto unlock;\n\n\tprintk(KERN_NOTICE \"o2hb: Region %s (%s) is now a quorum device\\n\",\n\t       config_item_name(&reg->hr_item), reg->hr_dev_name);\n\n\tset_bit(reg->hr_region_num, o2hb_quorum_region_bitmap);\n\n\t/*\n\t * If global heartbeat active, unpin all regions if the\n\t * region count > CUT_OFF\n\t */\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) > O2HB_PIN_CUT_OFF)\n\t\to2hb_region_unpin(NULL);\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Write error %d on device \\\"%s\\\"\\n\"",
            "write_wc.wc_error",
            "reg->hr_dev_name"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_wait_on_io",
          "args": [
            "reg",
            "&write_wc"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_wait_on_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "368-373",
          "snippet": "static void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_check_slot",
          "args": [
            "reg",
            "&reg->hr_slots[i]"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_check_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "767-947",
          "snippet": "static int o2hb_check_slot(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_slot *slot)\n{\n\tint changed = 0, gen_changed = 0;\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tstruct o2hb_disk_heartbeat_block *hb_block = reg->hr_tmp_block;\n\tu64 cputime;\n\tunsigned int dead_ms = o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS;\n\tunsigned int slot_dead_ms;\n\tint tmp;\n\tint queued = 0;\n\n\tmemcpy(hb_block, slot->ds_raw_block, reg->hr_block_bytes);\n\n\t/*\n\t * If a node is no longer configured but is still in the livemap, we\n\t * may need to clear that bit from the livemap.\n\t */\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\ttmp = test_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tif (!tmp)\n\t\t\treturn 0;\n\t}\n\n\tif (!o2hb_verify_crc(reg, hb_block)) {\n\t\t/* all paths from here will drop o2hb_live_lock for\n\t\t * us. */\n\t\tspin_lock(&o2hb_live_lock);\n\n\t\t/* Don't print an error on the console in this case -\n\t\t * a freshly formatted heartbeat area will not have a\n\t\t * crc set on it. */\n\t\tif (list_empty(&slot->ds_live_item))\n\t\t\tgoto out;\n\n\t\t/* The node is live but pushed out a bad crc. We\n\t\t * consider it a transient miss but don't populate any\n\t\t * other values as they may be junk. */\n\t\tmlog(ML_ERROR, \"Node %d has written a bad crc to %s\\n\",\n\t\t     slot->ds_node_num, reg->hr_dev_name);\n\t\to2hb_dump_slot(hb_block);\n\n\t\tslot->ds_equal_samples++;\n\t\tgoto fire_callbacks;\n\t}\n\n\t/* we don't care if these wrap.. the state transitions below\n\t * clear at the right places */\n\tcputime = le64_to_cpu(hb_block->hb_seq);\n\tif (slot->ds_last_time != cputime)\n\t\tslot->ds_changed_samples++;\n\telse\n\t\tslot->ds_equal_samples++;\n\tslot->ds_last_time = cputime;\n\n\t/* The node changed heartbeat generations. We assume this to\n\t * mean it dropped off but came back before we timed out. We\n\t * want to consider it down for the time being but don't want\n\t * to lose any changed_samples state we might build up to\n\t * considering it live again. */\n\tif (slot->ds_last_generation != le64_to_cpu(hb_block->hb_generation)) {\n\t\tgen_changed = 1;\n\t\tslot->ds_equal_samples = 0;\n\t\tmlog(ML_HEARTBEAT, \"Node %d changed generation (0x%llx \"\n\t\t     \"to 0x%llx)\\n\", slot->ds_node_num,\n\t\t     (long long)slot->ds_last_generation,\n\t\t     (long long)le64_to_cpu(hb_block->hb_generation));\n\t}\n\n\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\n\tmlog(ML_HEARTBEAT, \"Slot %d gen 0x%llx cksum 0x%x \"\n\t     \"seq %llu last %llu changed %u equal %u\\n\",\n\t     slot->ds_node_num, (long long)slot->ds_last_generation,\n\t     le32_to_cpu(hb_block->hb_cksum),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq),\n\t     (unsigned long long)slot->ds_last_time, slot->ds_changed_samples,\n\t     slot->ds_equal_samples);\n\n\tspin_lock(&o2hb_live_lock);\n\nfire_callbacks:\n\t/* dead nodes only come to life after some number of\n\t * changes at any time during their dead time */\n\tif (list_empty(&slot->ds_live_item) &&\n\t    slot->ds_changed_samples >= O2HB_LIVE_THRESHOLD) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d (id 0x%llx) joined my region\\n\",\n\t\t     slot->ds_node_num, (long long)slot->ds_last_generation);\n\n\t\tset_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* first on the list generates a callback */\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Add node %d to live nodes \"\n\t\t\t     \"bitmap\\n\", slot->ds_node_num);\n\t\t\tset_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_UP_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\tlist_add_tail(&slot->ds_live_item,\n\t\t\t      &o2hb_live_slots[slot->ds_node_num]);\n\n\t\tslot->ds_equal_samples = 0;\n\n\t\t/* We want to be sure that all nodes agree on the\n\t\t * number of milliseconds before a node will be\n\t\t * considered dead. The self-fencing timeout is\n\t\t * computed from this value, and a discrepancy might\n\t\t * result in heartbeat calling a node dead when it\n\t\t * hasn't self-fenced yet. */\n\t\tslot_dead_ms = le32_to_cpu(hb_block->hb_dead_ms);\n\t\tif (slot_dead_ms && slot_dead_ms != dead_ms) {\n\t\t\t/* TODO: Perhaps we can fail the region here. */\n\t\t\tmlog(ML_ERROR, \"Node %d on device %s has a dead count \"\n\t\t\t     \"of %u ms, but our count is %u ms.\\n\"\n\t\t\t     \"Please double check your configuration values \"\n\t\t\t     \"for 'O2CB_HEARTBEAT_THRESHOLD'\\n\",\n\t\t\t     slot->ds_node_num, reg->hr_dev_name, slot_dead_ms,\n\t\t\t     dead_ms);\n\t\t}\n\t\tgoto out;\n\t}\n\n\t/* if the list is dead, we're done.. */\n\tif (list_empty(&slot->ds_live_item))\n\t\tgoto out;\n\n\t/* live nodes only go dead after enough consequtive missed\n\t * samples..  reset the missed counter whenever we see\n\t * activity */\n\tif (slot->ds_equal_samples >= o2hb_dead_threshold || gen_changed) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d left my region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tclear_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* last off the live_slot generates a callback */\n\t\tlist_del_init(&slot->ds_live_item);\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Remove node %d from live \"\n\t\t\t     \"nodes bitmap\\n\", slot->ds_node_num);\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\t/* node can be null */\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB,\n\t\t\t\t\t      node, slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\t/* We don't clear this because the node is still\n\t\t * actually writing new blocks. */\n\t\tif (!gen_changed)\n\t\t\tslot->ds_changed_samples = 0;\n\t\tgoto out;\n\t}\n\tif (slot->ds_changed_samples) {\n\t\tslot->ds_changed_samples = 0;\n\t\tslot->ds_equal_samples = 0;\n\t}\nout:\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\tif (node)\n\t\to2nm_node_put(node);\n\treturn changed;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static struct list_head o2hb_live_slots[O2NM_MAX_NODES];",
            "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
            "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic struct list_head o2hb_live_slots[O2NM_MAX_NODES];\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic int o2hb_check_slot(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_slot *slot)\n{\n\tint changed = 0, gen_changed = 0;\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tstruct o2hb_disk_heartbeat_block *hb_block = reg->hr_tmp_block;\n\tu64 cputime;\n\tunsigned int dead_ms = o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS;\n\tunsigned int slot_dead_ms;\n\tint tmp;\n\tint queued = 0;\n\n\tmemcpy(hb_block, slot->ds_raw_block, reg->hr_block_bytes);\n\n\t/*\n\t * If a node is no longer configured but is still in the livemap, we\n\t * may need to clear that bit from the livemap.\n\t */\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\ttmp = test_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tif (!tmp)\n\t\t\treturn 0;\n\t}\n\n\tif (!o2hb_verify_crc(reg, hb_block)) {\n\t\t/* all paths from here will drop o2hb_live_lock for\n\t\t * us. */\n\t\tspin_lock(&o2hb_live_lock);\n\n\t\t/* Don't print an error on the console in this case -\n\t\t * a freshly formatted heartbeat area will not have a\n\t\t * crc set on it. */\n\t\tif (list_empty(&slot->ds_live_item))\n\t\t\tgoto out;\n\n\t\t/* The node is live but pushed out a bad crc. We\n\t\t * consider it a transient miss but don't populate any\n\t\t * other values as they may be junk. */\n\t\tmlog(ML_ERROR, \"Node %d has written a bad crc to %s\\n\",\n\t\t     slot->ds_node_num, reg->hr_dev_name);\n\t\to2hb_dump_slot(hb_block);\n\n\t\tslot->ds_equal_samples++;\n\t\tgoto fire_callbacks;\n\t}\n\n\t/* we don't care if these wrap.. the state transitions below\n\t * clear at the right places */\n\tcputime = le64_to_cpu(hb_block->hb_seq);\n\tif (slot->ds_last_time != cputime)\n\t\tslot->ds_changed_samples++;\n\telse\n\t\tslot->ds_equal_samples++;\n\tslot->ds_last_time = cputime;\n\n\t/* The node changed heartbeat generations. We assume this to\n\t * mean it dropped off but came back before we timed out. We\n\t * want to consider it down for the time being but don't want\n\t * to lose any changed_samples state we might build up to\n\t * considering it live again. */\n\tif (slot->ds_last_generation != le64_to_cpu(hb_block->hb_generation)) {\n\t\tgen_changed = 1;\n\t\tslot->ds_equal_samples = 0;\n\t\tmlog(ML_HEARTBEAT, \"Node %d changed generation (0x%llx \"\n\t\t     \"to 0x%llx)\\n\", slot->ds_node_num,\n\t\t     (long long)slot->ds_last_generation,\n\t\t     (long long)le64_to_cpu(hb_block->hb_generation));\n\t}\n\n\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\n\tmlog(ML_HEARTBEAT, \"Slot %d gen 0x%llx cksum 0x%x \"\n\t     \"seq %llu last %llu changed %u equal %u\\n\",\n\t     slot->ds_node_num, (long long)slot->ds_last_generation,\n\t     le32_to_cpu(hb_block->hb_cksum),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq),\n\t     (unsigned long long)slot->ds_last_time, slot->ds_changed_samples,\n\t     slot->ds_equal_samples);\n\n\tspin_lock(&o2hb_live_lock);\n\nfire_callbacks:\n\t/* dead nodes only come to life after some number of\n\t * changes at any time during their dead time */\n\tif (list_empty(&slot->ds_live_item) &&\n\t    slot->ds_changed_samples >= O2HB_LIVE_THRESHOLD) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d (id 0x%llx) joined my region\\n\",\n\t\t     slot->ds_node_num, (long long)slot->ds_last_generation);\n\n\t\tset_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* first on the list generates a callback */\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Add node %d to live nodes \"\n\t\t\t     \"bitmap\\n\", slot->ds_node_num);\n\t\t\tset_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_UP_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\tlist_add_tail(&slot->ds_live_item,\n\t\t\t      &o2hb_live_slots[slot->ds_node_num]);\n\n\t\tslot->ds_equal_samples = 0;\n\n\t\t/* We want to be sure that all nodes agree on the\n\t\t * number of milliseconds before a node will be\n\t\t * considered dead. The self-fencing timeout is\n\t\t * computed from this value, and a discrepancy might\n\t\t * result in heartbeat calling a node dead when it\n\t\t * hasn't self-fenced yet. */\n\t\tslot_dead_ms = le32_to_cpu(hb_block->hb_dead_ms);\n\t\tif (slot_dead_ms && slot_dead_ms != dead_ms) {\n\t\t\t/* TODO: Perhaps we can fail the region here. */\n\t\t\tmlog(ML_ERROR, \"Node %d on device %s has a dead count \"\n\t\t\t     \"of %u ms, but our count is %u ms.\\n\"\n\t\t\t     \"Please double check your configuration values \"\n\t\t\t     \"for 'O2CB_HEARTBEAT_THRESHOLD'\\n\",\n\t\t\t     slot->ds_node_num, reg->hr_dev_name, slot_dead_ms,\n\t\t\t     dead_ms);\n\t\t}\n\t\tgoto out;\n\t}\n\n\t/* if the list is dead, we're done.. */\n\tif (list_empty(&slot->ds_live_item))\n\t\tgoto out;\n\n\t/* live nodes only go dead after enough consequtive missed\n\t * samples..  reset the missed counter whenever we see\n\t * activity */\n\tif (slot->ds_equal_samples >= o2hb_dead_threshold || gen_changed) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d left my region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tclear_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* last off the live_slot generates a callback */\n\t\tlist_del_init(&slot->ds_live_item);\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Remove node %d from live \"\n\t\t\t     \"nodes bitmap\\n\", slot->ds_node_num);\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\t/* node can be null */\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB,\n\t\t\t\t\t      node, slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\t/* We don't clear this because the node is still\n\t\t * actually writing new blocks. */\n\t\tif (!gen_changed)\n\t\t\tslot->ds_changed_samples = 0;\n\t\tgoto out;\n\t}\n\tif (slot->ds_changed_samples) {\n\t\tslot->ds_changed_samples = 0;\n\t\tslot->ds_equal_samples = 0;\n\t}\nout:\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\tif (node)\n\t\to2nm_node_put(node);\n\treturn changed;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "configured_nodes",
            "O2NM_MAX_NODES",
            "i + 1"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_issue_node_write",
          "args": [
            "reg",
            "&write_wc"
          ],
          "line": 1005
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_issue_node_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "476-500",
          "snippet": "static int o2hb_issue_node_write(struct o2hb_region *reg,\n\t\t\t\t struct o2hb_bio_wait_ctxt *write_wc)\n{\n\tint status;\n\tunsigned int slot;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(write_wc);\n\n\tslot = o2nm_this_node();\n\n\tbio = o2hb_setup_one_bio(reg, write_wc, &slot, slot+1);\n\tif (IS_ERR(bio)) {\n\t\tstatus = PTR_ERR(bio);\n\t\tmlog_errno(status);\n\t\tgoto bail;\n\t}\n\n\tatomic_inc(&write_wc->wc_num_reqs);\n\tsubmit_bio(WRITE_SYNC, bio);\n\n\tstatus = 0;\nbail:\n\treturn status;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_issue_node_write(struct o2hb_region *reg,\n\t\t\t\t struct o2hb_bio_wait_ctxt *write_wc)\n{\n\tint status;\n\tunsigned int slot;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(write_wc);\n\n\tslot = o2nm_this_node();\n\n\tbio = o2hb_setup_one_bio(reg, write_wc, &slot, slot+1);\n\tif (IS_ERR(bio)) {\n\t\tstatus = PTR_ERR(bio);\n\t\tmlog_errno(status);\n\t\tgoto bail;\n\t}\n\n\tatomic_inc(&write_wc->wc_num_reqs);\n\tsubmit_bio(WRITE_SYNC, bio);\n\n\tstatus = 0;\nbail:\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_prepare_block",
          "args": [
            "reg",
            "reg->hr_generation"
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_prepare_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "587-617",
          "snippet": "static inline void o2hb_prepare_block(struct o2hb_region *reg,\n\t\t\t\t      u64 generation)\n{\n\tint node_num;\n\tu64 cputime;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tnode_num = o2nm_this_node();\n\tslot = &reg->hr_slots[node_num];\n\n\thb_block = (struct o2hb_disk_heartbeat_block *)slot->ds_raw_block;\n\tmemset(hb_block, 0, reg->hr_block_bytes);\n\t/* TODO: time stuff */\n\tcputime = CURRENT_TIME.tv_sec;\n\tif (!cputime)\n\t\tcputime = 1;\n\n\thb_block->hb_seq = cpu_to_le64(cputime);\n\thb_block->hb_node = node_num;\n\thb_block->hb_generation = cpu_to_le64(generation);\n\thb_block->hb_dead_ms = cpu_to_le32(o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS);\n\n\t/* This step must always happen last! */\n\thb_block->hb_cksum = cpu_to_le32(o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block));\n\n\tmlog(ML_HB_BIO, \"our node generation = 0x%llx, cksum = 0x%x\\n\",\n\t     (long long)generation,\n\t     le32_to_cpu(hb_block->hb_cksum));\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic inline void o2hb_prepare_block(struct o2hb_region *reg,\n\t\t\t\t      u64 generation)\n{\n\tint node_num;\n\tu64 cputime;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tnode_num = o2nm_this_node();\n\tslot = &reg->hr_slots[node_num];\n\n\thb_block = (struct o2hb_disk_heartbeat_block *)slot->ds_raw_block;\n\tmemset(hb_block, 0, reg->hr_block_bytes);\n\t/* TODO: time stuff */\n\tcputime = CURRENT_TIME.tv_sec;\n\tif (!cputime)\n\t\tcputime = 1;\n\n\thb_block->hb_seq = cpu_to_le64(cputime);\n\thb_block->hb_node = node_num;\n\thb_block->hb_generation = cpu_to_le64(generation);\n\thb_block->hb_dead_ms = cpu_to_le32(o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS);\n\n\t/* This step must always happen last! */\n\thb_block->hb_cksum = cpu_to_le32(o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block));\n\n\tmlog(ML_HB_BIO, \"our node generation = 0x%llx, cksum = 0x%x\\n\",\n\t     (long long)generation,\n\t     le32_to_cpu(hb_block->hb_cksum));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_check_own_slot",
          "args": [
            "reg"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_check_own_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "548-585",
          "snippet": "static int o2hb_check_own_slot(struct o2hb_region *reg)\n{\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\tchar *errstr;\n\n\tslot = &reg->hr_slots[o2nm_this_node()];\n\t/* Don't check on our 1st timestamp */\n\tif (!slot->ds_last_time)\n\t\treturn 0;\n\n\thb_block = slot->ds_raw_block;\n\tif (le64_to_cpu(hb_block->hb_seq) == slot->ds_last_time &&\n\t    le64_to_cpu(hb_block->hb_generation) == slot->ds_last_generation &&\n\t    hb_block->hb_node == slot->ds_node_num)\n\t\treturn 1;\n\n#define ERRSTR1\t\t\"Another node is heartbeating on device\"\n#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"\n#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"\n\n\tif (hb_block->hb_node != slot->ds_node_num)\n\t\terrstr = ERRSTR1;\n\telse if (le64_to_cpu(hb_block->hb_generation) !=\n\t\t slot->ds_last_generation)\n\t\terrstr = ERRSTR2;\n\telse\n\t\terrstr = ERRSTR3;\n\n\tmlog(ML_ERROR, \"%s (%s): expected(%u:0x%llx, 0x%llx), \"\n\t     \"ondisk(%u:0x%llx, 0x%llx)\\n\", errstr, reg->hr_dev_name,\n\t     slot->ds_node_num, (unsigned long long)slot->ds_last_generation,\n\t     (unsigned long long)slot->ds_last_time, hb_block->hb_node,\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_generation),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq));\n\n\treturn 0;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"",
            "#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"",
            "#define ERRSTR1\t\t\"Another node is heartbeating on device\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"\n#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"\n#define ERRSTR1\t\t\"Another node is heartbeating on device\"\n\nstatic int o2hb_check_own_slot(struct o2hb_region *reg)\n{\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\tchar *errstr;\n\n\tslot = &reg->hr_slots[o2nm_this_node()];\n\t/* Don't check on our 1st timestamp */\n\tif (!slot->ds_last_time)\n\t\treturn 0;\n\n\thb_block = slot->ds_raw_block;\n\tif (le64_to_cpu(hb_block->hb_seq) == slot->ds_last_time &&\n\t    le64_to_cpu(hb_block->hb_generation) == slot->ds_last_generation &&\n\t    hb_block->hb_node == slot->ds_node_num)\n\t\treturn 1;\n\n#define ERRSTR1\t\t\"Another node is heartbeating on device\"\n#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"\n#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"\n\n\tif (hb_block->hb_node != slot->ds_node_num)\n\t\terrstr = ERRSTR1;\n\telse if (le64_to_cpu(hb_block->hb_generation) !=\n\t\t slot->ds_last_generation)\n\t\terrstr = ERRSTR2;\n\telse\n\t\terrstr = ERRSTR3;\n\n\tmlog(ML_ERROR, \"%s (%s): expected(%u:0x%llx, 0x%llx), \"\n\t     \"ondisk(%u:0x%llx, 0x%llx)\\n\", errstr, reg->hr_dev_name,\n\t     slot->ds_node_num, (unsigned long long)slot->ds_last_generation,\n\t     (unsigned long long)slot->ds_last_time, hb_block->hb_node,\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_generation),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq));\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_read_slots",
          "args": [
            "reg",
            "highest_node + 1"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_read_slots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "444-474",
          "snippet": "static int o2hb_read_slots(struct o2hb_region *reg,\n\t\t\t   unsigned int max_slots)\n{\n\tunsigned int current_slot=0;\n\tint status;\n\tstruct o2hb_bio_wait_ctxt wc;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(&wc);\n\n\twhile(current_slot < max_slots) {\n\t\tbio = o2hb_setup_one_bio(reg, &wc, &current_slot, max_slots);\n\t\tif (IS_ERR(bio)) {\n\t\t\tstatus = PTR_ERR(bio);\n\t\t\tmlog_errno(status);\n\t\t\tgoto bail_and_wait;\n\t\t}\n\n\t\tatomic_inc(&wc.wc_num_reqs);\n\t\tsubmit_bio(READ, bio);\n\t}\n\n\tstatus = 0;\n\nbail_and_wait:\n\to2hb_wait_on_io(reg, &wc);\n\tif (wc.wc_error && !status)\n\t\tstatus = wc.wc_error;\n\n\treturn status;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_read_slots(struct o2hb_region *reg,\n\t\t\t   unsigned int max_slots)\n{\n\tunsigned int current_slot=0;\n\tint status;\n\tstruct o2hb_bio_wait_ctxt wc;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(&wc);\n\n\twhile(current_slot < max_slots) {\n\t\tbio = o2hb_setup_one_bio(reg, &wc, &current_slot, max_slots);\n\t\tif (IS_ERR(bio)) {\n\t\t\tstatus = PTR_ERR(bio);\n\t\t\tmlog_errno(status);\n\t\t\tgoto bail_and_wait;\n\t\t}\n\n\t\tatomic_inc(&wc.wc_num_reqs);\n\t\tsubmit_bio(READ, bio);\n\t}\n\n\tstatus = 0;\n\nbail_and_wait:\n\to2hb_wait_on_io(reg, &wc);\n\tif (wc.wc_error && !status)\n\t\tstatus = wc.wc_error;\n\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_NOTICE",
            "\"o2hb: No configured nodes found!\\n\""
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "36-48",
          "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_highest_node",
          "args": [
            "configured_nodes",
            "O2NM_MAX_NODES"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_highest_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "949-952",
          "snippet": "static int o2hb_highest_node(unsigned long *nodes, int numbits)\n{\n\treturn find_last_bit(nodes, numbits);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_highest_node(unsigned long *nodes, int numbits)\n{\n\treturn find_last_bit(nodes, numbits);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "i",
            "configured_nodes"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "84-88",
          "snippet": "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_fill_node_map",
          "args": [
            "live_node_bitmap",
            "sizeof(live_node_bitmap)"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_fill_node_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "1417-1426",
          "snippet": "void o2hb_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\t/* callers want to serialize this map and callbacks so that they\n\t * can trust that they don't miss nodes coming to the party */\n\tdown_read(&o2hb_callback_sem);\n\tspin_lock(&o2hb_live_lock);\n\to2hb_fill_node_map_from_callback(map, bytes);\n\tspin_unlock(&o2hb_live_lock);\n\tup_read(&o2hb_callback_sem);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_RWSEM(o2hb_callback_sem);",
            "static DEFINE_SPINLOCK(o2hb_live_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\n\nvoid o2hb_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\t/* callers want to serialize this map and callbacks so that they\n\t * can trust that they don't miss nodes coming to the party */\n\tdown_read(&o2hb_callback_sem);\n\tspin_lock(&o2hb_live_lock);\n\to2hb_fill_node_map_from_callback(map, bytes);\n\tspin_unlock(&o2hb_live_lock);\n\tup_read(&o2hb_callback_sem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "ret"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2nm_configured_node_map",
          "args": [
            "configured_nodes",
            "sizeof(configured_nodes)"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_configured_node_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "60-74",
          "snippet": "int o2nm_configured_node_map(unsigned long *map, unsigned bytes)\n{\n\tstruct o2nm_cluster *cluster = o2nm_single_cluster;\n\n\tBUG_ON(bytes < (sizeof(cluster->cl_nodes_bitmap)));\n\n\tif (cluster == NULL)\n\t\treturn -EINVAL;\n\n\tread_lock(&cluster->cl_nodes_lock);\n\tmemcpy(map, cluster->cl_nodes_bitmap, sizeof(cluster->cl_nodes_bitmap));\n\tread_unlock(&cluster->cl_nodes_lock);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nint o2nm_configured_node_map(unsigned long *map, unsigned bytes)\n{\n\tstruct o2nm_cluster *cluster = o2nm_single_cluster;\n\n\tBUG_ON(bytes < (sizeof(cluster->cl_nodes_bitmap)));\n\n\tif (cluster == NULL)\n\t\treturn -EINVAL;\n\n\tread_lock(&cluster->cl_nodes_lock);\n\tmemcpy(map, cluster->cl_nodes_bitmap, sizeof(cluster->cl_nodes_bitmap));\n\tread_unlock(&cluster->cl_nodes_lock);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(o2hb_steady_queue);\n\nstatic int o2hb_do_disk_heartbeat(struct o2hb_region *reg)\n{\n\tint i, ret, highest_node;\n\tint membership_change = 0, own_slot_ok = 0;\n\tunsigned long configured_nodes[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tunsigned long live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tstruct o2hb_bio_wait_ctxt write_wc;\n\n\tret = o2nm_configured_node_map(configured_nodes,\n\t\t\t\t       sizeof(configured_nodes));\n\tif (ret) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/*\n\t * If a node is not configured but is in the livemap, we still need\n\t * to read the slot so as to be able to remove it from the livemap.\n\t */\n\to2hb_fill_node_map(live_node_bitmap, sizeof(live_node_bitmap));\n\ti = -1;\n\twhile ((i = find_next_bit(live_node_bitmap,\n\t\t\t\t  O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tset_bit(i, configured_nodes);\n\t}\n\n\thighest_node = o2hb_highest_node(configured_nodes, O2NM_MAX_NODES);\n\tif (highest_node >= O2NM_MAX_NODES) {\n\t\tmlog(ML_NOTICE, \"o2hb: No configured nodes found!\\n\");\n\t\tret = -EINVAL;\n\t\tgoto bail;\n\t}\n\n\t/* No sense in reading the slots of nodes that don't exist\n\t * yet. Of course, if the node definitions have holes in them\n\t * then we're reading an empty slot anyway... Consider this\n\t * best-effort. */\n\tret = o2hb_read_slots(reg, highest_node + 1);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\t/* With an up to date view of the slots, we can check that no\n\t * other node has been improperly configured to heartbeat in\n\t * our slot. */\n\town_slot_ok = o2hb_check_own_slot(reg);\n\n\t/* fill in the proper info for our next heartbeat */\n\to2hb_prepare_block(reg, reg->hr_generation);\n\n\tret = o2hb_issue_node_write(reg, &write_wc);\n\tif (ret < 0) {\n\t\tmlog_errno(ret);\n\t\tgoto bail;\n\t}\n\n\ti = -1;\n\twhile((i = find_next_bit(configured_nodes,\n\t\t\t\t O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES) {\n\t\tmembership_change |= o2hb_check_slot(reg, &reg->hr_slots[i]);\n\t}\n\n\t/*\n\t * We have to be sure we've advertised ourselves on disk\n\t * before we can go to steady state.  This ensures that\n\t * people we find in our steady state have seen us.\n\t */\n\to2hb_wait_on_io(reg, &write_wc);\n\tif (write_wc.wc_error) {\n\t\t/* Do not re-arm the write timeout on I/O error - we\n\t\t * can't be sure that the new block ever made it to\n\t\t * disk */\n\t\tmlog(ML_ERROR, \"Write error %d on device \\\"%s\\\"\\n\",\n\t\t     write_wc.wc_error, reg->hr_dev_name);\n\t\tret = write_wc.wc_error;\n\t\tgoto bail;\n\t}\n\n\t/* Skip disarming the timeout if own slot has stale/bad data */\n\tif (own_slot_ok) {\n\t\to2hb_set_quorum_device(reg);\n\t\to2hb_arm_write_timeout(reg);\n\t}\n\nbail:\n\t/* let the person who launched us know when things are steady */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (!ret && own_slot_ok && !membership_change) {\n\t\t\tif (atomic_dec_and_test(&reg->hr_steady_iterations))\n\t\t\t\twake_up(&o2hb_steady_queue);\n\t\t}\n\t}\n\n\tif (atomic_read(&reg->hr_steady_iterations) != 0) {\n\t\tif (atomic_dec_and_test(&reg->hr_unsteady_iterations)) {\n\t\t\tprintk(KERN_NOTICE \"o2hb: Unable to stabilize \"\n\t\t\t       \"heartbeart on region %s (%s)\\n\",\n\t\t\t       config_item_name(&reg->hr_item),\n\t\t\t       reg->hr_dev_name);\n\t\t\tatomic_set(&reg->hr_steady_iterations, 0);\n\t\t\treg->hr_aborted_start = 1;\n\t\t\twake_up(&o2hb_steady_queue);\n\t\t\tret = -EIO;\n\t\t}\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_highest_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "949-952",
    "snippet": "static int o2hb_highest_node(unsigned long *nodes, int numbits)\n{\n\treturn find_last_bit(nodes, numbits);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_last_bit",
          "args": [
            "nodes",
            "numbits"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_highest_node(unsigned long *nodes, int numbits)\n{\n\treturn find_last_bit(nodes, numbits);\n}"
  },
  {
    "function_name": "o2hb_check_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "767-947",
    "snippet": "static int o2hb_check_slot(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_slot *slot)\n{\n\tint changed = 0, gen_changed = 0;\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tstruct o2hb_disk_heartbeat_block *hb_block = reg->hr_tmp_block;\n\tu64 cputime;\n\tunsigned int dead_ms = o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS;\n\tunsigned int slot_dead_ms;\n\tint tmp;\n\tint queued = 0;\n\n\tmemcpy(hb_block, slot->ds_raw_block, reg->hr_block_bytes);\n\n\t/*\n\t * If a node is no longer configured but is still in the livemap, we\n\t * may need to clear that bit from the livemap.\n\t */\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\ttmp = test_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tif (!tmp)\n\t\t\treturn 0;\n\t}\n\n\tif (!o2hb_verify_crc(reg, hb_block)) {\n\t\t/* all paths from here will drop o2hb_live_lock for\n\t\t * us. */\n\t\tspin_lock(&o2hb_live_lock);\n\n\t\t/* Don't print an error on the console in this case -\n\t\t * a freshly formatted heartbeat area will not have a\n\t\t * crc set on it. */\n\t\tif (list_empty(&slot->ds_live_item))\n\t\t\tgoto out;\n\n\t\t/* The node is live but pushed out a bad crc. We\n\t\t * consider it a transient miss but don't populate any\n\t\t * other values as they may be junk. */\n\t\tmlog(ML_ERROR, \"Node %d has written a bad crc to %s\\n\",\n\t\t     slot->ds_node_num, reg->hr_dev_name);\n\t\to2hb_dump_slot(hb_block);\n\n\t\tslot->ds_equal_samples++;\n\t\tgoto fire_callbacks;\n\t}\n\n\t/* we don't care if these wrap.. the state transitions below\n\t * clear at the right places */\n\tcputime = le64_to_cpu(hb_block->hb_seq);\n\tif (slot->ds_last_time != cputime)\n\t\tslot->ds_changed_samples++;\n\telse\n\t\tslot->ds_equal_samples++;\n\tslot->ds_last_time = cputime;\n\n\t/* The node changed heartbeat generations. We assume this to\n\t * mean it dropped off but came back before we timed out. We\n\t * want to consider it down for the time being but don't want\n\t * to lose any changed_samples state we might build up to\n\t * considering it live again. */\n\tif (slot->ds_last_generation != le64_to_cpu(hb_block->hb_generation)) {\n\t\tgen_changed = 1;\n\t\tslot->ds_equal_samples = 0;\n\t\tmlog(ML_HEARTBEAT, \"Node %d changed generation (0x%llx \"\n\t\t     \"to 0x%llx)\\n\", slot->ds_node_num,\n\t\t     (long long)slot->ds_last_generation,\n\t\t     (long long)le64_to_cpu(hb_block->hb_generation));\n\t}\n\n\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\n\tmlog(ML_HEARTBEAT, \"Slot %d gen 0x%llx cksum 0x%x \"\n\t     \"seq %llu last %llu changed %u equal %u\\n\",\n\t     slot->ds_node_num, (long long)slot->ds_last_generation,\n\t     le32_to_cpu(hb_block->hb_cksum),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq),\n\t     (unsigned long long)slot->ds_last_time, slot->ds_changed_samples,\n\t     slot->ds_equal_samples);\n\n\tspin_lock(&o2hb_live_lock);\n\nfire_callbacks:\n\t/* dead nodes only come to life after some number of\n\t * changes at any time during their dead time */\n\tif (list_empty(&slot->ds_live_item) &&\n\t    slot->ds_changed_samples >= O2HB_LIVE_THRESHOLD) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d (id 0x%llx) joined my region\\n\",\n\t\t     slot->ds_node_num, (long long)slot->ds_last_generation);\n\n\t\tset_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* first on the list generates a callback */\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Add node %d to live nodes \"\n\t\t\t     \"bitmap\\n\", slot->ds_node_num);\n\t\t\tset_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_UP_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\tlist_add_tail(&slot->ds_live_item,\n\t\t\t      &o2hb_live_slots[slot->ds_node_num]);\n\n\t\tslot->ds_equal_samples = 0;\n\n\t\t/* We want to be sure that all nodes agree on the\n\t\t * number of milliseconds before a node will be\n\t\t * considered dead. The self-fencing timeout is\n\t\t * computed from this value, and a discrepancy might\n\t\t * result in heartbeat calling a node dead when it\n\t\t * hasn't self-fenced yet. */\n\t\tslot_dead_ms = le32_to_cpu(hb_block->hb_dead_ms);\n\t\tif (slot_dead_ms && slot_dead_ms != dead_ms) {\n\t\t\t/* TODO: Perhaps we can fail the region here. */\n\t\t\tmlog(ML_ERROR, \"Node %d on device %s has a dead count \"\n\t\t\t     \"of %u ms, but our count is %u ms.\\n\"\n\t\t\t     \"Please double check your configuration values \"\n\t\t\t     \"for 'O2CB_HEARTBEAT_THRESHOLD'\\n\",\n\t\t\t     slot->ds_node_num, reg->hr_dev_name, slot_dead_ms,\n\t\t\t     dead_ms);\n\t\t}\n\t\tgoto out;\n\t}\n\n\t/* if the list is dead, we're done.. */\n\tif (list_empty(&slot->ds_live_item))\n\t\tgoto out;\n\n\t/* live nodes only go dead after enough consequtive missed\n\t * samples..  reset the missed counter whenever we see\n\t * activity */\n\tif (slot->ds_equal_samples >= o2hb_dead_threshold || gen_changed) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d left my region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tclear_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* last off the live_slot generates a callback */\n\t\tlist_del_init(&slot->ds_live_item);\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Remove node %d from live \"\n\t\t\t     \"nodes bitmap\\n\", slot->ds_node_num);\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\t/* node can be null */\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB,\n\t\t\t\t\t      node, slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\t/* We don't clear this because the node is still\n\t\t * actually writing new blocks. */\n\t\tif (!gen_changed)\n\t\t\tslot->ds_changed_samples = 0;\n\t\tgoto out;\n\t}\n\tif (slot->ds_changed_samples) {\n\t\tslot->ds_changed_samples = 0;\n\t\tslot->ds_equal_samples = 0;\n\t}\nout:\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\tif (node)\n\t\to2nm_node_put(node);\n\treturn changed;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static struct list_head o2hb_live_slots[O2NM_MAX_NODES];",
      "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
      "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2nm_node_put",
          "args": [
            "node"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_node_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "131-134",
          "snippet": "void o2nm_node_put(struct o2nm_node *node)\n{\n\tconfig_item_put(&node->nd_item);\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nvoid o2nm_node_put(struct o2nm_node *node)\n{\n\tconfig_item_put(&node->nd_item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_run_event_list",
          "args": [
            "&event"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_run_event_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "632-669",
          "snippet": "static void o2hb_run_event_list(struct o2hb_node_event *queued_event)\n{\n\tstruct o2hb_callback *hbcall;\n\tstruct o2hb_node_event *event;\n\n\t/* Holding callback sem assures we don't alter the callback\n\t * lists when doing this, and serializes ourselves with other\n\t * processes wanting callbacks. */\n\tdown_write(&o2hb_callback_sem);\n\n\tspin_lock(&o2hb_live_lock);\n\twhile (!list_empty(&o2hb_node_events)\n\t       && !list_empty(&queued_event->hn_item)) {\n\t\tevent = list_entry(o2hb_node_events.next,\n\t\t\t\t   struct o2hb_node_event,\n\t\t\t\t   hn_item);\n\t\tlist_del_init(&event->hn_item);\n\t\tspin_unlock(&o2hb_live_lock);\n\n\t\tmlog(ML_HEARTBEAT, \"Node %s event for %d\\n\",\n\t\t     event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\",\n\t\t     event->hn_node_num);\n\n\t\thbcall = hbcall_from_type(event->hn_event_type);\n\n\t\t/* We should *never* have gotten on to the list with a\n\t\t * bad type... This isn't something that we should try\n\t\t * to recover from. */\n\t\tBUG_ON(IS_ERR(hbcall));\n\n\t\to2hb_fire_callbacks(hbcall, event->hn_node, event->hn_node_num);\n\n\t\tspin_lock(&o2hb_live_lock);\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tup_write(&o2hb_callback_sem);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_RWSEM(o2hb_callback_sem);",
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_node_events);",
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_node_events);\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic void o2hb_run_event_list(struct o2hb_node_event *queued_event)\n{\n\tstruct o2hb_callback *hbcall;\n\tstruct o2hb_node_event *event;\n\n\t/* Holding callback sem assures we don't alter the callback\n\t * lists when doing this, and serializes ourselves with other\n\t * processes wanting callbacks. */\n\tdown_write(&o2hb_callback_sem);\n\n\tspin_lock(&o2hb_live_lock);\n\twhile (!list_empty(&o2hb_node_events)\n\t       && !list_empty(&queued_event->hn_item)) {\n\t\tevent = list_entry(o2hb_node_events.next,\n\t\t\t\t   struct o2hb_node_event,\n\t\t\t\t   hn_item);\n\t\tlist_del_init(&event->hn_item);\n\t\tspin_unlock(&o2hb_live_lock);\n\n\t\tmlog(ML_HEARTBEAT, \"Node %s event for %d\\n\",\n\t\t     event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\",\n\t\t     event->hn_node_num);\n\n\t\thbcall = hbcall_from_type(event->hn_event_type);\n\n\t\t/* We should *never* have gotten on to the list with a\n\t\t * bad type... This isn't something that we should try\n\t\t * to recover from. */\n\t\tBUG_ON(IS_ERR(hbcall));\n\n\t\to2hb_fire_callbacks(hbcall, event->hn_node, event->hn_node_num);\n\n\t\tspin_lock(&o2hb_live_lock);\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tup_write(&o2hb_callback_sem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_queue_node_event",
          "args": [
            "&event",
            "O2HB_NODE_DOWN_CB",
            "node",
            "slot->ds_node_num"
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_queue_node_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "671-688",
          "snippet": "static void o2hb_queue_node_event(struct o2hb_node_event *event,\n\t\t\t\t  enum o2hb_callback_type type,\n\t\t\t\t  struct o2nm_node *node,\n\t\t\t\t  int node_num)\n{\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tBUG_ON((!node) && (type != O2HB_NODE_DOWN_CB));\n\n\tevent->hn_event_type = type;\n\tevent->hn_node = node;\n\tevent->hn_node_num = node_num;\n\n\tmlog(ML_HEARTBEAT, \"Queue node %s event for node %d\\n\",\n\t     type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\", node_num);\n\n\tlist_add_tail(&event->hn_item, &o2hb_node_events);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_node_events);",
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_node_events);\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic void o2hb_queue_node_event(struct o2hb_node_event *event,\n\t\t\t\t  enum o2hb_callback_type type,\n\t\t\t\t  struct o2nm_node *node,\n\t\t\t\t  int node_num)\n{\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tBUG_ON((!node) && (type != O2HB_NODE_DOWN_CB));\n\n\tevent->hn_event_type = type;\n\tevent->hn_node = node;\n\tevent->hn_node_num = node_num;\n\n\tmlog(ML_HEARTBEAT, \"Queue node %s event for node %d\\n\",\n\t     type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\", node_num);\n\n\tlist_add_tail(&event->hn_item, &o2hb_node_events);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "slot->ds_node_num",
            "o2hb_live_node_bitmap"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "102-106",
          "snippet": "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"o2hb: Remove node %d from live \"\n\t\t\t     \"nodes bitmap\\n\"",
            "slot->ds_node_num"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&o2hb_live_slots[slot->ds_node_num]"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&slot->ds_live_item"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Node %d on device %s has a dead count \"\n\t\t\t     \"of %u ms, but our count is %u ms.\\n\"\n\t\t\t     \"Please double check your configuration values \"\n\t\t\t     \"for 'O2CB_HEARTBEAT_THRESHOLD'\\n\"",
            "slot->ds_node_num",
            "reg->hr_dev_name",
            "slot_dead_ms",
            "dead_ms"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "hb_block->hb_dead_ms"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&slot->ds_live_item",
            "&o2hb_live_slots[slot->ds_node_num]"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "slot->ds_node_num",
            "o2hb_live_node_bitmap"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "84-88",
          "snippet": "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Node %d (id 0x%llx) joined my region\\n\"",
            "slot->ds_node_num",
            "(long long)slot->ds_last_generation"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Slot %d gen 0x%llx cksum 0x%x \"\n\t     \"seq %llu last %llu changed %u equal %u\\n\"",
            "slot->ds_node_num",
            "(long long)slot->ds_last_generation",
            "le32_to_cpu(hb_block->hb_cksum)",
            "(unsigned long long)le64_to_cpu(hb_block->hb_seq)",
            "(unsigned long long)slot->ds_last_time",
            "slot->ds_changed_samples",
            "slot->ds_equal_samples"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "hb_block->hb_seq"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Node %d changed generation (0x%llx \"\n\t\t     \"to 0x%llx)\\n\"",
            "slot->ds_node_num",
            "(long long)slot->ds_last_generation",
            "(long long)le64_to_cpu(hb_block->hb_generation)"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_dump_slot",
          "args": [
            "hb_block"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_dump_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "521-528",
          "snippet": "static void o2hb_dump_slot(struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tmlog(ML_ERROR, \"Dump slot information: seq = 0x%llx, node = %u, \"\n\t     \"cksum = 0x%x, generation 0x%llx\\n\",\n\t     (long long)le64_to_cpu(hb_block->hb_seq),\n\t     hb_block->hb_node, le32_to_cpu(hb_block->hb_cksum),\n\t     (long long)le64_to_cpu(hb_block->hb_generation));\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_dump_slot(struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tmlog(ML_ERROR, \"Dump slot information: seq = 0x%llx, node = %u, \"\n\t     \"cksum = 0x%x, generation 0x%llx\\n\",\n\t     (long long)le64_to_cpu(hb_block->hb_seq),\n\t     hb_block->hb_node, le32_to_cpu(hb_block->hb_cksum),\n\t     (long long)le64_to_cpu(hb_block->hb_generation));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_verify_crc",
          "args": [
            "reg",
            "hb_block"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_verify_crc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "530-539",
          "snippet": "static int o2hb_verify_crc(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tu32 read, computed;\n\n\tread = le32_to_cpu(hb_block->hb_cksum);\n\tcomputed = o2hb_compute_block_crc_le(reg, hb_block);\n\n\treturn read == computed;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_verify_crc(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tu32 read, computed;\n\n\tread = le32_to_cpu(hb_block->hb_cksum);\n\tcomputed = o2hb_compute_block_crc_le(reg, hb_block);\n\n\treturn read == computed;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "slot->ds_node_num",
            "o2hb_live_node_bitmap"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_get_node_by_num",
          "args": [
            "slot->ds_node_num"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_get_node_by_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "43-57",
          "snippet": "struct o2nm_node *o2nm_get_node_by_num(u8 node_num)\n{\n\tstruct o2nm_node *node = NULL;\n\n\tif (node_num >= O2NM_MAX_NODES || o2nm_single_cluster == NULL)\n\t\tgoto out;\n\n\tread_lock(&o2nm_single_cluster->cl_nodes_lock);\n\tnode = o2nm_single_cluster->cl_nodes[node_num];\n\tif (node)\n\t\tconfig_item_get(&node->nd_item);\n\tread_unlock(&o2nm_single_cluster->cl_nodes_lock);\nout:\n\treturn node;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nstruct o2nm_node *o2nm_get_node_by_num(u8 node_num)\n{\n\tstruct o2nm_node *node = NULL;\n\n\tif (node_num >= O2NM_MAX_NODES || o2nm_single_cluster == NULL)\n\t\tgoto out;\n\n\tread_lock(&o2nm_single_cluster->cl_nodes_lock);\n\tnode = o2nm_single_cluster->cl_nodes[node_num];\n\tif (node)\n\t\tconfig_item_get(&node->nd_item);\n\tread_unlock(&o2nm_single_cluster->cl_nodes_lock);\nout:\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "hb_block",
            "slot->ds_raw_block",
            "reg->hr_block_bytes"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD_INIT",
          "args": [
            "event.hn_item"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic struct list_head o2hb_live_slots[O2NM_MAX_NODES];\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic int o2hb_check_slot(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_slot *slot)\n{\n\tint changed = 0, gen_changed = 0;\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tstruct o2hb_disk_heartbeat_block *hb_block = reg->hr_tmp_block;\n\tu64 cputime;\n\tunsigned int dead_ms = o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS;\n\tunsigned int slot_dead_ms;\n\tint tmp;\n\tint queued = 0;\n\n\tmemcpy(hb_block, slot->ds_raw_block, reg->hr_block_bytes);\n\n\t/*\n\t * If a node is no longer configured but is still in the livemap, we\n\t * may need to clear that bit from the livemap.\n\t */\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\ttmp = test_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t\tif (!tmp)\n\t\t\treturn 0;\n\t}\n\n\tif (!o2hb_verify_crc(reg, hb_block)) {\n\t\t/* all paths from here will drop o2hb_live_lock for\n\t\t * us. */\n\t\tspin_lock(&o2hb_live_lock);\n\n\t\t/* Don't print an error on the console in this case -\n\t\t * a freshly formatted heartbeat area will not have a\n\t\t * crc set on it. */\n\t\tif (list_empty(&slot->ds_live_item))\n\t\t\tgoto out;\n\n\t\t/* The node is live but pushed out a bad crc. We\n\t\t * consider it a transient miss but don't populate any\n\t\t * other values as they may be junk. */\n\t\tmlog(ML_ERROR, \"Node %d has written a bad crc to %s\\n\",\n\t\t     slot->ds_node_num, reg->hr_dev_name);\n\t\to2hb_dump_slot(hb_block);\n\n\t\tslot->ds_equal_samples++;\n\t\tgoto fire_callbacks;\n\t}\n\n\t/* we don't care if these wrap.. the state transitions below\n\t * clear at the right places */\n\tcputime = le64_to_cpu(hb_block->hb_seq);\n\tif (slot->ds_last_time != cputime)\n\t\tslot->ds_changed_samples++;\n\telse\n\t\tslot->ds_equal_samples++;\n\tslot->ds_last_time = cputime;\n\n\t/* The node changed heartbeat generations. We assume this to\n\t * mean it dropped off but came back before we timed out. We\n\t * want to consider it down for the time being but don't want\n\t * to lose any changed_samples state we might build up to\n\t * considering it live again. */\n\tif (slot->ds_last_generation != le64_to_cpu(hb_block->hb_generation)) {\n\t\tgen_changed = 1;\n\t\tslot->ds_equal_samples = 0;\n\t\tmlog(ML_HEARTBEAT, \"Node %d changed generation (0x%llx \"\n\t\t     \"to 0x%llx)\\n\", slot->ds_node_num,\n\t\t     (long long)slot->ds_last_generation,\n\t\t     (long long)le64_to_cpu(hb_block->hb_generation));\n\t}\n\n\tslot->ds_last_generation = le64_to_cpu(hb_block->hb_generation);\n\n\tmlog(ML_HEARTBEAT, \"Slot %d gen 0x%llx cksum 0x%x \"\n\t     \"seq %llu last %llu changed %u equal %u\\n\",\n\t     slot->ds_node_num, (long long)slot->ds_last_generation,\n\t     le32_to_cpu(hb_block->hb_cksum),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq),\n\t     (unsigned long long)slot->ds_last_time, slot->ds_changed_samples,\n\t     slot->ds_equal_samples);\n\n\tspin_lock(&o2hb_live_lock);\n\nfire_callbacks:\n\t/* dead nodes only come to life after some number of\n\t * changes at any time during their dead time */\n\tif (list_empty(&slot->ds_live_item) &&\n\t    slot->ds_changed_samples >= O2HB_LIVE_THRESHOLD) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d (id 0x%llx) joined my region\\n\",\n\t\t     slot->ds_node_num, (long long)slot->ds_last_generation);\n\n\t\tset_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* first on the list generates a callback */\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Add node %d to live nodes \"\n\t\t\t     \"bitmap\\n\", slot->ds_node_num);\n\t\t\tset_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_UP_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\tlist_add_tail(&slot->ds_live_item,\n\t\t\t      &o2hb_live_slots[slot->ds_node_num]);\n\n\t\tslot->ds_equal_samples = 0;\n\n\t\t/* We want to be sure that all nodes agree on the\n\t\t * number of milliseconds before a node will be\n\t\t * considered dead. The self-fencing timeout is\n\t\t * computed from this value, and a discrepancy might\n\t\t * result in heartbeat calling a node dead when it\n\t\t * hasn't self-fenced yet. */\n\t\tslot_dead_ms = le32_to_cpu(hb_block->hb_dead_ms);\n\t\tif (slot_dead_ms && slot_dead_ms != dead_ms) {\n\t\t\t/* TODO: Perhaps we can fail the region here. */\n\t\t\tmlog(ML_ERROR, \"Node %d on device %s has a dead count \"\n\t\t\t     \"of %u ms, but our count is %u ms.\\n\"\n\t\t\t     \"Please double check your configuration values \"\n\t\t\t     \"for 'O2CB_HEARTBEAT_THRESHOLD'\\n\",\n\t\t\t     slot->ds_node_num, reg->hr_dev_name, slot_dead_ms,\n\t\t\t     dead_ms);\n\t\t}\n\t\tgoto out;\n\t}\n\n\t/* if the list is dead, we're done.. */\n\tif (list_empty(&slot->ds_live_item))\n\t\tgoto out;\n\n\t/* live nodes only go dead after enough consequtive missed\n\t * samples..  reset the missed counter whenever we see\n\t * activity */\n\tif (slot->ds_equal_samples >= o2hb_dead_threshold || gen_changed) {\n\t\tmlog(ML_HEARTBEAT, \"Node %d left my region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tclear_bit(slot->ds_node_num, reg->hr_live_node_bitmap);\n\n\t\t/* last off the live_slot generates a callback */\n\t\tlist_del_init(&slot->ds_live_item);\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tmlog(ML_HEARTBEAT, \"o2hb: Remove node %d from live \"\n\t\t\t     \"nodes bitmap\\n\", slot->ds_node_num);\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\t/* node can be null */\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB,\n\t\t\t\t\t      node, slot->ds_node_num);\n\n\t\t\tchanged = 1;\n\t\t\tqueued = 1;\n\t\t}\n\n\t\t/* We don't clear this because the node is still\n\t\t * actually writing new blocks. */\n\t\tif (!gen_changed)\n\t\t\tslot->ds_changed_samples = 0;\n\t\tgoto out;\n\t}\n\tif (slot->ds_changed_samples) {\n\t\tslot->ds_changed_samples = 0;\n\t\tslot->ds_equal_samples = 0;\n\t}\nout:\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\tif (node)\n\t\to2nm_node_put(node);\n\treturn changed;\n}"
  },
  {
    "function_name": "o2hb_set_quorum_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "724-765",
    "snippet": "static void o2hb_set_quorum_device(struct o2hb_region *reg)\n{\n\tif (!o2hb_global_heartbeat_active())\n\t\treturn;\n\n\t/* Prevent race with o2hb_heartbeat_group_drop_item() */\n\tif (kthread_should_stop())\n\t\treturn;\n\n\t/* Tag region as quorum only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\n\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\tgoto unlock;\n\n\t/*\n\t * A region can be added to the quorum only when it sees all\n\t * live nodes heartbeat on it. In other words, the region has been\n\t * added to all nodes.\n\t */\n\tif (memcmp(reg->hr_live_node_bitmap, o2hb_live_node_bitmap,\n\t\t   sizeof(o2hb_live_node_bitmap)))\n\t\tgoto unlock;\n\n\tprintk(KERN_NOTICE \"o2hb: Region %s (%s) is now a quorum device\\n\",\n\t       config_item_name(&reg->hr_item), reg->hr_dev_name);\n\n\tset_bit(reg->hr_region_num, o2hb_quorum_region_bitmap);\n\n\t/*\n\t * If global heartbeat active, unpin all regions if the\n\t * region count > CUT_OFF\n\t */\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) > O2HB_PIN_CUT_OFF)\n\t\to2hb_region_unpin(NULL);\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define O2HB_PIN_CUT_OFF\t\t3"
    ],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];",
      "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_region_unpin",
          "args": [
            "NULL"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_region_unpin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2412-2439",
          "snippet": "static void o2hb_region_unpin(const char *region_uuid)\n{\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\tint found = 0;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned) {\n\t\t\tmlog(ML_CLUSTER, \"Unpin region %s\\n\", uuid);\n\t\t\to2nm_undepend_item(&reg->hr_item);\n\t\t\treg->hr_item_pinned = 0;\n\t\t}\n\t\tif (found)\n\t\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_all_regions);",
            "static int o2hb_region_pin(const char *region_uuid);",
            "static void o2hb_region_unpin(const char *region_uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nstatic int o2hb_region_pin(const char *region_uuid);\nstatic void o2hb_region_unpin(const char *region_uuid);\n\nstatic void o2hb_region_unpin(const char *region_uuid)\n{\n\tstruct o2hb_region *reg;\n\tchar *uuid;\n\tint found = 0;\n\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tlist_for_each_entry(reg, &o2hb_all_regions, hr_all_item) {\n\t\tif (reg->hr_item_dropped)\n\t\t\tcontinue;\n\n\t\tuuid = config_item_name(&reg->hr_item);\n\t\tif (region_uuid) {\n\t\t\tif (strcmp(region_uuid, uuid))\n\t\t\t\tcontinue;\n\t\t\tfound = 1;\n\t\t}\n\n\t\tif (reg->hr_item_pinned) {\n\t\t\tmlog(ML_CLUSTER, \"Unpin region %s\\n\", uuid);\n\t\t\to2nm_undepend_item(&reg->hr_item);\n\t\t\treg->hr_item_pinned = 0;\n\t\t}\n\t\tif (found)\n\t\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_weight",
          "args": [
            "o2hb_quorum_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_quorum_region_bitmap"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "84-88",
          "snippet": "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"o2hb: Region %s (%s) is now a quorum device\\n\"",
            "config_item_name(&reg->hr_item)",
            "reg->hr_dev_name"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "&reg->hr_item"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "reg->hr_live_node_bitmap",
            "o2hb_live_node_bitmap",
            "sizeof(o2hb_live_node_bitmap)"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_quorum_region_bitmap"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_should_stop",
          "args": [],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define O2HB_PIN_CUT_OFF\t\t3\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\n\nstatic void o2hb_set_quorum_device(struct o2hb_region *reg)\n{\n\tif (!o2hb_global_heartbeat_active())\n\t\treturn;\n\n\t/* Prevent race with o2hb_heartbeat_group_drop_item() */\n\tif (kthread_should_stop())\n\t\treturn;\n\n\t/* Tag region as quorum only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\n\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\tgoto unlock;\n\n\t/*\n\t * A region can be added to the quorum only when it sees all\n\t * live nodes heartbeat on it. In other words, the region has been\n\t * added to all nodes.\n\t */\n\tif (memcmp(reg->hr_live_node_bitmap, o2hb_live_node_bitmap,\n\t\t   sizeof(o2hb_live_node_bitmap)))\n\t\tgoto unlock;\n\n\tprintk(KERN_NOTICE \"o2hb: Region %s (%s) is now a quorum device\\n\",\n\t       config_item_name(&reg->hr_item), reg->hr_dev_name);\n\n\tset_bit(reg->hr_region_num, o2hb_quorum_region_bitmap);\n\n\t/*\n\t * If global heartbeat active, unpin all regions if the\n\t * region count > CUT_OFF\n\t */\n\tif (bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t   O2NM_MAX_REGIONS) > O2HB_PIN_CUT_OFF)\n\t\to2hb_region_unpin(NULL);\nunlock:\n\tspin_unlock(&o2hb_live_lock);\n}"
  },
  {
    "function_name": "o2hb_shutdown_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "690-722",
    "snippet": "static void o2hb_shutdown_slot(struct o2hb_disk_slot *slot)\n{\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tint queued = 0;\n\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\tif (!list_empty(&slot->ds_live_item)) {\n\t\tmlog(ML_HEARTBEAT, \"Shutdown, node %d leaves region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tlist_del_init(&slot->ds_live_item);\n\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\t\t\tqueued = 1;\n\t\t}\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\to2nm_node_put(node);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static struct list_head o2hb_live_slots[O2NM_MAX_NODES];",
      "static unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2nm_node_put",
          "args": [
            "node"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_node_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "131-134",
          "snippet": "void o2nm_node_put(struct o2nm_node *node)\n{\n\tconfig_item_put(&node->nd_item);\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nvoid o2nm_node_put(struct o2nm_node *node)\n{\n\tconfig_item_put(&node->nd_item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_run_event_list",
          "args": [
            "&event"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_run_event_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "632-669",
          "snippet": "static void o2hb_run_event_list(struct o2hb_node_event *queued_event)\n{\n\tstruct o2hb_callback *hbcall;\n\tstruct o2hb_node_event *event;\n\n\t/* Holding callback sem assures we don't alter the callback\n\t * lists when doing this, and serializes ourselves with other\n\t * processes wanting callbacks. */\n\tdown_write(&o2hb_callback_sem);\n\n\tspin_lock(&o2hb_live_lock);\n\twhile (!list_empty(&o2hb_node_events)\n\t       && !list_empty(&queued_event->hn_item)) {\n\t\tevent = list_entry(o2hb_node_events.next,\n\t\t\t\t   struct o2hb_node_event,\n\t\t\t\t   hn_item);\n\t\tlist_del_init(&event->hn_item);\n\t\tspin_unlock(&o2hb_live_lock);\n\n\t\tmlog(ML_HEARTBEAT, \"Node %s event for %d\\n\",\n\t\t     event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\",\n\t\t     event->hn_node_num);\n\n\t\thbcall = hbcall_from_type(event->hn_event_type);\n\n\t\t/* We should *never* have gotten on to the list with a\n\t\t * bad type... This isn't something that we should try\n\t\t * to recover from. */\n\t\tBUG_ON(IS_ERR(hbcall));\n\n\t\to2hb_fire_callbacks(hbcall, event->hn_node, event->hn_node_num);\n\n\t\tspin_lock(&o2hb_live_lock);\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tup_write(&o2hb_callback_sem);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_RWSEM(o2hb_callback_sem);",
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_node_events);",
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_node_events);\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic void o2hb_run_event_list(struct o2hb_node_event *queued_event)\n{\n\tstruct o2hb_callback *hbcall;\n\tstruct o2hb_node_event *event;\n\n\t/* Holding callback sem assures we don't alter the callback\n\t * lists when doing this, and serializes ourselves with other\n\t * processes wanting callbacks. */\n\tdown_write(&o2hb_callback_sem);\n\n\tspin_lock(&o2hb_live_lock);\n\twhile (!list_empty(&o2hb_node_events)\n\t       && !list_empty(&queued_event->hn_item)) {\n\t\tevent = list_entry(o2hb_node_events.next,\n\t\t\t\t   struct o2hb_node_event,\n\t\t\t\t   hn_item);\n\t\tlist_del_init(&event->hn_item);\n\t\tspin_unlock(&o2hb_live_lock);\n\n\t\tmlog(ML_HEARTBEAT, \"Node %s event for %d\\n\",\n\t\t     event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\",\n\t\t     event->hn_node_num);\n\n\t\thbcall = hbcall_from_type(event->hn_event_type);\n\n\t\t/* We should *never* have gotten on to the list with a\n\t\t * bad type... This isn't something that we should try\n\t\t * to recover from. */\n\t\tBUG_ON(IS_ERR(hbcall));\n\n\t\to2hb_fire_callbacks(hbcall, event->hn_node, event->hn_node_num);\n\n\t\tspin_lock(&o2hb_live_lock);\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tup_write(&o2hb_callback_sem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_queue_node_event",
          "args": [
            "&event",
            "O2HB_NODE_DOWN_CB",
            "node",
            "slot->ds_node_num"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_queue_node_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "671-688",
          "snippet": "static void o2hb_queue_node_event(struct o2hb_node_event *event,\n\t\t\t\t  enum o2hb_callback_type type,\n\t\t\t\t  struct o2nm_node *node,\n\t\t\t\t  int node_num)\n{\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tBUG_ON((!node) && (type != O2HB_NODE_DOWN_CB));\n\n\tevent->hn_event_type = type;\n\tevent->hn_node = node;\n\tevent->hn_node_num = node_num;\n\n\tmlog(ML_HEARTBEAT, \"Queue node %s event for node %d\\n\",\n\t     type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\", node_num);\n\n\tlist_add_tail(&event->hn_item, &o2hb_node_events);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(o2hb_live_lock);",
            "static LIST_HEAD(o2hb_node_events);",
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_node_events);\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic void o2hb_queue_node_event(struct o2hb_node_event *event,\n\t\t\t\t  enum o2hb_callback_type type,\n\t\t\t\t  struct o2nm_node *node,\n\t\t\t\t  int node_num)\n{\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tBUG_ON((!node) && (type != O2HB_NODE_DOWN_CB));\n\n\tevent->hn_event_type = type;\n\tevent->hn_node = node;\n\tevent->hn_node_num = node_num;\n\n\tmlog(ML_HEARTBEAT, \"Queue node %s event for node %d\\n\",\n\t     type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\", node_num);\n\n\tlist_add_tail(&event->hn_item, &o2hb_node_events);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "slot->ds_node_num",
            "o2hb_live_node_bitmap"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "102-106",
          "snippet": "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&o2hb_live_slots[slot->ds_node_num]"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&slot->ds_live_item"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Shutdown, node %d leaves region\\n\"",
            "slot->ds_node_num"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_get_node_by_num",
          "args": [
            "slot->ds_node_num"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_get_node_by_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "43-57",
          "snippet": "struct o2nm_node *o2nm_get_node_by_num(u8 node_num)\n{\n\tstruct o2nm_node *node = NULL;\n\n\tif (node_num >= O2NM_MAX_NODES || o2nm_single_cluster == NULL)\n\t\tgoto out;\n\n\tread_lock(&o2nm_single_cluster->cl_nodes_lock);\n\tnode = o2nm_single_cluster->cl_nodes[node_num];\n\tif (node)\n\t\tconfig_item_get(&node->nd_item);\n\tread_unlock(&o2nm_single_cluster->cl_nodes_lock);\nout:\n\treturn node;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nstruct o2nm_node *o2nm_get_node_by_num(u8 node_num)\n{\n\tstruct o2nm_node *node = NULL;\n\n\tif (node_num >= O2NM_MAX_NODES || o2nm_single_cluster == NULL)\n\t\tgoto out;\n\n\tread_lock(&o2nm_single_cluster->cl_nodes_lock);\n\tnode = o2nm_single_cluster->cl_nodes[node_num];\n\tif (node)\n\t\tconfig_item_get(&node->nd_item);\n\tread_unlock(&o2nm_single_cluster->cl_nodes_lock);\nout:\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD_INIT",
          "args": [
            "event.hn_item"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic struct list_head o2hb_live_slots[O2NM_MAX_NODES];\nstatic unsigned long o2hb_live_node_bitmap[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\nstatic void o2hb_shutdown_slot(struct o2hb_disk_slot *slot)\n{\n\tstruct o2hb_node_event event =\n\t\t{ .hn_item = LIST_HEAD_INIT(event.hn_item), };\n\tstruct o2nm_node *node;\n\tint queued = 0;\n\n\tnode = o2nm_get_node_by_num(slot->ds_node_num);\n\tif (!node)\n\t\treturn;\n\n\tspin_lock(&o2hb_live_lock);\n\tif (!list_empty(&slot->ds_live_item)) {\n\t\tmlog(ML_HEARTBEAT, \"Shutdown, node %d leaves region\\n\",\n\t\t     slot->ds_node_num);\n\n\t\tlist_del_init(&slot->ds_live_item);\n\n\t\tif (list_empty(&o2hb_live_slots[slot->ds_node_num])) {\n\t\t\tclear_bit(slot->ds_node_num, o2hb_live_node_bitmap);\n\n\t\t\to2hb_queue_node_event(&event, O2HB_NODE_DOWN_CB, node,\n\t\t\t\t\t      slot->ds_node_num);\n\t\t\tqueued = 1;\n\t\t}\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tif (queued)\n\t\to2hb_run_event_list(&event);\n\n\to2nm_node_put(node);\n}"
  },
  {
    "function_name": "o2hb_queue_node_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "671-688",
    "snippet": "static void o2hb_queue_node_event(struct o2hb_node_event *event,\n\t\t\t\t  enum o2hb_callback_type type,\n\t\t\t\t  struct o2nm_node *node,\n\t\t\t\t  int node_num)\n{\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tBUG_ON((!node) && (type != O2HB_NODE_DOWN_CB));\n\n\tevent->hn_event_type = type;\n\tevent->hn_node = node;\n\tevent->hn_node_num = node_num;\n\n\tmlog(ML_HEARTBEAT, \"Queue node %s event for node %d\\n\",\n\t     type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\", node_num);\n\n\tlist_add_tail(&event->hn_item, &o2hb_node_events);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_node_events);",
      "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&event->hn_item",
            "&o2hb_node_events"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Queue node %s event for node %d\\n\"",
            "type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\"",
            "node_num"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(!node) && (type != O2HB_NODE_DOWN_CB)"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_node_events);\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic void o2hb_queue_node_event(struct o2hb_node_event *event,\n\t\t\t\t  enum o2hb_callback_type type,\n\t\t\t\t  struct o2nm_node *node,\n\t\t\t\t  int node_num)\n{\n\tassert_spin_locked(&o2hb_live_lock);\n\n\tBUG_ON((!node) && (type != O2HB_NODE_DOWN_CB));\n\n\tevent->hn_event_type = type;\n\tevent->hn_node = node;\n\tevent->hn_node_num = node_num;\n\n\tmlog(ML_HEARTBEAT, \"Queue node %s event for node %d\\n\",\n\t     type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\", node_num);\n\n\tlist_add_tail(&event->hn_item, &o2hb_node_events);\n}"
  },
  {
    "function_name": "o2hb_run_event_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "632-669",
    "snippet": "static void o2hb_run_event_list(struct o2hb_node_event *queued_event)\n{\n\tstruct o2hb_callback *hbcall;\n\tstruct o2hb_node_event *event;\n\n\t/* Holding callback sem assures we don't alter the callback\n\t * lists when doing this, and serializes ourselves with other\n\t * processes wanting callbacks. */\n\tdown_write(&o2hb_callback_sem);\n\n\tspin_lock(&o2hb_live_lock);\n\twhile (!list_empty(&o2hb_node_events)\n\t       && !list_empty(&queued_event->hn_item)) {\n\t\tevent = list_entry(o2hb_node_events.next,\n\t\t\t\t   struct o2hb_node_event,\n\t\t\t\t   hn_item);\n\t\tlist_del_init(&event->hn_item);\n\t\tspin_unlock(&o2hb_live_lock);\n\n\t\tmlog(ML_HEARTBEAT, \"Node %s event for %d\\n\",\n\t\t     event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\",\n\t\t     event->hn_node_num);\n\n\t\thbcall = hbcall_from_type(event->hn_event_type);\n\n\t\t/* We should *never* have gotten on to the list with a\n\t\t * bad type... This isn't something that we should try\n\t\t * to recover from. */\n\t\tBUG_ON(IS_ERR(hbcall));\n\n\t\to2hb_fire_callbacks(hbcall, event->hn_node, event->hn_node_num);\n\n\t\tspin_lock(&o2hb_live_lock);\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tup_write(&o2hb_callback_sem);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_RWSEM(o2hb_callback_sem);",
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_node_events);",
      "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_write",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_fire_callbacks",
          "args": [
            "hbcall",
            "event->hn_node",
            "event->hn_node_num"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_fire_callbacks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "619-629",
          "snippet": "static void o2hb_fire_callbacks(struct o2hb_callback *hbcall,\n\t\t\t\tstruct o2nm_node *node,\n\t\t\t\tint idx)\n{\n\tstruct o2hb_callback_func *f;\n\n\tlist_for_each_entry(f, &hbcall->list, hc_item) {\n\t\tmlog(ML_HEARTBEAT, \"calling funcs %p\\n\", f);\n\t\t(f->hc_func)(node, idx, f->hc_data);\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_fire_callbacks(struct o2hb_callback *hbcall,\n\t\t\t\tstruct o2nm_node *node,\n\t\t\t\tint idx)\n{\n\tstruct o2hb_callback_func *f;\n\n\tlist_for_each_entry(f, &hbcall->list, hc_item) {\n\t\tmlog(ML_HEARTBEAT, \"calling funcs %p\\n\", f);\n\t\t(f->hc_func)(node, idx, f->hc_data);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "IS_ERR(hbcall)"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "hbcall"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hbcall_from_type",
          "args": [
            "event->hn_event_type"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "hbcall_from_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2329-2335",
          "snippet": "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type)\n{\n\tif (type == O2HB_NUM_CB)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn &o2hb_callbacks[type];\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];",
            "static struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct o2hb_callback {\n\tstruct list_head list;\n} o2hb_callbacks[O2HB_NUM_CB];\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type)\n{\n\tif (type == O2HB_NUM_CB)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn &o2hb_callbacks[type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Node %s event for %d\\n\"",
            "event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\"",
            "event->hn_node_num"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&event->hn_item"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "o2hb_node_events.next",
            "structo2hb_node_event",
            "hn_item"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&queued_event->hn_item"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_write",
          "args": [
            "&o2hb_callback_sem"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_RWSEM(o2hb_callback_sem);\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_node_events);\nstatic struct o2hb_callback *hbcall_from_type(enum o2hb_callback_type type);\n\nstatic void o2hb_run_event_list(struct o2hb_node_event *queued_event)\n{\n\tstruct o2hb_callback *hbcall;\n\tstruct o2hb_node_event *event;\n\n\t/* Holding callback sem assures we don't alter the callback\n\t * lists when doing this, and serializes ourselves with other\n\t * processes wanting callbacks. */\n\tdown_write(&o2hb_callback_sem);\n\n\tspin_lock(&o2hb_live_lock);\n\twhile (!list_empty(&o2hb_node_events)\n\t       && !list_empty(&queued_event->hn_item)) {\n\t\tevent = list_entry(o2hb_node_events.next,\n\t\t\t\t   struct o2hb_node_event,\n\t\t\t\t   hn_item);\n\t\tlist_del_init(&event->hn_item);\n\t\tspin_unlock(&o2hb_live_lock);\n\n\t\tmlog(ML_HEARTBEAT, \"Node %s event for %d\\n\",\n\t\t     event->hn_event_type == O2HB_NODE_UP_CB ? \"UP\" : \"DOWN\",\n\t\t     event->hn_node_num);\n\n\t\thbcall = hbcall_from_type(event->hn_event_type);\n\n\t\t/* We should *never* have gotten on to the list with a\n\t\t * bad type... This isn't something that we should try\n\t\t * to recover from. */\n\t\tBUG_ON(IS_ERR(hbcall));\n\n\t\to2hb_fire_callbacks(hbcall, event->hn_node, event->hn_node_num);\n\n\t\tspin_lock(&o2hb_live_lock);\n\t}\n\tspin_unlock(&o2hb_live_lock);\n\n\tup_write(&o2hb_callback_sem);\n}"
  },
  {
    "function_name": "o2hb_fire_callbacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "619-629",
    "snippet": "static void o2hb_fire_callbacks(struct o2hb_callback *hbcall,\n\t\t\t\tstruct o2nm_node *node,\n\t\t\t\tint idx)\n{\n\tstruct o2hb_callback_func *f;\n\n\tlist_for_each_entry(f, &hbcall->list, hc_item) {\n\t\tmlog(ML_HEARTBEAT, \"calling funcs %p\\n\", f);\n\t\t(f->hc_func)(node, idx, f->hc_data);\n\t}\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "node",
            "idx",
            "f->hc_data"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"calling funcs %p\\n\"",
            "f"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "f",
            "&hbcall->list",
            "hc_item"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_fire_callbacks(struct o2hb_callback *hbcall,\n\t\t\t\tstruct o2nm_node *node,\n\t\t\t\tint idx)\n{\n\tstruct o2hb_callback_func *f;\n\n\tlist_for_each_entry(f, &hbcall->list, hc_item) {\n\t\tmlog(ML_HEARTBEAT, \"calling funcs %p\\n\", f);\n\t\t(f->hc_func)(node, idx, f->hc_data);\n\t}\n}"
  },
  {
    "function_name": "o2hb_prepare_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "587-617",
    "snippet": "static inline void o2hb_prepare_block(struct o2hb_region *reg,\n\t\t\t\t      u64 generation)\n{\n\tint node_num;\n\tu64 cputime;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tnode_num = o2nm_this_node();\n\tslot = &reg->hr_slots[node_num];\n\n\thb_block = (struct o2hb_disk_heartbeat_block *)slot->ds_raw_block;\n\tmemset(hb_block, 0, reg->hr_block_bytes);\n\t/* TODO: time stuff */\n\tcputime = CURRENT_TIME.tv_sec;\n\tif (!cputime)\n\t\tcputime = 1;\n\n\thb_block->hb_seq = cpu_to_le64(cputime);\n\thb_block->hb_node = node_num;\n\thb_block->hb_generation = cpu_to_le64(generation);\n\thb_block->hb_dead_ms = cpu_to_le32(o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS);\n\n\t/* This step must always happen last! */\n\thb_block->hb_cksum = cpu_to_le32(o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block));\n\n\tmlog(ML_HB_BIO, \"our node generation = 0x%llx, cksum = 0x%x\\n\",\n\t     (long long)generation,\n\t     le32_to_cpu(hb_block->hb_cksum));\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HB_BIO",
            "\"our node generation = 0x%llx, cksum = 0x%x\\n\"",
            "(long long)generation",
            "le32_to_cpu(hb_block->hb_cksum)"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "hb_block->hb_cksum"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block)"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_compute_block_crc_le",
          "args": [
            "reg",
            "hb_block"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_compute_block_crc_le",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "502-519",
          "snippet": "static u32 o2hb_compute_block_crc_le(struct o2hb_region *reg,\n\t\t\t\t     struct o2hb_disk_heartbeat_block *hb_block)\n{\n\t__le32 old_cksum;\n\tu32 ret;\n\n\t/* We want to compute the block crc with a 0 value in the\n\t * hb_cksum field. Save it off here and replace after the\n\t * crc. */\n\told_cksum = hb_block->hb_cksum;\n\thb_block->hb_cksum = 0;\n\n\tret = crc32_le(0, (unsigned char *) hb_block, reg->hr_block_bytes);\n\n\thb_block->hb_cksum = old_cksum;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic u32 o2hb_compute_block_crc_le(struct o2hb_region *reg,\n\t\t\t\t     struct o2hb_disk_heartbeat_block *hb_block)\n{\n\t__le32 old_cksum;\n\tu32 ret;\n\n\t/* We want to compute the block crc with a 0 value in the\n\t * hb_cksum field. Save it off here and replace after the\n\t * crc. */\n\told_cksum = hb_block->hb_cksum;\n\thb_block->hb_cksum = 0;\n\n\tret = crc32_le(0, (unsigned char *) hb_block, reg->hr_block_bytes);\n\n\thb_block->hb_cksum = old_cksum;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "generation"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "cputime"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "hb_block",
            "0",
            "reg->hr_block_bytes"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2nm_this_node",
          "args": [],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "143-151",
          "snippet": "u8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nu8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic inline void o2hb_prepare_block(struct o2hb_region *reg,\n\t\t\t\t      u64 generation)\n{\n\tint node_num;\n\tu64 cputime;\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\n\tnode_num = o2nm_this_node();\n\tslot = &reg->hr_slots[node_num];\n\n\thb_block = (struct o2hb_disk_heartbeat_block *)slot->ds_raw_block;\n\tmemset(hb_block, 0, reg->hr_block_bytes);\n\t/* TODO: time stuff */\n\tcputime = CURRENT_TIME.tv_sec;\n\tif (!cputime)\n\t\tcputime = 1;\n\n\thb_block->hb_seq = cpu_to_le64(cputime);\n\thb_block->hb_node = node_num;\n\thb_block->hb_generation = cpu_to_le64(generation);\n\thb_block->hb_dead_ms = cpu_to_le32(o2hb_dead_threshold * O2HB_REGION_TIMEOUT_MS);\n\n\t/* This step must always happen last! */\n\thb_block->hb_cksum = cpu_to_le32(o2hb_compute_block_crc_le(reg,\n\t\t\t\t\t\t\t\t   hb_block));\n\n\tmlog(ML_HB_BIO, \"our node generation = 0x%llx, cksum = 0x%x\\n\",\n\t     (long long)generation,\n\t     le32_to_cpu(hb_block->hb_cksum));\n}"
  },
  {
    "function_name": "o2hb_check_own_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "548-585",
    "snippet": "static int o2hb_check_own_slot(struct o2hb_region *reg)\n{\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\tchar *errstr;\n\n\tslot = &reg->hr_slots[o2nm_this_node()];\n\t/* Don't check on our 1st timestamp */\n\tif (!slot->ds_last_time)\n\t\treturn 0;\n\n\thb_block = slot->ds_raw_block;\n\tif (le64_to_cpu(hb_block->hb_seq) == slot->ds_last_time &&\n\t    le64_to_cpu(hb_block->hb_generation) == slot->ds_last_generation &&\n\t    hb_block->hb_node == slot->ds_node_num)\n\t\treturn 1;\n\n#define ERRSTR1\t\t\"Another node is heartbeating on device\"\n#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"\n#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"\n\n\tif (hb_block->hb_node != slot->ds_node_num)\n\t\terrstr = ERRSTR1;\n\telse if (le64_to_cpu(hb_block->hb_generation) !=\n\t\t slot->ds_last_generation)\n\t\terrstr = ERRSTR2;\n\telse\n\t\terrstr = ERRSTR3;\n\n\tmlog(ML_ERROR, \"%s (%s): expected(%u:0x%llx, 0x%llx), \"\n\t     \"ondisk(%u:0x%llx, 0x%llx)\\n\", errstr, reg->hr_dev_name,\n\t     slot->ds_node_num, (unsigned long long)slot->ds_last_generation,\n\t     (unsigned long long)slot->ds_last_time, hb_block->hb_node,\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_generation),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq));\n\n\treturn 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"",
      "#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"",
      "#define ERRSTR1\t\t\"Another node is heartbeating on device\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"%s (%s): expected(%u:0x%llx, 0x%llx), \"\n\t     \"ondisk(%u:0x%llx, 0x%llx)\\n\"",
            "errstr",
            "reg->hr_dev_name",
            "slot->ds_node_num",
            "(unsigned long long)slot->ds_last_generation",
            "(unsigned long long)slot->ds_last_time",
            "hb_block->hb_node",
            "(unsigned long long)le64_to_cpu(hb_block->hb_generation)",
            "(unsigned long long)le64_to_cpu(hb_block->hb_seq)"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "hb_block->hb_seq"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_this_node",
          "args": [],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "143-151",
          "snippet": "u8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nu8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"\n#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"\n#define ERRSTR1\t\t\"Another node is heartbeating on device\"\n\nstatic int o2hb_check_own_slot(struct o2hb_region *reg)\n{\n\tstruct o2hb_disk_slot *slot;\n\tstruct o2hb_disk_heartbeat_block *hb_block;\n\tchar *errstr;\n\n\tslot = &reg->hr_slots[o2nm_this_node()];\n\t/* Don't check on our 1st timestamp */\n\tif (!slot->ds_last_time)\n\t\treturn 0;\n\n\thb_block = slot->ds_raw_block;\n\tif (le64_to_cpu(hb_block->hb_seq) == slot->ds_last_time &&\n\t    le64_to_cpu(hb_block->hb_generation) == slot->ds_last_generation &&\n\t    hb_block->hb_node == slot->ds_node_num)\n\t\treturn 1;\n\n#define ERRSTR1\t\t\"Another node is heartbeating on device\"\n#define ERRSTR2\t\t\"Heartbeat generation mismatch on device\"\n#define ERRSTR3\t\t\"Heartbeat sequence mismatch on device\"\n\n\tif (hb_block->hb_node != slot->ds_node_num)\n\t\terrstr = ERRSTR1;\n\telse if (le64_to_cpu(hb_block->hb_generation) !=\n\t\t slot->ds_last_generation)\n\t\terrstr = ERRSTR2;\n\telse\n\t\terrstr = ERRSTR3;\n\n\tmlog(ML_ERROR, \"%s (%s): expected(%u:0x%llx, 0x%llx), \"\n\t     \"ondisk(%u:0x%llx, 0x%llx)\\n\", errstr, reg->hr_dev_name,\n\t     slot->ds_node_num, (unsigned long long)slot->ds_last_generation,\n\t     (unsigned long long)slot->ds_last_time, hb_block->hb_node,\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_generation),\n\t     (unsigned long long)le64_to_cpu(hb_block->hb_seq));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "o2hb_verify_crc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "530-539",
    "snippet": "static int o2hb_verify_crc(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tu32 read, computed;\n\n\tread = le32_to_cpu(hb_block->hb_cksum);\n\tcomputed = o2hb_compute_block_crc_le(reg, hb_block);\n\n\treturn read == computed;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_compute_block_crc_le",
          "args": [
            "reg",
            "hb_block"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_compute_block_crc_le",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "502-519",
          "snippet": "static u32 o2hb_compute_block_crc_le(struct o2hb_region *reg,\n\t\t\t\t     struct o2hb_disk_heartbeat_block *hb_block)\n{\n\t__le32 old_cksum;\n\tu32 ret;\n\n\t/* We want to compute the block crc with a 0 value in the\n\t * hb_cksum field. Save it off here and replace after the\n\t * crc. */\n\told_cksum = hb_block->hb_cksum;\n\thb_block->hb_cksum = 0;\n\n\tret = crc32_le(0, (unsigned char *) hb_block, reg->hr_block_bytes);\n\n\thb_block->hb_cksum = old_cksum;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic u32 o2hb_compute_block_crc_le(struct o2hb_region *reg,\n\t\t\t\t     struct o2hb_disk_heartbeat_block *hb_block)\n{\n\t__le32 old_cksum;\n\tu32 ret;\n\n\t/* We want to compute the block crc with a 0 value in the\n\t * hb_cksum field. Save it off here and replace after the\n\t * crc. */\n\told_cksum = hb_block->hb_cksum;\n\thb_block->hb_cksum = 0;\n\n\tret = crc32_le(0, (unsigned char *) hb_block, reg->hr_block_bytes);\n\n\thb_block->hb_cksum = old_cksum;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "hb_block->hb_cksum"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_verify_crc(struct o2hb_region *reg,\n\t\t\t   struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tu32 read, computed;\n\n\tread = le32_to_cpu(hb_block->hb_cksum);\n\tcomputed = o2hb_compute_block_crc_le(reg, hb_block);\n\n\treturn read == computed;\n}"
  },
  {
    "function_name": "o2hb_dump_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "521-528",
    "snippet": "static void o2hb_dump_slot(struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tmlog(ML_ERROR, \"Dump slot information: seq = 0x%llx, node = %u, \"\n\t     \"cksum = 0x%x, generation 0x%llx\\n\",\n\t     (long long)le64_to_cpu(hb_block->hb_seq),\n\t     hb_block->hb_node, le32_to_cpu(hb_block->hb_cksum),\n\t     (long long)le64_to_cpu(hb_block->hb_generation));\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Dump slot information: seq = 0x%llx, node = %u, \"\n\t     \"cksum = 0x%x, generation 0x%llx\\n\"",
            "(long long)le64_to_cpu(hb_block->hb_seq)",
            "hb_block->hb_node",
            "le32_to_cpu(hb_block->hb_cksum)",
            "(long long)le64_to_cpu(hb_block->hb_generation)"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "hb_block->hb_generation"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "hb_block->hb_cksum"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_dump_slot(struct o2hb_disk_heartbeat_block *hb_block)\n{\n\tmlog(ML_ERROR, \"Dump slot information: seq = 0x%llx, node = %u, \"\n\t     \"cksum = 0x%x, generation 0x%llx\\n\",\n\t     (long long)le64_to_cpu(hb_block->hb_seq),\n\t     hb_block->hb_node, le32_to_cpu(hb_block->hb_cksum),\n\t     (long long)le64_to_cpu(hb_block->hb_generation));\n}"
  },
  {
    "function_name": "o2hb_compute_block_crc_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "502-519",
    "snippet": "static u32 o2hb_compute_block_crc_le(struct o2hb_region *reg,\n\t\t\t\t     struct o2hb_disk_heartbeat_block *hb_block)\n{\n\t__le32 old_cksum;\n\tu32 ret;\n\n\t/* We want to compute the block crc with a 0 value in the\n\t * hb_cksum field. Save it off here and replace after the\n\t * crc. */\n\told_cksum = hb_block->hb_cksum;\n\thb_block->hb_cksum = 0;\n\n\tret = crc32_le(0, (unsigned char *) hb_block, reg->hr_block_bytes);\n\n\thb_block->hb_cksum = old_cksum;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "0",
            "(unsigned char *) hb_block",
            "reg->hr_block_bytes"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic u32 o2hb_compute_block_crc_le(struct o2hb_region *reg,\n\t\t\t\t     struct o2hb_disk_heartbeat_block *hb_block)\n{\n\t__le32 old_cksum;\n\tu32 ret;\n\n\t/* We want to compute the block crc with a 0 value in the\n\t * hb_cksum field. Save it off here and replace after the\n\t * crc. */\n\told_cksum = hb_block->hb_cksum;\n\thb_block->hb_cksum = 0;\n\n\tret = crc32_le(0, (unsigned char *) hb_block, reg->hr_block_bytes);\n\n\thb_block->hb_cksum = old_cksum;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_issue_node_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "476-500",
    "snippet": "static int o2hb_issue_node_write(struct o2hb_region *reg,\n\t\t\t\t struct o2hb_bio_wait_ctxt *write_wc)\n{\n\tint status;\n\tunsigned int slot;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(write_wc);\n\n\tslot = o2nm_this_node();\n\n\tbio = o2hb_setup_one_bio(reg, write_wc, &slot, slot+1);\n\tif (IS_ERR(bio)) {\n\t\tstatus = PTR_ERR(bio);\n\t\tmlog_errno(status);\n\t\tgoto bail;\n\t}\n\n\tatomic_inc(&write_wc->wc_num_reqs);\n\tsubmit_bio(WRITE_SYNC, bio);\n\n\tstatus = 0;\nbail:\n\treturn status;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "submit_bio",
          "args": [
            "WRITE_SYNC",
            "bio"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "bl_submit_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/blocklayout/blocklayout.c",
          "lines": "104-115",
          "snippet": "static struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"blocklayout.h\"",
            "#include \"../internal.h\"",
            "#include \"../nfs4session.h\"",
            "#include \"../pnfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/bio.h>\t\t/* struct bio */",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blocklayout.h\"\n#include \"../internal.h\"\n#include \"../nfs4session.h\"\n#include \"../pnfs.h\"\n#include <linux/pagevec.h>\n#include <linux/prefetch.h>\n#include <linux/bio.h>\t\t/* struct bio */\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&write_wc->wc_num_reqs"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "status"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "bio"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "bio"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_setup_one_bio",
          "args": [
            "reg",
            "write_wc",
            "&slot",
            "slot+1"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_setup_one_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "391-442",
          "snippet": "static struct bio *o2hb_setup_one_bio(struct o2hb_region *reg,\n\t\t\t\t      struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t      unsigned int *current_slot,\n\t\t\t\t      unsigned int max_slots)\n{\n\tint len, current_page;\n\tunsigned int vec_len, vec_start;\n\tunsigned int bits = reg->hr_block_bits;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tunsigned int cs = *current_slot;\n\tstruct bio *bio;\n\tstruct page *page;\n\n\t/* Testing has shown this allocation to take long enough under\n\t * GFP_KERNEL that the local node can get fenced. It would be\n\t * nicest if we could pre-allocate these bios and avoid this\n\t * all together. */\n\tbio = bio_alloc(GFP_ATOMIC, 16);\n\tif (!bio) {\n\t\tmlog(ML_ERROR, \"Could not alloc slots BIO!\\n\");\n\t\tbio = ERR_PTR(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* Must put everything in 512 byte sectors for the bio... */\n\tbio->bi_iter.bi_sector = (reg->hr_start_block + cs) << (bits - 9);\n\tbio->bi_bdev = reg->hr_bdev;\n\tbio->bi_private = wc;\n\tbio->bi_end_io = o2hb_bio_end_io;\n\n\tvec_start = (cs << bits) % PAGE_CACHE_SIZE;\n\twhile(cs < max_slots) {\n\t\tcurrent_page = cs / spp;\n\t\tpage = reg->hr_slot_data[current_page];\n\n\t\tvec_len = min(PAGE_CACHE_SIZE - vec_start,\n\t\t\t      (max_slots-cs) * (PAGE_CACHE_SIZE/spp) );\n\n\t\tmlog(ML_HB_BIO, \"page %d, vec_len = %u, vec_start = %u\\n\",\n\t\t     current_page, vec_len, vec_start);\n\n\t\tlen = bio_add_page(bio, page, vec_len, vec_start);\n\t\tif (len != vec_len) break;\n\n\t\tcs += vec_len / (PAGE_CACHE_SIZE/spp);\n\t\tvec_start = 0;\n\t}\n\nbail:\n\t*current_slot = cs;\n\treturn bio;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct bio *o2hb_setup_one_bio(struct o2hb_region *reg,\n\t\t\t\t      struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t      unsigned int *current_slot,\n\t\t\t\t      unsigned int max_slots)\n{\n\tint len, current_page;\n\tunsigned int vec_len, vec_start;\n\tunsigned int bits = reg->hr_block_bits;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tunsigned int cs = *current_slot;\n\tstruct bio *bio;\n\tstruct page *page;\n\n\t/* Testing has shown this allocation to take long enough under\n\t * GFP_KERNEL that the local node can get fenced. It would be\n\t * nicest if we could pre-allocate these bios and avoid this\n\t * all together. */\n\tbio = bio_alloc(GFP_ATOMIC, 16);\n\tif (!bio) {\n\t\tmlog(ML_ERROR, \"Could not alloc slots BIO!\\n\");\n\t\tbio = ERR_PTR(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* Must put everything in 512 byte sectors for the bio... */\n\tbio->bi_iter.bi_sector = (reg->hr_start_block + cs) << (bits - 9);\n\tbio->bi_bdev = reg->hr_bdev;\n\tbio->bi_private = wc;\n\tbio->bi_end_io = o2hb_bio_end_io;\n\n\tvec_start = (cs << bits) % PAGE_CACHE_SIZE;\n\twhile(cs < max_slots) {\n\t\tcurrent_page = cs / spp;\n\t\tpage = reg->hr_slot_data[current_page];\n\n\t\tvec_len = min(PAGE_CACHE_SIZE - vec_start,\n\t\t\t      (max_slots-cs) * (PAGE_CACHE_SIZE/spp) );\n\n\t\tmlog(ML_HB_BIO, \"page %d, vec_len = %u, vec_start = %u\\n\",\n\t\t     current_page, vec_len, vec_start);\n\n\t\tlen = bio_add_page(bio, page, vec_len, vec_start);\n\t\tif (len != vec_len) break;\n\n\t\tcs += vec_len / (PAGE_CACHE_SIZE/spp);\n\t\tvec_start = 0;\n\t}\n\nbail:\n\t*current_slot = cs;\n\treturn bio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2nm_this_node",
          "args": [],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "o2nm_this_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/nodemanager.c",
          "lines": "143-151",
          "snippet": "u8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}",
          "includes": [
            "#include \"sys.h\"",
            "#include \"masklog.h\"",
            "#include \"heartbeat.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct o2nm_cluster *o2nm_single_cluster = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sys.h\"\n#include \"masklog.h\"\n#include \"heartbeat.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n\nstruct o2nm_cluster *o2nm_single_cluster = NULL;\n\nu8 o2nm_this_node(void)\n{\n\tu8 node_num = O2NM_MAX_NODES;\n\n\tif (o2nm_single_cluster && o2nm_single_cluster->cl_has_local)\n\t\tnode_num = o2nm_single_cluster->cl_local_node;\n\n\treturn node_num;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_bio_wait_init",
          "args": [
            "write_wc"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_bio_wait_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "347-352",
          "snippet": "static inline void o2hb_bio_wait_init(struct o2hb_bio_wait_ctxt *wc)\n{\n\tatomic_set(&wc->wc_num_reqs, 1);\n\tinit_completion(&wc->wc_io_complete);\n\twc->wc_error = 0;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic inline void o2hb_bio_wait_init(struct o2hb_bio_wait_ctxt *wc)\n{\n\tatomic_set(&wc->wc_num_reqs, 1);\n\tinit_completion(&wc->wc_io_complete);\n\twc->wc_error = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_issue_node_write(struct o2hb_region *reg,\n\t\t\t\t struct o2hb_bio_wait_ctxt *write_wc)\n{\n\tint status;\n\tunsigned int slot;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(write_wc);\n\n\tslot = o2nm_this_node();\n\n\tbio = o2hb_setup_one_bio(reg, write_wc, &slot, slot+1);\n\tif (IS_ERR(bio)) {\n\t\tstatus = PTR_ERR(bio);\n\t\tmlog_errno(status);\n\t\tgoto bail;\n\t}\n\n\tatomic_inc(&write_wc->wc_num_reqs);\n\tsubmit_bio(WRITE_SYNC, bio);\n\n\tstatus = 0;\nbail:\n\treturn status;\n}"
  },
  {
    "function_name": "o2hb_read_slots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "444-474",
    "snippet": "static int o2hb_read_slots(struct o2hb_region *reg,\n\t\t\t   unsigned int max_slots)\n{\n\tunsigned int current_slot=0;\n\tint status;\n\tstruct o2hb_bio_wait_ctxt wc;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(&wc);\n\n\twhile(current_slot < max_slots) {\n\t\tbio = o2hb_setup_one_bio(reg, &wc, &current_slot, max_slots);\n\t\tif (IS_ERR(bio)) {\n\t\t\tstatus = PTR_ERR(bio);\n\t\t\tmlog_errno(status);\n\t\t\tgoto bail_and_wait;\n\t\t}\n\n\t\tatomic_inc(&wc.wc_num_reqs);\n\t\tsubmit_bio(READ, bio);\n\t}\n\n\tstatus = 0;\n\nbail_and_wait:\n\to2hb_wait_on_io(reg, &wc);\n\tif (wc.wc_error && !status)\n\t\tstatus = wc.wc_error;\n\n\treturn status;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2hb_wait_on_io",
          "args": [
            "reg",
            "&wc"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_wait_on_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "368-373",
          "snippet": "static void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}"
        }
      },
      {
        "call_info": {
          "callee": "submit_bio",
          "args": [
            "READ",
            "bio"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "bl_submit_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/blocklayout/blocklayout.c",
          "lines": "104-115",
          "snippet": "static struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"blocklayout.h\"",
            "#include \"../internal.h\"",
            "#include \"../nfs4session.h\"",
            "#include \"../pnfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/bio.h>\t\t/* struct bio */",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blocklayout.h\"\n#include \"../internal.h\"\n#include \"../nfs4session.h\"\n#include \"../pnfs.h\"\n#include <linux/pagevec.h>\n#include <linux/prefetch.h>\n#include <linux/bio.h>\t\t/* struct bio */\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct bio *\nbl_submit_bio(int rw, struct bio *bio)\n{\n\tif (bio) {\n\t\tget_parallel(bio->bi_private);\n\t\tdprintk(\"%s submitting %s bio %u@%llu\\n\", __func__,\n\t\t\trw == READ ? \"read\" : \"write\", bio->bi_iter.bi_size,\n\t\t\t(unsigned long long)bio->bi_iter.bi_sector);\n\t\tsubmit_bio(rw, bio);\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&wc.wc_num_reqs"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "status"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "bio"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "bio"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_setup_one_bio",
          "args": [
            "reg",
            "&wc",
            "&current_slot",
            "max_slots"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_setup_one_bio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "391-442",
          "snippet": "static struct bio *o2hb_setup_one_bio(struct o2hb_region *reg,\n\t\t\t\t      struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t      unsigned int *current_slot,\n\t\t\t\t      unsigned int max_slots)\n{\n\tint len, current_page;\n\tunsigned int vec_len, vec_start;\n\tunsigned int bits = reg->hr_block_bits;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tunsigned int cs = *current_slot;\n\tstruct bio *bio;\n\tstruct page *page;\n\n\t/* Testing has shown this allocation to take long enough under\n\t * GFP_KERNEL that the local node can get fenced. It would be\n\t * nicest if we could pre-allocate these bios and avoid this\n\t * all together. */\n\tbio = bio_alloc(GFP_ATOMIC, 16);\n\tif (!bio) {\n\t\tmlog(ML_ERROR, \"Could not alloc slots BIO!\\n\");\n\t\tbio = ERR_PTR(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* Must put everything in 512 byte sectors for the bio... */\n\tbio->bi_iter.bi_sector = (reg->hr_start_block + cs) << (bits - 9);\n\tbio->bi_bdev = reg->hr_bdev;\n\tbio->bi_private = wc;\n\tbio->bi_end_io = o2hb_bio_end_io;\n\n\tvec_start = (cs << bits) % PAGE_CACHE_SIZE;\n\twhile(cs < max_slots) {\n\t\tcurrent_page = cs / spp;\n\t\tpage = reg->hr_slot_data[current_page];\n\n\t\tvec_len = min(PAGE_CACHE_SIZE - vec_start,\n\t\t\t      (max_slots-cs) * (PAGE_CACHE_SIZE/spp) );\n\n\t\tmlog(ML_HB_BIO, \"page %d, vec_len = %u, vec_start = %u\\n\",\n\t\t     current_page, vec_len, vec_start);\n\n\t\tlen = bio_add_page(bio, page, vec_len, vec_start);\n\t\tif (len != vec_len) break;\n\n\t\tcs += vec_len / (PAGE_CACHE_SIZE/spp);\n\t\tvec_start = 0;\n\t}\n\nbail:\n\t*current_slot = cs;\n\treturn bio;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct bio *o2hb_setup_one_bio(struct o2hb_region *reg,\n\t\t\t\t      struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t      unsigned int *current_slot,\n\t\t\t\t      unsigned int max_slots)\n{\n\tint len, current_page;\n\tunsigned int vec_len, vec_start;\n\tunsigned int bits = reg->hr_block_bits;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tunsigned int cs = *current_slot;\n\tstruct bio *bio;\n\tstruct page *page;\n\n\t/* Testing has shown this allocation to take long enough under\n\t * GFP_KERNEL that the local node can get fenced. It would be\n\t * nicest if we could pre-allocate these bios and avoid this\n\t * all together. */\n\tbio = bio_alloc(GFP_ATOMIC, 16);\n\tif (!bio) {\n\t\tmlog(ML_ERROR, \"Could not alloc slots BIO!\\n\");\n\t\tbio = ERR_PTR(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* Must put everything in 512 byte sectors for the bio... */\n\tbio->bi_iter.bi_sector = (reg->hr_start_block + cs) << (bits - 9);\n\tbio->bi_bdev = reg->hr_bdev;\n\tbio->bi_private = wc;\n\tbio->bi_end_io = o2hb_bio_end_io;\n\n\tvec_start = (cs << bits) % PAGE_CACHE_SIZE;\n\twhile(cs < max_slots) {\n\t\tcurrent_page = cs / spp;\n\t\tpage = reg->hr_slot_data[current_page];\n\n\t\tvec_len = min(PAGE_CACHE_SIZE - vec_start,\n\t\t\t      (max_slots-cs) * (PAGE_CACHE_SIZE/spp) );\n\n\t\tmlog(ML_HB_BIO, \"page %d, vec_len = %u, vec_start = %u\\n\",\n\t\t     current_page, vec_len, vec_start);\n\n\t\tlen = bio_add_page(bio, page, vec_len, vec_start);\n\t\tif (len != vec_len) break;\n\n\t\tcs += vec_len / (PAGE_CACHE_SIZE/spp);\n\t\tvec_start = 0;\n\t}\n\nbail:\n\t*current_slot = cs;\n\treturn bio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_bio_wait_init",
          "args": [
            "&wc"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_bio_wait_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "347-352",
          "snippet": "static inline void o2hb_bio_wait_init(struct o2hb_bio_wait_ctxt *wc)\n{\n\tatomic_set(&wc->wc_num_reqs, 1);\n\tinit_completion(&wc->wc_io_complete);\n\twc->wc_error = 0;\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic inline void o2hb_bio_wait_init(struct o2hb_bio_wait_ctxt *wc)\n{\n\tatomic_set(&wc->wc_num_reqs, 1);\n\tinit_completion(&wc->wc_io_complete);\n\twc->wc_error = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int o2hb_read_slots(struct o2hb_region *reg,\n\t\t\t   unsigned int max_slots)\n{\n\tunsigned int current_slot=0;\n\tint status;\n\tstruct o2hb_bio_wait_ctxt wc;\n\tstruct bio *bio;\n\n\to2hb_bio_wait_init(&wc);\n\n\twhile(current_slot < max_slots) {\n\t\tbio = o2hb_setup_one_bio(reg, &wc, &current_slot, max_slots);\n\t\tif (IS_ERR(bio)) {\n\t\t\tstatus = PTR_ERR(bio);\n\t\t\tmlog_errno(status);\n\t\t\tgoto bail_and_wait;\n\t\t}\n\n\t\tatomic_inc(&wc.wc_num_reqs);\n\t\tsubmit_bio(READ, bio);\n\t}\n\n\tstatus = 0;\n\nbail_and_wait:\n\to2hb_wait_on_io(reg, &wc);\n\tif (wc.wc_error && !status)\n\t\tstatus = wc.wc_error;\n\n\treturn status;\n}"
  },
  {
    "function_name": "o2hb_setup_one_bio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "391-442",
    "snippet": "static struct bio *o2hb_setup_one_bio(struct o2hb_region *reg,\n\t\t\t\t      struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t      unsigned int *current_slot,\n\t\t\t\t      unsigned int max_slots)\n{\n\tint len, current_page;\n\tunsigned int vec_len, vec_start;\n\tunsigned int bits = reg->hr_block_bits;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tunsigned int cs = *current_slot;\n\tstruct bio *bio;\n\tstruct page *page;\n\n\t/* Testing has shown this allocation to take long enough under\n\t * GFP_KERNEL that the local node can get fenced. It would be\n\t * nicest if we could pre-allocate these bios and avoid this\n\t * all together. */\n\tbio = bio_alloc(GFP_ATOMIC, 16);\n\tif (!bio) {\n\t\tmlog(ML_ERROR, \"Could not alloc slots BIO!\\n\");\n\t\tbio = ERR_PTR(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* Must put everything in 512 byte sectors for the bio... */\n\tbio->bi_iter.bi_sector = (reg->hr_start_block + cs) << (bits - 9);\n\tbio->bi_bdev = reg->hr_bdev;\n\tbio->bi_private = wc;\n\tbio->bi_end_io = o2hb_bio_end_io;\n\n\tvec_start = (cs << bits) % PAGE_CACHE_SIZE;\n\twhile(cs < max_slots) {\n\t\tcurrent_page = cs / spp;\n\t\tpage = reg->hr_slot_data[current_page];\n\n\t\tvec_len = min(PAGE_CACHE_SIZE - vec_start,\n\t\t\t      (max_slots-cs) * (PAGE_CACHE_SIZE/spp) );\n\n\t\tmlog(ML_HB_BIO, \"page %d, vec_len = %u, vec_start = %u\\n\",\n\t\t     current_page, vec_len, vec_start);\n\n\t\tlen = bio_add_page(bio, page, vec_len, vec_start);\n\t\tif (len != vec_len) break;\n\n\t\tcs += vec_len / (PAGE_CACHE_SIZE/spp);\n\t\tvec_start = 0;\n\t}\n\nbail:\n\t*current_slot = cs;\n\treturn bio;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bio_add_page",
          "args": [
            "bio",
            "page",
            "vec_len",
            "vec_start"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HB_BIO",
            "\"page %d, vec_len = %u, vec_start = %u\\n\"",
            "current_page",
            "vec_len",
            "vec_start"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "PAGE_CACHE_SIZE - vec_start",
            "(max_slots-cs) * (PAGE_CACHE_SIZE/spp)"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Could not alloc slots BIO!\\n\""
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_mask_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "36-48",
          "snippet": "static ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);",
            "struct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstruct mlog_bits mlog_and_bits = MLOG_BITS_RHS(MLOG_INITIAL_AND_MASK);\nstruct mlog_bits mlog_not_bits = MLOG_BITS_RHS(0);\n\nstatic ssize_t mlog_mask_show(u64 mask, char *buf)\n{\n\tchar *state;\n\n\tif (__mlog_test_u64(mask, mlog_and_bits))\n\t\tstate = \"allow\";\n\telse if (__mlog_test_u64(mask, mlog_not_bits))\n\t\tstate = \"deny\";\n\telse\n\t\tstate = \"off\";\n\n\treturn snprintf(buf, PAGE_SIZE, \"%s\\n\", state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bio_alloc",
          "args": [
            "GFP_ATOMIC",
            "16"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_io_bio_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/extent_io.c",
          "lines": "2733-2746",
          "snippet": "struct bio *btrfs_io_bio_alloc(gfp_t gfp_mask, unsigned int nr_iovecs)\n{\n\tstruct btrfs_io_bio *btrfs_bio;\n\tstruct bio *bio;\n\n\tbio = bio_alloc_bioset(gfp_mask, nr_iovecs, btrfs_bioset);\n\tif (bio) {\n\t\tbtrfs_bio = btrfs_io_bio(bio);\n\t\tbtrfs_bio->csum = NULL;\n\t\tbtrfs_bio->csum_allocated = NULL;\n\t\tbtrfs_bio->end_io = NULL;\n\t}\n\treturn bio;\n}",
          "includes": [
            "#include \"backref.h\"",
            "#include \"rcu-string.h\"",
            "#include \"locking.h\"",
            "#include \"check-integrity.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"ctree.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/cleancache.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/bio.h>",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct bio_set *btrfs_bioset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"backref.h\"\n#include \"rcu-string.h\"\n#include \"locking.h\"\n#include \"check-integrity.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"ctree.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/cleancache.h>\n#include <linux/prefetch.h>\n#include <linux/pagevec.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/page-flags.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/bio.h>\n#include <linux/slab.h>\n#include <linux/bitops.h>\n\nstatic struct bio_set *btrfs_bioset;\n\nstruct bio *btrfs_io_bio_alloc(gfp_t gfp_mask, unsigned int nr_iovecs)\n{\n\tstruct btrfs_io_bio *btrfs_bio;\n\tstruct bio *bio;\n\n\tbio = bio_alloc_bioset(gfp_mask, nr_iovecs, btrfs_bioset);\n\tif (bio) {\n\t\tbtrfs_bio = btrfs_io_bio(bio);\n\t\tbtrfs_bio->csum = NULL;\n\t\tbtrfs_bio->csum_allocated = NULL;\n\t\tbtrfs_bio->end_io = NULL;\n\t}\n\treturn bio;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic struct bio *o2hb_setup_one_bio(struct o2hb_region *reg,\n\t\t\t\t      struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t      unsigned int *current_slot,\n\t\t\t\t      unsigned int max_slots)\n{\n\tint len, current_page;\n\tunsigned int vec_len, vec_start;\n\tunsigned int bits = reg->hr_block_bits;\n\tunsigned int spp = reg->hr_slots_per_page;\n\tunsigned int cs = *current_slot;\n\tstruct bio *bio;\n\tstruct page *page;\n\n\t/* Testing has shown this allocation to take long enough under\n\t * GFP_KERNEL that the local node can get fenced. It would be\n\t * nicest if we could pre-allocate these bios and avoid this\n\t * all together. */\n\tbio = bio_alloc(GFP_ATOMIC, 16);\n\tif (!bio) {\n\t\tmlog(ML_ERROR, \"Could not alloc slots BIO!\\n\");\n\t\tbio = ERR_PTR(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* Must put everything in 512 byte sectors for the bio... */\n\tbio->bi_iter.bi_sector = (reg->hr_start_block + cs) << (bits - 9);\n\tbio->bi_bdev = reg->hr_bdev;\n\tbio->bi_private = wc;\n\tbio->bi_end_io = o2hb_bio_end_io;\n\n\tvec_start = (cs << bits) % PAGE_CACHE_SIZE;\n\twhile(cs < max_slots) {\n\t\tcurrent_page = cs / spp;\n\t\tpage = reg->hr_slot_data[current_page];\n\n\t\tvec_len = min(PAGE_CACHE_SIZE - vec_start,\n\t\t\t      (max_slots-cs) * (PAGE_CACHE_SIZE/spp) );\n\n\t\tmlog(ML_HB_BIO, \"page %d, vec_len = %u, vec_start = %u\\n\",\n\t\t     current_page, vec_len, vec_start);\n\n\t\tlen = bio_add_page(bio, page, vec_len, vec_start);\n\t\tif (len != vec_len) break;\n\n\t\tcs += vec_len / (PAGE_CACHE_SIZE/spp);\n\t\tvec_start = 0;\n\t}\n\nbail:\n\t*current_slot = cs;\n\treturn bio;\n}"
  },
  {
    "function_name": "o2hb_bio_end_io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "375-387",
    "snippet": "static void o2hb_bio_end_io(struct bio *bio,\n\t\t\t   int error)\n{\n\tstruct o2hb_bio_wait_ctxt *wc = bio->bi_private;\n\n\tif (error) {\n\t\tmlog(ML_ERROR, \"IO Error %d\\n\", error);\n\t\twc->wc_error = error;\n\t}\n\n\to2hb_bio_wait_dec(wc, 1);\n\tbio_put(bio);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bio_put",
          "args": [
            "bio"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_bio_wait_dec",
          "args": [
            "wc",
            "1"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_bio_wait_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "355-366",
          "snippet": "static inline void o2hb_bio_wait_dec(struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t     unsigned int num)\n{\n\t/* sadly atomic_sub_and_test() isn't available on all platforms.  The\n\t * good news is that the fast path only completes one at a time */\n\twhile(num--) {\n\t\tif (atomic_dec_and_test(&wc->wc_num_reqs)) {\n\t\t\tBUG_ON(num > 0);\n\t\t\tcomplete(&wc->wc_io_complete);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic inline void o2hb_bio_wait_dec(struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t     unsigned int num)\n{\n\t/* sadly atomic_sub_and_test() isn't available on all platforms.  The\n\t * good news is that the fast path only completes one at a time */\n\twhile(num--) {\n\t\tif (atomic_dec_and_test(&wc->wc_num_reqs)) {\n\t\t\tBUG_ON(num > 0);\n\t\t\tcomplete(&wc->wc_io_complete);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"IO Error %d\\n\"",
            "error"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_bio_end_io(struct bio *bio,\n\t\t\t   int error)\n{\n\tstruct o2hb_bio_wait_ctxt *wc = bio->bi_private;\n\n\tif (error) {\n\t\tmlog(ML_ERROR, \"IO Error %d\\n\", error);\n\t\twc->wc_error = error;\n\t}\n\n\to2hb_bio_wait_dec(wc, 1);\n\tbio_put(bio);\n}"
  },
  {
    "function_name": "o2hb_wait_on_io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "368-373",
    "snippet": "static void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&wc->wc_io_complete"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_for_completion_rpc_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1116-1122",
          "snippet": "static int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_bio_wait_dec",
          "args": [
            "wc",
            "1"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_bio_wait_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "355-366",
          "snippet": "static inline void o2hb_bio_wait_dec(struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t     unsigned int num)\n{\n\t/* sadly atomic_sub_and_test() isn't available on all platforms.  The\n\t * good news is that the fast path only completes one at a time */\n\twhile(num--) {\n\t\tif (atomic_dec_and_test(&wc->wc_num_reqs)) {\n\t\t\tBUG_ON(num > 0);\n\t\t\tcomplete(&wc->wc_io_complete);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic inline void o2hb_bio_wait_dec(struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t     unsigned int num)\n{\n\t/* sadly atomic_sub_and_test() isn't available on all platforms.  The\n\t * good news is that the fast path only completes one at a time */\n\twhile(num--) {\n\t\tif (atomic_dec_and_test(&wc->wc_num_reqs)) {\n\t\t\tBUG_ON(num > 0);\n\t\t\tcomplete(&wc->wc_io_complete);\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_wait_on_io(struct o2hb_region *reg,\n\t\t\t    struct o2hb_bio_wait_ctxt *wc)\n{\n\to2hb_bio_wait_dec(wc, 1);\n\twait_for_completion(&wc->wc_io_complete);\n}"
  },
  {
    "function_name": "o2hb_bio_wait_dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "355-366",
    "snippet": "static inline void o2hb_bio_wait_dec(struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t     unsigned int num)\n{\n\t/* sadly atomic_sub_and_test() isn't available on all platforms.  The\n\t * good news is that the fast path only completes one at a time */\n\twhile(num--) {\n\t\tif (atomic_dec_and_test(&wc->wc_num_reqs)) {\n\t\t\tBUG_ON(num > 0);\n\t\t\tcomplete(&wc->wc_io_complete);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&wc->wc_io_complete"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_connect_completed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "1507-1520",
          "snippet": "static void o2net_sc_connect_completed(struct work_struct *work)\n{\n\tstruct o2net_sock_container *sc =\n\t\tcontainer_of(work, struct o2net_sock_container,\n\t\t\t     sc_connect_work);\n\n\tmlog(ML_MSG, \"sc sending handshake with ver %llu id %llx\\n\",\n              (unsigned long long)O2NET_PROTOCOL_VERSION,\n\t      (unsigned long long)be64_to_cpu(o2net_hand->connector_id));\n\n\to2net_initialize_handshake();\n\to2net_sendpage(sc, o2net_hand, sizeof(*o2net_hand));\n\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct o2net_handshake *o2net_hand;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct o2net_handshake *o2net_hand;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_connect_completed(struct work_struct *work)\n{\n\tstruct o2net_sock_container *sc =\n\t\tcontainer_of(work, struct o2net_sock_container,\n\t\t\t     sc_connect_work);\n\n\tmlog(ML_MSG, \"sc sending handshake with ver %llu id %llx\\n\",\n              (unsigned long long)O2NET_PROTOCOL_VERSION,\n\t      (unsigned long long)be64_to_cpu(o2net_hand->connector_id));\n\n\to2net_initialize_handshake();\n\to2net_sendpage(sc, o2net_hand, sizeof(*o2net_hand));\n\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "num > 0"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&wc->wc_num_reqs"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic inline void o2hb_bio_wait_dec(struct o2hb_bio_wait_ctxt *wc,\n\t\t\t\t     unsigned int num)\n{\n\t/* sadly atomic_sub_and_test() isn't available on all platforms.  The\n\t * good news is that the fast path only completes one at a time */\n\twhile(num--) {\n\t\tif (atomic_dec_and_test(&wc->wc_num_reqs)) {\n\t\t\tBUG_ON(num > 0);\n\t\t\tcomplete(&wc->wc_io_complete);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "o2hb_bio_wait_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "347-352",
    "snippet": "static inline void o2hb_bio_wait_init(struct o2hb_bio_wait_ctxt *wc)\n{\n\tatomic_set(&wc->wc_num_reqs, 1);\n\tinit_completion(&wc->wc_io_complete);\n\twc->wc_error = 0;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&wc->wc_io_complete"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&wc->wc_num_reqs",
            "1"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic inline void o2hb_bio_wait_init(struct o2hb_bio_wait_ctxt *wc)\n{\n\tatomic_set(&wc->wc_num_reqs, 1);\n\tinit_completion(&wc->wc_io_complete);\n\twc->wc_error = 0;\n}"
  },
  {
    "function_name": "o2hb_disarm_write_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "342-345",
    "snippet": "static void o2hb_disarm_write_timeout(struct o2hb_region *reg)\n{\n\tcancel_delayed_work_sync(&reg->hr_write_timeout_work);\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&reg->hr_write_timeout_work"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic void o2hb_disarm_write_timeout(struct o2hb_region *reg)\n{\n\tcancel_delayed_work_sync(&reg->hr_write_timeout_work);\n}"
  },
  {
    "function_name": "o2hb_arm_write_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "322-340",
    "snippet": "static void o2hb_arm_write_timeout(struct o2hb_region *reg)\n{\n\t/* Arm writeout only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tmlog(ML_HEARTBEAT, \"Queue write timeout for %u ms\\n\",\n\t     O2HB_MAX_WRITE_TIMEOUT_MS);\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tclear_bit(reg->hr_region_num, o2hb_failed_region_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\tcancel_delayed_work(&reg->hr_write_timeout_work);\n\treg->hr_last_timeout_start = jiffies;\n\tschedule_delayed_work(&reg->hr_write_timeout_work,\n\t\t\t      msecs_to_jiffies(O2HB_MAX_WRITE_TIMEOUT_MS));\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_delayed_work",
          "args": [
            "&reg->hr_write_timeout_work",
            "msecs_to_jiffies(O2HB_MAX_WRITE_TIMEOUT_MS)"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msecs_to_jiffies",
          "args": [
            "O2HB_MAX_WRITE_TIMEOUT_MS"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work",
          "args": [
            "&reg->hr_write_timeout_work"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_failed_region_bitmap"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "102-106",
          "snippet": "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit)\n{\n\tclear_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Queue write timeout for %u ms\\n\"",
            "O2HB_MAX_WRITE_TIMEOUT_MS"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&reg->hr_steady_iterations"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\n\nstatic void o2hb_arm_write_timeout(struct o2hb_region *reg)\n{\n\t/* Arm writeout only after thread reaches steady state */\n\tif (atomic_read(&reg->hr_steady_iterations) != 0)\n\t\treturn;\n\n\tmlog(ML_HEARTBEAT, \"Queue write timeout for %u ms\\n\",\n\t     O2HB_MAX_WRITE_TIMEOUT_MS);\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tclear_bit(reg->hr_region_num, o2hb_failed_region_bitmap);\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\tcancel_delayed_work(&reg->hr_write_timeout_work);\n\treg->hr_last_timeout_start = jiffies;\n\tschedule_delayed_work(&reg->hr_write_timeout_work,\n\t\t\t      msecs_to_jiffies(O2HB_MAX_WRITE_TIMEOUT_MS));\n}"
  },
  {
    "function_name": "o2hb_write_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "286-320",
    "snippet": "static void o2hb_write_timeout(struct work_struct *work)\n{\n\tint failed, quorum;\n\tunsigned long flags;\n\tstruct o2hb_region *reg =\n\t\tcontainer_of(work, struct o2hb_region,\n\t\t\t     hr_write_timeout_work.work);\n\n\tmlog(ML_ERROR, \"Heartbeat write timeout to device %s after %u \"\n\t     \"milliseconds\\n\", reg->hr_dev_name,\n\t     jiffies_to_msecs(jiffies - reg->hr_last_timeout_start));\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock_irqsave(&o2hb_live_lock, flags);\n\t\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\t\tset_bit(reg->hr_region_num, o2hb_failed_region_bitmap);\n\t\tfailed = bitmap_weight(o2hb_failed_region_bitmap,\n\t\t\t\t\tO2NM_MAX_REGIONS);\n\t\tquorum = bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t\t\tO2NM_MAX_REGIONS);\n\t\tspin_unlock_irqrestore(&o2hb_live_lock, flags);\n\n\t\tmlog(ML_HEARTBEAT, \"Number of regions %d, failed regions %d\\n\",\n\t\t     quorum, failed);\n\n\t\t/*\n\t\t * Fence if the number of failed regions >= half the number\n\t\t * of  quorum regions\n\t\t */\n\t\tif ((failed << 1) < quorum)\n\t\t\treturn;\n\t}\n\n\to2quo_disk_timeout();\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];",
      "static unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2quo_disk_timeout",
          "args": [],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "o2quo_disk_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/quorum.c",
          "lines": "100-103",
          "snippet": "void o2quo_disk_timeout(void)\n{\n\to2quo_fence_self();\n}",
          "includes": [
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/reboot.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"heartbeat.h\"\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n\nvoid o2quo_disk_timeout(void)\n{\n\to2quo_fence_self();\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_HEARTBEAT",
            "\"Number of regions %d, failed regions %d\\n\"",
            "quorum",
            "failed"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_store",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "115-121",
          "snippet": "static ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_store(struct kobject *obj, struct attribute *attr,\n\t\t\t  const char *buf, size_t count)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_store(mlog_attr->mask, buf, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&o2hb_live_lock",
            "flags"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_weight",
          "args": [
            "o2hb_quorum_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_weight",
          "args": [
            "o2hb_failed_region_bitmap",
            "O2NM_MAX_REGIONS"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_failed_region_bitmap"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_node_map_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/heartbeat.c",
          "lines": "84-88",
          "snippet": "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"heartbeat.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);",
            "static inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"heartbeat.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit);\nstatic inline void __ocfs2_node_map_clear_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t      int bit);\n\nstatic inline void __ocfs2_node_map_set_bit(struct ocfs2_node_map *map,\n\t\t\t\t\t    int bit)\n{\n\tset_bit(bit, map->map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "reg->hr_region_num",
            "o2hb_quorum_region_bitmap"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&o2hb_live_lock",
            "flags"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2hb_global_heartbeat_active",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "o2hb_global_heartbeat_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
          "lines": "2674-2677",
          "snippet": "int o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include \"quorum.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <linux/bitmap.h>",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/time.h>",
            "#include <linux/crc32.h>",
            "#include <linux/random.h>",
            "#include <linux/configfs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/file.h>",
            "#include <linux/delay.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nint o2hb_global_heartbeat_active(void)\n{\n\treturn (o2hb_heartbeat_mode == O2HB_HEARTBEAT_GLOBAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "jiffies_to_msecs",
          "args": [
            "jiffies - reg->hr_last_timeout_start"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structo2hb_region",
            "hr_write_timeout_work.work"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic unsigned long o2hb_quorum_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\nstatic unsigned long o2hb_failed_region_bitmap[BITS_TO_LONGS(O2NM_MAX_REGIONS)];\n\nstatic void o2hb_write_timeout(struct work_struct *work)\n{\n\tint failed, quorum;\n\tunsigned long flags;\n\tstruct o2hb_region *reg =\n\t\tcontainer_of(work, struct o2hb_region,\n\t\t\t     hr_write_timeout_work.work);\n\n\tmlog(ML_ERROR, \"Heartbeat write timeout to device %s after %u \"\n\t     \"milliseconds\\n\", reg->hr_dev_name,\n\t     jiffies_to_msecs(jiffies - reg->hr_last_timeout_start));\n\n\tif (o2hb_global_heartbeat_active()) {\n\t\tspin_lock_irqsave(&o2hb_live_lock, flags);\n\t\tif (test_bit(reg->hr_region_num, o2hb_quorum_region_bitmap))\n\t\t\tset_bit(reg->hr_region_num, o2hb_failed_region_bitmap);\n\t\tfailed = bitmap_weight(o2hb_failed_region_bitmap,\n\t\t\t\t\tO2NM_MAX_REGIONS);\n\t\tquorum = bitmap_weight(o2hb_quorum_region_bitmap,\n\t\t\t\t\tO2NM_MAX_REGIONS);\n\t\tspin_unlock_irqrestore(&o2hb_live_lock, flags);\n\n\t\tmlog(ML_HEARTBEAT, \"Number of regions %d, failed regions %d\\n\",\n\t\t     quorum, failed);\n\n\t\t/*\n\t\t * Fence if the number of failed regions >= half the number\n\t\t * of  quorum regions\n\t\t */\n\t\tif ((failed << 1) < quorum)\n\t\t\treturn;\n\t}\n\n\to2quo_disk_timeout();\n}"
  },
  {
    "function_name": "o2hb_global_heartbeat_mode_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "180-194",
    "snippet": "static int o2hb_global_heartbeat_mode_set(unsigned int hb_mode)\n{\n\tint ret = -1;\n\n\tif (hb_mode < O2HB_HEARTBEAT_NUM_MODES) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions)) {\n\t\t\to2hb_heartbeat_mode = hb_mode;\n\t\t\tret = 0;\n\t\t}\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_all_regions);",
      "unsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&o2hb_all_regions"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nunsigned int o2hb_heartbeat_mode = O2HB_HEARTBEAT_LOCAL;\n\nstatic int o2hb_global_heartbeat_mode_set(unsigned int hb_mode)\n{\n\tint ret = -1;\n\n\tif (hb_mode < O2HB_HEARTBEAT_NUM_MODES) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions)) {\n\t\t\to2hb_heartbeat_mode = hb_mode;\n\t\t\tret = 0;\n\t\t}\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2hb_dead_threshold_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/heartbeat.c",
    "lines": "170-178",
    "snippet": "static void o2hb_dead_threshold_set(unsigned int threshold)\n{\n\tif (threshold > O2HB_MIN_DEAD_THRESHOLD) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions))\n\t\t\to2hb_dead_threshold = threshold;\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n}",
    "includes": [
      "#include \"masklog.h\"",
      "#include \"quorum.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include \"heartbeat.h\"",
      "#include <linux/bitmap.h>",
      "#include <linux/slab.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/time.h>",
      "#include <linux/crc32.h>",
      "#include <linux/random.h>",
      "#include <linux/configfs.h>",
      "#include <linux/kthread.h>",
      "#include <linux/file.h>",
      "#include <linux/delay.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/bio.h>",
      "#include <linux/fs.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(o2hb_live_lock);",
      "static LIST_HEAD(o2hb_all_regions);",
      "unsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&o2hb_all_regions"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2hb_live_lock"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"masklog.h\"\n#include \"quorum.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <linux/bitmap.h>\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/time.h>\n#include <linux/crc32.h>\n#include <linux/random.h>\n#include <linux/configfs.h>\n#include <linux/kthread.h>\n#include <linux/file.h>\n#include <linux/delay.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SPINLOCK(o2hb_live_lock);\nstatic LIST_HEAD(o2hb_all_regions);\nunsigned int o2hb_dead_threshold = O2HB_DEFAULT_DEAD_THRESHOLD;\n\nstatic void o2hb_dead_threshold_set(unsigned int threshold)\n{\n\tif (threshold > O2HB_MIN_DEAD_THRESHOLD) {\n\t\tspin_lock(&o2hb_live_lock);\n\t\tif (list_empty(&o2hb_all_regions))\n\t\t\to2hb_dead_threshold = threshold;\n\t\tspin_unlock(&o2hb_live_lock);\n\t}\n}"
  }
]