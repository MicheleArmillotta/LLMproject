[
  {
    "function_name": "ffs2_free_xattr_ref(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "319-323",
    "snippet": "oid jffs2_free_xattr_ref(struct jffs2_xattr_ref *ref)\n{\n\tdbg_memalloc(\"%p\\n\", ref);\n\tkmem_cache_free(xattr_ref_cache, ref);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "attr_ref_cache,",
            "ef)"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "ef)"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\noid jffs2_free_xattr_ref(struct jffs2_xattr_ref *ref)\n{\n\tdbg_memalloc(\"%p\\n\", ref);\n\tkmem_cache_free(xattr_ref_cache, ref);\n}"
  },
  {
    "function_name": "ffs2_alloc_xattr_ref(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "306-317",
    "snippet": "truct jffs2_xattr_ref *jffs2_alloc_xattr_ref(void)\n{\n\tstruct jffs2_xattr_ref *ref;\n\tref = kmem_cache_zalloc(xattr_ref_cache, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ref);\n\tif (!ref)\n\t\treturn NULL;\n\n\tref->class = RAWNODE_CLASS_XATTR_REF;\n\tref->node = (void *)ref;\n\treturn ref;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "ef)"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_zalloc(",
          "args": [
            "attr_ref_cache,",
            "FP_KERNEL)"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntruct jffs2_xattr_ref *jffs2_alloc_xattr_ref(void)\n{\n\tstruct jffs2_xattr_ref *ref;\n\tref = kmem_cache_zalloc(xattr_ref_cache, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ref);\n\tif (!ref)\n\t\treturn NULL;\n\n\tref->class = RAWNODE_CLASS_XATTR_REF;\n\tref->node = (void *)ref;\n\treturn ref;\n}"
  },
  {
    "function_name": "ffs2_free_xattr_datum(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "300-304",
    "snippet": "oid jffs2_free_xattr_datum(struct jffs2_xattr_datum *xd)\n{\n\tdbg_memalloc(\"%p\\n\", xd);\n\tkmem_cache_free(xattr_datum_cache, xd);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "attr_datum_cache,",
            "d)"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "d)"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\noid jffs2_free_xattr_datum(struct jffs2_xattr_datum *xd)\n{\n\tdbg_memalloc(\"%p\\n\", xd);\n\tkmem_cache_free(xattr_datum_cache, xd);\n}"
  },
  {
    "function_name": "ffs2_alloc_xattr_datum(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "286-298",
    "snippet": "truct jffs2_xattr_datum *jffs2_alloc_xattr_datum(void)\n{\n\tstruct jffs2_xattr_datum *xd;\n\txd = kmem_cache_zalloc(xattr_datum_cache, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", xd);\n\tif (!xd)\n\t\treturn NULL;\n\n\txd->class = RAWNODE_CLASS_XATTR_DATUM;\n\txd->node = (void *)xd;\n\tINIT_LIST_HEAD(&xd->xindex);\n\treturn xd;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NIT_LIST_HEAD(",
          "args": [
            "xd->xindex)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "d)"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_zalloc(",
          "args": [
            "attr_datum_cache,",
            "FP_KERNEL)"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntruct jffs2_xattr_datum *jffs2_alloc_xattr_datum(void)\n{\n\tstruct jffs2_xattr_datum *xd;\n\txd = kmem_cache_zalloc(xattr_datum_cache, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", xd);\n\tif (!xd)\n\t\treturn NULL;\n\n\txd->class = RAWNODE_CLASS_XATTR_DATUM;\n\txd->node = (void *)xd;\n\tINIT_LIST_HEAD(&xd->xindex);\n\treturn xd;\n}"
  },
  {
    "function_name": "ffs2_free_inode_cache(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "279-283",
    "snippet": "oid jffs2_free_inode_cache(struct jffs2_inode_cache *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(inode_cache_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *inode_cache_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "node_cache_slab,",
            ")"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *inode_cache_slab;\n\noid jffs2_free_inode_cache(struct jffs2_inode_cache *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(inode_cache_slab, x);\n}"
  },
  {
    "function_name": "ffs2_alloc_inode_cache(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "271-277",
    "snippet": "truct jffs2_inode_cache *jffs2_alloc_inode_cache(void)\n{\n\tstruct jffs2_inode_cache *ret;\n\tret = kmem_cache_alloc(inode_cache_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *inode_cache_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "node_cache_slab,",
            "FP_KERNEL)"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *inode_cache_slab;\n\ntruct jffs2_inode_cache *jffs2_alloc_inode_cache(void)\n{\n\tstruct jffs2_inode_cache *ret;\n\tret = kmem_cache_alloc(inode_cache_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_node_frag(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "265-269",
    "snippet": "oid jffs2_free_node_frag(struct jffs2_node_frag *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(node_frag_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *node_frag_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "ode_frag_slab,",
            ")"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *node_frag_slab;\n\noid jffs2_free_node_frag(struct jffs2_node_frag *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(node_frag_slab, x);\n}"
  },
  {
    "function_name": "ffs2_alloc_node_frag(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "257-263",
    "snippet": "truct jffs2_node_frag *jffs2_alloc_node_frag(void)\n{\n\tstruct jffs2_node_frag *ret;\n\tret = kmem_cache_alloc(node_frag_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *node_frag_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "ode_frag_slab,",
            "FP_KERNEL)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *node_frag_slab;\n\ntruct jffs2_node_frag *jffs2_alloc_node_frag(void)\n{\n\tstruct jffs2_node_frag *ret;\n\tret = kmem_cache_alloc(node_frag_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_refblock(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "251-255",
    "snippet": "oid jffs2_free_refblock(struct jffs2_raw_node_ref *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(raw_node_ref_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *raw_node_ref_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "aw_node_ref_slab,",
            ")"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *raw_node_ref_slab;\n\noid jffs2_free_refblock(struct jffs2_raw_node_ref *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(raw_node_ref_slab, x);\n}"
  },
  {
    "function_name": "ffs2_prealloc_raw_node_refs(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "210-249",
    "snippet": "nt jffs2_prealloc_raw_node_refs(struct jffs2_sb_info *c,\n\t\t\t\t struct jffs2_eraseblock *jeb, int nr)\n{\n\tstruct jffs2_raw_node_ref **p, *ref;\n\tint i = nr;\n\n\tdbg_memalloc(\"%d\\n\", nr);\n\n\tp = &jeb->last_node;\n\tref = *p;\n\n\tdbg_memalloc(\"Reserving %d refs for block @0x%08x\\n\", nr, jeb->offset);\n\n\t/* If jeb->last_node is really a valid node then skip over it */\n\tif (ref && ref->flash_offset != REF_EMPTY_NODE)\n\t\tref++;\n\n\twhile (i) {\n\t\tif (!ref) {\n\t\t\tdbg_memalloc(\"Allocating new refblock linked from %p\\n\", p);\n\t\t\tref = *p = jffs2_alloc_refblock();\n\t\t\tif (!ref)\n\t\t\t\treturn -ENOMEM;\n\t\t}\n\t\tif (ref->flash_offset == REF_LINK_NODE) {\n\t\t\tp = &ref->next_in_ino;\n\t\t\tref = *p;\n\t\t\tcontinue;\n\t\t}\n\t\ti--;\n\t\tref++;\n\t}\n\tjeb->allocated_refs = nr;\n\n\tdbg_memalloc(\"Reserved %d refs for block @0x%08x, last_node is %p (%08x,%p)\\n\",\n\t\t  nr, jeb->offset, jeb->last_node, jeb->last_node->flash_offset,\n\t\t  jeb->last_node->next_in_ino);\n\n\treturn 0;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "Reserved %d refs for block @0x%08x, last_node is %p (%08x,%p)\\n\",",
            "r,",
            "eb->offset,",
            "eb->last_node,",
            "eb->last_node->flash_offset,",
            "eb->last_node->next_in_ino)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs2_alloc_refblock(",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "Allocating new refblock linked from %p\\n\",",
            ")"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "Reserving %d refs for block @0x%08x\\n\",",
            "r,",
            "eb->offset)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%d\\n\",",
            "r)"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\nnt jffs2_prealloc_raw_node_refs(struct jffs2_sb_info *c,\n\t\t\t\t struct jffs2_eraseblock *jeb, int nr)\n{\n\tstruct jffs2_raw_node_ref **p, *ref;\n\tint i = nr;\n\n\tdbg_memalloc(\"%d\\n\", nr);\n\n\tp = &jeb->last_node;\n\tref = *p;\n\n\tdbg_memalloc(\"Reserving %d refs for block @0x%08x\\n\", nr, jeb->offset);\n\n\t/* If jeb->last_node is really a valid node then skip over it */\n\tif (ref && ref->flash_offset != REF_EMPTY_NODE)\n\t\tref++;\n\n\twhile (i) {\n\t\tif (!ref) {\n\t\t\tdbg_memalloc(\"Allocating new refblock linked from %p\\n\", p);\n\t\t\tref = *p = jffs2_alloc_refblock();\n\t\t\tif (!ref)\n\t\t\t\treturn -ENOMEM;\n\t\t}\n\t\tif (ref->flash_offset == REF_LINK_NODE) {\n\t\t\tp = &ref->next_in_ino;\n\t\t\tref = *p;\n\t\t\tcontinue;\n\t\t}\n\t\ti--;\n\t\tref++;\n\t}\n\tjeb->allocated_refs = nr;\n\n\tdbg_memalloc(\"Reserved %d refs for block @0x%08x, last_node is %p (%08x,%p)\\n\",\n\t\t  nr, jeb->offset, jeb->last_node, jeb->last_node->flash_offset,\n\t\t  jeb->last_node->next_in_ino);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ffs2_alloc_refblock(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "193-208",
    "snippet": "tatic struct jffs2_raw_node_ref *jffs2_alloc_refblock(void)\n{\n\tstruct jffs2_raw_node_ref *ret;\n\n\tret = kmem_cache_alloc(raw_node_ref_slab, GFP_KERNEL);\n\tif (ret) {\n\t\tint i = 0;\n\t\tfor (i=0; i < REFS_PER_BLOCK; i++) {\n\t\t\tret[i].flash_offset = REF_EMPTY_NODE;\n\t\t\tret[i].next_in_ino = NULL;\n\t\t}\n\t\tret[i].flash_offset = REF_LINK_NODE;\n\t\tret[i].next_in_ino = NULL;\n\t}\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *raw_node_ref_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "aw_node_ref_slab,",
            "FP_KERNEL)"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *raw_node_ref_slab;\n\ntatic struct jffs2_raw_node_ref *jffs2_alloc_refblock(void)\n{\n\tstruct jffs2_raw_node_ref *ret;\n\n\tret = kmem_cache_alloc(raw_node_ref_slab, GFP_KERNEL);\n\tif (ret) {\n\t\tint i = 0;\n\t\tfor (i=0; i < REFS_PER_BLOCK; i++) {\n\t\t\tret[i].flash_offset = REF_EMPTY_NODE;\n\t\t\tret[i].next_in_ino = NULL;\n\t\t}\n\t\tret[i].flash_offset = REF_LINK_NODE;\n\t\tret[i].next_in_ino = NULL;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_tmp_dnode_info(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "187-191",
    "snippet": "oid jffs2_free_tmp_dnode_info(struct jffs2_tmp_dnode_info *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(tmp_dnode_info_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *tmp_dnode_info_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "mp_dnode_info_slab,",
            ")"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *tmp_dnode_info_slab;\n\noid jffs2_free_tmp_dnode_info(struct jffs2_tmp_dnode_info *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(tmp_dnode_info_slab, x);\n}"
  },
  {
    "function_name": "ffs2_alloc_tmp_dnode_info(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "178-185",
    "snippet": "truct jffs2_tmp_dnode_info *jffs2_alloc_tmp_dnode_info(void)\n{\n\tstruct jffs2_tmp_dnode_info *ret;\n\tret = kmem_cache_alloc(tmp_dnode_info_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\",\n\t\tret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *tmp_dnode_info_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "mp_dnode_info_slab,",
            "FP_KERNEL)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *tmp_dnode_info_slab;\n\ntruct jffs2_tmp_dnode_info *jffs2_alloc_tmp_dnode_info(void)\n{\n\tstruct jffs2_tmp_dnode_info *ret;\n\tret = kmem_cache_alloc(tmp_dnode_info_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\",\n\t\tret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_raw_inode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "172-176",
    "snippet": "oid jffs2_free_raw_inode(struct jffs2_raw_inode *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(raw_inode_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *raw_inode_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "aw_inode_slab,",
            ")"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *raw_inode_slab;\n\noid jffs2_free_raw_inode(struct jffs2_raw_inode *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(raw_inode_slab, x);\n}"
  },
  {
    "function_name": "ffs2_alloc_raw_inode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "164-170",
    "snippet": "truct jffs2_raw_inode *jffs2_alloc_raw_inode(void)\n{\n\tstruct jffs2_raw_inode *ret;\n\tret = kmem_cache_alloc(raw_inode_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *raw_inode_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "aw_inode_slab,",
            "FP_KERNEL)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *raw_inode_slab;\n\ntruct jffs2_raw_inode *jffs2_alloc_raw_inode(void)\n{\n\tstruct jffs2_raw_inode *ret;\n\tret = kmem_cache_alloc(raw_inode_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_raw_dirent(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "158-162",
    "snippet": "oid jffs2_free_raw_dirent(struct jffs2_raw_dirent *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(raw_dirent_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *raw_dirent_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "aw_dirent_slab,",
            ")"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *raw_dirent_slab;\n\noid jffs2_free_raw_dirent(struct jffs2_raw_dirent *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(raw_dirent_slab, x);\n}"
  },
  {
    "function_name": "ffs2_alloc_raw_dirent(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "150-156",
    "snippet": "truct jffs2_raw_dirent *jffs2_alloc_raw_dirent(void)\n{\n\tstruct jffs2_raw_dirent *ret;\n\tret = kmem_cache_alloc(raw_dirent_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *raw_dirent_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "aw_dirent_slab,",
            "FP_KERNEL)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *raw_dirent_slab;\n\ntruct jffs2_raw_dirent *jffs2_alloc_raw_dirent(void)\n{\n\tstruct jffs2_raw_dirent *ret;\n\tret = kmem_cache_alloc(raw_dirent_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_full_dnode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "144-148",
    "snippet": "oid jffs2_free_full_dnode(struct jffs2_full_dnode *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(full_dnode_slab, x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *full_dnode_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_free(",
          "args": [
            "ull_dnode_slab,",
            ")"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *full_dnode_slab;\n\noid jffs2_free_full_dnode(struct jffs2_full_dnode *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkmem_cache_free(full_dnode_slab, x);\n}"
  },
  {
    "function_name": "ffs2_alloc_full_dnode(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "136-142",
    "snippet": "truct jffs2_full_dnode *jffs2_alloc_full_dnode(void)\n{\n\tstruct jffs2_full_dnode *ret;\n\tret = kmem_cache_alloc(full_dnode_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *full_dnode_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_alloc(",
          "args": [
            "ull_dnode_slab,",
            "FP_KERNEL)"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *full_dnode_slab;\n\ntruct jffs2_full_dnode *jffs2_alloc_full_dnode(void)\n{\n\tstruct jffs2_full_dnode *ret;\n\tret = kmem_cache_alloc(full_dnode_slab, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_free_full_dirent(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "130-134",
    "snippet": "oid jffs2_free_full_dirent(struct jffs2_full_dirent *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkfree(x);\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free(",
          "args": [
            ")"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "in_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/scan.c",
          "lines": "51-60",
          "snippet": "tatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}",
          "includes": [
            "include \"debug.h\"",
            "include \"summary.h\"\n#",
            "include \"nodelist.h\"\n#",
            "include <linux/compiler.h>\n#",
            "include <linux/crc32.h>\n#",
            "include <linux/pagemap.h>\n#",
            "include <linux/mtd/mtd.h>\n#",
            "include <linux/slab.h>\n#",
            "include <linux/sched.h>\n#",
            "include <linux/kernel.h>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"debug.h\"\ninclude \"summary.h\"\n#\ninclude \"nodelist.h\"\n#\ninclude <linux/compiler.h>\n#\ninclude <linux/crc32.h>\n#\ninclude <linux/pagemap.h>\n#\ninclude <linux/mtd/mtd.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/sched.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic inline int min_free(struct jffs2_sb_info *c)\n{\n\tuint32_t min = 2 * sizeof(struct jffs2_raw_inode);\n#ifdef CONFIG_JFFS2_FS_WRITEBUFFER\n\tif (!jffs2_can_mark_obsolete(c) && min < c->wbuf_pagesize)\n\t\treturn c->wbuf_pagesize;\n#endif\n\treturn min;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            ")"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\noid jffs2_free_full_dirent(struct jffs2_full_dirent *x)\n{\n\tdbg_memalloc(\"%p\\n\", x);\n\tkfree(x);\n}"
  },
  {
    "function_name": "ffs2_alloc_full_dirent(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "122-128",
    "snippet": "truct jffs2_full_dirent *jffs2_alloc_full_dirent(int namesize)\n{\n\tstruct jffs2_full_dirent *ret;\n\tret = kmalloc(sizeof(struct jffs2_full_dirent) + namesize, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bg_memalloc(",
          "args": [
            "%p\\n\",",
            "et)"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc(",
          "args": [
            "izeof(struct jffs2_full_dirent) + namesize,",
            "FP_KERNEL)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntruct jffs2_full_dirent *jffs2_alloc_full_dirent(int namesize)\n{\n\tstruct jffs2_full_dirent *ret;\n\tret = kmalloc(sizeof(struct jffs2_full_dirent) + namesize, GFP_KERNEL);\n\tdbg_memalloc(\"%p\\n\", ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "ffs2_destroy_slab_caches(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "98-120",
    "snippet": "oid jffs2_destroy_slab_caches(void)\n{\n\tif(full_dnode_slab)\n\t\tkmem_cache_destroy(full_dnode_slab);\n\tif(raw_dirent_slab)\n\t\tkmem_cache_destroy(raw_dirent_slab);\n\tif(raw_inode_slab)\n\t\tkmem_cache_destroy(raw_inode_slab);\n\tif(tmp_dnode_info_slab)\n\t\tkmem_cache_destroy(tmp_dnode_info_slab);\n\tif(raw_node_ref_slab)\n\t\tkmem_cache_destroy(raw_node_ref_slab);\n\tif(node_frag_slab)\n\t\tkmem_cache_destroy(node_frag_slab);\n\tif(inode_cache_slab)\n\t\tkmem_cache_destroy(inode_cache_slab);\n#ifdef CONFIG_JFFS2_FS_XATTR\n\tif (xattr_datum_cache)\n\t\tkmem_cache_destroy(xattr_datum_cache);\n\tif (xattr_ref_cache)\n\t\tkmem_cache_destroy(xattr_ref_cache);\n#endif\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *full_dnode_slab;",
      "tatic struct kmem_cache *raw_dirent_slab;",
      "tatic struct kmem_cache *raw_inode_slab;",
      "tatic struct kmem_cache *tmp_dnode_info_slab;",
      "tatic struct kmem_cache *raw_node_ref_slab;",
      "tatic struct kmem_cache *node_frag_slab;",
      "tatic struct kmem_cache *inode_cache_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "attr_ref_cache)"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "attr_datum_cache)"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "node_cache_slab)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "ode_frag_slab)"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "aw_node_ref_slab)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "mp_dnode_info_slab)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "aw_inode_slab)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "aw_dirent_slab)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_destroy(",
          "args": [
            "ull_dnode_slab)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *full_dnode_slab;\ntatic struct kmem_cache *raw_dirent_slab;\ntatic struct kmem_cache *raw_inode_slab;\ntatic struct kmem_cache *tmp_dnode_info_slab;\ntatic struct kmem_cache *raw_node_ref_slab;\ntatic struct kmem_cache *node_frag_slab;\ntatic struct kmem_cache *inode_cache_slab;\n\noid jffs2_destroy_slab_caches(void)\n{\n\tif(full_dnode_slab)\n\t\tkmem_cache_destroy(full_dnode_slab);\n\tif(raw_dirent_slab)\n\t\tkmem_cache_destroy(raw_dirent_slab);\n\tif(raw_inode_slab)\n\t\tkmem_cache_destroy(raw_inode_slab);\n\tif(tmp_dnode_info_slab)\n\t\tkmem_cache_destroy(tmp_dnode_info_slab);\n\tif(raw_node_ref_slab)\n\t\tkmem_cache_destroy(raw_node_ref_slab);\n\tif(node_frag_slab)\n\t\tkmem_cache_destroy(node_frag_slab);\n\tif(inode_cache_slab)\n\t\tkmem_cache_destroy(inode_cache_slab);\n#ifdef CONFIG_JFFS2_FS_XATTR\n\tif (xattr_datum_cache)\n\t\tkmem_cache_destroy(xattr_datum_cache);\n\tif (xattr_ref_cache)\n\t\tkmem_cache_destroy(xattr_ref_cache);\n#endif\n}"
  },
  {
    "function_name": "ffs2_create_slab_caches(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/malloc.c",
    "lines": "34-96",
    "snippet": "nt __init jffs2_create_slab_caches(void)\n{\n\tfull_dnode_slab = kmem_cache_create(\"jffs2_full_dnode\",\n\t\t\t\t\t    sizeof(struct jffs2_full_dnode),\n\t\t\t\t\t    0, 0, NULL);\n\tif (!full_dnode_slab)\n\t\tgoto err;\n\n\traw_dirent_slab = kmem_cache_create(\"jffs2_raw_dirent\",\n\t\t\t\t\t    sizeof(struct jffs2_raw_dirent),\n\t\t\t\t\t    0, SLAB_HWCACHE_ALIGN, NULL);\n\tif (!raw_dirent_slab)\n\t\tgoto err;\n\n\traw_inode_slab = kmem_cache_create(\"jffs2_raw_inode\",\n\t\t\t\t\t   sizeof(struct jffs2_raw_inode),\n\t\t\t\t\t   0, SLAB_HWCACHE_ALIGN, NULL);\n\tif (!raw_inode_slab)\n\t\tgoto err;\n\n\ttmp_dnode_info_slab = kmem_cache_create(\"jffs2_tmp_dnode\",\n\t\t\t\t\t\tsizeof(struct jffs2_tmp_dnode_info),\n\t\t\t\t\t\t0, 0, NULL);\n\tif (!tmp_dnode_info_slab)\n\t\tgoto err;\n\n\traw_node_ref_slab = kmem_cache_create(\"jffs2_refblock\",\n\t\t\t\t\t      sizeof(struct jffs2_raw_node_ref) * (REFS_PER_BLOCK + 1),\n\t\t\t\t\t      0, 0, NULL);\n\tif (!raw_node_ref_slab)\n\t\tgoto err;\n\n\tnode_frag_slab = kmem_cache_create(\"jffs2_node_frag\",\n\t\t\t\t\t   sizeof(struct jffs2_node_frag),\n\t\t\t\t\t   0, 0, NULL);\n\tif (!node_frag_slab)\n\t\tgoto err;\n\n\tinode_cache_slab = kmem_cache_create(\"jffs2_inode_cache\",\n\t\t\t\t\t     sizeof(struct jffs2_inode_cache),\n\t\t\t\t\t     0, 0, NULL);\n\tif (!inode_cache_slab)\n\t\tgoto err;\n\n#ifdef CONFIG_JFFS2_FS_XATTR\n\txattr_datum_cache = kmem_cache_create(\"jffs2_xattr_datum\",\n\t\t\t\t\t     sizeof(struct jffs2_xattr_datum),\n\t\t\t\t\t     0, 0, NULL);\n\tif (!xattr_datum_cache)\n\t\tgoto err;\n\n\txattr_ref_cache = kmem_cache_create(\"jffs2_xattr_ref\",\n\t\t\t\t\t   sizeof(struct jffs2_xattr_ref),\n\t\t\t\t\t   0, 0, NULL);\n\tif (!xattr_ref_cache)\n\t\tgoto err;\n#endif\n\n\treturn 0;\n err:\n\tjffs2_destroy_slab_caches();\n\treturn -ENOMEM;\n}",
    "includes": [
      "include \"nodelist.h\"",
      "include <linux/jffs2.h>\n#",
      "include <linux/init.h>\n#",
      "include <linux/slab.h>\n#",
      "include <linux/kernel.h>\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct kmem_cache *full_dnode_slab;",
      "tatic struct kmem_cache *raw_dirent_slab;",
      "tatic struct kmem_cache *raw_inode_slab;",
      "tatic struct kmem_cache *tmp_dnode_info_slab;",
      "tatic struct kmem_cache *raw_node_ref_slab;",
      "tatic struct kmem_cache *node_frag_slab;",
      "tatic struct kmem_cache *inode_cache_slab;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ffs2_destroy_slab_caches(",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_xattr_ref\",",
            "izeof(struct jffs2_xattr_ref),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_xattr_datum\",",
            "izeof(struct jffs2_xattr_datum),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_inode_cache\",",
            "izeof(struct jffs2_inode_cache),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_node_frag\",",
            "izeof(struct jffs2_node_frag),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_refblock\",",
            "izeof(struct jffs2_raw_node_ref) * (REFS_PER_BLOCK + 1),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_tmp_dnode\",",
            "izeof(struct jffs2_tmp_dnode_info),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_raw_inode\",",
            "izeof(struct jffs2_raw_inode),",
            ",",
            "LAB_HWCACHE_ALIGN,",
            "ULL)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_raw_dirent\",",
            "izeof(struct jffs2_raw_dirent),",
            ",",
            "LAB_HWCACHE_ALIGN,",
            "ULL)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cache_create(",
          "args": [
            "jffs2_full_dnode\",",
            "izeof(struct jffs2_full_dnode),",
            ",",
            ",",
            "ULL)"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"nodelist.h\"\ninclude <linux/jffs2.h>\n#\ninclude <linux/init.h>\n#\ninclude <linux/slab.h>\n#\ninclude <linux/kernel.h>\n#\n\ntatic struct kmem_cache *full_dnode_slab;\ntatic struct kmem_cache *raw_dirent_slab;\ntatic struct kmem_cache *raw_inode_slab;\ntatic struct kmem_cache *tmp_dnode_info_slab;\ntatic struct kmem_cache *raw_node_ref_slab;\ntatic struct kmem_cache *node_frag_slab;\ntatic struct kmem_cache *inode_cache_slab;\n\nnt __init jffs2_create_slab_caches(void)\n{\n\tfull_dnode_slab = kmem_cache_create(\"jffs2_full_dnode\",\n\t\t\t\t\t    sizeof(struct jffs2_full_dnode),\n\t\t\t\t\t    0, 0, NULL);\n\tif (!full_dnode_slab)\n\t\tgoto err;\n\n\traw_dirent_slab = kmem_cache_create(\"jffs2_raw_dirent\",\n\t\t\t\t\t    sizeof(struct jffs2_raw_dirent),\n\t\t\t\t\t    0, SLAB_HWCACHE_ALIGN, NULL);\n\tif (!raw_dirent_slab)\n\t\tgoto err;\n\n\traw_inode_slab = kmem_cache_create(\"jffs2_raw_inode\",\n\t\t\t\t\t   sizeof(struct jffs2_raw_inode),\n\t\t\t\t\t   0, SLAB_HWCACHE_ALIGN, NULL);\n\tif (!raw_inode_slab)\n\t\tgoto err;\n\n\ttmp_dnode_info_slab = kmem_cache_create(\"jffs2_tmp_dnode\",\n\t\t\t\t\t\tsizeof(struct jffs2_tmp_dnode_info),\n\t\t\t\t\t\t0, 0, NULL);\n\tif (!tmp_dnode_info_slab)\n\t\tgoto err;\n\n\traw_node_ref_slab = kmem_cache_create(\"jffs2_refblock\",\n\t\t\t\t\t      sizeof(struct jffs2_raw_node_ref) * (REFS_PER_BLOCK + 1),\n\t\t\t\t\t      0, 0, NULL);\n\tif (!raw_node_ref_slab)\n\t\tgoto err;\n\n\tnode_frag_slab = kmem_cache_create(\"jffs2_node_frag\",\n\t\t\t\t\t   sizeof(struct jffs2_node_frag),\n\t\t\t\t\t   0, 0, NULL);\n\tif (!node_frag_slab)\n\t\tgoto err;\n\n\tinode_cache_slab = kmem_cache_create(\"jffs2_inode_cache\",\n\t\t\t\t\t     sizeof(struct jffs2_inode_cache),\n\t\t\t\t\t     0, 0, NULL);\n\tif (!inode_cache_slab)\n\t\tgoto err;\n\n#ifdef CONFIG_JFFS2_FS_XATTR\n\txattr_datum_cache = kmem_cache_create(\"jffs2_xattr_datum\",\n\t\t\t\t\t     sizeof(struct jffs2_xattr_datum),\n\t\t\t\t\t     0, 0, NULL);\n\tif (!xattr_datum_cache)\n\t\tgoto err;\n\n\txattr_ref_cache = kmem_cache_create(\"jffs2_xattr_ref\",\n\t\t\t\t\t   sizeof(struct jffs2_xattr_ref),\n\t\t\t\t\t   0, 0, NULL);\n\tif (!xattr_ref_cache)\n\t\tgoto err;\n#endif\n\n\treturn 0;\n err:\n\tjffs2_destroy_slab_caches();\n\treturn -ENOMEM;\n}"
  }
]